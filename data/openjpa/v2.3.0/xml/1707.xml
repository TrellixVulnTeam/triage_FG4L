<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:34:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1707/OPENJPA-1707.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1707] A warning message should be logged when a down level enhanced Entity is encountered.</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1707</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Currently when PCEnhancer is called to enhance an Entity that was previous enhanced it will simply noop and move on. It could be smarter and use the PersistenceCapable.pcGetEnhancementContractVersion to detect and when an Entity has been enhanced with an older version of the enhancer and log a warning message. A similar change would also need to be made to PCClassFileTransformer.needsEnhance to perform the same sort of logic at runtime.&lt;/p&gt;

&lt;p&gt;This would be particularly helpful in the case where an application was compiled/enhanced/packaged and a bug was fixed in the enhancer but the pre-packaged app still has the bad bytecode.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12467911">OPENJPA-1707</key>
            <summary>A warning message should be logged when a down level enhanced Entity is encountered.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="curtisr7">Rick Curtis</assignee>
                                    <reporter username="curtisr7">Rick Curtis</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Jun 2010 16:09:32 +0100</created>
                <updated>Wed, 25 Jan 2012 01:53:39 +0000</updated>
                                            <version>2.0.0</version>
                    <version>2.1.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>kernel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12885640" author="curtisr7" created="Tue, 6 Jul 2010 19:58:29 +0100"  >&lt;p&gt;The change that I committed to trunk utilizes the PCEnhancer.checkEnhancementLevel() method which was added in &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-151&quot; title=&quot;Added field in enhanced vesrion of a class is not serialized. Hence the change in detached+serialized instances is not registered under certain conditions.  &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-151&quot;&gt;&lt;del&gt;OPENJPA-151&lt;/del&gt;&lt;/a&gt; but as far as I can tell was never used. I believe the intent of this field was to be used for changes to enhanced bytecode that may break serialization. Since this field was never utilized, I took the liberty to repurpose the method.&lt;/p&gt;

&lt;p&gt;I added some magic to the build which now will write the revision of the PCEnhancer to META-INF/org.apache.openjpa.revision.properties. This value will be read into PCEnhancer in a static initializer which will be used for validation, and will be written to enhanced bytecode. This way we won&apos;t have to manually update the PCEnhancer.ENHANCER_VERSION every time a change is made to that file.&lt;/p&gt;

&lt;p&gt;Currently I have it so that when trace IS NOT enabled, we will only log one message when a down level Entity is encountered. If trace is enabled we will log a message for each down level Entity that is encountered. &lt;/p&gt;

&lt;p&gt;I flipped back and forth on whether or not this should be an INFO or WARN message. I ended up going with an INFO message because for the time being any Entity that was enhanced prior to this commit will result in a message being logged. &lt;/p&gt;</comment>
                            <comment id="12912522" author="mikedd" created="Mon, 20 Sep 2010 16:39:58 +0100"  >&lt;p&gt;Closing issues which have been resolved for some time. If the problem persists, please reopen. &lt;/p&gt;</comment>
                            <comment id="13192782" author="ppoddar@apache.org" created="Wed, 25 Jan 2012 01:53:17 +0000"  >&lt;p&gt;&amp;gt; Since this field was never utilized, I took the liberty to repurpose the method. &lt;br/&gt;
Such liberty is not recommended for several reasons&lt;br/&gt;
a) the purpose of the field is lost by your change. &lt;br/&gt;
b) The purpose was non-trivial and now replaced with a rather trivial semantics. What code reversion was used to enhance a class is not as important as to know whether the serialization data for an enhanced entity has been modified by us which is critical information in a version upgrade. &lt;br/&gt;
With this change one can add a new log statement in PCEnhancer and this change will start logging warning messages for no good reason. &lt;/p&gt;

&lt;p&gt;If the concern is why this information is not used so far, then change that by adding some code that validates that enhancement is compatible. &lt;br/&gt;
If the concern is to carry that information on code revision then that has to be done using a separate field, and upgrading the value of ENHANCEMENT_CONTRACT to its next integral level.&lt;/p&gt;</comment>
                            <comment id="13192783" author="ppoddar@apache.org" created="Wed, 25 Jan 2012 01:53:39 +0000"  >&lt;p&gt;Please see my comment&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12494520">OPENJPA-1912</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 20 Sep 2010 15:39:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161958</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7oa7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>288904</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>