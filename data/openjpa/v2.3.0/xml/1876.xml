<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:39:15 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1876/OPENJPA-1876.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1876] Slow JDBC tests</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1876</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Persistence JDBC tests and other database connected tests have been suffering from slow down starting somewhere in September 2010 &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. I can see this in my environment as well as Hudson builds:&lt;/p&gt;

&lt;p&gt;OpenJPA-trunk-deploy: Build #49 (Nov 7, 2010 6:46:34 AM): OpenJPA Persistence JDBC: 34 min&lt;/p&gt;

&lt;p&gt;OpenJPA-20x-deploy: Build #23 (Nov 5, 2010 7:14:48 PM): OpenJPA Persistence JDBC: 10 min&lt;/p&gt;

&lt;p&gt;As seen above, the trunk build executes much slower than the 2.0.x build yet the number of tests is roughly the same and there are no significant differences in execution times of modules that do not touch database.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://openjpa.208410.n2.nabble.com/Slow-JDBC-test-suite-tp5594040p5594040.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://openjpa.208410.n2.nabble.com/Slow-JDBC-test-suite-tp5594040p5594040.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12479325">OPENJPA-1876</key>
            <summary>Slow JDBC tests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="milosz">Milosz Tylenda</assignee>
                                    <reporter username="milosz">Milosz Tylenda</reporter>
                        <labels>
                    </labels>
                <created>Sun, 7 Nov 2010 17:56:40 +0000</created>
                <updated>Thu, 2 Feb 2012 17:00:23 +0000</updated>
                            <resolved>Mon, 24 Jan 2011 20:49:23 +0000</resolved>
                                    <version>2.1.0</version>
                                    <fixVersion>2.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12932598" author="curtisr7" created="Tue, 16 Nov 2010 18:51:18 +0000"  >&lt;p&gt;I looked at which tests are taking a long time this afternoon and came up with this list ... these are all 10+ seconds. I&apos;m not sure which of these can be attributed to the &apos;problem&apos; tests, but they are the longest running.&lt;/p&gt;

&lt;p&gt;Name									                                               Duration		Tests&lt;/p&gt;

&lt;p&gt;TestClearableScheduler   (org.apache.openjpa.persistence.datacache)   		3m:01s,088ms  1&lt;br/&gt;
TestQueryTimeout (org.apache.openjpa.persistence.query)   		   		49s,306ms 	12&lt;br/&gt;
TestDaytrader (org.apache.openjpa.integration.daytrader) 			   		42s,167ms 	1&lt;br/&gt;
TestTimeoutException (org.apache.openjpa.persistence.query) 			        30s,222ms 	3&lt;br/&gt;
TestSJVMCache (org.apache.openjpa.persistence.datacache) 			        24s,390ms 	30&lt;br/&gt;
TestDataCachePCDataGenerator (org.apache.openjpa.persistence.datacache) 	23s,567ms 	30&lt;br/&gt;
TestTypesafeCriteria (org.apache.openjpa.persistence.criteria) 			        22s,802ms 	100&lt;br/&gt;
TestEnhancementWithMultiplePUs (org.apache.openjpa.enhance) 			18s,864ms 	3&lt;br/&gt;
TestJPQLSubquery (org.apache.openjpa.persistence.criteria) 			        14s,346ms 	59&lt;br/&gt;
TestTypeSafeCondExpression (org.apache.openjpa.persistence.criteria) 		13s,267ms 	55&lt;br/&gt;
TestEmbeddable (org.apache.openjpa.persistence.embed) 				        10s,862ms 	26&lt;/p&gt;</comment>
                            <comment id="12932880" author="milosz" created="Wed, 17 Nov 2010 10:06:24 +0000"  >&lt;p&gt;Hi Rick. These are indeed the longest ones but in fact all database related tests are gradually slowed down.&lt;/p&gt;

&lt;p&gt;It might be related either to derby test profile or derby itself, since when I run the tests against another database, there is no slowdown.&lt;/p&gt;</comment>
                            <comment id="12979321" author="milosz" created="Sun, 9 Jan 2011 13:21:55 +0000"  >&lt;p&gt;The direct cause is DELETE statements (without WHERE clause) gradually become slow on Derby while a test case is executed and we issue a lot of DELETEs at the beginning of most test methods.&lt;/p&gt;

&lt;p&gt;The issue is related or caused by DBCP pooling auto-enablement because when I specify the properties in the old way:&lt;/p&gt;

&lt;p&gt;&amp;lt;property&amp;gt;&lt;br/&gt;
  &amp;lt;name&amp;gt;openjpa.jdbc.DriverDataSource&amp;lt;/name&amp;gt;&lt;br/&gt;
  &amp;lt;value&amp;gt;simple&amp;lt;/value&amp;gt;&lt;br/&gt;
&amp;lt;/property&amp;gt;&lt;br/&gt;
&amp;lt;dbcp.args&amp;gt;DriverClassName=org.apache.derby.jdbc.EmbeddedDriver,Url=jdbc:derby:target/database/openjpa-derby-database;create=true,Username=,Password=,MaxActive=10,MaxIdle=5,MinIdle=2,MaxWait=10000&amp;lt;/dbcp.args&amp;gt;&lt;br/&gt;
&amp;lt;connection.driver.name&amp;gt;org.apache.commons.dbcp.BasicDataSource&amp;lt;/connection.driver.name&amp;gt;&lt;/p&gt;

&lt;p&gt;the execution time drops to the old level and JDBC log channel shows database and driver version as in 2.0.x branch.&lt;/p&gt;</comment>
                            <comment id="12982619" author="milosz" created="Mon, 17 Jan 2011 12:41:54 +0000"  >&lt;p&gt;Narrowing further, the issue happens because we set connection properties (e.g. JDBC driver class) in the main pom.xml differently after implementing DBCP pooling auto-enablement. This impacts automatic Derby shutdown when closing a data source. Although we have always had set DerbyDictionary.shutdownOnClose set to true, we were not shutting Derby down in our tests. After the properties changed, we started doing the shutdown and this is slowing DELETE statements (but why?). It looks like the shutdown might be a good option for user applications but not for unit tests. Setting DerbyDictionary.shutdownOnClose=false should resolve the issue.&lt;/p&gt;

&lt;p&gt;As for the lack of database and driver version message in the log, it is also caused by the properties change. However, it is quite a good thing here - it means OpenJPA is able to figure out DBDictionary class without connecting to the database.&lt;/p&gt;</comment>
                            <comment id="13198952" author="allee8285" created="Thu, 2 Feb 2012 17:00:23 +0000"  >&lt;p&gt;Close issue in preparation for 2.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12471355">OPENJPA-1764</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Nov 2010 18:51:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>162108</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7p0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>289022</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>