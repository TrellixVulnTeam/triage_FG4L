<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:36:37 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-401/OPENJPA-401.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-401] UnsatisfiedLinkError in MappingToolTask when using DB2 JDBC driver </title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-401</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;The MappingToolTask&apos;s class resolver loads classes from a temporary classloader before loading them in the &quot;normal&quot; classloader. This can cause problems if the JDBC driver requires access to native libraries (which can only be loaded once). &lt;/p&gt;

&lt;p&gt;I&apos;ve seen errors like this when using the DB2 JCC driver and the IBM JDK : &lt;/p&gt;

&lt;p&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 608  persistence-tests  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Tool - Recording mapping and schema changes.&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; java.lang.UnsatisfiedLinkError: com/ibm/jvm/Trace.initTrace([Ljava/lang/String;[Ljava/lang/String;)V&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at com.ibm.jvm.Trace.initializeTrace(Trace.java:96)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at com.ibm.jvm.Trace.&amp;lt;clinit&amp;gt;(Trace.java:61)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.J9VMInternals.initializeImpl(Native Method)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.J9VMInternals.initialize(J9VMInternals.java:192)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.Class.forNameImpl(Native Method)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.Class.forName(Class.java:130)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at com.ibm.db2.jcc.c.o.q(o.java:550)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at com.ibm.db2.jcc.c.o.&amp;lt;clinit&amp;gt;(o.java:319)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.J9VMInternals.initializeImpl(Native Method)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.J9VMInternals.initialize(J9VMInternals.java:192)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.Class.forNameImpl(Native Method)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.Class.forName(Class.java:130)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at com.ibm.db2.jcc.DB2Driver.class$(DB2Driver.java:48)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at com.ibm.db2.jcc.DB2Driver.&amp;lt;clinit&amp;gt;(DB2Driver.java:51)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.J9VMInternals.initializeImpl(Native Method)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.J9VMInternals.initialize(J9VMInternals.java:192)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.Class.forNameImpl(Native Method)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at java.lang.Class.forName(Class.java:163)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt;     at org.apache.openjpa.jdbc.schema.DataSourceFactory.newDataSource(DataSourceFactory.java:82)&lt;/p&gt;

&lt;p&gt; &amp;lt;snip&amp;gt;&lt;/p&gt;

&lt;p&gt;Note that this does not occur with the Sun JDK (or at least I haven&apos;t hit the problem.&lt;/p&gt;

&lt;p&gt;A potential solution is to change the order of the classloaders used in MappingToolTask.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12380246">OPENJPA-401</key>
            <summary>UnsatisfiedLinkError in MappingToolTask when using DB2 JDBC driver </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikedd">Michael Dick</assignee>
                                    <reporter username="mikedd">Michael Dick</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Oct 2007 16:35:41 +0100</created>
                <updated>Tue, 5 Feb 2008 19:08:23 +0000</updated>
                            <resolved>Tue, 5 Feb 2008 19:08:23 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>1.0.1</fixVersion>
                    <fixVersion>1.0.2</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12546458" author="mprudhom" created="Wed, 28 Nov 2007 22:53:38 +0000"  >&lt;p&gt;I&apos;m reopening this because the fix was causing intermittent failures in loading metadata. E.g.:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;mappingtool&amp;#93;&lt;/span&gt; &amp;lt;openjpa-1.1.0-SNAPSHOT-r420667:598829 fatal user error&amp;gt; org.apache.openjpa.util.MetaDataException: Type &quot;class kodo.performance.PerfMultiA&quot; does not have persistence metadata.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;mappingtool&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.meta.MappingTool.getMapping(MappingTool.java:679)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;mappingtool&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.meta.MappingTool.refresh(MappingTool.java:716)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;mappingtool&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.meta.MappingTool.run(MappingTool.java:641)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;mappingtool&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.meta.MappingTool.run(MappingTool.java:1072)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;mappingtool&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.ant.MappingToolTask.executeOn(MappingToolTask.java:197)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;mappingtool&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.lib.ant.AbstractTask.execute(AbstractTask.java:172)&lt;/p&gt;

&lt;p&gt;I&apos;ve committed revision #599178 which swaps the order in which the child loaders are added to the MultiLoaderClassResolver, which seems to fix the problem, but I don&apos;t know if it will re-introduce the original symptoms reported in the bug. Michael, can you check with this new revision to see if it still works with your DB2 native driver?&lt;/p&gt;</comment>
                            <comment id="12546808" author="mikedd" created="Thu, 29 Nov 2007 17:16:32 +0000"  >&lt;p&gt;Unfortunately I do still see the problem. I haven&apos;t re-verified that it only occurs with the IBM JDK though (I&apos;ll try that later). &lt;/p&gt;

&lt;p&gt;In the mean time I wrote a quick patch which adds a configuration option to disable the temporary classloader for the mappingToolTask - which might be a palatable interim solution. &lt;/p&gt;</comment>
                            <comment id="12564138" author="pcl" created="Wed, 30 Jan 2008 19:28:07 +0000"  >&lt;p&gt;What&apos;s the status of this issue?&lt;/p&gt;</comment>
                            <comment id="12565852" author="mikedd" created="Tue, 5 Feb 2008 19:08:23 +0000"  >&lt;p&gt;The MappingToolTask now includes a flag which can be used to disable the temporary classloader, similarly to the PCEnhancerTask. If the flag is not specified then we&apos;ll use the temporary classloader (original behavior). &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12370559" name="OPENJPA-401.patch.txt" size="2936" author="mikedd" created="Thu, 29 Nov 2007 17:16:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 28 Nov 2007 22:53:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160723</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7klb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>288306</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>