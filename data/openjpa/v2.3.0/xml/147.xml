<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:34:34 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-147/OPENJPA-147.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-147] &lt;T&gt; T OpenJPAEntityManager.createInstance(Class&lt;T&gt; cls) fails when T is interface</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-147</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;According to JavaDoc, OpenJPAEntityManager.createInstance() method &lt;br/&gt;
       public &amp;lt;T&amp;gt; T createInstance(Class&amp;lt;T&amp;gt; cls);&lt;br/&gt;
     behaves as follows:&lt;/p&gt;

&lt;p&gt;&quot;Create a new instance of type &amp;lt;code&amp;gt;cls&amp;lt;/code&amp;gt;. If &amp;lt;code&amp;gt;cls&amp;lt;/code&amp;gt; is&lt;br/&gt;
  an interface or an abstract class whose abstract methods follow the&lt;br/&gt;
  JavaBeans convention, this method will create a concrete implementation&lt;br/&gt;
  according to the metadata that defines the class&quot;&lt;/p&gt;

&lt;p&gt;The method fails when T is an interface. The failure may be due to incorrect user configuration, however, further&lt;br/&gt;
information on this extension method is not available in OpenJPA documentation.&lt;/p&gt;

&lt;p&gt;Firstly, how to specify metadata for a interface that has bean-style methods? &lt;br/&gt;
Possibilities are:&lt;br/&gt;
a) Annotating the Java interface definition with @Entity &lt;br/&gt;
b) Specifying in &amp;lt;class&amp;gt;org.acme.IPerson&amp;lt;/class&amp;gt; in persistence.xml&lt;/p&gt;

&lt;p&gt;Either of the above fails. a) fails at parsing b) fails with &quot;no metadata&quot; &lt;/p&gt;

&lt;p&gt;There may be a correct but undocumented way of specifying a managed interface. If that is the case, then this JIRA report should be treated as a documentation bug. &lt;/p&gt;
</description>
                <environment></environment>
        <key id="12362818">OPENJPA-147</key>
            <summary>&lt;T&gt; T OpenJPAEntityManager.createInstance(Class&lt;T&gt; cls) fails when T is interface</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ppoddar@apache.org">Pinaki Poddar</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Feb 2007 18:17:49 +0000</created>
                <updated>Tue, 9 Mar 2010 18:32:30 +0000</updated>
                            <resolved>Tue, 15 Jan 2008 21:51:31 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                    <component>jpa</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12473224" author="clr" created="Wed, 14 Feb 2007 22:06:44 +0000"  >&lt;p&gt;&amp;gt;Firstly, how to specify metadata for a interface that has bean-style methods? &lt;br/&gt;
&amp;gt;Possibilities are: &lt;br/&gt;
&amp;gt;a) Annotating the Java interface definition with @Entity &lt;br/&gt;
&amp;gt;b) Specifying in &amp;lt;class&amp;gt;org.acme.IPerson&amp;lt;/class&amp;gt; in persistence.xml &lt;/p&gt;

&lt;p&gt;&amp;gt;Either of the above fails. a) fails at parsing b) fails with &quot;no metadata&quot; &lt;/p&gt;

&lt;p&gt;With a), does the failure occur in OpenJPA code, or does the compiler complain? What is the stack trace?&lt;/p&gt;

&lt;p&gt;With b), did you provide metadata as a file, in addition to referring to the interface in persistence.xml?&lt;/p&gt;</comment>
                            <comment id="12473293" author="ppoddar@apache.org" created="Thu, 15 Feb 2007 02:51:02 +0000"  >&lt;p&gt;I have attached four trial-and-error scenarios &lt;/p&gt;

&lt;p&gt;Condition (a) is Java interface is annotated with @Entity and condition (b) is &amp;lt;class&amp;gt;IPerson&amp;lt;/class&amp;gt; specified in persistence.xml.&lt;/p&gt;

&lt;p&gt;Case 1 (iface.trace.1.txt) both (a) and (b) are true : NPE in AnnotationPersistenceMetaDataParser.parseCallbackMethods() &lt;br/&gt;
Case 2: (iface.trace.2.txt) not (a) but (b) : Metadata not found&lt;br/&gt;
Case 3:(iface.trace.3.txt)  (a) but not (b) : NPE in AnnotationPersistenceMetaDataParser.parseCallbackMethods() &lt;/p&gt;

&lt;p&gt;Case 4: As I plug the NPE during parsing, and keep both (a) and (b) then the code proceeds further to fail within Enhancer. &lt;/p&gt;</comment>
                            <comment id="12473536" author="clr" created="Thu, 15 Feb 2007 22:22:56 +0000"  >&lt;p&gt;Could you please attach the java definition of test.IPerson and the contents of META-INF/orm.xml to this issue?&lt;/p&gt;</comment>
                            <comment id="12473539" author="ppoddar@apache.org" created="Thu, 15 Feb 2007 22:28:26 +0000"  >&lt;p&gt;The Java interface definition is attached. I did not use an orm.xml.&lt;/p&gt;</comment>
                            <comment id="12557792" author="pcl" created="Thu, 10 Jan 2008 20:46:34 +0000"  >&lt;p&gt;The recent commit adds support for this feature, but currently requires that the developer annotate interfaces with @ManagedInterface to enable the feature. Is this appropriate? Any other ideas for configuration / interfaces?&lt;/p&gt;

&lt;p&gt;One problem with @ManagedInterface is that it isn&apos;t intuitive for abstract class support. Perhaps we should decide how we eventually want to support abstract classes and see if we can make our managed interface support take that into account.&lt;/p&gt;</comment>
                            <comment id="12557843" author="ppoddar@apache.org" created="Thu, 10 Jan 2008 23:20:44 +0000"  >&lt;p&gt;Excellent!&lt;/p&gt;

&lt;p&gt;But something I am still missing once I changed to new @ManagedInterface&lt;/p&gt;

&lt;p&gt;Here is an Interface:&lt;br/&gt;
===================================================&lt;br/&gt;
package jira147;&lt;/p&gt;

&lt;p&gt;import org.apache.openjpa.persistence.ManagedInterface;&lt;/p&gt;

&lt;p&gt;@ManagedInterface&lt;br/&gt;
public interface IPerson &lt;/p&gt;
{
	public String getName();
	public void setName(String name);
}
&lt;p&gt;=====================================================&lt;br/&gt;
Here is a test methood&lt;/p&gt;

&lt;p&gt;	public void testNewInstance() &lt;/p&gt;
{
		EntityManager em = emf.createEntityManager();
		OpenJPAEntityManager oem = (OpenJPAEntityManager)em;
		Object ipc = oem.createInstance(IPerson.class);
		oem.getTransaction().begin();
		oem.persist(ipc);
		oem.getTransaction().commit();
	}
&lt;p&gt;=====================================================&lt;br/&gt;
Here is a persistence unit&lt;/p&gt;

&lt;p&gt;&amp;lt;persistence-unit name=&quot;test&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;class&amp;gt;jira147.IPerson&amp;lt;/class&amp;gt;&lt;br/&gt;
        &amp;lt;properties&amp;gt;&lt;br/&gt;
            &amp;lt;property name=&quot;openjpa.ConnectionDriverName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;property name=&quot;openjpa.ConnectionURL&quot; value=&quot;jdbc:mysql://localhost/openjpa&quot;/&amp;gt;&lt;br/&gt;
      	&amp;lt;/properties&amp;gt;&lt;br/&gt;
   &amp;lt;/persistence-unit&amp;gt;&lt;br/&gt;
====================================================&lt;br/&gt;
Here is the console&lt;br/&gt;
Using OpenJPA 420667:610924&lt;br/&gt;
62  test  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Runtime - Starting OpenJPA 1.1.0-SNAPSHOT&lt;br/&gt;
=======================================================&lt;br/&gt;
Here is the Stack Trace&lt;/p&gt;

&lt;p&gt;java.lang.IllegalArgumentException: No registered metadata for type &quot;interface jira147.IPerson&quot;.&lt;br/&gt;
	at org.apache.openjpa.enhance.PCRegistry.getMeta(PCRegistry.java:255)&lt;br/&gt;
	at org.apache.openjpa.enhance.PCRegistry.newInstance(PCRegistry.java:111)&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.newInstance(BrokerImpl.java:4167)&lt;br/&gt;
	at org.apache.openjpa.kernel.DelegatingBroker.newInstance(DelegatingBroker.java:1358)&lt;br/&gt;
	at org.apache.openjpa.persistence.EntityManagerImpl.createInstance(EntityManagerImpl.java:1068)&lt;br/&gt;
	at jira147.TestInterface.testNewInstance(TestInterface.java:22)&lt;/p&gt;
</comment>
                            <comment id="12557877" author="pcl" created="Fri, 11 Jan 2008 01:20:36 +0000"  >&lt;p&gt;You need to list the interface (IPerson) in the persistence unit.&lt;/p&gt;

&lt;p&gt;I assume (but have not tested) that existing auto-scanning techniques would also work.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="12386312">OPENJPA-486</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12385941">OPENJPA-481</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12351291" name="IPerson.java" size="157" author="ppoddar@apache.org" created="Thu, 15 Feb 2007 22:28:26 +0000"/>
                            <attachment id="12351207" name="TestInterface.java" size="704" author="ppoddar@apache.org" created="Thu, 15 Feb 2007 02:44:09 +0000"/>
                            <attachment id="12351203" name="iface.trace.1.txt" size="10434" author="ppoddar@apache.org" created="Thu, 15 Feb 2007 02:43:17 +0000"/>
                            <attachment id="12351204" name="iface.trace.2.txt" size="7885" author="ppoddar@apache.org" created="Thu, 15 Feb 2007 02:43:26 +0000"/>
                            <attachment id="12351205" name="iface.trace.3.txt" size="74482" author="ppoddar@apache.org" created="Thu, 15 Feb 2007 02:43:37 +0000"/>
                            <attachment id="12351206" name="iface.trace.4.txt" size="10645" author="ppoddar@apache.org" created="Thu, 15 Feb 2007 02:43:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 14 Feb 2007 22:06:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hysvzr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>202531</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>