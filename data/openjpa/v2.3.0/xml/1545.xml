<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:31:52 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1545/OPENJPA-1545.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1545] Add new Detach processing</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1545</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;There have been a number of mailing list posts where the net of the post is that someone doesn&apos;t want OpenJPA to detach their Entities because after the commit happens, then are all going to be gc&apos;d. All of the detach processing ends up being a waste.  I also observed this same behavior when running some performance tests.&lt;/p&gt;

&lt;p&gt;With this JIRA I&apos;m going to add a new openjpa.DetachState configuration option which will enable a new, super fast, minimalistic detach approach. This change is targeted at detach processing that happens due to an AutoDetach. Explicit detaches(ie: em.detach(..) ) will work as they always have before.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12457801">OPENJPA-1545</key>
            <summary>Add new Detach processing</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="curtisr7">Rick Curtis</assignee>
                                    <reporter username="curtisr7">Rick Curtis</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 Mar 2010 23:24:47 +0000</created>
                <updated>Tue, 21 Feb 2012 20:18:55 +0000</updated>
                            <resolved>Sat, 10 Apr 2010 18:40:11 +0100</resolved>
                                    <version>2.0.0-beta2</version>
                                    <fixVersion>2.0.0</fixVersion>
                                    <component>performance</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12839916" author="curtisr7" created="Mon, 1 Mar 2010 23:25:52 +0000"  >&lt;p&gt;Attaching a patch with a bulk of the detach changes. There is still some work to be done, but I wanted to get some input before going too far along with this.&lt;/p&gt;</comment>
                            <comment id="12840821" author="curtisr7" created="Wed, 3 Mar 2010 19:22:47 +0000"  >&lt;p&gt;Committed code changes, a simple UT, and doc to trunk. At this point I have a very basic unit test showing that I didn&apos;t break anything major.&lt;/p&gt;</comment>
                            <comment id="12840822" author="curtisr7" created="Wed, 3 Mar 2010 19:23:09 +0000"  >&lt;p&gt;Committed code changes, doc, and a simple UT to trunk.&lt;/p&gt;

&lt;p&gt;Additional unit tests still need to be created. &lt;/p&gt;</comment>
                            <comment id="12841918" author="curtisr7" created="Fri, 5 Mar 2010 16:33:34 +0000"  >&lt;p&gt;Ideally this detach area could use some refactoring. Hopefully I&apos;ll get back to this next week.&lt;/p&gt;</comment>
                            <comment id="12842697" author="drwoods" created="Mon, 8 Mar 2010 15:30:08 +0000"  >&lt;p&gt;code is being checked into 2.0.0, so updating affects/fix version to reflect that&lt;/p&gt;</comment>
                            <comment id="12844226" author="pcl" created="Thu, 11 Mar 2010 20:40:01 +0000"  >&lt;p&gt;At first glance, I&apos;d expect the &apos;loaded&apos; detach mode to be pretty optimal &amp;#8211; what is it doing that&apos;s causing headaches?&lt;/p&gt;</comment>
                            <comment id="12845903" author="ppoddar@apache.org" created="Tue, 16 Mar 2010 13:52:16 +0000"  >&lt;p&gt;Revision 918634 has added new version field to persistent entities for detach tests. &lt;br/&gt;
What are the assumptions made in the new detach technique that required these entities be added with a version field? If an entity does not have a version field how will be its impact?&lt;/p&gt;</comment>
                            <comment id="12845998" author="curtisr7" created="Tue, 16 Mar 2010 17:01:07 +0000"  >&lt;p&gt;@Pinaki - Per the doc that was committed in 918643: &quot;...It is highly recommended that all Entities have a @Version field when using this property.&quot; &lt;/p&gt;

&lt;p&gt;On second thought, I probably need to make having a version field a requirement. The version field is used when we calculate whether or not a given Entity is detached when there is no state manager present. &lt;/p&gt;

&lt;p&gt;@Patrick - Sorry I missed your update before. From a high level this change can be described as, &quot;OpenJPA give me my POJOs back.&quot; We found that the loaded setting does a fair amount of work validating that fields that should be loaded actually are. I short cut that entire path and completed the minimum amount of work to disassociate an Entity from the PersistenceContext. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://n2.nabble.com/Extreme-performance-problems-with-OpenJPA-commit-td4497009.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://n2.nabble.com/Extreme-performance-problems-with-OpenJPA-commit-td4497009.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12849257" author="ppoddar@apache.org" created="Wed, 24 Mar 2010 16:17:07 +0000"  >&lt;p&gt;The recommendation to add a version field is OK &lt;br/&gt;
&amp;#8211; but what happens with this lite detachment when an entity does not use a version field? &lt;br/&gt;
  Can I merge() the object graph back when this detach lite was used with some entities without a version field? &lt;/p&gt;

&lt;p&gt;If yes, why did the test persistent entities that worked before this change without version field required addition of a version field?&lt;br/&gt;
If no, how does that discrepancy manifest in the user application code &amp;#8211; does this new mechanics detect and raise an exception when it meets an unversioned entity &amp;#8211; &lt;br/&gt;
or does such usage violate data integrity silently? Do we have a test that shows such behavior?&lt;/p&gt;

</comment>
                            <comment id="12853418" author="curtisr7" created="Mon, 5 Apr 2010 17:10:34 +0100"  >&lt;p&gt;&amp;gt; Can I merge() the object graph back when this detach lite was used with some entities without a version field? &lt;br/&gt;
Yes.&lt;/p&gt;

&lt;p&gt;&amp;gt; If yes, why did the test persistent entities that worked before this change without version field required addition of a version field? &lt;br/&gt;
I&apos;m guessing that adding the @Version field is a good(/bad) habit that I&apos;ve got myself into. I did some testing and I can remove the @Version field, but I would need to change one assertion in the new testcase. When there is no version field and no detached state field, the Entity doesn&apos;t know whether is is detached or not(PersistenceCapable.pcIsDetached()). The OpenJPA runtime is able to determine whether or not the Entity exists by hitting to the db looking for the Entities id. see BrokerImpl.isDetached(Object o);&lt;/p&gt;</comment>
                            <comment id="12855611" author="drwoods" created="Sat, 10 Apr 2010 18:40:11 +0100"  >&lt;p&gt;Code checked into 2.0.0, so marking it resolved for the release notes.&lt;br/&gt;
If more work is required, please open a new issue and link it to this one.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12543556">OPENJPA-2136</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12437537" name="OPENJPA-1545.patch" size="6944" author="curtisr7" created="Mon, 1 Mar 2010 23:25:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Mar 2010 15:30:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161808</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyt6dr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204214</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>