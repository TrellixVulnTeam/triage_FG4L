<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:32:28 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-250/OPENJPA-250.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-250] Reduce synchronization bottlenecks in data cache, metadata repository, and lifecycle event manager</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-250</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Parts of the data cache, metadata repository, and lifecycle event manager are over-synchcronized. This should be resolved.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12370884">OPENJPA-250</key>
            <summary>Reduce synchronization bottlenecks in data cache, metadata repository, and lifecycle event manager</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="curtisr7">Rick Curtis</assignee>
                                    <reporter username="pcl">Patrick Linskey</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Jun 2007 02:00:24 +0100</created>
                <updated>Tue, 9 Mar 2010 18:31:00 +0000</updated>
                            <resolved>Tue, 6 Oct 2009 13:52:47 +0100</resolved>
                                    <version>0.9.0</version>
                    <version>0.9.6</version>
                    <version>0.9.7</version>
                    <version>1.0.3</version>
                    <version>1.1.0</version>
                    <version>1.2.1</version>
                    <version>2.0.0-M2</version>
                                    <fixVersion>1.2.2</fixVersion>
                    <fixVersion>2.0.0-beta</fixVersion>
                                    <component>build / infrastructure</component>
                    <component>datacache</component>
                    <component>jdbc</component>
                    <component>kernel</component>
                    <component>lib</component>
                    <component>query</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12501423" author="pcl" created="Tue, 5 Jun 2007 02:20:09 +0100"  >&lt;p&gt;This patch addresses the synchronization issues, and also replaces the OpenJPA-repackaged copies of Doug Lea&apos;s concurrent classes with a dependency on the backport-util-concurrent classes.&lt;/p&gt;</comment>
                            <comment id="12501424" author="pcl" created="Tue, 5 Jun 2007 02:20:49 +0100"  >&lt;p&gt;This patch addresses the synchronization issues, and also replaces the OpenJPA-repackaged copies of Doug Lea&apos;s concurrent classes with a dependency on the backport-util-concurrent classes.&lt;/p&gt;</comment>
                            <comment id="12518211" author="pcl" created="Tue, 7 Aug 2007 19:00:39 +0100"  >&lt;p&gt;Improvements have been made in this arena, but  there is more to do.&lt;/p&gt;</comment>
                            <comment id="12727793" author="sdroscher" created="Mon, 6 Jul 2009 22:31:35 +0100"  >&lt;p&gt;We found that caching performance hits a bottleneck with threads blocking on MetaDataRepository.getMetaData(). The changes in this issue looked to be the kind of thing that would help, but the original patch was for OpenJPA 0.9.x and a lot has changed in the code since then. Much of the patch was getting rid of classes in the org.apache.openjpa.lib.util.concurrent package and using edu.emory.mathcs.backport.java.util.concurrent classes instead. This looks to have been done at some other time in the code, using the standard java.util.concurrent package instead.&lt;/p&gt;

&lt;p&gt;So I went through all the code affected by the original patch and made similar changes as appropriate, basically changing a lot of synchronized methods to use  blocks that lock and unlock using the ReentrantReadWriteLock() and  ReentrantLock() classes.&lt;/p&gt;

&lt;p&gt;The resultant patch file is attached. This was found to give a much more scalable performance, we no longer have threads blocked on MetaDataRepository.getMetaData().&lt;/p&gt;</comment>
                            <comment id="12758221" author="drwoods" created="Tue, 22 Sep 2009 13:10:37 +0100"  >&lt;p&gt;Updating Affects, Fix and assignee values, given Curtis has checked this into trunk.&lt;/p&gt;</comment>
                            <comment id="12758885" author="sdroscher" created="Wed, 23 Sep 2009 22:33:15 +0100"  >&lt;p&gt;Any chance of this making it into 1.2.2 or 1.3.0 ?&lt;/p&gt;</comment>
                            <comment id="12759120" author="mikedd" created="Thu, 24 Sep 2009 14:47:21 +0100"  >&lt;p&gt;Merging to 1.3.0 can be done, but I&apos;m not ready to introduce it in 1.2.2 - synchronization changes make me nervous. &lt;/p&gt;</comment>
                            <comment id="12761285" author="ppoddar@apache.org" created="Thu, 1 Oct 2009 18:53:21 +0100"  >&lt;p&gt;1. Uses non-localized messages.&lt;br/&gt;
2. preLoad and noLock are not documented&lt;/p&gt;</comment>
                            <comment id="12787737" author="curtisr7" created="Tue, 8 Dec 2009 20:45:48 +0000"  >&lt;p&gt;Shortly here I&apos;m going to commit changes to this JIRA and I&apos;d like to explain them before I pull the trigger...&lt;/p&gt;

&lt;p&gt;In doing some performance testing on trunk, we found that java.util.concurrent.lock.ReentrantLocks do not scale nearly as well as java synchronization. A 5% regression was observed on an 8-way and a ~20% regression was observed on a 16-way machine when using j.u.c.l.ReentrantLocks rather than the synchronized keyword. When openjpa.MetaDataRepository=Preload=true is configured this regression is gone, and a modest performance improvement is observed. &lt;/p&gt;

&lt;p&gt;The performance (or the lack thereof) of j.u.c.l.ReentrantLock is being pursued by the JDK team, but in the meantime I&apos;m committing a change that will do the following:&lt;br/&gt;
1.) Give us our previous &apos;default&apos; performance.&lt;br/&gt;
2.) Allow a user to configure the MDR to use no locks to improve scalability/performance.&lt;/p&gt;</comment>
                            <comment id="12798817" author="curtisr7" created="Mon, 11 Jan 2010 19:37:53 +0000"  >&lt;p&gt;Committed revision 898024 to trunk. This commit comes with the same comment that I noted for the 1.2 branch.&lt;/p&gt;</comment>
                            <comment id="12798819" author="curtisr7" created="Mon, 11 Jan 2010 19:40:31 +0000"  >&lt;p&gt;Sorry Mike, looks like I axed your last update!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12421889" name="OPENJPA-250-1.0.x.patch" size="6855" author="fyrewyld" created="Mon, 12 Oct 2009 19:36:48 +0100"/>
                            <attachment id="12358915" name="OPENJPA-250.patch" size="308727" author="pcl" created="Tue, 5 Jun 2007 02:20:49 +0100"/>
                            <attachment id="12412655" name="sync-121.patch" size="59298" author="sdroscher" created="Mon, 6 Jul 2009 22:31:35 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 6 Jul 2009 21:31:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160578</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hysw8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>202572</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>