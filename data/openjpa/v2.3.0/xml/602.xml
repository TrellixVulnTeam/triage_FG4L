<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:37:41 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-602/OPENJPA-602.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-602] NullPointerException at org.apache.openjpa.jdbc.meta.strats.RelationToManyInverseKeyFieldStrategy.map</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-602</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;The example I&apos;ll attach crashes with an NPE when running the mappingtool.&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.strats.RelationToManyInverseKeyFieldStrategy.map(RelationToManyInverseKeyFieldStrategy.java:136)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.strats.RelationCollectionInverseKeyFieldStrategy.map(RelationCollectionInverseKeyFieldStrategy.java:95)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.FieldMapping.setStrategy(FieldMapping.java:120)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.RuntimeStrategyInstaller.installStrategy(RuntimeStrategyInstaller.java:80)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.FieldMapping.resolveMapping(FieldMapping.java:438)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.FieldMapping.resolve(FieldMapping.java:403)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.ClassMapping.resolveMapping(ClassMapping.java:812)&lt;/p&gt;

&lt;p&gt;The goal of this JIRA is not (neccessarily) to support the kind of mapping that would be required for this (which may be hard), but to at least print a clear error and not an NPE...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12396006">OPENJPA-602</key>
            <summary>NullPointerException at org.apache.openjpa.jdbc.meta.strats.RelationToManyInverseKeyFieldStrategy.map</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ppoddar@apache.org">Pinaki Poddar</assignee>
                                    <reporter username="vorburger">Michael Vorburger</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 May 2008 10:51:23 +0100</created>
                <updated>Tue, 9 Mar 2010 18:32:51 +0000</updated>
                            <resolved>Thu, 19 Jun 2008 17:26:32 +0100</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.2.0</fixVersion>
                                    <component>jdbc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12596698" author="vorburger" created="Wed, 14 May 2008 10:54:53 +0100"  >&lt;p&gt;----&lt;del&gt;Original Message&lt;/del&gt;----&lt;br/&gt;
From: Michael Vorburger &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:mvorburger@odyssey-group.com&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;mvorburger@odyssey-group.com&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;br/&gt;
Sent: mercredi, 30. avril 2008 17:07&lt;br/&gt;
To: users@openjpa.apache.org; dev@openjpa.apache.org&lt;br/&gt;
Subject: NPE at RelationToManyInverseKeyFieldStrategy when using mappedBy inverse&lt;/p&gt;

&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I&apos;m running into an NPE in RelationToManyInverseKeyFieldStrategy&lt;br/&gt;
(copy/pasted below) when using an OneToMany inverse relation with mappedBy and InheritanceType.TABLE_PER_CLASS in 1.1.0-SNAPSHOT...&lt;/p&gt;

&lt;p&gt;Test summary: A common abstract superclass Translatable which has a @OneToManySet&amp;lt;Translation&amp;gt;, and many subclasses of that like e.g. a SomethingTranslatable, and many more.  The idea is that mapping should lead to a Translation table holding the items for SomethingTranslatable and all other superclasses.  Then SomethingTranslatable and many other tables (no physical Translatable table).  There shouldn&apos;t be a join table for each SomethingTranslatable, as it&apos;s a OneToManySet, it doesn&apos;t make sense, so the owning side is a @ManyToOne in Translation back to Translatable.  Granted a physical FK will not be possible in such a schema - accepted, but it should still be possible to map this?  It works until I use @Inheritance(strategy = InheritanceType.TABLE_PER_CLASS) on Translatable, with it - boum, NPE.&lt;/p&gt;</comment>
                            <comment id="12597408" author="vorburger" created="Fri, 16 May 2008 10:57:29 +0100"  >&lt;p&gt;----&lt;del&gt;Original Message&lt;/del&gt;----&lt;br/&gt;
From: Fay Wang &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:fyw300@yahoo.com&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;fyw300@yahoo.com&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;br/&gt;
Sent: jeudi, 15. mai 2008 00:52&lt;br/&gt;
To: users@openjpa.apache.org; dev@openjpa.apache.org&lt;br/&gt;
Subject: RE: NPE at RelationToManyInverseKeyFieldStrategy when using mappedBy inverse&lt;/p&gt;

&lt;p&gt;Here is my finding: The NPE problem is the combination of (1) abstract class, (2) inheritance strategy of TABLE_PER_CLASS, and (3) toMany relationship. When you have (1) and (2), or (1) and (3), or (2) and (3), you will be fine.  However, when the three things are put together, the class strategy of this entity class becomes NoneClassStrategy (since abstract class with inheritance strategy of TABLE_PER_CLASS will not have a corresponding database table). With NoneClassStrategy, the foreign key required for the toMany relationship will not be constructed, resulting in NPE. I am not clear whether JPA spec ever mentioned that no relation fields in the abstract class when inheritance strategy is table per concrete class. If not, this seems to be a bug in OpenJPA.&lt;/p&gt;

&lt;p&gt;@Entity&lt;br/&gt;
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS) public abstract class EntityA { &lt;/p&gt;

&lt;p&gt;    @Id&lt;br/&gt;
    @GeneratedValue&lt;br/&gt;
    private Long id;&lt;/p&gt;

&lt;p&gt;    @Version&lt;br/&gt;
    private Long version;&lt;/p&gt;

&lt;p&gt;    @OneToMany(cascade=CascadeType.PERSIST,&lt;br/&gt;
          mappedBy=&quot;entityA&quot;)&lt;br/&gt;
    private java.util.Set&amp;lt;EntityB&amp;gt; entityBs;&lt;/p&gt;

&lt;p&gt;    public java.util.Set&amp;lt;EntiytB&amp;gt; getEntityBs() &lt;/p&gt;
{
          return entityBs;
    }

&lt;p&gt;    public void setEntityBs(java.util.Set&amp;lt;EntityB&amp;gt; entityBs) &lt;/p&gt;
{
	  this.entityBs = entityBs;
    }
&lt;p&gt;  &lt;br/&gt;
  }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;If you only have (1) and (2), you will be fine because &lt;/p&gt;


&lt;p&gt;----&lt;del&gt;Original Message&lt;/del&gt;----&lt;br/&gt;
From: Fay Wang &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:fyw300@yahoo.com&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;fyw300@yahoo.com&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;br/&gt;
Sent: mercredi, 14. mai 2008 18:45&lt;br/&gt;
To: users@openjpa.apache.org; dev@openjpa.apache.org&lt;br/&gt;
Subject: RE: NPE at RelationToManyInverseKeyFieldStrategy when using mappedBy inverse&lt;/p&gt;

&lt;p&gt;I take it back. I found that when I put the fields and methods in EntityBase class directly in the Translatable class instead of having Translatable inherit from EntityBase class, I still get NPE. This problem seems having nothing to do with MappedSuperclass annotation.&lt;/p&gt;

&lt;p&gt;-Fay&lt;/p&gt;

&lt;p&gt;----&lt;del&gt;Original Message&lt;/del&gt;----&lt;br/&gt;
From: Fay Wang &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:fyw300@yahoo.com&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;fyw300@yahoo.com&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;br/&gt;
Sent: mercredi, 14. mai 2008 18:23&lt;br/&gt;
To: users@openjpa.apache.org; dev@openjpa.apache.org&lt;br/&gt;
Subject: RE: NPE at RelationToManyInverseKeyFieldStrategy when using mappedBy inverse&lt;/p&gt;

&lt;p&gt;Hi Mike,&lt;br/&gt;
    Your super class EntityBase is annotated as @MappedSuperclass. Your Translatable class which inherits from EntityBase has inheritance strategy of TABLE_PER_CLASS. Since MappedSuperclass itself is not a persistence class and can not act in the capacity of an entity, it does not have a corresponding table in the database. I think this is why openjpa got confused and could not find foreign key between the parent class and the child class. When I removed Inheritance strategy annotation from Translatable class, your test case went through. Having said that, I think the NPE should be fixed and proper error message should be thrown.&lt;/p&gt;

&lt;p&gt;-Fay&lt;/p&gt;</comment>
                            <comment id="12602263" author="timkaltenbrunner" created="Wed, 4 Jun 2008 13:43:50 +0100"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I have the same problem at my current project. I have an existing database structure created with Kodo JDO. Now I want to use OpenJPA but keep the old database structure. Will someone fix this problem or will you only throw an exception. I am also not sure if the specification specifies that this case should be possible but JDO implementation do support it and therefore it would be nice to have it in OpenJPA . &lt;/p&gt;

&lt;p&gt;Cheers Tim&lt;/p&gt;</comment>
                            <comment id="12604032" author="ppoddar@apache.org" created="Tue, 10 Jun 2008 21:46:11 +0100"  >&lt;p&gt;SVN Revision 666314 &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;  addresses this issue. Used a modified version the attached patch as the domain model in a test case. &lt;br/&gt;
It will be helpful if the reporter can verify &lt;br/&gt;
        a) whether the newly added test case reflects the intended domain model &lt;br/&gt;
and b) whether the change resolves the original issue.&lt;/p&gt;

&lt;p&gt;Known limitation:&lt;br/&gt;
  As the root of persistent hierarchy is abstract and table-per-class strategy is being used, &lt;br/&gt;
 aggregate JPQL query e.g. &quot;SELECT COUNT(p) FROM Translatable p&quot; will not be possible &lt;br/&gt;
 because the concrete subclasses such as SomethingTranslatable or SomeOtherTranslatable are unjoined.&lt;/p&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=666314&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=666314&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12606440" author="ppoddar@apache.org" created="Thu, 19 Jun 2008 17:26:32 +0100"  >&lt;p&gt;SVN revision 666314.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12382033" name="FullStackTrace-OPENJPA-602.txt" size="3550" author="vorburger" created="Wed, 14 May 2008 10:53:39 +0100"/>
                            <attachment id="12382032" name="OneToMany-test.zip" size="112067" author="vorburger" created="Wed, 14 May 2008 10:52:01 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 4 Jun 2008 12:43:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160918</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7l1z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>288381</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>