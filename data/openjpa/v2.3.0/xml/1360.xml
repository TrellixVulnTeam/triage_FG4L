<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:46:27 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1360/OPENJPA-1360.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1360] ReverseMappingTool omits nullable, length, etc. when ClassMapping.setEmbedded(true) is called</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1360</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;In my ReverseCustomizer, I call classMapping.setEmbedded(true).  This is because for a variety of reasons I need the code that is generated by the ReverseMappingTool to be @MappedSuperclasses, not @Entities.&lt;/p&gt;

&lt;p&gt;Indeed when I do this, the resulting class is a @MappedSuperclass (great!) BUT all of the length and nullable and other @Column attributes are missing.  In other words, all simple fields receive only a @Basic annotation, with no attributes, and nothing else.  In addition, the class declaration receives a @Table annotation with no attributes.  (I&apos;m using the command line flag that instructs the ReverseMappingTool to generate annotations.)&lt;/p&gt;

&lt;p&gt;Ideally I&apos;d like the generated source code to look identical to the source code that would be generated for a ClassMapping where setEmbedded(true) was never called, except of course that I want the @Entity annotation to be replaced with @MappedSuperclass.&lt;/p&gt;

&lt;p&gt;Obviously if there is a better way from within a ReverseCustomizer for me to accomplish my (very odd) goals (mandated by a strange development process and a 30-year-old database), I am all ears.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12438938">OPENJPA-1360</key>
            <summary>ReverseMappingTool omits nullable, length, etc. when ClassMapping.setEmbedded(true) is called</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="drwoods">Donald Woods</assignee>
                                    <reporter username="ljnelson">Laird Nelson</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Oct 2009 16:53:05 +0100</created>
                <updated>Tue, 30 Mar 2010 00:17:47 +0100</updated>
                            <resolved>Mon, 8 Mar 2010 21:48:27 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0-beta3</fixVersion>
                                    <component>tooling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12770234" author="ljnelson" created="Mon, 26 Oct 2009 22:10:37 +0000"  >&lt;p&gt;It looks like, at least for the annotations path, AnnotationPersistenceMetaDataSerializer is the culprit.  At line 202 or thereabouts, in the isMappingMode(ClassMetaData meta) method, it includes a check to see if the supplied meta isEmbeddedOnly().  If it is, then there is nothing else you can do from the standpoint of your ReverseCustomizer: that metdata is deemed to NOT be in mapping mode.  That of course means that when the Java code is written out, all fields are output with only a @Basic annotation and nothing else.&lt;/p&gt;

&lt;p&gt;The (rather cumbersome) workaround is to subclass both this serializer and PersistenceMappingFactory and supply a PersistenceMappingFactory implementation that returns new instances of an AnnotationPersistenceMetaDataSerializer that is capable of omitting this isEmbeddedOnly() check from its own implementation of the isMappingMode(ClassMetaData meta) method.&lt;/p&gt;</comment>
                            <comment id="12770617" author="ljnelson" created="Tue, 27 Oct 2009 19:29:53 +0000"  >&lt;p&gt;Talking to myself it seems....  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve successfully implemented the workaround as described in my prior comment.&lt;/p&gt;

&lt;p&gt;The isMappingMode(ClassMetaData) method of my serializer now looks like this:&lt;/p&gt;

&lt;p&gt;@Override&lt;br/&gt;
public boolean isMappingMode(final ClassMetaData meta) &lt;/p&gt;
{
  return 
    this.isMappingMode() &amp;amp;&amp;amp; 
    (meta.getSourceMode() &amp;amp; MetaDataModes.MODE_MAPPING) != 0 &amp;amp;&amp;amp;
    (meta.getEmbeddingMetaData() == null || this.isMappingMode(meta.getEmbeddingMetaData()));
}</comment>
                            <comment id="12806487" author="ljnelson" created="Fri, 29 Jan 2010 20:28:31 +0000"  >&lt;p&gt;This bug is still present in openjpa 1.2.2, even with the new ClassMapping.isAbstract() method.&lt;/p&gt;</comment>
                            <comment id="12842755" author="drwoods" created="Mon, 8 Mar 2010 18:08:26 +0000"  >&lt;p&gt;Proposed patch based on 1.3.x changes.  Need to run a full set of junits and TCK before committing to trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12454972">OPENJPA-1492</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12438211" name="OPENJPA-1360-trunk.patch" size="1090" author="drwoods" created="Mon, 8 Mar 2010 18:08:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Mar 2010 18:08:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161629</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyt11z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>203351</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>