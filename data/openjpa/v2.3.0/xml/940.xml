<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:43:38 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-940/OPENJPA-940.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-940] Using table-generator in XML descriptor results in ClassCastException</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-940</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Defining a table generator in the XML descriptor leads to a class cast exception. The reason is a probably unintentional fall through of a switch/case block in class XMLPersistenceMetaDataSerializer line 502:&lt;/p&gt;

&lt;p&gt;...&lt;br/&gt;
            switch (type) {&lt;br/&gt;
                case TYPE_META:&lt;br/&gt;
                    serializeClass((ClassMetaData) obj, fieldAccess&lt;br/&gt;
                        &amp;amp;&amp;amp; propertyAccess);&lt;br/&gt;
                    break;&lt;br/&gt;
                case TYPE_SEQ:&lt;br/&gt;
                    if (isMappingMode())&lt;br/&gt;
                        serializeSequence((SequenceMetaData) obj);&lt;br/&gt;
                        // HERE SHOULD BE A break;&lt;br/&gt;
                case TYPE_QUERY:&lt;br/&gt;
                    serializeQuery((QueryMetaData) obj);&lt;br/&gt;
                    break;&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;As a result I get the following stack:&lt;/p&gt;

&lt;p&gt;219  testPU  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Runtime - Starting OpenJPA 1.2.0&lt;br/&gt;
688  testPU  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.JDBC - Using dictionary class &quot;org.apache.openjpa.jdbc.sql.DerbyDictionary&quot;.&lt;br/&gt;
3329  testPU  WARN   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.MetaData - Found duplicate generator &quot;tableGen&quot; in &quot;class com.daimler.tss.lab.jpa.pojo.Slave&quot;.  Ignoring.&lt;br/&gt;
3830  testPU  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.MetaData - Writing to file &quot;C:\Uli\Workspaces\TSS_ganymede_2\OpenJPA Test\build\classes\META-INF\test-orm.xml&quot;.&lt;br/&gt;
3986  testPU  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.MetaData - Writing sequence &quot;tableGen&quot;.&lt;br/&gt;
Exception in thread &quot;main&quot; &amp;lt;openjpa-1.2.0-r422266:683325 nonfatal general error&amp;gt; org.apache.openjpa.persistence.PersistenceException: org.apache.openjpa.jdbc.meta.SequenceMapping cannot be cast to org.apache.openjpa.meta.QueryMetaData&lt;br/&gt;
	at org.apache.openjpa.kernel.AbstractBrokerFactory.newBroker(AbstractBrokerFactory.java:196)&lt;br/&gt;
	at org.apache.openjpa.kernel.DelegatingBrokerFactory.newBroker(DelegatingBrokerFactory.java:142)&lt;br/&gt;
	at org.apache.openjpa.persistence.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:192)&lt;br/&gt;
	at org.apache.openjpa.persistence.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:145)&lt;br/&gt;
	at org.apache.openjpa.persistence.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:56)&lt;br/&gt;
	at com.daimler.tss.lab.jpa.test.RelationshipManagementTest.createMaster(RelationshipManagementTest.java:47)&lt;br/&gt;
	at com.daimler.tss.lab.jpa.test.RelationshipManagementTest.main(RelationshipManagementTest.java:39)&lt;br/&gt;
Caused by: java.lang.ClassCastException: org.apache.openjpa.jdbc.meta.SequenceMapping cannot be cast to org.apache.openjpa.meta.QueryMetaData&lt;br/&gt;
	at org.apache.openjpa.persistence.XMLPersistenceMetaDataSerializer.serialize(XMLPersistenceMetaDataSerializer.java:504)&lt;br/&gt;
	at org.apache.openjpa.lib.meta.XMLMetaDataSerializer.serialize(XMLMetaDataSerializer.java:257)&lt;br/&gt;
	at org.apache.openjpa.lib.meta.XMLMetaDataSerializer.serialize(XMLMetaDataSerializer.java:121)&lt;br/&gt;
	at org.apache.openjpa.lib.meta.XMLMetaDataSerializer.serialize(XMLMetaDataSerializer.java:90)&lt;br/&gt;
	at org.apache.openjpa.meta.AbstractCFMetaDataFactory.serialize(AbstractCFMetaDataFactory.java:479)&lt;br/&gt;
	at org.apache.openjpa.meta.AbstractCFMetaDataFactory.store(AbstractCFMetaDataFactory.java:234)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.MappingTool.record(MappingTool.java:538)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.MappingTool.record(MappingTool.java:453)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.JDBCBrokerFactory.synchronizeMappings(JDBCBrokerFactory.java:159)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.JDBCBrokerFactory.newBrokerImpl(JDBCBrokerFactory.java:119)&lt;br/&gt;
	at org.apache.openjpa.kernel.AbstractBrokerFactory.newBroker(AbstractBrokerFactory.java:189)&lt;br/&gt;
	... 6 more&lt;/p&gt;

&lt;p&gt;May I suggest to run findBugs on your source code. That would have found this section for sure. Does anyone test the XML descriptor stuff?&lt;/p&gt;</description>
                <environment>Windows XP&lt;br/&gt;
Java SE 6 Update 11</environment>
        <key id="12415537">OPENJPA-940</key>
            <summary>Using table-generator in XML descriptor results in ClassCastException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fancy">Catalina Wei</assignee>
                                    <reporter username="uhermse">Ulrich Hermsen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Feb 2009 07:58:07 +0000</created>
                <updated>Thu, 17 Feb 2011 14:11:48 +0000</updated>
                            <resolved>Thu, 17 Feb 2011 04:12:03 +0000</resolved>
                                    <version>1.2.0</version>
                    <version>2.0.0-M2</version>
                                    <fixVersion>2.1.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <timeoriginalestimate seconds="1200">20m</timeoriginalestimate>
                            <timeestimate seconds="1200">20m</timeestimate>
                                                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161238</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hysr0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>201726</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>