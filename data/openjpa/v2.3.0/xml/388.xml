<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:32:23 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-388/OPENJPA-388.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-388] MappingToolTask can&apos;t find persistence meta data. </title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-388</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Running the MappingToolTask causes an error like this : &lt;/p&gt;

&lt;p&gt;Buildfile: build.xml&lt;/p&gt;

&lt;p&gt;clean:&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;delete&amp;#93;&lt;/span&gt; Deleting directory /home/mikedd/workspaces/jpa/ant/target&lt;/p&gt;

&lt;p&gt;compile:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;mkdir&amp;#93;&lt;/span&gt; Created dir: /home/mikedd/workspaces/jpa/ant/target&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 1 source file to /home/mikedd/workspaces/jpa/ant/target&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;mkdir&amp;#93;&lt;/span&gt; Created dir: /home/mikedd/workspaces/jpa/ant/target/META-INF&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;copy&amp;#93;&lt;/span&gt; Copying 2 files to /home/mikedd/workspaces/jpa/ant/target/META-INF&lt;/p&gt;

&lt;p&gt;enhance:&lt;/p&gt;

&lt;p&gt;map:&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 87  persistence-tests  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.JDBC - Using dictionary class &quot;org.apache.openjpa.jdbc.sql.DerbyDictionary&quot;.&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 169  persistence-tests  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Tool - Mapping tool running on type &quot;class mdd.TestEntity&quot; with action &quot;buildSchema&quot;.&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; &amp;lt;openjpa-1.1.0-SNAPSHOT-r420667:580087 fatal user error&amp;gt; org.apache.openjpa.util.MetaDataException: Type &quot;class mdd.TestEntity&quot; does not have persistence metadata.&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.meta.MappingTool.getMapping(MappingTool.java:679)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.meta.MappingTool.buildSchema(MappingTool.java:745)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.meta.MappingTool.run(MappingTool.java:643)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.meta.MappingTool.run(MappingTool.java:1066)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.jdbc.ant.MappingToolTask.executeOn(MappingToolTask.java:194)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.openjpa.lib.ant.AbstractTask.execute(AbstractTask.java:172)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:275)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Task.perform(Task.java:364)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Target.execute(Target.java:341)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Target.performTasks(Target.java:369)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1216)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Project.executeTarget(Project.java:1185)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:40)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Project.executeTargets(Project.java:1068)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Main.runBuild(Main.java:668)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Main.startAnt(Main.java:187)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.launch.Launcher.run(Launcher.java:246)&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;mapping&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.launch.Launcher.main(Launcher.java:67)&lt;/p&gt;

&lt;p&gt;Running from the command line generates the expected result : &lt;/p&gt;

&lt;p&gt;52  persistence-tests  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.JDBC - Using dictionary class &quot;org.apache.openjpa.jdbc.sql.DerbyDictionary&quot;.&lt;br/&gt;
59  persistence-tests  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Tool - No targets were given.  Running on all classes listed in your configuration, or all persistent classes in the classpath if no classes are configured.  Use -help to display tool usage information.&lt;br/&gt;
130  persistence-tests  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Tool - Mapping tool running on type &quot;class mdd.TestEntity&quot; with action &quot;buildSchema&quot;.&lt;br/&gt;
343  persistence-tests  INFO   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Tool - Recording mapping and schema changes.&lt;/p&gt;

&lt;p&gt;The root problem here lies with the ant classloaders. The ant classloader appears to be unable to load the annotation classes unless they&apos;re found in $&lt;/p&gt;
{ANT_HOME}/lib. &lt;br/&gt;
&lt;br/&gt;
Example : &lt;br/&gt;
@Entity&lt;br/&gt;
public class MyEntity  {&lt;br/&gt;
   // . . .&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
MyEntity.class.isAnnotationPresent(Entity.class); &lt;br/&gt;
// returns false with the ant classloader&lt;br/&gt;
// returns true with the ant classloader if you copy geronimo-jpa_3.0_spec-1.0.jar to ${ANT_HOME}
&lt;p&gt;/lib&lt;br/&gt;
// returns true if we create a temporary classloader - similar to the PCEnhancerTask. &lt;/p&gt;

</description>
                <environment></environment>
        <key id="12379307">OPENJPA-388</key>
            <summary>MappingToolTask can&apos;t find persistence meta data. </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikedd">Michael Dick</assignee>
                                    <reporter username="mikedd">Michael Dick</reporter>
                        <labels>
                    </labels>
                <created>Fri, 28 Sep 2007 17:51:47 +0100</created>
                <updated>Tue, 30 Oct 2007 15:29:13 +0000</updated>
                            <resolved>Tue, 30 Oct 2007 15:29:13 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>1.0.1</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                    <component>jdbc</component>
                        <due>Fri, 5 Oct 2007 07:00:00 +0000</due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160710</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7kmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>288311</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>