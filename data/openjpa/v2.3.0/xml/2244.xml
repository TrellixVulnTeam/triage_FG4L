<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:44:27 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-2244/OPENJPA-2244.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-2244] Nested classpath ignored in mapping tool ant task</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-2244</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;The nested classpath element inside the mappingtool ant task are ignored when loading the persistent configuration file. User got the following error:&lt;/p&gt;

&lt;p&gt;&amp;lt;openjpa-2.0.2-SNAPSHOT-r422266:1361284M fatal user error&amp;gt; org.apache.openjpa.util.MetaDataException: MetaDataFactory could not be configured (conf.newMetaDataFactoryInstance() returned null). This might mean that no configuration properties were found. Ensure that you have a META-INF/persistence.xml file, that it is available in your classpath, or that the properties file you are using for configuration is available. If you are using Ant, please see the &amp;lt;properties&amp;gt; or &amp;lt;propertiesFile&amp;gt; attributes of the task&apos;s nested &amp;lt;config&amp;gt; element. This can also occur if your OpenJPA distribution jars are corrupt, or if your security policy is overly strict.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12601129">OPENJPA-2244</key>
            <summary>Nested classpath ignored in mapping tool ant task</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="helenxu">Helen Xu</assignee>
                                    <reporter username="helenxu">Helen Xu</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Aug 2012 22:43:18 +0100</created>
                <updated>Wed, 10 Apr 2013 16:05:07 +0100</updated>
                            <resolved>Wed, 10 Apr 2013 16:05:01 +0100</resolved>
                                    <version>2.0.1</version>
                    <version>2.1.1</version>
                    <version>2.2.0</version>
                                    <fixVersion>2.0.3</fixVersion>
                    <fixVersion>2.1.2</fixVersion>
                    <fixVersion>2.2.2</fixVersion>
                    <fixVersion>2.2.1.1</fixVersion>
                    <fixVersion>2.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13427370" author="helenxu" created="Thu, 2 Aug 2012 16:02:30 +0100"  >&lt;p&gt;The fix is to add the ant classloader before loading the configuration file.&lt;/p&gt;

&lt;p&gt;patch attached.&lt;/p&gt;</comment>
                            <comment id="13428285" author="helenxu" created="Fri, 3 Aug 2012 19:36:29 +0100"  >&lt;p&gt;new patch attached to load context classloader only when it is needed.&lt;/p&gt;</comment>
                            <comment id="13459075" author="helenxu" created="Wed, 19 Sep 2012 21:47:01 +0100"  >&lt;p&gt;When user specifies the properties attribute inside the config element to point to a specific persistence config file and persistent unit, the persistence config file or unit cannot be loaded from the nested classpath as well. here is an example:&lt;br/&gt;
&amp;lt;mappingtool schemaAction=&quot;build&quot; sqlFile=&quot;create.sql&quot;&amp;gt;  &lt;br/&gt;
      	&amp;lt;classpath&amp;gt;&lt;br/&gt;
      		&amp;lt;pathelement location=&quot;mapping-tool-pi.jar&quot; /&amp;gt; &lt;br/&gt;
      		&amp;lt;pathelement location=&quot;mapping-tool-persistenceunit-pi.jar&quot; /&amp;gt; &lt;br/&gt;
      		&amp;lt;pathelement location=&quot;./&quot; /&amp;gt;&lt;br/&gt;
      	&amp;lt;/classpath&amp;gt;&lt;br/&gt;
        &amp;lt;config propertiesFile=&quot;&quot;persistence.xml#mappingtool-pu&quot; connectionDriverName=&quot;com.ibm.db2.jcc.DB2Driver&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/mappingtool&amp;gt; &lt;/p&gt;

&lt;p&gt;user will get the following exception&lt;br/&gt;
Caused by: java.util.MissingResourceException: persistence.xml#mappingtool-pu&lt;br/&gt;
	at org.apache.openjpa.lib.conf.ProductDerivations.load(ProductDerivations.java:286)&lt;br/&gt;
	at org.apache.openjpa.lib.conf.ConfigurationImpl.setProperties(ConfigurationImpl.java:858)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:611)&lt;br/&gt;
	at org.apache.tools.ant.IntrospectionHelper$AttributeSetter.setObject(IntrospectionHelper.java:1498)&lt;br/&gt;
	at org.apache.tools.ant.IntrospectionHelper.setAttribute(IntrospectionHelper.java:405)&lt;/p&gt;

&lt;p&gt;The reason it failed to load the config is:&lt;br/&gt;
1. It doesn&apos;t have the properties value parsing to separate the file name and persistent unit name&lt;br/&gt;
2. ConfigurationImpl.setProperties() didn&apos;t take the ant class loader when it try to load the config file, or it loaded the config file too early. Ideally it should wait until all the classpath setting loaded. &lt;br/&gt;
This problem will happen for all types of OPENJPA ant task.&lt;/p&gt;

&lt;p&gt;I have created a fix for this problem. please refer to the patch file for details.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12545800" name="OPENJPA-2244.patch" size="11303" author="helenxu" created="Wed, 19 Sep 2012 21:47:33 +0100"/>
                            <attachment id="12539075" name="OPENJPA-2244.patch" size="3971" author="helenxu" created="Fri, 3 Aug 2012 19:36:29 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240122</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxurzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3355</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>