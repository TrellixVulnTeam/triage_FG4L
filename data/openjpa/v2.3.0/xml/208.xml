<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:35:45 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-208/OPENJPA-208.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-208] NoResultException and NonUniqueResultException are not thrown when expected</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-208</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;When calling Query.getSingleResult() on a query that either has no result or multiple results, either a NoResultException and NonUniqueResultException (respectively) should be thrown in accordance with section 3.6.1 of the JPA spec. Instead, we appear to throw a org.apache.openjpa.persistence.InvalidStateException:&lt;/p&gt;

&lt;p&gt;org.apache.openjpa.persistence.InvalidStateException: The query on candidate type &quot;class com.sun.ts.tests.ejb30.persistence.query.apitests.Department&quot; with filter &quot;select d.name from Department d where d.id &amp;gt; 1&quot; was configured to have a unique result, but more than one instance matched the query.&lt;br/&gt;
     at org.apache.openjpa.kernel.QueryImpl.singleResult(QueryImpl.java:1282)&lt;br/&gt;
     at org.apache.openjpa.kernel.QueryImpl.toResult(QueryImpl.java:1207)&lt;br/&gt;
     at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:982)&lt;br/&gt;
     at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:791)&lt;br/&gt;
     at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:761)&lt;br/&gt;
     at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:757)&lt;br/&gt;
     at org.apache.openjpa.kernel.DelegatingQuery.execute(DelegatingQuery.java:514)&lt;br/&gt;
     at org.apache.openjpa.persistence.QueryImpl.execute(QueryImpl.java:225)&lt;br/&gt;
     at org.apache.openjpa.persistence.QueryImpl.getSingleResult(QueryImpl.java:287)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12366747">OPENJPA-208</key>
            <summary>NoResultException and NonUniqueResultException are not thrown when expected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mprudhom">Marc Prud&apos;hommeaux</assignee>
                                    <reporter username="mprudhom">Marc Prud&apos;hommeaux</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Apr 2007 23:25:55 +0100</created>
                <updated>Tue, 9 Mar 2010 18:32:33 +0000</updated>
                            <resolved>Mon, 9 Apr 2007 18:06:36 +0100</resolved>
                                    <version>0.9.6</version>
                                    <fixVersion>0.9.7</fixVersion>
                                    <component>jpa</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12487348" author="mprudhom" created="Fri, 6 Apr 2007 23:32:49 +0100"  >&lt;p&gt;This seems to have slipped in in the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-168&quot; title=&quot;sql optimize n rows query hint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-168&quot;&gt;&lt;del&gt;OPENJPA-168&lt;/del&gt;&lt;/a&gt;: see &lt;a href=&quot;http://svn.apache.org/viewvc/incubator/openjpa/trunk/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/QueryImpl.java?p2=%2Fincubator%2Fopenjpa%2Ftrunk%2Fopenjpa-persistence%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fopenjpa%2Fpersistence%2FQueryImpl.java&amp;amp;p1=%2Fincubator%2Fopenjpa%2Ftrunk%2Fopenjpa-persistence%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fopenjpa%2Fpersistence%2FQueryImpl.java&amp;amp;r1=522581&amp;amp;r2=522580&amp;amp;view=diff&amp;amp;pathrev=522581&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/incubator/openjpa/trunk/openjpa-persistence/src/main/java/org/apache/openjpa/persistence/QueryImpl.java?p2=%2Fincubator%2Fopenjpa%2Ftrunk%2Fopenjpa-persistence%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fopenjpa%2Fpersistence%2FQueryImpl.java&amp;amp;p1=%2Fincubator%2Fopenjpa%2Ftrunk%2Fopenjpa-persistence%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fopenjpa%2Fpersistence%2FQueryImpl.java&amp;amp;r1=522581&amp;amp;r2=522580&amp;amp;view=diff&amp;amp;pathrev=522581&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12487349" author="mprudhom" created="Fri, 6 Apr 2007 23:33:30 +0100"  >&lt;p&gt;This appears to have been introduced by the commits for the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-168&quot; title=&quot;sql optimize n rows query hint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-168&quot;&gt;&lt;del&gt;OPENJPA-168&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12487352" author="mprudhom" created="Fri, 6 Apr 2007 23:48:03 +0100"  >&lt;p&gt;The change to &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-168&quot; title=&quot;sql optimize n rows query hint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-168&quot;&gt;&lt;del&gt;OPENJPA-168&lt;/del&gt;&lt;/a&gt; seems to have been done to make the validation of a single result a little cleaner by having the kernel query perform the validation that there is a single result. However, this meant that we could only do generic exception translation, and so were no longer throwing a NoResultException or NonUniqueResultException. We could fix this by introducing a could new kernel exceptions or exception types, but it might just be easier to revert to having the validation done in the persistence QueryImpl.&lt;/p&gt;

&lt;p&gt;Any objections to fixing this the easy way?&lt;/p&gt;</comment>
                            <comment id="12487359" author="mprudhom" created="Sat, 7 Apr 2007 00:33:50 +0100"  >&lt;p&gt;Went ahead and restored the previous behavior where the QueryImpl itself checks for non-uniqueness and throws the expected exception.&lt;/p&gt;</comment>
                            <comment id="12487577" author="mprudhom" created="Mon, 9 Apr 2007 17:42:08 +0100"  >&lt;p&gt;From Abe on mailing list: That breaks the single result optimization that was added for  &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-168&quot; title=&quot;sql optimize n rows query hint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-168&quot;&gt;&lt;del&gt;OPENJPA-168&lt;/del&gt;&lt;/a&gt; when getSingleResult() is called.  There was a reason we moved the validation to the kernel.  The previous code was correct. You need to use the &quot;hard&quot; way of creating new exception types.&lt;/p&gt;</comment>
                            <comment id="12487581" author="mprudhom" created="Mon, 9 Apr 2007 18:06:36 +0100"  >&lt;p&gt;Added NoResultException and NonUniqueResultException to kernel to allow the identification of the case where a unique result was selected by either none or too many were found&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160539</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hysw1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>202540</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>