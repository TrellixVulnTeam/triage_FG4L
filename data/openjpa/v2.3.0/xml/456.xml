<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:44:11 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-456/OPENJPA-456.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-456] Missed to validate the column name length for Join Column</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-456</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;In the PersistenceMappingDefault.populateJoinColumn() method, it missed the call to validate the column length. Consequencely the column length  that was longer than DB2&apos;s max column length resulted an invalid column length exception .&lt;/p&gt;

&lt;p&gt;The fix wil be:&lt;/p&gt;

&lt;p&gt;    public void populateJoinColumn(FieldMapping fm, Table local, Table foreign,&lt;br/&gt;
        Column col, Object target, int pos, int cols) &lt;/p&gt;
{
        // only use spec defaults with column targets
        if (!(target instanceof Column))
            return;

        // if this is a bidi relation, prefix with inverse field name, else
        // prefix with owning entity name
        FieldMapping[] inverses = fm.getInverseMappings();
        String name;
        if (inverses.length &amp;gt; 0)
            name = inverses[0].getName();
        else
            name = fm.getDefiningMapping().getTypeAlias();

        // suffix with &apos;_&apos; + target column
        name += &quot;_&quot; + ((Column) target).getName();
        name = dict.getValidColumnName(name, foreign);  ===&amp;gt; add this call before set the name to the column.
        col.setName(name);
    }</description>
                <environment></environment>
        <key id="12383584">OPENJPA-456</key>
            <summary>Missed to validate the column name length for Join Column</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikedd">Michael Dick</assignee>
                                    <reporter username="tckan1">Teresa Kan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Nov 2007 05:11:14 +0000</created>
                <updated>Sun, 20 Apr 2008 20:00:07 +0100</updated>
                            <resolved>Sun, 20 Apr 2008 20:00:07 +0100</resolved>
                                    <version>1.1.0</version>
                                    <fixVersion>1.1.0</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                    <component>jdbc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12546997" author="tckan1" created="Fri, 30 Nov 2007 05:12:18 +0000"  >&lt;p&gt;Attach the patch..&lt;/p&gt;</comment>
                            <comment id="12549519" author="tckan1" created="Fri, 7 Dec 2007 19:01:49 +0000"  >&lt;p&gt;With my current fix(&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-456&quot; title=&quot;Missed to validate the column name length for Join Column&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-456&quot;&gt;&lt;del&gt;OPENJPA-456&lt;/del&gt;&lt;/a&gt;) which  put the getValidColumnName() in the PersistenctMappingDefault..populateJoinColumn(). The output will be like this:&lt;/p&gt;

&lt;p&gt;===PersitendceMappingDefault.populateJoinColumn(), name before conversion=RelationToHandlerMapInstance_id&lt;br/&gt;
===PersitendceMappingDefault.populateJoinColumn(), name after conversion=RELATIONTOHANDLERMAPINSTANCE_I&lt;/p&gt;


&lt;p&gt;If I modified the code to shorten the name first before append the targetName (&quot;_ID&quot;), then the output looks like this:&lt;/p&gt;

&lt;p&gt;===PersitendceMappingDefault.populateJoinColumn(), tempname =RelationToHandlerMapInstanc&lt;br/&gt;
===PersitendceMappingDefault.populateJoinColumn(), name before conversion=RelationToHandlerMapInstanc_id&lt;br/&gt;
===PersitendceMappingDefault.populateJoinColumn(), name after conversion=RELATIONTOHANDLERMAPINSTANC_ID&lt;/p&gt;

&lt;p&gt;I think the latest solution is better. It preserves the _ID at the end. For current solution will lost the _ID at the end if the max column name is much shorter than the initial name.&lt;br/&gt;
The attach patch provides the latest solution..&lt;/p&gt;</comment>
                            <comment id="12590795" author="mikedd" created="Sun, 20 Apr 2008 20:00:07 +0100"  >&lt;p&gt;Closing old issue which was integrated with revision 603633 on 12-12-2008&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12370609" name="OPENJPA-456.patch" size="661" author="tckan1" created="Fri, 30 Nov 2007 05:12:17 +0000"/>
                            <attachment id="12371250" name="openjpa_456_2.patch" size="997" author="tckan1" created="Fri, 7 Dec 2007 19:01:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 20 Apr 2008 19:00:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160777</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hysz93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>203059</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>