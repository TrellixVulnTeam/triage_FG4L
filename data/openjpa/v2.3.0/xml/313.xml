<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:40:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-313/OPENJPA-313.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-313] list of objects returned by query partially correct</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-313</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;We have an object inheritance hierarchy as follows.&lt;/p&gt;

&lt;p&gt;    FixedAnnuity extends Annuity&lt;br/&gt;
    EquityAnnuity extends Annuity&lt;/p&gt;

&lt;p&gt;Then we have following code:&lt;/p&gt;

&lt;p&gt;    List&amp;lt;IAnnuity&amp;gt; annuities = getServerAdapter().findHolderAnnuities(holder);&lt;/p&gt;

&lt;p&gt;from which we expect to have a list of &quot;Annuity&quot; (could be Annuity, FixedAnnuity or &lt;br/&gt;
EquityAnnuity) from following code&lt;br/&gt;
	EntityManager em = null;&lt;br/&gt;
	try&lt;/p&gt;
{		 						
		em = factory.createEntityManager();
		Query query = em.createNamedQuery(&quot;GetHolderAnnuities&quot;);
		query.setParameter(&quot;holderId&quot;, holder.getId());		
		return (List&amp;lt;IAnnuity&amp;gt;) query.getResultList();
	}&lt;br/&gt;
&lt;br/&gt;
Here is the query&lt;br/&gt;
	&amp;lt;named-query name=&quot;GetHolderAnnuities&quot;&amp;gt;&lt;br/&gt;
	&amp;lt;query&amp;gt;SELECT a FROM Annuity AS a WHERE a.annuityHolderId = :holderId&amp;lt;/query&amp;gt;&lt;br/&gt;
	&amp;lt;/named-query&amp;gt;&lt;br/&gt;
&lt;br/&gt;
In the end, the list returned only the first object with the correct Object, the &lt;br/&gt;
rest of the objects all casted into the basic type &quot;Annuity&quot;&lt;br/&gt;
e.g. we have following code:&lt;br/&gt;
&lt;br/&gt;
	EntityManager em = null;&lt;br/&gt;
	try{		 								em = factory.createEntityManager();		Query query = em.createNamedQuery(&quot;GetHolderAnnuities&quot;);		query.setParameter(&quot;holderId&quot;, holder.getId());				return (List&amp;lt;IAnnuity&amp;gt;) query.getResultList();	}

&lt;p&gt;	FixedAnnuity fixed1 = new FixedAnnuity();&lt;br/&gt;
	fixed1.setHolder(holder);&lt;br/&gt;
	EquityAnnuity equity1 = new EquityAnnuity();&lt;br/&gt;
	equity1.setHolder(holder);&lt;br/&gt;
	FixedAnnuity fixed1 = new FixedAnnuity();&lt;br/&gt;
	fixed2.setHolder(holder);&lt;br/&gt;
	EquityAnnuity equity2 = new EquityAnnuity();&lt;br/&gt;
	equity2.setHolder(holder);&lt;/p&gt;

&lt;p&gt;	List&amp;lt;IAnnuity&amp;gt; annuities = getServerAdapter().findHolderAnnuities(holder);&lt;/p&gt;

&lt;p&gt;Only annuities.get(0) returns the correct object as FixedAnnuity, the other 3 &lt;br/&gt;
objects returned all returned as Annuity &lt;/p&gt;</description>
                <environment></environment>
        <key id="12375808">OPENJPA-313</key>
            <summary>list of objects returned by query partially correct</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fancy">Catalina Wei</reporter>
                        <labels>
                    </labels>
                <created>Sat, 11 Aug 2007 00:14:33 +0100</created>
                <updated>Tue, 9 Mar 2010 18:32:37 +0000</updated>
                            <resolved>Thu, 16 Aug 2007 15:49:14 +0100</resolved>
                                                    <fixVersion>1.0.0</fixVersion>
                                    <component>jdbc</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12519166" author="fancy" created="Sat, 11 Aug 2007 00:34:35 +0100"  >&lt;p&gt;The attached patch seemed to have fixed the problem.&lt;br/&gt;
The testcase of the Annuity has FetchType EAGER set on both side of a OneToMany relation. An Annuity may have many Payouts.&lt;br/&gt;
I&apos;d like to get some feedback from commiters before checking in this patch.&lt;br/&gt;
TCK verification is in process.&lt;/p&gt;</comment>
                            <comment id="12519190" author="fancy" created="Sat, 11 Aug 2007 03:53:12 +0100"  >&lt;p&gt;same patch as the last patch, but using the new naming convention as recommended by the community.&lt;/p&gt;</comment>
                            <comment id="12519452" author="kwsutter" created="Mon, 13 Aug 2007 17:10:15 +0100"  >&lt;p&gt;Catalina,&lt;br/&gt;
Thanks for the patch.  A couple of questions and/or comments though...&lt;/p&gt;

&lt;p&gt;It looks like this updated code is only if we&apos;re working with an OpenJPAID oid and subs is true.  I can understand the oid part, but what exactly is the subs boolean used for?  I know this wasn&apos;t your original code, but a quick glance at the code shows a need for a javadoc update at least.  You must have spent some time figuring out how this parameter is used.  It would be helpful to put add to the javadoc for this method to explain what the subs parameter is used for (at least).  Thanks.&lt;/p&gt;

&lt;p&gt;Also, I really dislike empty catch clauses.  I can&apos;t tell if this was on purpose or an oversight.  It also forces me to think through the logic whether this exception clause was necessary or not.  I think the empty clause is okay, but we should at least put a comment in the clause indicating why we can safely ignore this exception.&lt;/p&gt;

&lt;p&gt;I also personally don&apos;t like the idea of comparing strings for the strategy type, but it looks like we&apos;re just following suit from the existing code.  We can only change so much at a time, I suppose...  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks again,&lt;br/&gt;
Kevin&lt;/p&gt;</comment>
                            <comment id="12519590" author="fancy" created="Tue, 14 Aug 2007 05:27:12 +0100"  >&lt;p&gt;add block comments to the code.&lt;/p&gt;</comment>
                            <comment id="12519837" author="fancy" created="Wed, 15 Aug 2007 03:23:33 +0100"  >&lt;p&gt;attached revised patch.&lt;br/&gt;
mvn clean install ran successful.&lt;/p&gt;</comment>
                            <comment id="12520264" author="kwsutter" created="Thu, 16 Aug 2007 15:49:14 +0100"  >&lt;p&gt;Since Catalina doesn&apos;t quite have the necessary karma yet, I will resolve this Issue for her...  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  Thanks, Catalina, for the patch!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12363817" name="OPENJPA-313.2.patch" size="2850" author="fancy" created="Wed, 15 Aug 2007 03:23:33 +0100"/>
                            <attachment id="12363754" name="OPENJPA-313.r564688.patch" size="2441" author="fancy" created="Tue, 14 Aug 2007 05:27:12 +0100"/>
                            <attachment id="12363646" name="OPENJPA-313.r564688.patch" size="1652" author="fancy" created="Sat, 11 Aug 2007 03:53:12 +0100"/>
                            <attachment id="12363639" name="jpa1.0.0.patch" size="1652" author="fancy" created="Sat, 11 Aug 2007 00:34:35 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 13 Aug 2007 16:10:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160639</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyt5xr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204142</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>