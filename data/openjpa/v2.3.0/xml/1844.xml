<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:38:14 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1844/OPENJPA-1844.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1844] Create a JConsole plugin to display DataCache statistics and help tune the cache</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1844</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;I have created a simple JConsole plugin that will enable a OpenJPA user to view DataCache statistics and it also allows for some runtime interactions with the cache. These changes are going to come in two parts. The first part will be the plugin side of changes and second part is going to come via another JIRA which will feature the OpenJPA core runtime changes.&lt;/p&gt;

&lt;p&gt;The features that I have currently implemented are:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A view of cache hits, reads, and writes.&lt;/li&gt;
	&lt;li&gt;A button to evict the entire contents of the cache.&lt;/li&gt;
	&lt;li&gt;A button to reset the statistics.&lt;/li&gt;
	&lt;li&gt;A check box to enable / disable statistics gathering&lt;/li&gt;
	&lt;li&gt;The ability to disable / enable caching specific types.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I would like to add the following features:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Show the current DataCache configuration and show what (if any) changes have been made at runtime (ie: Stopped caching a certain type).&lt;/li&gt;
	&lt;li&gt;Allow changing the cache size.&lt;/li&gt;
	&lt;li&gt;Evict only a certain type.&lt;/li&gt;
	&lt;li&gt;Make some cute bar charts for hit/miss ratio.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This works both in a JSE environment and in a WebSphere environment(sans security). I&apos;ll add more details on how to run jconsole with the plugin once I have some code committed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12477779">OPENJPA-1844</key>
            <summary>Create a JConsole plugin to display DataCache statistics and help tune the cache</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="curtisr7">Rick Curtis</assignee>
                                    <reporter username="curtisr7">Rick Curtis</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Oct 2010 22:02:24 +0100</created>
                <updated>Wed, 13 Jul 2011 17:11:23 +0100</updated>
                            <resolved>Wed, 12 Jan 2011 23:03:11 +0000</resolved>
                                                    <fixVersion>2.1.0</fixVersion>
                                    <component>datacache</component>
                    <component>instrumentation</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12922715" author="curtisr7" created="Tue, 19 Oct 2010 22:03:30 +0100"  >&lt;p&gt;Attaching a screenshot of the JConsole UI.&lt;/p&gt;</comment>
                            <comment id="12923501" author="curtisr7" created="Thu, 21 Oct 2010 17:26:31 +0100"  >&lt;p&gt;A few comments for the initial code drop:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Look closely at the DataCacheManager changes. I added the ability to selectively start/stop caching a certain type.&lt;/li&gt;
	&lt;li&gt;Look closely at MetaDataRepository/ClassMetaData changes. I added a mapping of {String class name] -&amp;gt; java.lang.Class.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;There are still a few todos:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;There are a number of strings in the plugin code that should be localized&lt;/li&gt;
	&lt;li&gt;Still need to add some unit tests for the new runtime changes.&lt;/li&gt;
	&lt;li&gt;Need to add doc.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;For any early tire kickers out there, here are the steps needed to get this plugin working (in JSE). I&apos;m going to recommend using the Sun JVM for now.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Start a JPA application with openjpa.Instrumentation enabled for the DataCache&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;.&lt;/li&gt;
	&lt;li&gt;After a EntityManager is created, launch the jconsole&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;.&lt;/li&gt;
	&lt;li&gt;If you haven&apos;t enabled DataCache statistics, check the enable statistics box.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &amp;lt;property name=&quot;openjpa.Instrumentation&quot; value=&quot;jmx(Instrument=&apos;DataCache,QueryCache&apos;)&quot;/&amp;gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;java_home&amp;#93;&lt;/span&gt;\bin&amp;gt;jconsole.exe -pluginpath openjpa-all-2.1.0-SNAPSHOT.jar -J-Djava.class.path=..\lib\jconsole.jar;..\lib\tools.jar;openjpa-all-2.1.0-SNAPSHOT.jar&lt;/p&gt;</comment>
                            <comment id="12924694" author="drwoods" created="Mon, 25 Oct 2010 20:49:42 +0100"  >&lt;p&gt;The following doesn&apos;t work on Mac OSX -&lt;br/&gt;
        &amp;lt;dependency&amp;gt;&lt;br/&gt;
            &amp;lt;groupId&amp;gt;sun.jconsole&amp;lt;/groupId&amp;gt;&lt;br/&gt;
            &amp;lt;artifactId&amp;gt;jconsole&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
            &amp;lt;version&amp;gt;1.6.0&amp;lt;/version&amp;gt;&lt;br/&gt;
            &amp;lt;scope&amp;gt;system&amp;lt;/scope&amp;gt;&lt;br/&gt;
            &amp;lt;systemPath&amp;gt;$&lt;/p&gt;
{java.home}/../lib/jconsole.jar&amp;lt;/systemPath&amp;gt;&lt;br/&gt;
        &amp;lt;/dependency&amp;gt;&lt;br/&gt;
as there is no JRE vs. JDK separation.  Instead it needs to be -&lt;br/&gt;
            &amp;lt;systemPath&amp;gt;${java.home}
&lt;p&gt;/lib/jconsole.jar&amp;lt;/systemPath&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12924708" author="drwoods" created="Mon, 25 Oct 2010 21:25:04 +0100"  >&lt;p&gt;Add code to handle different location of jconsole.jar on MacOSX in r1027257.&lt;/p&gt;</comment>
                            <comment id="12924758" author="ppoddar@apache.org" created="Mon, 25 Oct 2010 23:22:19 +0100"  >&lt;p&gt;While I like the feature, there must be a better way than to bring  JConsole dependency to openjpa kerne&lt;/p&gt;
</comment>
                            <comment id="12924979" author="curtisr7" created="Tue, 26 Oct 2010 15:55:55 +0100"  >&lt;p&gt;@Pinaki - Agreed. Any suggestions?&lt;/p&gt;</comment>
                            <comment id="12925004" author="drwoods" created="Tue, 26 Oct 2010 16:51:27 +0100"  >&lt;p&gt;trunk/openjpa-tools would be the only other place, which would get pulled into the zip and openjpa-all.jar and/or openjpa.jar&lt;/p&gt;</comment>
                            <comment id="12925385" author="techhusky" created="Wed, 27 Oct 2010 15:48:35 +0100"  >&lt;p&gt;I think the JConsole/Swing code should be pulled out of kernel and included into a new trunk/openjpa-tools submodule.  I don&apos;t think the tools artifacts should go into the base openjpa.jar, but wouldn&apos;t be opposed to putting it into the openjpa-all jar.  Also, I think the binary distribution zip should include the tools jar along side the openjpa and openjpa-all jars.&lt;/p&gt;</comment>
                            <comment id="12926326" author="curtisr7" created="Fri, 29 Oct 2010 16:50:56 +0100"  >&lt;p&gt;With revision 1028808 I committed all of the changes for the JConsole plugin to openjpa-tools... but I messed up the commit message. See &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1801&quot; title=&quot;CacheStatistics misses are improperly calculated.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1801&quot;&gt;&lt;del&gt;OPENJPA-1801&lt;/del&gt;&lt;/a&gt; for the commit. I took a 180 from my original commit as I removed the dependency on ANY runtime code and now it can run in a true standalone fashion.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;java_home&amp;#93;&lt;/span&gt;\bin&amp;gt;jconsole.exe -pluginpath openjpa-tools-0.1.0-SNAPSHOT.jar&lt;/p&gt;

&lt;p&gt;A few things to note:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;This plugin is now completely independent from the OpenJPA runtime code. I had to make use of java.util.ResourceBundle and java.text.MessageFormat for localization of strings.&lt;/li&gt;
	&lt;li&gt;To launch the plugin you no longer need to specify the classpath.&lt;/li&gt;
	&lt;li&gt;I added org.apache.openjpa.jconsole.DataCacheMBean interface which includes a subset of the runtimes MBean interface(org.apache.openjpa.instrumentation.jmx.DataCacheJMXInstrumentMBean). I did this as a convenience so I could use JMX.newMBeanProxy(...), rather than using the &apos;reflection&apos; way of invoking MBean methods.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12980999" author="mikedd" created="Wed, 12 Jan 2011 23:03:11 +0000"  >&lt;p&gt;If there&apos;s more work to be done for this issue please re-open, or open a sub task for the remaining work. &lt;/p&gt;</comment>
                            <comment id="13064660" author="curtisr7" created="Wed, 13 Jul 2011 17:11:23 +0100"  >&lt;p&gt;Closing resolved issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12457593" name="screenshot.jpg" size="76107" author="curtisr7" created="Tue, 19 Oct 2010 22:03:30 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 25 Oct 2010 19:49:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>68163</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hysv93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>202411</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>