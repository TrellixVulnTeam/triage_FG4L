<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:43:39 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-132/OPENJPA-132.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-132] java.lang.NoSuchMethodError for entity with ID of type java.sql.Date</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-132</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Opening JIRA report to track the following problem (posted to development forum &lt;a href=&quot;http://www.nabble.com/Exception-when-using-java.sql.Date-as-an-id-tf3189597.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/Exception-when-using-java.sql.Date-as-an-id-tf3189597.html&lt;/a&gt;) &lt;/p&gt;

&lt;p&gt;I&apos;m getting the following exception when I try to fetch an entity with a java.sql.Date as the id :&lt;/p&gt;

&lt;p&gt;java.lang.NoSuchMethodError: org.apache.openjpa.util.DateId.getId()Ljava/sql/Date;&lt;br/&gt;
    at mikedd.entities.SqlDatePK.pcCopyKeyFieldsFromObjectId (SqlDatePK.java)&lt;br/&gt;
    at mikedd.entities.SqlDatePK.pcNewInstance(SqlDatePK.java)&lt;br/&gt;
    at org.apache.openjpa.enhance.PCRegistry.newInstance(PCRegistry.java:118)&lt;br/&gt;
    at org.apache.openjpa.kernel.StateManagerImpl.initialize (StateManagerImpl.java:247)&lt;br/&gt;
    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initializeState(JDBCStoreManager.java:327)&lt;br/&gt;
    at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initialize(JDBCStoreManager.java:252)&lt;br/&gt;
    at org.apache.openjpa.kernel.DelegatingStoreManager.initialize(DelegatingStoreManager.java:108)&lt;br/&gt;
    at org.apache.openjpa.kernel.ROPStoreManager.initialize(ROPStoreManager.java:54)&lt;br/&gt;
    at org.apache.openjpa.kernel.BrokerImpl.initialize (BrokerImpl.java:868)&lt;br/&gt;
    at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:826)&lt;br/&gt;
    at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:743)&lt;br/&gt;
    at org.apache.openjpa.kernel.DelegatingBroker.find (DelegatingBroker.java:169)&lt;br/&gt;
    at org.apache.openjpa.persistence.EntityManagerImpl.find(EntityManagerImpl.java:346)&lt;br/&gt;
    at mikedd.tests.TestSqlDateId.testFindAfterClear(TestSqlDateId.java:25)&lt;br/&gt;
    at sun.reflect.NativeMethodAccessorImpl.invoke0 (Native Method)&lt;br/&gt;
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
    at java.lang.reflect.Method.invoke (Method.java:585)&lt;br/&gt;
    at junit.framework.TestCase.runTest(TestCase.java:154)&lt;br/&gt;
    . . .&lt;/p&gt;

&lt;p&gt;It&apos;s coming from the generated bytecode which expects there to be a getId method that returns the same type of the Id, however java.sql.Date is using the same ID class as java.util.Date. Do we need a separate class for java.sql.Date? &lt;/p&gt;


&lt;p&gt;Responses from Patrick and Craig follow. The consensus so far is to provide ID separate classes for java.sql.Date and java.util.Date. &lt;/p&gt;

&lt;p&gt;It looks like we either need a separate type for java.sql.Date (and&lt;br/&gt;
presumably java.sql.Timestamp), or we need to change the logic to accept&lt;br/&gt;
a getId() method that returns a type that is assignable from the id&lt;br/&gt;
field&apos;s type.&lt;/p&gt;

&lt;p&gt;-Patrick&lt;/p&gt;

&lt;p&gt;It&apos;s probably cleaner if we have separate classes for the different&lt;br/&gt;
types. That is, have the getId method in the new&lt;br/&gt;
org.apache.openjpa.util.SQLDateId return the proper type&lt;br/&gt;
(java.sql.Date). After all, java.sql.&lt;/p&gt;
{Date, Time, Timestamp}
&lt;p&gt; are not&lt;br/&gt;
really the same as java.util.Date.&lt;/p&gt;

&lt;p&gt;-Craig&lt;/p&gt;

&lt;p&gt;FTR, I think that I prefer separate classes as well; it&apos;s clearer, and&lt;br/&gt;
avoids any ambiguity with other subclasses in the future.&lt;/p&gt;

&lt;p&gt;-Patrick&lt;/p&gt;</description>
                <environment></environment>
        <key id="12362259">OPENJPA-132</key>
            <summary>java.lang.NoSuchMethodError for entity with ID of type java.sql.Date</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mikedd">Michael Dick</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Feb 2007 22:40:38 +0000</created>
                <updated>Tue, 17 Apr 2007 19:38:46 +0100</updated>
                            <resolved>Tue, 20 Mar 2007 19:02:16 +0000</resolved>
                                                    <fixVersion>0.9.7</fixVersion>
                                    <component>kernel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12482134" author="mikedd" created="Mon, 19 Mar 2007 15:59:44 +0000"  >&lt;p&gt;Attaching a patch.  &lt;/p&gt;

&lt;p&gt;The patch includes a new Id class for java.sql.Date and the appropriate hooks so that if will be used.&lt;/p&gt;

&lt;p&gt;I chose to move the SQL_DATE constant from JavaSQLTypes to its superclass JavaTypes. The constant for java.sql.Date needed to be visible to the classes in openjpa-kernel and I didn&apos;t see a reason to have define two constants. &lt;/p&gt;

&lt;p&gt;The remainder of the changes are fairly straightforward whenever there is special processing for java.util.Date I did the same thing for java.sql.Date. &lt;/p&gt;

&lt;p&gt;I&apos;ll attach testcases separately, this is probably a big enough patch file to review and the tests need a little cleaning up. &lt;/p&gt;</comment>
                            <comment id="12482259" author="awhite" created="Mon, 19 Mar 2007 23:18:23 +0000"  >&lt;p&gt;I have a fix ready to commit that consists of about 6 lines of enhancer code to account for Date subclasses when using DateId, just as we account for Object subclasses when using ObjectId.  The fix avoids the new type constant, new identity class, and all the additional &quot;case&quot; statements for SQL dates in the patch proposed by Michael Dick.  Additionally, the fix should work with java.sql.Time and java.sql.Timestamp too; Michael&apos;s fix will not.  I believe this is a simpler, better solution.  I also have a test case for SQL date id&apos;s ready to commit; we can use it with either my patch or Michael&apos;s.  I will hold off on committing until we resolve whose patch to use.  &lt;/p&gt;</comment>
                            <comment id="12482448" author="mikedd" created="Tue, 20 Mar 2007 17:16:17 +0000"  >&lt;p&gt;I&apos;m fine using Abe&apos;s patch. The patch I submitted was just focussed on java.sql.Date, not the other java.sql classes. A simpler fix which adds more function is usually a good thing. &lt;/p&gt;</comment>
                            <comment id="12482462" author="kwsutter" created="Tue, 20 Mar 2007 18:06:51 +0000"  >&lt;p&gt;Abe,&lt;br/&gt;
Can you post your patch so that we can see how the two approaches differ?  Thanks.&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;</comment>
                            <comment id="12482483" author="awhite" created="Tue, 20 Mar 2007 19:02:16 +0000"  >&lt;p&gt;Fixed in SVN revision 520522.  We can back out if we decide to use an alternative fix strategy in the future.&lt;/p&gt;</comment>
                            <comment id="12482484" author="awhite" created="Tue, 20 Mar 2007 19:04:20 +0000"  >&lt;p&gt;Sorry Kevin; I didn&apos;t see your comment before committing.  As my resolution comment states, though, I can back my fix out if we decide we don&apos;t like it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12353664" name="OpenJPA-132.patch.txt" size="26006" author="mikedd" created="Mon, 19 Mar 2007 15:59:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 19 Mar 2007 23:18:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160467</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7jrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>288172</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>