<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:46:21 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1565/OPENJPA-1565.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1565] QueryTimeOut and LockTimeOut exceptions are not raised correctly</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1565</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Narrowing SQL Exception to a more specific exception such as lock or query or referential integrity violation does not distinguish correctly whether a query or lock request has timed out. &lt;br/&gt;
This distinction is critical for JPA 2.0 spec compliance because QueryTimeOut and LockTimeOut exceptions are not supposed to cause rollback as per the spe (Section 3.9).&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12458864">OPENJPA-1565</key>
            <summary>QueryTimeOut and LockTimeOut exceptions are not raised correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ppoddar@apache.org">Pinaki Poddar</assignee>
                                    <reporter username="ppoddar@apache.org">Pinaki Poddar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Mar 2010 22:51:41 +0000</created>
                <updated>Wed, 7 Apr 2010 16:18:17 +0100</updated>
                            <resolved>Mon, 22 Mar 2010 20:11:05 +0000</resolved>
                                    <version>2.0.0-M1</version>
                    <version>2.0.0-M2</version>
                    <version>2.0.0-M3</version>
                    <version>2.0.0-beta</version>
                    <version>2.0.0-beta2</version>
                                    <fixVersion>2.0.0-beta3</fixVersion>
                                    <component>jdbc</component>
                    <component>jpa</component>
                    <component>kernel</component>
                    <component>query</component>
                    <component>sql</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                            <comments>
                            <comment id="12845979" author="drwoods" created="Tue, 16 Mar 2010 16:32:47 +0000"  >&lt;p&gt;Looks like this is causing new junit test failures on any DB besides Derby.&lt;/p&gt;

&lt;p&gt;MySQL 2 tests -&lt;br/&gt;
1) TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities    (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError was raised but expected javax.persistence.QueryTimeoutException&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities(TestTimeoutException.java:63)&lt;br/&gt;
2) TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities     (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError was raised but expected javax.persistence.LockTimeoutException&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities(TestTimeoutException.java:93)&lt;/p&gt;

&lt;p&gt;Microsoft SQL 2008 - 1 test -&lt;br/&gt;
TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities     (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError was raised but expected javax.persistence.LockTimeoutException&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities(TestTimeoutException.java:93)&lt;/p&gt;


&lt;p&gt;DB2 - 2 tests -&lt;br/&gt;
1) TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities    (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError was raised but expected javax.persistence.QueryTimeoutException&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities(TestTimeoutException.java:63)&lt;br/&gt;
2) TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities     (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError was raised but expected javax.persistence.LockTimeoutException&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at org.apache.openjpa.persistence.query.TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities(TestTimeoutException.java:93)&lt;/p&gt;</comment>
                            <comment id="12845984" author="ppoddar@apache.org" created="Tue, 16 Mar 2010 16:44:04 +0000"  >&lt;p&gt;1. Note the SQL Error State and Code of the SQL Exception when it fails to throw expected exception&lt;br/&gt;
2. Check sql-error-state-codes.xml for that database dictionary. The error states are categorized in that file. If the observed error does not occur in the list of error states, add it (the error state not the error code).&lt;br/&gt;
3. Also check corresponding DB dictionary implementation isFatalException() and ensure that it returns false when query/lock timeouts are intended to be raised. &lt;br/&gt;
4. Returning false from isFatalException() will ensure that at facade level the transaction is not rolled back.&lt;/p&gt;</comment>
                            <comment id="12846005" author="ppoddar@apache.org" created="Tue, 16 Mar 2010 17:14:29 +0000"  >&lt;p&gt;I ran with mysql-connector-java-5.1.6 locally and the tests passed for &lt;br/&gt;
MySQL.&lt;/p&gt;

&lt;p&gt;I had given Jody a patch for DB2 errors &amp;#8211; will check if he can verify&lt;/p&gt;

&lt;p&gt;Can you please send me the stacktrace of SQL error for  MS-SQL 2008?&lt;/p&gt;

&lt;p&gt;Regards &amp;#8211;&lt;/p&gt;

&lt;p&gt;Pinaki &lt;/p&gt;







&lt;p&gt;&quot;Donald Woods (JIRA)&quot; &amp;lt;jira@apache.org&amp;gt; &lt;br/&gt;
03/16/2010 11:36 AM&lt;/p&gt;

&lt;p&gt;To&lt;br/&gt;
Pinaki Poddar/Dallas/IBM@IBMUS&lt;br/&gt;
cc&lt;/p&gt;

&lt;p&gt;Subject&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Issue Comment Edited: (&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1565&quot; title=&quot;QueryTimeOut and LockTimeOut exceptions are not raised correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1565&quot;&gt;&lt;del&gt;OPENJPA-1565&lt;/del&gt;&lt;/a&gt;) QueryTimeOut and LockTimeOut &lt;br/&gt;
exceptions are not raised correctly&lt;/p&gt;







&lt;p&gt;    [ &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1565?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=12845979#action_12845979&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/OPENJPA-1565?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=12845979#action_12845979&lt;/a&gt; &lt;br/&gt;
] &lt;/p&gt;

&lt;p&gt;Donald Woods edited comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1565&quot; title=&quot;QueryTimeOut and LockTimeOut exceptions are not raised correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1565&quot;&gt;&lt;del&gt;OPENJPA-1565&lt;/del&gt;&lt;/a&gt; at 3/16/10 4:35 PM:&lt;br/&gt;
----------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Looks like this is causing new junit test failures on any DB besides &lt;br/&gt;
Derby.&lt;/p&gt;

&lt;p&gt;MySQL 2 tests -&lt;br/&gt;
1) &lt;br/&gt;
TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities &lt;br/&gt;
   (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError &lt;br/&gt;
was raised but expected javax.persistence.QueryTimeoutException&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities(TestTimeoutException.java:63)&lt;br/&gt;
2) &lt;br/&gt;
TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities &lt;br/&gt;
    (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError &lt;br/&gt;
was raised but expected javax.persistence.LockTimeoutException&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities(TestTimeoutException.java:93)&lt;/p&gt;

&lt;p&gt;Microsoft SQL 2008 - 1 test -&lt;br/&gt;
TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities &lt;br/&gt;
    (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError &lt;br/&gt;
was raised but expected javax.persistence.LockTimeoutException&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities(TestTimeoutException.java:93)&lt;/p&gt;


&lt;p&gt;DB2 - 2 tests -&lt;br/&gt;
1) &lt;br/&gt;
TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities &lt;br/&gt;
   (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError &lt;br/&gt;
was raised but expected javax.persistence.QueryTimeoutException&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities(TestTimeoutException.java:63)&lt;br/&gt;
2) &lt;br/&gt;
TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities &lt;br/&gt;
    (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError &lt;br/&gt;
was raised but expected javax.persistence.LockTimeoutException&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities(TestTimeoutException.java:93)&lt;/p&gt;


&lt;p&gt;      was (Author: drwoods):&lt;br/&gt;
    Looks like this is causing new junit test failures on any DB besides &lt;br/&gt;
Derby.&lt;/p&gt;

&lt;p&gt;MySQL 2 tests -&lt;br/&gt;
1) &lt;br/&gt;
TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities &lt;br/&gt;
   (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError &lt;br/&gt;
was raised but expected javax.persistence.QueryTimeoutException&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities(TestTimeoutException.java:63)&lt;br/&gt;
2) &lt;br/&gt;
TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities &lt;br/&gt;
    (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError &lt;br/&gt;
was raised but expected javax.persistence.LockTimeoutException&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities(TestTimeoutException.java:93)&lt;/p&gt;

&lt;p&gt;Microsoft SQL 2008 - 1 test -&lt;br/&gt;
TestException.testThrowsEntityExistsException &lt;br/&gt;
(org.apache.openjpa.persistence.exception)&lt;br/&gt;
junit.framework.AssertionFailedError: &amp;lt;openjpa-2.0.0-SNAPSHOT-runknown &lt;br/&gt;
fatal store error&amp;gt; org.apache.openjpa.persistence.RollbackException: The &lt;br/&gt;
transaction has been rolled back. See the nested exceptions for details on &lt;br/&gt;
the errors that occurred. or its cause is not instanceof class &lt;br/&gt;
javax.persistence.EntityExistsException&lt;br/&gt;
at junit.framework.Assert.fail(Assert.java:47)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.exception.TestException.assertException(TestException.java:207)&lt;/p&gt;

&lt;p&gt;DB2 - 2 tests -&lt;br/&gt;
1) &lt;br/&gt;
TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities &lt;br/&gt;
   (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError &lt;br/&gt;
was raised but expected javax.persistence.QueryTimeoutException&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.testQueryTimeOutExceptionWhileQueryingWithLocksOnAlreadyLockedEntities(TestTimeoutException.java:63)&lt;br/&gt;
2) &lt;br/&gt;
TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities &lt;br/&gt;
    (org.apache.openjpa.persistence.query)&lt;br/&gt;
junit.framework.AssertionFailedError: junit.framework.AssertionFailedError &lt;br/&gt;
was raised but expected javax.persistence.LockTimeoutException&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.assertError(TestTimeoutException.java:141)&lt;br/&gt;
at &lt;br/&gt;
org.apache.openjpa.persistence.query.TestTimeoutException.testLockTimeOutExceptionWhileLockingAlreadyLockedEntities(TestTimeoutException.java:93)&lt;/p&gt;


&lt;p&gt;2.0.0-beta2&lt;br/&gt;
query or referential integrity violation does not distinguish correctly &lt;br/&gt;
whether a query or lock request has timed out. &lt;br/&gt;
QueryTimeOut and LockTimeOut exceptions are not supposed to cause rollback &lt;br/&gt;
as per the spe (Section 3.9).&lt;/p&gt;

&lt;p&gt;&amp;#8211; &lt;br/&gt;
This message is automatically generated by JIRA.&lt;br/&gt;
-&lt;br/&gt;
You can reply to this email to add a comment to the issue online.&lt;/p&gt;

</comment>
                            <comment id="12848312" author="drwoods" created="Mon, 22 Mar 2010 20:11:05 +0000"  >&lt;p&gt;Code committed by Pinaki.  Remaining test issues will be handled via &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1594&quot; title=&quot;Tests not handling new QueryTimeOut and LockTimeOut exceptions correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1594&quot;&gt;OPENJPA-1594&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12459907">OPENJPA-1594</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12460975">OPENJPA-1609</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12461400">OPENJPA-1614</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12417320">OPENJPA-991</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12459907">OPENJPA-1594</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Mar 2010 16:32:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161828</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyt2a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>203550</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>