<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:33:09 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1557/OPENJPA-1557.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1557] Logging configuration is difficult for running tests</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1557</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Logging is difficult to configure and is incorrectly documented for running tests.&lt;/p&gt;

&lt;p&gt;There is a system property that can be set on the command line when running tests using surefire: openjpa.loglevel. This property, set via -Dopenjpa.loglevel, is used in the pom.xml to send logging properties to the runtime. The simple case works, e.g. -Dopenjpa.loglevel=error. This affects enhancement and the test runtime to report only errors. &lt;/p&gt;

&lt;p&gt;However, setting this property also results in warnings:&lt;br/&gt;
enhance.all.entities:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;echo&amp;#93;&lt;/span&gt;  running enhancer&lt;br/&gt;
12  WARN   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Runtime - The configuration property named &quot;openjpa.loglevel&quot; was not recognized and will be ignored, although the name closely matches a valid property called &quot;openjpa.Log&quot;.&lt;br/&gt;
2  WARN   &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Runtime - The configuration property named &quot;openjpa.loglevel&quot; was not recognized and will be ignored, although the name closely matches a valid property called &quot;openjpa.Log&quot;.&lt;/p&gt;

&lt;p&gt;This is because the property is both passed to the runtime and also used to configure the log level via the surefire plugin (the relevant part of the pom.xml follows):&lt;/p&gt;

&lt;p&gt;                        &amp;lt;property&amp;gt;&lt;br/&gt;
                            &amp;lt;name&amp;gt;openjpa.Log&amp;lt;/name&amp;gt;&lt;br/&gt;
                            &amp;lt;value&amp;gt;DefaultLevel=$&lt;/p&gt;
{openjpa.loglevel}
&lt;p&gt;&amp;lt;/value&amp;gt;&lt;br/&gt;
                        &amp;lt;/property&amp;gt;&lt;/p&gt;

&lt;p&gt;Via &quot;property injection&quot; it&apos;s also possible to set any number of other log properties using this mechanism, although it&apos;s a bit odd. Just concatenate the extra properties after the level. For example,&lt;/p&gt;

&lt;p&gt;mvn test -Dopenjpa.loglevel=trace,file=openjpa.log,Runtime=info&lt;/p&gt;

&lt;p&gt;This will set the default log level to trace, send the log output to the file openjpa.log, and set the Runtime log level to info.&lt;/p&gt;

&lt;p&gt;The surefire plugin effectively disables the openjpa.Log so the user cannot use this property.&lt;/p&gt;

&lt;p&gt;The warning can be removed by changing the PersistenceTestCase.createNamedEMF:&lt;br/&gt;
        Map map = new HashMap(System.getProperties());&lt;br/&gt;
        map.remove(&quot;openjpa.level&quot;);&lt;/p&gt;

&lt;p&gt;But the enhancer doesn&apos;t go through this path.&lt;/p&gt;

&lt;p&gt;Before I change the online documentation I&apos;d like to see if anyone else has any ideas how to make this easier.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12458574">OPENJPA-1557</key>
            <summary>Logging configuration is difficult for running tests</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="clr">Craig L Russell</assignee>
                                    <reporter username="clr">Craig L Russell</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Mar 2010 20:11:54 +0000</created>
                <updated>Thu, 15 Apr 2010 20:22:57 +0100</updated>
                            <resolved>Thu, 15 Apr 2010 20:22:57 +0100</resolved>
                                    <version>1.2.2</version>
                    <version>2.0.0-beta2</version>
                                    <fixVersion>1.0.4</fixVersion>
                    <fixVersion>1.2.3</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0-beta3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12843418" author="mikedd" created="Wed, 10 Mar 2010 03:15:04 +0000"  >&lt;p&gt;Hi Craig,&lt;/p&gt;

&lt;p&gt;My comments on the mailing list were wrong. It was actually Marc who added the openjpa.loglevel property - back in &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=496880&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=496880&lt;/a&gt;. I made some changes after that to pass it in to the enhancer though - and misremembered when the property was added.&lt;/p&gt;

&lt;p&gt;That said if you don&apos;t need to change the loglevel a relatively easy workaround is to set it in .m2/settings.xml - it&apos;s not a system property and the enhancer ignores it. This is what I&apos;ve been using.&lt;/p&gt;

&lt;p&gt;That said I think the right answer is to remove loglevel and use openjpa.Log instead - the surefire plugin config can be changed to accommodate this.. I&apos;ll attach a patch shortly. &lt;/p&gt;


</comment>
                            <comment id="12843419" author="mikedd" created="Wed, 10 Mar 2010 03:16:52 +0000"  >&lt;p&gt;The attached patch works for simple scenarios (-Dopenjpa.Log=DefaultLevel=FATAL, overrides openjpa.Log set in .m2/settings.xml, etc.). &lt;/p&gt;</comment>
                            <comment id="12843600" author="allee8285" created="Wed, 10 Mar 2010 15:46:49 +0000"  >&lt;p&gt;While we are working on the $&lt;/p&gt;
{openjpa.loglevel}
&lt;p&gt;, can we rename this variable to say &quot;loglevel.openjpa&quot;. It is because of the &quot;openjpa.&quot; prefix, OpenJPA  thought that it is a user mistake and put out a warning message.&lt;/p&gt;

&lt;p&gt;Albert Lee&lt;/p&gt;</comment>
                            <comment id="12843614" author="mikedd" created="Wed, 10 Mar 2010 16:26:59 +0000"  >&lt;p&gt;Good point - that&apos;ll also remove the warning messages.. You can still get yourself into trouble if you use -Dopenjpa.Log=DefaultLevel=FATAL on the maven command line though. System props won&apos;t override the value from config (IIRC) and we&apos;ll always pass in loglevel.openjpa on the config. &lt;/p&gt;

&lt;p&gt;As a quick fix I&apos;d be okay with that though - but it&apos;d be nice to have a single property that we use throughout the build and &apos;normal&apos; configuration. &lt;/p&gt;</comment>
                            <comment id="12844752" author="clr" created="Fri, 12 Mar 2010 23:19:42 +0000"  >&lt;p&gt;With the patch, my concerns go away. &lt;/p&gt;

&lt;p&gt;&amp;gt; You can still get yourself into trouble if you use -Dopenjpa.Log=DefaultLevel=FATAL on the maven command line though. System props won&apos;t override the value from config (IIRC) and we&apos;ll always pass in loglevel.openjpa on the config. &lt;/p&gt;

&lt;p&gt;I don&apos;t follow this comment. If we remove the openjpa.loglevel completely (my understanding of your patch) then you will never get the warning unless you accidentally supply openjpa.loglevel. Still, adding a property loglevel.openjpa is problematic because then you&apos;d be in the same predicament by having loglevel.openjpa overriding the openjpa.Log property. &lt;/p&gt;

&lt;p&gt;With the patch, the only thing the user needs to do is to use the &quot;long form&quot; -Dopenjpa.Log=DefaultLevel=FATAL instead of the &quot;short form&quot; -Dopenjpa.loglevel=FATAL. &lt;/p&gt;

&lt;p&gt;And I&apos;m happy to document the openjpa.Log that you need to use instead of openjpa.loglevel to change the logging levels. I wandered into this issue in the first place after finding conflicting information on our own web site.&lt;/p&gt;</comment>
                            <comment id="12845511" author="mikedd" created="Mon, 15 Mar 2010 20:34:39 +0000"  >&lt;p&gt;Hi Craig,&lt;/p&gt;

&lt;p&gt;The comment that didn&apos;t make sense was related to just renaming the propery loglevel.openjpa. It doesn&apos;t apply to the patch I attached. Sorry for the confusion. &lt;/p&gt;

&lt;p&gt;I&apos;ll go ahead and commit the patch, if there aren&apos;t any last minute objections. &lt;/p&gt;</comment>
                            <comment id="12846066" author="mikedd" created="Tue, 16 Mar 2010 18:46:42 +0000"  >&lt;p&gt;Committed the patch on trunk - had to merge changes to slice, integration/daytrader and integration/validation. &lt;/p&gt;

&lt;p&gt;For some reason the slice unit tests do not pick up the openjpa.Log parameter when it&apos;s passed in as a system arg. They aren&apos;t particularly noisy tests so I&apos;m shelving that issue for now. &lt;/p&gt;</comment>
                            <comment id="12848224" author="clr" created="Mon, 22 Mar 2010 17:37:01 +0000"  >&lt;p&gt;I&apos;ve applied the patch to 1.3.x.&lt;/p&gt;

&lt;p&gt;svn commit -m &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1557&quot; title=&quot;Logging configuration is difficult for running tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1557&quot;&gt;&lt;del&gt;OPENJPA-1557&lt;/del&gt;&lt;/a&gt; remove openjpa.log from pom.xmls to avoid overwriting openjpa.Log&quot; openjpa-persistence-jdbc/pom.xml openjpa-slice/pom.xml&lt;br/&gt;
Sending        openjpa-persistence-jdbc/pom.xml&lt;br/&gt;
Sending        openjpa-slice/pom.xml&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 926209.&lt;/p&gt;

&lt;p&gt;I&apos;ll take a look at the doc pages next.&lt;/p&gt;</comment>
                            <comment id="12849306" author="drwoods" created="Wed, 24 Mar 2010 17:45:04 +0000"  >&lt;p&gt;If there are further doc updates, please checkin against &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1557&quot; title=&quot;Logging configuration is difficult for running tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1557&quot;&gt;&lt;del&gt;OPENJPA-1557&lt;/del&gt;&lt;/a&gt;, but do not reopen, since this has been included in the beta3 release.&lt;/p&gt;</comment>
                            <comment id="12849329" author="clr" created="Wed, 24 Mar 2010 18:15:35 +0000"  >&lt;p&gt;Just one last reference to openjpa.loglevel in the top level pom.xml properties:&lt;/p&gt;

&lt;p&gt;&amp;lt;openjpa.loglevel&amp;gt;INFO&amp;lt;/openjpa.loglevel&amp;gt;&lt;/p&gt;

&lt;p&gt;Is this needed to avoid breaking anything else? Or should it be removed as well?&lt;/p&gt;
</comment>
                            <comment id="12849350" author="drwoods" created="Wed, 24 Mar 2010 18:45:41 +0000"  >&lt;p&gt;You should be able to remove it.  Thought I got all of those....&lt;/p&gt;</comment>
                            <comment id="12849960" author="clr" created="Fri, 26 Mar 2010 00:17:29 +0000"  >&lt;p&gt;It turns out that openjpa-persistence-jdbc/src/main/ant/enhancer.xml has a dependency on openjpa.loglevel and it&apos;s not trivial to get rid of it. More work will be needed to remove it...&lt;/p&gt;</comment>
                            <comment id="12850099" author="drwoods" created="Fri, 26 Mar 2010 11:41:20 +0000"  >&lt;p&gt;Which branch and revision are you looking at?&lt;br/&gt;
I removed the remaining openjpa.loglevel usage in 1.3.x using r926702....&lt;br/&gt;
There are no openjpa.loglevel references in the latest /trunk or branches/2.0.x codebases.&lt;/p&gt;</comment>
                            <comment id="12850164" author="mikedd" created="Fri, 26 Mar 2010 14:59:46 +0000"  >&lt;p&gt;1.3.x has been building for me with Donald&apos;s last round of changes, fwiw. &lt;/p&gt;

&lt;p&gt;I&apos;ll take a look again this weekend and maybe merge to 1.2.x / 1.0.x. &lt;/p&gt;</comment>
                            <comment id="12857499" author="mikedd" created="Thu, 15 Apr 2010 20:22:30 +0100"  >&lt;p&gt;reopening to indicate it&apos;s fixed in 1.0.4 and 1.2.3&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12438365" name="OPENJPA-1557.diff.txt" size="4115" author="mikedd" created="Wed, 10 Mar 2010 03:16:52 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Mar 2010 03:15:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161820</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyt2mv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>203607</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>