<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:39:14 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-2373/OPENJPA-2373.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-2373] MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL </title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-2373</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;A MapsId annotation in entity C (child) annotates a field p of type P (parent). P uses auto-generated identity. &lt;br/&gt;
P-C is a bidirectional parent-child relationship.&lt;/p&gt;

&lt;p&gt;During flush sequence, A row is created for P and flushed for the database to assign an identity. When C is flushed, it wrongly creates a row for P again while handling the field p that points to parent.&lt;/p&gt;

&lt;p&gt;Of course, the commit breaks with a DuplicateKeyException on P&apos;s table. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12643463">OPENJPA-2373</key>
            <summary>MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="ppoddar@apache.org">Pinaki Poddar</assignee>
                                    <reporter username="ppoddar@apache.org">Pinaki Poddar</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Apr 2013 01:06:41 +0100</created>
                <updated>Sun, 5 Apr 2015 17:16:58 +0100</updated>
                                            <version>2.0.0</version>
                    <version>2.0.1</version>
                    <version>2.1.1</version>
                    <version>2.2.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13635879" author="jira-bot" created="Fri, 19 Apr 2013 01:12:39 +0100"  >&lt;p&gt;Commit 1469646 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ppoddar%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;ppoddar@apache.org&quot;&gt;Pinaki Poddar&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1469646&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1469646&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: Add toString() for debugging&lt;/p&gt;</comment>
                            <comment id="13635899" author="jira-bot" created="Fri, 19 Apr 2013 01:55:17 +0100"  >&lt;p&gt;Commit 1469649 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ppoddar%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;ppoddar@apache.org&quot;&gt;Pinaki Poddar&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1469649&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1469649&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: special processing path for MapsId with auto-generated identity&lt;/p&gt;</comment>
                            <comment id="13635903" author="jira-bot" created="Fri, 19 Apr 2013 01:58:33 +0100"  >&lt;p&gt;Commit 1469652 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ppoddar%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;ppoddar@apache.org&quot;&gt;Pinaki Poddar&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1469652&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1469652&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: test case for MapsId with auto-generated identity&lt;/p&gt;</comment>
                            <comment id="13635905" author="jira-bot" created="Fri, 19 Apr 2013 02:01:37 +0100"  >&lt;p&gt;Commit 1469653 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ppoddar%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;ppoddar@apache.org&quot;&gt;Pinaki Poddar&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1469653&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1469653&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: Add toString() for debugging&lt;/p&gt;</comment>
                            <comment id="13649374" author="allee8285" created="Sun, 5 May 2013 18:23:33 +0100"  >&lt;p&gt;TestMapsIdWithAutoGeneratedKey was introduced in r1469652. This passes against Derby but failed with Oracle withe the following error. Based on the symptom, this may be related to the error introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2328&quot; title=&quot;NPE caused by one too many calls on the iterator inside the library.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2328&quot;&gt;&lt;del&gt;OPENJPA-2328&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2378&quot; title=&quot;TestHandlerStrategy.testIssue_OPENJPA2328 failed with Oracle&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2378&quot;&gt;&lt;del&gt;OPENJPA-2378&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;     73   &amp;lt;testcase time=&quot;1.374&quot; classname=&quot;org.apache.openjpa.persistence.inheritance.jointable.onetomany.TestMapsIdWithAutoGeneratedKey&quot; name=&quot;testPersistShirtWithPart&quot;&amp;gt;&lt;br/&gt;
     74     &amp;lt;error message=&quot;The transaction has been rolled back.  See the nested exceptions for details on the errors that occurred.&quot; type=&quot;&amp;lt;openjpa-2.3.0-SNAPSHOT-r422266&quot;&amp;gt;&amp;lt;openjpa-2.3.0-SN        APSHOT-r422266:1469652 fatal store error&amp;gt; org.apache.openjpa.persistence.RollbackException: The transaction has been rolled back.  See the nested exceptions for details on the errors tha        t occurred.&lt;br/&gt;
     75 FailedObject: org.apache.openjpa.persistence.common.apps.Shirt@426b51d8&lt;br/&gt;
     76   at org.apache.openjpa.persistence.EntityManagerImpl.commit(EntityManagerImpl.java:594)&lt;br/&gt;
     77   at org.apache.openjpa.persistence.inheritance.jointable.onetomany.TestMapsIdWithAutoGeneratedKey.testPersistShirtWithPart(TestMapsIdWithAutoGeneratedKey.java:94)&lt;br/&gt;
     78   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;/p&gt;

&lt;p&gt;......&lt;/p&gt;

&lt;p&gt;    108 Caused by: &amp;lt;openjpa-2.3.0-SNAPSHOT-r422266:1469652 fatal general error&amp;gt; org.apache.openjpa.persistence.PersistenceException: The transaction has been rolled back.  See the nested exce        ptions for details on the errors that occurred.&lt;br/&gt;
    109 FailedObject: org.apache.openjpa.persistence.common.apps.Shirt@426b51d8&lt;br/&gt;
    110   at org.apache.openjpa.kernel.BrokerImpl.newFlushException(BrokerImpl.java:2366)&lt;br/&gt;
    111   at org.apache.openjpa.kernel.BrokerImpl.flush(BrokerImpl.java:2203)&lt;br/&gt;
    112   at org.apache.openjpa.kernel.BrokerImpl.flushSafe(BrokerImpl.java:2101)&lt;br/&gt;
    113   at org.apache.openjpa.kernel.BrokerImpl.beforeCompletion(BrokerImpl.java:2019)&lt;br/&gt;
    114   at org.apache.openjpa.kernel.LocalManagedRuntime.commit(LocalManagedRuntime.java:81)&lt;br/&gt;
    115   at org.apache.openjpa.kernel.BrokerImpl.commit(BrokerImpl.java:1524)&lt;br/&gt;
    116   at org.apache.openjpa.kernel.DelegatingBroker.commit(DelegatingBroker.java:933)&lt;br/&gt;
    117   at org.apache.openjpa.persistence.EntityManagerImpl.commit(EntityManagerImpl.java:570)&lt;br/&gt;
    118   ... 31 more&lt;br/&gt;
    119 Caused by: &amp;lt;openjpa-2.3.0-SNAPSHOT-r422266:1469652 fatal store error&amp;gt; org.apache.openjpa.persistence.EntityExistsException: ORA-01400: cannot insert NULL into (&amp;quot;SCOTT&amp;quot;.&amp;amp;quot        ;MPTZZT&amp;quot;.&amp;quot;ID_TXE&amp;quot;)&lt;br/&gt;
    120  &lt;/p&gt;
{prepstmnt 259984788 INSERT INTO MPTZZT (NA_TXE) VALUES (?)} &lt;span class=&quot;error&quot;&gt;&amp;#91;code=1400, state=23000&amp;#93;&lt;/span&gt;&lt;br/&gt;
    121 FailedObject: org.apache.openjpa.persistence.common.apps.Shirt@426b51d8&lt;br/&gt;
    122   at org.apache.openjpa.jdbc.sql.DBDictionary.narrow(DBDictionary.java:4942)&lt;br/&gt;
    123   at org.apache.openjpa.jdbc.sql.DBDictionary.newStoreException(DBDictionary.java:4917)&lt;br/&gt;
    124   at org.apache.openjpa.jdbc.sql.SQLExceptions.getStore(SQLExceptions.java:136)&lt;br/&gt;
    125   at org.apache.openjpa.jdbc.sql.SQLExceptions.getStore(SQLExceptions.java:78)&lt;br/&gt;
    126   at org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.flushAndUpdate(PreparedStatementManagerImpl.java:144)&lt;br/&gt;
    127   at org.apache.openjpa.jdbc.kernel.BatchingPreparedStatementManagerImpl.flushAndUpdate(BatchingPreparedStatementManagerImpl.java:79)&lt;br/&gt;
    128   at org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.flushInternal(PreparedStatementManagerImpl.java:100)&lt;br/&gt;
    129   at org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.flush(PreparedStatementManagerImpl.java:88)&lt;br/&gt;
    130   at org.apache.openjpa.jdbc.kernel.ConstraintUpdateManager.flush(ConstraintUpdateManager.java:357)&lt;br/&gt;
    131   at org.apache.openjpa.jdbc.kernel.ConstraintUpdateManager.flushGraph(ConstraintUpdateManager.java:349)&lt;br/&gt;
    132   at org.apache.openjpa.jdbc.kernel.ConstraintUpdateManager.flush(ConstraintUpdateManager.java:97)&lt;br/&gt;
    133   at org.apache.openjpa.jdbc.kernel.BatchingConstraintUpdateManager.flush(BatchingConstraintUpdateManager.java:59)&lt;br/&gt;
    134   at org.apache.openjpa.jdbc.kernel.AbstractUpdateManager.flush(AbstractUpdateManager.java:105)&lt;br/&gt;
    135   at org.apache.openjpa.jdbc.kernel.AbstractUpdateManager.flush(AbstractUpdateManager.java:78)&lt;br/&gt;
    136   at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.flush(JDBCStoreManager.java:732)&lt;br/&gt;
    137   at org.apache.openjpa.kernel.DelegatingStoreManager.flush(DelegatingStoreManager.java:131)&lt;br/&gt;
    138   ... 38 more&lt;br/&gt;
    139 Caused by: org.apache.openjpa.lib.jdbc.ReportingSQLException: ORA-01400: cannot insert NULL into (&amp;quot;SCOTT&amp;quot;.&amp;quot;MPTZZT&amp;quot;.&amp;quot;ID_TXE&amp;quot;)&lt;br/&gt;
    140  {prepstmnt 259984788 INSERT INTO MPTZZT (NA_TXE) VALUES (?)}
&lt;p&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;code=1400, state=23000&amp;#93;&lt;/span&gt;&lt;br/&gt;
    141   at org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator.wrap(LoggingConnectionDecorator.java:219)&lt;br/&gt;
    142   at org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator.wrap(LoggingConnectionDecorator.java:195)&lt;br/&gt;
    143   at org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator.access$1000(LoggingConnectionDecorator.java:59)&lt;br/&gt;
    144   at org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator$LoggingConnection$LoggingPreparedStatement.executeUpdate(LoggingConnectionDecorator.java:1134)&lt;br/&gt;
    145   at org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:275)&lt;br/&gt;
    146   at org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:275)&lt;br/&gt;
    147   at org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.executeUpdate(PreparedStatementManagerImpl.java:268)&lt;br/&gt;
    148   at org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.flushAndUpdate(PreparedStatementManagerImpl.java:119)&lt;br/&gt;
    149   ... 49 more&lt;/p&gt;
</comment>
                            <comment id="13649774" author="ppoddar@apache.org" created="Mon, 6 May 2013 15:38:14 +0100"  >
&lt;p&gt;Albert,&lt;br/&gt;
  I will take a look.&lt;br/&gt;
  1. May take a little while.&lt;br/&gt;
  2. Is there a Orace instance that can be accessed outside the BSO&lt;br/&gt;
firewall?&lt;/p&gt;


&lt;p&gt;Regards &amp;#8211;&lt;/p&gt;

&lt;p&gt;Pinaki&lt;/p&gt;








&lt;p&gt;From:	&quot;Albert Lee (JIRA)&quot; &amp;lt;jira@apache.org&amp;gt;&lt;br/&gt;
To:	Pinaki Poddar/Dallas/IBM@IBMUS&lt;br/&gt;
Date:	05/05/2013 10:24 AM&lt;br/&gt;
Subject:	&lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Commented&amp;#93;&lt;/span&gt; (&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;) MapsId in a Child entity to a&lt;br/&gt;
            Parent entity using auto-assigned identity fails with duplicte&lt;br/&gt;
            INSERT SQL&lt;/p&gt;




&lt;p&gt;    [&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=13649374#comment-13649374&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/OPENJPA-2373?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&amp;amp;focusedCommentId=13649374#comment-13649374&lt;/a&gt;&lt;br/&gt;
 ]&lt;/p&gt;

&lt;p&gt;Albert Lee commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;:&lt;br/&gt;
-------------------------------------&lt;/p&gt;

&lt;p&gt;TestMapsIdWithAutoGeneratedKey was introduced in r1469652. This passes&lt;br/&gt;
against Derby but failed with Oracle withe the following error. Based on&lt;br/&gt;
the symptom, this may be related to the error introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2328&quot; title=&quot;NPE caused by one too many calls on the iterator inside the library.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2328&quot;&gt;&lt;del&gt;OPENJPA-2328&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
and &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2378&quot; title=&quot;TestHandlerStrategy.testIssue_OPENJPA2328 failed with Oracle&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2378&quot;&gt;&lt;del&gt;OPENJPA-2378&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;     73   &amp;lt;testcase time=&quot;1.374&quot;&lt;br/&gt;
classname=&quot;org.apache.openjpa.persistence.inheritance.jointable.onetomany.TestMapsIdWithAutoGeneratedKey&quot;&lt;br/&gt;
 name=&quot;testPersistShirtWithPart&quot;&amp;gt;&lt;br/&gt;
     74     &amp;lt;error message=&quot;The transaction has been rolled back.  See the&lt;br/&gt;
nested exceptions for details on the errors that occurred.&quot;&lt;br/&gt;
type=&quot;&amp;lt;openjpa-2.3.0-SNAPSHOT-r422266&quot;&amp;gt;&amp;lt;openjpa-2.3.0-SN&lt;br/&gt;
APSHOT-r422266:1469652 fatal store error&amp;gt;&lt;br/&gt;
org.apache.openjpa.persistence.RollbackException: The transaction has been&lt;br/&gt;
rolled back.  See the nested exceptions for details on the errors tha&lt;br/&gt;
t occurred.&lt;br/&gt;
     75 FailedObject:&lt;br/&gt;
org.apache.openjpa.persistence.common.apps.Shirt@426b51d8&lt;br/&gt;
     76   at org.apache.openjpa.persistence.EntityManagerImpl.commit&lt;br/&gt;
(EntityManagerImpl.java:594)&lt;br/&gt;
     77   at&lt;br/&gt;
org.apache.openjpa.persistence.inheritance.jointable.onetomany.TestMapsIdWithAutoGeneratedKey.testPersistShirtWithPart&lt;br/&gt;
(TestMapsIdWithAutoGeneratedKey.java:94)&lt;br/&gt;
     78   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;/p&gt;

&lt;p&gt;......&lt;/p&gt;

&lt;p&gt;    108 Caused by: &amp;lt;openjpa-2.3.0-SNAPSHOT-r422266:1469652 fatal general&lt;br/&gt;
error&amp;gt; org.apache.openjpa.persistence.PersistenceException: The&lt;br/&gt;
transaction has been rolled back.  See the nested exce        ptions for&lt;br/&gt;
details on the errors that occurred.&lt;br/&gt;
    109 FailedObject:&lt;br/&gt;
org.apache.openjpa.persistence.common.apps.Shirt@426b51d8&lt;br/&gt;
    110   at org.apache.openjpa.kernel.BrokerImpl.newFlushException&lt;br/&gt;
(BrokerImpl.java:2366)&lt;br/&gt;
    111   at org.apache.openjpa.kernel.BrokerImpl.flush&lt;br/&gt;
(BrokerImpl.java:2203)&lt;br/&gt;
    112   at org.apache.openjpa.kernel.BrokerImpl.flushSafe&lt;br/&gt;
(BrokerImpl.java:2101)&lt;br/&gt;
    113   at org.apache.openjpa.kernel.BrokerImpl.beforeCompletion&lt;br/&gt;
(BrokerImpl.java:2019)&lt;br/&gt;
    114   at org.apache.openjpa.kernel.LocalManagedRuntime.commit&lt;br/&gt;
(LocalManagedRuntime.java:81)&lt;br/&gt;
    115   at org.apache.openjpa.kernel.BrokerImpl.commit&lt;br/&gt;
(BrokerImpl.java:1524)&lt;br/&gt;
    116   at org.apache.openjpa.kernel.DelegatingBroker.commit&lt;br/&gt;
(DelegatingBroker.java:933)&lt;br/&gt;
    117   at org.apache.openjpa.persistence.EntityManagerImpl.commit&lt;br/&gt;
(EntityManagerImpl.java:570)&lt;br/&gt;
    118   ... 31 more&lt;br/&gt;
    119 Caused by: &amp;lt;openjpa-2.3.0-SNAPSHOT-r422266:1469652 fatal store&lt;br/&gt;
error&amp;gt; org.apache.openjpa.persistence.EntityExistsException: ORA-01400:&lt;br/&gt;
cannot insert NULL into&lt;br/&gt;
(&amp;quot;SCOTT&amp;quot;.&amp;amp;quot        ;MPTZZT&amp;quot;.&amp;quot;ID_TXE&amp;quot;)&lt;br/&gt;
    120  &lt;/p&gt;
{prepstmnt 259984788 INSERT INTO MPTZZT (NA_TXE) VALUES (?)}&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;code=1400, state=23000&amp;#93;&lt;/span&gt;&lt;br/&gt;
    121 FailedObject:&lt;br/&gt;
org.apache.openjpa.persistence.common.apps.Shirt@426b51d8&lt;br/&gt;
    122   at org.apache.openjpa.jdbc.sql.DBDictionary.narrow&lt;br/&gt;
(DBDictionary.java:4942)&lt;br/&gt;
    123   at org.apache.openjpa.jdbc.sql.DBDictionary.newStoreException&lt;br/&gt;
(DBDictionary.java:4917)&lt;br/&gt;
    124   at org.apache.openjpa.jdbc.sql.SQLExceptions.getStore&lt;br/&gt;
(SQLExceptions.java:136)&lt;br/&gt;
    125   at org.apache.openjpa.jdbc.sql.SQLExceptions.getStore&lt;br/&gt;
(SQLExceptions.java:78)&lt;br/&gt;
    126   at&lt;br/&gt;
org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.flushAndUpdate&lt;br/&gt;
(PreparedStatementManagerImpl.java:144)&lt;br/&gt;
    127   at&lt;br/&gt;
org.apache.openjpa.jdbc.kernel.BatchingPreparedStatementManagerImpl.flushAndUpdate&lt;br/&gt;
(BatchingPreparedStatementManagerImpl.java:79)&lt;br/&gt;
    128   at&lt;br/&gt;
org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.flushInternal&lt;br/&gt;
(PreparedStatementManagerImpl.java:100)&lt;br/&gt;
    129   at&lt;br/&gt;
org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.flush&lt;br/&gt;
(PreparedStatementManagerImpl.java:88)&lt;br/&gt;
    130   at org.apache.openjpa.jdbc.kernel.ConstraintUpdateManager.flush&lt;br/&gt;
(ConstraintUpdateManager.java:357)&lt;br/&gt;
    131   at&lt;br/&gt;
org.apache.openjpa.jdbc.kernel.ConstraintUpdateManager.flushGraph&lt;br/&gt;
(ConstraintUpdateManager.java:349)&lt;br/&gt;
    132   at org.apache.openjpa.jdbc.kernel.ConstraintUpdateManager.flush&lt;br/&gt;
(ConstraintUpdateManager.java:97)&lt;br/&gt;
    133   at&lt;br/&gt;
org.apache.openjpa.jdbc.kernel.BatchingConstraintUpdateManager.flush&lt;br/&gt;
(BatchingConstraintUpdateManager.java:59)&lt;br/&gt;
    134   at org.apache.openjpa.jdbc.kernel.AbstractUpdateManager.flush&lt;br/&gt;
(AbstractUpdateManager.java:105)&lt;br/&gt;
    135   at org.apache.openjpa.jdbc.kernel.AbstractUpdateManager.flush&lt;br/&gt;
(AbstractUpdateManager.java:78)&lt;br/&gt;
    136   at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.flush&lt;br/&gt;
(JDBCStoreManager.java:732)&lt;br/&gt;
    137   at org.apache.openjpa.kernel.DelegatingStoreManager.flush&lt;br/&gt;
(DelegatingStoreManager.java:131)&lt;br/&gt;
    138   ... 38 more&lt;br/&gt;
    139 Caused by: org.apache.openjpa.lib.jdbc.ReportingSQLException:&lt;br/&gt;
ORA-01400: cannot insert NULL into&lt;br/&gt;
(&amp;quot;SCOTT&amp;quot;.&amp;quot;MPTZZT&amp;quot;.&amp;quot;ID_TXE&amp;quot;)&lt;br/&gt;
    140  {prepstmnt 259984788 INSERT INTO MPTZZT (NA_TXE) VALUES (?)}
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;code=1400, state=23000&amp;#93;&lt;/span&gt;&lt;br/&gt;
    141   at org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator.wrap&lt;br/&gt;
(LoggingConnectionDecorator.java:219)&lt;br/&gt;
    142   at org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator.wrap&lt;br/&gt;
(LoggingConnectionDecorator.java:195)&lt;br/&gt;
    143   at org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator.access&lt;br/&gt;
$1000(LoggingConnectionDecorator.java:59)&lt;br/&gt;
    144   at org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator&lt;br/&gt;
$LoggingConnection$LoggingPreparedStatement.executeUpdate&lt;br/&gt;
(LoggingConnectionDecorator.java:1134)&lt;br/&gt;
    145   at&lt;br/&gt;
org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate&lt;br/&gt;
(DelegatingPreparedStatement.java:275)&lt;br/&gt;
    146   at&lt;br/&gt;
org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate&lt;br/&gt;
(DelegatingPreparedStatement.java:275)&lt;br/&gt;
    147   at&lt;br/&gt;
org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.executeUpdate&lt;br/&gt;
(PreparedStatementManagerImpl.java:268)&lt;br/&gt;
    148   at&lt;br/&gt;
org.apache.openjpa.jdbc.kernel.PreparedStatementManagerImpl.flushAndUpdate&lt;br/&gt;
(PreparedStatementManagerImpl.java:119)&lt;br/&gt;
    149   ... 49 more&lt;/p&gt;


&lt;p&gt;fails with duplicte INSERT SQL&lt;br/&gt;
--------------------------------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(parent). P uses auto-generated identity.&lt;br/&gt;
database to assign an identity. When C is flushed, it wrongly creates a row&lt;br/&gt;
for P again while handling the field p that points to parent.&lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;br/&gt;
This message is automatically generated by JIRA.&lt;br/&gt;
If you think it was sent incorrectly, please contact your JIRA&lt;br/&gt;
administrators&lt;br/&gt;
For more information on JIRA, see: &lt;a href=&quot;http://www.atlassian.com/software/jira&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.atlassian.com/software/jira&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="13661383" author="jira-bot" created="Sat, 18 May 2013 17:16:32 +0100"  >&lt;p&gt;Commit 1484136 from hthomann&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1484136&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1484136&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL - back ported to 2.0.x Pinaki Poddar&apos;s trunk changes.&lt;/p&gt;</comment>
                            <comment id="13661570" author="jira-bot" created="Sun, 19 May 2013 15:39:39 +0100"  >&lt;p&gt;Commit 1484287 from hthomann&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1484287&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1484287&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL - back ported to 2.0.x Pinaki Poddar&apos;s trunk changes.&lt;/p&gt;</comment>
                            <comment id="13661575" author="jira-bot" created="Sun, 19 May 2013 16:44:24 +0100"  >&lt;p&gt;Commit 1484300 from hthomann&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1484300&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1484300&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL - back ported to 2.1.x Pinaki Poddar&apos;s trunk changes.&lt;/p&gt;</comment>
                            <comment id="13661607" author="jira-bot" created="Sun, 19 May 2013 18:39:42 +0100"  >&lt;p&gt;Commit 1484320 from hthomann&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1484320&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1484320&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL - back ported to 2.2.1.x Pinaki Poddar&apos;s trunk changes.&lt;/p&gt;</comment>
                            <comment id="13661613" author="jira-bot" created="Sun, 19 May 2013 19:01:52 +0100"  >&lt;p&gt;Commit 1484325 from hthomann&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1484325&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1484325&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL - back ported to 2.2.x Pinaki Poddar&apos;s trunk changes.&lt;/p&gt;</comment>
                            <comment id="13663572" author="jira-bot" created="Wed, 22 May 2013 00:23:35 +0100"  >&lt;p&gt;Commit 1485010 from hthomann&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1485010&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1485010&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: Made a test case update given identity auto generated ids do not work so well for some databases.&lt;/p&gt;</comment>
                            <comment id="13663580" author="jira-bot" created="Wed, 22 May 2013 00:27:47 +0100"  >&lt;p&gt;Commit 1485011 from hthomann&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1485011&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1485011&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: Made a test case update given identity auto generated ids do not work so well for some databases.&lt;/p&gt;</comment>
                            <comment id="13663596" author="jira-bot" created="Wed, 22 May 2013 00:39:20 +0100"  >&lt;p&gt;Commit 1485012 from hthomann&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1485012&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1485012&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: Made a test case update given identity auto generated ids do not work so well for some databases.&lt;/p&gt;</comment>
                            <comment id="13663601" author="jira-bot" created="Wed, 22 May 2013 00:43:17 +0100"  >&lt;p&gt;Commit 1485013 from hthomann&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1485013&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1485013&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: Made a test case update given identity auto generated ids do not work so well for some databases.&lt;/p&gt;</comment>
                            <comment id="13680519" author="jira-bot" created="Tue, 11 Jun 2013 19:43:58 +0100"  >&lt;p&gt;Commit 1491895 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpaheath&quot; class=&quot;user-hover&quot; rel=&quot;jpaheath&quot;&gt;Heath Thomann&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1491895&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1491895&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: Made further updates to the test created for this JIRA.&lt;/p&gt;</comment>
                            <comment id="13680549" author="jira-bot" created="Tue, 11 Jun 2013 19:59:12 +0100"  >&lt;p&gt;Commit 1491905 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpaheath&quot; class=&quot;user-hover&quot; rel=&quot;jpaheath&quot;&gt;Heath Thomann&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1491905&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1491905&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: Made further updates to the test created for this JIRA.&lt;/p&gt;</comment>
                            <comment id="13680573" author="jira-bot" created="Tue, 11 Jun 2013 20:23:06 +0100"  >&lt;p&gt;Commit 1491915 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpaheath&quot; class=&quot;user-hover&quot; rel=&quot;jpaheath&quot;&gt;Heath Thomann&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1491915&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1491915&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2373&quot; title=&quot;MapsId in a Child entity to a Parent entity using auto-assigned identity fails with duplicte INSERT SQL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2373&quot;&gt;OPENJPA-2373&lt;/a&gt;: Made updates to the test created for this JIRA.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12581891" name="graycol.gif" size="105" author="ppoddar@apache.org" created="Mon, 6 May 2013 15:38:14 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 19 Apr 2013 00:12:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323830</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzdpyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>324175</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>