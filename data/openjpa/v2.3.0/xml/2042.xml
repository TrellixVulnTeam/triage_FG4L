<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:30:07 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-2042/OPENJPA-2042.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-2042] Diagnostics for Application Managed EntityManagerFactory leaks.</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-2042</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;EntityManagerFactories can be leaked if they are created with the JSE bootstrap Persistence class and are never closed, causing an OutOfMemoryException.&lt;/p&gt;

&lt;p&gt;One possibility may be to log a warning or otherwise alert the developer when the number of unclosed EMF&apos;s reaches a certain threshold. An extra step could be taken here to track where the EMF&apos;s are being opened and which ones aren&apos;t being closed as to show the developer exactly where in the code the problem is occurring.&lt;/p&gt;

&lt;p&gt;There may be a possibility to eliminate this leak by making the references to the EMF&apos;s weak and let the garbage collector clean up the unclosed EMF&apos;s. However, in the case that other objects are being leaked as well, this change may make it harder to detect such leaks.&lt;/p&gt;

&lt;p&gt;I ran a simple test that creates a EMF from Persistence. It then creates and closes an EntityManger. A new EMF is then created without closing the old one, effectively &quot;leaking&quot; it. As expected, this results in an OutOfMemoryException. When using weak references on the EMF&apos;s, I was able to get the test to run all night without a trace of any heap growth. However, this is only a very simple test and a test with more Entities/Configurations/etc. may result in heap growth due to other objects being leaked(as mentioned earlier). My test case is attached.&lt;/p&gt;

&lt;p&gt;For comparison, I tried the same test on Hibernate and EclipseLink. Hibernate runs into the same OutOfMemoryException. EclipseLink does not.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12519443">OPENJPA-2042</key>
            <summary>Diagnostics for Application Managed EntityManagerFactory leaks.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="curtisr7">Rick Curtis</assignee>
                                    <reporter username="jtnowosatka">Jacob Nowosatka</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Aug 2011 18:53:07 +0100</created>
                <updated>Wed, 10 Apr 2013 21:51:17 +0100</updated>
                            <resolved>Wed, 10 Apr 2013 21:51:17 +0100</resolved>
                                    <version>1.0.4</version>
                    <version>1.2.2</version>
                    <version>2.0.1</version>
                    <version>2.1.0</version>
                                    <fixVersion>1.2.3</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13099041" author="curtisr7" created="Wed, 7 Sep 2011 16:45:55 +0100"  >&lt;p&gt;Jake - Do you have a patch to fix this issue?&lt;/p&gt;</comment>
                            <comment id="13099228" author="jtnowosatka" created="Wed, 7 Sep 2011 20:08:57 +0100"  >&lt;p&gt;Patch changes the references to EMF&apos;s to weak references.&lt;/p&gt;</comment>
                            <comment id="13105433" author="mikedd" created="Thu, 15 Sep 2011 16:36:31 +0100"  >&lt;p&gt;The patch looks good, thanks Jacob. &lt;/p&gt;</comment>
                            <comment id="13145527" author="curtisr7" created="Mon, 7 Nov 2011 14:36:48 +0000"  >&lt;p&gt;Reopening this issue as I think this might be causing a failure on Jenkins&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://builds.apache.org/job/OpenJPA-trunk-deploy/org.apache.openjpa$openjpa-persistence-jdbc/200/consoleText&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/OpenJPA-trunk-deploy/org.apache.openjpa$openjpa-persistence-jdbc/200/consoleText&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13145567" author="curtisr7" created="Mon, 7 Nov 2011 15:46:05 +0000"  >&lt;p&gt;Committed revision 1198786 to trunk. I added a null check in PCRegistry to fix the following problem:&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.openjpa.enhance.PCRegistry.register(PCRegistry.java:210)&lt;br/&gt;
	at org.apache.openjpa.persistence.jdbc.maps.m2mmapex3.FullName.&amp;lt;clinit&amp;gt;(FullName.java)&lt;br/&gt;
	... 38 more&lt;/p&gt;</comment>
                            <comment id="13198984" author="allee8285" created="Thu, 2 Feb 2012 17:13:52 +0000"  >&lt;p&gt;Close issue in preparation for 2.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12493363" name="OPENJPA-2042.patch" size="1381" author="jtnowosatka" created="Wed, 7 Sep 2011 20:08:57 +0100"/>
                            <attachment id="12491207" name="TestEMFMemoryLeak.java" size="1696" author="jtnowosatka" created="Mon, 22 Aug 2011 15:21:56 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 7 Sep 2011 15:45:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2284</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7pl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>289115</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>