<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:36:50 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-210/OPENJPA-210.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-210] Query returning 2 entities w/1-1 relationship returns wrong types in the result list</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-210</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Query returning 2 entities w/1-1 relationship returns &lt;span class=&quot;error&quot;&gt;&amp;#91;Address, Address&amp;#93;&lt;/span&gt;  instead of &lt;span class=&quot;error&quot;&gt;&amp;#91;Winery, Address&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&quot;SELECT r,r.address from Winery r&quot; returns &lt;span class=&quot;error&quot;&gt;&amp;#91;Address, Address&amp;#93;&lt;/span&gt; &lt;br/&gt;
&quot;SELECT r,r.home from EmpBean r&quot; returns &lt;span class=&quot;error&quot;&gt;&amp;#91;null, AddressBean&amp;#93;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;does not matter if 1-1 relationship is uni-directional or bi-directional&lt;/p&gt;

&lt;p&gt;(NOTE: &quot;SELECT r.address,r&quot; gets same Address id already exists in the L1 cache  if uni-dir relationship (issue 209))  &lt;/p&gt;

&lt;p&gt;clear detaches all entities from the persistent context&lt;br/&gt;
1302  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Query - Executing query: SELECT r,r.home FROM EmpBean r&lt;br/&gt;
1302  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 755379462&amp;gt; executing prepstmnt 335287292 SELECT t0.empid, t1.street, t1.city, t1.state, t1.zip FROM bugsmallEmpBean t0 LEFT OUTER JOIN bugsmallAddressBean t1 ON t0.home_street = t1.street&lt;br/&gt;
1302  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 755379462&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0 ms&amp;#93;&lt;/span&gt; spent&lt;br/&gt;
1302  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 755379462&amp;gt; executing prepstmnt 695216496 SELECT t0.city, t0.state, t0.zip FROM bugsmallAddressBean t0 WHERE t0.street = ? &lt;span class=&quot;error&quot;&gt;&amp;#91;params=(String) 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
1312  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 755379462&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;10 ms&amp;#93;&lt;/span&gt; spent&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at com.ibm.websphere.ejb3sample.winetour.bugsmall.BugSmallWineryTest.test_1_1relationshipQuery_EmpBean_AddressBean(BugSmallWineryTest.java:468)&lt;br/&gt;
	at com.ibm.websphere.ejb3sample.winetour.bugsmall.BugSmallWineryTest.main(BugSmallWineryTest.java:103)&lt;br/&gt;
1352  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.Query - Executing query: &lt;span class=&quot;error&quot;&gt;&amp;#91;SELECT r,r.address FROM Winery r WHERE r.wineryid = ?1&amp;#93;&lt;/span&gt; with parameters: &lt;/p&gt;
{1=1}
&lt;p&gt;1352  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 755379462&amp;gt; executing prepstmnt 1670669204 SELECT t0.wineryid, t1.phone, t1.city, t1.state, t1.street, t1.zip FROM bugsmallWinery t0 LEFT OUTER JOIN bugsmallAddress t1 ON t0.address_phone = t1.phone WHERE (t0.wineryid = ?) &lt;span class=&quot;error&quot;&gt;&amp;#91;params=(int) 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
1362  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 755379462&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;10 ms&amp;#93;&lt;/span&gt; spent&lt;br/&gt;
1362  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 755379462&amp;gt; executing prepstmnt 2097052926 SELECT t0.city, t0.state, t0.street, t0.zip FROM bugsmallAddress t0 WHERE t0.phone = ? &lt;span class=&quot;error&quot;&gt;&amp;#91;params=(String) 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
1512  bugsmall  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 755379462&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0 ms&amp;#93;&lt;/span&gt; spent&lt;br/&gt;
java.lang.ClassCastException: com.ibm.websphere.ejb3sample.winetour.bugsmall.Address incompatible with com.ibm.websphere.ejb3sample.winetour.bugsmall.Winery&lt;br/&gt;
	at com.ibm.websphere.ejb3sample.winetour.bugsmall.BugSmallWineryTest.test_1_1relationshipQuery_Winery_Address(BugSmallWineryTest.java:374)&lt;br/&gt;
	at com.ibm.websphere.ejb3sample.winetour.bugsmall.BugSmallWineryTest.main(BugSmallWineryTest.java:104)&lt;br/&gt;
close(only used for application managed Persistent Context) inactivates the EntityManager and detaches all entities&lt;br/&gt;
create new Application Managed Persistent Context with no managed entities&lt;/p&gt;

&lt;p&gt;====================================&lt;br/&gt;
Starting test_1_1relationshipQuery_EmpBean_AddressBean()&lt;br/&gt;
====================================&lt;br/&gt;
Shows a EmpBean and its address&lt;br/&gt;
String sql = &quot;SELECT r,r.home FROM EmpBean r WHERE r.empid = ?1&quot;&lt;br/&gt;
Caution: requires _em.find(EmpBean.class,parm1) to avoid cache exception or incorrect types in result list&lt;br/&gt;
Caution: &quot;SELECT r,r.home&quot; currently fails, returns &lt;span class=&quot;error&quot;&gt;&amp;#91;null, AddressBean&amp;#93;&lt;/span&gt; instead of &lt;span class=&quot;error&quot;&gt;&amp;#91;EmpBean, AddressBean&amp;#93;&lt;/span&gt;&lt;br/&gt;
-----------------------------------------------------------------------------&lt;br/&gt;
1-1 query oa&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; is null &lt;br/&gt;
1-1 query oa&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; = com.ibm.websphere.ejb3sample.winetour.bugsmall.AddressBean&lt;/p&gt;

&lt;p&gt;====================================&lt;br/&gt;
Starting test_1_1relationshipQuery_Winery_Address()&lt;br/&gt;
====================================&lt;br/&gt;
Shows a winery and its address&lt;br/&gt;
String sql = &quot;SELECT r,r.address FROM Winery r WHERE r.wineryid = :wineryid &quot;&lt;br/&gt;
Caution: requires _em.find(Winery.class,parm1) to avoid cache exception or incorrect types in result list&lt;br/&gt;
Caution: &quot;SELECT r,r.address&quot; currently fails, returns &lt;span class=&quot;error&quot;&gt;&amp;#91;Address, Address&amp;#93;&lt;/span&gt; instead of &lt;span class=&quot;error&quot;&gt;&amp;#91;Winery, Address&amp;#93;&lt;/span&gt;&lt;br/&gt;
-----------------------------------------------------------------------------&lt;br/&gt;
1-1 query oa&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; = com.ibm.websphere.ejb3sample.winetour.bugsmall.Address&lt;br/&gt;
1-1 query oa&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; = com.ibm.websphere.ejb3sample.winetour.bugsmall.Address&lt;/p&gt;

</description>
                <environment>0.9.7-incubating-SNAPSHOT,  windows, db2</environment>
        <key id="12366751">OPENJPA-210</key>
            <summary>Query returning 2 entities w/1-1 relationship returns wrong types in the result list</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kwsutter">Kevin Sutter</assignee>
                                    <reporter username="ghongell">George Hongell</reporter>
                        <labels>
                    </labels>
                <created>Sat, 7 Apr 2007 00:27:29 +0100</created>
                <updated>Tue, 9 Mar 2010 18:32:33 +0000</updated>
                            <resolved>Fri, 11 Jul 2008 15:33:47 +0100</resolved>
                                    <version>0.9.7</version>
                                    <fixVersion>1.0.4</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12487357" author="ghongell" created="Sat, 7 Apr 2007 00:30:19 +0100"  >&lt;p&gt;run main method of BugSmallWineryTest in attached application to reproduce error&lt;/p&gt;</comment>
                            <comment id="12487362" author="ghongell" created="Sat, 7 Apr 2007 00:51:27 +0100"  >&lt;p&gt;The same test on a similar application fails with java.lang.InstantiationException: java.lang.Integer&lt;br/&gt;
String sql = &quot;SELECT r,r.home FROM EmpBean r&quot;;&lt;/p&gt;

&lt;p&gt;clear detaches all entities from the persistent context&lt;br/&gt;
2463  mdd  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 1297894748&amp;gt; executing prepstmnt 96339390 SELECT t0.empid, t1.street, t1.city, t1.state, t1.zip FROM EmpBean t0 LEFT OUTER JOIN AddressBean t1 ON t0.home_street = t1.street&lt;br/&gt;
2463  mdd  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.jdbc.SQL - &amp;lt;t 1094861122, conn 1297894748&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;0 ms&amp;#93;&lt;/span&gt; spent&lt;br/&gt;
&amp;lt;0|false|0.9.7-incubating-SNAPSHOT&amp;gt; org.apache.openjpa.persistence.PersistenceException: java.lang.Integer&lt;br/&gt;
	at org.apache.openjpa.util.ApplicationIds.copy(ApplicationIds.java:301)&lt;br/&gt;
	at org.apache.openjpa.util.ApplicationIds.copy(ApplicationIds.java:239)&lt;br/&gt;
	at org.apache.openjpa.kernel.StateManagerImpl.initialize(StateManagerImpl.java:236)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initializeState(JDBCStoreManager.java:327)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initialize(JDBCStoreManager.java:252)&lt;br/&gt;
	at org.apache.openjpa.kernel.DelegatingStoreManager.initialize(DelegatingStoreManager.java:108)&lt;br/&gt;
	at org.apache.openjpa.kernel.ROPStoreManager.initialize(ROPStoreManager.java:54)&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.initialize(BrokerImpl.java:873)&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:831)&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:753)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:773)&lt;br/&gt;
	at org.apache.openjpa.jdbc.sql.AbstractResult.load(AbstractResult.java:254)&lt;br/&gt;
	at org.apache.openjpa.jdbc.sql.SelectImpl$SelectResult.load(SelectImpl.java:2115)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.exps.PCPath.load(PCPath.java:684)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.exps.PCPath.load(PCPath.java:672)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.ProjectionResultObjectProvider.getResultObject(ProjectionResultObjectProvider.java:73)&lt;br/&gt;
	at org.apache.openjpa.lib.rop.EagerResultList.&amp;lt;init&amp;gt;(EagerResultList.java:33)&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.toResult(QueryImpl.java:1214)&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:981)&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:791)&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:761)&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:757)&lt;br/&gt;
	at org.apache.openjpa.kernel.DelegatingQuery.execute(DelegatingQuery.java:512)&lt;br/&gt;
	at org.apache.openjpa.persistence.QueryImpl.execute(QueryImpl.java:225)&lt;br/&gt;
	at org.apache.openjpa.persistence.QueryImpl.getResultList(QueryImpl.java:264)&lt;br/&gt;
	at com.ibm.ws.query.tests.BugTest.test_1_1relationshipQuery_EmpBean_AddressBean(BugTest.java:252)&lt;br/&gt;
	at com.ibm.ws.query.tests.BugTest.main(BugTest.java:96)&lt;br/&gt;
Caused by: java.lang.InstantiationException: java.lang.Integer&lt;br/&gt;
	at java.lang.Class.newInstanceImpl(Native Method)&lt;br/&gt;
	at java.lang.Class.newInstance(Class.java:1243)&lt;br/&gt;
	at org.apache.openjpa.util.ApplicationIds.copy(ApplicationIds.java:299)&lt;br/&gt;
	... 26 more&lt;br/&gt;
close(only used for application managed Persistent Context) inactivates the EntityManager and detaches all entities&lt;br/&gt;
create new Application Managed Persistent Context with no managed entities&lt;/p&gt;

&lt;p&gt;====================================&lt;br/&gt;
Starting test_1_1relationshipQuery_EmpBean_AddressBean()&lt;br/&gt;
====================================&lt;br/&gt;
Shows a EmpBean and its address&lt;br/&gt;
String sql = &quot;SELECT r.home,r FROM EmpBean r WHERE r.empid = ?1&quot;&lt;br/&gt;
Caution: requires _em.find(EmpBean.class,parm1) to avoid cache exception&lt;br/&gt;
Caution: &quot;SELECT r,r.home&quot; currently fails, returns &lt;span class=&quot;error&quot;&gt;&amp;#91;AddressBean, AddressBean&amp;#93;&lt;/span&gt; instead of &lt;span class=&quot;error&quot;&gt;&amp;#91;EmpBean, AddressBean&amp;#93;&lt;/span&gt;&lt;br/&gt;
-----------------------------------------------------------------------------&lt;/p&gt;</comment>
                            <comment id="12519016" author="kwsutter" created="Fri, 10 Aug 2007 14:35:23 +0100"  >&lt;p&gt;Some of the problems identified in this Issue sound very similar to other problems that I am currently driving.  I&apos;ll take a look at this Issue and see where it goes.&lt;/p&gt;</comment>
                            <comment id="12521482" author="mprudhom" created="Tue, 21 Aug 2007 15:57:08 +0100"  >&lt;p&gt;Bumping to release 1.0.1 since 1.0.0 is being released.&lt;/p&gt;</comment>
                            <comment id="12538833" author="allee8285" created="Tue, 30 Oct 2007 16:15:20 +0000"  >&lt;p&gt;Defer to next release.&lt;/p&gt;</comment>
                            <comment id="12612348" author="mikedd" created="Thu, 10 Jul 2008 03:12:45 +0100"  >&lt;p&gt;Defer to next release. &lt;/p&gt;</comment>
                            <comment id="12612888" author="ppoddar@apache.org" created="Fri, 11 Jul 2008 15:33:47 +0100"  >&lt;p&gt;Consider not deferring.&lt;br/&gt;
Resolved with r666515 (2008-06-10).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12355112" name="1_1WrongReturnTypesBugWineryTest.zip" size="19415" author="ghongell" created="Sat, 7 Apr 2007 00:30:19 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 10 Aug 2007 13:35:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160541</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hysytb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>202988</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>