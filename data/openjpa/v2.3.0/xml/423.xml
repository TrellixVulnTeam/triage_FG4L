<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:33:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-423/OPENJPA-423.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-423] Deadlock victim exception getting sequence value with SQLServer</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-423</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Opening a JIRA issue for the following problem, originally posted to openjpa-dev mailing list. &lt;/p&gt;

&lt;p&gt;I&apos;ve run into tricky issue with Sequence tables on SQLServer.&lt;/p&gt;

&lt;p&gt;After some time during a stress test I get this exception when trying to update the sequence table:&lt;br/&gt;
openjpa.jdbc.SQL: Trace: &amp;lt;t 25198719, conn 17636058&amp;gt; executing prepstmnt 4953425 SELECT SEQUENCE_VALUE FROM OPENJPA_SEQUENCE_TABLE WHERE ID = ? &lt;span class=&quot;error&quot;&gt;&amp;#91;params=(int) 0&amp;#93;&lt;/span&gt;&lt;br/&gt;
. . .&lt;br/&gt;
openjpa.jdbc.SQL: Trace: &amp;lt;t 25198719, conn 17636058&amp;gt; executing prepstmnt 19626156 UPDATE OPENJPA_SEQUENCE_TABLE SET SEQUENCE_VALUE = ? WHERE ID = ? AND SEQUENCE_VALUE = ? &lt;span class=&quot;error&quot;&gt;&amp;#91;params=(long) 48601, (int) 0, (long) 48551&amp;#93;&lt;/span&gt;&lt;br/&gt;
. . .&lt;br/&gt;
java.sql.SQLException: &lt;span class=&quot;error&quot;&gt;&amp;#91;IBM&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQLServer JDBC Driver&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;SQLServer&amp;#93;&lt;/span&gt;Transaction (Process ID 85) was deadlocked on lock resources with another process and has been chosen as the deadlock victim. Rerun the transaction.&lt;br/&gt;
    at com.ibm.websphere.jdbc.base.BaseExceptions.createException(Unknown Source)&lt;br/&gt;
    at com.ibm.websphere.jdbc.base.BaseExceptions.getException(Unknown Source)&lt;br/&gt;
 . . .&lt;br/&gt;
    at org.apache.openjpa.lib.jdbc.DelegatingPreparedStatement.executeUpdate (DelegatingPreparedStatement.java:269)&lt;br/&gt;
    at org.apache.openjpa.lib.jdbc.LoggingConnectionDecorator$LoggingConnection$LoggingPreparedStatement.executeUpdate(LoggingConnectionDecorator.java:856)&lt;/p&gt;

&lt;p&gt;I believe I&apos;m hitting the exception because SQLServer doesn&apos;t support the FOR UPDATE clause. Normally the first SQL statement shown above would have locked the row preventing the deadlock. SQLServer does support the WITH (UPDLOCK) hint, but I haven&apos;t found a convenient way to isolate the change so that it only affects TableSequences.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12381324">OPENJPA-423</key>
            <summary>Deadlock victim exception getting sequence value with SQLServer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikedd">Michael Dick</assignee>
                                    <reporter username="mikedd">Michael Dick</reporter>
                        <labels>
                    </labels>
                <created>Sun, 28 Oct 2007 13:58:06 +0000</created>
                <updated>Mon, 29 Oct 2007 15:48:45 +0000</updated>
                            <resolved>Mon, 29 Oct 2007 15:48:45 +0000</resolved>
                                    <version>0.9.6</version>
                    <version>0.9.7</version>
                    <version>1.0.0</version>
                                    <fixVersion>1.0.1</fixVersion>
                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                        <attachments>
                            <attachment id="12368559" name="OPENJPA-423.patch.txt" size="5264" author="mikedd" created="Sun, 28 Oct 2007 13:58:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160745</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyszbj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>203070</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>