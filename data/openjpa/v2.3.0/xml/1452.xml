<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:36:43 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1452/OPENJPA-1452.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1452] OpenJPA 2.0.0-M3 attempts to mutate unmodifiable map in Glassfish</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1452</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;OpenJPA Attempts to modiy an umodifiable map in Glassfish.&lt;/p&gt;

&lt;p&gt;Similar issue to:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-498&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/OPENJPA-498&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To reproduce:&lt;br/&gt;
+ Place the open jpa libs in &lt;span class=&quot;error&quot;&gt;&amp;#91;glassfish&amp;#93;&lt;/span&gt;/domain/domains1/lib&lt;br/&gt;
+ Deploy any app or jar using openjpa as the persistence provider&lt;br/&gt;
    &amp;lt;provider&amp;gt;org.apache.openjpa.persistence.PersistenceProviderImpl&amp;lt;/provider&amp;gt;&lt;/p&gt;

&lt;p&gt;trace:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;#|2010-01-02T19:42:27.581+0100|INFO|sun-glassfish-comms-server1.5|javax.enterprise.system.tools.deployment|_ThreadID=17;_ThreadName=Timer-12;|deployed with moduleid = gs-apps_EJB|#&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;[#|2010-01-02T19:42:27.834+0100|WARNING|sun-glassfish-comms-server1.5|javax.enterprise.system.core.classloading|_ThreadID=17;_ThreadName=Timer-12;_RequestID=68741cc4-049e-4f05-a6f5-fab7d336f48e;|The log message is null.&lt;br/&gt;
java.lang.UnsupportedOperationException&lt;br/&gt;
	at java.util.Collections$UnmodifiableMap.remove(Collections.java:1288)&lt;br/&gt;
	at org.apache.openjpa.lib.conf.Configurations.removeProperty(Configurations.java:681)&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceProviderImpl.createContainerEntityManagerFactory(PersistenceProviderImpl.java:157)&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceProviderImpl.createContainerEntityManagerFactory(PersistenceProviderImpl.java:59)&lt;br/&gt;
	at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:149)&lt;br/&gt;
	at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:84)&lt;br/&gt;
	at com.sun.enterprise.server.AbstractLoader.loadPersistenceUnits(AbstractLoader.java:895)&lt;br/&gt;
	at com.sun.enterprise.server.EJBModuleLoader.doLoad(EJBModuleLoader.java:165)&lt;br/&gt;
	at com.sun.enterprise.server.AbstractLoader.load(AbstractLoader.java:238)&lt;br/&gt;
	at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:233)&lt;br/&gt;
	at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:188)&lt;br/&gt;
	at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:420)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.invokeModuleDeployEventListener(AdminEventMulticaster.java:1005)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.handleModuleDeployEvent(AdminEventMulticaster.java:992)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.processEvent(AdminEventMulticaster.java:470)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.multicastEvent(AdminEventMulticaster.java:182)&lt;br/&gt;
	at com.sun.enterprise.admin.server.core.DeploymentNotificationHelper.multicastEvent(DeploymentNotificationHelper.java:308)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.DeploymentServiceUtils.multicastEvent(DeploymentServiceUtils.java:231)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.ServerDeploymentTarget.sendStartEvent(ServerDeploymentTarget.java:298)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.ApplicationStartPhase.runPhase(ApplicationStartPhase.java:132)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.DeploymentPhase.executePhase(DeploymentPhase.java:108)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.PEDeploymentService.executePhases(PEDeploymentService.java:966)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.PEDeploymentService.deploy(PEDeploymentService.java:280)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.PEDeploymentService.deploy(PEDeploymentService.java:298)&lt;br/&gt;
	at com.sun.enterprise.admin.mbeans.ApplicationsConfigMBean.deploy(ApplicationsConfigMBean.java:584)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at com.sun.enterprise.admin.MBeanHelper.invokeOperationInBean(MBeanHelper.java:381)&lt;br/&gt;
	at com.sun.enterprise.admin.MBeanHelper.invokeOperationInBean(MBeanHelper.java:364)&lt;br/&gt;
	at com.sun.enterprise.admin.config.BaseConfigMBean.invoke(BaseConfigMBean.java:477)&lt;br/&gt;
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)&lt;br/&gt;
	at sun.reflect.GeneratedMethodAccessor14.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at com.sun.enterprise.admin.util.proxy.ProxyClass.invoke(ProxyClass.java:90)&lt;br/&gt;
	at $Proxy1.invoke(Unknown Source)&lt;br/&gt;
	at com.sun.enterprise.admin.server.core.jmx.SunoneInterceptor.invoke(SunoneInterceptor.java:304)&lt;br/&gt;
	at com.sun.enterprise.interceptor.DynamicInterceptor.invoke(DynamicInterceptor.java:174)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.invokeDeploymentService(AutoDeployer.java:583)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.deployJavaEEArchive(AutoDeployer.java:564)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.deploy(AutoDeployer.java:495)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.deployAll(AutoDeployer.java:270)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployControllerImpl$AutoDeployTask.run(AutoDeployControllerImpl.java:374)&lt;br/&gt;
	at java.util.TimerThread.mainLoop(Timer.java:512)&lt;br/&gt;
	at java.util.TimerThread.run(Timer.java:462)&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;#]&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;#|2010-01-02T19:42:27.837+0100|WARNING|sun-glassfish-comms-server1.5|javax.enterprise.system.core|_ThreadID=17;_ThreadName=Timer-12;_RequestID=68741cc4-049e-4f05-a6f5-fab7d336f48e;|CORE5020: Error while loading ejb module|#&amp;#93;&lt;/span&gt;&lt;/p&gt;
</description>
                <environment>Ubuntu-karmic koala&lt;br/&gt;
SLES 10.2&lt;br/&gt;
&lt;br/&gt;
Using sailfin v1 b60g (based on glassfish v2.1)</environment>
        <key id="12444508">OPENJPA-1452</key>
            <summary>OpenJPA 2.0.0-M3 attempts to mutate unmodifiable map in Glassfish</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="drwoods">Donald Woods</assignee>
                                    <reporter username="baboune">seyvet@yahoo.com</reporter>
                        <labels>
                    </labels>
                <created>Sat, 2 Jan 2010 18:53:10 +0000</created>
                <updated>Wed, 28 Apr 2010 23:43:47 +0100</updated>
                            <resolved>Fri, 8 Jan 2010 18:23:49 +0000</resolved>
                                    <version>2.0.0-M3</version>
                                    <fixVersion>2.0.0-beta</fixVersion>
                                    <component>jpa</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12795898" author="baboune" created="Sat, 2 Jan 2010 18:58:07 +0000"  >&lt;p&gt;list of jars added to the &lt;span class=&quot;error&quot;&gt;&amp;#91;GLASFFISH&amp;#93;&lt;/span&gt;/domains/domain1/lib directory:&lt;br/&gt;
commons-collections-3.2.1.jar  &lt;br/&gt;
commons-pool-1.5.2.jar  ext&lt;br/&gt;
openjpa-all-2.0.0-M3.jar&lt;br/&gt;
commons-lang-2.1.jar&lt;br/&gt;
serp-1.13.1.jar&lt;/p&gt;

&lt;p&gt;Note that I had to put the openjpa-all jar and not openjpa-2.0.0-M3, otherwise I was getting a Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: javax/persistence/spi/ProviderUtil.  That is the case even if I deploy the libs in the &lt;span class=&quot;error&quot;&gt;&amp;#91;GLASSFISH&amp;#93;&lt;/span&gt;/lib directory.&lt;/p&gt;

</comment>
                            <comment id="12795910" author="baboune" created="Sat, 2 Jan 2010 20:18:40 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I took a subversion snapshot of the source code and reintroduced the change in Configurations.java:&lt;br/&gt;
Index: Configurations.java&lt;br/&gt;
===================================================================&lt;br/&gt;
&amp;#8212; Configurations.java    (revision 895268) &lt;br/&gt;
+++ Configurations.java    (working copy) &lt;br/&gt;
@@ -677,8 +677,10 @@&lt;br/&gt;
     public static Object removeProperty(String partialKey, Map props) &lt;/p&gt;
{
         if (partialKey == null || props == null || props.isEmpty())
             return null;
-        String fullKey = ProductDerivations.getConfigurationKey(partialKey, props); 
-        return props.remove(fullKey); 
+     if (containsProperty(partialKey, props)) 
+        return props.remove(ProductDerivations.getConfigurationKey(partialKey, props)); 
+    else  
+        return null; 
     }

&lt;p&gt;     /**&lt;/p&gt;

&lt;p&gt;Recompile the project and used the new open-jpa jar generated.&lt;/p&gt;

&lt;p&gt;Now I get this:&lt;br/&gt;
[#|2010-01-02T21:15:39.566+0100|WARNING|sun-glassfish-comms-server2.0|javax.enterprise.system.stream.err|_ThreadID=16;_ThreadName=Timer-7;_RequestID=e78ed0fe-72e4-4798-8ab5-1430c502d733;|&lt;br/&gt;
java.lang.NoSuchMethodError: javax.persistence.spi.PersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode;&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceUnitInfoImpl.toOpenJPAProperties(PersistenceUnitInfoImpl.java:457)&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceProductDerivation.load(PersistenceProductDerivation.java:260)&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceProviderImpl.createContainerEntityManagerFactory(PersistenceProviderImpl.java:158)&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceProviderImpl.createContainerEntityManagerFactory(PersistenceProviderImpl.java:59)&lt;br/&gt;
	at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:149)&lt;br/&gt;
	at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:84)&lt;br/&gt;
	at com.sun.enterprise.server.AbstractLoader.loadPersistenceUnits(AbstractLoader.java:915)&lt;br/&gt;
	at com.sun.enterprise.server.EJBModuleLoader.doLoad(EJBModuleLoader.java:165)&lt;br/&gt;
	at com.sun.enterprise.server.AbstractLoader.load(AbstractLoader.java:240)&lt;br/&gt;
	at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:233)&lt;br/&gt;
	at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:188)&lt;br/&gt;
	at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:420)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.invokeModuleDeployEventListener(AdminEventMulticaster.java:1005)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.handleModuleDeployEvent(AdminEventMulticaster.java:992)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.processEvent(AdminEventMulticaster.java:470)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.multicastEvent(AdminEventMulticaster.java:182)&lt;br/&gt;
	at com.sun.enterprise.admin.server.core.DeploymentNotificationHelper.multicastEvent(DeploymentNotificationHelper.java:308)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.DeploymentServiceUtils.multicastEvent(DeploymentServiceUtils.java:231)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.ServerDeploymentTarget.sendStartEvent(ServerDeploymentTarget.java:298)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.ApplicationStartPhase.runPhase(ApplicationStartPhase.java:132)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.DeploymentPhase.executePhase(DeploymentPhase.java:108)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.PEDeploymentService.executePhases(PEDeploymentService.java:966)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.PEDeploymentService.deploy(PEDeploymentService.java:280)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.PEDeploymentService.deploy(PEDeploymentService.java:298)&lt;br/&gt;
	at com.sun.enterprise.admin.mbeans.ApplicationsConfigMBean.deploy(ApplicationsConfigMBean.java:584)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at com.sun.enterprise.admin.MBeanHelper.invokeOperationInBean(MBeanHelper.java:390)&lt;br/&gt;
	at com.sun.enterprise.admin.MBeanHelper.invokeOperationInBean(MBeanHelper.java:373)&lt;br/&gt;
	at com.sun.enterprise.admin.config.BaseConfigMBean.invoke(BaseConfigMBean.java:477)&lt;br/&gt;
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)&lt;br/&gt;
	at sun.reflect.GeneratedMethodAccessor14.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at com.sun.enterprise.admin.util.proxy.ProxyClass.invoke(ProxyClass.java:90)&lt;br/&gt;
	at $Proxy1.invoke(Unknown Source)&lt;br/&gt;
	at com.sun.enterprise.admin.server.core.jmx.SunoneInterceptor.invoke(SunoneInterceptor.java:304)&lt;br/&gt;
	at com.sun.enterprise.interceptor.DynamicInterceptor.invoke(DynamicInterceptor.java:170)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.invokeDeploymentService(AutoDeployer.java:583)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.deployJavaEEArchive(AutoDeployer.java:564)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.deploy(AutoDeployer.java:495)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.deployAll(AutoDeployer.java:270)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployControllerImpl$AutoDeployTask.run(AutoDeployControllerImpl.java:374)&lt;br/&gt;
	at java.util.TimerThread.mainLoop(Timer.java:512)&lt;br/&gt;
	at java.util.TimerThread.run(Timer.java:462)&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;#]&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;



&lt;p&gt;Seems there are lots of problem running openJPA 2 on glassfish...&lt;/p&gt;
</comment>
                            <comment id="12795912" author="baboune" created="Sat, 2 Jan 2010 20:20:37 +0000"  >&lt;p&gt;Updated Configurations,java, fixes the unmodifiable exception but triggers another....&lt;/p&gt;

&lt;p&gt;java.lang.NoSuchMethodError: javax.persistence.spi.PersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode&lt;/p&gt;</comment>
                            <comment id="12798050" author="drwoods" created="Fri, 8 Jan 2010 16:05:34 +0000"  >&lt;p&gt;Testing the patch now against trunk.&lt;/p&gt;

&lt;p&gt;As far as the ValidationMode problem, the M3 release used the JPA 2.0 PFD2 APIs, which there were some changes to the API dealing with the location of the validation interfaces in the final spec.  Maybe your level of Glassfish is using the final JPA2 spec apis?  If so, you&apos;ll have to grab a nightly 2.0.0-SNAPSHOT build from trunk, which uses the final JPA2 APIs.&lt;/p&gt;</comment>
                            <comment id="12798117" author="drwoods" created="Fri, 8 Jan 2010 18:23:49 +0000"  >&lt;p&gt;Returned code back to what was in 1.2/1.3, which called containsProperty()&lt;/p&gt;</comment>
                            <comment id="12804297" author="baboune" created="Sun, 24 Jan 2010 20:43:45 +0000"  >&lt;p&gt;I tired again with the latest nightly build and the error is still there.&lt;br/&gt;
Apache svn revision: 422266:897056&lt;/p&gt;

&lt;p&gt;java.lang.UnsupportedOperationException&lt;br/&gt;
at java.util.Collections$UnmodifiableMap.remove(Collections.java:1288)&lt;br/&gt;
at org.apache.openjpa.lib.conf.Configurations.removeProperty(Configurations.java:681)&lt;br/&gt;
at org.apache.openjpa.persistence.PersistenceProviderImpl.createContainerEntityManagerFactory(PersistenceProviderImpl.java:157)&lt;br/&gt;
at org.apache.openjpa.persistence.PersistenceProviderImpl.createContainerEntityManagerFactory(PersistenceProviderImpl.java:59)&lt;br/&gt;
at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:149)&lt;br/&gt;
at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:84)&lt;br/&gt;
at com.sun.enterprise.server.AbstractLoader.loadPersistenceUnits(AbstractLoader.java:895)&lt;br/&gt;
at com.sun.enterprise.server.EJBModuleLoader.doLoad(EJBModuleLoader.java:165)&lt;br/&gt;
at com.sun.enterprise.server.AbstractLoader.load(AbstractLoader.java:238)&lt;br/&gt;
at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:233) &lt;/p&gt;

&lt;p&gt;Should I reopen this?&lt;/p&gt;</comment>
                            <comment id="12804301" author="baboune" created="Sun, 24 Jan 2010 21:03:17 +0000"  >&lt;p&gt;Tried tp download the latest svn repository files and build from there.  The original problem is gone.  But I still get:&lt;br/&gt;
[#|2010-01-24T22:00:56.608+0100|WARNING|sun-glassfish-comms-server1.5|javax.enterprise.system.stream.err|_ThreadID=16;_ThreadName=Timer-7;_RequestID=ac39b253-89d1-4910-b76b-a305b28e5877;|java.lang.NoSuchMethodError: javax.persistence.spi.PersistenceUnitInfo.getValidationMode()Ljavax/persistence/ValidationMode;&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceUnitInfoImpl.toOpenJPAProperties(PersistenceUnitInfoImpl.java:457)&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceProductDerivation.load(PersistenceProductDerivation.java:313)&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceProviderImpl.createContainerEntityManagerFactory(PersistenceProviderImpl.java:158)&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceProviderImpl.createContainerEntityManagerFactory(PersistenceProviderImpl.java:62)&lt;br/&gt;
	at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:149)&lt;br/&gt;
	at com.sun.enterprise.server.PersistenceUnitLoaderImpl.load(PersistenceUnitLoaderImpl.java:84)&lt;br/&gt;
	at com.sun.enterprise.server.AbstractLoader.loadPersistenceUnits(AbstractLoader.java:895)&lt;br/&gt;
	at com.sun.enterprise.server.EJBModuleLoader.doLoad(EJBModuleLoader.java:165)&lt;br/&gt;
	at com.sun.enterprise.server.AbstractLoader.load(AbstractLoader.java:238)&lt;br/&gt;
	at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:233)&lt;br/&gt;
	at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:188)&lt;br/&gt;
	at com.sun.enterprise.server.StandAloneEJBModulesManager.moduleDeployed(StandAloneEJBModulesManager.java:420)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.invokeModuleDeployEventListener(AdminEventMulticaster.java:1005)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.handleModuleDeployEvent(AdminEventMulticaster.java:992)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.processEvent(AdminEventMulticaster.java:470)&lt;br/&gt;
	at com.sun.enterprise.admin.event.AdminEventMulticaster.multicastEvent(AdminEventMulticaster.java:182)&lt;br/&gt;
	at com.sun.enterprise.admin.server.core.DeploymentNotificationHelper.multicastEvent(DeploymentNotificationHelper.java:308)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.DeploymentServiceUtils.multicastEvent(DeploymentServiceUtils.java:231)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.ServerDeploymentTarget.sendStartEvent(ServerDeploymentTarget.java:298)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.ApplicationStartPhase.runPhase(ApplicationStartPhase.java:132)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.DeploymentPhase.executePhase(DeploymentPhase.java:108)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.PEDeploymentService.executePhases(PEDeploymentService.java:966)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.PEDeploymentService.deploy(PEDeploymentService.java:280)&lt;br/&gt;
	at com.sun.enterprise.deployment.phasing.PEDeploymentService.deploy(PEDeploymentService.java:298)&lt;br/&gt;
	at com.sun.enterprise.admin.mbeans.ApplicationsConfigMBean.deploy(ApplicationsConfigMBean.java:584)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at com.sun.enterprise.admin.MBeanHelper.invokeOperationInBean(MBeanHelper.java:381)&lt;br/&gt;
	at com.sun.enterprise.admin.MBeanHelper.invokeOperationInBean(MBeanHelper.java:364)&lt;br/&gt;
	at com.sun.enterprise.admin.config.BaseConfigMBean.invoke(BaseConfigMBean.java:477)&lt;br/&gt;
	at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:836)&lt;br/&gt;
	at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:761)&lt;br/&gt;
	at sun.reflect.GeneratedMethodAccessor14.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at com.sun.enterprise.admin.util.proxy.ProxyClass.invoke(ProxyClass.java:90)&lt;br/&gt;
	at $Proxy1.invoke(Unknown Source)&lt;br/&gt;
	at com.sun.enterprise.admin.server.core.jmx.SunoneInterceptor.invoke(SunoneInterceptor.java:304)&lt;br/&gt;
	at com.sun.enterprise.interceptor.DynamicInterceptor.invoke(DynamicInterceptor.java:174)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.invokeDeploymentService(AutoDeployer.java:583)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.deployJavaEEArchive(AutoDeployer.java:564)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.deploy(AutoDeployer.java:495)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployer.deployAll(AutoDeployer.java:270)&lt;br/&gt;
	at com.sun.enterprise.deployment.autodeploy.AutoDeployControllerImpl$AutoDeployTask.run(AutoDeployControllerImpl.java:374)&lt;br/&gt;
	at java.util.TimerThread.mainLoop(Timer.java:512)&lt;br/&gt;
	at java.util.TimerThread.run(Timer.java:462)&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;#]&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;



&lt;p&gt;Raise new issue?&lt;/p&gt;</comment>
                            <comment id="12804586" author="techhusky" created="Mon, 25 Jan 2010 16:14:33 +0000"  >&lt;p&gt;Does the version of Glassfish you are using support JPA 2.0/EE6?  It looks like you are trying to use OpenJPA 2.0 with JPA 1.0 level spec API.  The 2.0 level spec API jar  (either from Geronimo or a version provided by Sun) is required to run OpenJPA 2.0.&lt;/p&gt;

&lt;p&gt;Note:  The OpenJPA M3 release does not match the final JPA 2.0 specification, but the most current trunk level code does.  If you get an EE6 version of Glassfish, be sure to use the most current OpenJPA trunk level code.&lt;/p&gt;</comment>
                            <comment id="12806485" author="baboune" created="Fri, 29 Jan 2010 20:27:24 +0000"  >&lt;p&gt;Glassfish 2.1 does not support EE6/JPA 2.0.&lt;br/&gt;
So no openJPA for us then... I would have thought that OpenJPA 2 would be backward compatible with JPA 2&lt;/p&gt;</comment>
                            <comment id="12806511" author="techhusky" created="Fri, 29 Jan 2010 21:35:50 +0000"  >&lt;p&gt;OpenJPA 2.0 is backward compatible with OpenJPA 1.0 from an application standpoint  (ie. your apps that run on OpenJPA 1.x will continue to run on OpenJPA 2.0), but not from an environment perspective.  Your runtime environment must have the correct libraries and versions of those libraries required by OpenJPA 2.0.  This typically isn&apos;t a problem in JSE environments since you just include the required jars in your classpath and run the app.  However, it is often a problem in JEE environments since the app server vendors provide the libraries for whatever JEE spec level they support and typically don&apos;t provide a way to plug in a newer spec level of those libraries.  Thus, you need to pick up a new release of the app server with support for the newer spec level.  OpenJPA 2.0 should work with the JEE6 version of Glassfish.  (But, I haven&apos;t tried it)  There&apos;s also a WebSphere JPA 2.0 alpha&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; available that is based on OpenJPA 2.0.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;  &lt;a href=&quot;https://www14.software.ibm.com/iwm/web/cc/earlyprograms/websphere/wsasjpaoa/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://www14.software.ibm.com/iwm/web/cc/earlyprograms/websphere/wsasjpaoa/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12830499" author="baboune" created="Sat, 6 Feb 2010 09:55:18 +0000"  >&lt;p&gt;Verified with latest nightly build.&lt;/p&gt;</comment>
                            <comment id="12861975" author="ppoddar@apache.org" created="Wed, 28 Apr 2010 23:43:47 +0100"  >&lt;p&gt;&amp;gt; Glassfish 2.1 does not support EE6/JPA 2.0.&lt;br/&gt;
&amp;gt; So no openJPA for us then... I would have thought that OpenJPA 2 would be backward compatible with JPA 2&lt;/p&gt;

&lt;p&gt;To run OpenJPA 2.0 (or possibly other JPA 2.0 compliant JPA provider, my observations/experiments are based on OpenJPA only), please try the following&lt;/p&gt;

&lt;p&gt;  1. Grab a JPA 2.0 Specification JAR from somewhere. JPA 2.0 specifcation jar is not only a set of interface classes but also has concrete implementation classes. &lt;br/&gt;
      The errors reported in this issue can be traced to the fact that &lt;br/&gt;
          a) Glassfish V2.x includes EclipseLink library which in turn includes JPA spec classes &lt;br/&gt;
          b) those spec classes are JPA 1.0 &lt;/p&gt;

&lt;p&gt;  2. Place that jar (say jpa-spec-2.0.jar) into &amp;lt;root&amp;gt;/domains/domain1/lib/ext &lt;br/&gt;
      where &amp;lt;root&amp;gt; is glassfish v2.x install point&lt;br/&gt;
                 domain1 is the name of the domain&lt;/p&gt;

&lt;p&gt;      That lib/ext directory is also a good place for common libraries such as JDBC driver&lt;/p&gt;

&lt;p&gt;  3. Place openjpa 2.x libraries into &amp;lt;root&amp;gt;/domains/domain1/applibs. &lt;/p&gt;

&lt;p&gt;  4. Deploy your application with --libraries option. The options should specify openjpa 2.x library name(s). You can do the same from the web-based admin console on the page&lt;br/&gt;
(Web Applications -&amp;gt; Deploy) and fill-in &apos;Libraries&apos; field.  &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12429283" name="Configurations.java" size="28039" author="baboune" created="Sat, 2 Jan 2010 20:20:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 8 Jan 2010 16:05:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161717</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyt6cn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204209</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>