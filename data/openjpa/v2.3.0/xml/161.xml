<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:32:39 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-161/OPENJPA-161.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-161] Overuse of synchronization in AbstractBrokerFactory</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-161</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;AbstractBrokerFactory maintains a Map&amp;lt;Transaction,List&amp;lt;Broker&amp;gt;&amp;gt; that is guarded by synchronized blocks. These synchronized blocks should be removed if possible.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12363438">OPENJPA-161</key>
            <summary>Overuse of synchronization in AbstractBrokerFactory</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                                <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="pcl">Patrick Linskey</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Feb 2007 21:57:16 +0000</created>
                <updated>Tue, 9 Mar 2010 18:32:31 +0000</updated>
                            <resolved>Fri, 23 Feb 2007 18:34:04 +0000</resolved>
                                                    <fixVersion>0.9.7</fixVersion>
                                    <component>kernel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12475177" author="pcl" created="Thu, 22 Feb 2007 22:08:58 +0000"  >&lt;p&gt;This patch removes the synchronization on _transactional, replacing it with a ConcurrentHashMap and using the ConcurrentHashMap.putIfAbsent() call to safely handle concurrent access. My analysis is that we do not need to synchronize on the lists inside _transactional, since the key that we look up the collection with is a JTA transaction, and JTA does not allow a transaction to be used concurrently in multiple threads.&lt;/p&gt;

&lt;p&gt;Barring any objections, I plan to commit this change in the next day or so.&lt;/p&gt;</comment>
                            <comment id="12475369" author="awhite" created="Fri, 23 Feb 2007 15:49:35 +0000"  >&lt;p&gt;I think the FIXME part of the patch should be removed/simplified.  The patch itself contains comments like the following:&lt;/p&gt;

&lt;p&gt;// we don&apos;t need to synchronize on brokers since one JTA transaction&lt;br/&gt;
// can never be active on multiple concurrent threads.&lt;/p&gt;

&lt;p&gt;Yet the FIXME part explicitly guards against having the same transaction on concurrent threads.  If guards like this are necessary, then they need to be consistent throughout the patch.  But if we agree that the comment above is correct and the same transaction can&apos;t be active on multiple threads, then the FIXME part is useless.&lt;/p&gt;</comment>
                            <comment id="12475372" author="pcl" created="Fri, 23 Feb 2007 15:58:40 +0000"  >&lt;p&gt;Oops, FIXME is stale &amp;#8211; the comment is no longer applicable. Disregard. (In an earlier revision, I was guarding &apos;brokers&apos; with a synchronized block, but analyzed further and decided that indeed, it was not necessary.)&lt;/p&gt;</comment>
                            <comment id="12475374" author="awhite" created="Fri, 23 Feb 2007 16:05:05 +0000"  >&lt;p&gt;The code in question (just after the FIXME) is still guarding against the same transaction in concurrent threads.  See the &quot;someone beat us to it&quot; putIfAbsent call.  If we agree that transactions are thread bound &amp;#8211; as must be the case for the rest of the patch to be correct &amp;#8211; no one can &quot;beat us to it&quot;, because we&apos;re the only thread with access to that transaction.  &lt;/p&gt;</comment>
                            <comment id="12475377" author="pcl" created="Fri, 23 Feb 2007 16:13:30 +0000"  >&lt;p&gt;Good point &amp;#8211; I guess we can switch to just using a put() call instead. I&apos;ll change accordingly.&lt;/p&gt;</comment>
                            <comment id="12475379" author="pcl" created="Fri, 23 Feb 2007 16:27:34 +0000"  >&lt;p&gt;New patch that doesn&apos;t use putIfAbsent()&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12351896" name="ASF.LICENSE.NOT.GRANTED--openjpa-161-patch.txt" size="5716" author="pcl" created="Fri, 23 Feb 2007 16:27:38 +0000"/>
                            <attachment id="12351840" name="openjpa-161-patch.txt" size="6145" author="pcl" created="Thu, 22 Feb 2007 22:08:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 23 Feb 2007 15:49:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160493</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyspvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>201540</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>