<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:40:36 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-2366/OPENJPA-2366.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-2366] provide option to exclude schema name from generated @Table annotation for generated entities</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-2366</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Feature request:&lt;/p&gt;

&lt;p&gt;Provide an option for org.apache.openjpa.jdbc.meta.ReverseMappingTool that will exclude the schema name for the @Table annotation on generated entities.  For example, if the schema name is not required and needs to be dynamically specified at deployment time via openjpa.jdbc.Schema.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12641444">OPENJPA-2366</key>
            <summary>provide option to exclude schema name from generated @Table annotation for generated entities</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ajdorenk">Austin Dorenkamp</assignee>
                                    <reporter username="jmysak">John Mysak</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Apr 2013 21:15:55 +0100</created>
                <updated>Tue, 3 Sep 2013 13:04:18 +0100</updated>
                            <resolved>Tue, 3 Sep 2013 05:20:38 +0100</resolved>
                                    <version>2.2.0</version>
                    <version>2.2.1</version>
                                    <fixVersion>2.3.0</fixVersion>
                                    <component>jpa</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="13683329" author="dkamp14" created="Fri, 14 Jun 2013 14:12:11 +0100"  >&lt;p&gt;My current thought for implementing this feature is to add a &quot;useSchema&quot; flag that will be set via command line {-useSchema = &amp;lt;true/false&amp;gt;}. With useSchema=false, the schema name for the @Table annotation will be excluded. However, useSchema will default to true if not specified so that it won&apos;t disrupt current OpenJPA users. UseSchema is different from useSchemaName as the latter only affects whether or not the schema name is included in the class name. I welcome any other thoughts and ideas regarding the implementation of this feature. &lt;/p&gt;</comment>
                            <comment id="13683484" author="techhusky" created="Fri, 14 Jun 2013 17:13:01 +0100"  >&lt;p&gt;I like this approach.  The options &quot;includeSchema&quot; and &quot;includeSchemaName&quot; and the inverses &quot;excludeSchema&quot; or &quot;excludeSchemaName&quot; also came to mind as possibilities.  The use of one of those may help further differentiate them from &quot;useSchemaName&quot;.  I&apos;m OK with &quot;useSchema&quot; as well though, good documentation will be the key.&lt;/p&gt;</comment>
                            <comment id="13731259" author="ajdorenk" created="Tue, 6 Aug 2013 21:58:00 +0100"  >&lt;p&gt;This patch deals with the ReverseMappingTool and associated classes. The added code creates the option for users to exclude the schema name (via a command line flag: &quot;-useSchemaElement&quot;) from the @Table annotation in the .java files generated for each table that is being mapped. The schema name will also be removed from the corresponding XML mapping file(s) (i.e., orm.xml) that are generated by the tool. The initialized value for &quot;useSchemaElement&quot; is true in order to preserve backwards compatibility.&lt;/p&gt;

&lt;p&gt;I am requesting a review so that these changes can be incorporated into future Apache OpenJPA releases.&lt;/p&gt;</comment>
                            <comment id="13731375" author="kwsutter" created="Tue, 6 Aug 2013 23:19:42 +0100"  >&lt;p&gt;Austin, Thanks for the patch.  It looks pretty good.  I have a couple of comments that need addressing before we could commit it.&lt;/p&gt;

&lt;p&gt;o  Doc changes.  I would add the following (to tie the propery setting to the xml updates)...&lt;/p&gt;

&lt;p&gt;+ If the useSchemaElement is set to false, &lt;br/&gt;
+ the schema name will also be removed from the corresponding XML mapping files&lt;/p&gt;

&lt;p&gt;o  Same type of comment applies to the corresponding java code for the tool comments in ReverseMappingTool.java&lt;/p&gt;

&lt;p&gt;o  It looks like you&apos;re modifying the generated @Table source line and removing any generated Schema element...  &lt;/p&gt;

&lt;p&gt;+            if(!_useSchemaElement &amp;amp;&amp;amp; s.contains(&quot;@Table&quot;))&lt;br/&gt;
+            {&lt;br/&gt;
+            	int counter = -1;	// Stores length of &quot;schemaName&quot; (minus quotes)&lt;br/&gt;
+            	char current = 0;&lt;br/&gt;
+            	while (current != &apos;&quot;&apos;)&lt;br/&gt;
+            	&lt;/p&gt;
{
+            		current = s.charAt(counter+16);
+            		counter++;
+            	}
&lt;p&gt;+            	s = s.replaceAll(s.substring(7, 18+counter), &quot;&quot;);&lt;br/&gt;
+            }&lt;/p&gt;

&lt;p&gt;    Since this generated @Table code line may change over time, we should move this logic higher up in the call stack.  That is, when the @Table source line is first being generated, determine that we don&apos;t want the Schema element and don&apos;t generate it in the first place.&lt;/p&gt;

&lt;p&gt;o  Same type of comment for the XML generation in XMLPersistenceMappingSerializer.  Why wouldn&apos;t we detect the condition in the serializeTable() method instead of resetting the names in the table identifier?  Actually, this latter approach looks quite scary.  It looks like we&apos;re modifying the actual class mapping data, which we probably don&apos;t want to do.  Did the full JUnit bucket run successfully after these changes were applied?&lt;/p&gt;

&lt;p&gt;    If we clean this up, then we can remove that ugly &quot;publicResetNames&quot; method...  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;o  Verify the indentation.  In Eclipse, have you changed tabs to be spaces?  There are a couple of areas like this that look to be formatting issues:&lt;/p&gt;

&lt;p&gt;+    public boolean getUseSchemaElement() &lt;/p&gt;
{
+		return _useSchemaElement;
+	}
&lt;p&gt;+&lt;br/&gt;
+	public void setUseSchemaElement(boolean useSchemaElement) &lt;/p&gt;
{
+		this._useSchemaElement = useSchemaElement;
+	}
&lt;p&gt;+&lt;br/&gt;
+	/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Internal parser interface.&lt;br/&gt;
      */&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;o  Remove extra comments attributing to you as an author...&lt;br/&gt;
+		&amp;lt;!--  Added the following code (ajdorenk) --&amp;gt;&lt;/p&gt;

&lt;p&gt;o  In the ReverseMappingTool.java file, shouldn&apos;t you use the getter method instead of accessing the field directly?&lt;br/&gt;
+            gen.setUseSchemaElement(_useSchemaElement);&lt;/p&gt;
</comment>
                            <comment id="13737317" author="ajdorenk" created="Mon, 12 Aug 2013 21:40:50 +0100"  >&lt;p&gt;The updated patches have just been attached. In this comment I will briefly walk through the changes:&lt;br/&gt;
~TestUseSchemaElement (TUSE) is a new class that test my changes&lt;br/&gt;
~ReverseMappingTool (RMT) contains the majority of the changes - including initially setting the UseSchemaElement (USE) flag. From the RMT class, the USE flag is stored in the ClassMetaData object where it is eventually retrieved from Annotation/XMLPersistenceMetaDataSerializer (where it is stored) by the Annotation/XMLPersistenceMappingSerializer (where the information for the .java and .xml files are being created). &lt;br/&gt;
~FieldMetaData is a class that the comments in CMD said to update with any changes to CMD&lt;br/&gt;
~ReverseMappingToolTask was updated to mirror changes to RMT&lt;br/&gt;
~persistence.xml was updated to enable the use of a local derby database in TUSE&lt;/p&gt;</comment>
                            <comment id="13740146" author="techhusky" created="Wed, 14 Aug 2013 21:30:06 +0100"  >&lt;p&gt;The latest patch looks good.  Thanks for submitting it.  Adding a specialized field to classmetadata is a little quirky, but it is less invasive than passing the setting all the way through the call stack.&lt;/p&gt;</comment>
                            <comment id="13754752" author="techhusky" created="Fri, 30 Aug 2013 15:50:24 +0100"  >&lt;p&gt;I&apos;ll get Austin&apos;s latest patches committed within the next few days.  Working through a few dev env issues...&lt;/p&gt;</comment>
                            <comment id="13756351" author="jira-bot" created="Tue, 3 Sep 2013 05:18:11 +0100"  >&lt;p&gt;Commit 1519550 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=techhusky&quot; class=&quot;user-hover&quot; rel=&quot;techhusky&quot;&gt;Jeremy Bauer&lt;/a&gt; in branch &apos;openjpa/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1519550&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1519550&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2366&quot; title=&quot;provide option to exclude schema name from generated @Table annotation for generated entities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2366&quot;&gt;&lt;del&gt;OPENJPA-2366&lt;/del&gt;&lt;/a&gt; Committing code and unit tests contributed by Austin Dorenkamp&lt;/p&gt;</comment>
                            <comment id="13756353" author="techhusky" created="Tue, 3 Sep 2013 05:19:43 +0100"  >&lt;p&gt;Committed &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2366&quot; title=&quot;provide option to exclude schema name from generated @Table annotation for generated entities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2366&quot;&gt;&lt;del&gt;OPENJPA-2366&lt;/del&gt;&lt;/a&gt;-3.patch and &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2366&quot; title=&quot;provide option to exclude schema name from generated @Table annotation for generated entities&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2366&quot;&gt;&lt;del&gt;OPENJPA-2366&lt;/del&gt;&lt;/a&gt;doc-3.patch to trunk (2.3.0) under rev 1519550.&lt;/p&gt;</comment>
                            <comment id="13756543" author="ajdorenk" created="Tue, 3 Sep 2013 13:04:18 +0100"  >&lt;p&gt;Thanks Jeremy!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12597546" name="OPENJPA-2366-3.patch" size="17541" author="ajdorenk" created="Mon, 12 Aug 2013 21:40:50 +0100"/>
                            <attachment id="12597547" name="OPENJPA-2366doc-3.patch" size="1138" author="ajdorenk" created="Mon, 12 Aug 2013 21:40:50 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 14 Jun 2013 13:12:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>321860</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzddt3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322205</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>