<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:37:21 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-752/OPENJPA-752.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-752] ProxySetupStateManager.setProxyData routing through PersistanceCapable caused &quot;PersistenceException: null&quot;</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-752</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;The symptom of the problem is an InternalException is thrown from ProxySetupStateManager.provide*Field method due to mismatched routing to a PersistenceCapable object: The stack will look like something similar to this:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; &amp;lt;openjpa-1.0.3-SNAPSHOT-r420667:649224M fatal user error&amp;gt; org.apache.openjpa.persistence.ArgumentException: Errors encountered while resolving metadata.  See nested exceptions for details.&lt;br/&gt;
        at org.apache.openjpa.meta.MetaDataRepository.resolve(MetaDataRepository.java:522)&lt;br/&gt;
        at org.apache.openjpa.meta.MetaDataRepository.getMetaData(MetaDataRepository.java:302)&lt;br/&gt;
        at org.apache.openjpa.kernel.BrokerImpl.newObjectId(BrokerImpl.java:1060)&lt;br/&gt;
        at org.apache.openjpa.kernel.DelegatingBroker.newObjectId(DelegatingBroker.java:252)&lt;br/&gt;
        at org.apache.openjpa.persistence.EntityManagerImpl.find(EntityManagerImpl.java:347)&lt;br/&gt;
        at test.Main.main(Main.java:16)&lt;br/&gt;
Caused by: &amp;lt;openjpa-1.0.3-SNAPSHOT-r420667:649224M fatal general error&amp;gt; org.apache.openjpa.persistence.PersistenceException: null&lt;br/&gt;
        at org.apache.openjpa.meta.ProxySetupStateManager.providedBooleanField(ProxySetupStateManager.java:206)&lt;br/&gt;
        at test.BaseNonVersionEntity.pcProvideField(BaseNonVersionEntity.java)&lt;br/&gt;
        at test.BaseVersionEntity.pcProvideField(BaseVersionEntity.java)&lt;br/&gt;
        at test.EntityVersionedA.pcProvideField(EntityVersionedA.java)&lt;br/&gt;
        at org.apache.openjpa.meta.ProxySetupStateManager.setProxyData(ProxySetupStateManager.java:62)&lt;br/&gt;
        at org.apache.openjpa.meta.ClassMetaData.resolveMeta(ClassMetaData.java:1731)&lt;br/&gt;
        at org.apache.openjpa.meta.ClassMetaData.resolve(ClassMetaData.java:1613)&lt;br/&gt;
        at org.apache.openjpa.meta.MetaDataRepository.processBuffer(MetaDataRepository.java:675)&lt;br/&gt;
        at org.apache.openjpa.meta.MetaDataRepository.resolveMeta(MetaDataRepository.java:575)&lt;br/&gt;
        at org.apache.openjpa.meta.MetaDataRepository.resolve(MetaDataRepository.java:500)&lt;br/&gt;
        ... 5 more&lt;br/&gt;
NestedThrowables:&lt;br/&gt;
&amp;lt;openjpa-1.0.3-SNAPSHOT-r420667:649224M fatal user error&amp;gt; org.apache.openjpa.persistence.ArgumentException: Unable to resolve type &quot;test.EntityNonVersionedM&quot; due to previous errors resolving related type &quot;test.EntityVersionedA&quot;.&lt;br/&gt;
        at org.apache.openjpa.meta.MetaDataRepository.processBuffer(MetaDataRepository.java:689)&lt;br/&gt;
        at org.apache.openjpa.meta.MetaDataRepository.resolveMeta(MetaDataRepository.java:575)&lt;br/&gt;
        at org.apache.openjpa.meta.MetaDataRepository.resolve(MetaDataRepository.java:500)&lt;br/&gt;
        at org.apache.openjpa.meta.MetaDataRepository.getMetaData(MetaDataRepository.java:302)&lt;br/&gt;
        at org.apache.openjpa.kernel.BrokerImpl.newObjectId(BrokerImpl.java:1060)&lt;br/&gt;
        at org.apache.openjpa.kernel.DelegatingBroker.newObjectId(DelegatingBroker.java:252)&lt;br/&gt;
        at org.apache.openjpa.persistence.EntityManagerImpl.find(EntityManagerImpl.java:347)&lt;br/&gt;
        at test.Main.main(Main.java:16)&lt;/p&gt;

&lt;p&gt;I shall attach a test case later.&lt;/p&gt;

&lt;p&gt;Albert Lee.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12407194">OPENJPA-752</key>
            <summary>ProxySetupStateManager.setProxyData routing through PersistanceCapable caused &quot;PersistenceException: null&quot;</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="allee8285">Albert Lee</assignee>
                                    <reporter username="allee8285">Albert Lee</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Oct 2008 18:28:01 +0100</created>
                <updated>Mon, 27 Oct 2008 16:57:34 +0000</updated>
                            <resolved>Fri, 24 Oct 2008 21:45:21 +0100</resolved>
                                    <version>1.0.3</version>
                    <version>1.1.0</version>
                    <version>1.2.0</version>
                    <version>1.3.0</version>
                                    <fixVersion>1.0.4</fixVersion>
                    <fixVersion>1.2.1</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0-M2</fixVersion>
                                    <component>kernel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12642500" author="allee8285" created="Fri, 24 Oct 2008 18:29:44 +0100"  >&lt;p&gt;Test case to reproduce the problem.&lt;/p&gt;</comment>
                            <comment id="12642502" author="allee8285" created="Fri, 24 Oct 2008 18:44:50 +0100"  >&lt;p&gt;The use case is:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;An entity inherits from 2 nested super classes&lt;br/&gt;
       EntityVersionedA -&amp;gt; BaseVersionEntity -&amp;gt; BaseNonVersionEntity&lt;/li&gt;
	&lt;li&gt;The entities are packaged in 2 different jar files&lt;/li&gt;
	&lt;li&gt;The persistence.xml reference one of the jar file in the persistence unit&apos;s &amp;lt;jar-file&amp;gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Since not all entities are packaged in the same jar file, resolving metadata of these class hierarchy do not build correctly in the ClassMetaData&apos;s attribue &quot;_allFields&quot;. This field contains fewer number of attributes in the corresponding persistence capable class. However the enhancer was able to detect all the fields based of Reflection, hence there is a mis-matched attribute table list between the ClassMetaData and the enhanced class. As a result, the interaction between the ProxySetupStateManager and the PersistenceCapable class route the method call to the wrong indexed provide*Field method.&lt;/p&gt;

&lt;p&gt;This problem may only occur if there is Calendar, Collection or Map object defined in an entity.&lt;/p&gt;

&lt;p&gt;The cause of the exception is basically incorrect packaging, a better exception message will go a long way to help application to correct the problem.&lt;/p&gt;

&lt;p&gt;Albert Lee.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12392795" name="OPENJPA-752.test.jar" size="14018" author="allee8285" created="Fri, 24 Oct 2008 18:29:44 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161060</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7lnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>288478</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>