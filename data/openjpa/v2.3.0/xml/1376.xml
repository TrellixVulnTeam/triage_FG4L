<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:30:59 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1376/OPENJPA-1376.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1376] @SequenceGenerator allocationSize incorrect implementation</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1376</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;OpenJpa use allocationSize parameter on NativeJDBCSeq to set the sequence cache value.&lt;/p&gt;

&lt;p&gt;But one &quot;JSR 220: Enterprise JavaBeansTM,Version 3.0&quot; , the allocationSize is : &quot;The amount to increment by when allocating sequence&lt;br/&gt;
numbers from the sequence.&quot;&lt;/p&gt;

&lt;p&gt;Allocating is used to limit the number of access to the sequence or table not to set the sequence cache value !&lt;/p&gt;

&lt;p&gt;If allocationSize=50, the sequence need to be call one time on each 50 call on AbstractJDBCSeq.next().&lt;/p&gt;

&lt;p&gt;1 call on AbstractJDBCSeq.next(). call the sequence or table &lt;br/&gt;
2 call : return previous value + 1;&lt;br/&gt;
3 call : return previous value + 2;&lt;br/&gt;
...&lt;br/&gt;
51 call :re-call the sequence&lt;br/&gt;
52 return previous value + 1&lt;br/&gt;
...&lt;/p&gt;



</description>
                <environment>All</environment>
        <key id="12439900">OPENJPA-1376</key>
            <summary>@SequenceGenerator allocationSize incorrect implementation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="milosz">Milosz Tylenda</assignee>
                                    <reporter username="yyvess">Yves</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Nov 2009 23:49:17 +0000</created>
                <updated>Fri, 8 Nov 2013 20:47:55 +0000</updated>
                            <resolved>Sun, 13 Mar 2011 09:57:14 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>2.0.0-M3</version>
                    <version>2.1.0</version>
                                    <fixVersion>1.2.3</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.2</fixVersion>
                    <fixVersion>2.1.2</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                                    <component>competitive</component>
                    <component>jdbc</component>
                    <component>performance</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <timeoriginalestimate seconds="28800">8h</timeoriginalestimate>
                            <timeestimate seconds="28800">8h</timeestimate>
                                        <comments>
                            <comment id="12991782" author="dagenix" created="Tue, 8 Feb 2011 04:20:27 +0000"  >&lt;p&gt;The attached patch modifies the NativeJDBCSeq class to make use of the increment parameter.  The modified class will only get the next value of the database sequence object once every increment number of invocations.&lt;/p&gt;

&lt;p&gt;The patch also modifies the meta-data parsers to use the allocationSize parameter to the SequenceGenerator&apos;s to set the increment size.&lt;/p&gt;</comment>
                            <comment id="12999932" author="milosz" created="Sun, 27 Feb 2011 11:22:15 +0000"  >&lt;p&gt;Palmer, thanks for the patch. I have modified it, e.g. allocate property is used instead of increment to be more consistent with table-based sequence, but the idea is the same. Committed.&lt;/p&gt;

&lt;p&gt;I also got rid of the auto-configuration support which was marked deprecated from the beginning of OpenJPA (2006) which was interferring with this change.&lt;/p&gt;

&lt;p&gt;Since this change poses some burden during migration, I will update the manual soon.&lt;/p&gt;</comment>
                            <comment id="13102277" author="milosz" created="Sun, 11 Sep 2011 15:00:29 +0100"  >&lt;p&gt;Added other Fix Versions since code has been checked in.&lt;/p&gt;

&lt;p&gt;On branches earlier than 2.2, the behaviour is gated by the useNativeSequenceCache property of DBDictionary. Set it to true to enable this new functionality.&lt;/p&gt;</comment>
                            <comment id="13102278" author="milosz" created="Sun, 11 Sep 2011 15:06:18 +0100"  >&lt;p&gt;Should be: Set it to FALSE to enable this new functionality.&lt;/p&gt;</comment>
                            <comment id="13102279" author="milosz" created="Sun, 11 Sep 2011 15:14:41 +0100"  >&lt;p&gt;Heath, I think the following code, found in a branch, needs correction. Won&apos;t we get too many &quot;INCREMENT BY&quot;s ?&lt;/p&gt;

&lt;p&gt;       if (seq.getIncrement() &amp;gt; 1 &amp;amp;&amp;amp; useNativeSequenceCache)&lt;/p&gt;
{

               buf.append(&quot; INCREMENT BY &quot;).append(seq.getIncrement());

       }

&lt;p&gt;       else if ((seq.getIncrement() &amp;gt; 1) || (seq.getAllocate() &amp;gt; 1))&lt;/p&gt;
{

           buf.append(&quot; INCREMENT BY &quot;).append(seq.getIncrement() * seq.getAllocate());

       }

&lt;p&gt;      if (seq.getIncrement() &amp;gt; 1)&lt;/p&gt;

&lt;p&gt;           buf.append(&quot; INCREMENT BY &quot;).append(seq.getIncrement());&lt;/p&gt;</comment>
                            <comment id="13104675" author="jpaheath" created="Wed, 14 Sep 2011 18:13:53 +0100"  >&lt;p&gt;Hello Milosz!!  Excellent catch!!  Thank you!  If you would please, could you double check my work here to make sure we are on the same page?  That is, in 1.2.x and 1.3.x, it looks like my changes to DBDictionary are correct.  However, looking at the DBDictionary changes in 2.0.x and 2.1.x, I forgot to remove this &apos;if&apos; block:&lt;/p&gt;

&lt;p&gt; if (seq.getIncrement() &amp;gt; 1)&lt;/p&gt;

&lt;p&gt;           buf.append(&quot; INCREMENT BY &quot;).append(seq.getIncrement()); &lt;/p&gt;

&lt;p&gt;Sound correct or am I still missing something?&lt;/p&gt;</comment>
                            <comment id="13105506" author="milosz" created="Thu, 15 Sep 2011 18:15:59 +0100"  >&lt;p&gt;Hi Heath! It sounds correct now. I will have a look at the other files and will let you know if I find anything.&lt;/p&gt;</comment>
                            <comment id="13198919" author="allee8285" created="Thu, 2 Feb 2012 16:28:36 +0000"  >&lt;p&gt;Close issue in preparation for 2.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12530384">OPENJPA-2069</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12555953">OPENJPA-2196</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12678313">OPENJPA-2450</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12470539" name="cache-native-seq-values.diff" size="5850" author="dagenix" created="Tue, 8 Feb 2011 04:20:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 Feb 2011 04:20:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2513</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7n1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>288703</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>