<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:29:57 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-2267/OPENJPA-2267.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-2267] native query select with null result causes NullPointerException</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-2267</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;if you do a native query with a null resultset where the resulting object is not the model object, it causes a null pointer exception.&lt;/p&gt;

&lt;p&gt;---------------------------------------------------&lt;/p&gt;

&lt;p&gt;mysql&amp;gt; desc Data;&lt;br/&gt;
&lt;ins&gt;-------------------------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;------------&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;---&lt;del&gt;&lt;ins&gt;&lt;/del&gt;-------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;---------------+&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Field                    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Type         &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Null &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Key &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Default &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Extra          &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-------------------------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;------------&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;---&lt;del&gt;&lt;ins&gt;&lt;/del&gt;-------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;---------------+&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; id                       &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; bigint(20)   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; NO   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; PRI &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; NULL    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; auto_increment &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; data                     &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; mediumblob   &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; YES  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; NULL    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-------------------------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;------------&lt;del&gt;&lt;ins&gt;&lt;/del&gt;----&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;---&lt;del&gt;&lt;ins&gt;&lt;/del&gt;-------&lt;del&gt;&lt;/ins&gt;&lt;/del&gt;---------------+&lt;br/&gt;
12 rows in set (0.01 sec)&lt;/p&gt;

&lt;p&gt;mysql&amp;gt; select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from Data;&lt;br/&gt;
&lt;ins&gt;----------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;----------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;        0 &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;----------&lt;/ins&gt;&lt;br/&gt;
1 row in set (0.00 sec)&lt;/p&gt;

&lt;p&gt;mysql&amp;gt; select max(id) from Data;&lt;br/&gt;
&lt;ins&gt;---------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; max(id) &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;---------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;    NULL &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;---------&lt;/ins&gt;&lt;br/&gt;
1 row in set (0.00 sec)&lt;/p&gt;

&lt;p&gt;now in java do :&lt;/p&gt;

&lt;p&gt;Query query = entityManager.createNativeQuery(&quot;select max(id) from Data&quot;, Long.class);&lt;br/&gt;
List results = query.getResultList();&lt;/p&gt;

&lt;p&gt;The following exception ensues.&lt;/p&gt;

&lt;p&gt;---------------------------------------------------&lt;/p&gt;

&lt;p&gt;&amp;lt;openjpa-2.2.0-r422266:1244990 nonfatal user error&amp;gt; org.apache.openjpa.persistence.ArgumentException: Failed to execute query &quot;select max(id) from Data&quot;. Check the query syntax for correctness. See nested exception for details.&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:872)&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:794)&lt;br/&gt;
	at org.apache.openjpa.kernel.DelegatingQuery.execute(DelegatingQuery.java:542)&lt;br/&gt;
	at org.apache.openjpa.persistence.QueryImpl.execute(QueryImpl.java:286)&lt;br/&gt;
	at org.apache.openjpa.persistence.QueryImpl.getResultList(QueryImpl.java:302)&lt;br/&gt;
...&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.openjpa.kernel.ResultPacker.pack(ResultPacker.java:202)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.SQLProjectionResultObjectProvider.getResultObject(SQLProjectionResultObjectProvider.java:88)&lt;br/&gt;
	at org.apache.openjpa.lib.rop.RangeResultObjectProvider.getResultObject(RangeResultObjectProvider.java:80)&lt;br/&gt;
	at org.apache.openjpa.lib.rop.EagerResultList.&amp;lt;init&amp;gt;(EagerResultList.java:36)&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.toResult(QueryImpl.java:1251)&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:1007)&lt;br/&gt;
	at org.apache.openjpa.kernel.QueryImpl.execute(QueryImpl.java:863)&lt;/p&gt;</description>
                <environment>my system is fedora 16, MySql 5.5.18 (running innodb), jdk1.6.0_26, openjdk 2.2.0 (also happened in 2.1.0), mysql-connector-java 5.1.18, commons-dbcp 1.4, spring 3.1.1</environment>
        <key id="12609165">OPENJPA-2267</key>
            <summary>native query select with null result causes NullPointerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="curtisr7">Rick Curtis</assignee>
                                    <reporter username="tedmanleung@gmail.com">Ted Leung</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Sep 2012 03:29:02 +0100</created>
                <updated>Mon, 5 Aug 2013 19:50:43 +0100</updated>
                            <resolved>Thu, 27 Sep 2012 22:06:31 +0100</resolved>
                                    <version>2.2.0</version>
                    <version>2.3.0</version>
                                    <fixVersion>2.3.0</fixVersion>
                                    <component>query</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13463481" author="tedmanleung@gmail.com" created="Wed, 26 Sep 2012 03:46:10 +0100"  >&lt;p&gt;for a work around (at least for mysql users) change the select to &lt;/p&gt;

&lt;p&gt;select ifnull(max(id),0) from Data&lt;/p&gt;

&lt;p&gt;Might not work for all use cases but in the case of trying to retrieve the max(id) it will work.&lt;/p&gt;</comment>
                            <comment id="13465089" author="curtisr7" created="Thu, 27 Sep 2012 22:06:21 +0100"  >&lt;p&gt;Committed revision 1391218 to trunk.&lt;/p&gt;</comment>
                            <comment id="13725557" author="jira-bot" created="Wed, 31 Jul 2013 19:30:58 +0100"  >&lt;p&gt;Commit 1508983 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fyrewyld&quot; class=&quot;user-hover&quot; rel=&quot;fyrewyld&quot;&gt;Jody Grassel&lt;/a&gt; in branch &apos;openjpa/branches/2.1.x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1508983&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1508983&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2267&quot; title=&quot;native query select with null result causes NullPointerException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2267&quot;&gt;&lt;del&gt;OPENJPA-2267&lt;/del&gt;&lt;/a&gt;: native query select with null result causes NullPointerException&lt;/p&gt;</comment>
                            <comment id="13726523" author="jira-bot" created="Thu, 1 Aug 2013 16:32:26 +0100"  >&lt;p&gt;Commit 1509299 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fyrewyld&quot; class=&quot;user-hover&quot; rel=&quot;fyrewyld&quot;&gt;Jody Grassel&lt;/a&gt; in branch &apos;openjpa/branches/2.2.x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1509299&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1509299&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2267&quot; title=&quot;native query select with null result causes NullPointerException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2267&quot;&gt;&lt;del&gt;OPENJPA-2267&lt;/del&gt;&lt;/a&gt;: native query select with null result causes NullPointerException&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12555891">OPENJPA-2195</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Sep 2012 21:06:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240099</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxuruv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3332</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>