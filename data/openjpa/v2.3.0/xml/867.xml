<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:39:41 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-867/OPENJPA-867.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-867] Unexpected Behaviour of DBDictionary.indexOf() method</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-867</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;There is potentially unexpected behaviour of the indexOf method of the DBDictionary class (org.apache.openjpa.jdbc.sql.DBDictionary) when a start index is specified but the search string is not found.&lt;/p&gt;

&lt;p&gt;When a start index is specified (say &quot;N&quot;), the search target string has the first N characters removed, the search performed (by INSTR in the default case), this is reduced by 1 to make it 0-indexed and then crucially the start index in added to the result.&lt;/p&gt;

&lt;p&gt;In Oracle, if the search term is not found, INSTR returns 0.  If a start index is supplied, this is then added and 1 is taken away, so the &quot;result of indexOf&quot; will be &quot;start index - 1&quot; if the search string is not found.  It may not be obvious whether, once a query is run, a number represents a successful match or not.&lt;/p&gt;

&lt;p&gt;I would expect the case where the string is not found to return 0 or -1, depending on the index base.  I think it is misleading for this to return a positive integer if the string is not found.&lt;/p&gt;

&lt;p&gt;Since you cannot tell whether the string will be matched at the time the query is constructed, it may be difficult to find a fix for this.&lt;/p&gt;</description>
                <environment>openjpa-jdbc 1.2.0 and trunk</environment>
        <key id="12413100">OPENJPA-867</key>
            <summary>Unexpected Behaviour of DBDictionary.indexOf() method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="milosz">Milosz Tylenda</assignee>
                                    <reporter username="alan_raison">Alan Raison</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Jan 2009 15:37:26 +0000</created>
                <updated>Thu, 2 Feb 2012 16:25:01 +0000</updated>
                            <resolved>Mon, 29 Aug 2011 21:13:10 +0100</resolved>
                                    <version>1.2.0</version>
                    <version>2.0.0-M2</version>
                                    <fixVersion>2.2.0</fixVersion>
                                    <component>sql</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13088223" author="milosz" created="Sat, 20 Aug 2011 18:02:03 +0100"  >&lt;p&gt;It turns out that the following databases do have a 3-argument version of LOCATE-like functions making the trick with SUBSTRING obsolete:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Oracle (INSTR),&lt;/li&gt;
	&lt;li&gt;MySQL (LOCATE),&lt;/li&gt;
	&lt;li&gt;H2 (LOCATE),&lt;/li&gt;
	&lt;li&gt;SQLServer (CHARINDEX).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Sybase supports LOCATE only in some of database flavours. Since it is not clear for me which flavours support it (seems IQ does and ASE does not) and I don&apos;t have access to a Sybase instance, I am going to leave the current behaviour on Sybase as is. If anyone knows which Sybase databases support the 3-argument LOCATE and how to tell them, please speak up.&lt;/p&gt;</comment>
                            <comment id="13093151" author="milosz" created="Mon, 29 Aug 2011 21:13:10 +0100"  >&lt;p&gt;Resolving for the databases with 3-argument LOCATE functions. Others (e.g. PostgreSQL) have to still live with the SUBSTRING trick.&lt;/p&gt;</comment>
                            <comment id="13198916" author="allee8285" created="Thu, 2 Feb 2012 16:25:01 +0000"  >&lt;p&gt;Close issue in preparation for 2.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 20 Aug 2011 17:02:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>63298</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7lzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>288534</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>