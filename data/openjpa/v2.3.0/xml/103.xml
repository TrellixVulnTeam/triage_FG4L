<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:30:03 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-103/OPENJPA-103.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-103] Default Listeners not being processed correctly</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-103</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;The basic problem is this:  I&apos;m attempting to specify some entity listeners in my orm.xml , but I continue to get the following TRACE message:&lt;/p&gt;

&lt;p&gt;322664  my persistence unit  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.MetaData - OpenJPA does not currently support XML element &quot;pre-persist&quot;. Ignoring.&lt;/p&gt;

&lt;p&gt;The following discussion is from the openjpa-dev mailing list...&lt;/p&gt;

&lt;p&gt;------------------------------------------------------------&lt;br/&gt;
Marc,&lt;br/&gt;
Thanks for the background on the earlier drafts of the JPA spec.  That helps explain some of the processing that I see.  I also now see that elements tagged as MetaDataTags have corresponding annotation support associated with them.  So, it looks like I just need to provide similar callback processing for the pre-* and post-* methods at the &quot;system&quot; level as exist at the &quot;class&quot; levels.  Thanks for your insights.&lt;/p&gt;

&lt;p&gt;Kevin&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Hide quoted text -&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;On 1/16/07, Marc Prud&apos;hommeaux &amp;lt;mprudhom@apache.org&amp;gt; wrote:&lt;/p&gt;

&lt;p&gt;    Kevin-&lt;/p&gt;

&lt;p&gt;    The draft of the JPA spec said that &quot;pre-persist&quot; was only supported&lt;br/&gt;
    beneath the &quot;entity-listeners&quot; (note plural) element, rather than&lt;br/&gt;
    &quot;entity-listener&quot;. This appears to have been corrected in the final&lt;br/&gt;
    version of the spec, but it looks like we never updated that part of&lt;br/&gt;
    the code (and the CTS doesn&apos;t test for it). This is indeed a bug.&lt;/p&gt;

&lt;p&gt;    As for how the parser works, I&apos;m afraid I don&apos;t know all that much&lt;br/&gt;
    about it (aside from sharing your observation that it is complex).&lt;br/&gt;
    Hopefully, though, my comment above will make the problem make a&lt;br/&gt;
    little more sense to you...&lt;/p&gt;



&lt;p&gt;    On Jan 16, 2007, at 3:20 PM, Kevin Sutter wrote:&lt;/p&gt;

&lt;p&gt;    &amp;gt; Looking for some assistance (that is, background information) on&lt;br/&gt;
    &amp;gt; how the&lt;br/&gt;
    &amp;gt; orm.xml parsing is supposed to work.  I&apos;m attempting to specify&lt;br/&gt;
    &amp;gt; some entity&lt;br/&gt;
    &amp;gt; listeners in my orm.xml , but I continue to get the following TRACE&lt;br/&gt;
    &amp;gt; message:&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; 322664  my persistence unit  TRACE  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; openjpa.MetaData -&lt;br/&gt;
    &amp;gt; OpenJPA does&lt;br/&gt;
    &amp;gt; not currently support XML element &quot;pre-persist&quot;. Ignoring.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; My orm.xml looks like this:&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; &amp;lt;entity-mappings&lt;br/&gt;
    &amp;gt;    xmlns=&quot;http://java.sun.com/xml/ns/persistence/orm&quot;&lt;br/&gt;
    &amp;gt;    xmlns:xsi=&quot; &lt;a href=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.w3.org/2001/XMLSchema-instance&lt;/a&gt;&quot;&lt;br/&gt;
    &amp;gt;    xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/persistence/orm&lt;br/&gt;
    &amp;gt; &lt;a href=&quot;http://java.sun.com/xml/ns/persistence/orm_1_0.xsd&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/xml/ns/persistence/orm_1_0.xsd&lt;/a&gt;&quot;&lt;br/&gt;
    &amp;gt;    version=&quot;1.0&quot;&amp;gt;&lt;br/&gt;
    &amp;gt;    &amp;lt;persistence-unit-metadata&amp;gt;&lt;br/&gt;
    &amp;gt;        &amp;lt;persistence-unit-defaults&amp;gt;&lt;br/&gt;
    &amp;gt;            &amp;lt;entity-listeners&amp;gt;&lt;br/&gt;
    &amp;gt;                &amp;lt;entity-listener class=&quot;&lt;br/&gt;
    &amp;gt; com.ibm.ws.persistence.tests.simple.TestEntity&quot;&amp;gt;&lt;br/&gt;
    &amp;gt;                    &amp;lt;pre-persist  method-name=&quot;prePersist&quot; /&amp;gt;&lt;br/&gt;
    &amp;gt;                    &amp;lt;post-persist method-name=&quot;postPersist&quot; /&amp;gt;&lt;br/&gt;
    &amp;gt;                    &amp;lt;pre-remove   method-name=&quot;preRemove&quot; /&amp;gt;&lt;br/&gt;
    &amp;gt;                    &amp;lt;post-remove  method-name=&quot;postRemove&quot; /&amp;gt;&lt;br/&gt;
    &amp;gt;                    &amp;lt;pre-update   method-name=&quot;preUpdate&quot; /&amp;gt;&lt;br/&gt;
    &amp;gt;                    &amp;lt;post-update  method-name=&quot;postUpdate&quot; /&amp;gt;&lt;br/&gt;
    &amp;gt;                    &amp;lt;post-load    method-name=&quot;postLoad&quot; /&amp;gt;&lt;br/&gt;
    &amp;gt;                &amp;lt;/entity-listener&amp;gt;&lt;br/&gt;
    &amp;gt;            &amp;lt;/entity-listeners&amp;gt;&lt;br/&gt;
    &amp;gt;        &amp;lt;/persistence-unit-defaults&amp;gt;&lt;br/&gt;
    &amp;gt;    &amp;lt;/persistence-unit-metadata&amp;gt;&lt;br/&gt;
    &amp;gt; &amp;lt;/entity-mappings&amp;gt;&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; I&apos;ve started to debug this problem, but I have some general&lt;br/&gt;
    &amp;gt; questions on how&lt;br/&gt;
    &amp;gt; the SAX parser is supposed to work.  I see in the&lt;br/&gt;
    &amp;gt; CFMetaDataParser.startElement() where these &quot;entity-listener&quot;&lt;br/&gt;
    &amp;gt; related tags&lt;br/&gt;
    &amp;gt; are treated as System Elements &amp;#8211; we end up calling&lt;br/&gt;
    &amp;gt; XMLPersistenceMetaDataParser.startSystemElement().&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; The processing in this method is dependent on whether the given&lt;br/&gt;
    &amp;gt; element is a&lt;br/&gt;
    &amp;gt; MetaDataTag or not.  When we process the &quot;entity-listener&quot; element,&lt;br/&gt;
    &amp;gt; it&apos;s&lt;br/&gt;
    &amp;gt; treated like a &quot;normal&quot; element and we fall past the switch&lt;br/&gt;
    &amp;gt; statement and&lt;br/&gt;
    &amp;gt; eventually call startEntityListener().  This processing all seems&lt;br/&gt;
    &amp;gt; to depend&lt;br/&gt;
    &amp;gt; on whether the _elems hashmap contains a string entry or a&lt;br/&gt;
    &amp;gt; MetatDataTag for&lt;br/&gt;
    &amp;gt; a given Element.  What is the significance of being a MetaDataTag&lt;br/&gt;
    &amp;gt; or not?&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; In this simple orm.xml, I have noticed that persistence-unit-metadata,&lt;br/&gt;
    &amp;gt; persistence-unit-defaults, and entity-listener are not&lt;br/&gt;
    &amp;gt; MetaDataTags.  But,&lt;br/&gt;
    &amp;gt; entity-listeners and the individual pre-persist, post-persist, etc&lt;br/&gt;
    &amp;gt; elements&lt;br/&gt;
    &amp;gt; are all MetaDataTags.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; When one of these pre-* or post-* MetaDataTag elements are&lt;br/&gt;
    &amp;gt; processed in the&lt;br/&gt;
    &amp;gt; startSystemElement() method, we fall into the default leg of the&lt;br/&gt;
    &amp;gt; switch&lt;br/&gt;
    &amp;gt; statement and produce the TRACE message outlined above.&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; Any pointers would be appreciated.  Thanks!&lt;br/&gt;
    &amp;gt;&lt;br/&gt;
    &amp;gt; Kevin&lt;br/&gt;
------------------------------------------------------------&lt;/p&gt;</description>
                <environment></environment>
        <key id="12360675">OPENJPA-103</key>
            <summary>Default Listeners not being processed correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kwsutter">Kevin Sutter</assignee>
                                    <reporter username="kwsutter">Kevin Sutter</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Jan 2007 17:08:31 +0000</created>
                <updated>Tue, 31 Jul 2007 19:57:05 +0100</updated>
                            <resolved>Wed, 17 Jan 2007 22:50:03 +0000</resolved>
                                                    <fixVersion>0.9.7</fixVersion>
                                    <component>jpa</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12465593" author="kwsutter" created="Wed, 17 Jan 2007 22:50:03 +0000"  >&lt;p&gt;The processing in the XMLPersistenceMetaDataParser.startSystemElement method had to be updated to recognize the pre-* and post-* lifecycle methods as being valid entries at the &quot;system&quot; level.  Since this processing was already part of the &quot;class&quot; level, I just had to add the corresponding case entry and invocation of the methods.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160440</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hysz1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>203024</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>