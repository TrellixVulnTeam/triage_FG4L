<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:41:55 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-305/OPENJPA-305.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-305] Dynamic configuration of EntityManagerFactory</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-305</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;OpenJPA configures EntityManagerFactory at creation time via an instance of Configuartion object. Once EntityManagerFactory is created and a EntityManager is issued from it &amp;#8211; the Configuration is frozen by design. That is no further changes to Configuration is allowed as long as EntityManagerFactory lives.&lt;/p&gt;

&lt;p&gt;For certain configuration properties, it is desirable to change them during the lifetime of a EntityManagerFactory.&lt;br/&gt;
This issue is raised to initiate a discussion on such a feature, the possibility and limitations of dynamic update and track the impact of such a change as frozen Configuration is an important assumption.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12375252">OPENJPA-305</key>
            <summary>Dynamic configuration of EntityManagerFactory</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ppoddar@apache.org">Pinaki Poddar</assignee>
                                    <reporter username="ppoddar@apache.org">Pinaki Poddar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 2 Aug 2007 20:52:48 +0100</created>
                <updated>Tue, 9 Mar 2010 18:32:37 +0000</updated>
                            <resolved>Mon, 9 Jun 2008 21:55:44 +0100</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12517415" author="ppoddar@apache.org" created="Fri, 3 Aug 2007 01:42:26 +0100"  >&lt;p&gt;Dynamic (i.e. while EntityManagerFactory is alive) change of Configuration will impact the pooling of BrokerFactory (which is the core implementation of which EntityManagerFactory is a facade).&lt;/p&gt;

&lt;p&gt;The pool maintains a Map of poolKey to BrokerFactory. A poolKey is effectively the Configuration expressed as a Property. So dynamically changing configuration properties must take into account the integrity of this pool which is till now based on the assumption of constancy of Configuration.&lt;/p&gt;

&lt;p&gt;Possibility of using IdentityHashMap and use the Configuration instance (not its Property values) as key:&lt;br/&gt;
  This is most likely &lt;b&gt;not&lt;/b&gt; going to work. The idea of freezing the config at the first place (perhaps) originated because callers who supply new copies of Configuration (that are same by value but not by identity) expect to get the same Factory. &lt;/p&gt;</comment>
                            <comment id="12517419" author="pcl" created="Fri, 3 Aug 2007 02:11:07 +0100"  >&lt;p&gt;I think that the best approach is to make the key computation be based on the original values. That way, any lookups for a configuration with a given set of original values will route to the same (possibly-mutated) new values.&lt;/p&gt;</comment>
                            <comment id="12517437" author="clr" created="Fri, 3 Aug 2007 05:38:31 +0100"  >&lt;p&gt;I agree with Patrick.&lt;/p&gt;

&lt;p&gt;The intent of making the EMF not configurable after the first getEM is just so that you can find an EMF based on the user-defined values.&lt;/p&gt;

&lt;p&gt;If you ask for an EMF that has a default property, and that property has changed, then you cannot get the behavior you expect.&lt;/p&gt;</comment>
                            <comment id="12528612" author="ppoddar@apache.org" created="Wed, 19 Sep 2007 00:43:40 +0100"  >&lt;p&gt;This is a proposed patch that makes few significant changes in Value-Configuration part to support dynamic update of Configuration. Hence this is a patch for your comment/review.&lt;/p&gt;

&lt;p&gt;1. The intents are&lt;br/&gt;
    a) certain Values can be marked dynamic. This allows them to be modified even after the configuration is frozen i.e. EntityManagerFactory has issued its first EntityManager.&lt;/p&gt;

&lt;p&gt;    b) because EntityManagerFactories are cached based on the keys of their configuration, the hashCode of the configuration must not be changed when a dynamic value V changes from x1 to x2. &lt;br/&gt;
      For example, for Configuration A, one of it&apos;s value V(A) is originally set to x1. Later it was modified to x2.&lt;br/&gt;
      A.hashCode() should remain the same before and after the modification if V is dynamic.&lt;/p&gt;

&lt;p&gt;    c) Equality: Two Configuration A and B had originally V(A)=x and V(B)=y where V is dynamic.&lt;br/&gt;
       Initially x!=y. That implies A not equals B. &lt;br/&gt;
       Now V(B) is set to x. Does A now equals B? &lt;br/&gt;
       The intended answer is no.&lt;/p&gt;

&lt;p&gt;2. What needed to  support (1c) is notion of &apos;originalValue&apos; for dynamic properties. This patch implements by declaring a new String field in Value.class, also logic of setting this &apos;originalValue&apos; in setString() and setObject() methods.&lt;/p&gt;

&lt;p&gt;3. The &apos;originalValue&apos; notion is used for changed behavior of Value.equals() and Value.hashCode() methods.&lt;/p&gt;

&lt;p&gt;4. ConfigurationImpl used to compute its hashCode() and equals() by first converting itself into a Properties object. I do not why. That is the main reason this is submitted as a patch for everyone&apos;s comment/review. &lt;br/&gt;
   This patch makes a conceptual change. Now ConfigurationImpl computes its hashCode() and equals() based on its Values &amp;#8211; who in turn evaluates their own hashCode() and equals() that varies based on their dynamic nature.&lt;/p&gt;


</comment>
                            <comment id="12528633" author="pcl" created="Wed, 19 Sep 2007 03:02:15 +0100"  >&lt;p&gt;Generally, it looks good. Some comments:&lt;/p&gt;

&lt;p&gt;I don&apos;t understand why we do the isDynamic() check in equals() and hashCode(), though; shouldn&apos;t getOriginalValue() always be correct?&lt;/p&gt;

&lt;p&gt;Also, it looks like there&apos;s a synchronization issue at hand &amp;#8211; based on my reading, dynamic sets must occur in a synchronized manner, or the behavior is non-deterministic. That is OK (I don&apos;t think that we necessarily want to add synchronization on accesses), but should be well-documented.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12375261">OPENJPA-307</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12366138" name="openjpa-305.patch.1.txt" size="7071" author="ppoddar@apache.org" created="Wed, 19 Sep 2007 00:43:40 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 3 Aug 2007 01:11:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160631</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyt5wn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204137</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>