<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:34:10 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-525/OPENJPA-525.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-525] Inserts new entity with NULL value for Clob column actually inserts empty string</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-525</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Inserts new entity with NULL value for Clob column with &quot;nullable = true&quot; actually inserts empty string as the value!&lt;/p&gt;

&lt;p&gt;Here&apos;s the persistence class:&lt;br/&gt;
public class Exam... &lt;/p&gt;
{
    @Lob
    private String text;
}</description>
                <environment>OpenJPA 1.0.0, 1.0.2&lt;br/&gt;
Oracle XE 10g (JDBC driver 10.2.0.3.0&lt;br/&gt;
JRE 1.5.0_13</environment>
        <key id="12389721">OPENJPA-525</key>
            <summary>Inserts new entity with NULL value for Clob column actually inserts empty string</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="milosz">Milosz Tylenda</assignee>
                                    <reporter username="frankca">Frank Le</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Feb 2008 19:20:04 +0000</created>
                <updated>Tue, 9 Mar 2010 18:31:01 +0000</updated>
                            <resolved>Sun, 27 Sep 2009 08:01:34 +0100</resolved>
                                    <version>1.0.0</version>
                    <version>1.0.2</version>
                    <version>1.1.0</version>
                    <version>1.2.1</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.1.1</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.0.0-M3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12719892" author="amy" created="Tue, 16 Jun 2009 02:38:05 +0100"  >&lt;p&gt;The patch is created in trunk.&lt;/p&gt;

&lt;p&gt;The bug in ResultSetResult prevents invocation to getClobString() on the dictionary class.&lt;/p&gt;</comment>
                            <comment id="12719905" author="amy" created="Tue, 16 Jun 2009 04:16:53 +0100"  >&lt;p&gt;this is for branch1.1.x&lt;/p&gt;</comment>
                            <comment id="12721476" author="dezzio" created="Thu, 18 Jun 2009 21:47:02 +0100"  >&lt;p&gt;Applied Amy&apos;s 1.1.x patch to the 1.1.x branch at rev 786218&lt;/p&gt;</comment>
                            <comment id="12723348" author="dezzio" created="Wed, 24 Jun 2009 00:08:52 +0100"  >&lt;p&gt;Merged change 786218 (Amy&apos;s patch) to trunk at change 787868&lt;/p&gt;</comment>
                            <comment id="12723354" author="dezzio" created="Wed, 24 Jun 2009 00:17:37 +0100"  >&lt;p&gt;This bug appears to affect all branches made prior to rev 787868, and branch owners may want to merge the change.  This bug should be closed after allowing a reasonable period of time for branch owners to take action.&lt;/p&gt;</comment>
                            <comment id="12723662" author="milosz" created="Wed, 24 Jun 2009 19:06:26 +0100"  >&lt;p&gt;Could you please check the possible impact this change has on the streaming LOB functionality? Not very sure it is because of this this but that functionality is now broken. The tests are named ReaderLobTest and InputStreamLobTest. Although they are not executed by the test suite, the functionality is described in user manual (I have no idea why someone named the tests that way causing the test suite to skip them - oversight?). Note that the tests require a database other than Derby to run on.&lt;/p&gt;

&lt;p&gt;One of stack traces I am receiving with MySQL:&lt;/p&gt;

&lt;p&gt;        at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:984)&lt;br/&gt;
        at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:878)&lt;br/&gt;
        at org.apache.openjpa.kernel.DelegatingBroker.find(DelegatingBroker.java:201)&lt;br/&gt;
        at org.apache.openjpa.persistence.EntityManagerImpl.find(EntityManagerImpl.java:464)&lt;br/&gt;
        at org.apache.openjpa.jdbc.meta.strats.AbstractLobTest.testSetResetAndFlush(AbstractLobTest.java:254)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:585)&lt;br/&gt;
        at junit.framework.TestCase.runTest(TestCase.java:154)&lt;br/&gt;
        at junit.framework.TestCase.runBare(TestCase.java:127)&lt;br/&gt;
        at org.apache.openjpa.persistence.test.PersistenceTestCase.runBare(PersistenceTestCase.java:475)&lt;br/&gt;
        at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.framework.TestResult.run(TestResult.java:109)&lt;br/&gt;
        at junit.framework.TestCase.run(TestCase.java:118)&lt;br/&gt;
        at org.apache.openjpa.persistence.test.PersistenceTestCase.run(PersistenceTestCase.java:190)&lt;br/&gt;
        at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
        at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:585)&lt;br/&gt;
        at org.apache.maven.surefire.junit.JUnitTestSet.execute(JUnitTestSet.java:213)&lt;br/&gt;
        at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.executeTestSet(AbstractDirectoryTestSuite.java:140)&lt;br/&gt;
        at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.execute(AbstractDirectoryTestSuite.java:127)&lt;br/&gt;
        at org.apache.maven.surefire.Surefire.run(Surefire.java:177)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:585)&lt;br/&gt;
        at org.apache.maven.surefire.booter.SurefireBooter.runSuitesInProcess(SurefireBooter.java:345)&lt;br/&gt;
        at org.apache.maven.surefire.booter.SurefireBooter.main(SurefireBooter.java:1009)&lt;br/&gt;
Caused by: java.lang.ClassCastException: org.apache.openjpa.jdbc.schema.DynamicSchemaFactory$DynamicColumn&lt;br/&gt;
        at org.apache.openjpa.jdbc.sql.ResultSetResult.getCharacterStreamInternal(ResultSetResult.java:305)&lt;br/&gt;
        at org.apache.openjpa.jdbc.sql.AbstractResult.getCharacterStream(AbstractResult.java:499)&lt;br/&gt;
        at org.apache.openjpa.jdbc.meta.strats.LobFieldStrategy.load(LobFieldStrategy.java:181)&lt;br/&gt;
        at org.apache.openjpa.jdbc.meta.FieldMapping.load(FieldMapping.java:912)&lt;br/&gt;
        at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:1015)&lt;br/&gt;
        at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:967)&lt;br/&gt;
        at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:628)&lt;br/&gt;
        at org.apache.openjpa.kernel.DelegatingStoreManager.load(DelegatingStoreManager.java:116)&lt;br/&gt;
        at org.apache.openjpa.datacache.DataCacheStoreManager.load(DataCacheStoreManager.java:393)&lt;br/&gt;
        at org.apache.openjpa.kernel.DelegatingStoreManager.load(DelegatingStoreManager.java:116)&lt;br/&gt;
        at org.apache.openjpa.kernel.ROPStoreManager.load(ROPStoreManager.java:78)&lt;br/&gt;
        at org.apache.openjpa.kernel.StateManagerImpl.loadFields(StateManagerImpl.java:2989)&lt;br/&gt;
        at org.apache.openjpa.kernel.StateManagerImpl.load(StateManagerImpl.java:405)&lt;br/&gt;
        at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:971)&lt;br/&gt;
        ... 32 more&lt;/p&gt;</comment>
                            <comment id="12727719" author="allee8285" created="Mon, 6 Jul 2009 20:31:56 +0100"  >&lt;p&gt;After the latest patch, I am seeing the following exception:&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.ClassCastException: org.apache.openjpa.jdbc.schema.DynamicSchemaFactory$DynamicColumn incompatible with java.lang.Number&lt;br/&gt;
at org.apache.openjpa.jdbc.sql.ResultSetResult.getCharacterStreamInternal(ResultSetResult.java:305)&lt;br/&gt;
at org.apache.openjpa.jdbc.sql.ResultSetResult.getObjectInternal(ResultSetResult.java:423)&lt;br/&gt;
at org.apache.openjpa.jdbc.sql.AbstractResult.getObject(AbstractResult.java:694)&lt;br/&gt;
at org.apache.openjpa.jdbc.meta.strats.HandlerStrategies.loadDataStore(HandlerStrategies.java:220)&lt;br/&gt;
at org.apache.openjpa.jdbc.meta.strats.HandlerFieldStrategy.load(HandlerFieldStrategy.java:186)&lt;br/&gt;
at org.apache.openjpa.jdbc.meta.FieldMapping.load(FieldMapping.java:912)&lt;br/&gt;
at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:1015)&lt;br/&gt;
at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:967)&lt;br/&gt;
at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initializeState(JDBCStoreManager.java:391)&lt;br/&gt;
at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.initialize(JDBCStoreManager.java:290)&lt;br/&gt;
at com.ibm.ws.persistence.jdbc.kernel.WsJpaJDBCStoreManager.initialize(WsJpaJDBCStoreManager.java:147)&lt;br/&gt;
at org.apache.openjpa.kernel.DelegatingStoreManager.initialize(DelegatingStoreManager.java:111)&lt;br/&gt;
at org.apache.openjpa.kernel.ROPStoreManager.initialize(ROPStoreManager.java:57)&lt;br/&gt;
at org.apache.openjpa.kernel.BrokerImpl.initialize(BrokerImpl.java:1003)&lt;br/&gt;
at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:961)&lt;/p&gt;

&lt;p&gt;Look further in the changes and found in:&lt;/p&gt;

&lt;p&gt;ResultSetResult.java &lt;/p&gt;

&lt;p&gt;    protected Object translate(Object obj, Joins joins)&lt;br/&gt;
        throws SQLException &lt;/p&gt;
{
        if (obj instanceof Number)
            return obj;
        // getStringInternal will take care the translation
        if (obj instanceof Column &amp;amp;&amp;amp; ((Column) obj).getType() == Types.CLOB)
        	return obj;
        return Numbers.valueOf(findObject(obj, joins));
    }

&lt;p&gt;The newly added code will always return object which is a Column type. However this method is expect a Number object to be returned.&lt;/p&gt;

&lt;p&gt;        // getStringInternal will take care the translation&lt;br/&gt;
        if (obj instanceof Column &amp;amp;&amp;amp; ((Column) obj).getType() == Types.CLOB)&lt;br/&gt;
        	return obj;&lt;/p&gt;

&lt;p&gt;Albert Lee.&lt;/p&gt;</comment>
                            <comment id="12727897" author="allee8285" created="Tue, 7 Jul 2009 04:37:35 +0100"  >&lt;p&gt;Attempt to fix the incompatible ClassCastException:&lt;/p&gt;

&lt;p&gt;1) reverted the translate() method implementation&lt;br/&gt;
2) enhanced the AbstractResult.getStringInternal() to include a new parameter indicating if the String is a ClobString, such that the ResultSetResult.getStringInternal() can use it to determine if the _dict.getClobString() or _dict.getString() should be call.&lt;/p&gt;

&lt;p&gt;After this patch is applied, OpenJPA trunk built and all tests ran successfully.&lt;/p&gt;

&lt;p&gt;Amy and Milosz, can you please try this patch to verify it does solve the original and subsequent regression problems?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Albert Lee.&lt;/p&gt;</comment>
                            <comment id="12728365" author="milosz" created="Tue, 7 Jul 2009 21:56:08 +0100"  >&lt;p&gt;Hi Albert. I have tried the patch with MySQL and it resolved most of the LOB streaming errors. Unfortunately one LOB streaming test still fails and it looks like another one started failing:&lt;/p&gt;

&lt;p&gt;  testQueryQualifiedId(org.apache.openjpa.persistence.jdbc.maps.spec_10_1_27_ex6.TestSpec10_1_27_Ex6)&lt;br/&gt;
  testUpdateWithNull(org.apache.openjpa.jdbc.meta.strats.TestReaderLob)&lt;/p&gt;
</comment>
                            <comment id="12728379" author="allee8285" created="Tue, 7 Jul 2009 22:46:11 +0100"  >&lt;p&gt;Milosz,&lt;/p&gt;

&lt;p&gt;Thanks for trying the patch on MySQL.&lt;/p&gt;

&lt;p&gt;I did not run into any problem in Derby and DB2. Probably it is some db specific feature.&lt;/p&gt;

&lt;p&gt;How is the failure surfaced in the test? What is the symptoms looks like? Do you have any exception stack to look at ? Do you have any idea what may have gone wrong? Not sure how is the patch affect Oracle db?&lt;/p&gt;

&lt;p&gt;Albert Lee.&lt;/p&gt;</comment>
                            <comment id="12728755" author="allee8285" created="Wed, 8 Jul 2009 16:55:05 +0100"  >&lt;p&gt;Milosz,&lt;/p&gt;

&lt;p&gt;Did you make any progress on testing the MySQL db with the fixes? Are the failing tests passed before the original patch?&lt;/p&gt;

&lt;p&gt;Do you have any objection if we commit the changes so that it reverts the original regression first. Then figure out what are the problems that you have encountered since the original fix had the observed regression? &lt;/p&gt;

&lt;p&gt;If I don&apos;t hear from you (or anyone) soon, I shall go ahead with the commit.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Albert Lee.&lt;/p&gt;</comment>
                            <comment id="12728854" author="milosz" created="Wed, 8 Jul 2009 20:07:48 +0100"  >&lt;p&gt;Albert,&lt;/p&gt;

&lt;p&gt;You don&apos;t run into problems with Derby and DB2 because LOB streaming requires other databases (see AbstractLOBTest), otherwise it is basically a no-op.&lt;/p&gt;

&lt;p&gt;Yes, the failing tests passed before the original patch although they were not executed by the default test suite because of incorrect names.&lt;/p&gt;

&lt;p&gt;For me, you can go ahead with the commit. I have little time this week and then I start vacation. I will dig into this problem but probably no earlier than Jul 20.&lt;/p&gt;</comment>
                            <comment id="12737245" author="milosz" created="Thu, 30 Jul 2009 20:32:53 +0100"  >&lt;p&gt;I started looking into this problem but no success so far. I will again be out of source for the first half of August, so if someone needs it earlier, grab it.&lt;/p&gt;</comment>
                            <comment id="12743672" author="milosz" created="Sat, 15 Aug 2009 11:54:49 +0100"  >&lt;p&gt;Although Amy&apos;s patch caused more failures in streaming LOB functionality, that functionality does not work without the patch either. I have double checked this and even 1.2.0 and 1.1.0 releases do not pass all the tests. I will open a new issue for possible fix of streaming LOB.&lt;/p&gt;</comment>
                            <comment id="12743677" author="milosz" created="Sat, 15 Aug 2009 12:22:38 +0100"  >&lt;p&gt;This issue is Oracle-specific.&lt;/p&gt;

&lt;p&gt;To answer Amy&apos;s initial question (unfortunately that comment is visible only when you are logged in):&lt;/p&gt;

&lt;p&gt;&amp;gt; We&apos;re using empty_lob() instead of &quot;null&quot; when the Lob field has no value even it is nullable. is there any historical reason to do so?&lt;/p&gt;

&lt;p&gt;I think the reason is: if we set a LOB column to null we are not able to later update that column with a string longer that 4000 chars. Most probably it was needed in Oracle 8 times but looks like is not needed anymore (starting from Oracle 9 or 10). We should consider reworking our Oracle LOB support - there are chances that some Oracle-specific code can now be avoided and issues like this will disappear.&lt;/p&gt;

&lt;p&gt;I will open a new issue for the idea of reworking Oracle LOB support.&lt;/p&gt;
</comment>
                            <comment id="12743688" author="milosz" created="Sat, 15 Aug 2009 13:04:25 +0100"  >&lt;p&gt;To clarify: OpenJPA persists an empty CLOB (Oracle-specific) when value to be persisted is null. Neither of the patches changes that. What the patches try to do is when the empty CLOB is read back, it is detected that the CLOB is empty and a null is returned. Without the patches, getString is called on the empty CLOB which gives an empty string to the user.&lt;/p&gt;

&lt;p&gt;Amy&apos;s patch fixes the issue (TestSerializedLobs.testNullableClob passes with Oracle) but causes Albert&apos;s failure.&lt;br/&gt;
Albert&apos;s patch breaks the Oracle behaviour again (TestSerializedLobs.testNullableClob fails with Oracle) but fixes the error introduced by Amy&apos;s patch (so it is basically the state when no patch has been applied in terms of functionality).&lt;/p&gt;</comment>
                            <comment id="12743838" author="milosz" created="Sun, 16 Aug 2009 13:21:05 +0100"  >&lt;p&gt;Albert, could you apply the attached &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-525&quot; title=&quot;Inserts new entity with NULL value for Clob column actually inserts empty string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-525&quot;&gt;&lt;del&gt;OPENJPA-525&lt;/del&gt;&lt;/a&gt;.3.patch to trunk and see whether it works for you? With that patch TestSerializedLobs.testNullableClob passes with Oracle.&lt;/p&gt;

&lt;p&gt;I have moved the call to translate method from AbstractResult.getObject to ResultSetResult.getObjectInternal. Now ResultSetResult.getObjectInternal receives a Column instead of a bare Number and can determine if the Coulmn is of type CLOB.&lt;/p&gt;</comment>
                            <comment id="12746796" author="amy" created="Mon, 24 Aug 2009 10:56:46 +0100"  >&lt;p&gt;hi Milosz &amp;amp; Albert,&lt;br/&gt;
thank you very much for looking into this issue.&lt;br/&gt;
Milosz , I&apos;ve tried &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-525&quot; title=&quot;Inserts new entity with NULL value for Clob column actually inserts empty string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-525&quot;&gt;&lt;del&gt;OPENJPA-525&lt;/del&gt;&lt;/a&gt;.3.patch on oracle. TestSerializedLobs can pass with it.&lt;br/&gt;
I also run TestInputStreamLob on mysql with it and the case can pass too. Could you please check in the patch?&lt;/p&gt;


&lt;p&gt;Thanks,&lt;br/&gt;
Amy&lt;/p&gt;</comment>
                            <comment id="12746807" author="amy" created="Mon, 24 Aug 2009 11:39:56 +0100"  >&lt;p&gt;patch for 1.1.x based on Milosz&apos;s patch&lt;/p&gt;</comment>
                            <comment id="12747052" author="dezzio" created="Mon, 24 Aug 2009 21:25:59 +0100"  >&lt;p&gt;Applied Amy&apos;s patch &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-525&quot; title=&quot;Inserts new entity with NULL value for Clob column actually inserts empty string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-525&quot;&gt;&lt;del&gt;OPENJPA-525&lt;/del&gt;&lt;/a&gt;-3-branch1.1.x.patch to branch 1.1.1 at revision 807362.  Includes merge from Milosz&apos;s change on trunk at 790666 that renamed misnamed test cases.&lt;/p&gt;

&lt;p&gt;Amy, can you let us know the results of testing this change with MySQL and Oracle (identifying DB and driver versions), as well as let us know the results of testing Milosz&apos;s patch on trunk with the same setups?&lt;/p&gt;</comment>
                            <comment id="12747216" author="amy" created="Tue, 25 Aug 2009 05:01:44 +0100"  >&lt;p&gt;Oracle: Database 10g Enterprise Edition Release 11g&lt;br/&gt;
Driver: Oracle JDBC Driver version - &quot;11.1.0.7.0-Production&quot;&lt;/p&gt;

&lt;p&gt;MySQL: 5.1.37-community MySQL Community Server (GPL)&lt;/p&gt;

&lt;p&gt;branch1.1.x: r807362&lt;br/&gt;
TestSerializedLobs passed on oracle and mysql.&lt;br/&gt;
TestInputStreamLob passed on mysql. on Oracle, it&apos;s result is &quot;Tests run: 13, Failures: 1, Errors: 12, Skipped: 0&quot;. The failure isn&apos;t caused by the patch. It failed before r786218 too. I think it should be tracked by &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1248&quot; title=&quot;LOB streaming does not work as expected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1248&quot;&gt;&lt;del&gt;OPENJPA-1248&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
TestReaderLob: on oracle, the result is similar with TestInputStreamLob. The failure isn&apos;t caused by the patch either. We should track it with &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1248&quot; title=&quot;LOB streaming does not work as expected&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1248&quot;&gt;&lt;del&gt;OPENJPA-1248&lt;/del&gt;&lt;/a&gt; too. I&apos;ll paste a stack trace to that issue. &lt;br/&gt;
on mysql, even before r786218, testUpdateWithNull will fail. at r807362 it also failed. I.e. the &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-525&quot; title=&quot;Inserts new entity with NULL value for Clob column actually inserts empty string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-525&quot;&gt;&lt;del&gt;OPENJPA-525&lt;/del&gt;&lt;/a&gt;-3-branch1.1.x.patch doesn&apos;t cause any regression. I&apos;ll create a new JIRA issue to track the failure.&lt;/p&gt;

&lt;p&gt;trunk: r807465+&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-525&quot; title=&quot;Inserts new entity with NULL value for Clob column actually inserts empty string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-525&quot;&gt;&lt;del&gt;OPENJPA-525&lt;/del&gt;&lt;/a&gt;.3.patch&lt;br/&gt;
TestSerializedLobs: same as 1.1.x branch&lt;br/&gt;
TestInputStreamLob: same as 1.1.x branch.&lt;br/&gt;
TestReaderLob: same as 1.1.x branch&lt;/p&gt;

&lt;p&gt;So I think &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-525&quot; title=&quot;Inserts new entity with NULL value for Clob column actually inserts empty string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-525&quot;&gt;&lt;del&gt;OPENJPA-525&lt;/del&gt;&lt;/a&gt;.3.patch does resolve the original problem of this issue and safe to be checked in.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Amy&lt;/p&gt;</comment>
                            <comment id="12747429" author="dezzio" created="Tue, 25 Aug 2009 15:19:09 +0100"  >&lt;p&gt;Milosz and Amy, thank you!&lt;/p&gt;

&lt;p&gt;Applied Milosz&apos;s &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-525&quot; title=&quot;Inserts new entity with NULL value for Clob column actually inserts empty string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-525&quot;&gt;&lt;del&gt;OPENJPA-525&lt;/del&gt;&lt;/a&gt;.3.patch to trunk at 807642.&lt;/p&gt;</comment>
                            <comment id="12748054" author="milosz" created="Wed, 26 Aug 2009 19:03:38 +0100"  >&lt;p&gt;I have ported &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-525&quot; title=&quot;Inserts new entity with NULL value for Clob column actually inserts empty string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-525&quot;&gt;&lt;del&gt;OPENJPA-525&lt;/del&gt;&lt;/a&gt;.3.patch along with new tests in TestSerializedLobs to branch 1.3.x.&lt;/p&gt;

&lt;p&gt;Mike, you can consider applying the fix to other branches or close this bug.&lt;/p&gt;</comment>
                            <comment id="12759995" author="milosz" created="Sun, 27 Sep 2009 08:01:34 +0100"  >&lt;p&gt;Reopen if needs porting to other branches.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12433149">OPENJPA-1248</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12435247">OPENJPA-1289</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12433905">OPENJPA-1263</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12433151">OPENJPA-1249</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12417465" name="OPENJPA-525-3-branch1.1.x.patch" size="4453" author="amy" created="Mon, 24 Aug 2009 11:39:55 +0100"/>
                            <attachment id="12412698" name="OPENJPA-525.2.patch" size="3182" author="allee8285" created="Tue, 7 Jul 2009 04:37:35 +0100"/>
                            <attachment id="12416706" name="OPENJPA-525.3.patch" size="2509" author="milosz" created="Sun, 16 Aug 2009 13:21:05 +0100"/>
                            <attachment id="12410739" name="OPENJPA525.patch" size="2612" author="amy" created="Tue, 16 Jun 2009 02:38:05 +0100"/>
                            <attachment id="12410747" name="OPENJPA525_1_1_x.patch" size="2628" author="amy" created="Tue, 16 Jun 2009 04:16:53 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Jun 2009 07:54:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160842</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyswsn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>202661</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>