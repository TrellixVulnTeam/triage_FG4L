<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:37:49 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1114/OPENJPA-1114.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1114] Bean Validation APIs should be an optional runtime dependency</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1114</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Bean Validation APIs should be an optional runtime dependency by using reflection to determine if the APIs are available before accessing our ValidatorImpl class or any javax.validation.* API classes.&lt;br/&gt;
openjpa-persistence will set scope=provided on geronimo-validation_1.0_spec&lt;br/&gt;
openjpa-all will include the spec in the aggregated all jar&lt;br/&gt;
openjpa-persistence-jdbc will not add a test dependency on the spec&lt;br/&gt;
openjpa-integration will be used to test the validation support via &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1106&quot; title=&quot;Integration tests for Bean Validation providers - Part 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1106&quot;&gt;&lt;del&gt;OPENJPA-1106&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12426871">OPENJPA-1114</key>
            <summary>Bean Validation APIs should be an optional runtime dependency</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12424122">OPENJPA-1052</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="drwoods">Donald Woods</assignee>
                                    <reporter username="drwoods">Donald Woods</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Jun 2009 03:21:02 +0100</created>
                <updated>Tue, 9 Mar 2010 18:31:16 +0000</updated>
                            <resolved>Tue, 2 Jun 2009 19:22:56 +0100</resolved>
                                                    <fixVersion>2.0.0-M2</fixVersion>
                                    <component>validation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12715339" author="drwoods" created="Tue, 2 Jun 2009 03:28:05 +0100"  >&lt;p&gt;work in-progress.  will test some more tomorrow before committing....&lt;/p&gt;</comment>
                            <comment id="12715347" author="drwoods" created="Tue, 2 Jun 2009 03:52:58 +0100"  >&lt;p&gt;updated patch&lt;/p&gt;</comment>
                            <comment id="12716750" author="drwoods" created="Fri, 5 Jun 2009 21:56:34 +0100"  >&lt;p&gt;Some details about the included logging/tracing:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If the BV APIs are not on the classpath or ValidationMode=NONE, then nothing will get logged unless you have TRACE enabled.&lt;/li&gt;
	&lt;li&gt;If you have the BV APIs but not a provider, then you&apos;ll get a warning in the log.&lt;/li&gt;
	&lt;li&gt;If you have validation mode = CALLBACK but either the BV API or Impl is missing, then you&apos;ll get a error in the log and eventually a fatal exception once &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1111&quot; title=&quot;Validation mode of callback should cause a PersistenceException when no provider is available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1111&quot;&gt;&lt;del&gt;OPENJPA-1111&lt;/del&gt;&lt;/a&gt; is resolved.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12716765" author="ppoddar@apache.org" created="Fri, 5 Jun 2009 22:56:28 +0100"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If you have the BV APIs but not a provider, then you&apos;ll get a warning in the log.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Can we warn only once? I noticed the warning messages simply because  there were too many of them.&lt;/p&gt;</comment>
                            <comment id="12717247" author="drwoods" created="Mon, 8 Jun 2009 14:22:49 +0100"  >&lt;p&gt;The warning happens everytime you create a new EM/BrokerImpl, as a new LifecycleEventManager gets created for each Broker created.&lt;br/&gt;
If we decide later on to include the BV API from Geronimo as a runtime dependency in the POMs (currently it is not, but we include it in the release assembly and openjpa-all.jar) then we can change that log msg to a Trace, but for now, we should include the warning since it is an optional depend (which means a user should supply their own API + Impl for now.)&lt;/p&gt;</comment>
                            <comment id="12717266" author="ppoddar@apache.org" created="Mon, 8 Jun 2009 15:27:21 +0100"  >&lt;p&gt;Can this vaalidator be configured per-EM basis or only per_EMF basis?&lt;br/&gt;
If it can only be done per-EMF basis then there should not be warning per EM.&lt;/p&gt;


&lt;p&gt;PersistenceProductDerivation constructs ValidatingLifecycleEventManager. &lt;br/&gt;
This is an unusual usage of plug-in. Can you elaborate why ValidatingLifecycleEventManager can not be plugged-in in the usual way other plug-ins work?&lt;br/&gt;
There are many plug-ins for which compile-time dependency to a third-party library is avoided.&lt;/p&gt;





</comment>
                            <comment id="12717307" author="drwoods" created="Mon, 8 Jun 2009 17:04:19 +0100"  >&lt;p&gt;It is created at the EMF level, as a ValidatorFactory can only be passed in on a createEMF() or createContainerEMF() call as a Map property, or by trying to create a default validator off the classpath if none were supplied.&lt;/p&gt;

&lt;p&gt;A little background - The ValidatingLifecycleEventManager (VLEM) was created as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1068&quot; title=&quot;Support Bean Validation: Entity validation upon lifecycle events&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1068&quot;&gt;&lt;del&gt;OPENJPA-1068&lt;/del&gt;&lt;/a&gt; as a way to extend the existing LifecycleEventManager (LEM) with Bean Validation (BV) specific behavior.&lt;br/&gt;
Previously, the LEM was created by BrokerImpl.initialize(), but we couldn&apos;t put the VLEM vs. LEM logic there, as BrokerImpl is in openjpa-kernel and doesn&apos;t have access to any of the JPA Spec APIs.  We also couldn&apos;t place the logic in OpenJPAConfigurationImpl, as that class is also in openjpa-kernel and can&apos;t access the JPA Spec APIs.  So, we followed Albert&apos;s coding for LockMgr and used the PersistenceProductDerivation to setup the configuration objects.&lt;br/&gt;
Now, there is still one scenario that doesn&apos;t work and will be addressed by &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1111&quot; title=&quot;Validation mode of callback should cause a PersistenceException when no provider is available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1111&quot;&gt;&lt;del&gt;OPENJPA-1111&lt;/del&gt;&lt;/a&gt;, which may lead us to moving the VLEM vs LEM creation logic to some other location.&lt;/p&gt;

&lt;p&gt;Any thoughts on where this logic (which requires access to the javax.persistence.validation spec classes) should reside would be greatly appreciated.&lt;/p&gt;</comment>
                            <comment id="12718065" author="ppoddar@apache.org" created="Wed, 10 Jun 2009 14:10:56 +0100"  >&lt;p&gt;The attached patch shows how a ValidatingLifecycleManager can be configured without bringing in compile-time dependency to Validation API jar.&lt;br/&gt;
This conventional plug-in route also helps you to configure VLEM as a bean. And hence this patch can be improved.&lt;br/&gt;
For example, making ValidationMode and Factory setting as part of VLEM itself. This will help removing separate API method on OpenJPAConfiguration for ValidationMode/factory which are semantically interdependent but that fact is neither obvious nor perhaps enforceable within the API.  &lt;/p&gt;</comment>
                            <comment id="12718089" author="drwoods" created="Wed, 10 Jun 2009 15:18:18 +0100"  >&lt;p&gt;OK, thanks for clearing up the plugin concept, but I think we still have the issue of when to set the alias to &quot;jpa2&quot;, since we need all of the product derivations applied to the config before we try to initialize the plugin.  I&apos;ll look at this some more, as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-1111&quot; title=&quot;Validation mode of callback should cause a PersistenceException when no provider is available&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-1111&quot;&gt;&lt;del&gt;OPENJPA-1111&lt;/del&gt;&lt;/a&gt;.  Thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12424743">OPENJPA-1068</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12409625" name="OPENJPA-1114.patch" size="10619" author="drwoods" created="Tue, 2 Jun 2009 03:52:58 +0100"/>
                            <attachment id="12409621" name="OPENJPA-1114.patch" size="8735" author="drwoods" created="Tue, 2 Jun 2009 03:28:05 +0100"/>
                            <attachment id="12410311" name="openjpa-1114.2.txt" size="12299" author="ppoddar@apache.org" created="Wed, 10 Jun 2009 14:10:56 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Jun 2009 21:56:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161402</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyt3wn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>203813</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>