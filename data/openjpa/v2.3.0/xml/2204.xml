<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:32:30 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-2204/OPENJPA-2204.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-2204] NPE in JDBCStoreManager with Trace turned on</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-2204</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Reporting JIRA on behalf of a user without access to JIRAs...&lt;/p&gt;

&lt;p&gt;OK - nearly there! Presumably because we&apos;re no longer hooked in to the container, OpenJPA was pumping out its log messages to system out. I set openjpa.Log to &quot;commons&quot; and, as desired, it now sends trace to java.util.logging. The only problem is that, when I set trace to &quot;openjpa.*=all&quot; I get a NullPointerException (that isn&apos;t there when trace is turned off):&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;31/05/12 11:31:05:576 BST&amp;#93;&lt;/span&gt; 00000020 id=         com.ibm.amc.AmcRuntimeException                              3 printStackTrace java.lang.NullPointerException&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.find(JDBCStoreManager.java:979)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.strats.UntypedPCValueHandler.toObjectValue(UntypedPCValueHandler.java:127)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.strats.HandlerStrategies.loadObject(HandlerStrategies.java:207)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.strats.HandlerCollectionTableFieldStrategy.loadElement(HandlerCollectionTableFieldStrategy.java:78)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.strats.StoreCollectionFieldStrategy.load(StoreCollectionFieldStrategy.java:558)&lt;br/&gt;
	at org.apache.openjpa.jdbc.meta.FieldMapping.load(FieldMapping.java:934)&lt;br/&gt;
	at org.apache.openjpa.jdbc.kernel.JDBCStoreManager.load(JDBCStoreManager.java:673)&lt;br/&gt;
	at com.ibm.ws.persistence.jdbc.kernel.WsJpaJDBCStoreManager.load(WsJpaJDBCStoreManager.java:130)&lt;br/&gt;
	at org.apache.openjpa.kernel.DelegatingStoreManager.load(DelegatingStoreManager.java:117)&lt;br/&gt;
	at org.apache.openjpa.kernel.ROPStoreManager.load(ROPStoreManager.java:78)&lt;br/&gt;
	at org.apache.openjpa.kernel.StateManagerImpl.loadFields(StateManagerImpl.java:3071)&lt;br/&gt;
	at org.apache.openjpa.kernel.StateManagerImpl.loadField(StateManagerImpl.java:3148)&lt;br/&gt;
	at org.apache.openjpa.kernel.StateManagerImpl.beforeAccessField(StateManagerImpl.java:1612)&lt;br/&gt;
	at org.apache.openjpa.kernel.StateManagerImpl.accessingField(StateManagerImpl.java:1597)&lt;br/&gt;
	at com.ibm.amc.server.action.impl.ActionStatusImpl.pcGetupdates(ActionStatusImpl.java)&lt;br/&gt;
	at com.ibm.amc.server.action.impl.ActionStatusImpl.getUpdates(ActionStatusImpl.java:206)&lt;/p&gt;

&lt;p&gt;This NPE looks to be due to dumping the parameters for the JDBCStoreManager.find():&lt;/p&gt;

&lt;p&gt;        if (_log.isTraceEnabled()) &lt;/p&gt;
{
            _log.trace(&quot;find: oid=&quot;+oid+&quot; &quot;+vm.getDeclaredTypeMapping().getDescribedType());
        }

&lt;p&gt;And, either vm or vm.getDeclaredTypeMapping() is null...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12558784">OPENJPA-2204</key>
            <summary>NPE in JDBCStoreManager with Trace turned on</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kwsutter">Kevin Sutter</assignee>
                                    <reporter username="kwsutter">Kevin Sutter</reporter>
                        <labels>
                    </labels>
                <created>Thu, 31 May 2012 14:47:38 +0100</created>
                <updated>Tue, 5 Jun 2012 03:23:38 +0100</updated>
                            <resolved>Tue, 5 Jun 2012 03:23:38 +0100</resolved>
                                    <version>2.2.1</version>
                    <version>2.3.0</version>
                                    <fixVersion>2.3.0</fixVersion>
                                    <component>jdbc</component>
                    <component>logging</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13286601" author="kwsutter" created="Thu, 31 May 2012 15:28:54 +0100"  >&lt;p&gt;A quick review of the code shows that the vm parameter must not be null.  This JDBCStoreManager.find() is called from three locations and all three locations have accessed the &quot;vm&quot; parameter prior to this find() operation.  So, it&apos;s looking like it&apos;s the getDeclaredTypeMapping() that is returning null.  I&apos;ll look at that next...&lt;/p&gt;</comment>
                            <comment id="13286946" author="kwsutter" created="Thu, 31 May 2012 22:09:12 +0100"  >&lt;p&gt;Now that I look closer at the original exception and call stack, it looks like the NPE might actually be coming from attempting to dump the oid...  We check if the oid is null at the beginning of the method, but maybe the toString() method on one of our oid types is causing the NPE...&lt;/p&gt;</comment>
                            <comment id="13289090" author="kwsutter" created="Tue, 5 Jun 2012 03:21:18 +0100"  >&lt;p&gt;Reproduced the problem  by turning on Trace for the org.apache.openjpa.persistence.graph.TestPersistentGraph junit testcase.  My first guess was correct &amp;#8211; the getDeclaredTypeMapping() was returning null and causing the NPE for the trace string.  I modified the prep for this trace string and all works now.  I&apos;ll correct in Trunk and let other service stream owners pull it back, if desired.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240162</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxus8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3395</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>