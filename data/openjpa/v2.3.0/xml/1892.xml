<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:42:05 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-1892/OPENJPA-1892.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-1892] NullPointerException thrown by the BrokerImpl.find() if requesting an entity which is marked by the @Cacheable(false) annotation</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-1892</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;The configuration is as follows:&lt;br/&gt;
1. We have two entities which are in parent-child relationship (class Parent, class Child extends Parent)&lt;br/&gt;
2. The child entity is marked by the @Cacheable(false) annotation&lt;br/&gt;
3. The parent entity is not marked by the @Cacheable annotation&lt;br/&gt;
4. Shared cache configuration is set to DISABLE_SELECTIVE&lt;br/&gt;
5. Transaction type is RESOURCE_LOCAL&lt;/p&gt;

&lt;p&gt;The test case is:&lt;br/&gt;
1. Create an instance of the Child entity and set some properties&lt;br/&gt;
2. Persist the entity by calling the EntityManager.persist() method&lt;br/&gt;
3. Request the entity using EntityManager.find() method and make sure the returned instance is the same which been persisted.&lt;br/&gt;
4. Clear L1 cache usign EntityManager.clear() mwthod&lt;br/&gt;
5. Repeat step 3. Here we get NPE in the BrokerImpl.find()&lt;/p&gt;

&lt;p&gt;&amp;lt;openjpa-2.0.0-r422266:935683 nonfatal general error&amp;gt; org.apache.openjpa.persistence.PersistenceException: null&lt;br/&gt;
FailedObject: 2051 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.openjpa.util.StringId&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;java.lang.String&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:986)&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:880)&lt;br/&gt;
	at org.apache.openjpa.kernel.DelegatingBroker.find(DelegatingBroker.java:223)&lt;br/&gt;
	at org.apache.openjpa.persistence.EntityManagerImpl.find(EntityManagerImpl.java:476)&lt;br/&gt;
	at test.openjpa.caching.TestOpenJPACacheable.test(TestOpenJPACacheable.java:55)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)&lt;br/&gt;
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)&lt;br/&gt;
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)&lt;br/&gt;
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)&lt;br/&gt;
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:76)&lt;br/&gt;
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)&lt;br/&gt;
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)&lt;br/&gt;
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)&lt;br/&gt;
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)&lt;br/&gt;
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)&lt;br/&gt;
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)&lt;br/&gt;
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)&lt;br/&gt;
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)&lt;br/&gt;
	at org.junit.runners.ParentRunner.run(ParentRunner.java:236)&lt;br/&gt;
	at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:62)&lt;br/&gt;
	at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.executeTestSet(AbstractDirectoryTestSuite.java:140)&lt;br/&gt;
	at org.apache.maven.surefire.suite.AbstractDirectoryTestSuite.execute(AbstractDirectoryTestSuite.java:127)&lt;br/&gt;
	at org.apache.maven.surefire.Surefire.run(Surefire.java:177)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
	at org.apache.maven.surefire.booter.SurefireBooter.runSuitesInProcess(SurefireBooter.java:345)&lt;br/&gt;
	at org.apache.maven.surefire.booter.SurefireBooter.main(SurefireBooter.java:1009)&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.openjpa.datacache.DataCacheStoreManager.newPCData(DataCacheStoreManager.java:670)&lt;br/&gt;
	at org.apache.openjpa.datacache.DataCacheStoreManager.cacheStateManager(DataCacheStoreManager.java:374)&lt;br/&gt;
	at org.apache.openjpa.datacache.DataCacheStoreManager.initialize(DataCacheStoreManager.java:353)&lt;br/&gt;
	at org.apache.openjpa.kernel.DelegatingStoreManager.initialize(DelegatingStoreManager.java:112)&lt;br/&gt;
	at org.apache.openjpa.kernel.ROPStoreManager.initialize(ROPStoreManager.java:57)&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.initialize(BrokerImpl.java:1005)&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.find(BrokerImpl.java:963)&lt;br/&gt;
	... 32 more&lt;/p&gt;</description>
                <environment>OpenJPA 2.0.0&lt;br/&gt;
PostgreSQL 8.4&lt;br/&gt;
Application managed env</environment>
        <key id="12480408">OPENJPA-1892</key>
            <summary>NullPointerException thrown by the BrokerImpl.find() if requesting an entity which is marked by the @Cacheable(false) annotation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="curtisr7">Rick Curtis</assignee>
                                    <reporter username="jwrap">Nik Maximov</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Nov 2010 09:09:47 +0000</created>
                <updated>Fri, 19 Nov 2010 19:52:19 +0000</updated>
                            <resolved>Fri, 19 Nov 2010 19:52:19 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>2.1.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>datacache</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12933741" author="jwrap" created="Fri, 19 Nov 2010 09:14:32 +0000"  >&lt;p&gt;The test case attached.&lt;br/&gt;
NOTE: In case if parent entity also marked as non-cacheable all works.&lt;/p&gt;</comment>
                            <comment id="12933937" author="curtisr7" created="Fri, 19 Nov 2010 19:52:18 +0000"  >&lt;p&gt;Committed a test and code change to trunk.&lt;/p&gt;

&lt;p&gt;@see revision 1036988.&lt;/p&gt;

&lt;p&gt;Rick&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12459988" name="jpa-cache.zip" size="6303" author="jwrap" created="Fri, 19 Nov 2010 09:14:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 19 Nov 2010 19:52:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>162121</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyso1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>201244</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>