<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:40:30 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-315/OPENJPA-315.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-315] Unenhanced generated id field of a primitive wrapper type causes NPE</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-315</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Unenhanced generated id field of a primitive wrapper type causes NPE because the field value is null.  This bug only occurs when the id field is an object type as primitive fields are automatically initialized to 0.  I believe this is a critical bug because when using a primitive field the system appears to work but the id field is always 0 which could cause data corruption.  The following stack trace shows the bug:&lt;/p&gt;

&lt;p&gt;&amp;lt;openjpa-0.0.0-r420667:564688M nonfatal general error&amp;gt; org.apache.openjpa.persistence.PersistenceException: null&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.persist(BrokerImpl.java:2437)&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.persist(BrokerImpl.java:2251)&lt;br/&gt;
	at org.apache.openjpa.kernel.DelegatingBroker.persist(DelegatingBroker.java:1010)&lt;br/&gt;
	at org.apache.openjpa.persistence.EntityManagerImpl.persist(EntityManagerImpl.java:541)&lt;br/&gt;
	at org.apache.openjpa.enhance.AbstractUnenhancedClassTest.getObjectIdHelper(AbstractUnenhancedClassTest.java:134)&lt;br/&gt;
	at org.apache.openjpa.enhance.AbstractUnenhancedClassTest.testGetObjectIdOnOpenJPAType(AbstractUnenhancedClassTest.java:115)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:40)&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.openjpa.util.ApplicationIds.fromPKValues(ApplicationIds.java:152)&lt;br/&gt;
	at org.apache.openjpa.enhance.ReflectingPersistenceCapable.pcNewObjectIdInstance(ReflectingPersistenceCapable.java:257)&lt;br/&gt;
	at org.apache.openjpa.util.ApplicationIds.create(ApplicationIds.java:384)&lt;br/&gt;
	at org.apache.openjpa.kernel.BrokerImpl.persist(BrokerImpl.java:2405)&lt;br/&gt;
	... 23 more&lt;/p&gt;

&lt;p&gt;The attached patch reproduces this bug.  The patch is a clone of TestUnenhancedFieldAccess that simply changes the id field to type Integer. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12375994">OPENJPA-315</key>
            <summary>Unenhanced generated id field of a primitive wrapper type causes NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dain">Dain Sundstrom</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Aug 2007 20:04:10 +0100</created>
                <updated>Tue, 9 Mar 2010 18:32:37 +0000</updated>
                            <resolved>Wed, 29 Aug 2007 02:26:28 +0100</resolved>
                                                    <fixVersion>1.0.0</fixVersion>
                                    <component>UnenhancedClasses</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12519747" author="dain" created="Tue, 14 Aug 2007 20:07:10 +0100"  >&lt;p&gt;This patch has overrides for all the failing tests that do nothing.  These empty overrides must be removed to reproduce the bug.&lt;/p&gt;</comment>
                            <comment id="12521271" author="pcl" created="Tue, 21 Aug 2007 00:14:35 +0100"  >&lt;p&gt;&amp;gt; I believe this is a critical bug because when using a primitive&lt;br/&gt;
&amp;gt; field the system appears to work but the id field is always 0&lt;br/&gt;
&amp;gt; which could cause data corruption.&lt;/p&gt;

&lt;p&gt;I don&apos;t follow &amp;#8211; are you saying that you are seeing a data corruption problem?&lt;/p&gt;

&lt;p&gt;Note that OpenJPA will not assign an ID field until it needs to, so you should call flush() or em.getObjectId() before checking to see if an ID field has been provided.&lt;/p&gt;</comment>
                            <comment id="12521274" author="pcl" created="Tue, 21 Aug 2007 00:20:05 +0100"  >&lt;p&gt;Marking as resolved under the assumption that the IDs are properly assigned as tested elsewhere.&lt;/p&gt;</comment>
                            <comment id="12523260" author="dain" created="Tue, 28 Aug 2007 16:32:24 +0100"  >&lt;p&gt;&amp;gt; I don&apos;t follow &amp;#8211; are you saying that you are seeing a data corruption problem? &lt;/p&gt;

&lt;p&gt;No.  I said &quot;could cause data corruption&quot;.   Any improperly loaded field in a bean could cause data corruption simply because the data isn&apos;t 100% normalized.  For example, someone could make a calculation using the primary key, which was improperly set to 0, and then store that calculation in another bean.&lt;/p&gt;

&lt;p&gt;&amp;gt; Note that OpenJPA will not assign an ID field until it needs to, so you should call flush() or em.getObjectId() before checking to &amp;gt; see if an ID field has been provided.&lt;/p&gt;

&lt;p&gt;Please review and apply this test.  You may have already fixed the bug when fixing the other issues I committed, but I believe this is the only test for this specific issue.   If you have already added another test for this bug, that is fine also but should be noted in this bug report for completeness.&lt;/p&gt;</comment>
                            <comment id="12523286" author="pcl" created="Tue, 28 Aug 2007 18:26:32 +0100"  >&lt;p&gt;&amp;gt; Please review and apply this test. &lt;/p&gt;

&lt;p&gt;What is &quot;this test&quot;? Are you referring to the patch associated with this issue? If so, how do the changes in &lt;a href=&quot;http://svn.apache.org/viewcvs?view=rev&amp;amp;rev=567875&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs?view=rev&amp;amp;rev=567875&lt;/a&gt; not resolve this issue? Note that if you hit the &apos;subversion commits&apos; tab (or the &apos;all&apos; tab) in the comments section, you&apos;ll see all commits associated with a particular JIRA issue.&lt;/p&gt;

&lt;p&gt;Also, from a process standpoint, it&apos;s fine to create test case patches that will cause the build to fail when they are applied; presumably, the person who grabs the patch and applies it expects to use the test case to validate that a fix works.&lt;/p&gt;</comment>
                            <comment id="12523427" author="dain" created="Wed, 29 Aug 2007 02:26:09 +0100"  >&lt;p&gt;Sorry.  I was responding to your comment &quot;Marking as resolved under the assumption that the IDs are properly assigned as tested elsewhere&quot;, which to me implied that you assumed there was already a test for this bug so my patch wasn&apos;t necessary.  Again, sorry.&lt;/p&gt;</comment>
                            <comment id="12523428" author="dain" created="Wed, 29 Aug 2007 02:26:28 +0100"  >&lt;p&gt;Issue has been resolved and a test has been added&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12376009">OPENEJB-628</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12363796" name="OPENJPA-315.patch" size="9826" author="dain" created="Tue, 14 Aug 2007 20:07:09 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 20 Aug 2007 23:14:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160641</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hysqm7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>201660</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>