<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:37:41 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-600/OPENJPA-600.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-600] java.lang.NoClassDefFoundError is thrown when using JRocket and application-provided OpenJPA jars</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-600</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;Customers want to use a version of OpenJPA in their applications other than the version bundled with WebLogic. It enables customers to use an upgraded version of OpenJPA than is shipped with the product. &lt;/p&gt;

&lt;p&gt;The customer&apos;s application would have openjpa.jar and kodo.jar in its lib or APP-INF/lib directory, and use the filtering classloader to filter out org.apache.openjpa.&lt;b&gt;, com.solarmetric.&lt;/b&gt; and kodo.*.&lt;/p&gt;

&lt;p&gt;When I deploy a sample application with embedded openjpa.jar to weblogic server, the following exception is thrown during deployment:&lt;/p&gt;

&lt;p&gt;java.lang.NoClassDefFoundError: org/apache/openjpa/enhance/PCEnhancer&lt;br/&gt;
	at org.apache.openjpa.enhance.PCClassFileTransformer.transform(PCClassFileTransformer.java:127)&lt;br/&gt;
	at org.apache.openjpa.persistence.PersistenceProviderImpl$ClassTransformerImpl.transform(PersistenceProviderImpl.java:201)&lt;br/&gt;
	at weblogic.deployment.PersistenceUnitInfoImpl$ClassPreProcessorImpl.preProcess(PersistenceUnitInfoImpl.java:490)&lt;br/&gt;
	at weblogic.utils.classloaders.ClassPreProcessor$ClassPreProcessorSupport.preProcess(ClassPreProcessor.java:95)&lt;br/&gt;
	at weblogic.utils.classloaders.GenericClassLoader.doPreProcess(GenericClassLoader.java:351)&lt;br/&gt;
	at weblogic.utils.classloaders.GenericClassLoader.defineClass(GenericClassLoader.java:332)&lt;br/&gt;
	at weblogic.utils.classloaders.GenericClassLoader.findLocalClass(GenericClassLoader.java:291)&lt;br/&gt;
	at weblogic.utils.classloaders.GenericClassLoader.findClass(GenericClassLoader.java:259)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:306)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:251)&lt;br/&gt;
	at weblogic.utils.classloaders.GenericClassLoader.loadClass(GenericClassLoader.java:179)&lt;br/&gt;
	at java.lang.Class.getDeclaredMethods0(Native Method)&lt;br/&gt;
	at java.lang.Class.privateGetDeclaredMethods(Class.java:2427)&lt;br/&gt;
	at java.lang.Class.privateGetPublicMethods(Class.java:2547)&lt;br/&gt;
	at java.lang.Class.getMethods(Class.java:1410)&lt;br/&gt;
	at weblogic.ejb.container.ejbc.VersionHelperImpl.computeCRC(VersionHelperImpl.java:350)&lt;br/&gt;
	at weblogic.ejb.container.ejbc.VersionHelperImpl.makeFileHash(VersionHelperImpl.java:268)&lt;br/&gt;
	at weblogic.ejb.container.ejbc.VersionHelperImpl.&amp;lt;init&amp;gt;(VersionHelperImpl.java:78)&lt;br/&gt;
	at weblogic.ejb.container.deployer.EJBDeployer.compileIfNecessary(EJBDeployer.java:521)&lt;br/&gt;
	at weblogic.ejb.container.deployer.EJBDeployer.prepare(EJBDeployer.java:1154)&lt;br/&gt;
	at weblogic.ejb.container.deployer.EJBModule.prepare(EJBModule.java:400)&lt;br/&gt;
	at weblogic.application.internal.flow.ModuleListenerInvoker.prepare(ModuleListenerInvoker.java:93)&lt;br/&gt;
	at weblogic.application.internal.flow.DeploymentCallbackFlow$1.next(DeploymentCallbackFlow.java:385)&lt;br/&gt;
	at weblogic.application.utils.StateMachineDriver$ParallelChange$1.run(StateMachineDriver.java:71)&lt;br/&gt;
	at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)&lt;br/&gt;
	at weblogic.security.service.SecurityManager.runAs(Unknown Source)&lt;br/&gt;
	at weblogic.application.utils.StateMachineDriver$ParallelChange.run(StateMachineDriver.java:79)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;

&lt;p&gt;Note this error happens in pure-JIT JVM such as JRocket only, not with the interpreting JVMs (for instance HotSpot).&lt;/p&gt;

&lt;p&gt;The error is because the tranformer plugin in openjpa makes a faulty assumption (which happens to work on interpreters), that types can be &lt;br/&gt;
resolved during execution of a method. Read up on the VM/lanf spec, it clearly states that you may not make such an assumption. Thus, while it might work with the reference, the preprocessor is quite broken.&lt;/p&gt;</description>
                <environment>Runtime enhancement in combination with a pure-JIT JVM such as JRocket</environment>
        <key id="12395963">OPENJPA-600</key>
            <summary>java.lang.NoClassDefFoundError is thrown when using JRocket and application-provided OpenJPA jars</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jasonzheng1970">Jason Zheng</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 May 2008 19:43:26 +0100</created>
                <updated>Tue, 13 May 2008 19:57:58 +0100</updated>
                                            <version>1.1.0</version>
                                                    <component>kernel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12596491" author="jasonzheng1970" created="Tue, 13 May 2008 19:48:50 +0100"  >&lt;p&gt;The error is because the tranformer plugin in openjpa makes a faulty assumption (which happens to work on interpreters), that types can be resolved during execution of a method. Read up on the VM/lanf spec, it clearly states that you may not make such an assumption. Thus, while it might work with the reference, the preprocessor is quite broken.&lt;/p&gt;

&lt;p&gt;We have to split the transform method into two methods to avoid ClassCircularityError (which is swallowed and rethrown as NoClassDefFoundError) when compiling of this method using pure-JIT JVM  such as JRockit.&lt;/p&gt;
</comment>
                            <comment id="12596498" author="jasonzheng1970" created="Tue, 13 May 2008 19:57:58 +0100"  >&lt;p&gt;The patch, &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-600&quot; title=&quot;java.lang.NoClassDefFoundError is thrown when using JRocket and application-provided OpenJPA jars&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-600&quot;&gt;OPENJPA-600&lt;/a&gt;.txt,  is based on:&lt;/p&gt;

&lt;p&gt;OpenJPA 1.1.0-SNAPSHOT&lt;br/&gt;
version id: openjpa-1.1.0-SNAPSHOT-r422266:653176M&lt;/p&gt;

&lt;p&gt;Jason&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12381977" name="OPENJPA-600.txt" size="1231" author="jasonzheng1970" created="Tue, 13 May 2008 19:48:50 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160916</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7l2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>288383</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>