<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:34:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-2229/OPENJPA-2229.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-2229] Persistence entities not recognized when deploying on JBoss AS 7.1</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-2229</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;I&apos;ve found this guide &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; about using OenJPA 2.2.0 and JBoss 7.1: I had some minor issues (already reported on that page) easily solved, but then I came to this exception, thrown at every JPA query:&lt;/p&gt;

&lt;p&gt;&amp;lt;openjpa-2.2.0-r422266:1244990 nonfatal user error&amp;gt; org.apache.openjpa.persistence.ArgumentException: An error occurred while parsing the query filter &quot;SELECT e FROM  ExternalResource e&quot;. Error message: The name &quot;ExternalResource&quot; is not a recognized entity or identifier. Perhaps you meant ExternalResource, which is a close match. Known entity names: &lt;span class=&quot;error&quot;&gt;&amp;#91;ExternalResource, AbstractSchema, RAttrUniqueValue, AbstractVirAttr, Membership, TaskExec, SyncopeConf, Report, RAttr, AbstractExec, SyncopeLogger, USchema, MAttr, PasswordPolicy, RSchema, MSchema, MAttrValue, MAttrUniqueValue, AbstractAttr, AbstractDerSchema, AbstractVirSchema, UAttr, AccountPolicy, RAttrValue, UAttrValue, ReportExec, SyncopeUser, Notification, ConnInstance, AbstractDerAttr, AbstractAttrValue, SyncopeRole, SyncPolicy, Policy, ReportletConfInstance, Task, UAttrUniqueValue, Entitlement, SchemaMapping, UserRequest&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.openjpa.kernel.exps.AbstractExpressionBuilder.parseException(AbstractExpressionBuilder.java:119) &lt;span class=&quot;error&quot;&gt;&amp;#91;openjpa-kernel-2.2.0.jar:2.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getClassMetaData(JPQLExpressionBuilder.java:194) &lt;span class=&quot;error&quot;&gt;&amp;#91;openjpa-kernel-2.2.0.jar:2.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.resolveClassMetaData(JPQLExpressionBuilder.java:167) &lt;span class=&quot;error&quot;&gt;&amp;#91;openjpa-kernel-2.2.0.jar:2.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getCandidateMetaData(JPQLExpressionBuilder.java:242) &lt;span class=&quot;error&quot;&gt;&amp;#91;openjpa-kernel-2.2.0.jar:2.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getCandidateMetaData(JPQLExpressionBuilder.java:212) &lt;span class=&quot;error&quot;&gt;&amp;#91;openjpa-kernel-2.2.0.jar:2.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.getCandidateType(JPQLExpressionBuilder.java:205) &lt;span class=&quot;error&quot;&gt;&amp;#91;openjpa-kernel-2.2.0.jar:2.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder.access$200(JPQLExpressionBuilder.java:80) &lt;span class=&quot;error&quot;&gt;&amp;#91;openjpa-kernel-2.2.0.jar:2.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.openjpa.kernel.jpql.JPQLExpressionBuilder$ParsedJPQL.populate(JPQLExpressionBuilder.java:2417) &lt;span class=&quot;error&quot;&gt;&amp;#91;openjpa-kernel-2.2.0.jar:2.2.0&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.openjpa.kernel.jpql.JPQLParser.populate(JPQLParser.java:61) &lt;span class=&quot;error&quot;&gt;&amp;#91;openjpa-kernel-2.2.0.jar:2.2.0&amp;#93;&lt;/span&gt;&lt;/p&gt;


&lt;p&gt;After some deeper investigation, I&apos;ve found that the problem resides in the vfs: JBoss URLs, currently not managed.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://community.jboss.org/thread/201329&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://community.jboss.org/thread/201329&lt;/a&gt; &lt;/p&gt;</description>
                <environment>JBoss AS 7.1.1-Final</environment>
        <key id="12598564">OPENJPA-2229</key>
            <summary>Persistence entities not recognized when deploying on JBoss AS 7.1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="curtisr7">Rick Curtis</assignee>
                                    <reporter username="ilgrosso">Francesco Chicchiricc&#242;</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Jul 2012 15:19:25 +0100</created>
                <updated>Mon, 1 Oct 2012 18:07:23 +0100</updated>
                            <resolved>Fri, 3 Aug 2012 16:20:49 +0100</resolved>
                                    <version>2.2.0</version>
                    <version>2.2.1</version>
                    <version>2.3.0</version>
                                    <fixVersion>2.3.0</fixVersion>
                                    <component>kernel</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13412828" author="ilgrosso" created="Thu, 12 Jul 2012 15:22:00 +0100"  >&lt;p&gt;This patch makes AbstractCFMetaDataFactory handle vfs: URLs.&lt;/p&gt;

&lt;p&gt;Since the JBoss library for managing such URLs is LGPL, I&apos;ve preferred to implement these calls using Java reflections in order to avoid pushing any additional dependency.&lt;/p&gt;

&lt;p&gt;I&apos;ve tested this patch by deploying Apache Syncope on JBoss AS 7.1.1.Final and found no issues.&lt;/p&gt;</comment>
                            <comment id="13412860" author="curtisr7" created="Thu, 12 Jul 2012 16:05:30 +0100"  >&lt;p&gt;Francesco -&lt;/p&gt;

&lt;p&gt;Your patch looks pretty good... I think a few small modifications will be required, but I should be able to handle those. I&apos;ll try to get around to committing this patch to trunk late today or early tomorrow.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Rick&lt;/p&gt;</comment>
                            <comment id="13412867" author="ilgrosso" created="Thu, 12 Jul 2012 16:13:31 +0100"  >&lt;p&gt;Hi Rick,&lt;br/&gt;
this sounds very nice!&lt;/p&gt;

&lt;p&gt;Once you&apos;ll apply the patch and commit, will the updated Maven artifacts be published immediately? I&apos;d love to be able to have it with 2.2.1-SNAPSHOT &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="13412922" author="struberg" created="Thu, 12 Jul 2012 17:42:25 +0100"  >&lt;p&gt;Hi!&lt;/p&gt;

&lt;p&gt;This is only ONE of n known problems with URL.&lt;/p&gt;

&lt;p&gt;The problem is most times that URL.toExternalForm() and new URL() are not commutative. There is a long thread over at commons for classpath scanning. The problem with the JBoss VFS is a well known issue not only for JPA but other frameworks. There is not only vfs:// but e.g. wsjar:// and tons of other possible URLs. You can read more about this in this thread: &lt;br/&gt;
&lt;a href=&quot;http://apache-commons.680414.n4.nabble.com/classscan-new-URL-xxx-and-it-s-problems-td4634723.html#a4634734&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://apache-commons.680414.n4.nabble.com/classscan-new-URL-xxx-and-it-s-problems-td4634723.html#a4634734&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The only way to solve this right is a plugable archive mechanism like proposed and implemented by David Blevins in xbean-finder.&lt;/p&gt;</comment>
                            <comment id="13413063" author="ilgrosso" created="Thu, 12 Jul 2012 19:48:45 +0100"  >&lt;p&gt;Mark,&lt;br/&gt;
for the (little) extent of my knowledge of OpenJPA internals, I agree with you: the attached patch is definitely not the ending solution for URL handling issues; anyway, it could be a temporary fix that allows to cover some more use cases.&lt;br/&gt;
This, of course, to be refactored as soon as the new URL scanning mechanism will be in place.&lt;br/&gt;
WDYT?&lt;/p&gt;</comment>
                            <comment id="13413602" author="struberg" created="Fri, 13 Jul 2012 10:25:51 +0100"  >&lt;p&gt;perfectly fine. I just wanted to raise the awareness that this might hit us in other situations as well. Not only with other url prefixes, but also in other locations in the OpenJPA codebase. It would be perfect if we can move this to a common helper class somehow.&lt;/p&gt;</comment>
                            <comment id="13414460" author="curtisr7" created="Sat, 14 Jul 2012 18:19:59 +0100"  >&lt;p&gt;Francesco -&lt;/p&gt;

&lt;p&gt;Since I have zero JBoss experience I committed your patch some some minor modifications to trunk without new tests. Please verify the patch works as expected when you get a chance.&lt;/p&gt;

&lt;p&gt;&amp;gt; It would be perfect if we can move this to a common helper class somehow. &lt;br/&gt;
Agreed, but I don&apos;t see that happening until someone really screams and ponies up some cycles.&lt;/p&gt;</comment>
                            <comment id="13414582" author="ilgrosso" created="Sun, 15 Jul 2012 08:06:24 +0100"  >&lt;p&gt;Hi Rick,&lt;br/&gt;
I&apos;ve taken a look at the code modification on trunk: did not think to that AccessController.doPrivileged()!&lt;/p&gt;

&lt;p&gt;I made my patch against 2.2.x branch because my application (Apache Syncope) is based on 2.2.0: I&apos;ve tried to quickly test Syncope on JBoss with 2.3.0-SNAPSHOT artifacts (after a fresh &apos;mvn clean install&apos; from updated OpenJPA trunk source tree), unfortunately with no luck.&lt;/p&gt;

&lt;p&gt;Then I backported the AbstractCFMetaDataFactory class from trunk to branch 2.2.x, did another &apos;mvn clean install&apos;, then switch Syncope POMs to 2.2.1-SNAPSHOT: it worked.&lt;/p&gt;

&lt;p&gt;Baseline: the applied patch is working, but I am not (currently) able to test it with trunk (2.3.0-SNAPSHOT).&lt;/p&gt;</comment>
                            <comment id="13428178" author="curtisr7" created="Fri, 3 Aug 2012 16:20:49 +0100"  >&lt;p&gt;Committed revision 1361564 to trunk.&lt;/p&gt;</comment>
                            <comment id="13466948" author="jpaheath" created="Mon, 1 Oct 2012 18:07:23 +0100"  >&lt;p&gt;HI!  Please note that part of this fix (Revision 1369042) was incorrectly listed under JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2229&quot; title=&quot;Persistence entities not recognized when deploying on JBoss AS 7.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2229&quot;&gt;&lt;del&gt;OPENJPA-2229&lt;/del&gt;&lt;/a&gt;.....the commit was meant for JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2247&quot; title=&quot;JoinColumn annotation is ignored when mapping a unidirectional owned OneToOne that is in a SecondaryTable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2247&quot;&gt;&lt;del&gt;OPENJPA-2247&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Heath&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12598573">SYNCOPE-109</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12536225" name="jboss-vfs.patch" size="3111" author="ilgrosso" created="Thu, 12 Jul 2012 15:22:00 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 12 Jul 2012 15:05:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240137</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxus3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3370</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>