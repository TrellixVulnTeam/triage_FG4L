<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:39:09 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/OPENJPA-2285/OPENJPA-2285.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[OPENJPA-2285] L2 cache doesn&apos;t store FK(s) back into the cache when lazy loading data.</title>
                <link>https://issues.apache.org/jira/browse/OPENJPA-2285</link>
                <project id="12310351" key="OPENJPA">OpenJPA</project>
                    <description>&lt;p&gt;I ran into a performance bug recently where we aren&apos;t caching data, but we could be. The data that we aren&apos;t caching is when lazy loading an unowned relationship .&lt;/p&gt;

&lt;p&gt;For instance, if we have the model Person &amp;lt;-&amp;gt; Address(LAZY, owner) and we find Person, that data will get stored in the cache. Since Address owns the relationship, we don&apos;t have the FK to cache(yet). Later we go to lazily load the address and we need to issue a joined query to find the Address which corresponds to our Person. Once that data has been loaded, we don&apos;t store the FK back into the cache.&lt;/p&gt;

&lt;p&gt;With this JIRA I&apos;m going to introduce a change that will make our runtime re-cache the Person data when additional data is loaded.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12613540">OPENJPA-2285</key>
            <summary>L2 cache doesn&apos;t store FK(s) back into the cache when lazy loading data.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="curtisr7">Rick Curtis</assignee>
                                    <reporter username="curtisr7">Rick Curtis</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Oct 2012 20:09:53 +0100</created>
                <updated>Sun, 5 Apr 2015 17:16:53 +0100</updated>
                                            <version>2.0.1</version>
                    <version>2.1.1</version>
                    <version>2.2.0</version>
                    <version>2.3.0</version>
                    <version>2.4.0</version>
                                                    <component>datacache</component>
                    <component>performance</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13485184" author="curtisr7" created="Fri, 26 Oct 2012 21:39:50 +0100"  >&lt;p&gt;Committed revision 1402635 to trunk.&lt;/p&gt;</comment>
                            <comment id="13493222" author="curtisr7" created="Thu, 8 Nov 2012 14:32:41 +0000"  >&lt;p&gt;Merged changes back to 2.2.x.&lt;/p&gt;</comment>
                            <comment id="13497474" author="curtisr7" created="Wed, 14 Nov 2012 21:31:02 +0000"  >&lt;p&gt;This code fix introduced a regression where we would put invalid data in the cache and resulted in the ClassCastException while loading data in a subsequent request. This is very much an edge case as you needed to be executing a query which returned an Embeddable which had an eager relationship to another Entity which then referred back to the embedding Entity. @See the added ut/ Entity model for details.&lt;/p&gt;

&lt;p&gt;Committing a code fix + new UT for this scenario to trunk and 2.2.x.&lt;/p&gt;</comment>
                            <comment id="13593448" author="curtisr7" created="Tue, 5 Mar 2013 14:52:16 +0000"  >&lt;p&gt;An internal test regression was attributed to the change in this JIRA. The problem is that when CacheStoreMode.USE (default) is set, data should NOT be stored back into the cache. I&apos;ll update the JIRA with more details soon here.&lt;/p&gt;</comment>
                            <comment id="13598922" author="jira-bot" created="Mon, 11 Mar 2013 16:01:43 +0000"  >&lt;p&gt;Commit 1455204 from curtisr7&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1455204&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1455204&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2285&quot; title=&quot;L2 cache doesn&amp;#39;t store FK(s) back into the cache when lazy loading data.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2285&quot;&gt;OPENJPA-2285&lt;/a&gt;: Revert prior changes.&lt;/p&gt;</comment>
                            <comment id="13598924" author="jira-bot" created="Mon, 11 Mar 2013 16:03:49 +0000"  >&lt;p&gt;Commit 1455205 from curtisr7&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1455205&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1455205&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2285&quot; title=&quot;L2 cache doesn&amp;#39;t store FK(s) back into the cache when lazy loading data.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2285&quot;&gt;OPENJPA-2285&lt;/a&gt; : Revert previous changes to 2.2.x.&lt;/p&gt;</comment>
                            <comment id="13598925" author="curtisr7" created="Mon, 11 Mar 2013 16:05:37 +0000"  >&lt;p&gt;Reverted changes from 2.2.x and trunk. Closing as invalid.&lt;/p&gt;</comment>
                            <comment id="13901612" author="curtisr7" created="Fri, 14 Feb 2014 16:43:43 +0000"  >&lt;p&gt;Attaching a testcase that is similar to the &apos;internal test&apos; that was failing.&lt;/p&gt;</comment>
                            <comment id="13906385" author="jira-bot" created="Thu, 20 Feb 2014 00:38:31 +0000"  >&lt;p&gt;Commit 1570016 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=curtisr7&quot; class=&quot;user-hover&quot; rel=&quot;curtisr7&quot;&gt;Rick Curtis&lt;/a&gt; in branch &apos;openjpa/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1570016&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1570016&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/OPENJPA-2285&quot; title=&quot;L2 cache doesn&amp;#39;t store FK(s) back into the cache when lazy loading data.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;OPENJPA-2285&quot;&gt;OPENJPA-2285&lt;/a&gt;: Recommitted DataCacheStoreManager improvement.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12734123">OPENJPA-2524</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12629052" name="OPENJPA-2285.test.patch" size="4662" author="curtisr7" created="Fri, 14 Feb 2014 16:43:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 11 Mar 2013 16:01:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>251087</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4yn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62773</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>