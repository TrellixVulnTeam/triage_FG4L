<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:41:44 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-850/ZOOKEEPER-850.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-850] Switch from log4j to slf4j</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-850</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;i would like to see slf4j integrated into the zookeeper instead of relying explicitly on log4j.&lt;/p&gt;

&lt;p&gt;slf4j is an abstract logging framework. There are adapters from slf4j to many logger implementations, one of them is log4j.&lt;/p&gt;

&lt;p&gt;The decision which log engine to use i dont like to make so early.&lt;/p&gt;

&lt;p&gt;This would help me to embed zookeeper in my own applications (which use a different logger implemenation, but slf4j is the basis)&lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;

&lt;p&gt;(as i can see, those slf4j request flood all other projects on apache as well &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Maybe for 3.4 or 4.0?&lt;/p&gt;

&lt;p&gt;I can offer a patchset, i have experience in such an migration already. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12471687">ZOOKEEPER-850</key>
            <summary>Switch from log4j to slf4j</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="public@ecopatz.de">Olaf Krische</assignee>
                                    <reporter username="public@ecopatz.de">Olaf Krische</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Aug 2010 13:49:18 +0100</created>
                <updated>Tue, 10 Sep 2013 21:10:16 +0100</updated>
                            <resolved>Tue, 24 Jan 2012 00:25:01 +0000</resolved>
                                    <version>3.3.1</version>
                                    <fixVersion>3.4.0</fixVersion>
                                    <component>java client</component>
                        <due></due>
                            <votes>10</votes>
                                    <watches>11</watches>
                                                                                                            <comments>
                            <comment id="12898979" author="phunt" created="Mon, 16 Aug 2010 17:31:23 +0100"  >&lt;p&gt;I think it&apos;s reasonable, is it fully backward compatible? What are the implications/impact for end users (ie what will they have to change, will they see any changes in their output, etc...)?&lt;/p&gt;

&lt;p&gt;If you submit a patch we&apos;d be able to evaluate better (try it out ourselves), feel free.&lt;/p&gt;</comment>
                            <comment id="12901518" author="public@ecopatz.de" created="Mon, 23 Aug 2010 19:13:40 +0100"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;if you still use the log4j logger at runtime, then it should have no impact on the logging output, since those definitions in log4j.properties for log4j remain valid.&lt;/p&gt;

&lt;p&gt;1) &lt;/p&gt;

&lt;p&gt;Add &quot;slf4j-api-1.5.10.jar&quot;, its the API for slf4j&lt;/p&gt;

&lt;p&gt;2) &lt;/p&gt;

&lt;p&gt;For $clazz, replace:&lt;/p&gt;

&lt;p&gt;  final static org.apache.log4j.Logger = org.apache.log4j.Logger.getLogger($clazz);&lt;/p&gt;

&lt;p&gt;with&lt;/p&gt;

&lt;p&gt;  final static org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger($clazz);&lt;/p&gt;

&lt;p&gt;This must compile, then zookeeper is independend from log4j.&lt;/p&gt;

&lt;p&gt;3) &lt;/p&gt;

&lt;p&gt;For runtime, e.g. testing, decide which logger to use. For log4j, you would just add:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;slf4j-log4j12-1.5.10.jar, the adapter from slf4j to log4j&lt;/li&gt;
	&lt;li&gt;log4j-1.2.15.jar for log4j, which should already be defined in ant&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This would be all. &lt;/p&gt;

&lt;p&gt;(patchset is not so easy as i thought, since zookeeper use its very own file structure, i dont even get 3.3.1 with a normal ant compile to work) &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12926744" author="public@ecopatz.de" created="Sun, 31 Oct 2010 17:34:02 +0000"  >&lt;p&gt;So, in a way, i didnt change much. All what is required now is to have those two extra slf4j-jars in the classpath. Then it should run as always. Even if there is still a mistake, since log4j is still there, all should work as always.&lt;/p&gt;

&lt;p&gt;The &quot;org.apache.zookeeper.jmx.ManagedUtil&quot; has to go away. Why not as an extra utility in contrib? It manages log4j by jmx. So therefore it requires log4j. I didnt wanna do a structural change.&lt;/p&gt;

&lt;p&gt;You can remove &quot;log4j&quot; from ivy, then you will see the last dependencies, when building.&lt;/p&gt;

&lt;p&gt;ant test tar went thru without a problem.&lt;/p&gt;</comment>
                            <comment id="12926745" author="public@ecopatz.de" created="Sun, 31 Oct 2010 17:35:04 +0000"  >&lt;p&gt;the patch&lt;/p&gt;</comment>
                            <comment id="12927036" author="phunt" created="Mon, 1 Nov 2010 16:43:29 +0000"  >&lt;p&gt;Hi Olaf, thanks for the patch. A couple questions/comments:&lt;/p&gt;

&lt;p&gt;1) can you create this patch against trunk? We only put bug fixes into the fix releases, so this would be slated for 3.4.0 release (current trunk).&lt;/p&gt;

&lt;p&gt;2) do any of the shell scripts need to be updated? (bin directory)&lt;/p&gt;

&lt;p&gt;3) I see references to log4j in the build.xml file(s). Do any of these need to be upated? It would be good if you could build a release (ant tar) and verify that the built archive can run zk server/client via the bin scripts.&lt;/p&gt;

&lt;p&gt;4) It looks like the documentation also needs to be updated, do a &quot;egrep -Ri log4j src/docs/src/documentation/ log4j&quot; from the toplevel. We should at least update the existing docs, also it would be helpful to include addl information to help both users and developers make the switch.&lt;/p&gt;

&lt;p&gt;5) we typically create &quot;release notes&quot; for a release, it would be good to document in this JIRA (the rel notes section) any details we should include in the release notes documentation that goes along with the release. Some short statement detailing the change an any impact (you&apos;ve given some detail in the comments, basically wrapping it up into something short/simple for users to follow during upgrade).&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12927244" author="public@ecopatz.de" created="Tue, 2 Nov 2010 01:10:53 +0000"  >&lt;p&gt;Release-Notes: &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;replaces as far as possible the log4j with slf4j code (also in contrib for bookkeeper, zooinspector,rest,loggraph)&lt;/li&gt;
	&lt;li&gt;you must add slf4j-api-1.6.1jar and slf4j-log4j12-1.6.1 to the classpath!&lt;/li&gt;
	&lt;li&gt;log4j remains as the final logger, some code still depends directly on it (there is work to do...)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12927248" author="public@ecopatz.de" created="Tue, 2 Nov 2010 01:21:10 +0000"  >&lt;p&gt;@patrick&lt;/p&gt;

&lt;p&gt;1) done&lt;/p&gt;

&lt;p&gt;2) no&lt;/p&gt;

&lt;p&gt;3) i started zkServer/zkCli and it works with the bin scripts. &lt;/p&gt;

&lt;p&gt;About the build.xml files i am not really sure. For example, in ZooInspector it references an old zookeeper-3.3.0.jar. Broken anyways?&lt;/p&gt;

&lt;p&gt;Can someone look it up who is more familiar with the ant build system?&lt;/p&gt;

&lt;p&gt;4) i changed some of the &quot;xml&quot; files to reflect the change to slf4j. how to create the html files from it? they are not created when creating the tar.&lt;/p&gt;

&lt;p&gt;5) see the attachement&lt;/p&gt;
</comment>
                            <comment id="12930229" author="phunt" created="Tue, 9 Nov 2010 18:48:59 +0000"  >&lt;p&gt;fyi hbase&apos;s jira for similar change: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2608&quot; title=&quot;Switch to SLF4J&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2608&quot;&gt;&lt;del&gt;HBASE-2608&lt;/del&gt;&lt;/a&gt; (looks like this patch is proposing similar to 2 in hbase jira?)&lt;/p&gt;</comment>
                            <comment id="12930231" author="phunt" created="Tue, 9 Nov 2010 18:53:35 +0000"  >&lt;p&gt;Attaching Olaf&apos;s patch as raw patch file so that hudson can do it&apos;s magic.&lt;/p&gt;</comment>
                            <comment id="12930232" author="phunt" created="Tue, 9 Nov 2010 18:57:14 +0000"  >&lt;p&gt;Olaf, re 5 could you add similar comments to this JIRA in the &quot;release notes&quot; section? We&apos;ll need that when doing the release itself.&lt;/p&gt;</comment>
                            <comment id="12930267" author="hadoopqa" created="Tue, 9 Nov 2010 19:57:42 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12459170/ZOOKEEPER-850.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12459170/ZOOKEEPER-850.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1033155.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 249 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 1 new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/14//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/14//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/14//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/14//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/14//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/14//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12930432" author="hadoopqa" created="Wed, 10 Nov 2010 02:01:47 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12459170/ZOOKEEPER-850.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12459170/ZOOKEEPER-850.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1033155.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 249 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 1 new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/21//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/21//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/21//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/21//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/21//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/21//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12965915" author="michim" created="Wed, 1 Dec 2010 23:09:46 +0000"  >&lt;p&gt;The previous patch got broken after some checkins. I modified 2 files to fix compilation errors. &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;changed src/java/main/org/apache/zookeeper/server/quorum/LeaderElection.java to use LoggerFactory.getLogger().&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;changed fatal to error in src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;--Michi&lt;/p&gt;</comment>
                            <comment id="12965925" author="hadoopqa" created="Wed, 1 Dec 2010 23:32:42 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12465085/ZOOKEEPER-850.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12465085/ZOOKEEPER-850.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1040752.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 249 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 9 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/59//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/59//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/59//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/59//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/59//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/59//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12966326" author="michim" created="Thu, 2 Dec 2010 22:47:47 +0000"  >&lt;p&gt;I still see some references to log4j. I&apos;m not sure if they are expected. Olaf, could you comment?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;br/&gt;
--Michi&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; 
src/java/test/org/apache/zookeeper/test/ClientBase.java:import org.apache.log4j.Priority;
src/java/test/org/apache/zookeeper/test/ClientTest.java:import org.apache.log4j.Priority;
src/java/test/org/apache/zookeeper/test/CnxManagerTest.java.orig:import org.apache.log4j.Logger;
src/java/test/org/apache/zookeeper/server/quorum/QuorumPeerMainTest.java:import org.apache.log4j.Layout;
src/java/test/org/apache/zookeeper/server/quorum/QuorumPeerMainTest.java:import org.apache.log4j.Level;
src/java/test/org/apache/zookeeper/server/quorum/QuorumPeerMainTest.java:import org.apache.log4j.Logger;
src/java/test/org/apache/zookeeper/server/quorum/QuorumPeerMainTest.java:import org.apache.log4j.WriterAppender;
src/java/main/org/apache/zookeeper/jmx/ManagedUtil.java:import org.apache.log4j.LogManager;
src/java/main/org/apache/zookeeper/jmx/ManagedUtil.java:import org.apache.log4j.Logger;
src/java/main/org/apache/zookeeper/jmx/ManagedUtil.java:import org.apache.log4j.jmx.HierarchyDynamicMBean;
src/java/main/org/apache/zookeeper/jmx/ManagedUtil.java:import org.apache.log4j.spi.LoggerRepository;
src/java/main/org/apache/zookeeper/jmx/ManagedUtil.java:     * Register the log4j JMX mbeans. Set environment variable
src/java/main/org/apache/zookeeper/jmx/ManagedUtil.java:     * &quot;zookeeper.jmx.log4j.disable&quot; to true to disable registration.
src/java/main/org/apache/zookeeper/jmx/ManagedUtil.java:        if (Boolean.getBoolean(&quot;zookeeper.jmx.log4j.disable&quot;) == true) {
src/java/main/org/apache/zookeeper/jmx/ManagedUtil.java:        ObjectName mbo = new ObjectName(&quot;log4j:hiearchy=default&quot;);
src/java/main/org/apache/zookeeper/server/quorum/QuorumPeerConfig.java:import org.apache.log4j.MDC;
src/java/main/org/apache/zookeeper/server/quorum/QuorumPeerMain.java:          LOG.warn(&quot;Unable to register log4j JMX control&quot;, e);
src/java/main/org/apache/zookeeper/server/quorum/LeaderElection.java.orig:import org.apache.log4j.Logger;
src/java/main/org/apache/zookeeper/server/quorum/QuorumCnxManager.java.orig:import org.apache.log4j.Logger;
src/java/main/org/apache/zookeeper/server/ZooKeeperServerMain.java:            LOG.warn(&quot;Unable to register log4j JMX control&quot;, e);
src/java/main/org/apache/zookeeper/client/StaticHostProvider.java:import org.apache.log4j.Logger;
src/java/main/org/apache/zookeeper/ZooKeeper.java.orig:import org.apache.log4j.Logger;
src/java/main/org/apache/zookeeper/ClientCnxnSocket.java:import org.apache.log4j.Logger;
src/java/main/org/apache/zookeeper/ClientCnxnSocketNIO.java:import org.apache.log4j.Logger;
src/java/main/org/apache/zookeeper/ClientCnxn.java.orig:import org.apache.log4j.Logger;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="12966517" author="public@ecopatz.de" created="Fri, 3 Dec 2010 12:59:06 +0000"  >&lt;p&gt;Hello Michi,&lt;/p&gt;

&lt;p&gt;i have changed only the code, which uses log4j for logging.&lt;/p&gt;

&lt;p&gt;But  some classes do more than that, they use log4j priorities, they add appenders at runtime, they do log4j business stuff. This logic i did not want to remove. It would be consequent to do so, but i thought, someone more experienced with the zookeeper project should do that.&lt;/p&gt;

&lt;p&gt;I commented that on the patch, that its incomplete.&lt;/p&gt;

&lt;p&gt;Help appreciated.&lt;/p&gt;</comment>
                            <comment id="12968431" author="michim" created="Mon, 6 Dec 2010 21:59:20 +0000"  >&lt;p&gt;Thanks for the clarification, Olaf. &lt;/p&gt;

&lt;p&gt;This patch fixes the following files:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;src/java/test/org/apache/zookeeper/test/ClientBase.java
src/java/test/org/apache/zookeeper/test/ClientTest.java
src/java/main/org/apache/zookeeper/server/quorum/QuorumPeerConfig.java
src/java/main/org/apache/zookeeper/client/StaticHostProvider.java
src/java/main/org/apache/zookeeper/ClientCnxnSocket.java
src/java/main/org/apache/zookeeper/ClientCnxnSocketNIO.java
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I couldn&apos;t fix  ManagedUtil.java and QuorumPeerMainTest.java because it uses log4j specific features. What should we do about these files?&lt;/p&gt;

&lt;p&gt;--Michi&lt;/p&gt;</comment>
                            <comment id="12968452" author="hadoopqa" created="Mon, 6 Dec 2010 22:22:49 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12465621/ZOOKEEPER-850.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12465621/ZOOKEEPER-850.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1040752.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 249 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 9 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/61//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/61//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/61//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/61//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/61//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/61//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12968512" author="public@ecopatz.de" created="Tue, 7 Dec 2010 00:38:09 +0000"  >&lt;p&gt;@michi &lt;/p&gt;

&lt;p&gt;maven2 has its own test scope with its own dependency. so to select the &quot;final&quot; logger &quot;log4j&quot; in this test scope would cause no harm. can it be divided in ant projects as well? &lt;/p&gt;

&lt;p&gt;about managedutil, as far as i can see, it is jmx stuff. well, it should be moved to contrib or be deleted. everyone can write its own &quot;jmx&quot; handler for its &quot;final&quot; logging implementation, thats no biggie. just someone should made this decision.&lt;/p&gt;


</comment>
                            <comment id="12969084" author="phunt" created="Wed, 8 Dec 2010 00:08:51 +0000"  >&lt;p&gt;ManagedUtil - this is adding log4j mbeans into the jmx registry so that log4j itself can be configured/monitored via jmx&lt;/p&gt;

&lt;p&gt;There should be something similar for slf4j, no?&lt;/p&gt;

&lt;p&gt;QuorumPeerMainTest - this allows us to verify particular messages are indeed being logged. We should be able to do similar with slf4j. no?&lt;/p&gt;</comment>
                            <comment id="12969095" author="public@ecopatz.de" created="Wed, 8 Dec 2010 00:32:13 +0000"  >&lt;p&gt;@patrick&lt;/p&gt;

&lt;p&gt;there is no such for thing for slf4j. slf4j is just the logger interface, the api.&lt;/p&gt;

&lt;p&gt;you can configure the final logger by jmx, like log4j, sure. but which logger you use, this you can only know in your end project. as long as you are not &quot;there&quot;, you can not configure anything. it makes no sense, since you just do logging in your code. thats why ManagedUtil could go to contrib, its log4j specific jmx stuff.&lt;/p&gt;

&lt;p&gt;in &quot;tests&quot; you will also chose a final logger, like log4j, &quot;tests&quot; are a final project. but this dependency should only be visible in tests. zookeeper itself should not deliver with log4j dependencies anymore. &lt;/p&gt;

&lt;p&gt;is it possible in ANT scripts to have a special test scope with test specific dependencies?&lt;/p&gt;
</comment>
                            <comment id="12970062" author="mahadev" created="Fri, 10 Dec 2010 03:22:51 +0000"  >&lt;p&gt;olaf,&lt;br/&gt;
  I dont think it would be wise to depend on both sl4fj and log4j. I&apos;d really like us to move to sl4j (have heard a lot of good things abt it), but keeping a log4j  dependency  inthe project, just because we need it it one test and jmx would be weird. Neway we can get rid of log4j altogether? &lt;/p&gt;</comment>
                            <comment id="12970154" author="public@ecopatz.de" created="Fri, 10 Dec 2010 12:40:59 +0000"  >&lt;p&gt;i agree, totally. no log4j api access in the source code. still you need a logger impl in tests, like log4j.&lt;/p&gt;</comment>
                            <comment id="12970255" author="mahadev" created="Fri, 10 Dec 2010 18:26:31 +0000"  >&lt;p&gt;agreed. But we do have a code dependency on log4j in tests right? Do we want code dependency on log4j in tests? I am not an expert on loggin, so probably you&apos;d be a better judge of this. What do you think? &lt;/p&gt;</comment>
                            <comment id="12970290" author="public@ecopatz.de" created="Fri, 10 Dec 2010 19:37:13 +0000"  >&lt;p&gt;In tests i would not mind any log4j api access, as long as this test and the decision to use log4j as logger is not carried out as a dependency in the published jars. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</comment>
                            <comment id="12980158" author="mahadev" created="Tue, 11 Jan 2011 16:10:39 +0000"  >&lt;p&gt;+1 the patch looks good. I will go ahead and commit after +1 from hudson.&lt;/p&gt;</comment>
                            <comment id="12988957" author="hadoopqa" created="Mon, 31 Jan 2011 23:25:25 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12465621/ZOOKEEPER-850.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12465621/ZOOKEEPER-850.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1062244.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 249 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/105//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/105//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12994910" author="michi009" created="Tue, 15 Feb 2011 18:14:07 +0000"  >&lt;p&gt;Hi Olaf,&lt;/p&gt;

&lt;p&gt;The patch doesn&apos;t apply any more. Could you update the patch if you have time? If not, I&apos;ll take care of it.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;br/&gt;
--Michi&lt;/p&gt;</comment>
                            <comment id="12995551" author="janhoy" created="Wed, 16 Feb 2011 22:31:02 +0000"  >&lt;p&gt;When is this scheduled for commit? We&apos;re about to release a new Solr version which faces issues with the log4j dependency.&lt;/p&gt;</comment>
                            <comment id="12996725" author="hadoopqa" created="Sat, 19 Feb 2011 08:12:34 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12465621/ZOOKEEPER-850.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12465621/ZOOKEEPER-850.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1072085.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 249 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/149//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/149//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12999124" author="hadoopqa" created="Thu, 24 Feb 2011 23:41:08 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12465621/ZOOKEEPER-850.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12465621/ZOOKEEPER-850.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1072085.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 249 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/167//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/167//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12999168" author="public@ecopatz.de" created="Fri, 25 Feb 2011 01:01:31 +0000"  >&lt;p&gt;Michi, &lt;/p&gt;

&lt;p&gt;i am currently kind of flooded with other stuff. Maybe on a weekend i will try to create a new patch again.&lt;/p&gt;</comment>
                            <comment id="13000380" author="mahadev" created="Mon, 28 Feb 2011 16:31:41 +0000"  >&lt;p&gt;cancelling the patch for now.&lt;/p&gt;</comment>
                            <comment id="13003029" author="public@ecopatz.de" created="Sat, 5 Mar 2011 19:30:29 +0000"  >&lt;p&gt;updated patch&lt;/p&gt;</comment>
                            <comment id="13003030" author="public@ecopatz.de" created="Sat, 5 Mar 2011 19:32:06 +0000"  >&lt;p&gt;updated patch&lt;/p&gt;</comment>
                            <comment id="13003034" author="hadoopqa" created="Sat, 5 Mar 2011 20:04:01 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12472757/ZOOKEEPER-850.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12472757/ZOOKEEPER-850.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1074995.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 249 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 1 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/179//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/179//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/179//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/179//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/179//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/179//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13009358" author="michi009" created="Mon, 21 Mar 2011 20:35:31 +0000"  >&lt;p&gt;+1. &lt;/p&gt;

&lt;p&gt;There is one findbugs warning, but it&apos;s not this patch that introduced it.&lt;/p&gt;

&lt;p&gt;===&lt;br/&gt;
Exception is caught when Exception is not thrown in org.apache.zookeeper.server.quorum.QuorumPeer$ResponderThread.run()&lt;/p&gt;

&lt;p&gt;Bug type REC_CATCH_EXCEPTION (click for details)&lt;br/&gt;
In class org.apache.zookeeper.server.quorum.QuorumPeer$ResponderThread&lt;br/&gt;
In method org.apache.zookeeper.server.quorum.QuorumPeer$ResponderThread.run()&lt;br/&gt;
At QuorumPeer.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;line 310&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="13016171" author="john.wang@gmail.com" created="Wed, 6 Apr 2011 00:00:53 +0100"  >&lt;p&gt;This is becoming more urgent as oracle has removed com.sun.jmx and com.sun.jdmk packages from maven central... The reason it matters for this is because log4j 1.2.15 depends on those classes.&lt;/p&gt;

&lt;p&gt;So on a fresh build for zookeeper or any thing that depends on zookeeper via maven would not work...&lt;/p&gt;</comment>
                            <comment id="13017581" author="mahadev" created="Fri, 8 Apr 2011 19:23:07 +0100"  >&lt;p&gt;@John,&lt;br/&gt;
 Yup this definitely is a issue. What I usually do is the following in my pom files:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  &amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;org.apache.hadoop&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;zookeeper&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;3.3.1&amp;lt;/version&amp;gt;
      &amp;lt;scope&amp;gt;compile&amp;lt;/scope&amp;gt;
       &amp;lt;exclusions&amp;gt;
        &amp;lt;exclusion&amp;gt;
          &amp;lt;groupId&amp;gt;com.sun.jdmk&amp;lt;/groupId&amp;gt;
          &amp;lt;artifactId&amp;gt;jmxtools&amp;lt;/artifactId&amp;gt;
        &amp;lt;/exclusion&amp;gt;
        &amp;lt;exclusion&amp;gt;
          &amp;lt;groupId&amp;gt;com.sun.jmx&amp;lt;/groupId&amp;gt;
          &amp;lt;artifactId&amp;gt;jmxri&amp;lt;/artifactId&amp;gt;
        &amp;lt;/exclusion&amp;gt;
      &amp;lt;/exclusions&amp;gt;
    &amp;lt;/dependency&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This works for me but should obviously be fixed.&lt;/p&gt;</comment>
                            <comment id="13017767" author="phunt" created="Sat, 9 Apr 2011 01:00:34 +0100"  >&lt;p&gt;Is this one ready to go? We really should try to get this in, thanks for sticking with us Olaf!&lt;/p&gt;</comment>
                            <comment id="13017773" author="michim" created="Sat, 9 Apr 2011 01:05:52 +0100"  >&lt;p&gt;I think it&apos;s good to go. Mahadev and I +1ed it. &lt;/p&gt;

&lt;p&gt;--Michi&lt;/p&gt;</comment>
                            <comment id="13017782" author="phunt" created="Sat, 9 Apr 2011 01:37:38 +0100"  >&lt;p&gt;Michi &amp;#8211; In that case why don&apos;t you do the honors! (commit it to trunk)&lt;/p&gt;</comment>
                            <comment id="13017784" author="michim" created="Sat, 9 Apr 2011 01:40:29 +0100"  >&lt;p&gt;Ok, I&apos;ll give it a try. &lt;/p&gt;

&lt;p&gt;--Michi&lt;/p&gt;</comment>
                            <comment id="13017790" author="public@ecopatz.de" created="Sat, 9 Apr 2011 02:13:35 +0100"  >&lt;p&gt;A little more confidence here! If there is anything happening, it can be fixed. Thumbs up! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;(please do not forget the sub-task...)&lt;/p&gt;</comment>
                            <comment id="13018750" author="michim" created="Tue, 12 Apr 2011 08:15:49 +0100"  >&lt;p&gt;Checked into trunk.&lt;/p&gt;

&lt;p&gt;Olaf, thank you for the patch! &lt;br/&gt;
--Michi&lt;/p&gt;</comment>
                            <comment id="13018792" author="hudson" created="Tue, 12 Apr 2011 11:54:28 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #1151 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/ZooKeeper-trunk/1151/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/ZooKeeper-trunk/1151/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-850&quot; title=&quot;Switch from log4j to slf4j&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-850&quot;&gt;&lt;del&gt;ZOOKEEPER-850&lt;/del&gt;&lt;/a&gt;: Switch from log4j to slf4j (Olaf Krische via michim)&lt;/p&gt;</comment>
                            <comment id="13018834" author="public@ecopatz.de" created="Tue, 12 Apr 2011 14:42:30 +0100"  >&lt;p&gt;This task can not be closed yet, until subtask &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1010&quot; title=&quot;Remove or move ManagedUtil to contrib, because it has direct log4j dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1010&quot;&gt;&lt;del&gt;ZOOKEEPER-1010&lt;/del&gt;&lt;/a&gt; has been resolved. Otherwise it will always crash, when someone starts the client up and has the log4j dependency removed.&lt;/p&gt;</comment>
                            <comment id="13018891" author="michim" created="Tue, 12 Apr 2011 17:24:35 +0100"  >&lt;p&gt;Oh yeah. I&apos;ll leave this open until &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1010&quot; title=&quot;Remove or move ManagedUtil to contrib, because it has direct log4j dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1010&quot;&gt;&lt;del&gt;ZOOKEEPER-1010&lt;/del&gt;&lt;/a&gt; is resolved. &lt;/p&gt;

&lt;p&gt;--Michi&lt;/p&gt;</comment>
                            <comment id="13084933" author="mahadev" created="Mon, 15 Aug 2011 02:05:39 +0100"  >&lt;p&gt;Olaf/Michi,&lt;br/&gt;
 Is &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1010&quot; title=&quot;Remove or move ManagedUtil to contrib, because it has direct log4j dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1010&quot;&gt;&lt;del&gt;ZOOKEEPER-1010&lt;/del&gt;&lt;/a&gt; a blocker for 3.4. release? My understanding is that folks still need to use log4j since the testing is dependent on it. I dont think that should be blocker. Please correct me if I am wrong.&lt;/p&gt;

&lt;p&gt;thanks&lt;/p&gt;</comment>
                            <comment id="13084999" author="h2o" created="Mon, 15 Aug 2011 09:41:09 +0100"  >&lt;p&gt;Why would log4j be required for &quot;testing&quot;? That&apos;s a &lt;b&gt;bug&lt;/b&gt;. The whole problem is that you&apos;re tying &quot;management&quot; functionality to your logging library, and that needs to be removed (or more precisely separated). The coupling of ManagedUtil to log4j is a blocker for resolving this issue. It may not be relevant for running the server standalone, but it is a HUGE problem for running the server &quot;embedded&quot; (e.g. in an app server) just as it is for the &quot;client-only&quot; side of things. Which of course is just another case for separating the two in the first place. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13085292" author="public@ecopatz.de" created="Mon, 15 Aug 2011 21:01:18 +0100"  >&lt;p&gt;It is not a blocker. As long as log4j remains as a dependency in the distribution, zookeeper runs fine. We just call slf4j functions, which themselves call log4j functions, instead of calling log4j directly.&lt;/p&gt;

&lt;p&gt;In any way, the bug is now a year old. Who uses ManagedUtil anyways? It is not my code, i do not have the guts to just kick it out or move it away. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</comment>
                            <comment id="13085414" author="mahadev" created="Mon, 15 Aug 2011 23:56:25 +0100"  >&lt;p&gt;Sadly, &lt;br/&gt;
 Its used in ZookeeperServerMain and QuorumPeerConfig.java. I do not want to block the release on these changes. I&apos;d rather have something that works in 3.4.0 and remove the remaining part in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1010&quot; title=&quot;Remove or move ManagedUtil to contrib, because it has direct log4j dependencies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1010&quot;&gt;&lt;del&gt;ZOOKEEPER-1010&lt;/del&gt;&lt;/a&gt; in 3.4.1. Would that be acceptable?&lt;/p&gt;</comment>
                            <comment id="13085437" author="public@ecopatz.de" created="Tue, 16 Aug 2011 00:41:07 +0100"  >&lt;p&gt;To me it is acceptable.&lt;/p&gt;</comment>
                            <comment id="13085444" author="public@ecopatz.de" created="Tue, 16 Aug 2011 01:03:03 +0100"  >&lt;p&gt;@Holger &lt;/p&gt;

&lt;p&gt;For testing it is ok to depend on log4j. I must log somehow, right? Especially if i test on cli, when there is no runtime like eclipse, which could pass me a default logger.&lt;/p&gt;

&lt;p&gt;But i might agree with you, that it is a bug, when zookeeper subprojects like client, server and tests are bound together so tight, that test dependencies, like logging with log4j, are carried out to server and client as well, just because there is no special context for testing. I was wondering this on my comment from 07/Dec/10 as well. In Maven i am used to have a test context. But is it possible with ant scripts?&lt;/p&gt;</comment>
                            <comment id="13119374" author="calvarez" created="Mon, 3 Oct 2011 16:50:23 +0100"  >&lt;p&gt;Hi all,&lt;/p&gt;

&lt;p&gt;Calls to org.slf4j.Logger methods should use parameters instead of &quot;string concatenation&quot;.&lt;br/&gt;
That&apos;s one of the main reasons to use SLF4J. More information at: &lt;a href=&quot;http://www.slf4j.org/faq.html#logging_performance&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.slf4j.org/faq.html#logging_performance&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13119499" author="public@ecopatz.de" created="Mon, 3 Oct 2011 20:02:30 +0100"  >&lt;p&gt;@cesar, do you have examples? &lt;/p&gt;

&lt;p&gt;i did only a replace of already existing logging calls, so log.debug or log.info stuff should still be surrounded by log.isDebugEnabled or log.isInfoEnabled as in the original. well, and about warnings and errors, we have chosen an older slf4j api (&amp;lt;1.6) so you still have to do a string concat for customizing your log message, only this enables you to log the stacktrace of an exception.&lt;/p&gt;

&lt;p&gt;so i think this is just details. i wish someone could just remove the direct log4j dependencies. i can not do this.&lt;/p&gt;

&lt;p&gt;and after that we can change to a newer slf4j api and make the beauty work in the source code.&lt;/p&gt;</comment>
                            <comment id="13119501" author="public@ecopatz.de" created="Mon, 3 Oct 2011 20:04:12 +0100"  >&lt;p&gt;i can not change the source code with the direct log4j dependencies. unless someone from the project decides: lets just remove this, no one needs it anyways!&lt;/p&gt;</comment>
                            <comment id="13130388" author="mahadev" created="Wed, 19 Oct 2011 07:25:18 +0100"  >&lt;p&gt;Moving it out of 3.4&lt;/p&gt;</comment>
                            <comment id="13191670" author="jdcryans" created="Tue, 24 Jan 2012 00:17:01 +0000"  >&lt;p&gt;I think this jira should be resolved and a new one opened since code committed here is already part of a release. More so that the release note contains this:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;you must add slf4j-api-1.6.1.jar and slf4j-log4j12-1.6.1.jar (bridge from sl4j to log4j) to the classpath, if not using the standard scripts&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;and that it doesn&apos;t appear anywhere since it wasn&apos;t resolved. BTW this creeped out as a new HBase client dependency too.&lt;/p&gt;</comment>
                            <comment id="13191681" author="mahadev" created="Tue, 24 Jan 2012 00:25:01 +0000"  >&lt;p&gt;Marking this as fixed for 3.4.0. Will create a new jira for removing the actual dependency on log4j.&lt;/p&gt;</comment>
                            <comment id="13191691" author="jdcryans" created="Tue, 24 Jan 2012 00:35:36 +0000"  >&lt;p&gt;Thanks Mahadev!&lt;/p&gt;</comment>
                            <comment id="13763435" author="shikhar" created="Tue, 10 Sep 2013 21:09:26 +0100"  >&lt;p&gt;What&apos;s the ticket for fixing the dependency?&lt;/p&gt;</comment>
                            <comment id="13763437" author="shikhar" created="Tue, 10 Sep 2013 21:10:16 +0100"  >&lt;p&gt;Found it under issue links: &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1371&quot; title=&quot;Remove dependency on log4j in the source code.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1371&quot;&gt;ZOOKEEPER-1371&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12498809">SOLR-2369</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12539547">ZOOKEEPER-1371</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12458511" name="ZOOKEEPER-3.3.1-log4j-slf4j-20101031.patch.bz2" size="15495" author="public@ecopatz.de" created="Sun, 31 Oct 2010 17:35:04 +0000"/>
                            <attachment id="12458597" name="ZOOKEEPER-3.4.0-log4j-slf4j-20101102.patch.bz2" size="20339" author="public@ecopatz.de" created="Tue, 2 Nov 2010 01:10:53 +0000"/>
                            <attachment id="12472757" name="ZOOKEEPER-850.patch" size="211374" author="public@ecopatz.de" created="Sat, 5 Mar 2011 19:32:06 +0000"/>
                            <attachment id="12465621" name="ZOOKEEPER-850.patch" size="211324" author="michim" created="Mon, 6 Dec 2010 21:59:20 +0000"/>
                            <attachment id="12465085" name="ZOOKEEPER-850.patch" size="207910" author="michim" created="Wed, 1 Dec 2010 23:09:46 +0000"/>
                            <attachment id="12459170" name="ZOOKEEPER-850.patch" size="207628" author="phunt" created="Tue, 9 Nov 2010 18:53:34 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12500817">ZOOKEEPER-1010</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 16 Aug 2010 16:31:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>175</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzxb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33380</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>* replaces log4j with slf4j code (also in contrib for bookkeeper, zooinspector,rest,loggraph), added slf4j dependencies into several ivy.xml files&lt;br/&gt;
* you must add slf4j-api-1.6.1.jar and slf4j-log4j12-1.6.1.jar (bridge from sl4j to log4j) to the classpath, if not using the standard scripts&lt;br/&gt;
* log4j remains as the final logger yet, there is still work to do: remove programmatic access to the log4j api from certain classes (which add appenders or configure log4j at runtime), or move them to contrib&lt;br/&gt;
&lt;br/&gt;
</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>