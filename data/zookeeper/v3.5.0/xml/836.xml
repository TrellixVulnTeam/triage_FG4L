<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:46:54 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-836/ZOOKEEPER-836.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-836] hostlist as string</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-836</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;The hostlist is parsed in the ctor of ClientCnxn. This violates the rule of &lt;br/&gt;
not doing (too much) work in a ctor. Instead the ClientCnxn should receive an &lt;br/&gt;
object of class &quot;HostSet&quot;. HostSet could then be instantiated e.g. with a &lt;br/&gt;
comma separated string.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12471298">ZOOKEEPER-836</key>
            <summary>hostlist as string</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12471297">ZOOKEEPER-835</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thkoch">Thomas Koch</assignee>
                                    <reporter username="ymc-pada">Patrick Datko</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Aug 2010 15:46:00 +0100</created>
                <updated>Wed, 1 Dec 2010 10:52:17 +0000</updated>
                            <resolved>Tue, 30 Nov 2010 20:47:54 +0000</resolved>
                                    <version>3.3.1</version>
                                                    <component>java client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12933882" author="hadoopqa" created="Fri, 19 Nov 2010 17:42:21 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12460025/ZOOKEEPER-836.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12460025/ZOOKEEPER-836.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1036071.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The patch appears to cause tar ant target to fail.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to cause Findbugs to fail.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/36//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/36//testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/36//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/36//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12933885" author="thkoch" created="Fri, 19 Nov 2010 17:48:27 +0000"  >&lt;p&gt;forgot to add a file in the last patch&lt;/p&gt;</comment>
                            <comment id="12933903" author="hadoopqa" created="Fri, 19 Nov 2010 18:22:38 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12460027/ZOOKEEPER-836.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12460027/ZOOKEEPER-836.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1036071.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 8 new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 26 release audit warnings (more than the trunk&apos;s current 24 warnings).&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/37//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/37//testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/37//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/37//artifact/trunk/patchprocess/patchReleaseAuditProblems.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/37//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/37//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/37//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/37//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12933906" author="thkoch" created="Fri, 19 Nov 2010 18:33:14 +0000"  >&lt;p&gt;now also added apache license headers ...&lt;/p&gt;</comment>
                            <comment id="12933918" author="hadoopqa" created="Fri, 19 Nov 2010 19:02:40 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12460034/ZOOKEEPER-836.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12460034/ZOOKEEPER-836.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1036967.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 8 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/38//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/38//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/38//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/38//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/38//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/38//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12934559" author="breed" created="Mon, 22 Nov 2010 19:00:03 +0000"  >&lt;p&gt;this looks good thomas. i was hoping to take it one step farther. having a ConnectStringParser and then passing around a list of InetSocketAddresses, it would be nice to have a HostSet and then pass that object around. We would also move the shuffling and the calculation of the connect timeout into that class.&lt;/p&gt;

&lt;p&gt;the reason i mention this is we have another issue (which i cannot seem to find) of periodically reresolving hostnames. right now if you change address resolutions at the DNS server, the client will not pick it up. If we were passing around a HostSet object, follow on work could have a periodic re-resolution encapsulated in that class.&lt;/p&gt;

&lt;p&gt;what do you think? &lt;/p&gt;</comment>
                            <comment id="12934591" author="thkoch" created="Mon, 22 Nov 2010 20:40:47 +0000"  >&lt;p&gt;Hi Benjamin,&lt;/p&gt;

&lt;p&gt;this kind of HostSet class you mention could still be introduced on top of this issue. I&apos;d like in this case to do this in a separate issue where we&apos;d also discuss the design. In this issue I just wanted to get rid of the connectString parsing in ClientCnxn and prepare ClientCnxn to have the chrootPath moved out of it.&lt;br/&gt;
If you could commit this patch as it, I could continue with the patches I&apos;ve in my pipe.&lt;/p&gt;</comment>
                            <comment id="12934718" author="breed" created="Tue, 23 Nov 2010 02:57:46 +0000"  >&lt;p&gt;why don&apos;t we at least call it HostSet so that we don&apos;t have to change the name later?&lt;/p&gt;</comment>
                            <comment id="12934870" author="thkoch" created="Tue, 23 Nov 2010 15:58:52 +0000"  >&lt;p&gt;Hi Benjamin,&lt;/p&gt;

&lt;p&gt;we can not call it HostSet, because the new class I added isn&apos;t a HostSet, it&apos;s a parser for a connectString.&lt;br/&gt;
I don&apos;t know, what the HostSet you suggest should look like. What&apos;s the difference between a List or Set of InetSocketAddress and a HostSet?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Should there be any methods on HostSet appart from the normal List/Set methods?&lt;/li&gt;
	&lt;li&gt;Should there be a reference to HostSet outside of ClientCnxn to manipulate HostSet after it has been given to ClientCnxn?&lt;/li&gt;
	&lt;li&gt;Should the elements of HostSet be instances of InetSocketAddress or just pairs of hostname and port? In that case, do we need to prepare for anything special in regard to IPv6 support?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This issue had to purposes for me:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Get rid of connectionString parsing in ClientCnxn.&lt;/li&gt;
	&lt;li&gt;Separate the HostSet from the chrootPath. IMHO these two things don&apos;t belong together and it was maybe a mistake from the beginning to let the user give the chrootPath inside of the connectString.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;After this patch, I&apos;d like to prepare the next three commits:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-849&quot; title=&quot;Provide Path class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-849&quot;&gt;ZOOKEEPER-849&lt;/a&gt;: Provide a Path class - This will also affect the ConnectStringParser, because I&apos;d like it to return a Path instance instead of a String&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-838&quot; title=&quot;Chroot is an attribute of ClientCnxn&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-838&quot;&gt;ZOOKEEPER-838&lt;/a&gt;: Chroot is an attribute of ClientCnxn - It is possible, that only the ZooKeeper object knows about the chroot and ClientCnxn doesn&apos;t need to have any knowledge about it. Thus it can become possible in the long run to have multiple ZooKeeper objects instantiated using the same ClientCnxn but with different Chroots.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-837&quot; title=&quot;cyclic dependency ClientCnxn, ZooKeeper&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-837&quot;&gt;ZOOKEEPER-837&lt;/a&gt;: cyclic dependency ClientCnxn, ZooKeeper - Of course to have multiple ZooKeeper objects we have to get rid of the ClientCnxn-&amp;gt;ZooKeeper dependency.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12934946" author="breed" created="Tue, 23 Nov 2010 18:04:16 +0000"  >&lt;p&gt;it seems like overkill to have a class to just parse a hostlist. wouldn&apos;t you want put that parsing in the class that actually manages the list?&lt;/p&gt;

&lt;p&gt;we should not be passing around a list of resolved addresses, since those addresses and the list themselves can change. (this is what i mentioned earlier.) instead hostset should take care of resolving and managing the list of resolved addresses. i guess we can do that as a separate patch.&lt;/p&gt;


</comment>
                            <comment id="12935075" author="thkoch" created="Tue, 23 Nov 2010 22:03:18 +0000"  >&lt;p&gt;Well, here we enter matters of taste. Is it better, to have many classes with each class having only a very limited responsability, like the unix philosopy &quot;do one thing and do it well&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;? Or is it better to have few classes which include everything they need?&lt;br/&gt;
It&apos;s my personal taste, that it makes perfect sense to have one class to parse a connectString in a HostSet and a chrootPath and probably have a separate HostSet class for itself. I can&apos;t force this taste on you, but it&apos;s one of my strongest believes on how to write manageable code. - Small, independent, testable, comprehensible units of code.&lt;/p&gt;

&lt;p&gt;I don&apos;t understand your second paragraph. What do you mean with &quot;resolved addresses&quot;? What are then &quot;unresolved addresses&quot;? Do you mean, we should manage the HostSet as pairs of a hostNameString and a portNumber and only resolve it (instantiate an InetSocketAddress and let it query DNS) as late as possible and resolve it again on every connect attempt? - This could make sense and I&apos;d ask you to open a separate issue for it, please. I could then provide a patch for it on top of this patch.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://en.wikipedia.org/wiki/Unix_philosophy&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://en.wikipedia.org/wiki/Unix_philosophy&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12935498" author="breed" created="Wed, 24 Nov 2010 21:29:30 +0000"  >&lt;p&gt;i really don&apos;t think it is a good idea to refactor code based on an individual developer&apos;s taste. we should do it to fix a bug or to improve something. i will not veto this patch, but i&apos;m not going to +1 it. you&apos;ll need to convince another committer that it is a good idea.&lt;/p&gt;</comment>
                            <comment id="12935501" author="breed" created="Wed, 24 Nov 2010 21:31:58 +0000"  >&lt;p&gt;adding a link to the issue about reresolving hosts, since i think this work should at least complement that.&lt;/p&gt;</comment>
                            <comment id="12935521" author="thkoch" created="Wed, 24 Nov 2010 21:47:27 +0000"  >&lt;p&gt;I&apos;ll try to rework the patch and integrate &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-338&quot; title=&quot;zk hosts should be resolved periodically for loadbalancing amongst zk servers.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-338&quot;&gt;ZOOKEEPER-338&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-146&quot; title=&quot;Allow clients to retrieve the list of hosts/servers from a URL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-146&quot;&gt;ZOOKEEPER-146&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12935524" author="breed" created="Wed, 24 Nov 2010 21:53:33 +0000"  >&lt;p&gt;that would be great thomas. thanx!&lt;/p&gt;</comment>
                            <comment id="12936059" author="thkoch" created="Fri, 26 Nov 2010 16:52:29 +0000"  >&lt;p&gt;This new patch version introduces the interface HostProvider with the most relevant method next(long spinDelay) which ClientCnxn uses to get the next Host to try.&lt;br/&gt;
A first implementation of this interface is included as StaticHostProvider which mostly reflects the behavior of the current code.&lt;/p&gt;

&lt;p&gt;One difference to current behavior is:&lt;br/&gt;
Once a connection has been established, the StaticHostProvider is reseted to point to the first host in its internal list. The internal list however is still shuffled on instantiation.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-338&quot; title=&quot;zk hosts should be resolved periodically for loadbalancing amongst zk servers.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-338&quot;&gt;ZOOKEEPER-338&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-146&quot; title=&quot;Allow clients to retrieve the list of hosts/servers from a URL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-146&quot;&gt;ZOOKEEPER-146&lt;/a&gt; can be solved on top of this patch by providing additional implementations of HostProvider and allowing ZooKeeper to be instantiated with an instance of ClientCnxn.&lt;/p&gt;</comment>
                            <comment id="12936099" author="breed" created="Fri, 26 Nov 2010 21:34:03 +0000"  >&lt;p&gt;this looks great thomas! i really like the HostProvider class. There is one change i would like you to make. (or i can make it if you are okay with it.) the  IllegalConstructorArgumentException is a bit gratuitous. especially since it will be changed to an IllegalArgumentException later. could you just make that an IllegalConstructorArgumentException so that we can avoid class proliferation?&lt;/p&gt;</comment>
                            <comment id="12964492" author="breed" created="Sun, 28 Nov 2010 03:23:00 +0000"  >&lt;p&gt;dang, i just realized that i meant to say &quot;could you just make that an IllegalArgementException&quot;.&lt;/p&gt;</comment>
                            <comment id="12964501" author="thkoch" created="Sun, 28 Nov 2010 06:27:44 +0000"  >&lt;p&gt;Hi Benjamin,&lt;/p&gt;

&lt;p&gt;I&apos;m happy that we found something we both like! About the exception I had the following thoughts:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Well, obviously I don&apos;t consider class proliferation an issue. I&apos;d always prefer adding a new class instead of having 500+ lines gorilla classes that needs hours to understand.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I&apos;m not sure on that one: Shouldn&apos;t it be a very rare exception &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; to throw unchecked exceptions? I&apos;d use unchecked exceptions when I&apos;m very sure at programming time, that either this problem should never happen in the first plane or when there is nothing, my caller code could do to handle this exception and the best thing to do is to blow up the whole process.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I&apos;ve had a look through standard Java Exceptions but didn&apos;t find any that would&apos;ve made sense, so I wrote my own. Throwing just an instance of &quot;Exception&quot; seemed to unspecific.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I&apos;m re-throwing as an IllegalArgumentException in ZooKeeper to not break API compatibility. If I could break API compatibility, then I&apos;d just pass it through.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Even better then passing it through is my long term goal for dependency injection: The ZooKeeper class shouldn&apos;t instantiate a ClientCnxn in the first place. There should be a ZooKeeper( ClientCnxn cnxn ) constructor. However this is possible only after &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-837&quot; title=&quot;cyclic dependency ClientCnxn, ZooKeeper&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-837&quot;&gt;ZOOKEEPER-837&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12964506" author="thkoch" created="Sun, 28 Nov 2010 07:30:16 +0000"  >&lt;p&gt;I&apos;ve found this article from ibm developerworks about the pros and cons of checked vs. unchecked exceptions:&lt;br/&gt;
&lt;a href=&quot;http://www.ibm.com/developerworks/java/library/j-jtp05254.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.ibm.com/developerworks/java/library/j-jtp05254.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I believe it supports my case for checked exceptions in this patch. Maybe I should provide more specific exceptions?&lt;/p&gt;

&lt;p&gt;I couldn&apos;t find a preference toward either checked or unchecked exceptions in the &lt;a href=&quot;http://wiki.apache.org/hadoop/CodeReviewChecklist&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/hadoop/CodeReviewChecklist&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I know only of this mail which suggests phunt&apos;s preference of checked exceptions: &lt;br/&gt;
&lt;a href=&quot;http://www.mail-archive.com/zookeeper-user@hadoop.apache.org/msg00920.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/zookeeper-user@hadoop.apache.org/msg00920.html&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="12964618" author="hadoopqa" created="Mon, 29 Nov 2010 02:42:16 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12460514/ZOOKEEPER-836.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12460514/ZOOKEEPER-836.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1038827.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 8 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/51//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/51//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/51//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/51//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/51//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/51//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12964791" author="breed" created="Mon, 29 Nov 2010 16:11:14 +0000"  >&lt;p&gt;i agree, we should use checked exceptions. most, if not all, of the exceptions we have added are checked exceptions. still we have to adapt to the world in which we live. Thread.sleep() should not throw a checked exception, but it does. i&apos;m not going to write a new class to fix that. IllegalArgumentException works perfectly here. maybe it should have been a checked exception, but it&apos;s not. let&apos;s just use it and move on. i know class proliferation is not an issue for you, but it is for some of us.&lt;/p&gt;</comment>
                            <comment id="12964801" author="breed" created="Mon, 29 Nov 2010 16:28:58 +0000"  >&lt;p&gt;same patch as before, just using IllegalArgumentException rather than introducing a new class.&lt;/p&gt;</comment>
                            <comment id="12964813" author="fournc" created="Mon, 29 Nov 2010 16:49:14 +0000"  >&lt;p&gt;I am not a fan of the StaticHostProvider changing the random round robin behavior of the current setup. In the case of a poorly-behaving ZK server that allows connections briefly and then terminates them, the client is trapped by this server if it happens to be at the start of its randomized list. Is it likely to happen? Probably not, but I don&apos;t see any compelling reason to introduce this possible problem.&lt;/p&gt;</comment>
                            <comment id="12964827" author="breed" created="Mon, 29 Nov 2010 17:07:13 +0000"  >&lt;p&gt;i agree that always starting at the beginning of the list will be a problem, but that shouldn&apos;t happen with StaticHostProvider. the iterator of the host list is a local variable that gets used on each call to next(), so you shouldn&apos;t go back to the beginning until you have gone through all the other hosts in the list.&lt;/p&gt;</comment>
                            <comment id="12964841" author="thkoch" created="Mon, 29 Nov 2010 17:19:31 +0000"  >&lt;p&gt;Camille is right. The randomized list is used from the beginning on every reconnect. This is an artifact of a previous design. I thought it wouldn&apos;t matter. I&apos;ll fix this now.&lt;/p&gt;</comment>
                            <comment id="12964848" author="phunt" created="Mon, 29 Nov 2010 17:30:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;I know only of this mail which suggests phunt&apos;s preference of checked exceptions&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m not a fan of &quot;get rid of all checked exceptions&quot;, I believe they do have a place. I did see a recent article (can&apos;t find it off hand) though that was specifically talking about not using checked exceptions in public APIs due to the fact that they change the signature. I see the wisdom in that &amp;#8211; except when throwing an unchecked exception (in order to not break the API signature) ends up breaking the semantics (say you start throwing an unchecked exception that you expect the caller should naturally handle, not sure of use case/real world example here...)&lt;/p&gt;</comment>
                            <comment id="12964850" author="breed" created="Mon, 29 Nov 2010 17:39:21 +0000"  >&lt;p&gt;ah good catch camille! i totally missed setting the iterator to null in onConnected()&lt;/p&gt;</comment>
                            <comment id="12964852" author="phunt" created="Mon, 29 Nov 2010 17:43:10 +0000"  >&lt;blockquote&gt;&lt;p&gt;ah good catch camille! i totally missed setting the iterator to null in onConnected()&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;let&apos;s add a test for this case&lt;/p&gt;</comment>
                            <comment id="12964862" author="thkoch" created="Mon, 29 Nov 2010 18:20:13 +0000"  >&lt;p&gt;Hopefully the last version. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Fixed the issue of Camille.&lt;/p&gt;</comment>
                            <comment id="12964863" author="thkoch" created="Mon, 29 Nov 2010 18:22:48 +0000"  >&lt;p&gt;go go hudson!&lt;/p&gt;</comment>
                            <comment id="12964873" author="thkoch" created="Mon, 29 Nov 2010 18:45:11 +0000"  >&lt;p&gt;added more tests&lt;/p&gt;</comment>
                            <comment id="12964874" author="breed" created="Mon, 29 Nov 2010 18:53:18 +0000"  >&lt;p&gt;+1 looks good thomas! thanx!&lt;/p&gt;

&lt;p&gt;camille, does it look good to you?&lt;/p&gt;</comment>
                            <comment id="12964877" author="hadoopqa" created="Mon, 29 Nov 2010 19:02:38 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12464887/ZOOKEEPER-836.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12464887/ZOOKEEPER-836.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1038827.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 8 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/54//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/54//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/54//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/54//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/54//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/54//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12964892" author="breed" created="Mon, 29 Nov 2010 19:32:57 +0000"  >&lt;p&gt;the core tests that failed are in the C code, so not related to this patch. the findbugs are also not related to this patch.&lt;/p&gt;</comment>
                            <comment id="12964893" author="hadoopqa" created="Mon, 29 Nov 2010 19:33:40 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12464889/ZOOKEEPER-836.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12464889/ZOOKEEPER-836.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1038827.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 8 new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/55//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/55//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/55//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/55//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/55//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/PreCommit-ZOOKEEPER-Build/55//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12965313" author="breed" created="Tue, 30 Nov 2010 18:03:47 +0000"  >&lt;p&gt;this patch is totally ready to go in. thomas added the tests that pat asked for, but hudson doesn&apos;t seem to be passing. the failures are unrelated to thomas&apos;s patch and it passes on my machine.&lt;/p&gt;</comment>
                            <comment id="12965329" author="phunt" created="Tue, 30 Nov 2010 18:29:37 +0000"  >&lt;p&gt;Sounds good to go in. We should try and address the test failure (Ben can you create a jira for that?) but that&apos;s for another JIRA.&lt;/p&gt;

&lt;p&gt;Thanks Thomas, you are on a hot streak!&lt;/p&gt;</comment>
                            <comment id="12965422" author="thkoch" created="Tue, 30 Nov 2010 20:43:12 +0000"  >&lt;p&gt;Ran the testsuite again without errors. Benjamin reported a failure in some Hammer test on his local machine.&lt;/p&gt;</comment>
                            <comment id="12965427" author="breed" created="Tue, 30 Nov 2010 20:47:54 +0000"  >&lt;p&gt;&#8203;&#8203;Committed revision 1040752.&lt;/p&gt;</comment>
                            <comment id="12965654" author="hudson" created="Wed, 1 Dec 2010 10:52:17 +0000"  >&lt;p&gt;Integrated in ZooKeeper-trunk #1023 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/ZooKeeper-trunk/1023/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/ZooKeeper-trunk/1023/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-836&quot; title=&quot;hostlist as string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-836&quot;&gt;&lt;del&gt;ZOOKEEPER-836&lt;/del&gt;&lt;/a&gt;. hostlist as string.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12463601">ZOOKEEPER-762</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12417097">ZOOKEEPER-338</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12465492">ZOOKEEPER-781</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12405190">ZOOKEEPER-146</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12464889" name="ZOOKEEPER-836.patch" size="29452" author="thkoch" created="Mon, 29 Nov 2010 18:45:11 +0000"/>
                            <attachment id="12464887" name="ZOOKEEPER-836.patch" size="28775" author="thkoch" created="Mon, 29 Nov 2010 18:20:13 +0000"/>
                            <attachment id="12460514" name="ZOOKEEPER-836.patch" size="31499" author="thkoch" created="Fri, 26 Nov 2010 16:52:29 +0000"/>
                            <attachment id="12460034" name="ZOOKEEPER-836.patch" size="14109" author="thkoch" created="Fri, 19 Nov 2010 18:33:14 +0000"/>
                            <attachment id="12464876" name="ZOOKEEPER-836_2.patch" size="28201" author="breed" created="Mon, 29 Nov 2010 16:28:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 19 Nov 2010 17:42:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47580</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzxbj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33382</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>hostliste, comma seperated</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>