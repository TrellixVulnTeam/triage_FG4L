<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:43:54 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-792/ZOOKEEPER-792.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-792] zkpython memory leak</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-792</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;We recently upgraded zookeeper from 3.2.1 to 3.3.1, now we are seeing less client deadlock on session expiration, which is a definite plus!&lt;/p&gt;

&lt;p&gt;Unfortunately we are seeing memory leak that requires our zk clients to be restarted every half-day. Valgrind result:&lt;/p&gt;

&lt;p&gt;==8804== 25 (12 direct, 13 indirect) bytes in 1 blocks are definitely lost in loss record 255 of 670&lt;br/&gt;
==8804==    at 0x4021C42: calloc (vg_replace_malloc.c:418)&lt;br/&gt;
==8804==    by 0x5047B42: parse_acls (zookeeper.c:369)&lt;br/&gt;
==8804==    by 0x5047EF6: pyzoo_create (zookeeper.c:1009)&lt;br/&gt;
==8804==    by 0x40786CC: PyCFunction_Call (in /usr/lib/libpython2.4.so.1.0)&lt;br/&gt;
==8804==    by 0x40B31DC: PyEval_EvalFrame (in /usr/lib/libpython2.4.so.1.0)&lt;br/&gt;
==8804==    by 0x40B4485: PyEval_EvalCodeEx (in /usr/lib/libpython2.4.so.1.0)&lt;/p&gt;</description>
                <environment>&lt;p&gt;vmware workstation - guest OS:Linux python:2.4.3&lt;/p&gt;</environment>
        <key id="12467836">ZOOKEEPER-792</key>
            <summary>zkpython memory leak</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="voyager">Lei Zhang</assignee>
                                    <reporter username="voyager">Lei Zhang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Jun 2010 22:36:54 +0100</created>
                <updated>Wed, 23 Nov 2011 19:22:41 +0000</updated>
                            <resolved>Mon, 23 Aug 2010 03:59:54 +0100</resolved>
                                    <version>3.3.1</version>
                                    <fixVersion>3.3.2</fixVersion>
                    <fixVersion>3.4.0</fixVersion>
                                    <component>contrib-bindings</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12882391" author="voyager" created="Fri, 25 Jun 2010 00:08:38 +0100"  >&lt;p&gt;Plug memory leak in pyzoo_get() and pyzoo_create().&lt;/p&gt;</comment>
                            <comment id="12882420" author="hadoopqa" created="Fri, 25 Jun 2010 02:41:37 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12447995/ZOOKEEPER-792.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12447995/ZOOKEEPER-792.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 953041.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/120/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/120/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/120/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/120/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/120/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/120/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12892801" author="mahadev" created="Tue, 27 Jul 2010 15:44:28 +0100"  >&lt;p&gt;henry, can you take a look at this?&lt;/p&gt;</comment>
                            <comment id="12897986" author="voyager" created="Thu, 12 Aug 2010 23:44:32 +0100"  >&lt;p&gt;We&apos;ve been using this patch in production (16-node cluster) for over a month. I&apos;d like to have it go into never release. Can somebody please code review?&lt;/p&gt;</comment>
                            <comment id="12899004" author="henryr" created="Mon, 16 Aug 2010 18:41:23 +0100"  >&lt;p&gt;Hi - &lt;/p&gt;

&lt;p&gt;Sorry for the slow response! I just took a look over the patch - good catches.&lt;/p&gt;

&lt;p&gt;+1. I&apos;ll commit within the day. &lt;/p&gt;

&lt;p&gt;Henry&lt;/p&gt;</comment>
                            <comment id="12899676" author="henryr" created="Wed, 18 Aug 2010 01:56:06 +0100"  >&lt;p&gt;Just to update - I&apos;ve found that zkpython tests are failing in trunk, and I don&apos;t want to commit a patch when the tests are broken. I&apos;ll be creating a JIRA shortly to address the problem once I&apos;ve looked into it slightly further.&lt;/p&gt;</comment>
                            <comment id="12900380" author="henryr" created="Thu, 19 Aug 2010 19:09:08 +0100"  >&lt;p&gt;Aha - I think I have found the problem, and it was related to this patch.&lt;/p&gt;


&lt;p&gt;   PyObject *ret = Py_BuildValue( &quot;(s#,N)&quot;, buffer,buffer_len, stat_dict );&lt;br/&gt;
+  free_pywatcher(pw);&lt;br/&gt;
   free(buffer);&lt;/p&gt;

&lt;p&gt;We shouldn&apos;t free the pywatcher_t object here because it may be called later. This was what was causing the segfault I was seeing. I&apos;ll upload a new patch with this line removed; I hope it will still fix your memory consumption issues. &lt;/p&gt;</comment>
                            <comment id="12900389" author="henryr" created="Thu, 19 Aug 2010 19:20:34 +0100"  >&lt;p&gt;Updated patch to remove that bug. &lt;/p&gt;</comment>
                            <comment id="12900391" author="henryr" created="Thu, 19 Aug 2010 19:25:40 +0100"  >&lt;p&gt;I forgot --no-prefix. Plus ca change, plus c&apos;est la meme chose. &lt;/p&gt;</comment>
                            <comment id="12900563" author="voyager" created="Fri, 20 Aug 2010 04:41:37 +0100"  >&lt;p&gt;Thanks a lot.&lt;/p&gt;</comment>
                            <comment id="12901244" author="henryr" created="Mon, 23 Aug 2010 03:59:53 +0100"  >&lt;p&gt;I just committed this! Thanks Lei Zhang!&lt;/p&gt;</comment>
                            <comment id="12909609" author="hudson" created="Wed, 15 Sep 2010 07:19:57 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #936 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/ZooKeeper-trunk/936/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/ZooKeeper-trunk/936/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12452555" name="ZOOKEEPER-792.patch" size="1363" author="henryr" created="Thu, 19 Aug 2010 19:25:40 +0100"/>
                            <attachment id="12452554" name="ZOOKEEPER-792.patch" size="1371" author="henryr" created="Thu, 19 Aug 2010 19:20:33 +0100"/>
                            <attachment id="12447995" name="ZOOKEEPER-792.patch" size="1234" author="voyager" created="Fri, 25 Jun 2010 00:08:38 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 25 Jun 2010 01:41:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47598</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzu4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32866</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>