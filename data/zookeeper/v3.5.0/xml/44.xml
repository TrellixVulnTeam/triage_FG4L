<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:51:57 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-44/ZOOKEEPER-44.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-44] DataTree does not use natural sort for getChildren</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-44</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;DataTree.getChildren() performs Collection.sort() on the list of children before returning it, but Java&apos;s default comparator for Strings will sort &apos;lock-20&apos; before &apos;lock-3&apos; for instance. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12398018">ZOOKEEPER-44</key>
            <summary>DataTree does not use natural sort for getChildren</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jghoman">Jakob Homan</assignee>
                                    <reporter username="stuhood">Stu Hood</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Jun 2008 05:17:46 +0100</created>
                <updated>Sun, 26 Oct 2008 01:10:38 +0000</updated>
                            <resolved>Sat, 2 Aug 2008 01:09:49 +0100</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12604235" author="breed" created="Wed, 11 Jun 2008 15:36:26 +0100"  >&lt;p&gt;Actually we have been meaning to remove the sort. It causes an unnecessary burden on the server. If we really want things sorted, we should do it in the client library. The question is: do we really want things sorted? Especially in Java it is easy enough for the user to sort the list themself if needed.&lt;/p&gt;</comment>
                            <comment id="12604265" author="phunt" created="Wed, 11 Jun 2008 17:22:41 +0100"  >&lt;p&gt;My personal preference would be to leave it unsorted and let the client sort if needed. That way you only pay the perf penalty if you need the children sorted. Either way we should address this &amp;#8211; remove the unnecessary sort and make sure to document that the results are unsorted.&lt;/p&gt;</comment>
                            <comment id="12604288" author="stuhood" created="Wed, 11 Jun 2008 18:53:46 +0100"  >&lt;p&gt;I&apos;d be fine with the sort being removed from getChildren, but fixing the natural sorting problem is still important. It causes undue pain for the client to have to perform an integer-aware sort to get the proper ordering for locks.&lt;/p&gt;

&lt;p&gt;My workaround was to pad the sequence value before appending it to the path in create:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((createRequest.getFlags() &amp;amp; CreateFlags.SEQUENCE) != 0) {
    path = path + &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.format(&lt;span class=&quot;code-quote&quot;&gt;&quot;%1$010d&quot;&lt;/span&gt;, parentCVersion);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="12604290" author="breed" created="Wed, 11 Jun 2008 19:02:16 +0100"  >&lt;p&gt;+1 Excellent suggestion!&lt;/p&gt;</comment>
                            <comment id="12604292" author="phunt" created="Wed, 11 Jun 2008 19:06:09 +0100"  >&lt;p&gt;+1, sounds like a great addition to a FAQ.&lt;/p&gt;

&lt;p&gt;Assigning to Ben to remove the sort and document appropriately.&lt;/p&gt;</comment>
                            <comment id="12619159" author="jghoman" created="Fri, 1 Aug 2008 23:55:03 +0100"  >&lt;p&gt;I&apos;ve gone ahead and implemented the patch as discussed, which does the following:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Implements the padding for sequential file names, padding ten zeroes to the name (enough to handle as many digits as can be generated by a 32-bit int).  This allows the names to be sorted by natural order.&lt;/li&gt;
	&lt;li&gt;Removed the server sorting the list of children, leaving it up to the client to do so if it wishes.  This could give a very slight performance bump, particularly when dealing with directories with a large number of files.&lt;/li&gt;
	&lt;li&gt;Updated the Javadoc to reflect this change in both versions of the getChildren method.&lt;/li&gt;
	&lt;li&gt;Adds a unit test that checks that the sequential file names are being created correctly.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I thought about adding a GetChildrenSorted or such method, but since it&apos;s really easy for the client to sort the list once returned (java.Collections.List.Sort(children)), it seems like it would be more work to add and support these methods.&lt;/p&gt;

&lt;p&gt;Hope this is useful.&lt;/p&gt;</comment>
                            <comment id="12619160" author="jghoman" created="Fri, 1 Aug 2008 23:55:35 +0100"  >&lt;p&gt;Implements the changes discussed in the Jira.&lt;/p&gt;</comment>
                            <comment id="12619163" author="breed" created="Sat, 2 Aug 2008 00:09:16 +0100"  >&lt;p&gt;+1 Fantastic job Jakob! This looks great. Test cases and everything.&lt;/p&gt;</comment>
                            <comment id="12619164" author="mahadev" created="Sat, 2 Aug 2008 00:18:24 +0100"  >&lt;p&gt;+1 .. thanks jakob .... &lt;/p&gt;

&lt;p&gt;nit:&lt;/p&gt;

&lt;p&gt;is %1$ redundant? i had to look up the formatter in java for this &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;... i think %010d should be fine?&lt;/p&gt;</comment>
                            <comment id="12619165" author="jghoman" created="Sat, 2 Aug 2008 00:28:09 +0100"  >&lt;p&gt;Unnecessary placeholder removed.&lt;/p&gt;</comment>
                            <comment id="12619169" author="mahadev" created="Sat, 2 Aug 2008 01:09:49 +0100"  >&lt;p&gt;I just committed this. THanks Jakob. &lt;/p&gt;</comment>
                            <comment id="12619290" author="stuhood" created="Sun, 3 Aug 2008 00:04:49 +0100"  >&lt;p&gt;This is probably a separate issue, but is anyone worried by the fact that after ~2 billion creates, the sequence number will wrap around and break various algorithms?&lt;/p&gt;</comment>
                            <comment id="12619293" author="mahadev" created="Sun, 3 Aug 2008 01:31:42 +0100"  >&lt;p&gt;2 billion creates seem to be a lot fo creates. also since we are working on an upgrade feature on zookeeper &amp;#8212; we can upgrade the version to be long sometime later ...  &amp;#8211; which would make the wrap around 4* 10^18.&lt;/p&gt;</comment>
                            <comment id="12619400" author="hudson" created="Mon, 4 Aug 2008 02:45:20 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #42 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/42/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/42/&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12642685" author="phunt" created="Sun, 26 Oct 2008 01:10:38 +0000"  >&lt;p&gt;3.0.0 has been released, closing issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12387376" name="seqfile.diff" size="5549" author="jghoman" created="Fri, 1 Aug 2008 23:55:35 +0100"/>
                            <attachment id="12387378" name="seqfile2.diff" size="5547" author="jghoman" created="Sat, 2 Aug 2008 00:28:09 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 11 Jun 2008 14:36:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48090</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzyrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33616</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>