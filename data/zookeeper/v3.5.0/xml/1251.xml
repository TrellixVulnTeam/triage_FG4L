<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:50:23 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-1251/ZOOKEEPER-1251.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-1251] call checkSession at begin of PrepRequestProcessor.pRequest</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-1251</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;There are 6 locations that call checkSession. This can be reduced to one location and makes it also much clearer in which cases checkSession is called or not called.&lt;/p&gt;

&lt;p&gt;Note that in case that now the SessionMoved|Expired error is checked first before the check for a Marshalling error. However it shouldn&apos;t matter which error gets reported.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12528853">ZOOKEEPER-1251</key>
            <summary>call checkSession at begin of PrepRequestProcessor.pRequest</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12524256">ZOOKEEPER-1198</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="10002" iconUrl="https://issues.apache.org/jira/images/icons/statuses/document.png" description="A patch for this issue has been uploaded to JIRA by a contributor.">Patch Available</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="thkoch">Thomas Koch</assignee>
                                    <reporter username="thkoch">Thomas Koch</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Oct 2011 12:07:56 +0100</created>
                <updated>Sat, 12 Nov 2011 12:15:14 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13135869" author="thkoch" created="Wed, 26 Oct 2011 12:10:03 +0100"  >&lt;p&gt;this patch adds 4 lines, deletes 18 lines&lt;/p&gt;</comment>
                            <comment id="13135880" author="hadoopqa" created="Wed, 26 Oct 2011 12:42:13 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12500864/ZOOKEEPER-1251.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12500864/ZOOKEEPER-1251.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1188523.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/679//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/679//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/679//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/679//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/679//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/679//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13136117" author="phunt" created="Wed, 26 Oct 2011 18:08:11 +0100"  >&lt;p&gt;committed. Thanks Thomas!&lt;/p&gt;</comment>
                            <comment id="13136958" author="hudson" created="Thu, 27 Oct 2011 11:54:40 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #1346 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/1346/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/1346/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1251&quot; title=&quot;call checkSession at begin of PrepRequestProcessor.pRequest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1251&quot;&gt;ZOOKEEPER-1251&lt;/a&gt;. call checkSession at begin of PrepRequestProcessor.pRequest (Thomas Koch via phunt)&lt;/p&gt;

&lt;p&gt;phunt : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1189318&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1189318&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13148724" author="phunt" created="Fri, 11 Nov 2011 20:49:12 +0000"  >&lt;p&gt;Turns out there is a bug in this (found while testing &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1208&quot; title=&quot;Ephemeral node not removed after the client session is long gone&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1208&quot;&gt;&lt;del&gt;ZOOKEEPER-1208&lt;/del&gt;&lt;/a&gt;). It does not correctly handle checkSession failures - hdr is not set correctly and results in NPE in FinalRequestProcessor.&lt;/p&gt;</comment>
                            <comment id="13148731" author="thkoch" created="Fri, 11 Nov 2011 21:03:23 +0000"  >&lt;p&gt;Only for correctness: The bug has probably already been there before in the case of read requests. I could provide a patch on top of &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1284&quot; title=&quot;Cleanup minor PrepRequestProcessor issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1284&quot;&gt;ZOOKEEPER-1284&lt;/a&gt; if you like. But since the issue you describe has not been introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1251&quot; title=&quot;call checkSession at begin of PrepRequestProcessor.pRequest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1251&quot;&gt;ZOOKEEPER-1251&lt;/a&gt;, I propose that we handle this in a new issue?&lt;/p&gt;</comment>
                            <comment id="13148738" author="phunt" created="Fri, 11 Nov 2011 21:16:33 +0000"  >&lt;p&gt;@thomas I&apos;d suggest write a test that demonstrates this problem (both read and write), attach that to a new jira. If you want to fix it all the better. We can commit this after the new jira is fixed.&lt;/p&gt;</comment>
                            <comment id="13148750" author="phunt" created="Fri, 11 Nov 2011 21:28:55 +0000"  >&lt;p&gt;@thomas I checked your assertion about &quot;probably already been there before in the case of read requests&quot; by updating my test in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1208&quot; title=&quot;Ephemeral node not removed after the client session is long gone&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1208&quot;&gt;&lt;del&gt;ZOOKEEPER-1208&lt;/del&gt;&lt;/a&gt; to do a read - doesn&apos;t seem to be the case. Reads and writes are handled gracefully when operations come in after session expiration.&lt;/p&gt;</comment>
                            <comment id="13148754" author="phunt" created="Fri, 11 Nov 2011 21:32:56 +0000"  >&lt;p&gt;Apply update_to_1208_showingreadfailure.patch  to post-1208 code and you&apos;ll see what I mean. Please include this in any repro/fix.&lt;/p&gt;</comment>
                            <comment id="13149043" author="hudson" created="Sat, 12 Nov 2011 10:57:42 +0000"  >&lt;p&gt;Integrated in ZooKeeper-trunk #1363 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/1363/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/1363/&lt;/a&gt;)&lt;br/&gt;
    Reverting: &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1251&quot; title=&quot;call checkSession at begin of PrepRequestProcessor.pRequest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1251&quot;&gt;ZOOKEEPER-1251&lt;/a&gt;. call checkSession at begin of PrepRequestProcessor.pRequest&lt;/p&gt;

&lt;p&gt;phunt : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1201045&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1201045&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/PrepRequestProcessor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13149051" author="thkoch" created="Sat, 12 Nov 2011 11:49:58 +0000"  >&lt;p&gt;This patch includes the not yet committed &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1208&quot; title=&quot;Ephemeral node not removed after the client session is long gone&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1208&quot;&gt;&lt;del&gt;ZOOKEEPER-1208&lt;/del&gt;&lt;/a&gt; from phunt and cleanups proposed in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1284&quot; title=&quot;Cleanup minor PrepRequestProcessor issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1284&quot;&gt;ZOOKEEPER-1284&lt;/a&gt;. Building on top of 1284 is necessary for this patch.&lt;/p&gt;</comment>
                            <comment id="13149054" author="hadoopqa" created="Sat, 12 Nov 2011 12:15:14 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12503488/ZOOKEEPER-1251_with_1208_and_1284.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12503488/ZOOKEEPER-1251_with_1208_and_1284.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1201045.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 5 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/788//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/788//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/788//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/788//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/788//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/788//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12500864" name="ZOOKEEPER-1251.patch" size="4103" author="thkoch" created="Wed, 26 Oct 2011 12:10:03 +0100"/>
                            <attachment id="12503488" name="ZOOKEEPER-1251_with_1208_and_1284.patch" size="21699" author="thkoch" created="Sat, 12 Nov 2011 11:48:31 +0000"/>
                            <attachment id="12503424" name="update_to_1208_showingreadfailure.patch" size="3495" author="phunt" created="Fri, 11 Nov 2011 21:32:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 26 Oct 2011 11:42:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>214713</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy1elj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42016</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>