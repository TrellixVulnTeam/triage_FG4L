<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:46:49 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-809/ZOOKEEPER-809.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-809] Improved REST Interface</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-809</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;I would like to extend the existing REST Interface to also support:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;configuration&lt;/li&gt;
	&lt;li&gt;ephemeral znodes&lt;/li&gt;
	&lt;li&gt;watches - PubSubHubbub&lt;/li&gt;
	&lt;li&gt;ACLs&lt;/li&gt;
	&lt;li&gt;basic authentication&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I want to do this because when building web applications that talks directly to ZooKeeper a REST API it&apos;s a lot easier to use (there is no protocol mismatch) than an API that uses persistent connections. I plan to use the improved version to build a web-based administrative interface. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12468977">ZOOKEEPER-809</key>
            <summary>Improved REST Interface</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="savu.andrei">Andrei Savu</assignee>
                                    <reporter username="savu.andrei">Andrei Savu</reporter>
                        <labels>
                    </labels>
                <created>Sat, 10 Jul 2010 16:18:29 +0100</created>
                <updated>Wed, 23 Nov 2011 19:22:05 +0000</updated>
                            <resolved>Tue, 17 Aug 2010 08:26:03 +0100</resolved>
                                                    <fixVersion>3.4.0</fixVersion>
                                    <component>contrib</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12887045" author="savu.andrei" created="Sat, 10 Jul 2010 16:20:14 +0100"  >&lt;p&gt;Very soon I&apos;m also going to attach an updated version of the REST SPEC.txt file because I would like to get more feedback from you before writing any code. &lt;/p&gt;</comment>
                            <comment id="12888357" author="savu.andrei" created="Wed, 14 Jul 2010 15:11:12 +0100"  >&lt;p&gt;I&apos;ve attached the first draft of the SPECs for an improved REST gateway. &lt;/p&gt;

&lt;p&gt;I&apos;m proposing the following new operations:&lt;/p&gt;

&lt;p&gt;1. create a new session &amp;#8211; POST /sessions/v1?op=create HTTP/1.1&lt;/p&gt;

&lt;p&gt;2. keep the session alive &amp;#8211; PUT /sessions/v1/&amp;lt;SESSION-ID&amp;gt; HTTP/1.1&lt;/p&gt;

&lt;p&gt;3. close the session &amp;#8211; DELETE /sessions/v1/&amp;lt;SESSION-ID&amp;gt; HTTP/1.1&lt;/p&gt;

&lt;p&gt;4. create an ephemeral node &amp;#8211; POST /znodes/v1/a/b?op=create&amp;amp;name=c&amp;amp;ephemeral=true&amp;amp;session=&amp;lt;SESSION-ID&amp;gt; HTTP/1.1&lt;/p&gt;

&lt;p&gt;5. create a new watch &amp;#8211; POST /znodes/v1/a/b?op=watch&amp;amp;view=data OR children&amp;amp;session=&amp;lt;SESSION-ID&amp;gt; HTTP/1.1&lt;/p&gt;

&lt;p&gt;6. query watch status &amp;#8211; GET /sessions/v1/&amp;lt;SESSION-ID&amp;gt;/watches/&amp;lt;WATCH-ID&amp;gt; HTTP/1.1&lt;br/&gt;
This operation could support long-polling in the future. &lt;/p&gt;

&lt;p&gt;7. delete a triggered watch &amp;#8211; DELETE /sessions/v1/&amp;lt;SESSION-ID&amp;gt;/watches/&amp;lt;WATCH-ID&amp;gt; HTTP/1.1&lt;/p&gt;

&lt;p&gt;Let me know what you think about this. Am I breaking the REST principles? &lt;/p&gt;

&lt;p&gt;This is what I want to do in the first iteration. In the second iteration I would like to add support for ACLs and authentication. &lt;/p&gt;</comment>
                            <comment id="12888404" author="phunt" created="Wed, 14 Jul 2010 17:01:12 +0100"  >&lt;p&gt;When I first created the REST interface I didn&apos;t have the notion of sessions, now that you do I think you would want to augment the notion of having a /znodes/... url with a url of /sessions/v1/&amp;lt;session TOKEN&amp;gt;/znodes/....&lt;/p&gt;

&lt;p&gt;so create the session as you suggest, however that create operation returns a url representing the session, after which all of your operations use that as a &quot;prefix&quot; if you will. e.g.:&lt;/p&gt;

&lt;p&gt;create a new session - POST /sessions/v1?op=create HTTP/1.1&lt;/p&gt;

&lt;p&gt;returns /sessions/v1/ab483cd8283ef274&lt;/p&gt;

&lt;p&gt;notice the session TOKEN is a randomly generated key - this allows for some &quot;security through obscurity&quot; as it&apos;s &quot;hard to guess&quot; and is some small measure of security. session keepalive and delete would operate on this url. GET on the url might return the original session id for example&lt;/p&gt;

&lt;p&gt;create an ephemeral node - POST /sessions/v1/ab483cd8283ef274/znodes/v1/a/b?op=create&amp;amp;name=c&amp;amp;ephemeral=true HTTP/1.1&lt;/p&gt;

&lt;p&gt;you might keep the /znodes feature as-is for those not wanting to use sessions (admin r/o console say, or cli tool), however you might want to make turning it off an option - allowing the operator to force users to use explicit sessions&lt;/p&gt;

&lt;p&gt;notice how this also cleans up items 5/6 wrt the url used to access (same prefix in both cases)&lt;/p&gt;

&lt;p&gt;when you add acl support you might add something like:&lt;/p&gt;

&lt;p&gt;/sessions/v1/ab483cd8283ef274/auth/...&lt;/p&gt;

&lt;p&gt;resource for managing them (add auth for example). I think you&apos;d have to require SSL to make this secure..., and return some security token good for the session so that someone else can&apos;t impersonate you... etc...&lt;/p&gt;
</comment>
                            <comment id="12895227" author="savu.andrei" created="Wed, 4 Aug 2010 12:49:19 +0100"  >
&lt;p&gt;This patch contains:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;basic support for sessions ( create: POST /sessions/v1?op=create&amp;amp;expire=SECONDS, delete: DELETE /sessions/v1/&amp;lt;ID&amp;gt;, heartbeat: PUT /sessions/v1/&amp;lt;ID&amp;gt; )&lt;/li&gt;
	&lt;li&gt;support for ephemeral nodes: create: POST /znodes/v1/a/b?op=create&amp;amp;name=c&amp;amp;ephemeral=true&amp;amp;session=ID&lt;/li&gt;
	&lt;li&gt;experimental (almost complete) python REST client&lt;/li&gt;
	&lt;li&gt;demos: demo_master_election.py &amp;amp; demo_queue.py&lt;/li&gt;
	&lt;li&gt;updated specs&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;m not going to implement watches now because they are not useful if the client pulls the server for changes.  &lt;/p&gt;

&lt;p&gt;Working on: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;configuration, ACLs and basic authentication&lt;/li&gt;
	&lt;li&gt;packaging - I want to be able to run the REST gateway as a task managed by the Hue &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; supervisor.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I would really like to get more feedback from you regarding this patch. Thanks. &lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://github.com/cloudera/hue&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://github.com/cloudera/hue&lt;/a&gt; &lt;/p&gt;
</comment>
                            <comment id="12895571" author="phunt" created="Thu, 5 Aug 2010 07:54:52 +0100"  >&lt;p&gt;Looks good to me. python and java tests are a nice touch.&lt;/p&gt;

&lt;p&gt;A few nits:&lt;/p&gt;

&lt;p&gt;spec:&lt;br/&gt;
succesful -&amp;gt; successful&lt;br/&gt;
adition -&amp;gt; additional&lt;br/&gt;
any detail on the session uuid? format and valid characters? min/max length?&lt;br/&gt;
why is session expired 503? would 400 be better?&lt;/p&gt;

&lt;p&gt;code:&lt;br/&gt;
80char max&lt;br/&gt;
try not to reformat existing code unless you&apos;re changing something in that area. makes it hard to review and confuses &quot;blame&quot; information&lt;/p&gt;</comment>
                            <comment id="12895574" author="savu.andrei" created="Thu, 5 Aug 2010 08:03:25 +0100"  >&lt;p&gt;Thanks Patrick for reviewing the patch. I will fix those issues ASAP. &lt;/p&gt;

&lt;p&gt;Sorry about reformatting existing code, I&apos;ve used the Eclipse Format tool and only latter I&apos;ve realized that it changes the whole file. &lt;/p&gt;</comment>
                            <comment id="12895704" author="savu.andrei" created="Thu, 5 Aug 2010 15:58:12 +0100"  >&lt;p&gt;Changes in this patch:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;ZooKeeperService&lt;/tt&gt; now uses the servlet context path and not full URI as a key for retrieving ZooKeeper connections&lt;/li&gt;
	&lt;li&gt;added a configuration file: conf/rest.properties&lt;/li&gt;
	&lt;li&gt;added support for multiple endpoints: /cluster1, /cluster2 - useful if you have multiple ZooKeeper clusters&lt;/li&gt;
	&lt;li&gt;HTTPS support&lt;/li&gt;
	&lt;li&gt;HTTP Basic Authentication&lt;/li&gt;
	&lt;li&gt;shutdownHook for cleanup&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;m still working on: packaging, ACLs &amp;amp; ZooKeeper Authentication &lt;/p&gt;

&lt;p&gt;I will finish the packaging ant task tomorrow and next week (after the GSoC &quot;soft&quot; deadline) I will also add support for ACLs and Authentication.&lt;/p&gt;

&lt;p&gt;Let me know what you think. Thanks. &lt;/p&gt;</comment>
                            <comment id="12896034" author="savu.andrei" created="Fri, 6 Aug 2010 14:46:49 +0100"  >&lt;p&gt;In this patch:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;ant task for packaging: just run &lt;tt&gt;ant tar&lt;/tt&gt; and it will generate &lt;tt&gt;zookeeper-dev-rest.tar.gz&lt;/tt&gt; in &lt;tt&gt;build/contrib/rest/&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;basic script for starting and stopping the REST gateway - &lt;tt&gt;bin/restServer.sh&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Remaining: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;ACLs &amp;amp; ZooKeeper Authentication - after GSoC &quot;soft&quot; deadline&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;All tests are passing, including the ones from the new python client test suite.&lt;/p&gt;
</comment>
                            <comment id="12898154" author="savu.andrei" created="Fri, 13 Aug 2010 10:39:59 +0100"  >&lt;p&gt;In this patch I&apos;ve added:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;a bunch of classes for parsing the configuration file&lt;/li&gt;
	&lt;li&gt;per context HTTP Digest authentication settings&lt;/li&gt;
	&lt;li&gt;per context ZooKeeper digest authentication settings&lt;/li&gt;
	&lt;li&gt;support for chroot when parsing the hostPort string&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;By using these features you can easily create secure channels from your application to ZooKeeper ( HTTPS + Digest Authentication + ZK Auth + chroot). It doesn&apos;t support the whole API but it should be really useful for configuration management. &lt;/p&gt;

&lt;p&gt;Working on:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;support for ACLs: read and update&lt;/li&gt;
	&lt;li&gt;per session ZooKeeper authentication&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Sample config for a channel:&lt;/p&gt;

&lt;p&gt;rest.port = 9998&lt;/p&gt;

&lt;p&gt;rest.endpoint.1 = /channel;localhost:2181,localhost:2182,localhost:2183/app&lt;br/&gt;
rest.endpoint.1.http.auth = user:pass,user2:pass2&lt;br/&gt;
rest.endpoint.1.zk.digest = appuser:pass&lt;/p&gt;

&lt;p&gt;.. you should also enable SSL because the browser sends the password as plain text&lt;/p&gt;

&lt;p&gt;rest.ssl = true&lt;br/&gt;
rest.ssl.jks = keys/rest.jks&lt;br/&gt;
rest.ssl.jks.pass = 123456&lt;/p&gt;</comment>
                            <comment id="12899273" author="phunt" created="Tue, 17 Aug 2010 06:12:52 +0100"  >&lt;p&gt;This looks good, a few issues to address:&lt;/p&gt;

&lt;p&gt;1) add license to HTTPBasicAuth.java&lt;/p&gt;

&lt;p&gt;2) replace tabs with spaces for indentation (check the resulting patch file for any tabs)&lt;/p&gt;

&lt;p&gt;3) the diff is missing binaries for:&lt;/p&gt;

&lt;p&gt;:000000 100644 0000000... 13e5aab... A	src/contrib/rest/conf/keys/rest.cer&lt;br/&gt;
:000000 100644 0000000... 539e8be... A	src/contrib/rest/conf/keys/rest.jks&lt;/p&gt;
</comment>
                            <comment id="12899280" author="savu.andrei" created="Tue, 17 Aug 2010 06:27:59 +0100"  >&lt;p&gt;I&apos;ve added the license header to &lt;tt&gt;HTTPBasicAuth.java&lt;/tt&gt;, removed all the tabs and added dummy self-signed keys to &lt;tt&gt;keys.tar.gz&lt;/tt&gt; ( should be extracted to &lt;tt&gt;conf/keys&lt;/tt&gt; folder ). &lt;/p&gt;

&lt;p&gt;Thanks Patrick for reviewing. &lt;/p&gt;</comment>
                            <comment id="12899307" author="phunt" created="Tue, 17 Aug 2010 07:54:39 +0100"  >&lt;p&gt;ant test in src/contrib/rest is failing:&lt;/p&gt;

&lt;p&gt;compile-test:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 11 source files to /home/phunt/dev/workspace/svn_zookeeper/build/contrib/rest/test&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; /home/phunt/dev/workspace/svn_zookeeper/src/contrib/rest/src/test/org/apache/zookeeper/server/jersey/Base.java:62: mapContext(java.lang.String,org.apache.zookeeper.server.jersey.cfg.Endpoint) in org.apache.zookeeper.server.jersey.ZooKeeperService cannot be applied to (java.lang.String,java.lang.String)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;        ZooKeeperService.mapContext(CONTEXT_PATH, ZKHOSTPORT);&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;                        ^&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; 1 error&lt;/p&gt;</comment>
                            <comment id="12899310" author="savu.andrei" created="Tue, 17 Aug 2010 08:07:51 +0100"  >&lt;ul&gt;
	&lt;li&gt;fixed &lt;tt&gt;text/Base.java&lt;/tt&gt; broken by refactoring &lt;tt&gt;ZooKeeperService&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;all junit tests are now passing&lt;/li&gt;
	&lt;li&gt;all python tests are now passing&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12899312" author="phunt" created="Tue, 17 Aug 2010 08:26:03 +0100"  >&lt;p&gt;+1, looks great Andrei, thanks!&lt;/p&gt;</comment>
                            <comment id="12899369" author="hudson" created="Tue, 17 Aug 2010 11:50:56 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #907 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/ZooKeeper-trunk/907/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/ZooKeeper-trunk/907/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-809&quot; title=&quot;Improved REST Interface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-809&quot;&gt;&lt;del&gt;ZOOKEEPER-809&lt;/del&gt;&lt;/a&gt;. Improved REST Interface&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12468975">ZOOKEEPER-808</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12458993">ZOOKEEPER-701</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12451219" name="SPEC.txt" size="12957" author="savu.andrei" created="Wed, 4 Aug 2010 12:49:19 +0100"/>
                            <attachment id="12449455" name="SPEC.txt" size="14322" author="savu.andrei" created="Wed, 14 Jul 2010 15:11:12 +0100"/>
                            <attachment id="12452259" name="ZOOKEEPER-809.patch" size="114804" author="savu.andrei" created="Tue, 17 Aug 2010 08:07:51 +0100"/>
                            <attachment id="12452253" name="ZOOKEEPER-809.patch" size="114918" author="savu.andrei" created="Tue, 17 Aug 2010 06:27:58 +0100"/>
                            <attachment id="12452009" name="ZOOKEEPER-809.patch" size="111793" author="savu.andrei" created="Fri, 13 Aug 2010 10:39:59 +0100"/>
                            <attachment id="12451424" name="ZOOKEEPER-809.patch" size="100933" author="savu.andrei" created="Fri, 6 Aug 2010 14:46:48 +0100"/>
                            <attachment id="12451335" name="ZOOKEEPER-809.patch" size="97939" author="savu.andrei" created="Thu, 5 Aug 2010 15:58:11 +0100"/>
                            <attachment id="12451218" name="ZOOKEEPER-809.patch" size="69116" author="savu.andrei" created="Wed, 4 Aug 2010 12:49:19 +0100"/>
                            <attachment id="12452254" name="keys.tar.gz" size="1629" author="savu.andrei" created="Tue, 17 Aug 2010 06:27:59 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 14 Jul 2010 16:01:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47587</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzxbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33384</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>