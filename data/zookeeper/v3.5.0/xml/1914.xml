<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:45:09 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-1914/ZOOKEEPER-1914.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-1914] TestWatchers.cc failure</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-1914</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2051/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2051/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;      &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; /home/jenkins/jenkins-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/src/c/tests/TestWatchers.cc:667: Assertion: assertion failed &lt;span class=&quot;error&quot;&gt;&amp;#91;Expression: ensureCondition( deliveryTracker.deliveryCounterEquals(2),1000)&amp;lt;1000&amp;#93;&lt;/span&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12709364">ZOOKEEPER-1914</key>
            <summary>TestWatchers.cc failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="michim">Michi Mutsuzaki</assignee>
                                    <reporter username="michim">Michi Mutsuzaki</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Apr 2014 23:51:56 +0100</created>
                <updated>Sat, 11 Apr 2015 23:02:24 +0100</updated>
                                                            <fixVersion>3.5.2</fixVersion>
                    <fixVersion>3.6.0</fixVersion>
                                    <component>c client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13975014" author="michim" created="Sun, 20 Apr 2014 02:39:15 +0100"  >&lt;p&gt;I can reproduce this failure pretty consistently on my setup. The problem seems to be that the client somehow starts trying to connect to port 22181, which is the standalone server port. TestWatchers.cc uses the mock server, so it&apos;s not supposed to connect to the standalone port. This failure doesn&apos;t happen if I run only TestWatchers, so I&apos;m guessing something is not getting destroyed properly in some other test. &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2014-04-19 18:18:38,543:31200(0x7f0c51437740):ZOO_INFO@zookeeper_init_internal@1008: Initiating client connection, host=localhost:2121 sessionTimeout=10000 watcher=0x40b360 sessionId=0x75bcd15 sessionPasswd=&amp;lt;hidden&amp;gt; context=0x7fff1cfa30e0 flags=0
2014-04-19 18:18:38,543:31200(0x7f0c4ef8b700):ZOO_INFO@check_events@2105: initiated connection to server [127.0.0.1:2121]
2014-04-19 18:18:38,543:31200(0x7f0c4ef8b700):ZOO_INFO@check_events@2153: session establishment complete on server [127.0.0.1:2121], sessionId=0x75bcd15, negotiated timeout=10000
2014-04-19 18:18:38,543:31200(0x7f0c3dffb700):ZOO_INFO@check_events@2105: initiated connection to server [127.0.0.1:22181]
2014-04-19 18:18:38,543:31200(0x7f0c3dffb700):ZOO_ERROR@handle_socket_error_msg@2123: Socket [127.0.0.1:22181] zk retcode=-4, errno=112(Host is down): failed while receiving a server response
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13975070" author="michim" created="Sun, 20 Apr 2014 07:45:58 +0100"  >&lt;p&gt;TestWatchers.cc fails once in a while because the leaked clients from TestClient.cc interfere with TestWatchers.cc. This patch reorders the tests so that TestWatchers.cc runs before TestClient.cc.&lt;/p&gt;

&lt;p&gt;The real fix would be to fix TestClient.cc to clean up the client handles.&lt;/p&gt;</comment>
                            <comment id="13975071" author="hadoopqa" created="Sun, 20 Apr 2014 08:24:18 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12640976/ZOOKEEPER-1914.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12640976/ZOOKEEPER-1914.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1588584.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2053//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2053//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2053//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2053//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2053//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2053//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13999388" author="hadoopqa" created="Fri, 16 May 2014 00:18:01 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12640976/ZOOKEEPER-1914.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12640976/ZOOKEEPER-1914.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1595038.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2093//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2093//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2093//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2093//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2093//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/2093//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14001045" author="fpj" created="Sun, 18 May 2014 10:40:00 +0100"  >&lt;p&gt;Have you tried to clean the handles in TestClient? Let me have a look, it sounds better to do the real fix rather than reordering.&lt;/p&gt;</comment>
                            <comment id="14001086" author="fpj" created="Sun, 18 May 2014 14:50:40 +0100"  >&lt;p&gt;What about this?&lt;/p&gt;</comment>
                            <comment id="14001301" author="michim" created="Mon, 19 May 2014 01:50:47 +0100"  >&lt;p&gt;Sorry I should have mentioned earlier, I tried something similar to your patch, but then some tests just hung, and I didn&apos;t look into it any further.&lt;/p&gt;

&lt;p&gt;Maybe we can check in the patch that reorders the test to make the build green, and keep this JIRA open to fix the actual problem.&lt;/p&gt;</comment>
                            <comment id="14001893" author="fpj" created="Mon, 19 May 2014 16:29:36 +0100"  >&lt;p&gt;yeah, it hangs for me too. let&apos;s do it as you suggest.&lt;/p&gt;</comment>
                            <comment id="14005236" author="fpj" created="Wed, 21 May 2014 22:04:57 +0100"  >&lt;p&gt;I have committed the patch that changes the order of the tests and stated in the comment that this is a workaround. I&apos;m leaving this issue open though. Committed revision 1596684.&lt;/p&gt;</comment>
                            <comment id="14005356" author="hudson" created="Wed, 21 May 2014 23:54:42 +0100"  >&lt;p&gt;SUCCESS: Integrated in ZooKeeper-trunk #2312 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/2312/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/2312/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1914&quot; title=&quot;TestWatchers.cc failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1914&quot;&gt;ZOOKEEPER-1914&lt;/a&gt;. TestWatchers.cc failure - workaround (michim via fpj) (fpj: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1596684&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1596684&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/src/c/Makefile.am&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14066775" author="phunt" created="Fri, 18 Jul 2014 20:37:30 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;Flavio Junqueira&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michim&quot; class=&quot;user-hover&quot; rel=&quot;michim&quot;&gt;Michi Mutsuzaki&lt;/a&gt; What&apos;s the status on this? Should it be patch available or is it still being worked on?&lt;/p&gt;</comment>
                            <comment id="14066898" author="michim" created="Fri, 18 Jul 2014 22:21:51 +0100"  >&lt;p&gt;We reordered the test so that we don&apos;t hit this issue, but the real fix would be to do a proper cleanup after each test. I think we should keep this open, but it can be pushed out to 3.5.1.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12645462" name="ZOOKEEPER-1914-draft.patch" size="10343" author="fpj" created="Sun, 18 May 2014 14:50:40 +0100"/>
                            <attachment id="12640976" name="ZOOKEEPER-1914.patch" size="417" author="michim" created="Sun, 20 Apr 2014 07:45:58 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 20 Apr 2014 07:24:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>387686</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzon1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>387947</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>