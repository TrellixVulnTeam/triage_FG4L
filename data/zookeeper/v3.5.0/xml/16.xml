<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:45:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-16/ZOOKEEPER-16.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-16] Need to do path validation</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-16</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;Moved from SourceForge to Apache.&lt;br/&gt;
&lt;a href=&quot;http://sourceforge.net/tracker/index.php?func=detail&amp;amp;aid=1963141&amp;amp;group_id=209147&amp;amp;atid=1008544&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://sourceforge.net/tracker/index.php?func=detail&amp;amp;aid=1963141&amp;amp;group_id=209147&amp;amp;atid=1008544&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12397975">ZOOKEEPER-16</key>
            <summary>Need to do path validation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="phunt">Patrick Hunt</assignee>
                                    <reporter username="phunt">Patrick Hunt</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Jun 2008 22:17:18 +0100</created>
                <updated>Fri, 13 Feb 2009 21:18:48 +0000</updated>
                            <resolved>Sat, 31 Jan 2009 01:27:39 +0000</resolved>
                                    <version>3.0.0</version>
                    <version>3.0.1</version>
                                    <fixVersion>3.1.0</fixVersion>
                                    <component>c client</component>
                    <component>java client</component>
                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12605379" author="phunt" created="Mon, 16 Jun 2008 20:01:43 +0100"  >&lt;p&gt;Ben please document the spec for this and reassign to Andrew for implementation.&lt;/p&gt;

&lt;p&gt;Needs to be implemented in both c and java clients.&lt;/p&gt;</comment>
                            <comment id="12605385" author="breed" created="Mon, 16 Jun 2008 20:22:15 +0100"  >&lt;p&gt;The following characters cannot be used because they don&apos;t display well (or render in confusing ways):&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;overlong encodings&lt;/li&gt;
	&lt;li&gt;\u0000 (we use null terminated strings!)&lt;/li&gt;
	&lt;li&gt;\u0001-\u0019,\u00-\u009F.&lt;/li&gt;
	&lt;li&gt;&apos;.&apos; and &apos;..&apos; cannot be path elements. For example, the following would be invalid paths &apos;/a/b/./c&apos; and &apos;/a/b/../c&apos;.  (This could result in confusion since ZooKeeper does not use relative references.)&lt;/li&gt;
	&lt;li&gt;The following characters are also not valid for use \ud800-\uf8ff, \ufff0-\uffff, \uXfffe-\uXffff (where X is 1 to e), \uf0000-\ufffff&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Any of these violations should result in an error, decoding should stop, and an exception thrown or error returned.&lt;/p&gt;</comment>
                            <comment id="12605409" author="mahadev" created="Mon, 16 Jun 2008 22:02:01 +0100"  >&lt;p&gt;one thing i just realized is that &amp;#8211; &lt;/p&gt;

&lt;p&gt;is /user/mahadev//test == /user/mahadev/test in Zookeeper?&lt;/p&gt;

&lt;p&gt;We do raw string comparison. So i think the above is false. &lt;/p&gt;
</comment>
                            <comment id="12605420" author="phunt" created="Mon, 16 Jun 2008 23:04:31 +0100"  >&lt;p&gt;What do we want it to be? A NOP (they are equal as in bash) or an error? Error might be easier to deal with (simplifies equality test/path processing) and could be an indication of &quot;code smell&quot; anyway (ie error in the client path consing code). My personal pref would be error.&lt;/p&gt;
</comment>
                            <comment id="12605490" author="mahadev" created="Tue, 17 Jun 2008 05:00:42 +0100"  >&lt;p&gt;what i menat was ... a client doing &lt;/p&gt;

&lt;p&gt;get on /user/mahadev/test &lt;br/&gt;
and a get on /user/mahadev//test.&lt;br/&gt;
usually any filesystem like namespace handles this and would return the same thing.&lt;/p&gt;

&lt;p&gt;an error is fine ... this has nothing to do with this jira. Sorry abt the comment. &lt;/p&gt;
</comment>
                            <comment id="12605619" author="breed" created="Tue, 17 Jun 2008 15:28:51 +0100"  >&lt;p&gt;I agree it should be (and for that example will be) an error. All valid paths are canonical paths.&lt;/p&gt;</comment>
                            <comment id="12614016" author="phunt" created="Wed, 16 Jul 2008 17:42:11 +0100"  >&lt;p&gt;Are we validating that the path is not null?&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-77&quot; title=&quot;NPE in jute toCSVString code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-77&quot;&gt;&lt;del&gt;ZOOKEEPER-77&lt;/del&gt;&lt;/a&gt; which seems to be throwing an NPE due to null path.&lt;/p&gt;</comment>
                            <comment id="12626228" author="phunt" created="Wed, 27 Aug 2008 19:29:55 +0100"  >&lt;p&gt;As part of this fix we need to verify that the patch specified by the user is non-null.&lt;/p&gt;</comment>
                            <comment id="12655017" author="phunt" created="Tue, 9 Dec 2008 23:42:12 +0000"  >&lt;p&gt;this patch starts to validate the path, but quickly runs into an issue.&lt;/p&gt;

&lt;p&gt;create(//sync) handles validation fine, we throw KeeperException.BadArgumentException&lt;/p&gt;

&lt;p&gt;however create(//async) is not declared to throw KeeperException&lt;/p&gt;

&lt;p&gt;we can call the async callback handler with rc code of BadArgument, however this is suboptimal, it would be much better to throw an exception right away. We lose the error message as well (contained by the exception)&lt;/p&gt;

&lt;p&gt;our best option afiak is to deprecate the current async methods and create new async methods which throw KE and have &quot;Path path&quot; arguments instead of &quot;String path&quot; arguments. We could validate the path when Path is created (a new zk type), also passing around Path objects might allow us to optimize serialization/deser during the marshalling stages.&lt;/p&gt;

&lt;p&gt;It really is unfortunate that the async methods aren&apos;t declared to throw KeeperException, adding this would allow error handling flexibility in future (perhaps some other error type we haven&apos;t throught of, separate from path validation).&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="12655043" author="breed" created="Wed, 10 Dec 2008 00:43:32 +0000"  >&lt;p&gt;We could throw an IllegalArgumentException, then the API wouldn&apos;t be a problem. Arguably an invalid path is along the same lines as a null pointer. (Especially given that a null path is an invalid case.)&lt;/p&gt;

&lt;p&gt;If we want to make it a checked exception we should throw BadArgumentException and not KeeperException. The async methods have the nice property that you don&apos;t have to worry about KeeperExceptions happening. Any exceptions will come through the callback. It is a pain to have to handle exceptions in two places: once when you make the call and again when you get the callback.&lt;/p&gt;</comment>
                            <comment id="12655059" author="mahadev" created="Wed, 10 Dec 2008 01:26:21 +0000"  >&lt;p&gt;I like Illegalargumentexception... we dont have to throw a checked exception.... the application should not be using invalid paths for creating zookeeper nodes, so i am fine with illegalargument exceptions.&lt;/p&gt;</comment>
                            <comment id="12655066" author="phunt" created="Wed, 10 Dec 2008 01:39:35 +0000"  >&lt;p&gt;Hm, I didn&apos;t think of IAE, that&apos;s a good idea. I didn&apos;t know about the concept of not having checked excep on async either, that&apos;s an interesting idea. Can we document that somewhere? perhaps the internals documentation in forrest?&lt;/p&gt;

&lt;p&gt;I&apos;ll update the patch to use IAE.&lt;/p&gt;</comment>
                            <comment id="12655322" author="phunt" created="Wed, 10 Dec 2008 19:17:53 +0000"  >&lt;p&gt;Updated patch based on comment/feedback.&lt;/p&gt;

&lt;p&gt;We now throw IllegalArgumentException in the java client if the path is not valid&lt;br/&gt;
In the c client we return a rc of ZBADARGUMENT (c client was already checking for null - just added the addl conditions)&lt;/p&gt;

&lt;p&gt;Tests added to both c and java.&lt;/p&gt;

&lt;p&gt;Note: valid path definition already existed in the programmer guide, no additional doc changes were necessary &amp;#8211; although I did update the java and c client API docs as appropriate.&lt;/p&gt;</comment>
                            <comment id="12667245" author="fpj" created="Mon, 26 Jan 2009 13:41:30 +0000"  >&lt;p&gt;I went over the patch and it looks good to me, although it is stale and I couldn&apos;t apply it to trunk. Also, one question I have is why you don&apos;t have to declare all methods in ZooKeeper.java that invoke validatePath as throwing IllegalArgumentException.&lt;/p&gt;

&lt;p&gt;I&apos;m canceling the patch for now.&lt;/p&gt;

&lt;p&gt;(Never mind about the comment on IllegalArgumentException. I just found out the reason: it is an unchecked exception.)&lt;/p&gt;</comment>
                            <comment id="12667246" author="fpj" created="Mon, 26 Jan 2009 13:41:47 +0000"  >&lt;p&gt;Patch is stale.&lt;/p&gt;</comment>
                            <comment id="12667863" author="phunt" created="Tue, 27 Jan 2009 23:36:13 +0000"  >&lt;p&gt;Remerged against the mainline.&lt;/p&gt;

&lt;p&gt;Not declaring throws IAE because it&apos;s a runtime exception - but I did document in the javadoc for the effected methods.&lt;/p&gt;</comment>
                            <comment id="12668760" author="breed" created="Fri, 30 Jan 2009 05:50:41 +0000"  >&lt;p&gt;The patch looks good. there are two issues that i see:&lt;/p&gt;

&lt;p&gt;1) we don&apos;t validate the path at the server. in some sense that is the most important place to do it. we need to put checks into PrepRequestProcessor and FinalRequestProcessor.&lt;br/&gt;
2) the check for C may give false positives for unicode characters. if the server check is in place, we can probably just make the client do the obvious check: c &amp;gt; 0x00 &amp;amp;&amp;amp; c &amp;lt; 0x1f and then let the server catch the rest.&lt;/p&gt;</comment>
                            <comment id="12668995" author="mahadev" created="Fri, 30 Jan 2009 19:44:39 +0000"  >&lt;p&gt;i think the we should avoid doing more work at the server and let the client handle the path checking. Doing this check in the PrepRequestPRocessor will have performance impact. On the other hand we could do some minor chekcing on the server to see if the path is null, starts with / and others... &lt;/p&gt;

&lt;p&gt;we can open up another jira for path validation on server side if you feel strongly abt it.&lt;/p&gt;

&lt;p&gt;for 2) &lt;br/&gt;
their should be some client c libarary that should catch unicode characters .. again we can open another jira for that. for now we can go with this... &lt;/p&gt;</comment>
                            <comment id="12668997" author="mahadev" created="Fri, 30 Jan 2009 19:51:38 +0000"  >&lt;p&gt;well thinking abt it more ... &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if we just do a check for path in &quot;create&quot; in prep requestprocessor then it should not be a performance impact&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12669000" author="phunt" created="Fri, 30 Jan 2009 19:54:12 +0000"  >&lt;p&gt;Included Ben&apos;s suggestion regarding c client check.&lt;br/&gt;
Also fixed a test broken by other commit.&lt;/p&gt;</comment>
                            <comment id="12669067" author="mahadev" created="Fri, 30 Jan 2009 22:58:33 +0000"  >&lt;p&gt;this patch adds the check at the server only on create. also added a test ot verify it,&lt;/p&gt;</comment>
                            <comment id="12669071" author="mahadev" created="Fri, 30 Jan 2009 23:02:08 +0000"  >&lt;p&gt;I just committed this. Thanks pat.&lt;/p&gt;</comment>
                            <comment id="12669113" author="phunt" created="Sat, 31 Jan 2009 01:27:38 +0000"  >&lt;p&gt;Committed revision 739446.&lt;br/&gt;
(closing on behalf of mahadev who committed this)&lt;/p&gt;</comment>
                            <comment id="12669567" author="hudson" created="Mon, 2 Feb 2009 11:49:18 +0000"  >&lt;p&gt;Integrated in ZooKeeper-trunk #217 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/217/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/217/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12400389">ZOOKEEPER-77</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12399175" name="ZOOKEEPER-16.patch" size="25426" author="mahadev" created="Fri, 30 Jan 2009 22:58:33 +0000"/>
                            <attachment id="12399154" name="ZOOKEEPER-16.patch" size="23893" author="phunt" created="Fri, 30 Jan 2009 19:54:12 +0000"/>
                            <attachment id="12398856" name="ZOOKEEPER-16.patch" size="23910" author="phunt" created="Tue, 27 Jan 2009 23:36:13 +0000"/>
                            <attachment id="12395752" name="ZOOKEEPER-16.patch" size="32911" author="phunt" created="Wed, 10 Dec 2008 19:17:53 +0000"/>
                            <attachment id="12395689" name="ZOOKEEPER-16.patch" size="3746" author="phunt" created="Tue, 9 Dec 2008 23:42:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 16 Jun 2008 19:22:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>48106</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzwkf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33260</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>