<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:49:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-1670/ZOOKEEPER-1670.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-1670] zookeeper should set a default value for SERVER_JVMFLAGS and CLIENT_JVMFLAGS so that memory usage is controlled</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-1670</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;We noticed this with jdk 1.6 where if no heap size is set the process takes up to 1/4 of mem available on the machine.&lt;/p&gt;

&lt;p&gt;More info &lt;a href=&quot;http://stackoverflow.com/questions/3428251/is-there-a-default-xmx-setting-for-java-1-5&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://stackoverflow.com/questions/3428251/is-there-a-default-xmx-setting-for-java-1-5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can run the following command to see what are the defaults for your machine&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java -XX:+PrintFlagsFinal -version 2&amp;gt;&amp;amp;1 | grep -i -E &apos;heapsize|permsize|version&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And we noticed on two different class of machines that this was 1/4th of total memory on the machine.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12637274">ZOOKEEPER-1670</key>
            <summary>zookeeper should set a default value for SERVER_JVMFLAGS and CLIENT_JVMFLAGS so that memory usage is controlled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fpj">Flavio Junqueira</assignee>
                                    <reporter username="arpitgupta">Arpit Gupta</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Mar 2013 21:36:54 +0000</created>
                <updated>Tue, 1 Oct 2013 22:32:01 +0100</updated>
                            <resolved>Tue, 1 Oct 2013 22:32:01 +0100</resolved>
                                    <version>3.4.5</version>
                                    <fixVersion>3.5.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13603918" author="arpitgupta" created="Fri, 15 Mar 2013 22:11:29 +0000"  >&lt;p&gt;Here is a simple patch that sets the default to 1G&lt;/p&gt;</comment>
                            <comment id="13603951" author="hadoopqa" created="Fri, 15 Mar 2013 22:54:50 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12573957/ZOOKEEPER-1670.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12573957/ZOOKEEPER-1670.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1455387.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1430//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1430//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1430//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1430//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1430//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1430//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13603955" author="arpitgupta" created="Fri, 15 Mar 2013 22:58:13 +0000"  >&lt;p&gt;No tests added but manually started a server and if not defined it started with 1G heap. When i set SERVER_JVMFLAGS and started the server it picked up what i set.&lt;/p&gt;</comment>
                            <comment id="13606829" author="enis" created="Tue, 19 Mar 2013 21:18:31 +0000"  >&lt;p&gt;The patch looks good, but I am wondering whether it makes sense to add a default conf/zookeeper-env.sh, and add the default there. bin/zkEnv.sh roughly corresponds to bin/hadoop-config.sh, and conf/zookeeper-env.sh roughly corresponds to conf/hadoop-env.sh from my understanding. &lt;/p&gt;</comment>
                            <comment id="13606860" author="arpitgupta" created="Tue, 19 Mar 2013 21:32:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The problem with zookeeper-env.sh is that people can replace the default configs. So i think the check should be in zkEnv.sh&lt;/p&gt;

&lt;p&gt;However another problem exists where SERVER_JVMFLAGS is also used to set the jaas configuration file. I feel we need to introduce another variable called ZK_SERVER_HEAP which defaults to 1G and we set the SERVER_JVMFLAGS=&quot;$ZK_SERVER_HEAP $SERVER_JVMFLAGS&quot;&lt;/p&gt;

&lt;p&gt;That way any existing settings user do for heap size still works but will default to 1G if nothing is found.&lt;/p&gt;</comment>
                            <comment id="13606868" author="arpitgupta" created="Tue, 19 Mar 2013 21:40:01 +0000"  >&lt;p&gt;attached a patch with the new approach.&lt;/p&gt;</comment>
                            <comment id="13606916" author="hadoopqa" created="Tue, 19 Mar 2013 22:15:17 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12574412/ZOOKEEPER-1670.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12574412/ZOOKEEPER-1670.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1458356.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1435//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1435//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1435//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1435//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1435//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1435//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13606963" author="enis" created="Tue, 19 Mar 2013 22:40:23 +0000"  >&lt;p&gt;I&apos;ve looked at how we do it for HBase as a reference: &lt;/p&gt;

&lt;p&gt;Mainly, we define HBASE_HEAPSIZE in conf/hbase-env.sh, but commented out: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
# The maximum amount of heap to use, in MB. Default is 1000.
# export HBASE_HEAPSIZE=1000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And in actual bin/hbase script that we do append Xmx, and have a default value: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
JAVA_HEAP_MAX=-Xmx1000m&#183;
...
# check envvars which might override &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; args
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [ &lt;span class=&quot;code-quote&quot;&gt;&quot;$HBASE_HEAPSIZE&quot;&lt;/span&gt; != &quot;&quot; ]; then
  #echo &lt;span class=&quot;code-quote&quot;&gt;&quot;run with heapsize $HBASE_HEAPSIZE&quot;&lt;/span&gt;
  JAVA_HEAP_MAX=&lt;span class=&quot;code-quote&quot;&gt;&quot;-Xmx&quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;$HBASE_HEAPSIZE&quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;m&quot;&lt;/span&gt;
  #echo $JAVA_HEAP_MAX
fi
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13624074" author="arpitgupta" created="Fri, 5 Apr 2013 22:19:29 +0100"  >&lt;p&gt;Updated the patch to be similar to what Hadoop and HBase do.&lt;/p&gt;

&lt;p&gt;Also added the default to the client as well.&lt;/p&gt;</comment>
                            <comment id="13624107" author="hadoopqa" created="Fri, 5 Apr 2013 22:55:36 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12577295/ZOOKEEPER-1670.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12577295/ZOOKEEPER-1670.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1463329.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1443//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1443//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1443//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1443//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1443//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1443//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13625627" author="enis" created="Mon, 8 Apr 2013 19:17:35 +0100"  >&lt;p&gt;This looks good. Should we add this to the .cmd files as well? &lt;/p&gt;</comment>
                            <comment id="13625662" author="arpitgupta" created="Mon, 8 Apr 2013 19:54:03 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I can make the change but i dont have the HW to test it out. Let me know. Also been debating this.. do we want different default env vars for server and client? If they are different you can have the same config on the client and the server machines.&lt;/p&gt;</comment>
                            <comment id="13625821" author="enis" created="Mon, 8 Apr 2013 22:14:12 +0100"  >&lt;blockquote&gt;&lt;p&gt;I can make the change but i dont have the HW to test it out&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I can test it. &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;do we want different default env vars for server and client?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;From what it seems, CLIENT only refers to zkCli. We do not need a huge heap for that. Are you thinking of ZOOKEEPER_CLIENT_HEAPSIZE and ZOOKEEPER_SERVER_HEAPSIZE? &lt;/p&gt;</comment>
                            <comment id="13625825" author="arpitgupta" created="Mon, 8 Apr 2013 22:17:32 +0100"  >&lt;p&gt;Yes thats what i am thinking. I was going to default both to 1G but i can make the default for the client smaller. Let me know how much you think we should set the default to.&lt;/p&gt;</comment>
                            <comment id="13625899" author="arpitgupta" created="Mon, 8 Apr 2013 23:09:26 +0100"  >&lt;p&gt;Created ZK_CLIENT_HEAP default of 256m and ZK_SERVER_HEAP default of 100m&lt;/p&gt;</comment>
                            <comment id="13625926" author="hadoopqa" created="Mon, 8 Apr 2013 23:45:46 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12577635/ZOOKEEPER-1670.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12577635/ZOOKEEPER-1670.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1463329.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1449//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1449//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1449//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1449//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1449//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1449//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13625993" author="arpitgupta" created="Tue, 9 Apr 2013 00:52:05 +0100"  >&lt;p&gt;sorry for the noise.. here is a more optimized patch.&lt;/p&gt;

&lt;p&gt;Also did not generate a windows patch because the windows start scripts do not seem to be setting jvm flags.&lt;/p&gt;</comment>
                            <comment id="13626026" author="hadoopqa" created="Tue, 9 Apr 2013 01:35:51 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12577655/ZOOKEEPER-1670.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12577655/ZOOKEEPER-1670.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1463329.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1450//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1450//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1450//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1450//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1450//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1450//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13626064" author="enis" created="Tue, 9 Apr 2013 02:18:01 +0100"  >&lt;p&gt;Looks good to me. &lt;/p&gt;</comment>
                            <comment id="13753559" author="fpj" created="Thu, 29 Aug 2013 13:28:16 +0100"  >&lt;p&gt;+1, looks good to me. I&apos;ll create a jira for the jvm flags for windows start scripts.&lt;/p&gt;</comment>
                            <comment id="13756533" author="fpj" created="Tue, 3 Sep 2013 12:42:06 +0100"  >&lt;p&gt;Trunk: Committed revision 1519655.&lt;br/&gt;
b3.4: Committed revision 1519650.&lt;/p&gt;</comment>
                            <comment id="13756758" author="phunt" created="Tue, 3 Sep 2013 17:35:26 +0100"  >&lt;p&gt;I think we should revert this change:&lt;/p&gt;

&lt;p&gt;1) The original defaults were based on the JVM egonomics. To change things as this patch does, arbitrarily, might cause problems for some folks. If someone wants a specific value for the heap they should just specify it on the command line - I&apos;d be a lot more comfortable if we set the heap only when a user specified a value (it&apos;s ok to have specific env settings for this, just shouldn&apos;t have a default).&lt;/p&gt;

&lt;p&gt;2) Also many folks are already specifying the heap size using the command line &quot;SERVER_JVMFLAGS&quot; parameter. This change will now cause potential problems as the new defaults may override the SERVER_JVMFLAGS settings already in place.&lt;/p&gt;

</comment>
                            <comment id="13756762" author="arpitgupta" created="Tue, 3 Sep 2013 17:40:12 +0100"  >&lt;blockquote&gt;&lt;p&gt;Also many folks are already specifying the heap size using the command line &quot;SERVER_JVMFLAGS&quot; parameter. This change will now cause potential problems as the new defaults may override the SERVER_JVMFLAGS settings already in place.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I dont think this is true as SERVER_JVMFLAGS is at the end. So if you were specifying the heap size using SERVER_JVMFLAGS it should still be applied as the last heap size setting is what will be the picked up.&lt;/p&gt;</comment>
                            <comment id="13756768" author="phunt" created="Tue, 3 Sep 2013 17:44:46 +0100"  >&lt;p&gt;Also rather than patching this for specific issues we might want to think about it more in the large, esp wrt &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-545&quot; title=&quot;investigate use of realtime gc as the recommened default for server vm&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-545&quot;&gt;ZOOKEEPER-545&lt;/a&gt;. The default collector is really a poor setting for us at this point. (esp re stop-the-world collections)&lt;/p&gt;</comment>
                            <comment id="13757031" author="fpj" created="Tue, 3 Sep 2013 21:27:10 +0100"  >&lt;p&gt;Thanks for the feedback, Pat. I can really go either way, but given that this has been here for a long time and I have given time for folks to dispute my +1, I&apos;d rather not revert it unless you argue that this will really break things for our users. Is it acceptable to you that we keep it and discuss separately what you think is the best way to deal with it?&lt;/p&gt;</comment>
                            <comment id="13757660" author="hudson" created="Wed, 4 Sep 2013 12:07:14 +0100"  >&lt;p&gt;SUCCESS: Integrated in ZooKeeper-trunk #2044 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/2044/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/2044/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1670&quot; title=&quot;zookeeper should set a default value for SERVER_JVMFLAGS and CLIENT_JVMFLAGS so that memory usage is controlled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1670&quot;&gt;&lt;del&gt;ZOOKEEPER-1670&lt;/del&gt;&lt;/a&gt;. zookeeper should set a default value for SERVER_JVMFLAGS and CLIENT_JVMFLAGS so that memory usage is controlled (Arpit Gupta via fpj) (fpj: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1519655&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1519655&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/bin/zkEnv.sh&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13778725" author="fpj" created="Thu, 26 Sep 2013 13:42:08 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=phunt&quot; class=&quot;user-hover&quot; rel=&quot;phunt&quot;&gt;Patrick Hunt&lt;/a&gt;, I&apos;d really to come to a conclusion on this patch. Could you please respond to my last comment?&lt;/p&gt;</comment>
                            <comment id="13779677" author="phunt" created="Fri, 27 Sep 2013 06:30:43 +0100"  >&lt;p&gt;Here&apos;s another reason - we typically fix bugs in bug fix releases (like 3.4.6). People expect the old behavior(s) to be unchanged in fixes. This seems like it would be better in a minor update like 3.5.0. Least surprise.&lt;/p&gt;</comment>
                            <comment id="13779678" author="phunt" created="Fri, 27 Sep 2013 06:31:44 +0100"  >&lt;p&gt;Also I&apos;d still like us to address the default GC setup, but that would wait for a separate jira (although it might have impact on what this jira is trying to accomplish - hence my previous comment.&lt;/p&gt;</comment>
                            <comment id="13780471" author="fpj" created="Fri, 27 Sep 2013 22:47:20 +0100"  >&lt;p&gt;This issue is marked as a bug and I understood it as if the absence of defaults was causing problems. As I said, I can really go either way with respect to the fix and I understand the argument that this is borderline as a bug fix. &lt;/p&gt;

&lt;p&gt;Now, is your proposal to revert it on the 3.4 branch only or both? From your argument, I understand that keeping it on 3.5.0 is acceptable. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arpitgupta&quot; class=&quot;user-hover&quot; rel=&quot;arpitgupta&quot;&gt;Arpit Gupta&lt;/a&gt;, is it acceptable to you?&lt;/p&gt;
</comment>
                            <comment id="13780480" author="arpitgupta" created="Fri, 27 Sep 2013 22:53:01 +0100"  >&lt;p&gt;Sure that works.&lt;/p&gt;</comment>
                            <comment id="13782396" author="phunt" created="Tue, 1 Oct 2013 00:06:52 +0100"  >&lt;p&gt;Reverting from 3.4 and keeping in trunk is good for me. Thanks!&lt;/p&gt;</comment>
                            <comment id="13783373" author="fpj" created="Tue, 1 Oct 2013 22:31:32 +0100"  >&lt;p&gt;Reverted b3.4 commit. Committed revision 1528221.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12577655" name="ZOOKEEPER-1670.patch" size="456" author="arpitgupta" created="Tue, 9 Apr 2013 00:52:05 +0100"/>
                            <attachment id="12577635" name="ZOOKEEPER-1670.patch" size="632" author="arpitgupta" created="Mon, 8 Apr 2013 23:09:26 +0100"/>
                            <attachment id="12577295" name="ZOOKEEPER-1670.patch" size="491" author="arpitgupta" created="Fri, 5 Apr 2013 22:19:29 +0100"/>
                            <attachment id="12574412" name="ZOOKEEPER-1670.patch" size="346" author="arpitgupta" created="Tue, 19 Mar 2013 21:40:01 +0000"/>
                            <attachment id="12573957" name="ZOOKEEPER-1670.patch" size="288" author="arpitgupta" created="Fri, 15 Mar 2013 22:11:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 15 Mar 2013 22:54:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>317766</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzcoiv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>318107</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>