<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:42:06 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-237/ZOOKEEPER-237.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-237] Add a Chroot request</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-237</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;It would be nice to be able to root ZooKeeper handles at specific points in the namespace, so that applications that use ZooKeeper can work in their own rooted subtree.&lt;/p&gt;

&lt;p&gt;For example, if ops decides that application X can use the subtree /apps/X and application Y can use the subtree /apps/Y, X can to a chroot to /apps/X and then all its path references can be rooted at /apps/X. Thus when X creates the path &quot;/myid&quot;, it will actually be creating the path &quot;/apps/X/myid&quot;.&lt;/p&gt;

&lt;p&gt;There are two ways we can expose this mechanism: 1) We can simply add a chroot(String path) API, or 2) we can integrate into a service identifier scheme for example zk://server1:2181,server2:2181/my/root. I like the second form personally.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12409149">ZOOKEEPER-237</key>
            <summary>Add a Chroot request</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mahadev">Mahadev konar</assignee>
                                    <reporter username="breed">Benjamin Reed</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Nov 2008 21:28:56 +0000</created>
                <updated>Wed, 8 Jul 2009 21:23:56 +0100</updated>
                            <resolved>Thu, 25 Jun 2009 00:00:04 +0100</resolved>
                                                    <fixVersion>3.2.0</fixVersion>
                                    <component>c client</component>
                    <component>java client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12650337" author="phunt" created="Mon, 24 Nov 2008 21:46:05 +0000"  >&lt;p&gt;I like the idea of being able to bind an application to a particular subtree. However this binding should be opaque to the client - the client should not be specifying (or circumventing) the root. The operator should map a credential to a root (ala aws s3)&lt;/p&gt;</comment>
                            <comment id="12650369" author="breed" created="Mon, 24 Nov 2008 23:01:11 +0000"  >&lt;p&gt;If you bind a credential to a root, you end up tying yourself to a particular authorization scheme and id.&lt;/p&gt;

&lt;p&gt;If ACLs are used, you would not be able to circumvent the root. And by using an identifier not tied to a credential, you can support multiple credentials for a given root. For example, you may have /mySpace1, and you have some clients that are in a trusted cluster that &quot;authenticate&quot; with ip addresses and others that use stronger credentials. You may also have the converse problem where a given credential may have access to /mySpace1 and /yourSpace2, so the root would be ambiguous.&lt;/p&gt;</comment>
                            <comment id="12650796" author="phunt" created="Tue, 25 Nov 2008 23:44:43 +0000"  >&lt;p&gt;@ben:&lt;/p&gt;

&lt;p&gt;credential: how about binding the id then?&lt;br/&gt;
acl use: I was thinking that some users might use this instead of acls - similar to the way aws does&lt;/p&gt;

&lt;p&gt;So you are saying then that this is purely a user space feature. Clients can set this for their own convenience, but it has no aspirations towards being a true namespace?&lt;/p&gt;

&lt;p&gt;In which case an ops team might assign a client a particular subtree &quot;/apps/app1&quot;, they would configure the ACLs such that the &quot;app1&quot; client would only have access to /apps/app1. The client  would then have the ability to &quot;chroot&quot; to /apps/app1 (hopefully using the second form you list above) and therefore skip the need to prefix all paths with /apps/app1. That sounds fine.&lt;/p&gt;

&lt;p&gt;Another benefit is that if the client has to move to a diff part of the heirarchy, this could be done by changing the connection string (chroot) alone. Nice.&lt;/p&gt;</comment>
                            <comment id="12706090" author="breed" created="Tue, 5 May 2009 17:38:03 +0100"  >&lt;p&gt;could the chroot be done entirely in the client library? it&apos;s basically just prepending a prefix to all the requests and stripping the prefix off on watches.&lt;/p&gt;</comment>
                            <comment id="12708599" author="phunt" created="Tue, 12 May 2009 21:17:20 +0100"  >&lt;p&gt;There are a couple of pros for server:&lt;/p&gt;

&lt;p&gt;1) implement once rather than once for each client java/c&lt;/p&gt;

&lt;p&gt;2) it has the additional benefit of being a security feature, rather than just a user convenience.&lt;/p&gt;

&lt;p&gt;would be interesting to look at the complexity of implementation client vs server.&lt;/p&gt;</comment>
                            <comment id="12715249" author="phunt" created="Mon, 1 Jun 2009 21:50:33 +0100"  >&lt;p&gt;The current patch implements the java client side of chroot. After reviewing the code more closely it became clear&lt;br/&gt;
that implementing this on the server is much harder/errorprone/inefficient than implementing the core functionality&lt;br/&gt;
on the client. This means we don&apos;t get enforcement with this JIRA, however &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-424&quot; title=&quot;server side chroot enforcment - link to auth&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-424&quot;&gt;ZOOKEEPER-424&lt;/a&gt; was created to&lt;br/&gt;
address that feature enhancement.&lt;/p&gt;

&lt;p&gt;As it currently stands the client can set a chroot during client (ZooKeeper) object creation which will provide&lt;br/&gt;
similar functionality to unix chroot command. See the updated API and forrest docs for details.&lt;/p&gt;

&lt;p&gt;I added 3 tests, two of which re-use existing test functionality. I&apos;m validating both the synchronous as well&lt;br/&gt;
as async operations.&lt;/p&gt;

&lt;p&gt;Note: I made delete(&quot;/&quot;) have the same semantics w/ or w/o chroot being used. I thought this best, although&lt;br/&gt;
not strictly necessary.&lt;/p&gt;

&lt;p&gt;Note: /zookeeper is only available if chroot is not used (we don&apos;t map it into the chroot for example). I don&apos;t think&lt;br/&gt;
we would want to do that anyway. but wanted to not it here for review.&lt;/p&gt;

&lt;p&gt;When updating the client code I introduced the concept of clientpath and serverpath to make the distinction more&lt;br/&gt;
clear.&lt;/p&gt;

&lt;p&gt;Note that we validate both the chroot path as well as the clientPath, we don&apos;t validate the serverpath, assuming&lt;br/&gt;
that it&apos;s valid. Also this ensures that clientpaths start, for example, with / character&lt;/p&gt;

&lt;p&gt;Note: watchregistration objects resulted in a very nice way of mapping client/server paths in watches that don&apos;t require&lt;br/&gt;
us to do any prefix elimination.&lt;/p&gt;


&lt;p&gt;In general I was pretty happy with the (small) number of changes required to implement this and also the decent&lt;br/&gt;
test coverage we currently have.&lt;/p&gt;


&lt;p&gt;Mahadev should take this next and implement the c client changes, hopefully they will be similar.&lt;/p&gt;</comment>
                            <comment id="12717788" author="mahadev" created="Tue, 9 Jun 2009 20:06:56 +0100"  >&lt;p&gt;pat, this patch does not apply any more, can you update the patch to merge with the trunk?&lt;/p&gt;</comment>
                            <comment id="12717818" author="phunt" created="Tue, 9 Jun 2009 22:05:00 +0100"  >&lt;p&gt;merged into latest trunk&lt;/p&gt;</comment>
                            <comment id="12717822" author="phunt" created="Tue, 9 Jun 2009 22:22:17 +0100"  >&lt;p&gt;oops, cancel, waiting for c code from Mahadev&lt;/p&gt;</comment>
                            <comment id="12722807" author="mahadev" created="Mon, 22 Jun 2009 21:38:33 +0100"  >&lt;p&gt;This patch implements the c and includes the java part as well. It has unit tests for watcher testings/and all the apis testing with chroot enabled.&lt;/p&gt;</comment>
                            <comment id="12723430" author="hadoopqa" created="Wed, 24 Jun 2009 05:40:00 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12411450/ZOOKEEPER-237.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12411450/ZOOKEEPER-237.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 787789.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 23 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/129/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/129/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/129/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/129/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/129/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/129/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12723646" author="breed" created="Wed, 24 Jun 2009 18:29:18 +0100"  >&lt;p&gt;looks good. two comments:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;feel free to ignore this one: when you setup hostname and chroot, i think the code is simpler if you hostname = strdup(host) and then poke a null into hostname to strip off the chroot&lt;/li&gt;
	&lt;li&gt;we need to make sure we have total coverage for the testcases. you are missing a couple of the synchronous calls and you need to add the asynchronous calls. (i know it is tedious)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12723739" author="mahadev" created="Wed, 24 Jun 2009 22:08:50 +0100"  >&lt;p&gt;good points ben &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;added tests for zoo_wget_children and added a test for async create just for checking purposes.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12723741" author="mahadev" created="Wed, 24 Jun 2009 22:12:34 +0100"  >&lt;p&gt;attached the wrong pathc,&lt;/p&gt;</comment>
                            <comment id="12723756" author="breed" created="Wed, 24 Jun 2009 22:40:57 +0100"  >&lt;p&gt;+1 good to go! nice job.&lt;/p&gt;</comment>
                            <comment id="12723788" author="mahadev" created="Thu, 25 Jun 2009 00:00:04 +0100"  >&lt;p&gt;I just committed this. thanks pat.&lt;/p&gt;</comment>
                            <comment id="12724021" author="hudson" created="Thu, 25 Jun 2009 11:51:09 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #357 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/357/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/357/&lt;/a&gt;)&lt;br/&gt;
    . Add a Chroot request (phunt and mahadev)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12405190">ZOOKEEPER-146</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12424618">ZOOKEEPER-390</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12426852">ZOOKEEPER-424</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12411705" name="ZOOKEEPER-237.patch" size="90461" author="mahadev" created="Wed, 24 Jun 2009 22:12:34 +0100"/>
                            <attachment id="12411450" name="ZOOKEEPER-237.patch" size="89076" author="mahadev" created="Mon, 22 Jun 2009 21:38:33 +0100"/>
                            <attachment id="12410256" name="ZOOKEEPER-237.patch" size="68844" author="phunt" created="Tue, 9 Jun 2009 22:05:00 +0100"/>
                            <attachment id="12409598" name="ZOOKEEPER-237.patch" size="68813" author="phunt" created="Mon, 1 Jun 2009 21:37:36 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 24 Nov 2008 21:46:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47958</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzybr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33545</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>