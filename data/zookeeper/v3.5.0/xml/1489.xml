<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:43:48 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-1489/ZOOKEEPER-1489.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-1489] Data loss after truncate on transaction log</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-1489</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;The truncate method on the transaction log in the class org.apache.zookeeper.server.persistence.FileTxnLog will reduce the file size to the required amount without either closing or re-positioning the logStream (which could also be dangerous since the truncate method is not synchronized against concurrent writes to the log).&lt;/p&gt;

&lt;p&gt;This causes the next append to that log to create a small &quot;hole&quot; in the file which java would interpret as binary zeroes when reading it. This then causes to the FileTxnIterator.next() implementation to detect the end of the log file too early.&lt;/p&gt;

&lt;p&gt;I&apos;ll attach a small maven project with one junit test which can be used to reproduce the issue. Due to the blackbox nature of the test it will run for roughly 50 seconds unfortunately. &lt;/p&gt;

&lt;p&gt;Steps to reproduce:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Start an ensemble of zookeeper servers with at least 3 participants&lt;/li&gt;
	&lt;li&gt;Create one entry and the remove one of the servers from the ensemble temporarily (e.g. zk-2)&lt;/li&gt;
	&lt;li&gt;Create another entry which is hence only reflected on zk-1 and zk-3&lt;/li&gt;
	&lt;li&gt;Take zk-1 out of the ensemble without shutting it down (that is important, I did that by interrupting the network connection to that node) and clean zk-3&lt;/li&gt;
	&lt;li&gt;Bring back zk-2 and zk-3 so that they form a quorum&lt;/li&gt;
	&lt;li&gt;Allow zk-1 to connect again&lt;/li&gt;
	&lt;li&gt;zk-1 will receive a TRUNC message from zk-2 since zk-1 is now a minority knowing about that second node creation event&lt;/li&gt;
	&lt;li&gt;Create a third node&lt;/li&gt;
	&lt;li&gt;Force zk-1 to become master somehow&lt;/li&gt;
	&lt;li&gt;That third node will be gone&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;Tested on Ubuntu 12.04 and CentOS 6, should be reproducible elsewhere&lt;/p&gt;</environment>
        <key id="12594918">ZOOKEEPER-1489</key>
            <summary>Data loss after truncate on transaction log</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="phunt">Patrick Hunt</assignee>
                                    <reporter username="christianz">Christian Ziech</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Jun 2012 10:09:37 +0100</created>
                <updated>Wed, 18 Jul 2012 12:01:52 +0100</updated>
                            <resolved>Tue, 17 Jul 2012 22:29:26 +0100</resolved>
                                    <version>3.4.3</version>
                    <version>3.3.5</version>
                                    <fixVersion>3.3.6</fixVersion>
                    <fixVersion>3.4.4</fixVersion>
                    <fixVersion>3.5.0</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13395755" author="christianz" created="Mon, 18 Jun 2012 10:14:14 +0100"  >&lt;p&gt;Attaching a small maven project which contains the before mentioned test case. That test works reliably to reproduce the failure for 3.4.3 but for 3.3.5 it seems to pass, although the problem in the transaction log seems to be present there too. This difference seems to be caused by 3.3.5 not sending the truncate message to its peers in that flow the test case is following. &lt;br/&gt;
However I cannot exclude that other flows may show the same problem for 3.3.5 as well.&lt;/p&gt;</comment>
                            <comment id="13398002" author="phunt" created="Thu, 21 Jun 2012 00:47:22 +0100"  >&lt;p&gt;I looked at the code for this and I agree, it seems the existing txn log is not being repositioned. I&apos;ll work on some tests and a patch for this.&lt;/p&gt;

&lt;p&gt;Thanks Christian!&lt;/p&gt;</comment>
                            <comment id="13403936" author="phunt" created="Fri, 29 Jun 2012 15:15:56 +0100"  >&lt;p&gt;I have created a patch that fixes the issue and passes all our tests, however it&apos;s still hanging up when running the tests you (Christian) provided. I&apos;m getting close (I think I see the issue, working on it)&lt;/p&gt;

&lt;p&gt;Christian, I&apos;d like to include the test you created in our unit test infra. Would it be possible for you to contribute these? If so please re-attach the tgz archive to this jira and click the &quot;grant&quot; option when doing so. I would take what you&apos;ve provided and massage it a bit to get into our test infra (pkg names, license headers, etc...). I like the port forwarder idea alot&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; if you&apos;re unable to contribute the code I&apos;ll likely add this concept to our test infra at some point myself. Thanks again!&lt;/p&gt;</comment>
                            <comment id="13403977" author="christianz" created="Fri, 29 Jun 2012 16:51:26 +0100"  >&lt;p&gt;Re-uploading as requested. &lt;/p&gt;

&lt;p&gt;I&apos;m happy that you liked the idea - note that some work may be required on that class to make it reliable. I just hacked that together as a demonstrator. I&apos;m happy that I could help.&lt;/p&gt;</comment>
                            <comment id="13406209" author="phunt" created="Wed, 4 Jul 2012 01:32:22 +0100"  >&lt;p&gt;The attached patches fix the issue in 3.3/3.4/trunk. Notice:&lt;/p&gt;

&lt;p&gt;1) the core fix is in FileTxnSnapLog - specifically reopening the snap/txnlog files after doing the truncation. I would have liked to have just closed and created the FTSL, however there were multiple objects holding references to this object, not just ZKDB. I looked at changing this however the impact was significant - it could also have repercussions on third parties embedding the zkserver. In the end I went for the reset approach.&lt;/p&gt;

&lt;p&gt;2) notice that the code fix is relatively small. The tests make up the bulk of the changes.&lt;/p&gt;

&lt;p&gt;3) I&apos;ve tested this for all three branches successfully.&lt;/p&gt;

&lt;p&gt;4) I added a truncate test that verified that the append after truncate worked properly. This test failed prior to applying the fix.&lt;/p&gt;

&lt;p&gt;5) I also harvested the core test from Christian&apos;s original attachment (awesome!). This allowed me to verify and include tests that will verify this doesn&apos;t get broken again. I also verified that without applying the fix this test will fail.&lt;/p&gt;

&lt;p&gt;6) bonus is the addition of PortForwarder - this should allow us to easily expand testing which introduces network failures of various types.&lt;/p&gt;</comment>
                            <comment id="13408307" author="fournc" created="Fri, 6 Jul 2012 21:49:58 +0100"  >&lt;p&gt;Can we stick this guy in reviewboard? I&apos;ve got some comments that might be more easily made there. I&apos;m most concerned with some of the timeouts, printlns etc in TruncateCorruptionTest. Like, no way should we have a test with 300000ms timeouts in it. &lt;/p&gt;</comment>
                            <comment id="13408373" author="phunt" created="Fri, 6 Jul 2012 22:32:17 +0100"  >&lt;p&gt;That&apos;s great, thanks: &lt;a href=&quot;https://reviews.apache.org/r/5815/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/5815/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;fwiw the test was/is complicated. I didn&apos;t want to change too much and lose the ability to reproduce the problem. I did replace a number of timeouts and such, might not have caught everything. I&apos;m also fine to log everything is that&apos;s an issue.&lt;/p&gt;</comment>
                            <comment id="13409594" author="breed" created="Mon, 9 Jul 2012 17:04:04 +0100"  >&lt;p&gt;sorry i haven&apos;t been able to look at this more deeply. i was more swamped this weekend than expected. i have two small comments (given the previous statement feel free to ignore &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;1) i think the correct fix is to simply ensure that a new log file is created after we do the initial handshake. that is what we were doing earlier; i&apos;m not sure when it changed...&lt;br/&gt;
2) you should be able to reproduce this quickly and reliably using a Zab1_0Test style&lt;/p&gt;

&lt;p&gt;i&apos;m planning on checking more deeply into these two points, but given that i have a time crunch for the next week, i&apos;m afraid i might not get to it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13409631" author="phunt" created="Mon, 9 Jul 2012 17:50:14 +0100"  >&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13409650" author="breed" created="Mon, 9 Jul 2012 18:14:48 +0100"  >&lt;p&gt;after further investigation it appears that pat&apos;s fix is the best. we do not restart the log file on reconnect only on restart or snapshot change.&lt;/p&gt;

&lt;p&gt;+1 on the fix. i&apos;ll try to get a better test in, but i don&apos;t want to hold up the fix.&lt;/p&gt;</comment>
                            <comment id="13409717" author="fournc" created="Mon, 9 Jul 2012 19:45:16 +0100"  >&lt;p&gt;I left my comments in the review btw, but I think in general I&apos;m +1 if we get rid of the 300000ms waits in that test.&lt;/p&gt;</comment>
                            <comment id="13409732" author="phunt" created="Mon, 9 Jul 2012 20:02:24 +0100"  >&lt;p&gt;I saw that, thanks Camille (will get back to this once I have a few min free...)&lt;/p&gt;</comment>
                            <comment id="13411791" author="phunt" created="Wed, 11 Jul 2012 19:07:35 +0100"  >&lt;p&gt;Updated patches with Camille&apos;s f/b (more sane timeouts in 3 cases)&lt;/p&gt;</comment>
                            <comment id="13411831" author="hadoopqa" created="Wed, 11 Jul 2012 19:37:06 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12536083/ZOOKEEPER-1489.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12536083/ZOOKEEPER-1489.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1357711.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 13 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1132//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1132//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1132//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1132//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1132//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1132//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13412004" author="phunt" created="Wed, 11 Jul 2012 22:14:21 +0100"  >&lt;p&gt;Looks like a problem in the port forwarding utility. According to the logs the servers are having trouble communicating - timeouts on the connection(s). I&apos;ll look at adding more details to the PortForwarder class.&lt;/p&gt;</comment>
                            <comment id="13412066" author="phunt" created="Wed, 11 Jul 2012 23:20:54 +0100"  >&lt;p&gt;I updated the patches to do more logging on portforward issues - to enable debugging. Also moved the test printlns into logs (verified the test still fails w/o the fix).&lt;/p&gt;</comment>
                            <comment id="13412068" author="phunt" created="Wed, 11 Jul 2012 23:22:02 +0100"  >&lt;p&gt;One other thing, noticed that some of the socket timeouts were very short on the port forwarder - increased the timeouts to values more likely to pass on various hardware/loads.&lt;/p&gt;</comment>
                            <comment id="13412231" author="christianz" created="Wed, 11 Jul 2012 23:27:40 +0100"  >&lt;p&gt;One should note that I only quickly put together that port forwarder and did not really use it anywhere except for producing the test case here to demonstrate the issue ... so there could be any amount of race conditions I did not think about.&lt;/p&gt;

&lt;p&gt;PS: Great to read that work is progressing so quickly &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ...&lt;/p&gt;</comment>
                            <comment id="13412331" author="hadoopqa" created="Thu, 12 Jul 2012 00:10:30 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12536130/ZOOKEEPER-1489.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12536130/ZOOKEEPER-1489.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1357711.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 13 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1134//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1134//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1134//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1134//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1134//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1134//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13412348" author="hadoopqa" created="Thu, 12 Jul 2012 00:21:37 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12536130/ZOOKEEPER-1489.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12536130/ZOOKEEPER-1489.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1357711.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 13 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1135//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1135//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1135//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1135//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1135//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1135//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13412548" author="phunt" created="Thu, 12 Jul 2012 07:17:47 +0100"  >&lt;p&gt;Christian no worries at all. I really appreciate your submission, happy to work out the kinks. Will be a great addition to our testing regime.&lt;/p&gt;</comment>
                            <comment id="13412553" author="phunt" created="Thu, 12 Jul 2012 07:22:24 +0100"  >&lt;p&gt;This update adds more logging, I also believe it fixes the test failure we were seeing. The main issue was that the port forwarder was not attempting to reconnect on outbound connection failure. In the case of follower connecting to the quorum port on the leader it might take some time for the leader to open the port once the election has completed. The core follower code retries this. However in the port forwarder case it would originally try once and close the inbound connection if the outbound failed. I now retry 10 times.&lt;/p&gt;

&lt;p&gt;I managed to find a box which would fail on this test (my laptop and a number of other boxes didn&apos;t display this issue). With this latest fix the previously failing box is now passing the test consistently.&lt;/p&gt;</comment>
                            <comment id="13412554" author="phunt" created="Thu, 12 Jul 2012 07:25:22 +0100"  >&lt;p&gt;I also verified that the latest test code still fails without the fix applied.&lt;/p&gt;</comment>
                            <comment id="13412566" author="hadoopqa" created="Thu, 12 Jul 2012 07:58:33 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12536181/ZOOKEEPER-1489.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12536181/ZOOKEEPER-1489.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1357711.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 13 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1136//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1136//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1136//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1136//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1136//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1136//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13412581" author="hadoopqa" created="Thu, 12 Jul 2012 08:27:04 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12536181/ZOOKEEPER-1489.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12536181/ZOOKEEPER-1489.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1357711.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 13 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1137//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1137//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1137//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1137//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1137//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1137//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13413045" author="fournc" created="Thu, 12 Jul 2012 19:27:19 +0100"  >&lt;p&gt;+1 looks good&lt;/p&gt;</comment>
                            <comment id="13416624" author="phunt" created="Tue, 17 Jul 2012 22:29:26 +0100"  >&lt;p&gt;Committed.&lt;/p&gt;</comment>
                            <comment id="13416995" author="hudson" created="Wed, 18 Jul 2012 12:01:52 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #1617 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/1617/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/1617/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1489&quot; title=&quot;Data loss after truncate on transaction log&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1489&quot;&gt;&lt;del&gt;ZOOKEEPER-1489&lt;/del&gt;&lt;/a&gt;. Data loss after truncate on transaction log (phunt) (Revision 1362660)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
phunt : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1362660&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1362660&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/ZKDatabase.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/persistence/FileTxnSnapLog.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/server/TruncateCorruptionTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/server/quorum/QuorumPeerTestBase.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/server/util/PortForwarder.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/TruncateTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12533999" name="TruncateTxLogCorruption.tgz" size="6766" author="christianz" created="Fri, 29 Jun 2012 16:51:26 +0100"/>
                            <attachment id="12532383" name="TruncateTxLogCorruption.tgz" size="6766" author="christianz" created="Mon, 18 Jun 2012 10:14:14 +0100"/>
                            <attachment id="12536181" name="ZOOKEEPER-1489.patch" size="34360" author="phunt" created="Thu, 12 Jul 2012 07:22:24 +0100"/>
                            <attachment id="12536130" name="ZOOKEEPER-1489.patch" size="32704" author="phunt" created="Wed, 11 Jul 2012 23:20:54 +0100"/>
                            <attachment id="12536083" name="ZOOKEEPER-1489.patch" size="32335" author="phunt" created="Wed, 11 Jul 2012 19:07:35 +0100"/>
                            <attachment id="12535022" name="ZOOKEEPER-1489.patch" size="32230" author="phunt" created="Wed, 4 Jul 2012 01:26:20 +0100"/>
                            <attachment id="12536179" name="ZOOKEEPER-1489_br33.patch" size="32194" author="phunt" created="Thu, 12 Jul 2012 07:18:22 +0100"/>
                            <attachment id="12536128" name="ZOOKEEPER-1489_br33.patch" size="30538" author="phunt" created="Wed, 11 Jul 2012 23:19:51 +0100"/>
                            <attachment id="12536081" name="ZOOKEEPER-1489_br33.patch" size="30216" author="phunt" created="Wed, 11 Jul 2012 19:07:01 +0100"/>
                            <attachment id="12535020" name="ZOOKEEPER-1489_br33.patch" size="30111" author="phunt" created="Wed, 4 Jul 2012 01:26:10 +0100"/>
                            <attachment id="12536180" name="ZOOKEEPER-1489_br34.patch" size="34260" author="phunt" created="Thu, 12 Jul 2012 07:18:22 +0100"/>
                            <attachment id="12536129" name="ZOOKEEPER-1489_br34.patch" size="32604" author="phunt" created="Wed, 11 Jul 2012 23:19:51 +0100"/>
                            <attachment id="12536082" name="ZOOKEEPER-1489_br34.patch" size="32235" author="phunt" created="Wed, 11 Jul 2012 19:07:01 +0100"/>
                            <attachment id="12535021" name="ZOOKEEPER-1489_br34.patch" size="32130" author="phunt" created="Wed, 4 Jul 2012 01:26:10 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 20 Jun 2012 23:47:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>242018</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxwcgn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12506</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>