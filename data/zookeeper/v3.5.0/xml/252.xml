<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:47:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-252/ZOOKEEPER-252.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-252] PurgeTxnLog is not handling the new dataDir directory structure</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-252</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;org.apache.zookeeper.server.PurgeTxnLog class has not been updated to handle the new directory structure imposed by the upgrade from v2 to v3 of ZooKeeper. In particular the dataDir now has a &quot;version-2&quot; subdirectory that stores all of the snaps/transactionallogs for version2 of the persistence layer.&lt;/p&gt;

&lt;p&gt;I also note that the documentation of this class is particularly poor. I&apos;m working on &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-229&quot; title=&quot;improve documentation regarding user&amp;#39;s responsibility to cleanup datadir (snaps/logs)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-229&quot;&gt;&lt;del&gt;ZOOKEEPER-229&lt;/del&gt;&lt;/a&gt; and would like to point to the API docs for this class regarding usage but they api docs are nonexistent&lt;/p&gt;

&lt;p&gt;Also - I think it&apos;s important for the user to be able to specify the number of &quot;backup&quot; snaps and logs that should be kept &amp;#8211; right now it seems we delete all but the current snaps/txlogs. Either by count or by date &amp;#8211; ie &quot;remove anything 5 days or older, with a minum of 3 most recents snaps (and accompanying txlogs)&quot; seems like a pretty common user case (assuming the operator is doing system backups every X days, etc...)&lt;/p&gt;

&lt;p&gt;in general this class needs some tlc - the formatting should also be cleaned up.&lt;/p&gt;

&lt;p&gt;Also - the API docs for this and LogFormatter are not included in the build.xml &quot;javadoc&quot; target. These are user utilities so javadoc for these two classes should be included. I will fix this issue as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-229&quot; title=&quot;improve documentation regarding user&amp;#39;s responsibility to cleanup datadir (snaps/logs)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-229&quot;&gt;&lt;del&gt;ZOOKEEPER-229&lt;/del&gt;&lt;/a&gt;. I&apos;m also updateing the forrest documention in 229 so don&apos;t worry about that either.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12410411">ZOOKEEPER-252</key>
            <summary>PurgeTxnLog is not handling the new dataDir directory structure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mahadev">Mahadev konar</assignee>
                                    <reporter username="phunt">Patrick Hunt</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Dec 2008 23:06:29 +0000</created>
                <updated>Fri, 13 Feb 2009 21:18:53 +0000</updated>
                            <resolved>Sat, 31 Jan 2009 01:19:11 +0000</resolved>
                                    <version>3.0.0</version>
                    <version>3.0.1</version>
                                    <fixVersion>3.1.0</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12667552" author="mahadev" created="Tue, 27 Jan 2009 02:04:35 +0000"  >&lt;p&gt;this patch fixes the issue.&lt;br/&gt;
It allows purgetxn to be called with -n num (which is to keep history for last n snapshots and the corresponding logs).&lt;/p&gt;</comment>
                            <comment id="12667560" author="mahadev" created="Tue, 27 Jan 2009 02:19:18 +0000"  >&lt;p&gt;had a bug in the last patch.&lt;/p&gt;</comment>
                            <comment id="12667865" author="mahadev" created="Tue, 27 Jan 2009 23:36:34 +0000"  >&lt;p&gt;this patch adds a test and checks to see we have exactly a given number of snapshots in the dir... &lt;/p&gt;</comment>
                            <comment id="12667873" author="mahadev" created="Tue, 27 Jan 2009 23:52:21 +0000"  >&lt;p&gt;fixed a minor bug.&lt;/p&gt;</comment>
                            <comment id="12667875" author="mahadev" created="Tue, 27 Jan 2009 23:54:39 +0000"  >&lt;p&gt;missed the test.&lt;/p&gt;</comment>
                            <comment id="12669110" author="phunt" created="Sat, 31 Jan 2009 01:19:11 +0000"  >&lt;p&gt;Committed revision 739479.&lt;/p&gt;

&lt;p&gt;all tests passing and also did local testing of various repositories.&lt;/p&gt;</comment>
                            <comment id="12669571" author="hudson" created="Mon, 2 Feb 2009 11:49:19 +0000"  >&lt;p&gt;Integrated in ZooKeeper-trunk #217 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/217/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/217/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12408778">ZOOKEEPER-229</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12398859" name="ZOOKEEPER-252.patch" size="10462" author="mahadev" created="Tue, 27 Jan 2009 23:54:39 +0000"/>
                            <attachment id="12398858" name="ZOOKEEPER-252.patch" size="5532" author="mahadev" created="Tue, 27 Jan 2009 23:52:21 +0000"/>
                            <attachment id="12398857" name="ZOOKEEPER-252.patch" size="5532" author="mahadev" created="Tue, 27 Jan 2009 23:36:34 +0000"/>
                            <attachment id="12398792" name="ZOOKEEPER-252.patch" size="5532" author="mahadev" created="Tue, 27 Jan 2009 02:19:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 27 Jan 2009 02:04:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47944</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzvz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33164</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>