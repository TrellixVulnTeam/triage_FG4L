<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:50:29 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-308/ZOOKEEPER-308.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-308] improve the atomic broadcast performance 3x</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-308</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;We need a benchmark for zab, the atomic broadcast protocol of zookeeper. we can also do some small tweaks to make zab go much faster.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12414449">ZOOKEEPER-308</key>
            <summary>improve the atomic broadcast performance 3x</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="breed">Benjamin Reed</assignee>
                                    <reporter username="breed">Benjamin Reed</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Feb 2009 06:43:59 +0000</created>
                <updated>Sat, 12 Sep 2009 22:00:40 +0100</updated>
                            <resolved>Fri, 20 Feb 2009 00:24:04 +0000</resolved>
                                                    <fixVersion>3.2.0</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12672173" author="breed" created="Tue, 10 Feb 2009 06:48:05 +0000"  >&lt;p&gt;This patch adds the AtomicBroadcastBenchmark to show the throughput of just the atomic broadcast layer. It also has the following performance improvements: use a hashtable rather than list for outstanding requests, only flush the txnlog buffer we we absolutely have to, only flush to buffer for the tcp stream on the leader when there aren&apos;t pending requests&lt;/p&gt;</comment>
                            <comment id="12672175" author="breed" created="Tue, 10 Feb 2009 06:49:34 +0000"  >&lt;p&gt;This graph shows the throughput of zab as the number of servers increase. before i started tweaking zab was running around 15K ops/second with 3 servers.&lt;/p&gt;</comment>
                            <comment id="12674080" author="breed" created="Mon, 16 Feb 2009 23:59:28 +0000"  >&lt;p&gt;This patch adds two key improvements to NIOServer and prep req processor: if nothing is queued for a connection when we try to send a buffer, we can try to send it right away to avoid the selector wakeup; and using a hashmap to lookup changes to a patch to reduce the load on the prep request processor.&lt;/p&gt;</comment>
                            <comment id="12674763" author="mahadev" created="Wed, 18 Feb 2009 19:48:34 +0000"  >&lt;p&gt;this is great!!! &lt;br/&gt;
comments/questions on the patch &amp;#8211; &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;what is the usefulness of the change in FileTxnLog, the flush has been moved earlier i.e while flushing when rolling the logs. Is their some specific reason for it?&lt;/li&gt;
	&lt;li&gt;looks the outstanding changes on gives us a sorted order of zxid.... is it possible to get rid of outstandingchanges assuming that if zxid is the first in the outstandingchanges queue then zxid +1 will be the next one? I dont have a strong opinion on it. Anyway the outstanding list should not use that much memory.&lt;/li&gt;
	&lt;li&gt;what is the purpose of writePacket(*, boolean) in follower.java. Why do we need to an option on when to flush ?&lt;/li&gt;
	&lt;li&gt;why is tcpNodelay an option? why is not it always set to true?&lt;/li&gt;
	&lt;li&gt;leader.java (line 560) needs wrapping&lt;/li&gt;
	&lt;li&gt;why is the Excpetion wrapped around to IOExcpetion in SerializeUtils.java? All the lines in the deserializeSnapshot can only throw IOExcpeiton? Why do we have to wrap around Exception?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12674826" author="breed" created="Wed, 18 Feb 2009 23:51:48 +0000"  >&lt;p&gt;1) added buffering to the txnlog. because of this, when we go to roll the log, there still might be txns in memory that have not been flushed to the file, so i have to do the flush before the roll.&lt;br/&gt;
2) we still need outstanding changes for followers that start to sync up. we send them the outstanding changes.&lt;br/&gt;
3) i also added buffering to the writePacket(), i want to minimize flushing, and thus a system call, so i only flush when i have to.&lt;br/&gt;
4) the tcpNodelay option is really there for experimentation. we may want to turn in on based on different traffic patterns or network topologies, but probably not. if it is an option, we can easly test without have to recompile things.&lt;br/&gt;
6) i got the unreasonable length exception with a corrupt log. that exception is a runtime exception. perhaps i really should have changed that exception to be an IOException.&lt;/p&gt;</comment>
                            <comment id="12675091" author="mahadev" created="Thu, 19 Feb 2009 19:08:26 +0000"  >&lt;p&gt;ok ... &lt;/p&gt;

&lt;p&gt;so for 6) are you going to change it for this patch or do you want to do that later?&lt;/p&gt;
</comment>
                            <comment id="12675192" author="mahadev" created="Fri, 20 Feb 2009 00:22:10 +0000"  >&lt;p&gt;this patch has a minor indentation change.&lt;/p&gt;</comment>
                            <comment id="12675193" author="mahadev" created="Fri, 20 Feb 2009 00:24:04 +0000"  >&lt;p&gt;I just committed this. thank ben.&lt;/p&gt;</comment>
                            <comment id="12675550" author="hudson" created="Sat, 21 Feb 2009 11:45:36 +0000"  >&lt;p&gt;Integrated in ZooKeeper-trunk #236 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/236/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/236/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="12754611" author="phunt" created="Sat, 12 Sep 2009 22:00:03 +0100"  >&lt;p&gt;somehow this slipped through w/o a fix version number and is only now being corrected - marking as fixed in 3.2.0&lt;/p&gt;</comment>
                            <comment id="12754612" author="phunt" created="Sat, 12 Sep 2009 22:00:40 +0100"  >&lt;p&gt;closing as fixed in 3.2.0&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12400559" name="ZOOKEEPER-308.patch" size="38806" author="mahadev" created="Fri, 20 Feb 2009 00:22:10 +0000"/>
                            <attachment id="12400302" name="ZOOKEEPER-308.patch" size="38788" author="breed" created="Mon, 16 Feb 2009 23:59:28 +0000"/>
                            <attachment id="12399888" name="ZOOKEEPER-308.patch" size="34905" author="breed" created="Tue, 10 Feb 2009 06:48:05 +0000"/>
                            <attachment id="12399890" name="dat.png" size="3968" author="breed" created="Tue, 10 Feb 2009 06:49:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 18 Feb 2009 19:48:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47909</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzy67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33520</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>