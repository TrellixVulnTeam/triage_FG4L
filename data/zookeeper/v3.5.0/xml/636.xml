<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:51:54 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-636/ZOOKEEPER-636.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-636] configure.ac has instructions which override the contents of CFLAGS and CXXFLAGS.</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-636</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;The information mustn&apos;t be overridden.&lt;br/&gt;
The template like &#171;CFLAGS=&quot;$CFLAGS -some-option&quot;&#187; should be used.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12444309">ZOOKEEPER-636</key>
            <summary>configure.ac has instructions which override the contents of CFLAGS and CXXFLAGS.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dememax">Maxim P. Dementiev</assignee>
                                    <reporter username="dememax">Maxim P. Dementiev</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Dec 2009 13:52:06 +0000</created>
                <updated>Wed, 23 Nov 2011 19:22:15 +0000</updated>
                            <resolved>Wed, 19 May 2010 08:38:10 +0100</resolved>
                                    <version>3.2.1</version>
                                    <fixVersion>3.4.0</fixVersion>
                                    <component>build</component>
                    <component>c client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12803112" author="phunt" created="Thu, 21 Jan 2010 01:39:23 +0000"  >&lt;p&gt;could you provide a bit more detail of the issue. what&apos;s the problem? what issue are you seeing, can you give an example where it&apos;s a problem?&lt;/p&gt;

&lt;p&gt;I tried the following with the current code &quot;make CFLAGS=-XXXXX&quot; and -XXXXX was used in compiling the source. Isn&apos;t this what we want?&lt;/p&gt;</comment>
                            <comment id="12804128" author="dememax" created="Sat, 23 Jan 2010 19:32:08 +0000"  >&lt;p&gt;Dear Patrick,&lt;/p&gt;

&lt;p&gt;You&apos;ve mentioned only one possible usage.&lt;br/&gt;
Please, try to think wider.&lt;/p&gt;

&lt;p&gt;ZooKeeper C client library uses autoconf framework (&lt;a href=&quot;http://www.gnu.org/software/autoconf/autoconf.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.gnu.org/software/autoconf/autoconf.html&lt;/a&gt;).&lt;br/&gt;
Try to run &quot;./configure --help&quot; on any version of C client library, it says:&lt;br/&gt;
&quot;Some influential environment variables: CFLAGS - C compiler flags&quot;&lt;br/&gt;
It means that the way like this:&lt;br/&gt;
------------- beginning -------------------&lt;br/&gt;
max@localhost ~/sources/zookeeper-3.2.2/src/c $ export CFLAGS=&quot;-march=k8 -Os -pipe -fomit-frame-pointer&quot;&lt;br/&gt;
max@localhost ~/sources/zookeeper-3.2.2/src/c $ ./configure&lt;br/&gt;
checking for doxygen... /usr/bin/doxygen&lt;br/&gt;
------------- end -------------------&lt;br/&gt;
This way is perfectly legal, intentional and must influence the result of configure script.&lt;/p&gt;

&lt;p&gt;Of course, nothing can prevent a developer to do the trick like this in a configure script:&lt;br/&gt;
------------- beginning -------------------&lt;br/&gt;
CFLAGS=&quot;-g -O0&quot;;CXXFLAGS=&quot;-g -O0&quot;&lt;br/&gt;
------------- end -------------------&lt;br/&gt;
This is quote from zookeeper-3.2.2/src/c/configure.ac, line 57.&lt;br/&gt;
The end-user of &quot;configure&quot; command doesn&apos;t expect this behaviour, it violates that &quot;configure --help&quot; states.&lt;/p&gt;

&lt;p&gt;More, there is no open source project in widespread usage which does this overriding in its configure scripts.&lt;/p&gt;

&lt;p&gt;The value of CFLAGS environment variable is usually used in configure script itself, if it is present, to check some functionality.&lt;br/&gt;
For example, &quot;gcc -march=XXX&quot; can turn on atomic intrinsics (&lt;a href=&quot;http://gcc.gnu.org/onlinedocs/gcc-4.4.1/gcc/Atomic-Builtins.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://gcc.gnu.org/onlinedocs/gcc-4.4.1/gcc/Atomic-Builtins.html&lt;/a&gt;), &quot;g++ -std=std+0x&quot; can turn on moving methods in STL implementation, and so on.&lt;/p&gt;</comment>
                            <comment id="12804621" author="phunt" created="Mon, 25 Jan 2010 18:09:48 +0000"  >&lt;p&gt;@maxim, thanks, that&apos;s what I was looking for. Not being an expert at autotools myself it&apos;s hard to know what correct behavior is.&lt;/p&gt;

&lt;p&gt;Do you want to take a shot at this? &lt;/p&gt;

&lt;p&gt;Also, if you had any other ideas how to make our auto* integration better we&apos;d love to have you submit patches. In particular&lt;br/&gt;
there&apos;s a long standing issue that we require cppunit, if you know how to address this we&apos;d love to have a patch (I assume &lt;br/&gt;
this would be an option to configure to turn off cppunit being required, obv this would make it impossible to run the tests&lt;br/&gt;
 but at least one could compile). We&apos;ve tried fixing this issue previously but no luck. &lt;/p&gt;

&lt;p&gt;Please continue making suggestions, patches would even be better!&lt;/p&gt;</comment>
                            <comment id="12805239" author="dememax" created="Tue, 26 Jan 2010 22:12:28 +0000"  >&lt;p&gt;I don&apos;t think I&apos;m an autotools expert, but many things have changed since &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-281&quot; title=&quot;autoreconf fails for /zookeeper-3.0.1/src/c/&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-281&quot;&gt;&lt;del&gt;ZOOKEEPER-281&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
I even posted an article about Autoconf and CppUnit integration in my blog: &lt;a href=&quot;http://mpd-eng.livejournal.com/700.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mpd-eng.livejournal.com/700.html&lt;/a&gt;&lt;br/&gt;
I&apos;ll do my best to fix this one issue (CFLAGS overriding).&lt;br/&gt;
And please, fill free to assign to me any autoconf issue (is there corresponding opened issue with cppunit that you&apos;ve talked about?).&lt;/p&gt;</comment>
                            <comment id="12805256" author="phunt" created="Tue, 26 Jan 2010 22:44:50 +0000"  >&lt;p&gt;That would be great. I think the closest thing we have is &quot;build&quot; component. Feel free to work on open JIRAs, it&apos;s fine if you want to assign it to yourself (you don&apos;t&lt;br/&gt;
need to wait for me). Regards.&lt;/p&gt;</comment>
                            <comment id="12868296" author="dememax" created="Mon, 17 May 2010 18:32:06 +0100"  >&lt;p&gt;This patch modifies src/c/configure.ac and src/c/Makefile.am files in order to not override user values of CFLAGS and CXXFLAGS environment variables like it is expected and defined by design.&lt;br/&gt;
Some C and C++ options are still in Makefile.am.&lt;/p&gt;</comment>
                            <comment id="12868297" author="dememax" created="Mon, 17 May 2010 18:35:47 +0100"  >&lt;p&gt;Sorry for delay. Our project is in trouble (&lt;a href=&quot;http://mpd-eng.livejournal.com/1159.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mpd-eng.livejournal.com/1159.html&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;I&apos;ve changed src/c/Makefile.am: CXXFLAGS should not be overridden.&lt;br/&gt;
Anyway, I kept some additional options there (&quot;AM_CFLAGS = -Wall -Werror&quot; and &quot;AM_CXXFLAGS = -Wall&quot;). I think it must be moved in configure.ac as well.&lt;/p&gt;

&lt;p&gt;It is possible to parse the contents of CFLAGS and CXXFLAGS variable and to add specific options conditionally (like it is done for example in &lt;a href=&quot;http://git.gnome.org/browse/gtk+/tree/configure.in?h=gtk-2-18#n320&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://git.gnome.org/browse/gtk+/tree/configure.in?h=gtk-2-18#n320&lt;/a&gt;), but we need to define requirements for the platform and tool versions (can we use such a technique or not).&lt;/p&gt;</comment>
                            <comment id="12868320" author="hadoopqa" created="Mon, 17 May 2010 18:58:53 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12444711/ZOOKEEPER-636.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12444711/ZOOKEEPER-636.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 944515.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 1 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/92/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/92/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/92/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/92/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/92/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/92/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12868382" author="dememax" created="Mon, 17 May 2010 21:12:54 +0100"  >&lt;p&gt;And I wonder what does this     &quot;-1 core tests. The patch failed core unit tests.&quot;  mean for me?&lt;br/&gt;
Should I correct something?&lt;/p&gt;</comment>
                            <comment id="12868393" author="mahadev" created="Mon, 17 May 2010 21:31:21 +0100"  >&lt;p&gt;maxim, looks like the c tests failed. You can take a look at what failed in  &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/92/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/92/testReport&lt;/a&gt;. This does not look like some problem in the patch. To verify, you can cancel and resubmit to see if the test fails again or not.&lt;/p&gt;</comment>
                            <comment id="12868395" author="phunt" created="Mon, 17 May 2010 21:35:32 +0100"  >&lt;p&gt;Maxim, this is a known issue:&lt;/p&gt;

&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;      &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; Zookeeper_simpleSystem::testAuth ZooKeeper server started : elapsed 25448 : OK&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;      &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; zktest-mt: /grid/0/hudson/hudson-slave/workspace/Zookeeper-Patch-h1.grid.sp2.yahoo.net/trunk/src/c/src/zookeeper.c:1950: zookeeper_process: Assertion `cptr&apos; failed.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;      &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; Zookeeper_simpleSystem::testHangingClient&lt;/p&gt;

&lt;p&gt;try retriggering the build. (cancel/submit)&lt;/p&gt;</comment>
                            <comment id="12868568" author="dememax" created="Tue, 18 May 2010 10:16:11 +0100"  >&lt;p&gt;Resubmitting after the fail which isn&apos;t related to the patch.&lt;/p&gt;</comment>
                            <comment id="12868574" author="hadoopqa" created="Tue, 18 May 2010 10:38:55 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12444711/ZOOKEEPER-636.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12444711/ZOOKEEPER-636.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 944515.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 1 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/96/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/96/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/96/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/96/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/96/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h1.grid.sp2.yahoo.net/96/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12869045" author="phunt" created="Wed, 19 May 2010 08:38:09 +0100"  >&lt;p&gt;+1, thanks Maxim!&lt;/p&gt;</comment>
                            <comment id="12869057" author="dememax" created="Wed, 19 May 2010 09:42:23 +0100"  >&lt;p&gt;Thank you, Patrick!&lt;br/&gt;
I do hope our team (&lt;a href=&quot;http://mpd-eng.livejournal.com/1159.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mpd-eng.livejournal.com/1159.html&lt;/a&gt;) will find an opportunity to continue work on the project and I will do more for ZooKeeper!&lt;/p&gt;</comment>
                            <comment id="12874191" author="hudson" created="Tue, 1 Jun 2010 20:39:03 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #831 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/831/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/831/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12444711" name="ZOOKEEPER-636.patch" size="1806" author="dememax" created="Mon, 17 May 2010 18:32:06 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 21 Jan 2010 01:39:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47677</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzxjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33420</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>autoconf autotools configure</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>