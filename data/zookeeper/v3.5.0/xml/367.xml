<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:47:05 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-367/ZOOKEEPER-367.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-367] RecoveryTest failure - &quot;unreasonable length&quot; IOException</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-367</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;during local testing I received the attached recoverytest failure&lt;/p&gt;</description>
                <environment>&lt;p&gt;ubuntu 8.10 intrpid ibex, jvm 1.6.0_10&lt;/p&gt;</environment>
        <key id="12422023">ZOOKEEPER-367</key>
            <summary>RecoveryTest failure - &quot;unreasonable length&quot; IOException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mahadev">Mahadev konar</assignee>
                                    <reporter username="phunt">Patrick Hunt</reporter>
                        <labels>
                    </labels>
                <created>Sat, 4 Apr 2009 01:29:32 +0100</created>
                <updated>Wed, 8 Jul 2009 21:24:02 +0100</updated>
                            <resolved>Fri, 17 Apr 2009 19:12:25 +0100</resolved>
                                    <version>3.2.0</version>
                                    <fixVersion>3.2.0</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12696742" author="phunt" created="Tue, 7 Apr 2009 21:48:44 +0100"  >&lt;p&gt;rep2 is another repository with the same issue&lt;/p&gt;</comment>
                            <comment id="12698554" author="phunt" created="Mon, 13 Apr 2009 22:17:17 +0100"  >&lt;p&gt;Seeing similar failure, this time in InvalidSnapshotTest&lt;br/&gt;
invalid1.tar.gz for log/datadir&lt;/p&gt;</comment>
                            <comment id="12698581" author="mahadev" created="Mon, 13 Apr 2009 23:41:07 +0100"  >&lt;p&gt;thanks for uploading the logs pat.. i think the problem is the following - &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the snapshot is not valid (which is be possible since we use a different thread and we might shutdown the server before we finish snapshotting)&lt;/li&gt;
	&lt;li&gt;the snapshot is thought to be valid since it ends with &quot;/&quot; (which is accidental). the current method only checks for a &quot;/&quot; at the end of the snapshot to think this is valid.&lt;/li&gt;
	&lt;li&gt;the read method throws since it is actually invalid snapshot&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;All we need to do is read the last snapshot and keep doing it until we can successfulyl read the last snapshot (catching IOException in deserializing snapshots and trying reading the older snapshot until we succeed, if we run out of snapshots we can declare error). I iwll post a patch for this as soon as I can. We can check in the data files as a part of the test for testing purpose.&lt;/p&gt;</comment>
                            <comment id="12698625" author="mahadev" created="Tue, 14 Apr 2009 03:22:27 +0100"  >&lt;p&gt;this patch should fix the issue. &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the patch keeps trying (only 100 retries - that should be enough) to read a snapshot unless it fines a valid one that has right crc&apos;s and a / at the end&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; I will add a test with the logs pat provided to me in rec.tar.gz. &lt;br/&gt;
Pat, can you verify that the patch works with the other logs as well that you uploaded? you can test it by just trying to bring up a server with those logs. It should come up with this patch and fail to come up without the patch.&lt;/p&gt;</comment>
                            <comment id="12698975" author="mahadev" created="Tue, 14 Apr 2009 23:57:27 +0100"  >&lt;p&gt;this patch adds a test.&lt;br/&gt;
also for the test we have to check in the data files that pat posted so that we can run the test with the data file. I am uploading the datafiles as tar.gz. &lt;br/&gt;
You will need to untar the tar.gz in src/java/test/data and then svn add src/java/test/data/invalidsnap. the patch will fail the automated testing just becasue the patch cannot have the binary files.&lt;/p&gt;</comment>
                            <comment id="12699523" author="hadoopqa" created="Thu, 16 Apr 2009 06:01:51 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12405473/invalidsnap.tar.gz&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12405473/invalidsnap.tar.gz&lt;/a&gt;&lt;br/&gt;
  against trunk revision 764673.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/31/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/31/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12699854" author="phunt" created="Thu, 16 Apr 2009 21:47:05 +0100"  >&lt;p&gt;You need try/finally around the operations that might throw exceptions while processing the stream(s). The finally needs to close the stream. This will handle the case where an exception is thrown while processing the stream - otw resources may be leaked.&lt;/p&gt;

&lt;p&gt;You might want to run with something like Coverity prevent - it&apos;s good at flagging this sort of thing.&lt;/p&gt;

&lt;p&gt;(I realize the old code didn&apos;t handle this properly either, but as you&apos;re updating the code you should fix it)&lt;/p&gt;
</comment>
                            <comment id="12699928" author="mahadev" created="Fri, 17 Apr 2009 00:35:00 +0100"  >&lt;p&gt;good catch pat... thanks for the review.. here&apos;s an updated patch.&lt;/p&gt;</comment>
                            <comment id="12700053" author="hadoopqa" created="Fri, 17 Apr 2009 08:37:13 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12405715/ZOOKEEPER-367.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12405715/ZOOKEEPER-367.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 765797.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 10 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/38/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/38/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/38/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/38/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/38/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-vesta.apache.org/38/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12700263" author="phunt" created="Fri, 17 Apr 2009 19:12:25 +0100"  >&lt;p&gt;+1, looks good&lt;br/&gt;
Committed revision 766107&lt;/p&gt;</comment>
                            <comment id="12700661" author="hudson" created="Mon, 20 Apr 2009 07:11:57 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #284 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/284/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/ZooKeeper-trunk/284/&lt;/a&gt;)&lt;br/&gt;
    . RecoveryTest failure - &apos;unreasonable length&apos; IOException&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12417100">ZOOKEEPER-340</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12404612" name="TEST-org.apache.zookeeper.test.RecoveryTest.txt" size="13151" author="phunt" created="Sat, 4 Apr 2009 01:30:17 +0100"/>
                            <attachment id="12405715" name="ZOOKEEPER-367.patch" size="15100" author="mahadev" created="Fri, 17 Apr 2009 00:35:00 +0100"/>
                            <attachment id="12405472" name="ZOOKEEPER-367.patch" size="17780" author="mahadev" created="Tue, 14 Apr 2009 23:57:27 +0100"/>
                            <attachment id="12405379" name="ZOOKEEPER-367.patch" size="9602" author="mahadev" created="Tue, 14 Apr 2009 03:22:27 +0100"/>
                            <attachment id="12405355" name="invalid1.tar.gz" size="372605" author="phunt" created="Mon, 13 Apr 2009 22:17:17 +0100"/>
                            <attachment id="12405473" name="invalidsnap.tar.gz" size="76410" author="mahadev" created="Tue, 14 Apr 2009 23:57:27 +0100"/>
                            <attachment id="12404613" name="rec.tar.gz" size="76843" author="phunt" created="Sat, 4 Apr 2009 01:30:17 +0100"/>
                            <attachment id="12404878" name="rep2.tar.gz" size="114481" author="phunt" created="Tue, 7 Apr 2009 21:48:44 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 13 Apr 2009 22:41:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>47869</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzvnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33112</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>