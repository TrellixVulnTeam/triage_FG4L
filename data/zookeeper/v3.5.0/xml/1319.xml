<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:46:27 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-1319/ZOOKEEPER-1319.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-1319] Missing data after restarting+expanding a cluster</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-1319</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;I&apos;ve been trying to update to ZK 3.4.0 and have had some issues where some data become inaccessible after adding a node to a cluster.  My use case is a bit strange (as explained before on this list) in that I try to grow the cluster dynamically by having an external program automatically restart Zookeeper servers in a controlled way whenever the list of participating ZK servers needs to change.  This used to work just fine in 3.3.3 (and before), so this represents a regression.&lt;/p&gt;

&lt;p&gt;The scenario I see is this:&lt;/p&gt;

&lt;p&gt;1) Start up a 1-server ZK cluster (the server has ZK ID 0).&lt;br/&gt;
2) A client connects to the server, and makes a bunch of znodes, in particular a znode called &quot;/membership&quot;.&lt;br/&gt;
3) Shut down the cluster.&lt;br/&gt;
4) Bring up a 2-server ZK cluster, including the original server 0 with its existing data, and a new server with ZK ID 1.&lt;br/&gt;
5) Node 0 has the highest zxid and is elected leader.&lt;br/&gt;
6) A client connecting to server 1 tries to &quot;get /membership&quot; and gets back a -101 error code (no such znode).&lt;br/&gt;
7) The same client then tries to &quot;create /membership&quot; and gets back a -110 error code (znode already exists).&lt;br/&gt;
8) Clients connecting to server 0 can successfully &quot;get /membership&quot;.&lt;/p&gt;

&lt;p&gt;I will attach a tarball with debug logs for both servers, annotating where steps #1 and #4 happen.  You can see that the election involves a proposal for zxid 110 from server 0, but immediately following the election server 1 has these lines:&lt;/p&gt;

&lt;p&gt;2011-12-05 17:18:48,308 9299 [QuorumPeer&lt;span class=&quot;error&quot;&gt;&amp;#91;myid=1&amp;#93;&lt;/span&gt;/127.0.0.1:2901] WARN org.apache.zookeeper.server.quorum.Learner  - Got zxid 0x100000001 expected 0x1&lt;br/&gt;
2011-12-05 17:18:48,313 9304 &lt;span class=&quot;error&quot;&gt;&amp;#91;SyncThread:1&amp;#93;&lt;/span&gt; INFO org.apache.zookeeper.server.persistence.FileTxnLog  - Creating new log file: log.100000001&lt;/p&gt;

&lt;p&gt;Perhaps that&apos;s not relevant, but it struck me as odd.  At the end of server 1&apos;s log you can see a repeated cycle of getData-&amp;gt;create-&amp;gt;getData as the client tries to make sense of the inconsistent responses.&lt;/p&gt;

&lt;p&gt;The other piece of information is that if I try to use the on-disk directories for either of the servers to start a new one-node ZK cluster, all the data are accessible.&lt;/p&gt;

&lt;p&gt;I haven&apos;t tried writing a program outside of my application to reproduce this, but I can do it very easily with some of my app&apos;s tests if anyone needs more information.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux (Debian Squeeze)&lt;/p&gt;</environment>
        <key id="12533982">ZOOKEEPER-1319</key>
            <summary>Missing data after restarting+expanding a cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="phunt">Patrick Hunt</assignee>
                                    <reporter username="strib">Jeremy Stribling</reporter>
                        <labels>
                            <label>cluster</label>
                            <label>data</label>
                    </labels>
                <created>Tue, 6 Dec 2011 03:06:10 +0000</created>
                <updated>Sat, 17 Dec 2011 01:33:57 +0000</updated>
                            <resolved>Fri, 9 Dec 2011 19:09:12 +0000</resolved>
                                    <version>3.4.0</version>
                                    <fixVersion>3.4.1</fixVersion>
                    <fixVersion>3.5.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13163305" author="strib" created="Tue, 6 Dec 2011 03:07:05 +0000"  >&lt;p&gt;Contains two logs, one for server 0 and one for server 1.  The logs are annotated to describe where the cluster was restarted.&lt;/p&gt;</comment>
                            <comment id="13164039" author="phunt" created="Wed, 7 Dec 2011 01:29:03 +0000"  >&lt;p&gt;I see the problem, a change made in &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1136&quot; title=&quot;NEW_LEADER should be queued not sent to match the Zab 1.0 protocol on the twiki&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1136&quot;&gt;&lt;del&gt;ZOOKEEPER-1136&lt;/del&gt;&lt;/a&gt; is causing this regression. setting of lastProposed in the lead() method of Leader was commented out for some reason. As a result the new follower is getting an empty diff rather than a snapshot.&lt;/p&gt;

&lt;p&gt;This is a serious issue as it&apos;s causing the follower to get an inconsistent view of the database. We&apos;ll need to roll 3.4.1 asap.&lt;/p&gt;

&lt;p&gt;Jeremy &amp;#8211; Thanks for reporting this issue!&lt;/p&gt;</comment>
                            <comment id="13164612" author="fpj" created="Wed, 7 Dec 2011 18:50:39 +0000"  >&lt;p&gt;I didn&apos;t see lastProposed commented out in the patch of &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1136&quot; title=&quot;NEW_LEADER should be queued not sent to match the Zab 1.0 protocol on the twiki&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1136&quot;&gt;&lt;del&gt;ZOOKEEPER-1136&lt;/del&gt;&lt;/a&gt;. Have I misunderstood your comment, Pat?&lt;/p&gt;</comment>
                            <comment id="13164616" author="phunt" created="Wed, 7 Dec 2011 18:54:07 +0000"  >&lt;p&gt;@flavio look at line 268 of the patch for 1136.&lt;/p&gt;</comment>
                            <comment id="13164703" author="phunt" created="Wed, 7 Dec 2011 21:14:32 +0000"  >&lt;p&gt;This patch fixes the problem.&lt;/p&gt;

&lt;p&gt;It seems that Zab1_0 tests were not checking for the correct sequence of events on the learner side - that&apos;s really frustrating (and why 1136 commented out that section of setting lastProposed - because with it zab1_0 tests failed). Otw (if zab1_0 was right) we would have found this before 3.4.0 shipped. &lt;/p&gt;

&lt;p&gt;Please double check my changes to zab1_0 tests - in particular should we be seeing this sequence? Two NEWLEADERS? (iirc that&apos;s expected)&lt;/p&gt;</comment>
                            <comment id="13164705" author="phunt" created="Wed, 7 Dec 2011 21:16:02 +0000"  >&lt;p&gt;btw, I added a new test which fails prior to fixing the issue in Leader.java, it succeeds subsequent to fixing the issue.&lt;br/&gt;
org.apache.zookeeper.test.FollowerResyncConcurrencyTest.testLaggingFollowerResyncsUnderNewEpoch()&lt;/p&gt;</comment>
                            <comment id="13164706" author="phunt" created="Wed, 7 Dec 2011 21:18:05 +0000"  >&lt;p&gt;minor change to patch - fixed indent issue.&lt;/p&gt;</comment>
                            <comment id="13164709" author="hadoopqa" created="Wed, 7 Dec 2011 21:20:36 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12506515/ZOOKEEPER-1319.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12506515/ZOOKEEPER-1319.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1208979.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/807//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/807//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13164749" author="phunt" created="Wed, 7 Dec 2011 21:49:04 +0000"  >&lt;p&gt;Same patch applied to trunk.&lt;/p&gt;</comment>
                            <comment id="13164787" author="hadoopqa" created="Wed, 7 Dec 2011 22:34:12 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12506524/ZOOKEEPER-1319_trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12506524/ZOOKEEPER-1319_trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1208979.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/808//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/808//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/808//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/808//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/808//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/808//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13164789" author="hadoopqa" created="Wed, 7 Dec 2011 22:35:04 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12506524/ZOOKEEPER-1319_trunk.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12506524/ZOOKEEPER-1319_trunk.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1208979.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/809//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/809//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/809//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/809//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/809//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/809//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13164948" author="fpj" created="Thu, 8 Dec 2011 02:39:56 +0000"  >&lt;p&gt;+1, looks good, Pat. About the double occurrence of NEWLEADER, it happens because we insert NEWLEADER in outstandingRequests in Leader.lead() and queue a NEWLEADER message in LearnerHandler.run(). When we execute LearnerHandler.startForwarding() from LearnerHandler.run(), we queue the packets in outstandingRequests, including NEWLEADER. &lt;/p&gt;

&lt;p&gt;It is not necessary to send it again in startForwarding(), but we do need it in outstandingRequests to collect acks. Since we have to add it to outstandingRequests, one simple way to avoid it is by performing a check like this in startForwarding:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;                if(outstandingProposals.get(zxid).packet.getType() != NEWLEADER){
                    handler.queuePacket(outstandingProposals.get(zxid).packet);
                }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I have verified that by including this check, I can remove the double occurrence of NEWLEADER in Pat&apos;s patch and the test passes. We may want to consider this check in some later release.&lt;/p&gt;</comment>
                            <comment id="13164965" author="mahadev" created="Thu, 8 Dec 2011 03:52:49 +0000"  >&lt;p&gt;Flavio/Pat,&lt;br/&gt;
 Ben and I had a long discussion on this.&lt;br/&gt;
 Here is the gist - There are 2 NEWLEADER packets one added when the Leader just has become a leader and one added in startforwarding as Flavio mentioned above. We need to skip adding the first one (the one in leader.lead())  to the queue of packets to send to the follower. Flavio is right above that if we skip the adding of NEWLEADER in start forwarding we are good. We need to send the NEWLEADER packet in LearnerHandler (Line 390) because that means the end of all syncing up transactions from the Leader for the follower.&lt;/p&gt;

&lt;p&gt;Ben has an updated patch and will update the jira soon tonight.&lt;/p&gt;</comment>
                            <comment id="13164970" author="breed" created="Thu, 8 Dec 2011 04:06:39 +0000"  >&lt;p&gt;this should fix everything. i&apos;d like to add a couple more unit tests, but the functional fixes are in.&lt;/p&gt;</comment>
                            <comment id="13164985" author="hadoopqa" created="Thu, 8 Dec 2011 04:35:02 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12506569/ZOOKEEPER-1319_trunk2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12506569/ZOOKEEPER-1319_trunk2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1208979.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/812//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/812//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/812//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/812//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/812//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/812//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13164996" author="breed" created="Thu, 8 Dec 2011 05:10:04 +0000"  >&lt;p&gt;never mind, i figured out that the case i wanted to test for was impossible: an outstandingProposal queue with a NL and other proposals, but i realized that other proposals will not be generated until the NL message is committed at which point it will no longer be in the outstandingProposal queue, so the double NL is completely innocuous...&lt;/p&gt;</comment>
                            <comment id="13164997" author="breed" created="Thu, 8 Dec 2011 05:10:04 +0000"  >&lt;p&gt;never mind, i figured out that the case i wanted to test for was impossible: an outstandingProposal queue with a NL and other proposals, but i realized that other proposals will not be generated until the NL message is committed at which point it will no longer be in the outstandingProposal queue, so the double NL is completely innocuous...&lt;/p&gt;</comment>
                            <comment id="13165020" author="phunt" created="Thu, 8 Dec 2011 06:15:52 +0000"  >&lt;p&gt;sounds fine, two questions come to mind though.&lt;/p&gt;

&lt;p&gt;1) why make this change now, this has been the behavior for a while, no? seems safer to just leave it as is for 3.4 and change in 3.5+&lt;/p&gt;

&lt;p&gt;2) what are the implications, if any, for backward compatibility with 3.3 based servers?&lt;/p&gt;</comment>
                            <comment id="13165084" author="fpj" created="Thu, 8 Dec 2011 08:28:16 +0000"  >&lt;p&gt;Since the double NEWLEADER is harmless, it doesn&apos;t sound like a big deal to me to postpone to a future release. It is mainly inefficient to have it that way. At the same time, the fix seems to be simple enough so we could consider.&lt;/p&gt;

&lt;p&gt;I don&apos;t think it causes backward compatibility problems. In my understanding, all it happens in the Leaner is executing this twice:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;                case Leader.NEWLEADER: // it will be NEWLEADER in v1.0
                    zk.takeSnapshot();
                    self.setCurrentEpoch(newEpoch);
                    snapshotTaken = true;
                    writePacket(new QuorumPacket(Leader.ACK, newLeaderZxid, null, null), true);
                    break;
                }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;I believe this is idempotent.&lt;/p&gt;</comment>
                            <comment id="13165377" author="strib" created="Thu, 8 Dec 2011 18:03:31 +0000"  >&lt;p&gt;Patch 2 fixes the problem my tests were seeing.  Thanks!&lt;/p&gt;</comment>
                            <comment id="13165380" author="phunt" created="Thu, 8 Dec 2011 18:05:17 +0000"  >&lt;p&gt;That&apos;s great, thanks for following up!&lt;/p&gt;</comment>
                            <comment id="13165465" author="mahadev" created="Thu, 8 Dec 2011 19:33:05 +0000"  >&lt;p&gt;I am more inclined towards what flavio mentioned above. To reduce the number of changes I think its best we dont remove the duplicate NEWLEADER. Ben any thoughts? &lt;/p&gt;</comment>
                            <comment id="13165494" author="phunt" created="Thu, 8 Dec 2011 19:58:40 +0000"  >&lt;p&gt;mahadev - jeremy mentioned that he tested with the second version of the patch, is that going to be a problem? (re confirmation of fix).&lt;/p&gt;</comment>
                            <comment id="13165677" author="strib" created="Thu, 8 Dec 2011 23:31:04 +0000"  >&lt;p&gt;Patch 1 also seems to do the trick.&lt;/p&gt;</comment>
                            <comment id="13166420" author="mahadev" created="Fri, 9 Dec 2011 18:40:22 +0000"  >&lt;p&gt;I am going ahead and checking in Pat&apos;s patch. I have opened &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1324&quot; title=&quot;Remove Duplicate NEWLEADER packets from the Leader to the Follower.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1324&quot;&gt;&lt;del&gt;ZOOKEEPER-1324&lt;/del&gt;&lt;/a&gt; to track the duplicate NEWLEADER packets. Just being paranoid here and making minimal changes for the RC.&lt;/p&gt;</comment>
                            <comment id="13166456" author="mahadev" created="Fri, 9 Dec 2011 19:09:12 +0000"  >&lt;p&gt;I just committed Pat&apos;s patch to 3.4 and trunk. Thanks all for contributing on this!&lt;/p&gt;</comment>
                            <comment id="13166526" author="hudson" created="Fri, 9 Dec 2011 20:20:26 +0000"  >&lt;p&gt;Integrated in ZooKeeper-trunk #1390 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/1390/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/1390/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1319&quot; title=&quot;Missing data after restarting+expanding a cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1319&quot;&gt;&lt;del&gt;ZOOKEEPER-1319&lt;/del&gt;&lt;/a&gt;. Missing data after restarting+expanding a cluster. (phunt and breed via mahadev)&lt;/p&gt;

&lt;p&gt;mahadev : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1212578&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1212578&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/quorum/Leader.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/server/quorum/Zab1_0Test.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/test/FollowerResyncConcurrencyTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12506515" name="ZOOKEEPER-1319.patch" size="8747" author="phunt" created="Wed, 7 Dec 2011 21:18:05 +0000"/>
                            <attachment id="12506513" name="ZOOKEEPER-1319.patch" size="8755" author="phunt" created="Wed, 7 Dec 2011 21:14:32 +0000"/>
                            <attachment id="12506524" name="ZOOKEEPER-1319_trunk.patch" size="8682" author="phunt" created="Wed, 7 Dec 2011 21:49:04 +0000"/>
                            <attachment id="12506569" name="ZOOKEEPER-1319_trunk2.patch" size="7943" author="breed" created="Thu, 8 Dec 2011 04:06:39 +0000"/>
                            <attachment id="12506212" name="logs.tgz" size="91837" author="strib" created="Tue, 6 Dec 2011 03:07:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 7 Dec 2011 01:29:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>219708</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzsmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32621</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>