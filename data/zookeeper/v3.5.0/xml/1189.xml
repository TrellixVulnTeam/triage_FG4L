<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:51:23 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-1189/ZOOKEEPER-1189.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-1189] For an invalid snapshot file(less than 10bytes size) RandomAccessFile stream is leaking.</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-1189</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;When loading the snapshot, ZooKeeper will consider only the &apos;snapshots with atleast 10 bytes size&apos;. Otherwsie it will ignore and just return without closing the RandomAccessFile.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Util.isValidSnapshot() having the following logic. 
       // Check for a valid snapshot
        RandomAccessFile raf = new RandomAccessFile(f, &quot;r&quot;);
        // including the header and the last / bytes
        // the snapshot should be atleast 10 bytes
        if (raf.length() &amp;lt; 10) {
            return false;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since the snapshot file validation logic is outside try block, it won&apos;t go to the finally block and will be leaked.&lt;/p&gt;

&lt;p&gt;Suggestion: Move the validation logic to the try/catch block.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12523338">ZOOKEEPER-1189</key>
            <summary>For an invalid snapshot file(less than 10bytes size) RandomAccessFile stream is leaking.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rakeshr">Rakesh R</assignee>
                                    <reporter username="rakeshr">Rakesh R</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Sep 2011 15:29:05 +0100</created>
                <updated>Wed, 23 Nov 2011 19:22:22 +0000</updated>
                            <resolved>Tue, 27 Sep 2011 02:11:20 +0100</resolved>
                                    <version>3.3.3</version>
                                    <fixVersion>3.3.4</fixVersion>
                    <fixVersion>3.4.0</fixVersion>
                    <fixVersion>3.5.0</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13106501" author="rakeshr" created="Fri, 16 Sep 2011 15:58:18 +0100"  >&lt;p&gt;Attached the patch, Please review the fix.&lt;/p&gt;</comment>
                            <comment id="13106519" author="hadoopqa" created="Fri, 16 Sep 2011 16:24:00 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12494800/ZOOKEEPER-1189.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12494800/ZOOKEEPER-1189.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1170886.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/555//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/555//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/555//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/555//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/555//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/555//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13106621" author="breed" created="Fri, 16 Sep 2011 18:40:40 +0100"  >&lt;p&gt;+1 looks great!&lt;/p&gt;</comment>
                            <comment id="13106973" author="phunt" created="Sat, 17 Sep 2011 01:54:21 +0100"  >&lt;p&gt;Let&apos;s make sure this is fixed in all active branches (currently 3.3.4, 3.4.0 and 3.5.0 (ie trunk))&lt;/p&gt;</comment>
                            <comment id="13107941" author="rakeshr" created="Mon, 19 Sep 2011 17:23:33 +0100"  >&lt;p&gt;Improved the testcase: Added assertion message.&lt;/p&gt;</comment>
                            <comment id="13107981" author="hadoopqa" created="Mon, 19 Sep 2011 17:54:30 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12495094/ZOOKEEPER-1189.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12495094/ZOOKEEPER-1189.1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1172406.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/561//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/561//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/561//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/561//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/561//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/561//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13109544" author="rakeshr" created="Wed, 21 Sep 2011 15:53:48 +0100"  >&lt;p&gt;Thanks very much Benjamin, Mahadev, Pat for looking at this.&lt;/p&gt;</comment>
                            <comment id="13114164" author="mahadev" created="Sun, 25 Sep 2011 07:45:17 +0100"  >&lt;p&gt;@rakesh,&lt;br/&gt;
 Can you please provide a patch for 3.3 branch? The patch seems to apply to both 3.4 and 3.5 but does not apply to 3.3 branch.&lt;/p&gt;</comment>
                            <comment id="13114532" author="hadoopqa" created="Mon, 26 Sep 2011 09:43:33 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12496448/ZOOKEEPER-1189-branch-3.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12496448/ZOOKEEPER-1189-branch-3.3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1173949.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/588//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/588//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13114533" author="rakeshr" created="Mon, 26 Sep 2011 09:43:51 +0100"  >&lt;p&gt;Hi Mahadev,&lt;/p&gt;

&lt;p&gt;I have attached the patch &lt;span class=&quot;error&quot;&gt;&amp;#91;ZOOKEEPER-1189-branch-3.3.patch&amp;#93;&lt;/span&gt; for the 3.3 branch. Please review this.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Rakesh&lt;/p&gt;</comment>
                            <comment id="13115069" author="mahadev" created="Tue, 27 Sep 2011 01:26:41 +0100"  >&lt;p&gt;Thanks Rakesh, will go ahead and commit.&lt;/p&gt;</comment>
                            <comment id="13115097" author="mahadev" created="Tue, 27 Sep 2011 02:11:20 +0100"  >&lt;p&gt;Just committed this. Thanks a lot Rakesh!&lt;/p&gt;</comment>
                            <comment id="13115200" author="rakeshr" created="Tue, 27 Sep 2011 05:26:47 +0100"  >&lt;p&gt;Thanks Mahadev, for reviewing and committing the patch.&lt;/p&gt;

&lt;p&gt;-Rakesh&lt;/p&gt;</comment>
                            <comment id="13115399" author="hudson" created="Tue, 27 Sep 2011 11:57:55 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #1316 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/1316/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/1316/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1189&quot; title=&quot;For an invalid snapshot file(less than 10bytes size) RandomAccessFile stream is leaking.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1189&quot;&gt;&lt;del&gt;ZOOKEEPER-1189&lt;/del&gt;&lt;/a&gt;. For an invalid snapshot file(less than 10bytes size) RandomAccessFile stream is leaking. (Rakesh R via mahadev)&lt;/p&gt;

&lt;p&gt;mahadev : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1176144&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1176144&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/main/org/apache/zookeeper/server/persistence/Util.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/java/test/org/apache/zookeeper/server/ZooKeeperServerTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12496448" name="ZOOKEEPER-1189-branch-3.3.patch" size="2374" author="rakeshr" created="Mon, 26 Sep 2011 09:39:07 +0100"/>
                            <attachment id="12495094" name="ZOOKEEPER-1189.1.patch" size="2448" author="rakeshr" created="Mon, 19 Sep 2011 17:23:33 +0100"/>
                            <attachment id="12494800" name="ZOOKEEPER-1189.patch" size="2406" author="rakeshr" created="Fri, 16 Sep 2011 15:58:18 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 16 Sep 2011 15:24:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzsxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32673</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>