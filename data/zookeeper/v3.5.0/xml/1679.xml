<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:49:16 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-1679/ZOOKEEPER-1679.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-1679] c client: use -Wdeclaration-after-statement</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-1679</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;Visual studio still doesn&apos;t support c99.&lt;/p&gt;

&lt;p&gt;--Michi&lt;/p&gt;</description>
                <environment></environment>
        <key id="12639871">ZOOKEEPER-1679</key>
            <summary>c client: use -Wdeclaration-after-statement</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="michim">Michi Mutsuzaki</assignee>
                                    <reporter username="michim">Michi Mutsuzaki</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Mar 2013 19:34:51 +0000</created>
                <updated>Wed, 21 Aug 2013 12:06:45 +0100</updated>
                            <resolved>Wed, 21 Aug 2013 10:53:55 +0100</resolved>
                                    <version>3.4.5</version>
                                    <fixVersion>3.5.0</fixVersion>
                                    <component>c client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13617695" author="michim" created="Fri, 29 Mar 2013 20:33:31 +0000"  >&lt;p&gt;Visual studio complains if a variable declaration is found after a statement. This patch adds -Wdeclaration-after-statement option to the Makefile to catch the error at compile time when using gcc.&lt;/p&gt;

&lt;p&gt;It also fixes a minor compilation error on windows (use _strtoui64 instead of strtoull).&lt;/p&gt;

&lt;p&gt;I tested the patch with visual studio 2008. This patch should fix the current windows build failure. &lt;/p&gt;</comment>
                            <comment id="13617733" author="hadoopqa" created="Fri, 29 Mar 2013 21:15:27 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12576154/ZOOKEEPER-1679.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12576154/ZOOKEEPER-1679.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1462141.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 1 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1441//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1441//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1441//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1441//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1441//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1441//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13624780" author="hadoopqa" created="Sun, 7 Apr 2013 09:05:30 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12576154/ZOOKEEPER-1679.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12576154/ZOOKEEPER-1679.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1463329.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 1 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1446//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1446//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1446//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1446//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1446//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/1446//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13685830" author="fpj" created="Mon, 17 Jun 2013 19:42:01 +0100"  >&lt;p&gt;Hi Michi,&lt;/p&gt;

&lt;p&gt;I have tried your patch with visual studio 2010 and 2012. It fails to build on both and here is the output:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;1&amp;gt;------ Build started: Project: zookeeper, Configuration: Debug Win32 ------
1&amp;gt;Build started 17/06/2013 19:14:43.
1&amp;gt;InitializeBuildStatus:
1&amp;gt;  Touching &quot;Debug\zookeeper.unsuccessfulbuild&quot;.
1&amp;gt;ClCompile:
1&amp;gt;  zk_log.c
1&amp;gt;src\c\include\winconfig.h(187): warning C4005: &apos;EWOULDBLOCK&apos; : macro redefinition
1&amp;gt;          c:\program files (x86)\microsoft visual studio 10.0\vc\include\errno.h(132) : see previous definition of &apos;EWOULDBLOCK&apos;
1&amp;gt;src\c\include\winconfig.h(188): warning C4005: &apos;EINPROGRESS&apos; : macro redefinition
1&amp;gt;          c:\program files (x86)\microsoft visual studio 10.0\vc\include\errno.h(104) : see previous definition of &apos;EINPROGRESS&apos;
1&amp;gt;src\c\src\zk_log.c(120): warning C4996: &apos;_snprintf&apos;: This function or variable may be unsafe. Consider using _snprintf_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details.
1&amp;gt;          c:\program files (x86)\microsoft visual studio 10.0\vc\include\stdio.h(363) : see declaration of &apos;_snprintf&apos;
1&amp;gt;src\c\src\zk_log.c(138): error C2143: syntax error : missing &apos;;&apos; before &apos;type&apos;
1&amp;gt;src\c\src\zk_log.c(140): error C2065: &apos;pid&apos; : undeclared identifier
1&amp;gt;src\c\src\zk_log.c(142): error C2065: &apos;pid&apos; : undeclared identifier
1&amp;gt;src\c\src\zk_log.c(146): error C2143: syntax error : missing &apos;;&apos; before &apos;type&apos;
1&amp;gt;src\c\src\zk_log.c(147): error C2143: syntax error : missing &apos;;&apos; before &apos;const&apos;
1&amp;gt;src\c\src\zk_log.c(160): error C2143: syntax error : missing &apos;;&apos; before &apos;type&apos;
1&amp;gt;src\c\src\zk_log.c(165): error C2143: syntax error : missing &apos;;&apos; before &apos;type&apos;
1&amp;gt;src\c\src\zk_log.c(171): error C2275: &apos;va_list&apos; : illegal use of this type as an expression
1&amp;gt;          c:\program files (x86)\microsoft visual studio 10.0\vc\include\vadefs.h(57) : see declaration of &apos;va_list&apos;
1&amp;gt;src\c\src\zk_log.c(171): error C2146: syntax error : missing &apos;;&apos; before identifier &apos;va&apos;
1&amp;gt;src\c\src\zk_log.c(171): error C2065: &apos;va&apos; : undeclared identifier
1&amp;gt;src\c\src\zk_log.c(172): error C2065: &apos;va&apos; : undeclared identifier
1&amp;gt;src\c\src\zk_log.c(172): warning C4047: &apos;=&apos; : &apos;int&apos; differs in levels of indirection from &apos;va_list&apos;
1&amp;gt;src\c\src\zk_log.c(173): error C2065: &apos;ofs&apos; : undeclared identifier
1&amp;gt;src\c\src\zk_log.c(173): error C2065: &apos;ofs&apos; : undeclared identifier
1&amp;gt;src\c\src\zk_log.c(173): error C2065: &apos;va&apos; : undeclared identifier
1&amp;gt;src\c\src\zk_log.c(173): warning C4047: &apos;function&apos; : &apos;va_list&apos; differs in levels of indirection from &apos;int&apos;
1&amp;gt;src\c\src\zk_log.c(173): warning C4024: &apos;vsnprintf&apos; : different types for formal and actual parameter 4
1&amp;gt;src\c\src\zk_log.c(174): error C2065: &apos;va&apos; : undeclared identifier
1&amp;gt;src\c\src\zk_log.c(174): warning C4047: &apos;=&apos; : &apos;int&apos; differs in levels of indirection from &apos;va_list&apos;
1&amp;gt;  mt_adaptor.c
1&amp;gt;src\c\include\winconfig.h(187): warning C4005: &apos;EWOULDBLOCK&apos; : macro redefinition
1&amp;gt;          c:\program files (x86)\microsoft visual studio 10.0\vc\include\errno.h(132) : see previous definition of &apos;EWOULDBLOCK&apos;
1&amp;gt;src\c\include\winconfig.h(188): warning C4005: &apos;EINPROGRESS&apos; : macro redefinition
1&amp;gt;          c:\program files (x86)\microsoft visual studio 10.0\vc\include\errno.h(104) : see previous definition of &apos;EINPROGRESS&apos;
1&amp;gt;src\c\src\mt_adaptor.c(119): error C2065: &apos;zh&apos; : undeclared identifier
1&amp;gt;src\c\src\mt_adaptor.c(119): warning C4047: &apos;function&apos; : &apos;const zhandle_t *&apos; differs in levels of indirection from &apos;int&apos;
1&amp;gt;src\c\src\mt_adaptor.c(119): warning C4024: &apos;zoo_get_log_callback&apos; : different types for formal and actual parameter 1
1&amp;gt;src\c\src\mt_adaptor.c(134): error C2065: &apos;zh&apos; : undeclared identifier
1&amp;gt;src\c\src\mt_adaptor.c(134): warning C4047: &apos;function&apos; : &apos;const zhandle_t *&apos; differs in levels of indirection from &apos;int&apos;
1&amp;gt;src\c\src\mt_adaptor.c(134): warning C4024: &apos;zoo_get_log_callback&apos; : different types for formal and actual parameter 1
1&amp;gt;src\c\src\mt_adaptor.c(498): warning C4244: &apos;=&apos; : conversion from &apos;time_t&apos; to &apos;int32_t&apos;, possible loss of data
1&amp;gt;  Generating Code...
1&amp;gt;
1&amp;gt;Build FAILED.
1&amp;gt;
1&amp;gt;Time Elapsed 00:00:00.39
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Any insight here?&lt;/p&gt;</comment>
                            <comment id="13745164" author="fpj" created="Tue, 20 Aug 2013 18:29:14 +0100"  >&lt;p&gt;+1, works for me.&lt;/p&gt;</comment>
                            <comment id="13745907" author="fpj" created="Wed, 21 Aug 2013 10:53:55 +0100"  >&lt;p&gt;Committed revision 1516126.&lt;/p&gt;</comment>
                            <comment id="13745944" author="hudson" created="Wed, 21 Aug 2013 12:06:45 +0100"  >&lt;p&gt;SUCCESS: Integrated in ZooKeeper-trunk #2030 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/2030/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/2030/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1679&quot; title=&quot;c client: use -Wdeclaration-after-statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1679&quot;&gt;&lt;del&gt;ZOOKEEPER-1679&lt;/del&gt;&lt;/a&gt;. c client: use -Wdeclaration-after-statement (michi via fpj) (fpj: &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1516126&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1516126&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/c/Makefile.am&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/c/src/cli.c&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/c/src/zookeeper.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12576154" name="ZOOKEEPER-1679.patch" size="3147" author="michim" created="Fri, 29 Mar 2013 20:27:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 29 Mar 2013 21:15:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320340</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzd4ev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320681</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>