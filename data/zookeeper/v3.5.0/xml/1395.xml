<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:50:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/ZOOKEEPER-1395/ZOOKEEPER-1395.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[ZOOKEEPER-1395] node-watcher double-free redux</title>
                <link>https://issues.apache.org/jira/browse/ZOOKEEPER-1395</link>
                <project id="12310801" key="ZOOKEEPER">ZooKeeper</project>
                    <description>&lt;p&gt;This is basically the same issue as &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-888&quot; title=&quot;c-client / zkpython: Double free corruption on node watcher&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-888&quot;&gt;&lt;del&gt;ZOOKEEPER-888&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-740&quot; title=&quot;zkpython leading to segfault on zookeeper&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-740&quot;&gt;&lt;del&gt;ZOOKEEPER-740&lt;/del&gt;&lt;/a&gt; (the latter is open as I write this, but it was superseded by the fix that went in with 888). The problem still exists after the &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-888&quot; title=&quot;c-client / zkpython: Double free corruption on node watcher&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-888&quot;&gt;&lt;del&gt;ZOOKEEPER-888&lt;/del&gt;&lt;/a&gt; patch, however; it&apos;s just more difficult to trigger:&lt;/p&gt;

&lt;p&gt;1) Zookeeper notices connection loss, schedules watcher_dispatch&lt;br/&gt;
2) Zookeeper notices session loss, schedules watcher_dispatch&lt;br/&gt;
3) watcher_dispatch runs for connection loss&lt;br/&gt;
4) pywatcher is freed due to is_unrecoverable being true&lt;br/&gt;
5) watcher_dispatch runs for session loss&lt;br/&gt;
6) PyObject_CallObject attempts to run freed pywatcher with varying bad results&lt;/p&gt;

&lt;p&gt;The fix is easy, the dispatcher should act on the state it is given, not the state of the world when it runs. (Patch attached). Reliably triggering the crash is tricky due to the race, but it&apos;s not theoretical.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12543551">ZOOKEEPER-1395</key>
            <summary>node-watcher double-free redux</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="novas0x2a">Mike Lundy</assignee>
                                    <reporter username="novas0x2a">Mike Lundy</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Feb 2012 20:01:48 +0000</created>
                <updated>Thu, 26 Apr 2012 00:37:13 +0100</updated>
                            <resolved>Fri, 30 Mar 2012 23:31:56 +0100</resolved>
                                    <version>3.3.4</version>
                                    <fixVersion>3.3.6</fixVersion>
                    <fixVersion>3.4.4</fixVersion>
                    <fixVersion>3.5.0</fixVersion>
                                    <component>c client</component>
                    <component>contrib-bindings</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13212868" author="hadoopqa" created="Tue, 21 Feb 2012 20:12:04 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12515480/0001-notify-on-event-state-not-current-state.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12515480/0001-notify-on-event-state-not-current-state.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1244776.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/958//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/958//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13212873" author="novas0x2a" created="Tue, 21 Feb 2012 20:18:12 +0000"  >&lt;p&gt;Note that the patch is cut against 3.3.4, not trunk. (Jenkins ran it against trunk)&lt;/p&gt;</comment>
                            <comment id="13217816" author="novas0x2a" created="Tue, 28 Feb 2012 01:51:07 +0000"  >&lt;p&gt;Recut patches to use -p0 instead of -p1.&lt;/p&gt;</comment>
                            <comment id="13217842" author="hadoopqa" created="Tue, 28 Feb 2012 02:30:48 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12516257/3.%5B45%5D-0001-notify-on-event-state-not-current-state.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12516257/3.%5B45%5D-0001-notify-on-event-state-not-current-state.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 1294000.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs (version 1.3.9) warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/967//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/967//testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/967//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/967//artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/967//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-ZOOKEEPER-Build/967//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13239105" author="henryr" created="Tue, 27 Mar 2012 02:35:02 +0100"  >&lt;p&gt;+1 this looks sensible to me. I&apos;ll commit tonight or tomorrow. &lt;/p&gt;</comment>
                            <comment id="13242815" author="henryr" created="Fri, 30 Mar 2012 23:31:57 +0100"  >&lt;p&gt;I just committed this to 3.3, 3.4 and 3.5. Thanks Mike!&lt;/p&gt;</comment>
                            <comment id="13243112" author="hudson" created="Sat, 31 Mar 2012 12:00:27 +0100"  >&lt;p&gt;Integrated in ZooKeeper-trunk #1513 (See &lt;a href=&quot;https://builds.apache.org/job/ZooKeeper-trunk/1513/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/ZooKeeper-trunk/1513/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1395&quot; title=&quot;node-watcher double-free redux&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1395&quot;&gt;&lt;del&gt;ZOOKEEPER-1395&lt;/del&gt;&lt;/a&gt;. node-watcher double-free redux (Mike Lundy via henryr) (Revision 1307644)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
henry : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1307644&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1307644&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/trunk/src/contrib/zkpython/src/c/zookeeper.c&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12516256" name="3.3-0001-notify-on-event-state-not-current-state.patch" size="944" author="novas0x2a" created="Tue, 28 Feb 2012 01:51:07 +0000"/>
                            <attachment id="12516257" name="3.[45]-0001-notify-on-event-state-not-current-state.patch" size="927" author="novas0x2a" created="Tue, 28 Feb 2012 01:51:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 21 Feb 2012 20:12:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228790</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxzsc7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32575</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>