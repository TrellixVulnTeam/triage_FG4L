Matrix implementation bug fix and little addition