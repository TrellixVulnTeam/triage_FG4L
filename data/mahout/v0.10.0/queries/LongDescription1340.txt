Hadoop changed a few classes to interfaces between Hadoop 1 and Hadoop 2. A couple of these classes are used in the LuceneSegment unit tests. A little bit of simple reflection abstracts these differences away and makes these tests pass under both Hadoop 1 and Hadoop 2.