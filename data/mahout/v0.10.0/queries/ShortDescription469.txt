Need to update and test QR decomposition