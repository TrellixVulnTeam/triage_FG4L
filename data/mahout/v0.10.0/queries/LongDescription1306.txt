Seems some PCA related vectors are wiped by incorrect application of directory cleanup when -ow is given. 

I will also take this opportunity to do some architectural and test cleanup.