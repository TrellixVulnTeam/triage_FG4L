Lucene/Solr 4.0.0 was released on October 12, 2012 

Many of the functionalities have changed, so it wasn't an easy migration.

I'm including a patch, which passes all junit tests, for review.