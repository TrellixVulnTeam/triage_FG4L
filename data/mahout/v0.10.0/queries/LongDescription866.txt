The Mahalanobis distance currently checks certain preconditions on member variables for every call to distance().  These should be done as part of setup, not as part of the distance call.