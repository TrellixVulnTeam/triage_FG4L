SimilarityMatrixEntryKeyPartitioner sometimes produces illegal partition numbers