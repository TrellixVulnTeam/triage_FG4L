<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:19:11 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-391/MAHOUT-391.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-391] Make vector more space efficient with variable-length encoding, et al</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-391</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;There are a few things we can do to make Vector representations smaller on disk:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Use variable-length encoding for integer values like size and element indices in sparse representations&lt;/li&gt;
	&lt;li&gt;Further, delta-encode indices in sequential representations&lt;/li&gt;
	&lt;li&gt;Let caller specify that precision isn&apos;t crucial in values, allowing it to store values as floats&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Since indices are usually small-ish, I&apos;d guess this saves 2 bytes or so on average, out of 12 bytes per element now.&lt;br/&gt;
Using floats where applicable saves another 4. Not bad.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12463761">MAHOUT-391</key>
            <summary>Make vector more space efficient with variable-length encoding, et al</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srowen">Sean Owen</assignee>
                                    <reporter username="srowen">Sean Owen</reporter>
                        <labels>
                            <label>double</label>
                            <label>encoding</label>
                            <label>float</label>
                            <label>length</label>
                            <label>optimization</label>
                            <label>variable</label>
                            <label>vector</label>
                            <label>zag</label>
                            <label>zig</label>
                    </labels>
                <created>Wed, 5 May 2010 12:34:26 +0100</created>
                <updated>Sun, 31 Oct 2010 15:49:28 +0000</updated>
                            <resolved>Tue, 11 May 2010 20:23:42 +0100</resolved>
                                    <version>0.3</version>
                                    <fixVersion>0.4</fixVersion>
                                        <due>Fri, 14 May 2010 04:00:00 +0000</due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12864292" author="robinanil" created="Wed, 5 May 2010 12:50:19 +0100"  >&lt;p&gt;I am getting build errors. Maybe you are different JUnit version ?&lt;/p&gt;

&lt;p&gt;/Users/robinanil/mahout/core/src/test/java/org/apache/mahout/math/VarintTest.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;65,6&amp;#93;&lt;/span&gt; cannot find symbol&lt;br/&gt;
symbol  : method assertEquals(long,long)&lt;br/&gt;
location: class org.apache.mahout.math.VarintTest&lt;/p&gt;</comment>
                            <comment id="12864296" author="srowen" created="Wed, 5 May 2010 12:57:42 +0100"  >&lt;p&gt;Hm, that method has been in JUnit since ancient times, and is definitely still there: &lt;a href=&quot;http://kentbeck.github.com/junit/javadoc/latest/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://kentbeck.github.com/junit/javadoc/latest/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The build compiles and passes here and I have no other local changes, so is it possible it&apos;s local to your system?&lt;/p&gt;</comment>
                            <comment id="12864300" author="robinanil" created="Wed, 5 May 2010 13:05:46 +0100"  >&lt;p&gt;No Idea why. I am doing a clean install. Anyways builds fine without the test. Here is the comparison on unigram reuters vector dataset&lt;/p&gt;


&lt;p&gt;$ ls -l reuters-vectors/tfidf/vectors/&lt;br/&gt;
-rwxrwxrwx  1   18237354 May  5 17:33 part-00000&lt;/p&gt;

&lt;p&gt;$ ls -l reuters-vector-small/tfidf/vectors/&lt;br/&gt;
-rwxrwxrwx  1   18152858 May  5 17:24 part-00000&lt;/p&gt;</comment>
                            <comment id="12864303" author="srowen" created="Wed, 5 May 2010 13:11:41 +0100"  >&lt;p&gt;Bleh, that&apos;s not much of a difference at all. Are these dense vectors? this wouldn&apos;t help them much at all, indeed. But I&apos;d be surprised if normal-ish sparse vectors aren&apos;t 20% smaller or more.&lt;/p&gt;</comment>
                            <comment id="12864304" author="robinanil" created="Wed, 5 May 2010 13:17:27 +0100"  >&lt;p&gt;import org.apache.mahout.common.MahoutTestCase;&lt;/p&gt;

&lt;p&gt;This import was missing. That was the cause of the error, though the messaging was way off. Dunno how it compiles on your side.&lt;/p&gt;</comment>
                            <comment id="12864308" author="srowen" created="Wed, 5 May 2010 13:23:34 +0100"  >&lt;p&gt;Oh I get it. My other outstanding patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-302&quot; title=&quot;Change tests to use temp directories instead of output, testdata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-302&quot;&gt;&lt;del&gt;MAHOUT-302&lt;/del&gt;&lt;/a&gt; adds a second MahoutTestCase, so that there is one for the math and core module separately. The core one extends the math one of course. This is implicitly importing the one in math, which is in the same package. But you won&apos;t have it yet.&lt;/p&gt;

&lt;p&gt;Well that goes away soon anyway when all is committed. Importing the other temporarily is a fine patch. Oops, I hadn&apos;t even imagined these could overlap.&lt;/p&gt;</comment>
                            <comment id="12864851" author="srowen" created="Thu, 6 May 2010 18:35:08 +0100"  >&lt;p&gt;Hmm, I got similar results from a crude test, generating user vectors. The on-disk size was negligibly different, and the reducer took longer by a notable amount. I just can&apos;t figure out why it isn&apos;t a win &amp;#8211; could be a bad test, or that there&apos;s some misunderstood interaction with Hadoop, but I won&apos;t commit until it&apos;s sorted. More testing needed.&lt;/p&gt;</comment>
                            <comment id="12865446" author="robinanil" created="Sat, 8 May 2010 12:52:32 +0100"  >&lt;p&gt;I am sure its just some bug somewhere, conceptually, it should reduce the space. A parallel comparison with Hadoop VIntWritable should help pinpoint it&lt;/p&gt;</comment>
                            <comment id="12866259" author="srowen" created="Tue, 11 May 2010 19:35:56 +0100"  >&lt;p&gt;Latest full patch which should properly save the bytes advertised.&lt;/p&gt;</comment>
                            <comment id="12866278" author="robinanil" created="Tue, 11 May 2010 19:57:34 +0100"  >&lt;p&gt;Its failing for me .&lt;/p&gt;


&lt;p&gt;ava.io.EOFException&lt;br/&gt;
	at java.io.DataInputStream.readFully(DataInputStream.java:180)&lt;br/&gt;
	at java.io.DataInputStream.readLong(DataInputStream.java:399)&lt;br/&gt;
	at java.io.DataInputStream.readDouble(DataInputStream.java:451)&lt;br/&gt;
	at org.apache.mahout.math.VectorWritable.readFields(VectorWritable.java:163)&lt;br/&gt;
	at org.apache.hadoop.io.serializer.WritableSerialization$WritableDeserializer.deserialize(WritableSerialization.java:67)&lt;br/&gt;
	at org.apache.hadoop.io.serializer.WritableSerialization$WritableDeserializer.deserialize(WritableSerialization.java:40)&lt;br/&gt;
	at org.apache.hadoop.io.SequenceFile$Reader.deserializeValue(SequenceFile.java:1817)&lt;br/&gt;
	at org.apache.hadoop.io.SequenceFile$Reader.getCurrentValue(SequenceFile.java:1790)&lt;br/&gt;
	at org.apache.hadoop.mapred.SequenceFileRecordReader.getCurrentValue(SequenceFileRecordReader.java:103)&lt;br/&gt;
	at org.apache.hadoop.mapred.SequenceFileRecordReader.next(SequenceFileRecordReader.java:78)&lt;br/&gt;
	at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.moveToNext(MapTask.java:192)&lt;br/&gt;
	at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.next(MapTask.java:176)&lt;br/&gt;
	at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:48)&lt;br/&gt;
	at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:358)&lt;br/&gt;
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:307)&lt;br/&gt;
	at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:177)&lt;br/&gt;
May 12, 2010 12:25:14 AM org.apache.hadoop.mapred.JobClient monitorAndPrintJob&lt;/p&gt;

&lt;p&gt;There is some problem in symmetry between serialization and deserialization. I would suggest that you use the build reuters script to test it out.&lt;/p&gt;</comment>
                            <comment id="12866280" author="srowen" created="Tue, 11 May 2010 20:00:08 +0100"  >&lt;p&gt;Sorry my brain is out to lunch today. Trying to play too fast and loose with this recent slew of changes. &lt;/p&gt;

&lt;p&gt;Indeed line 161 must match the other fix I made:&lt;/p&gt;

&lt;p&gt;          int index = Varint.readUnsignedVarInt(in);&lt;/p&gt;

&lt;p&gt;Does that do it?&lt;/p&gt;</comment>
                            <comment id="12866283" author="robinanil" created="Tue, 11 May 2010 20:19:31 +0100"  >&lt;p&gt;18237354 vs 16184485&lt;br/&gt;
Thats a 11% improvement. Awesome!&lt;/p&gt;</comment>
                            <comment id="12866289" author="srowen" created="Tue, 11 May 2010 20:23:42 +0100"  >&lt;p&gt;Yeah I think that&apos;s a solid win, and about what I&apos;d expect on average in real life. 11% less storage and network traffic at this scale is significant. Committed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12444227" name="MAHOUT-391.patch" size="18900" author="srowen" created="Tue, 11 May 2010 19:35:56 +0100"/>
                            <attachment id="12443705" name="MAHOUT-391.patch" size="18613" author="srowen" created="Wed, 5 May 2010 12:35:02 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 5 May 2010 11:50:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9673</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxy5en:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23027</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>