<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:28:09 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-958/MAHOUT-958.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-958] NullPointerException in RepresentativePointsMapper when running cluster-reuters.sh example with kmeans</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-958</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;gt; svn info
Path: .
URL: http:&lt;span class=&quot;code-comment&quot;&gt;//svn.apache.org/repos/asf/mahout/trunk
&lt;/span&gt;Repository Root: http:&lt;span class=&quot;code-comment&quot;&gt;//svn.apache.org/repos/asf
&lt;/span&gt;Repository UUID: 13f79535-47bb-0310-9956-ffa450edef68
Revision: 1235544
Node Kind: directory
Schedule: normal
Last Changed Author: tdunning
Last Changed Rev: 1231800
Last Changed Date: 2012-01-15 16:01:38 -0800 (Sun, 15 Jan 2012)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;gt; ./examples/bin/cluster-reuters.sh
...
1. kmeans clustering
...
Inter-Cluster Density: NaN
Intra-Cluster Density: 0.0
CDbw Inter-Cluster Density: 0.0
CDbw Intra-Cluster Density: NaN
CDbw Separation: 0.0
12/01/24 16:08:47 INFO clustering.ClusterDumper: Wrote 20 clusters
12/01/24 16:08:47 INFO driver.MahoutDriver: Program took 126749 ms (Minutes: 2.1124833333333335)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All five &quot;&lt;tt&gt;Representative Points Driver&lt;/tt&gt;&quot; jobs fail.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2012-01-24 16:07:11,555 INFO org.apache.hadoop.util.NativeCodeLoader: Loaded the &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt;-hadoop library
2012-01-24 16:07:11,881 INFO org.apache.hadoop.mapred.MapTask: io.sort.mb = 100
2012-01-24 16:07:11,896 INFO org.apache.hadoop.mapred.MapTask: data buffer = 79691776/99614720
2012-01-24 16:07:11,896 INFO org.apache.hadoop.mapred.MapTask: record buffer = 262144/327680
2012-01-24 16:07:11,956 INFO org.apache.hadoop.mapred.TaskLogsTruncater: Initializing logs&apos; truncater with mapRetainSize=-1 and reduceRetainSize=-1
2012-01-24 16:07:11,979 INFO org.apache.hadoop.io.nativeio.NativeIO: Initialized cache &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; UID to User mapping with a cache timeout of 14400 seconds.
2012-01-24 16:07:11,979 INFO org.apache.hadoop.io.nativeio.NativeIO: Got UserName vernica &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; UID 1000 from the &lt;span class=&quot;code-keyword&quot;&gt;native&lt;/span&gt; implementation
2012-01-24 16:07:11,981 WARN org.apache.hadoop.mapred.Child: Error running child
java.lang.NullPointerException
	at org.apache.mahout.clustering.evaluation.RepresentativePointsMapper.mapPoint(RepresentativePointsMapper.java:73)
	at org.apache.mahout.clustering.evaluation.RepresentativePointsMapper.map(RepresentativePointsMapper.java:60)
	at org.apache.mahout.clustering.evaluation.RepresentativePointsMapper.map(RepresentativePointsMapper.java:40)
	at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:144)
	at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:763)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:369)
	at org.apache.hadoop.mapred.Child$4.run(Child.java:259)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1059)
	at org.apache.hadoop.mapred.Child.main(Child.java:253)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;gt; uname -a
Linux 3.2.1-3.fc16.x86_64 #1 SMP Mon Jan 23 15:36:17 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;gt; java -version
java version &lt;span class=&quot;code-quote&quot;&gt;&quot;1.7.0_02&quot;&lt;/span&gt;
Java(TM) SE &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment (build 1.7.0_02-b13)
Java HotSpot(TM) 64-Bit Server VM (build 22.0-b10, mixed mode)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hadoop Version: 0.20.203.0, r1099333&lt;/p&gt;</environment>
        <key id="12539701">MAHOUT-958</key>
            <summary>NullPointerException in RepresentativePointsMapper when running cluster-reuters.sh example with kmeans</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dfilimon">Dan Filimon</assignee>
                                    <reporter username="rvernica">Rares Vernica</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Jan 2012 00:25:49 +0000</created>
                <updated>Mon, 3 Feb 2014 08:05:46 +0000</updated>
                            <resolved>Fri, 7 Jun 2013 20:39:10 +0100</resolved>
                                    <version>0.6</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>Examples</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13194422" author="gsingers" created="Fri, 27 Jan 2012 03:56:56 +0000"  >&lt;p&gt;Hmm,works for me on mac.  Trying linux.&lt;/p&gt;</comment>
                            <comment id="13194429" author="gsingers" created="Fri, 27 Jan 2012 04:03:35 +0000"  >&lt;p&gt;works for me on mac.  I wonder if it is Java 7?  Also, can you try clean install?&lt;/p&gt;</comment>
                            <comment id="13196366" author="ehgjr" created="Mon, 30 Jan 2012 19:48:40 +0000"  >&lt;p&gt;same error here when run on top of hadoop, running locally is just fine. i guess it has something to do with the evaluation (-e) part of clusterdump. please help fix this. Many Thanks...&lt;/p&gt;</comment>
                            <comment id="13196976" author="ehgjr" created="Tue, 31 Jan 2012 15:26:06 +0000"  >&lt;p&gt;i&apos;ve seen the problem. it&apos;s a wildcard issue with FsShell..&lt;/p&gt;</comment>
                            <comment id="13197173" author="gsingers" created="Tue, 31 Jan 2012 20:08:28 +0000"  >&lt;p&gt;ehgjr: do you have a patch, by chance?&lt;/p&gt;</comment>
                            <comment id="13197575" author="ehgjr" created="Wed, 1 Feb 2012 04:37:29 +0000"  >&lt;p&gt;hello Grant. i would love to, but i&apos;m just a newbie on this. still trying to learn Mahout...&lt;/p&gt;</comment>
                            <comment id="13268914" author="malibu66" created="Sat, 5 May 2012 08:21:00 +0100"  >&lt;p&gt;I&apos;m just starting with Mahout and I had the exact same issue running with Hadoop on a single node. I did an mvn clean install on main project, examples, core, and integration, then copied the &quot;jar&quot; files from the target directories to the main project directory and it worked fine.&lt;/p&gt;

&lt;p&gt;Edit: This problem re-appeared (and has me asking whether it actually ever worked on this version), all the rebuilding in the world hasn&apos;t fixed it. The problem is the List &quot;repPoints&quot; in RepresentativePointsMapper is null after the call to &quot;.get(key)&quot;. Checking for null and skipping the totalDistance summation stops the error, but I&apos;m not sure if its just hiding another problem further up.&lt;br/&gt;
  if (repPoints != null) {&lt;br/&gt;
    for (VectorWritable refPoint : repPoints) &lt;/p&gt;
{
      totalDistance += measure.distance(refPoint.get(), point.getVector());
    }
&lt;p&gt;  }&lt;/p&gt;
</comment>
                            <comment id="13466312" author="hessenmob" created="Sat, 29 Sep 2012 22:05:40 +0100"  >&lt;p&gt;The same happens for me when using the option -e even when running local. &lt;/p&gt;

&lt;p&gt;Current JDK is 1.6 and not 1.7 like yours.&lt;/p&gt;

&lt;p&gt;hduser@johannesvb:~$ java -version&lt;br/&gt;
java version &quot;1.6.0_35&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_35-b10)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 20.10-b01, mixed mode)&lt;/p&gt;

&lt;p&gt;I used the fix from Todd Rose which kind of fixed it. But the output&lt;/p&gt;

&lt;p&gt;12/09/29 22:58:59 INFO evaluation.ClusterEvaluator: Inter-Cluster Density = NaN&lt;br/&gt;
12/09/29 22:58:59 INFO evaluation.ClusterEvaluator: Intra-Cluster Density = 0.0&lt;br/&gt;
12/09/29 22:59:01 INFO clustering.ClusterDumper: Wrote 200 clusters&lt;/p&gt;

&lt;p&gt;implies that something breaks.&lt;/p&gt;</comment>
                            <comment id="13475225" author="baron" created="Fri, 12 Oct 2012 19:34:31 +0100"  >&lt;p&gt;I had the exact same issue, but what ehgjr said about wildcards in a January 2012 comment gave me an idea.&lt;/p&gt;

&lt;p&gt;The problem in the cluster-reuters.sh script is the &apos;clusters-*-final&apos;:&lt;br/&gt;
  $MAHOUT clusterdump \&lt;br/&gt;
    -i $&lt;/p&gt;
{WORK_DIR}/reuters-kmeans/clusters-*-final \&lt;br/&gt;
    -o ${WORK_DIR}
&lt;p&gt;/reuters-kmeans/clusterdump \&lt;br/&gt;
    -d $&lt;/p&gt;
{WORK_DIR}/reuters-out-seqdir-sparse-kmeans/dictionary.file-0 \&lt;br/&gt;
    -dt sequencefile -b 100 -n 20 --evaluate -dm org.apache.mahout.common.distance.CosineDistanceMeasure -sp 0 \&lt;br/&gt;
    --pointsDir ${WORK_DIR}
&lt;p&gt;/reuters-kmeans/clusteredPoints \&lt;/p&gt;

&lt;p&gt;For me, the clusters-*-final resolved to clusters-2-final.  So I just re-ran that one clusterdump command outside of the cluster-reuters.sh script using &apos;clusters-2-final&apos; instead and all ran fine.  Obviously not a fix to cluster-reuters.sh, but a workaround to help you see the clusterdump results.&lt;/p&gt;

&lt;p&gt;PS: I&apos;m running this over a 20-node Hadoop cluster, not locally.  It seems strange that the --input, --dictionary and --pointsDir parameters reference HDFS locations while the the --output parameter references your EdgeNode&apos;s file system.&lt;/p&gt;</comment>
                            <comment id="13539806" author="vikram.dixit" created="Thu, 27 Dec 2012 03:02:41 +0000"  >&lt;p&gt;This fixes the null pointer exception. The issue was basically the * in the path name was mentioned earlier by someone. I used the globStatus API from HDFS to get the directory that matches the glob pattern and use that as the input directory instead of directly using the passed-in string. Please let me know if this works as expected in your case.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Vikram.&lt;/p&gt;</comment>
                            <comment id="13539808" author="vikram.dixit" created="Thu, 27 Dec 2012 03:03:24 +0000"  >&lt;p&gt;Fixes the NPE in representative points mapper.&lt;/p&gt;</comment>
                            <comment id="13678346" author="gsingers" created="Fri, 7 Jun 2013 20:39:10 +0100"  >&lt;p&gt;I couldn&apos;t reproduce this, but I suspect it is due to CDH, where I have seen similar behaviors before.  At any rate, the code looked good, so I went ahead and committed it.&lt;/p&gt;</comment>
                            <comment id="13678380" author="hudson" created="Fri, 7 Jun 2013 21:10:40 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #2054 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2054/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2054/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-958&quot; title=&quot;NullPointerException in RepresentativePointsMapper when running cluster-reuters.sh example with kmeans&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-958&quot;&gt;&lt;del&gt;MAHOUT-958&lt;/del&gt;&lt;/a&gt;: fix use with globs, &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-944&quot; title=&quot;LuceneIndexToSequenceFiles (lucene2seq) utility&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-944&quot;&gt;&lt;del&gt;MAHOUT-944&lt;/del&gt;&lt;/a&gt;: minor tweak to driver.classes (Revision 1490793)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
gsingers : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/CHANGELOG&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/integration/src/main/java/org/apache/mahout/clustering/evaluation/RepresentativePointsDriver.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/src/conf/driver.classes.default.props&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12562433" name="MAHOUT-958.patch" size="2499" author="vikram.dixit" created="Thu, 27 Dec 2012 03:02:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 27 Jan 2012 03:56:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>225204</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxwdl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12688</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>