<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:28:22 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-1116/MAHOUT-1116.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-1116] WeightedVectors do not implement equals()</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-1116</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;WeightedVectors &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; implement compareTo but not equals so in cases where just the weights or the indices differ, despire compareTo returning 0, equals returns false.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/mahout/blob/trunk/math/src/main/java/org/apache/mahout/math/WeightedVector.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/mahout/blob/trunk/math/src/main/java/org/apache/mahout/math/WeightedVector.java&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12616389">MAHOUT-1116</key>
            <summary>WeightedVectors do not implement equals()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srowen">Sean Owen</assignee>
                                    <reporter username="dfilimon">Dan Filimon</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Fri, 16 Nov 2012 10:51:20 +0000</created>
                <updated>Mon, 3 Feb 2014 08:05:45 +0000</updated>
                            <resolved>Fri, 16 Nov 2012 18:06:58 +0000</resolved>
                                    <version>1.0.0</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>Math</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="13498722" author="dfilimon" created="Fri, 16 Nov 2012 10:52:40 +0000"  >&lt;p&gt;A small patch fixing the issue.&lt;/p&gt;</comment>
                            <comment id="13498725" author="srowen" created="Fri, 16 Nov 2012 10:59:32 +0000"  >&lt;p&gt;(There are many subtle Java contract problems like this in the project &amp;#8211; I had tried to fix a lot over the years. The main offenders are bad equals(), not paired with hashCode(), wrong or missing clone(). I&apos;d again encourage people to understand these and try to fix what code they committed or worked on.)&lt;/p&gt;

&lt;p&gt;Here &amp;#8211; it&apos;s not technically wrong for the ordering to define no strict ordering over objects that are even not equal, but, it&apos;s certainly weird, certainly unintended here, and has few if any legit use cases.&lt;/p&gt;</comment>
                            <comment id="13498727" author="srowen" created="Fri, 16 Nov 2012 11:04:29 +0000"  >&lt;p&gt;Looking at this again, I think the issue here is that the ordering should not be defined as a natural ordering via compareTo(), but by a separate Comparator class. Because the class wholly delegates the idea of equality to the instance it wraps, which have no natural ordering, it&apos;s actually not meaningful to say these have a natural ordering even though they have a weight field.&lt;/p&gt;</comment>
                            <comment id="13498731" author="dfilimon" created="Fri, 16 Nov 2012 11:08:04 +0000"  >&lt;p&gt;I agree that the compareTo() implementation itself is strange in that it also does the element by element comparison of the vectors.&lt;br/&gt;
Perhaps there should be a different issue for the refactoring of the comparator code.&lt;/p&gt;

&lt;p&gt;I think it&apos;s fair to decouple the equals() from the compareTo() since that&apos;s a well defined function.&lt;/p&gt;
</comment>
                            <comment id="13498734" author="dfilimon" created="Fri, 16 Nov 2012 11:15:09 +0000"  >&lt;p&gt;Updated patch.&lt;/p&gt;</comment>
                            <comment id="13498735" author="dfilimon" created="Fri, 16 Nov 2012 11:16:48 +0000"  >&lt;p&gt;I see you updated the code too removing the Comparable interface.&lt;br/&gt;
Did you check if anything breaks if WeightedVectors are no longer comparable?&lt;/p&gt;</comment>
                            <comment id="13498741" author="srowen" created="Fri, 16 Nov 2012 11:21:28 +0000"  >&lt;p&gt;Nothing breaks directly (except the tests), but this isn&apos;t conclusive. I looked at all usages of this and its subclass Centroid in the code and none involve comparison or sorting. Within Hadoop, a different interface determines comparability, so I rule that out too. I also think it&apos;s good if anyone who wrote this can comment, but don&apos;t expect this hurts.&lt;/p&gt;</comment>
                            <comment id="13498956" author="tdunning" created="Fri, 16 Nov 2012 17:36:56 +0000"  >&lt;p&gt;Breaking out the comparison into a separate Comparator (which can even be a static class inside WeightedVector) is a grand idea.&lt;/p&gt;

&lt;p&gt;Any code that breaks should be easy to fix.  Since WV is so new, this should mostly be confined to the knn code that hasn&apos;t made it into Mahout yet.&lt;/p&gt;</comment>
                            <comment id="13498980" author="srowen" created="Fri, 16 Nov 2012 18:06:58 +0000"  >&lt;p&gt;I committed my patch. I introduced the same constant (though it needs to be 1e-8 not 10e-8). I don&apos;t think can add just equals() to this class and not hashCode(). Moving out compareTo() restores it to at least a consistent state.&lt;/p&gt;</comment>
                            <comment id="13499111" author="hudson" created="Fri, 16 Nov 2012 20:12:12 +0000"  >&lt;p&gt;Integrated in Mahout-Quality #1748 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/1748/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/1748/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1116&quot; title=&quot;WeightedVectors do not implement equals()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1116&quot;&gt;&lt;del&gt;MAHOUT-1116&lt;/del&gt;&lt;/a&gt; move WeightedVector comparison to separate class for better consistency with equals (Revision 1410518)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
srowen : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1410518&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1410518&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/math/src/main/java/org/apache/mahout/math/WeightedVector.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/math/src/main/java/org/apache/mahout/math/WeightedVectorComparator.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/math/src/test/java/org/apache/mahout/math/WeightedVectorTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12553765" name="MAHOUT-1116.patch" size="4732" author="srowen" created="Fri, 16 Nov 2012 11:14:19 +0000"/>
                            <attachment id="12553766" name="WeightedVector_MAHOUT_1116.patch" size="1610" author="dfilimon" created="Fri, 16 Nov 2012 11:15:09 +0000"/>
                            <attachment id="12553763" name="WeightedVector_MAHOUT_1116.patch" size="668" author="dfilimon" created="Fri, 16 Nov 2012 10:52:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 16 Nov 2012 10:59:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>258167</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyei2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>118625</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>