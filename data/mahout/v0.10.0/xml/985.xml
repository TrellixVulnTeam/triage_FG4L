<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:26:24 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-985/MAHOUT-985.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-985] MapBackedArffModel Unable To Parse ARFF Files Containing Instance Weights</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-985</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;When parsing an Arff file that contain instance-specific weights, MapBackedArffModel throws the following NPE exception. While I have only tested this in 0.5, I suspect this bug also occur in 0.6&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.lang.NullPointerException&lt;br/&gt;
        at org.apache.mahout.utils.vectors.arff.MapBackedARFFModel.getValue(MapBackedARFFModel.java:87)&lt;br/&gt;
        at org.apache.mahout.utils.vectors.arff.ARFFIterator.computeNext(ARFFIterator.java:75)&lt;br/&gt;
        at org.apache.mahout.utils.vectors.arff.ARFFIterator.computeNext(ARFFIterator.java:30)&lt;br/&gt;
        at com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:136)&lt;br/&gt;
        at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:131)&lt;br/&gt;
        at org.apache.mahout.utils.vectors.io.SequenceFileVectorWriter.write(SequenceFileVectorWriter.java:43)&lt;br/&gt;
        at org.apache.mahout.utils.vectors.arff.Driver.writeFile(Driver.java:159)&lt;br/&gt;
        at org.apache.mahout.utils.vectors.arff.Driver.main(Driver.java:127)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
        at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)&lt;br/&gt;
        at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139)&lt;br/&gt;
        at org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:187)&lt;/p&gt;

&lt;p&gt;The code works properly when all instance weights are set to the default value of 1. However when any instance has a non-default weight, such as in the sample Arff file below, the NPE occurs when MapBackedArffModel attempts to parse line 8. &lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;@relation &apos;Test Mahout&apos;&lt;/p&gt;

&lt;p&gt;@attribute Attr0 numeric&lt;br/&gt;
@attribute Label &lt;/p&gt;
{True,False}

&lt;p&gt;@data&lt;br/&gt;
0,False&lt;br/&gt;
1,True,&lt;/p&gt;
{2}
&lt;hr /&gt;

&lt;p&gt;The reason is that in Weka, all data instances are assumed to have a default weight of 1 and this default weight is not saved in the Arff file. However when a data instance DOES NOT have the default weight of 1, the non-default instance weight is appended at the end of the line surrounded by curly braces. When MapBackedArffModel.getValue method tries to parse this weight as an attribute, typeMap.get(idx) returns a null ARFFtype as there is no such attribute, which results in an NPE. &lt;/p&gt;
</description>
                <environment></environment>
        <key id="12544095">MAHOUT-985</key>
            <summary>MapBackedArffModel Unable To Parse ARFF Files Containing Instance Weights</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srowen">Sean Owen</assignee>
                                    <reporter username="davekor">Dave Kor</reporter>
                        <labels>
                            <label>Arff</label>
                    </labels>
                <created>Sat, 25 Feb 2012 02:37:33 +0000</created>
                <updated>Mon, 3 Feb 2014 08:05:58 +0000</updated>
                            <resolved>Fri, 22 Jun 2012 12:58:14 +0100</resolved>
                                    <version>0.5</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>Integration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13216614" author="joekumar" created="Sun, 26 Feb 2012 02:09:02 +0000"  >&lt;p&gt;Dave,&lt;/p&gt;

&lt;p&gt;I am trying to understand the implication of weights when we convert an ARFF to one of the mahout vectors. Should we normalize the vector values when there is a weight specified for an instance ? In Weka, When you add weights to an instance, how does it influence the actual instance values ? &lt;br/&gt;
Depending on the usage of weight on ARFF instances, we can handle the situation in mahout. Please let me know your thoughts.&lt;/p&gt;

&lt;p&gt;Joe. &lt;/p&gt;</comment>
                            <comment id="13216709" author="davekor" created="Sun, 26 Feb 2012 12:18:29 +0000"  >&lt;p&gt;This is best answered from a machine learning perspective. Instance weights are used for quite a wide variety of ML related tasks and that is why Weka supports it. Examples include:&lt;/p&gt;

&lt;p&gt;(A) Resampling Datasets&lt;br/&gt;
Sometimes, there is a need to get the machine learning algorithm to focus on specific parts of the dataset. For example, when the dataset is imbalanced and the class label you are interested is swamped by a huge number of uninteresting instances (in other words, the proverbial needle in a haystack problem). Most techniques for handling such cases involve some form of careful resampling, either boosting the weightage of instances that have the desired class label, or down-weighting the unwanted instances, or both.&lt;/p&gt;

&lt;p&gt;(B) Smoothing or Regularization (See &lt;a href=&quot;http://en.wikipedia.org/wiki/Regularization_(mathematics&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://en.wikipedia.org/wiki/Regularization_(mathematics&lt;/a&gt;) )&lt;br/&gt;
Some methods of Bayesian learning often take into consideration the prior distribution of labels when training a model and the simpler ways of introducing a prior is apply them as instance weights. Algorithms that can make use of instance weights include Naive Bayes, K-Means, Logistic Regression, Expectation Maximization/Gradient Descent/Conjugate Gradient, Nearest Neighbor, AdaBoost and many more. &lt;/p&gt;

&lt;p&gt;These are the two main uses of instance weighting I can remember off the top of my mind. I&apos;m sure there are a few more uses that I have missed out. As to how the weights are used, it is different from algorithm to algorithm and not all algorithms will make use of instance weights. In Weka, the algorithms that to take advantage of instance weights all implement weka.core.WeightedInstanceHandler. Weka algorithms that do not implement WeightedInstanceHandler simply assume the weights don&apos;t exist. For your reference, you can see the list of algorithms at &lt;a href=&quot;http://weka.sourceforge.net/doc.dev/weka/core/WeightedInstancesHandler.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://weka.sourceforge.net/doc.dev/weka/core/WeightedInstancesHandler.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As for Mahout, I am really not in a position to say as I have only started evaluating Mahout this week. The easy way out is simply to make sure MapBackedArffModel is able to successfully parse Arff files that contain weights and throw these weights away. However, it would be good if the weights can be passed on to Mahout&apos;s algorithms and let them have a chance to use the weights if the algorithm so desires. &lt;/p&gt;

&lt;p&gt;I hope this helps.&lt;/p&gt;</comment>
                            <comment id="13217883" author="joekumar" created="Tue, 28 Feb 2012 04:27:42 +0000"  >&lt;p&gt;Since the DenseVector and RandomAccessSparseVector dont have weight attributes, we&apos;ll currently discard the weights in ARFF files. This patch contains code to discard the weights specified for instances in ARFF files. &lt;/p&gt;</comment>
                            <comment id="13399274" author="srowen" created="Fri, 22 Jun 2012 12:52:52 +0100"  >&lt;p&gt;I want to commit this. It seems to fail in the dense vector case. I&apos;m guessing that, in that case, the &apos;split&apos; items need to be trimmed, and need to be checked for &quot;?&quot;, right?&lt;/p&gt;</comment>
                            <comment id="13399369" author="hudson" created="Fri, 22 Jun 2012 16:09:02 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #1556 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/1556/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/1556/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-985&quot; title=&quot;MapBackedArffModel Unable To Parse ARFF Files Containing Instance Weights&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-985&quot;&gt;&lt;del&gt;MAHOUT-985&lt;/del&gt;&lt;/a&gt; ignore ARFF instance weights, handle ? correctly (Revision 1352857)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
srowen : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1352857&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1352857&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/integration/src/main/java/org/apache/mahout/utils/vectors/arff/ARFFIterator.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/integration/src/main/java/org/apache/mahout/utils/vectors/arff/ARFFModel.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/integration/src/test/java/org/apache/mahout/utils/vectors/arff/ARFFVectorIterableTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12516271" name="MAHOUT-985.patch" size="6720" author="joekumar" created="Tue, 28 Feb 2012 04:27:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 26 Feb 2012 02:09:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>229333</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxy1rr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22438</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>