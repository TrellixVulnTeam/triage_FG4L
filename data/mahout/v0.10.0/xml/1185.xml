<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:27:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-1185/MAHOUT-1185.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-1185] MemoryDiffStorage.class has a bug for slope one algorithm which could cause incorrect recommendation results</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-1185</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;The function processOneUser(long averageCount, long userID) in the MemoryDiffStorage.class file contains a bug for calculating the itemAverage. Since the function tried to calculate the average difference among items (in a nested loop) and also the average individual item preference value in the same loop (the loop only from 0 to length-2, &lt;b&gt;for (int i = 0; i &amp;lt; length - 1; i++)&lt;/b&gt;), the itemAverage variable does not count the last item&apos;s preference value for every users which could lead to an incorrect recommendation results.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu&lt;/p&gt;</environment>
        <key id="12640241">MAHOUT-1185</key>
            <summary>MemoryDiffStorage.class has a bug for slope one algorithm which could cause incorrect recommendation results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="srowen">Sean Owen</assignee>
                                    <reporter username="stevenzcl1">Cunlu Zou</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Apr 2013 07:39:41 +0100</created>
                <updated>Mon, 3 Feb 2014 08:05:45 +0000</updated>
                            <resolved>Tue, 2 Apr 2013 10:36:46 +0100</resolved>
                                    <version>0.7</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>Collaborative Filtering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <timeoriginalestimate seconds="600">10m</timeoriginalestimate>
                            <timeestimate seconds="600">10m</timeestimate>
                                        <comments>
                            <comment id="13619561" author="stevenzcl1" created="Tue, 2 Apr 2013 07:44:08 +0100"  >&lt;p&gt;The fixed version&lt;/p&gt;</comment>
                            <comment id="13619570" author="srowen" created="Tue, 2 Apr 2013 07:55:44 +0100"  >&lt;p&gt;Diffs are computed over all pairs of prefs in the list. The diff of a pref and itself is 0 and there is no point in computing this. Thus the outer loop is from i=0 to length-2, and the inner loop is from j=i+1 to length-1. It is correct as-is.&lt;/p&gt;

&lt;p&gt;This patch would not only cause an exception (it dereferences at length) but would incorrectly add a non-zero diff consisting just of the item&apos;s pref value &amp;#8211; there&apos;s no &quot;diff&quot; there, it&apos;s an absolute value.&lt;/p&gt;</comment>
                            <comment id="13619589" author="stevenzcl1" created="Tue, 2 Apr 2013 08:26:46 +0100"  >&lt;p&gt;Please check the code carefully, there are two variables calcuated in the processOneUser function, the average diffs (the variable &lt;b&gt;average&lt;/b&gt; in the code) calculated correctly as you said, but there is also another variable to calculate the average preference value for &lt;b&gt;individual item&lt;/b&gt; (the variable &lt;b&gt;itemAverage&lt;/b&gt; in the code), they are totally different. The itemAverage value is used when no diffs values are avaible to predict the preference, for example, suppose we have following user-pref matrix (a-c are users,A-C are items)&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;A&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;B&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;C&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;a&lt;/td&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;-&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;b&lt;/td&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;-&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;4&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;c&lt;/td&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;-&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;-&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;for user c, we wanna predict the preference value for item C, since we only know user c has the preference value for item B, but there is no diff value available between B and C, in this case, the mahout tried to use the average value for item C which is (3+4)/2=3.5 as the predict value for the item C. The same case for user c to predict the preference value for item A. By comparing the predicted values, we then recommend item C not item A to user c instead.&lt;/p&gt;

&lt;p&gt;However, the code has the mistake for calculating this average value (*NOT the DIFF value) as I stated in the previous comments, hope I made this clear.&lt;/p&gt;</comment>
                            <comment id="13619598" author="stevenzcl1" created="Tue, 2 Apr 2013 08:37:04 +0100"  >&lt;p&gt;Please check the code carefully, there are two variables calcuated in the processOneUser function, the average diffs (the variable &lt;b&gt;average&lt;/b&gt; in the code) calculated correctly as you said, but there is also another variable to calculate the average preference value for &lt;b&gt;individual item&lt;/b&gt; (the variable &lt;b&gt;itemAverage&lt;/b&gt; in the code), they are totally different. The itemAverage value is used when no diffs values are avaible to predict the preference, for example, suppose we have following user-pref matrix (a-c are users,A-C are items)&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;A&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;B&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;C&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;a&lt;/td&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;1&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;-&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;3&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;b&lt;/td&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;-&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;4&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;c&lt;/td&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;-&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;2&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;-&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;for user c, we wanna predict the preference value for item C, since we only know user c has the preference value for item B, but there is no diff value available between B and C, in this case, the mahout tried to use the average value for item C which is (3+4)/2=3.5 as the predict value for the item C. The same case for user c to predict the preference value for item A. By comparing the predicted values, we then recommend item C not item A to user c instead.&lt;/p&gt;

&lt;p&gt;However, the code has the mistake for calculating this average value (*NOT the DIFF value) as I stated in the previous comments, hope I made this clear.&lt;/p&gt;</comment>
                            <comment id="13619604" author="stevenzcl1" created="Tue, 2 Apr 2013 08:46:03 +0100"  >&lt;p&gt;Sorry, I made a mistake on the length, here is the correct patch&lt;/p&gt;</comment>
                            <comment id="13619658" author="srowen" created="Tue, 2 Apr 2013 10:36:46 +0100"  >&lt;p&gt;Done, this can actually be a one-liner change to loop to &quot;i &amp;lt; length&quot; in the outer loop.&lt;/p&gt;</comment>
                            <comment id="13619752" author="hudson" created="Tue, 2 Apr 2013 13:38:18 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #1945 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/1945/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/1945/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1185&quot; title=&quot;MemoryDiffStorage.class has a bug for slope one algorithm which could cause incorrect recommendation results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1185&quot;&gt;&lt;del&gt;MAHOUT-1185&lt;/del&gt;&lt;/a&gt; ensure last item&apos;s value is counted in average (not diffs) (Revision 1463463)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
srowen : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1463463&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1463463&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/impl/recommender/slopeone/MemoryDiffStorage.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12576522" name="MemoryDiffStorage.patch" size="977" author="stevenzcl1" created="Tue, 2 Apr 2013 08:46:03 +0100"/>
                            <attachment id="12576516" name="MemoryDiffStorage.patch" size="973" author="stevenzcl1" created="Tue, 2 Apr 2013 07:44:08 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 2 Apr 2013 06:55:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320704</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzd6nr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>321045</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>