<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:24:20 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-1091/MAHOUT-1091.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-1091] Bug in SequentialAccessSparseVector full iteration</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-1091</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;The iterator for the SequentialAccessSparseVector doesn&apos;t return any items beyond the last non-zero.  This breaks some stuff pretty massively, but hopefully doesn&apos;t break much user code since iterating through all elements of a sparse vector is a relatively rare thing to do.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12610868">MAHOUT-1091</key>
            <summary>Bug in SequentialAccessSparseVector full iteration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tdunning">Ted Dunning</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Oct 2012 21:51:32 +0100</created>
                <updated>Mon, 3 Feb 2014 08:06:17 +0000</updated>
                            <resolved>Thu, 11 Oct 2012 07:25:48 +0100</resolved>
                                                    <fixVersion>0.8</fixVersion>
                                    <component>Math</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13471891" author="paritoshranjan" created="Mon, 8 Oct 2012 22:42:19 +0100"  >&lt;p&gt;Just tried out of curiosity. The patch contains the fix and a junit test demonstrating the fix. &lt;/p&gt;

&lt;p&gt;All mahout test cases pass with this fix.&lt;/p&gt;</comment>
                            <comment id="13472156" author="tdunning" created="Tue, 9 Oct 2012 06:47:24 +0100"  >&lt;p&gt;Here is a patch relative to &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1086&quot; title=&quot;Mean Shift Test Now Produces 4 Clusters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1086&quot;&gt;&lt;del&gt;MAHOUT-1086&lt;/del&gt;&lt;/a&gt; latest patch.  It includes a test that demonstrates the problem as well as code to repair it.&lt;/p&gt;</comment>
                            <comment id="13472160" author="tdunning" created="Tue, 9 Oct 2012 06:54:29 +0100"  >&lt;p&gt;Ooops.  Correct patch is here.&lt;/p&gt;</comment>
                            <comment id="13472167" author="paritoshranjan" created="Tue, 9 Oct 2012 07:06:30 +0100"  >&lt;p&gt;The patch I submitted would fail if there are 0 non-zero elements. Still, it was interesting to look into it.&lt;/p&gt;</comment>
                            <comment id="13472554" author="tdunning" created="Tue, 9 Oct 2012 18:14:21 +0100"  >&lt;p&gt;The patch you submitted also didn&apos;t catch all the elements after the last non-zero.&lt;/p&gt;</comment>
                            <comment id="13472584" author="paritoshranjan" created="Tue, 9 Oct 2012 18:44:07 +0100"  >&lt;p&gt;There is a test case in the patch which shows it can catch elements after the last non-zero. &lt;br/&gt;
I hope the test case is correct. If not, can you point me to the error?&lt;/p&gt;</comment>
                            <comment id="13472593" author="tdunning" created="Tue, 9 Oct 2012 19:06:02 +0100"  >&lt;p&gt;The test that I saw in your patch creates a sparse vector that is MAX_INTEGER in size, but you only verify that the iterator goes through the first few elements.  It is better to create a smaller vector and verify that it scans through all of the elements, both zero and non-zero.&lt;/p&gt;

&lt;p&gt;Take a look at the test in my patch.&lt;/p&gt;</comment>
                            <comment id="13472599" author="tdunning" created="Tue, 9 Oct 2012 19:09:51 +0100"  >&lt;p&gt;For instance, this test:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testIterators() {
      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; T v0 = vectorToTest(20);

      &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; sum = 0;
      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; elements = 0;
      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; nonZero = 0;
      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Vector.Element element : v0) {
        elements++;
        sum += element.get();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (element.get() != 0) {
          nonZero++;
        }
      }
  
      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; nonZeroIterated = 0;
      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Iterator&amp;lt;Vector.Element&amp;gt; i = v0.iterateNonZero();
      &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (i.hasNext()) {
        i.next();
        nonZeroIterated++;
      }
      assertEquals(20, elements);
      assertEquals(v0.size(), elements);
      assertEquals(nonZeroIterated, nonZero);
      assertEquals(v0.zSum(), sum, 0);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note how the iteration test verifies that it sees all the elements, but sees only the non-zeros in the non-zero iteration.&lt;/p&gt;</comment>
                            <comment id="13472614" author="paritoshranjan" created="Tue, 9 Oct 2012 19:32:58 +0100"  >&lt;p&gt;Yes, got the error. The test case is failing now. The way I was creating the SequentialAccessSparseVector was faulty, as I was not using the cardinality and size of the vector properly.&lt;/p&gt;

&lt;p&gt;Thanks for clearing the doubts.&lt;/p&gt;</comment>
                            <comment id="13473755" author="tdunning" created="Thu, 11 Oct 2012 02:19:13 +0100"  >&lt;p&gt;paritosh,&lt;/p&gt;

&lt;p&gt;I don&apos;t know your timezone, but if I don&apos;t hear anything else on this, I will commit shortly.&lt;/p&gt;</comment>
                            <comment id="13473863" author="paritoshr" created="Thu, 11 Oct 2012 06:55:02 +0100"  >&lt;p&gt;yes, go ahead.&lt;/p&gt;

</comment>
                            <comment id="13473881" author="tdunning" created="Thu, 11 Oct 2012 07:25:48 +0100"  >&lt;p&gt;Committed this change.&lt;/p&gt;</comment>
                            <comment id="13473946" author="hudson" created="Thu, 11 Oct 2012 09:22:58 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #1697 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/1697/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/1697/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1091&quot; title=&quot;Bug in SequentialAccessSparseVector full iteration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1091&quot;&gt;&lt;del&gt;MAHOUT-1091&lt;/del&gt;&lt;/a&gt; - Add test to demonstrate broken iterator in SequentialAccessSparseVector (and add fix) (Revision 1396920)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tdunning : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1396920&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1396920&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/math/src/main/java/org/apache/mahout/math/SequentialAccessSparseVector.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/math/src/test/java/org/apache/mahout/math/AbstractVectorTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12548365" name="0001-MAHOUT-1091-Add-test-to-demonstrate-broken-iterator-.patch" size="5319" author="tdunning" created="Tue, 9 Oct 2012 06:54:29 +0100"/>
                            <attachment id="12548364" name="0001-MAHOUT-1091-Add-test-to-demonstrate-broken-iterator-.patch" size="5319" author="tdunning" created="Tue, 9 Oct 2012 06:47:24 +0100"/>
                            <attachment id="12548302" name="MAHOUT-1091.patch" size="2095" author="paritoshranjan" created="Mon, 8 Oct 2012 22:42:19 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Oct 2012 21:42:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245640</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy06vz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34934</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>