<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:18:22 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-1302/MAHOUT-1302.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-1302] SequenceFilesFromMailArchivesTest.testSequential failing</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-1302</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;SequenceFilesFromMailArchivesTest.testSequential is failing only on ubuntu3 and ubuntu6 Jenkins nodes. Because of that, MahoutQuality and integration job builds either fail or are successful depending on where they get run.&lt;/p&gt;

&lt;p&gt;Test fails because it expects entries in chunk-0 SequenceFile to be in specific order, but that order is not guaranteed because of the way the chunk-0 is created/filled - SequenceFilesFromMailArchives traverses input using Java&apos;s&lt;/p&gt;

&lt;p&gt;File[] java.io.File.listFiles(FileFilter filter)&lt;/p&gt;

&lt;p&gt;which does not guarantee order of files/directories.&lt;/p&gt;

&lt;p&gt;Unless we want in SequenceFileIterator to guarantee order by sorting, test needs to be changed to verify presence of given files and their content, but not their exact order.&lt;/p&gt;</description>
                <environment>&lt;p&gt;ubuntu-3 and ubuntu-6 Apache Jenkins nodes&lt;/p&gt;</environment>
        <key id="12661837">MAHOUT-1302</key>
            <summary>SequenceFilesFromMailArchivesTest.testSequential failing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="smarthi">Suneel Marthi</assignee>
                                    <reporter username="sslavic">Stevo Slavic</reporter>
                        <labels>
                            <label>test</label>
                    </labels>
                <created>Mon, 5 Aug 2013 09:34:24 +0100</created>
                <updated>Mon, 3 Feb 2014 07:57:14 +0000</updated>
                            <resolved>Fri, 6 Sep 2013 15:50:10 +0100</resolved>
                                    <version>0.8</version>
                                    <fixVersion>0.9</fixVersion>
                                    <component>Integration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13729302" author="sslavic" created="Mon, 5 Aug 2013 09:37:55 +0100"  >&lt;p&gt;Looking at standard error output at&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2184/testReport/org.apache.mahout.text/SequenceFilesFromMailArchivesTest/testSequential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2184/testReport/org.apache.mahout.text/SequenceFilesFromMailArchivesTest/testSequential/&lt;/a&gt;&lt;br/&gt;
I&apos;m no longer sure my initial analysis is entirely correct. There is something environment specific going on.&lt;br/&gt;
But, according to log for a failed execution like one above, processing order is same as for successful test run e.g. on my dev env:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Aug 05, 2013 12:48:21 AM org.slf4j.impl.JCLLoggerAdapter info
INFO: Command line arguments: {--body=null, --bodySeparator=[
], --charset=[UTF-8], --chunkSize=[64], --endPhase=[2147483647], --input=[/home/sslavic/svn/mahout/mahout/integration/target/test-data/mahout-SequenceFilesFromMailArchivesTest-8799937166382529536/mail-archives-in], --keyPrefix=[TEST], --method=[sequential], --output=[/home/sslavic/svn/mahout/mahout/integration/target/test-data/mahout-SequenceFilesFromMailArchivesTest-8799937166382529536/mail-archives-out], --separator=[], --startPhase=[0], --subject=null, --tempDir=[temp]}
Aug 05, 2013 12:48:22 AM org.apache.hadoop.util.NativeCodeLoader &amp;lt;clinit&amp;gt;
WARNING: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Aug 05, 2013 12:48:22 AM org.slf4j.impl.JCLLoggerAdapter info
INFO: At /home/sslavic/svn/mahout/mahout/integration/target/test-data/mahout-SequenceFilesFromMailArchivesTest-8799937166382529536/mail-archives-in/subdir
Aug 05, 2013 12:48:22 AM org.slf4j.impl.JCLLoggerAdapter info
INFO: At /home/sslavic/svn/mahout/mahout/integration/target/test-data/mahout-SequenceFilesFromMailArchivesTest-8799937166382529536/mail-archives-in/subdir/subsubdir
Aug 05, 2013 12:48:22 AM org.slf4j.impl.JCLLoggerAdapter info
INFO: Parsed 2 messages from directory /home/sslavic/svn/mahout/mahout/integration/target/test-data/mahout-SequenceFilesFromMailArchivesTest-8799937166382529536/mail-archives-in/subdir/subsubdir
Aug 05, 2013 12:48:22 AM org.slf4j.impl.JCLLoggerAdapter info
INFO: Parsed 4 messages from directory /home/sslavic/svn/mahout/mahout/integration/target/test-data/mahout-SequenceFilesFromMailArchivesTest-8799937166382529536/mail-archives-in/subdir
Aug 05, 2013 12:48:22 AM org.slf4j.impl.JCLLoggerAdapter info
INFO: Parsed 4 messages from /home/sslavic/svn/mahout/mahout/integration/target/test-data/mahout-SequenceFilesFromMailArchivesTest-8799937166382529536/mail-archives-in
Aug 05, 2013 12:48:22 AM org.slf4j.impl.JCLLoggerAdapter info
INFO: Conversion took 465ms
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Still seems like environment specific issue. Guessing maybe hdfs config is different, or local FS, or JVM vendor/version.&lt;/p&gt;</comment>
                            <comment id="13729303" author="sslavic" created="Mon, 5 Aug 2013 09:40:26 +0100"  >&lt;p&gt;Comment by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdunning&quot; class=&quot;user-hover&quot; rel=&quot;tdunning&quot;&gt;Ted Dunning&lt;/a&gt; on &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/mahout-dev/201308.mbox/%3CCAJwFCa2Sv2wAhitYtzUaOSiKjtZE4BTRisxPOyAfyUsM2rv26A%40mail.gmail.com%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;dev mailing list&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I think that deterministicizing (new word alert) the order is a good thing.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="13751794" author="sslavic" created="Tue, 27 Aug 2013 23:22:55 +0100"  >&lt;p&gt;I&apos;ve just committed a change to fix the issue by making order of processing mail archives and (sub)directories deterministic and non-OS specific - first processing files then nested directories, just as expected by &lt;tt&gt;SequenceFilesFromMailArchivesTest.testSequential&lt;/tt&gt; unit test.&lt;/p&gt;

&lt;p&gt;I don&apos;t like the design of &lt;tt&gt;SequenceFilesFromMailArchives&lt;/tt&gt; - it&apos;s using &lt;tt&gt;PrefixAdditionFilter&lt;/tt&gt; which is a &lt;tt&gt;FileFilter&lt;/tt&gt; to traverse the FS tree. That felt unnatural before my change, and feels even more unnatural now after the change.&lt;/p&gt;</comment>
                            <comment id="13751865" author="hudson" created="Wed, 28 Aug 2013 00:14:08 +0100"  >&lt;p&gt;SUCCESS: Integrated in Mahout-Quality #2213 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2213/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2213/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1302&quot; title=&quot;SequenceFilesFromMailArchivesTest.testSequential failing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1302&quot;&gt;&lt;del&gt;MAHOUT-1302&lt;/del&gt;&lt;/a&gt; Made order of processing mail archives and (sub)directories deterministic and non-OS specific - first processing files then nested directories, just as expected by unit test (sslavic: rev 1517996)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/integration/src/main/java/org/apache/mahout/text/SequenceFilesFromMailArchives.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13752049" author="tdunning" created="Wed, 28 Aug 2013 04:08:12 +0100"  >&lt;blockquote&gt;
&lt;p&gt;I don&apos;t like the design of &lt;tt&gt;SequenceFilesFromMailArchives&lt;/tt&gt; - it&apos;s using &lt;tt&gt;PrefixAdditionFilter&lt;/tt&gt; which is a &lt;tt&gt;FileFilter&lt;/tt&gt; to traverse the FS tree. That felt unnatural before my change, and feels even more unnatural now after the change.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Stevo,&lt;/p&gt;

&lt;p&gt;I really don&apos;t think that &lt;b&gt;anybody&lt;/b&gt; is attached to the current implementation.  If you see something that is better, I would very much expect that everybody would applaud and not complain.&lt;/p&gt;</comment>
                            <comment id="13752787" author="sslavic" created="Wed, 28 Aug 2013 20:58:13 +0100"  >&lt;p&gt;Replaced &lt;tt&gt;PrefixAdditionFilter&lt;/tt&gt; &lt;tt&gt;java.io.FileFilter&lt;/tt&gt; usage for walking directory tree with an commons-io &lt;tt&gt;DirectoryWalker&lt;/tt&gt; based implementation.&lt;/p&gt;

&lt;p&gt;When Java 7 becomes min JDK for the Mahout project, we should consider using &lt;tt&gt;java.nio.file.FileVisitor&lt;/tt&gt; and &lt;tt&gt;java.nio.file.Files.walkFileTree&lt;/tt&gt; instead, to remove commons-io dependency.&lt;/p&gt;</comment>
                            <comment id="13752851" author="hudson" created="Wed, 28 Aug 2013 22:12:01 +0100"  >&lt;p&gt;FAILURE: Integrated in Mahout-Quality #2214 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2214/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2214/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1302&quot; title=&quot;SequenceFilesFromMailArchivesTest.testSequential failing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1302&quot;&gt;&lt;del&gt;MAHOUT-1302&lt;/del&gt;&lt;/a&gt; Replaced PrefixAddition FileFilter with equivalent implementation of commons-io DirectoryWalker, for walking the directory tree (sslavic: rev 1518338)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/integration/pom.xml&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/integration/src/main/java/org/apache/mahout/text/SequenceFilesFromMailArchives.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13753449" author="sslavic" created="Thu, 29 Aug 2013 10:11:30 +0100"  >&lt;p&gt;Issue is fixed - was able to reproduce failing test when changing order of dirs and files (dirs first, files after - then it fails), and code in place now guarantees correct order as expected by test (first files then dirs).&lt;br/&gt;
Anyway, will close the issue once test passes on either ubuntu-3 or ubuntu-6 node.&lt;/p&gt;</comment>
                            <comment id="13754556" author="hudson" created="Fri, 30 Aug 2013 11:19:36 +0100"  >&lt;p&gt;FAILURE: Integrated in Mahout-Quality #2217 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2217/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2217/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1302&quot; title=&quot;SequenceFilesFromMailArchivesTest.testSequential failing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1302&quot;&gt;&lt;del&gt;MAHOUT-1302&lt;/del&gt;&lt;/a&gt; Made message counts stack reference final (sslavic: rev 1518920)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/integration/src/main/java/org/apache/mahout/text/SequenceFilesFromMailArchives.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13760237" author="smarthi" created="Fri, 6 Sep 2013 15:50:10 +0100"  >&lt;p&gt;Fixed by Stevo Slavic.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12668889">MAHOUT-1334</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 27 Aug 2013 23:14:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>341841</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzgsqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342147</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>