<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:23:35 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-404/MAHOUT-404.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-404] AbstractJob improvements.</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-404</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;Per discussion : &lt;a href=&quot;http://lucene.472066.n3.nabble.com/Re-input-now-Dmapred-input-dir-td852297.html#a852297&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.472066.n3.nabble.com/Re-input-now-Dmapred-input-dir-td852297.html#a852297&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;With the advent of the parsedArgs map returned by AbstractJob.parseArguments is there&lt;br/&gt;
a need to pass Option arguments around anymore? Could AbstractJob maintain&lt;br/&gt;
Options state in a sense?&lt;/p&gt;

&lt;p&gt;For example, from RecommenderJob:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    Option numReccomendationsOpt = AbstractJob.buildOption(&lt;span class=&quot;code-quote&quot;&gt;&quot;numRecommendations&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;n&quot;&lt;/span&gt;, 
      &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of recommendations per user&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;10&quot;&lt;/span&gt;);
    Option usersFileOpt = AbstractJob.buildOption(&lt;span class=&quot;code-quote&quot;&gt;&quot;usersFile&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;u&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;File of users to recommend &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
    Option booleanDataOpt = AbstractJob.buildOption(&lt;span class=&quot;code-quote&quot;&gt;&quot;booleanData&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;Treat input as without pref values&quot;&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.FALSE.toString());

    Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; parsedArgs = AbstractJob.parseArguments(
        args, numReccomendationsOpt, usersFileOpt, booleanDataOpt);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (parsedArgs == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; -1;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Could be changed to something like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
buildOption(&lt;span class=&quot;code-quote&quot;&gt;&quot;numRecommendations&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;n&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of recommendations per user&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;10&quot;&lt;/span&gt;);
buildOption(&lt;span class=&quot;code-quote&quot;&gt;&quot;usersFile&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;u&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;File of users to recommend &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
buildOption(&lt;span class=&quot;code-quote&quot;&gt;&quot;booleanData&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;Treat input as without pref values&quot;&lt;/span&gt;,
&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.FALSE.toString());
Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; parsedArgs = parseArguments(); 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12465694">MAHOUT-404</key>
            <summary>AbstractJob improvements.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="drew.farris">Drew Farris</assignee>
                                    <reporter username="drew.farris">Drew Farris</reporter>
                        <labels>
                    </labels>
                <created>Sat, 29 May 2010 04:42:43 +0100</created>
                <updated>Sun, 31 Oct 2010 15:49:32 +0000</updated>
                            <resolved>Thu, 8 Jul 2010 13:44:19 +0100</resolved>
                                    <version>0.4</version>
                                    <fixVersion>0.4</fixVersion>
                                    <component>Integration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12873231" author="drew.farris" created="Sat, 29 May 2010 04:48:54 +0100"  >&lt;p&gt;This captures the idea in patch form. Haven&apos;t done any testing with it yet.&lt;/p&gt;</comment>
                            <comment id="12873657" author="srowen" created="Mon, 31 May 2010 14:51:15 +0100"  >&lt;p&gt;I&apos;m into the idea &amp;#8211; make changes like this as you see fit, as far as I&apos;m concerned.&lt;/p&gt;</comment>
                            <comment id="12875925" author="drew.farris" created="Sat, 5 Jun 2010 20:25:41 +0100"  >&lt;p&gt;Updated patch to show where I&apos;m going with this &amp;#8211; Abstract job holds more state now. Added support for flag options which have no arguments (e.g: -ow for overwrite). CollocDriver demonstrates most of the improvements since I know this code the best.&lt;/p&gt;

&lt;p&gt;Still getting:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
WARNING: Use GenericOptionsParser &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; parsing the arguments. Applications should implement Tool &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the same.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When launching jobs using this code. Next step is to track that one down. Working in patches for now because I can&apos;t judge the brokenness of this for the other jobs quite yet.&lt;/p&gt;</comment>
                            <comment id="12876222" author="srowen" created="Mon, 7 Jun 2010 13:18:26 +0100"  >&lt;p&gt;Looks OK to me. As far as I&apos;m concerned, go ahead and let me play with the result.&lt;/p&gt;</comment>
                            <comment id="12876517" author="drew.farris" created="Tue, 8 Jun 2010 03:07:57 +0100"  >&lt;p&gt;Thanks for the look over, Sean. I&apos;ll commit.&lt;/p&gt;

&lt;p&gt;In the event we need to back it out, here&apos;s the latest version of the patch - it cleans up Generic Options Parser warnings in some cases. &lt;/p&gt;

&lt;p&gt;When -h is provided to something derived from AbstractJob, it will print out both the GenericOptionsParser arguments and the job-specific options.&lt;/p&gt;</comment>
                            <comment id="12876530" author="hudson" created="Tue, 8 Jun 2010 04:20:55 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #56 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Mahout-Quality/56/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Mahout-Quality/56/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-404&quot; title=&quot;AbstractJob improvements.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-404&quot;&gt;&lt;del&gt;MAHOUT-404&lt;/del&gt;&lt;/a&gt;: AbstractJob Improvements&lt;/p&gt;</comment>
                            <comment id="12876653" author="srowen" created="Tue, 8 Jun 2010 12:52:25 +0100"  >&lt;p&gt;Do I understand correctly that...&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Just about everything works as before, we just need to build options with buildOption()&lt;/li&gt;
	&lt;li&gt;Call addInputOption() and addOutputOption() to parse standard input/output option&lt;/li&gt;
	&lt;li&gt;Call getInputPath() and getOutputPath() to correctly determine input path?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If so I&apos;ll finish out a few more changes to implement the above.&lt;br/&gt;
Should we not make the input/output options always present and parsed for all jobs by moving to parseArgs()? like some other args are.&lt;/p&gt;</comment>
                            <comment id="12876675" author="drew.farris" created="Tue, 8 Jun 2010 14:25:15 +0100"  >&lt;blockquote&gt;
&lt;p&gt;Do I understand correctly that...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Just about everything works as before, we just need to build options with buildOption()&lt;/li&gt;
	&lt;li&gt;Call addInputOption() and addOutputOption() to parse standard input/output option&lt;/li&gt;
	&lt;li&gt;Call getInputPath() and getOutputPath() to correctly determine input path?&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;Yep, these are all correct. One subtlety that&apos;s different from before is that the map returned by parseArgs(String[]) will contain keys with null values for options without arguments, such as those used to indicate that an overwrite should happen. I think that&apos;s the only added behavior. &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Should we not make the input/output options always present and parsed for all jobs by moving to parseArgs()? like some other args are.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;There were some jobs that used arguments different from the standard -i and -o options so I decided to leave these up to the developer implementing the job (e.g: MatricMultiplicationJob which has two separate inputs) instead of automatically adding them for all jobs.&lt;/p&gt;

&lt;p&gt;Unrelated put worth pointing out to others who might come across this issue: I&apos;m assuming that not all jobs will use prepareJob in AbstractJob to set themselves up. In cases like these it is pretty essential to pass the Configuration objects into whichever job is being set up, otherwise they won&apos;t be configured based on the options provided via GenericOptionsParser. &lt;/p&gt;
</comment>
                            <comment id="12876686" author="tdunning" created="Tue, 8 Jun 2010 15:38:47 +0100"  >&lt;blockquote&gt;
&lt;p&gt;Should we not make the input/output options always present and parsed for all jobs by moving to parseArgs()? like some other args are.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Some jobs don&apos;t have conventional inputs and outputs.  Imagine a random cluster test data generator.  It would have output, but no input.  Likewise some programs have two outputs or none except minor diagnostics.&lt;/p&gt;</comment>
                            <comment id="12877137" author="srowen" created="Wed, 9 Jun 2010 18:02:38 +0100"  >&lt;p&gt;OK here&apos;s a follow on patch from me. Thoughts?&lt;/p&gt;</comment>
                            <comment id="12877171" author="srowen" created="Wed, 9 Jun 2010 20:04:35 +0100"  >&lt;p&gt;Ah one wrinkle here. This is making &quot;--input&quot; required when I had thought we&apos;d want to support this in addition to the standard &quot;-Dmapred.input.dir&quot; param which is also in use. Same for output.&lt;/p&gt;

&lt;p&gt;This can be solved by making --input optional and a little more change in the parsing. &lt;br/&gt;
But then --input is optional everywhere.&lt;/p&gt;

&lt;p&gt;But maybe that issue then is good impetus to update to use the new job framework, wherever it causes a problem.&lt;/p&gt;</comment>
                            <comment id="12877830" author="hudson" created="Fri, 11 Jun 2010 16:20:30 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #69 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Mahout-Quality/69/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Mahout-Quality/69/&lt;/a&gt;)&lt;/p&gt;
</comment>
                            <comment id="12883375" author="drew.farris" created="Tue, 29 Jun 2010 02:04:19 +0100"  >&lt;p&gt;Just ran into the effect of making --input optional. The way the code is now I need to do null checks on input paths returned by AbstractJob.getInputPath(). I saw that the may also be a problem in ItemSimilarityJob or any ofther classes that call AbstractJob.prepareJob(..) &lt;/p&gt;

&lt;p&gt;I&apos;m thinking we could print out a help message if AbstractJob.addInputOption() was called and neither --input of -Dmapred.input.dir was specified. Does this sound right?&lt;/p&gt;
</comment>
                            <comment id="12883436" author="srowen" created="Tue, 29 Jun 2010 07:54:53 +0100"  >&lt;p&gt;Yes ideally the behavior is to error at some point if neither was specified, since at least one should be.&lt;/p&gt;</comment>
                            <comment id="12883776" author="drew.farris" created="Wed, 30 Jun 2010 04:05:52 +0100"  >&lt;p&gt;Here&apos;s a patch that modifies AbstractJob.parseDirectories to catch the case where addInputOption() or addOutputOption() has been called but no input/output option or property (mapred.input.dir/mapred.output.dir) is specified. In this case help will be displayed and parseArguments will return null.&lt;/p&gt;

&lt;p&gt;It also fixes an issue with the handling of &apos;flag&apos; options where the option key would appear in the map produced by parseArguments even though the flag wasn&apos;t specified on the command-line. In such a case, the key should not appear in the map.&lt;/p&gt;

&lt;p&gt;Also includes AbstractJobTest - a unit test for the flag handling, general option handling and input/output directoy option handling.&lt;/p&gt;

&lt;p&gt;Take a look, let me know if this all makes sense.&lt;/p&gt;
</comment>
                            <comment id="12885798" author="drew.farris" created="Wed, 7 Jul 2010 03:44:40 +0100"  >&lt;p&gt;Any objections? &lt;/p&gt;</comment>
                            <comment id="12886173" author="hudson" created="Thu, 8 Jul 2010 02:06:06 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #125 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Mahout-Quality/125/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Mahout-Quality/125/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-404&quot; title=&quot;AbstractJob improvements.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-404&quot;&gt;&lt;del&gt;MAHOUT-404&lt;/del&gt;&lt;/a&gt;: AbstractJob fixes from &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12448373/MAHOUT-404.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12448373/MAHOUT-404.patch&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12448373" name="MAHOUT-404.patch" size="14349" author="drew.farris" created="Wed, 30 Jun 2010 04:05:52 +0100"/>
                            <attachment id="12446710" name="MAHOUT-404.patch" size="25126" author="srowen" created="Wed, 9 Jun 2010 18:02:38 +0100"/>
                            <attachment id="12446556" name="MAHOUT-404.patch" size="49775" author="drew.farris" created="Tue, 8 Jun 2010 03:07:57 +0100"/>
                            <attachment id="12446414" name="MAHOUT-404.patch" size="47124" author="drew.farris" created="Sat, 5 Jun 2010 20:25:41 +0100"/>
                            <attachment id="12445831" name="MAHOUT-404.patch" size="19056" author="drew.farris" created="Sat, 29 May 2010 04:48:54 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 31 May 2010 13:51:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9660</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxy5br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23014</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>