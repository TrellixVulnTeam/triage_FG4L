<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:21:08 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-1578/MAHOUT-1578.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-1578] Optimizations in matrix serialization</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-1578</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;MatrixWritable contains inefficient code in a few places:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;type and size are stored with every vector, although they are the same for every vector&lt;/li&gt;
	&lt;li&gt;in some places vectors are added to the matrix via assign() in places where we could directly use the instance&lt;/li&gt;
&lt;/ul&gt;

</description>
                <environment></environment>
        <key id="12720523">MAHOUT-1578</key>
            <summary>Optimizations in matrix serialization</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ssc">Sebastian Schelter</assignee>
                                    <reporter username="ssc">Sebastian Schelter</reporter>
                        <labels>
                            <label>legacy</label>
                    </labels>
                <created>Wed, 11 Jun 2014 08:29:14 +0100</created>
                <updated>Mon, 13 Apr 2015 10:57:33 +0100</updated>
                            <resolved>Sat, 28 Mar 2015 17:11:16 +0000</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Math</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14027666" author="githubbot" created="Wed, 11 Jun 2014 12:56:57 +0100"  >&lt;p&gt;GitHub user sscdotopen opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/mahout/pull/16&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/mahout/pull/16&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1578&quot; title=&quot;Optimizations in matrix serialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1578&quot;&gt;&lt;del&gt;MAHOUT-1578&lt;/del&gt;&lt;/a&gt; Optimizations in matrix serialization&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1578&quot; title=&quot;Optimizations in matrix serialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1578&quot;&gt;&lt;del&gt;MAHOUT-1578&lt;/del&gt;&lt;/a&gt;: Optimizations in matrix serialization&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/sscdotopen/mahout&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/sscdotopen/mahout&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1578&quot; title=&quot;Optimizations in matrix serialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1578&quot;&gt;&lt;del&gt;MAHOUT-1578&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/mahout/pull/16.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/mahout/pull/16.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #16&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 645604c7a81762df19bfe3023fcc474490f4c183&lt;br/&gt;
Author: ssc &amp;lt;ssc@apache.org&amp;gt;&lt;br/&gt;
Date:   2014-06-11T11:52:11Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1578&quot; title=&quot;Optimizations in matrix serialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1578&quot;&gt;&lt;del&gt;MAHOUT-1578&lt;/del&gt;&lt;/a&gt; Optimizations in matrix serialization&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14027681" author="githubbot" created="Wed, 11 Jun 2014 13:10:05 +0100"  >&lt;p&gt;Github user sscdotopen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/mahout/pull/16#issuecomment-45732877&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/mahout/pull/16#issuecomment-45732877&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Can someone have a look at the changes? They passed unit-tests.&lt;/p&gt;</comment>
                            <comment id="14028235" author="githubbot" created="Wed, 11 Jun 2014 20:02:11 +0100"  >&lt;p&gt;Github user dlyubimov commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/mahout/pull/16#issuecomment-45784922&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/mahout/pull/16#issuecomment-45784922&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    So what does performance comparison look like?&lt;/p&gt;</comment>
                            <comment id="14028275" author="githubbot" created="Wed, 11 Jun 2014 20:28:40 +0100"  >&lt;p&gt;Github user sscdotopen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/mahout/pull/16#issuecomment-45788172&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/mahout/pull/16#issuecomment-45788172&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Haven&apos;t done any benchmarking so far. But usually, lots of small improvements make a difference in the end.  &lt;/p&gt;</comment>
                            <comment id="14028285" author="githubbot" created="Wed, 11 Jun 2014 20:35:18 +0100"  >&lt;p&gt;Github user sscdotopen commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/mahout/pull/16#issuecomment-45788881&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/mahout/pull/16#issuecomment-45788881&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I had some of those fixes included in the experiments that I ran last week. I did not measure the impact of individual fixes explicitly, but changes like directly setting an array of row vectors instead of assigning every row (where entries are potentially added with binary search in sequential sparse vectors) seem to have made a huge difference. &lt;/p&gt;

&lt;p&gt;    I had jobs that seemed to hang for minutes and when I jstacked on the workers, I saw that the code was busily wasting CPU in assigning entries to sparse rows in matrix deserialization... &lt;/p&gt;</comment>
                            <comment id="14028844" author="githubbot" created="Thu, 12 Jun 2014 06:34:50 +0100"  >&lt;p&gt;Github user dlyubimov commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/mahout/pull/16#discussion_r13688078&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/mahout/pull/16#discussion_r13688078&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: mrlegacy/src/main/java/org/apache/mahout/math/MatrixWritable.java &amp;#8212;&lt;br/&gt;
    @@ -113,27 +113,28 @@ public static Matrix readMatrix(DataInput in) throws IOException {&lt;br/&gt;
         int rows = in.readInt();&lt;br/&gt;
         int columns = in.readInt();&lt;/p&gt;

&lt;p&gt;    +    byte vectorFlags = in.readByte();&lt;br/&gt;
    +&lt;br/&gt;
         Matrix matrix;&lt;br/&gt;
    +&lt;br/&gt;
         if (dense) &lt;/p&gt;
{
           matrix = new DenseMatrix(rows, columns);
    -    }
&lt;p&gt; else {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (isSparseRowMatrix) 
{
    -        matrix = new SparseRowMatrix(rows, columns, sequential);
    -      }
&lt;p&gt; else {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;matrix = new SparseMatrix(rows, columns);&lt;br/&gt;
    +      for (int row = 0; row &amp;lt; rows; row++) 
{
    +        matrix.assignRow(row, VectorWritable.readVector(in, vectorFlags, columns));
           }&lt;/li&gt;
	&lt;li&gt;}&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;if (dense || isSparseRowMatrix) 
{
    +    }
&lt;p&gt; else if (isSparseRowMatrix) {&lt;br/&gt;
    +      Vector[] rowVectors = new Vector&lt;span class=&quot;error&quot;&gt;&amp;#91;rows&amp;#93;&lt;/span&gt;;&lt;br/&gt;
           for (int row = 0; row &amp;lt; rows; row++) {&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;matrix.assignRow(row, VectorWritable.readVector(in));
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    is that where the major problem was? is that because assignment of sequential vector to sequential vector is that slow? or this is an assignment of random vector to a sequential vector? (sequential to sequential actually should be ok methinks). &lt;/p&gt;

&lt;p&gt;    Anyway I don&apos;t see any immediate problems, and the quality of your work usually doesn&apos;t require any deep scrutiny, so i&apos;d say ship it. Actually the sooner the better, because i am very close to actually give it all a good spanking&lt;/p&gt;</comment>
                            <comment id="14029414" author="githubbot" created="Thu, 12 Jun 2014 18:04:22 +0100"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/mahout/pull/16&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/mahout/pull/16&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14029470" author="hudson" created="Thu, 12 Jun 2014 18:29:16 +0100"  >&lt;p&gt;SUCCESS: Integrated in Mahout-Quality #2651 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2651/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2651/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1578&quot; title=&quot;Optimizations in matrix serialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1578&quot;&gt;&lt;del&gt;MAHOUT-1578&lt;/del&gt;&lt;/a&gt; Optimizations in matrix serialization (ssc) closes apache/mahout#16 (ssc: rev a8e09cd3aa1c9d6fdda2eaf84f86a06a33963658)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;mrlegacy/src/main/java/org/apache/mahout/math/MatrixWritable.java&lt;/li&gt;
	&lt;li&gt;mrlegacy/src/main/java/org/apache/mahout/math/VectorWritable.java&lt;/li&gt;
	&lt;li&gt;CHANGELOG&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14349748" author="andrew_palumbo" created="Fri, 6 Mar 2015 01:24:07 +0000"  >&lt;p&gt;this can be closed right?&lt;/p&gt;</comment>
                            <comment id="14385417" author="andrew.musselman" created="Sat, 28 Mar 2015 17:11:16 +0000"  >&lt;p&gt;Looks resolved; re-open if needed.&lt;/p&gt;</comment>
                            <comment id="14492191" author="sslavic" created="Mon, 13 Apr 2015 10:57:33 +0100"  >&lt;p&gt;Bulk closing all 0.10.0 resolved issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 11 Jun 2014 11:56:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>398722</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzqi0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>398844</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>