<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:28:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-467/MAHOUT-467.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-467] Change Iterable&lt;Cooccurrence&gt; in  org.apache.mahout.math.hadoop.similarity.RowSimilarityJob.SimilarityReducer  to list or array to improve the performance</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-467</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;In Class AbstractDistributedVectorSimilarity&lt;/p&gt;


&lt;p&gt;      protected int countElements(Iterator&amp;lt;?&amp;gt; iterator)&lt;br/&gt;
      { int count = 0;&lt;br/&gt;
          while (iterator.hasNext()) &lt;br/&gt;
          &lt;/p&gt;
{
                  count++; 
                  iterator.next(); 
           }
&lt;p&gt; return count; &lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;The method countElements is used continually and is called continually ,but it has bad performance.&lt;/p&gt;

&lt;p&gt;If the iterator has million elements ,we have to iterate million  times to just get the count of the iterator.&lt;/p&gt;


&lt;p&gt;this methods used in many pacles:&lt;br/&gt;
1) DistributedCooccurrenceVectorSimilarity &lt;/p&gt;

&lt;p&gt;public class DistributedCooccurrenceVectorSimilarity extends AbstractDistributedVectorSimilarity {&lt;/p&gt;

&lt;p&gt;  @Override&lt;br/&gt;
  protected double doComputeResult(int rowA, int rowB, Iterable&amp;lt;Cooccurrence&amp;gt; cooccurrences, double weightOfVectorA,&lt;br/&gt;
      double weightOfVectorB, int numberOfColumns) &lt;/p&gt;
{
    return countElements(cooccurrences);
  }

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;one items may be liked by many people, we has system ,one items may be liked by  hundred thousand persons,&lt;br/&gt;
Here doComputeResult just returned the count of elements in  cooccurrences,but It has to iterate for hundred thousand times.&lt;/p&gt;

&lt;p&gt;If we use List or Array type,we can get the result in one call. because it already sets the size of the Array or list when system constructs the List or Array.&lt;/p&gt;

&lt;p&gt;2)  DistributedLoglikelihoodVectorSimilarity&lt;br/&gt;
3)  DistributedTanimotoCoefficientVectorSimilarity&lt;/p&gt;


&lt;p&gt;I have doing a test using DistributedCooccurrenceVectorSimilarity &lt;br/&gt;
it used 4.5 hours to run RowSimilarityJob-CooccurrencesMapper-SimilarityReducer&lt;/p&gt;</description>
                <environment></environment>
        <key id="12471414">MAHOUT-467</key>
            <summary>Change Iterable&lt;Cooccurrence&gt; in  org.apache.mahout.math.hadoop.similarity.RowSimilarityJob.SimilarityReducer  to list or array to improve the performance</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="srowen">Sean Owen</assignee>
                                    <reporter username="huiwenhan">Han Hui Wen </reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Aug 2010 14:17:54 +0100</created>
                <updated>Sat, 21 May 2011 04:22:29 +0100</updated>
                            <resolved>Wed, 22 Sep 2010 08:12:35 +0100</resolved>
                                    <version>0.4</version>
                                                    <component>Collaborative Filtering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12897771" author="ssc" created="Thu, 12 Aug 2010 15:33:32 +0100"  >&lt;p&gt;For the millions of cooccurrences to be modeled as a list or an array, we would have to simultaneously load them all into memory.&lt;br/&gt;
We can&apos;t do this because then the scalability of the whole job would be limited by the amount of RAM available on the worker machines. &lt;/p&gt;

&lt;p&gt;IIRC Mahout&apos;s goal is that its distributed jobs run in linear time compared to the amount of input data and need a constant amount of memory.&lt;/p&gt;</comment>
                            <comment id="12897791" author="huiwenhan" created="Thu, 12 Aug 2010 16:22:52 +0100"  >&lt;p&gt;millions of cooccurrences is just a assumption.&lt;/p&gt;

&lt;p&gt;even thousand of cooccurrences ,iterating just for count is low performance.&lt;/p&gt;</comment>
                            <comment id="12897799" author="ssc" created="Thu, 12 Aug 2010 16:34:35 +0100"  >&lt;p&gt;There&apos;s no point of time in the algorithm before the invocation of the SimilarityReducer where all cooccurrences for a pair of rows are seen together, so to load them into memory there it would also be necessary to iterate over them.&lt;/p&gt;</comment>
                            <comment id="12897904" author="tdunning" created="Thu, 12 Aug 2010 20:21:37 +0100"  >&lt;p&gt;This does expose another problem, though, in that these counts should be combined in addition to being reduced.  That means that the count++ should be something like count += value and there should be an upstream combiner somewhere.&lt;/p&gt;

&lt;p&gt;That will do much more good than using lists.&lt;/p&gt;</comment>
                            <comment id="12898048" author="huiwenhan" created="Fri, 13 Aug 2010 03:30:18 +0100"  >&lt;p&gt;I have opened one issue for MAPREDUCE,here is their comment :&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-2007&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/MAPREDUCE-2007&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="12898051" author="tdunning" created="Fri, 13 Aug 2010 03:43:10 +0100"  >
&lt;p&gt;That comment from Owen is essentially the same as what I and others have said.  If you need to count, use integers and combiners.  Don&apos;t wait until the reducer.&lt;/p&gt;

&lt;p&gt;In any case, it isn&apos;t a MAHOUT bug that map-reduce inherently doesn&apos;t allow you to see all the data being reduced in one place.&lt;/p&gt;

&lt;p&gt;Anybody mind if I close this as NOT-A-BUG?&lt;/p&gt;
</comment>
                            <comment id="12899801" author="hudson" created="Wed, 18 Aug 2010 10:29:14 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #200 (See &lt;a href=&quot;https://hudson.apache.org/hudson/job/Mahout-Quality/200/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/Mahout-Quality/200/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-467&quot; title=&quot;Change Iterable&amp;lt;Cooccurrence&amp;gt; in  org.apache.mahout.math.hadoop.similarity.RowSimilarityJob.SimilarityReducer  to list or array to improve the performance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-467&quot;&gt;&lt;del&gt;MAHOUT-467&lt;/del&gt;&lt;/a&gt;: removed static modifiers on driver private methods that were not invoked statically anyway&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12471055">MAHOUT-460</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 12 Aug 2010 14:33:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9596</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxy4xr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22951</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>