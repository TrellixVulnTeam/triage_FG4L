<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:27:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-1151/MAHOUT-1151.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-1151] Object reuse in distributed ALS</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-1151</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;In order to improve the performance our distributed ALS code, we should try to avoid object instantiation as much as possible, especially when it is done per input tuple.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12635553">MAHOUT-1151</key>
            <summary>Object reuse in distributed ALS</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ssc">Sebastian Schelter</assignee>
                                    <reporter username="ssc">Sebastian Schelter</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Mar 2013 11:40:01 +0000</created>
                <updated>Mon, 3 Feb 2014 08:06:17 +0000</updated>
                            <resolved>Mon, 11 Mar 2013 08:39:33 +0000</resolved>
                                    <version>0.8</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>Collaborative Filtering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13594730" author="hudson" created="Wed, 6 Mar 2013 14:12:48 +0000"  >&lt;p&gt;Integrated in Mahout-Quality #1885 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/1885/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/1885/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1151&quot; title=&quot;Object reuse in distributed ALS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1151&quot;&gt;&lt;del&gt;MAHOUT-1151&lt;/del&gt;&lt;/a&gt; Object reuse in distributed ALS, fixed typo (Revision 1453315)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1151&quot; title=&quot;Object reuse in distributed ALS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1151&quot;&gt;&lt;del&gt;MAHOUT-1151&lt;/del&gt;&lt;/a&gt; Object reuse in distributed ALS (Revision 1453310)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
ssc : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1453315&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1453315&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/RecommenderJob.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;ssc : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1453310&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1453310&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/common/FixedSizePriorityQueue.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/ParallelALSFactorizationJob.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/RecommenderJob.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/impl/recommender/GenericRecommendedItem.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/recommender/RecommendedItem.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/common/mapreduce/MergeVectorsReducer.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/math/VectorWritable.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13594848" author="tdunning" created="Wed, 6 Mar 2013 16:38:24 +0000"  >&lt;p&gt;Regarding the patch, it is mostly quite good.  Two small issues that I see are:&lt;/p&gt;

&lt;p&gt;1) using a float for the threshold probably just slows the code down due to conversions from double.  I only use floats where there is a big win&lt;/p&gt;

&lt;p&gt;2) more importantly, it doesn&apos;t appear from the patch that there is any trimming of the result list in the loop.  This is important to do because that causes the threshold to increase and the insertion of items to become more and more rare.&lt;/p&gt;</comment>
                            <comment id="13594857" author="ssc" created="Wed, 6 Mar 2013 16:49:47 +0000"  >&lt;p&gt;1) I removed the cast to a float, thx&lt;/p&gt;

&lt;p&gt;regarding 2)&lt;/p&gt;

&lt;p&gt;There is a trimming, as topKItems is a fixed size priority queue, so topKItems.peek() will always give the currently smallest value that is still included (aka the threshold). Correct me if I&apos;m wrong.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; 
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (topKItems.size() &amp;lt; recommendationsPerUser || predictedRating &amp;gt; topKItems.peek().getValue()) {
    topKItems.offer(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericRecommendedItem(itemID, (&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;) predictedRating));
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;My suspicion was that the instantiation of objects given to the offer() method might cause problems.&lt;/p&gt;</comment>
                            <comment id="13594860" author="srowen" created="Wed, 6 Mar 2013 17:00:00 +0000"  >&lt;p&gt;I think it would be better to leave the GenericRecommendedItem object immutable for the reasons Ted mentioned on the mailing list. However if needed a package-private alterante implementation that is mutable is a fine thing.&lt;/p&gt;

&lt;p&gt;Yes I think your implementation is correct. It&apos;s a min queue inside, so it always tracking the smallest top element.&lt;br/&gt;
The only small downside here is that you are checking size and comparing to the head twice, because offer() does it again.&lt;/p&gt;

&lt;p&gt;This is all quite similar in spirit to the separate TopItems class FWIW. I don&apos;t know if it&apos;s worth combining but it has these ideas embedded already.&lt;/p&gt;</comment>
                            <comment id="13595789" author="hudson" created="Thu, 7 Mar 2013 11:18:40 +0000"  >&lt;p&gt;Integrated in Mahout-Quality #1887 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/1887/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/1887/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1151&quot; title=&quot;Object reuse in distributed ALS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1151&quot;&gt;&lt;del&gt;MAHOUT-1151&lt;/del&gt;&lt;/a&gt;, a few more fixes (Revision 1453760)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1151&quot; title=&quot;Object reuse in distributed ALS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1151&quot;&gt;&lt;del&gt;MAHOUT-1151&lt;/del&gt;&lt;/a&gt;, a few more fixes (Revision 1453756)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
ssc : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1453760&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1453760&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/RecommenderJob.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;ssc : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1453756&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1453756&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/CappableRecommendedItem.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/ParallelALSFactorizationJob.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/RecommenderJob.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/impl/recommender/GenericRecommendedItem.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/recommender/RecommendedItem.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13596333" author="ssc" created="Thu, 7 Mar 2013 20:35:28 +0000"  >&lt;p&gt;Changes increased performance, due to tests of Josh Devins, at &lt;a href=&quot;https://gist.github.com/joshdevins/5106930&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://gist.github.com/joshdevins/5106930&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13597182" author="hudson" created="Fri, 8 Mar 2013 14:45:59 +0000"  >&lt;p&gt;Integrated in Mahout-Quality #1889 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/1889/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/1889/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1151&quot; title=&quot;Object reuse in distributed ALS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1151&quot;&gt;&lt;del&gt;MAHOUT-1151&lt;/del&gt;&lt;/a&gt; more optimizations (Revision 1454389)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
ssc : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1454389&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1454389&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/RecommendedItemsWritable.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/CappableRecommendedItem.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/MutableRecommendedItem.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/RecommenderJob.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/als/TopItemQueue.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/test/java/org/apache/mahout/cf/taste/hadoop/als/TopItemQueueTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13598643" author="ssc" created="Mon, 11 Mar 2013 08:39:33 +0000"  >&lt;p&gt;Josh reports 3x performance improvements in the recommendation computation now.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12572605" name="MAHOUT-1151-2.patch" size="15587" author="ssc" created="Thu, 7 Mar 2013 20:35:43 +0000"/>
                            <attachment id="12572313" name="MAHOUT-1151.patch" size="10248" author="ssc" created="Wed, 6 Mar 2013 12:22:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 6 Mar 2013 14:12:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316046</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzcdxb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316389</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>