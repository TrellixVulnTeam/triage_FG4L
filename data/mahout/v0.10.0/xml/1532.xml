<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:16:53 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-1532/MAHOUT-1532.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-1532] Add solve() function to the Scala DSL </title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-1532</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;We should add a solve() function to the Scala DSL with helps with solving Ax = b for in-core matrices and vectors.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12711385">MAHOUT-1532</key>
            <summary>Add solve() function to the Scala DSL </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ssc">Sebastian Schelter</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Apr 2014 06:23:20 +0100</created>
                <updated>Mon, 13 Apr 2015 11:21:29 +0100</updated>
                            <resolved>Sun, 18 May 2014 07:38:09 +0100</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Math</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13985180" author="ssc" created="Wed, 30 Apr 2014 06:24:33 +0100"  >&lt;p&gt;I&apos;m preparing a linear regression example example for a talk and I need to have this functionality. &lt;/p&gt;</comment>
                            <comment id="13985903" author="ssc" created="Wed, 30 Apr 2014 19:41:52 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dlyubimov&quot; class=&quot;user-hover&quot; rel=&quot;dlyubimov&quot;&gt;Dmitriy Lyubimov&lt;/a&gt; are you ok with this?&lt;/p&gt;</comment>
                            <comment id="13985913" author="dlyubimov" created="Wed, 30 Apr 2014 19:48:13 +0100"  >&lt;p&gt;sure. I actually kind of wanted to start on this myself a few times (e.g. it is hugely useful in weighted als) but every time ended using our chol() stuff, which is just a matter of sugar in this case. But yes this is hugely coherent with our direction. Are you planning to use chol() for this or something else? &lt;/p&gt;

&lt;p&gt;I think how people are doing it in major oos projects is by piggy-backing on UL decomposition, which is probably the cheapest way o fdoing this. but we don&apos;t have it so i guess it is ok to wrap it into a Cholesky or even qr. &lt;/p&gt;</comment>
                            <comment id="13986419" author="ssc" created="Thu, 1 May 2014 08:33:21 +0100"  >&lt;p&gt;I planned to use QR not Cholesky (QR doesn&apos;t implysemi-positive definite, right?). &lt;/p&gt;</comment>
                            <comment id="13986447" author="srowen" created="Thu, 1 May 2014 09:31:33 +0100"  >&lt;p&gt;Yes Cholesky requires symmetric positive definite. You need QR for the more general case here. &lt;/p&gt;</comment>
                            <comment id="13986480" author="tdunning" created="Thu, 1 May 2014 11:23:56 +0100"  >&lt;p&gt;QR is definitely the way to go where it works.&lt;/p&gt;

&lt;p&gt;Is this intended to be a least-squares solver?  Tall skinny systems?&lt;/p&gt;

&lt;p&gt;If so, QR of the Gram matrix is a common approach, but that can have poor numerical properties.&lt;/p&gt;

&lt;p&gt;For some problems, either conjugate gradient or approximate SVD are better approaches.&lt;/p&gt;

&lt;p&gt;For regularization, it is usually important to support L1, L2 and combined L1 and L2.  &lt;/p&gt;

&lt;p&gt;This is related to generalized linear modeling, but linear systems don&apos;t require as fancy a machinery.&lt;/p&gt;</comment>
                            <comment id="13986482" author="ssc" created="Thu, 1 May 2014 11:27:26 +0100"  >&lt;p&gt;I want to create a toy example for using the spark-shell to do linear regression and for that I need an in-core least squares solver.&lt;/p&gt;

&lt;p&gt;The patch proposes to add a solve() function which calls our QRDecomposition internally&lt;/p&gt;</comment>
                            <comment id="13986620" author="dlyubimov" created="Thu, 1 May 2014 15:15:59 +0100"  >&lt;p&gt;I think if you use qr you also need to check for singularity. R solve rejects those, but our qr does not dissalow those explicitly.&lt;/p&gt;</comment>
                            <comment id="13986627" author="dlyubimov" created="Thu, 1 May 2014 15:21:34 +0100"  >&lt;p&gt;Ah probably it is ok. You are delegating to solve inside qr rather than implementing it, i suppose it is already taken care 8f then&lt;/p&gt;</comment>
                            <comment id="13987575" author="tdunning" created="Fri, 2 May 2014 11:41:54 +0100"  >&lt;p&gt;Can somebody clarify what kind of solve() is being used here?&lt;/p&gt;

&lt;p&gt;What happens with over-determined systems?  (least squares solution?)&lt;/p&gt;

&lt;p&gt;What about under-determined systems? (regularized solution?)&lt;/p&gt;
</comment>
                            <comment id="13987603" author="ssc" created="Fri, 2 May 2014 12:25:56 +0100"  >&lt;p&gt;Sorry, I haven&apos;t been very concise with my language here, I need an in-core solver not least squares solver. The goal of this ticket is to have an equivalent of R&apos;s standard solve() function in the DSL (for in-core matrices). AFAIK, this function doesn&apos;t handle overdetermined or underdetermined systems.&lt;/p&gt;</comment>
                            <comment id="13988069" author="dlyubimov" created="Fri, 2 May 2014 19:34:47 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ssc&quot; class=&quot;user-hover&quot; rel=&quot;ssc&quot;&gt;Sebastian Schelter&lt;/a&gt; i think R solve also makes second parameter optional with a default eye(). In our case we could just define yet another solve() with single parameter that just returns an inverse. This is a bad practice but i think we need it just to be consistent with R. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tdunning&quot; class=&quot;user-hover&quot; rel=&quot;tdunning&quot;&gt;Ted Dunning&lt;/a&gt; what you are inquiring about i guess in our case analytically would correspond to &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
solve(X.t %*% X - diag(lambda, X.nrow), X.t %*% y) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;but solve() doesn&apos;t do it in either R nor i think it is an intent here either.&lt;/p&gt;</comment>
                            <comment id="13988395" author="tdunning" created="Sat, 3 May 2014 00:02:50 +0100"  >&lt;p&gt;So the matrix has to be square and have a non-zero determinant.&lt;/p&gt;

&lt;p&gt;What about having a matrix RHS?&lt;/p&gt;

&lt;p&gt;That is, solving &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
A X = B
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;where B and X are matrix instead of vector?&lt;/p&gt;
</comment>
                            <comment id="13988415" author="dlyubimov" created="Sat, 3 May 2014 00:20:00 +0100"  >&lt;p&gt;did you look at the patch? &lt;br/&gt;
i think it is already handling this.&lt;/p&gt;</comment>
                            <comment id="13988611" author="ssc" created="Sat, 3 May 2014 08:32:46 +0100"  >&lt;p&gt;Updated patch according to Dmitriy&apos;s comments.&lt;/p&gt;</comment>
                            <comment id="13990281" author="ssc" created="Tue, 6 May 2014 06:05:18 +0100"  >&lt;p&gt;Can someone have a quick look at the patch? Would like to commit this to continue working on the linear regression example.&lt;/p&gt;</comment>
                            <comment id="13990939" author="dlyubimov" created="Tue, 6 May 2014 19:23:07 +0100"  >&lt;p&gt;assuming tests are passing, seems fine. few minor non-binding suggestions &lt;/p&gt;

&lt;p&gt;Scalatest has been experiencing some evolution (e.g. see MathSuite.scala). I guess more &quot;fashionable&quot; style to write this &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(abs(1 - identity(0, 0)) &amp;lt; 1e-10)
   &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(abs(0 - identity(0, 1)) &amp;lt; 1e-10)
   &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(abs(0 - identity(1, 0)) &amp;lt; 1e-10)
   &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt;(abs(1 - identity(1, 1)) &amp;lt; 1e-10)  
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt; these days is something like this : &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  val control = eye(identity.ncol)
  (control - identity).norm should be &amp;lt; 1e-10
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;also this &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  test(&lt;span class=&quot;code-quote&quot;&gt;&quot;solve rejects non-square matrix&quot;&lt;/span&gt;) {
+    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+      val a = dense((1, 2, 3), (4, 5, 6))
+      val b = dvec(1, 2)
+      solve(a, b)
+      fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;IllegalArgumentException expected&quot;&lt;/span&gt;)
+    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; {
+      &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; e: IllegalArgumentException =&amp;gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; _: Throwable =&amp;gt; fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;unexpected throwable encountered&quot;&lt;/span&gt;)
+    }
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;these days is more fashionable as this &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
test(...) { 
 intercept[IllegalArgumentException] {
... 
  }
   
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13991494" author="hudson" created="Wed, 7 May 2014 03:50:17 +0100"  >&lt;p&gt;FAILURE: Integrated in Mahout-Quality #2606 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2606/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2606/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1532&quot; title=&quot;Add solve() function to the Scala DSL &quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1532&quot;&gt;&lt;del&gt;MAHOUT-1532&lt;/del&gt;&lt;/a&gt; Add solve() function to the Scala DSL (ssc: rev 1592922)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/CHANGELOG&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/math-scala/src/main/scala/org/apache/mahout/math/scalabindings/package.scala&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/math-scala/src/test/scala/org/apache/mahout/math/scalabindings/MathSuite.scala&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12643187" name="MAHOUT-1532.patch" size="4027" author="ssc" created="Sat, 3 May 2014 08:32:46 +0100"/>
                            <attachment id="12642598" name="MAHOUT-1532.patch" size="1068" author="ssc" created="Wed, 30 Apr 2014 06:24:33 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 30 Apr 2014 18:48:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389706</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzozcf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389948</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>