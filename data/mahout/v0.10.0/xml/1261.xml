<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:15:32 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-1261/MAHOUT-1261.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-1261] TasteHadoopUtils.idToIndex can return an int that has size Integer.MAX_VALUE</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-1261</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;I&apos;m running ItemSimilarityJob on a very large (~600M by 4B) matrix that&apos;s very sparse (total set of associations is 630MB).&lt;/p&gt;

&lt;p&gt;The job fails because of an IndexException in ToUserVectorsReducer.&lt;br/&gt;
TasteHadoopUtils.idToIndex(long id) hashes a long with:&lt;br/&gt;
0x7fffffff &amp;amp; Longs.hashCode(id) (line o.a.m.cf.taste.hadoop.TasteHadoopUtils:57).&lt;/p&gt;

&lt;p&gt;For some id (I don&apos;t know what value), the result returned is Integer.MAX_VALUE.&lt;br/&gt;
This cannot be set in the userVector because the cardinality of that is also Integer.MAX_VALUE and it throws an exception.&lt;/p&gt;

&lt;p&gt;So, the issue is that values from 0 to INT_MAX are returned by idToIndex but the vector only has 0 to INT_MAX - 1 possible entries.&lt;br/&gt;
It&apos;s a nasty little off-by-one bug.&lt;/p&gt;

&lt;p&gt;I&apos;m thinking of just % size when setting.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ssc&quot; class=&quot;user-hover&quot; rel=&quot;ssc&quot;&gt;Sebastian Schelter&lt;/a&gt; &amp;amp; everyone else, thoughts? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12652682">MAHOUT-1261</key>
            <summary>TasteHadoopUtils.idToIndex can return an int that has size Integer.MAX_VALUE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="smarthi">Suneel Marthi</assignee>
                                    <reporter username="dfilimon">Dan Filimon</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Jun 2013 16:09:15 +0100</created>
                <updated>Mon, 3 Feb 2014 07:57:15 +0000</updated>
                            <resolved>Thu, 28 Nov 2013 14:47:19 +0000</resolved>
                                    <version>0.8</version>
                                    <fixVersion>0.9</fixVersion>
                                    <component>Collaborative Filtering</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13682555" author="ssc" created="Thu, 13 Jun 2013 19:49:27 +0100"  >&lt;p&gt;Good find, it should never return Integer.MAX_VALUE. Its there a fancier way than using an if statement to prevent this?&lt;/p&gt;</comment>
                            <comment id="13761099" author="smarthi" created="Sat, 7 Sep 2013 20:07:24 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=quarazy&quot; class=&quot;user-hover&quot; rel=&quot;quarazy&quot;&gt;Carl Clark&lt;/a&gt; Thanks for the patch, could also include unit tests for this.&lt;/p&gt;</comment>
                            <comment id="13834216" author="smarthi" created="Wed, 27 Nov 2013 22:09:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ssc&quot; class=&quot;user-hover&quot; rel=&quot;ssc&quot;&gt;Sebastian Schelter&lt;/a&gt; Could u look at this? Thanks.&lt;/p&gt;</comment>
                            <comment id="13834234" author="ssc" created="Wed, 27 Nov 2013 22:18:38 +0000"  >&lt;p&gt;I thought we already patched this, will check though.&lt;/p&gt;
</comment>
                            <comment id="13834898" author="smarthi" created="Thu, 28 Nov 2013 14:47:19 +0000"  >&lt;p&gt;Patch committed to trunk.&lt;/p&gt;</comment>
                            <comment id="13835094" author="hudson" created="Thu, 28 Nov 2013 22:30:58 +0000"  >&lt;p&gt;SUCCESS: Integrated in Mahout-Quality #2338 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2338/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2338/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1261&quot; title=&quot;TasteHadoopUtils.idToIndex can return an int that has size Integer.MAX_VALUE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1261&quot;&gt;&lt;del&gt;MAHOUT-1261&lt;/del&gt;&lt;/a&gt;: TasteHadoopUtils.idToIndex can return an int that has size Integer.MAX_VALUE (smarthi: rev 1546379)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/CHANGELOG&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/main/java/org/apache/mahout/cf/taste/hadoop/TasteHadoopUtils.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/core/src/test/java/org/apache/mahout/cf/taste/hadoop/TasteHadoopUtilsTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12602022" name="MAHOUT-1261.patch" size="2718" author="quarazy" created="Sun, 8 Sep 2013 00:37:25 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 13 Jun 2013 18:49:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>333006</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzfafb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>333334</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>