<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:16:27 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MAHOUT-1232/MAHOUT-1232.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MAHOUT-1232] VectorHelper.topEntries() throws a NPE when number of NonZero elements in vector &lt; maxEntries</title>
                <link>https://issues.apache.org/jira/browse/MAHOUT-1232</link>
                <project id="12310751" key="MAHOUT">Mahout</project>
                    <description>&lt;p&gt;Vectordump throws a NullPointerException when sort is specified and the number of NonZero elements in the input vector is less than the specified vector size (-vs).&lt;/p&gt;



&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

mahout vectordump -i reuters-vectors/tfidf-vectors -dt sequencefile -d reuters-vectors/dictionary.file-* -vs 15 -ni 30 -o vectordump -p &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -sort reuters-vectors/tfidf-vectors

INFO: Sort? &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.NullPointerException
	at org.apache.mahout.utils.vectors.VectorHelper.topEntries(VectorHelper.java:89)
	at org.apache.mahout.utils.vectors.VectorHelper.vectorToJson(VectorHelper.java:135)
	at org.apache.mahout.utils.vectors.VectorDumper.run(VectorDumper.java:242)
	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
	at org.apache.mahout.utils.vectors.VectorDumper.main(VectorDumper.java:262)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:601)
	at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)
	at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139)
	at org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:195)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The issue is in the following block of code that is invoked when sort=true in VectorHelper.java &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Element e : vector.nonZeroes()) {
      queue.insertWithOverflow(Pair.of(e.index(), e.get()));
    }
    List&amp;lt;Pair&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt;&amp;gt; entries = Lists.newArrayList();
    Pair&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;&amp;gt; pair;
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ((pair = queue.pop()) != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (pair.getFirst() &amp;gt; -1) {
        entries.add(pair);
      }
    }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment></environment>
        <key id="12649837">MAHOUT-1232</key>
            <summary>VectorHelper.topEntries() throws a NPE when number of NonZero elements in vector &lt; maxEntries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="smarthi">Suneel Marthi</assignee>
                                    <reporter username="smarthi">Suneel Marthi</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 May 2013 03:00:48 +0100</created>
                <updated>Sat, 27 Jul 2013 05:15:27 +0100</updated>
                            <resolved>Wed, 29 May 2013 06:45:41 +0100</resolved>
                                    <version>0.7</version>
                    <version>0.8</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>Integration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13668954" author="smarthi" created="Wed, 29 May 2013 04:06:20 +0100"  >&lt;p&gt;Unit Test to reproduce this error&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testTopEntriesNullPointerException() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    Vector v = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SequentialAccessSparseVector(10);
    v.set(2, 3.1);
    v.set(4, 1.0);
    v.set(6, 8.1);
    v.set(7, -100);
    v.set(9, 12.2);
    v.set(1, 0.0);
    v.set(3, 0.0);
    v.set(8, 2.7);

    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      VectorHelper.topEntries(v, 8);
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable expected) {
      assertEquals(NullPointerException.class, expected.getClass());
    }
  }

  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testTopEntries() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    Vector v = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SequentialAccessSparseVector(10);
    v.set(2, 3.1);
    v.set(4, 1.0);
    v.set(6, 8.1);
    v.set(7, -100);
    v.set(9, 12.2);
    v.set(1, 0.0);
    v.set(3, 0.0);
    v.set(8, 2.7);
    assertEquals(6, VectorHelper.topEntries(v, 6).size());
  }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13669006" author="smarthi" created="Wed, 29 May 2013 06:11:18 +0100"  >&lt;p&gt;When the number of nonZero elements in the input is &amp;lt; maxEntries, the call to queue.pop returns a Pair&amp;lt;null, null&amp;gt;. The subsequent call to pair.getFirst() results in a NullPointerException.&lt;/p&gt;</comment>
                            <comment id="13669040" author="hudson" created="Wed, 29 May 2013 07:43:31 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #2021 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2021/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2021/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1232&quot; title=&quot;VectorHelper.topEntries() throws a NPE when number of NonZero elements in vector &amp;lt; maxEntries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1232&quot;&gt;&lt;del&gt;MAHOUT-1232&lt;/del&gt;&lt;/a&gt;: VectorHelper.topEntries() throws a NPE when number of NonZero elements in vector &amp;lt; maxEntries (Revision 1487279)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
smarthi : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/CHANGELOG&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/integration/src/main/java/org/apache/mahout/utils/vectors/VectorDumper.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/integration/src/main/java/org/apache/mahout/utils/vectors/VectorHelper.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/integration/src/test/java/org/apache/mahout/utils/vectors/VectorHelperTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13669823" author="hudson" created="Wed, 29 May 2013 23:36:08 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #2023 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2023/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2023/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1232&quot; title=&quot;VectorHelper.topEntries() throws a NPE when number of NonZero elements in vector &amp;lt; maxEntries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1232&quot;&gt;&lt;del&gt;MAHOUT-1232&lt;/del&gt;&lt;/a&gt;: VectorHelper.topEntries() throws a NPE when number of NonZero elements in vector &amp;lt; maxEntries - Adding a unit test to address the scenario when the input vector has all zero elements. (Revision 1487645)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
smarthi : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/integration/src/test/java/org/apache/mahout/utils/vectors/VectorHelperTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13671180" author="hudson" created="Fri, 31 May 2013 06:30:45 +0100"  >&lt;p&gt;Integrated in Mahout-Quality #2024 (See &lt;a href=&quot;https://builds.apache.org/job/Mahout-Quality/2024/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Mahout-Quality/2024/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/MAHOUT-1232&quot; title=&quot;VectorHelper.topEntries() throws a NPE when number of NonZero elements in vector &amp;lt; maxEntries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAHOUT-1232&quot;&gt;&lt;del&gt;MAHOUT-1232&lt;/del&gt;&lt;/a&gt;: VectorHelper.topEntries() throws a NPE when number of NonZero elements in vector &amp;lt; maxEntries - added code comments (Revision 1488007)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
smarthi : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/mahout/trunk/integration/src/main/java/org/apache/mahout/utils/vectors/VectorHelper.java&lt;/li&gt;
	&lt;li&gt;/mahout/trunk/integration/src/test/java/org/apache/mahout/utils/vectors/VectorHelperTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12585158" name="MAHOUT-1232.patch" size="3273" author="smarthi" created="Wed, 29 May 2013 06:11:38 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 29 May 2013 06:43:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>330164</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzesyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>330498</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>