conf.setMapOutputValueClass(vectorClass) should be conf.setMapOutputValueClass(Text.class); in KMeansDrive.runClustering(...)