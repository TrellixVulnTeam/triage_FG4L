Improve Euclidean distance similarity calculation