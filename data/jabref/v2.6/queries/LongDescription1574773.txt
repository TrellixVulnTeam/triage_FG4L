sanitizeUrl() changes any kind of URL to an "http://" URL, making it impossible to have "ftp://" or "file:///" (note the third slash) URLs. Ditto pure local paths. That's neutered, not sanitized. Unfortunately, the comment doesn't explain which "bad characters" break a "portable" URL, so I don't know what a solution that works for everyone should look like. It seems to me, though, that "ftp://" should be allowed on pretty much any system, while "file:///" may be limited to Unix-like systems. In addition, pure local paths (e.g. "/home/user/example.txt") are not valid URLs but perfectly valid arguments to give to Unixy browsers, and they should pass sanitizeUrl() unchanged. 