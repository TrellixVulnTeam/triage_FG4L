Credentials not always stored properly when changed