<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:02:56 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-741/LUCENE-741.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[LUCENE-741] Field norm modifier (CLI tool)</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-741</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                    <description>&lt;p&gt;I took Chris&apos; LengthNormModifier (contrib/misc) and modified it slightly, to allow us to set fake norms on an existing fields, effectively making it equivalent to Field.Index.NO_NORMS.&lt;/p&gt;

&lt;p&gt;This is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-448&quot; title=&quot;optional norms&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-448&quot;&gt;&lt;del&gt;LUCENE-448&lt;/del&gt;&lt;/a&gt; (NO_NORMS patch) and &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-496&quot; title=&quot;New tool for  reseting the (length)norm of fields after changing Similarity&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-496&quot;&gt;&lt;del&gt;LUCENE-496&lt;/del&gt;&lt;/a&gt; (LengthNormModifier contrib from Chris).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12358338">LUCENE-741</key>
            <summary>Field norm modifier (CLI tool)</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="otis">Otis Gospodnetic</assignee>
                                    <reporter username="otis">Otis Gospodnetic</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Dec 2006 21:41:02 +0000</created>
                <updated>Fri, 12 Jan 2007 07:19:16 +0000</updated>
                                                                            <component>core/index</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12460078" author="otis" created="Wed, 20 Dec 2006 22:33:57 +0000"  >&lt;p&gt;Committed.  I&apos;ll also remove the old version of this code (+ its unit test), the one that still lives in contrib/miscellaneous/src/java/org/apache/lucene/misc/ .&lt;/p&gt;</comment>
                            <comment id="12463801" author="otis" created="Thu, 11 Jan 2007 05:02:53 +0000"  >&lt;p&gt;The norm-removing functionality was bogus - it simply &quot;normalized the norms&quot; to be 1 for the given field, but did not completely remove norms for a field, and did not flip the omitNorms bit for the given field, so it was never a true NO_NORMS field.&lt;/p&gt;

&lt;p&gt;I&apos;ll upload a new patch that does this, but it does it only for Lucene 2.0.0 and Lucene 2.1-dev before the new .nrm changes from &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-756&quot; title=&quot;Maintain norms in a single file .nrm&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-756&quot;&gt;&lt;del&gt;LUCENE-756&lt;/del&gt;&lt;/a&gt; were committed.&lt;/p&gt;</comment>
                            <comment id="12464105" author="doronc" created="Fri, 12 Jan 2007 06:39:17 +0000"  >&lt;p&gt;I was looking at what it would take to make this work with .nrm file as well. &lt;br/&gt;
I expected there will be a test that fails currently, but there is none.&lt;br/&gt;
So I looked into the tests and the implementation and have a few questions:&lt;/p&gt;

&lt;p&gt;(1) under contrib, FieldNormModifier and LengthNormModifier seem quite similar, right? &lt;br/&gt;
The first one sets with:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;reader.setNorm(d, fieldName,&lt;/li&gt;
	&lt;li&gt;sim.encodeNorm(sim.lengthNorm(fieldName, termCounts&lt;span class=&quot;error&quot;&gt;&amp;#91;d&amp;#93;&lt;/span&gt;)));&lt;br/&gt;
The latter with:&lt;/li&gt;
	&lt;li&gt;byte norm = sim.encodeNorm(sim.lengthNorm(fieldName, termCounts&lt;span class=&quot;error&quot;&gt;&amp;#91;d&amp;#93;&lt;/span&gt;));&lt;/li&gt;
	&lt;li&gt;reader.setNorm(d, fieldName, norm);&lt;br/&gt;
Do we need to keep both?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;(2) TestFieldNormModifier.testFieldWithNoNorm() calls resetNorms() for a field that does not exist. Some work is done by the modifier to collect the term frequencies, and then reader.setNorm is called but it does nothing, because there are no norms. And indeed the test verifies that there are still no norms for this field. Confusing I think. For some reason I assumed that calling resetNorms() for a field that has none, would implicitly set omitNorms to false for that field and compute it - the inverse of killNorms(). Since this is not the case, perhaps resetNorms should throw an exception in this case?&lt;/p&gt;

&lt;p&gt;(3) I would feel safer about this feature if the test was more strict - something like TestNorms - have several fields, modify some, each in a unique way, remove some others, then at the end verify that all the values of each field norms are exactly as expected. &lt;/p&gt;

&lt;p&gt;(4) For killNorms to work, you can first revert the index to not use .nrm, and then &quot;kill&quot; as before. The code knows to read .fN files, for both backwards compatibility, and for reading segments created be DocumentWriter. The following steps will do this:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;read the norms using reader.norm(field)&lt;/li&gt;
	&lt;li&gt;write into .fN files&lt;/li&gt;
	&lt;li&gt;remove .nrm file&lt;/li&gt;
	&lt;li&gt;modify segmentInfo to know that it has no .nrm file.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;(5) It would have been more efficient to optimize (and remove the .nrm file) once in the application, so perhaps modify the public API to take an array of fields and operate on all?&lt;/p&gt;</comment>
                            <comment id="12464109" author="doronc" created="Fri, 12 Jan 2007 07:19:16 +0000"  >&lt;p&gt;Attached for.nrm.patch was very noisy - so I replaced it with one created with &lt;br/&gt;
   svn diff -x --ignore-eol-style  contrib/miscellaneous&lt;br/&gt;
It is relative to trunk.&lt;/p&gt;

&lt;p&gt;A test is added to TestFieldNormModifier.java - testModifiedNormValuesCombinedWithKill - that verifies exactly what are the values of norms after modification.&lt;/p&gt;

&lt;p&gt;FieldNormModifier modified to handle .nrm file as outlined above.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12348721" name="LUCENE-741.patch" size="11139" author="otis" created="Thu, 11 Jan 2007 11:29:24 +0000"/>
                            <attachment id="12346942" name="LUCENE-741.patch" size="12303" author="otis" created="Mon, 11 Dec 2006 21:45:56 +0000"/>
                            <attachment id="12348790" name="for.nrm.patch" size="14854" author="doronc" created="Fri, 12 Jan 2007 07:13:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Jan 2007 06:39:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13011</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Lucene Fields</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxyvtr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27307</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>