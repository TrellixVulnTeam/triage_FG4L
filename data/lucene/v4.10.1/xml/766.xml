<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:11:03 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/LUCENE-766/LUCENE-766.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[LUCENE-766] Two same new field with and without Term vector make an IllegalStateException</title>
                <link>https://issues.apache.org/jira/browse/LUCENE-766</link>
                <project id="12310110" key="LUCENE">Lucene - Core</project>
                    <description>&lt;p&gt;On a empty index, adding a document with two fields with the same name but with different term vector option fail. The field with TermVector.WITH_POSITIONS_OFFSETS is correctly indexed, as the offset are correclty extracted. The field with TermVector.NO is not. The TermVectorsWriter tries to add offset info given to the data of the filedinfo from the &quot;fnm&quot; file, but the DocumentWriter didn&apos;t prepared offset datas as it gets its info from the field itself, not from the fieldinfo.&lt;/p&gt;

&lt;p&gt;Attaching a patch with a test. The test without the fix make this stack trace :&lt;/p&gt;

&lt;p&gt;java.lang.IllegalStateException: Trying to write offsets that are null!&lt;br/&gt;
	at org.apache.lucene.index.TermVectorsWriter.writeField(TermVectorsWriter.java:311)&lt;br/&gt;
	at org.apache.lucene.index.TermVectorsWriter.closeField(TermVectorsWriter.java:142)&lt;br/&gt;
	at org.apache.lucene.index.TermVectorsWriter.closeDocument(TermVectorsWriter.java:100)&lt;br/&gt;
	at org.apache.lucene.index.TermVectorsWriter.close(TermVectorsWriter.java:240)&lt;br/&gt;
	at org.apache.lucene.index.DocumentWriter.writePostings(DocumentWriter.java:365)&lt;br/&gt;
	at org.apache.lucene.index.DocumentWriter.addDocument(DocumentWriter.java:114)&lt;br/&gt;
	at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:618)&lt;br/&gt;
	at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:601)&lt;br/&gt;
	at org.apache.lucene.index.TestDocumentWriter.testTermVector(TestDocumentWriter.java:147)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12359991">LUCENE-766</key>
            <summary>Two same new field with and without Term vector make an IllegalStateException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="doronc">Doron Cohen</assignee>
                                    <reporter username="hibou">Nicolas Lalev&#233;e</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Jan 2007 10:27:19 +0000</created>
                <updated>Thu, 3 Jan 2008 07:35:28 +0000</updated>
                            <resolved>Thu, 3 Jan 2008 07:35:28 +0000</resolved>
                                    <version>2.1</version>
                                                    <component>core/index</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12531237" author="gsingers" created="Sat, 29 Sep 2007 12:49:38 +0100"  >&lt;p&gt;Hi Nicolas,&lt;/p&gt;

&lt;p&gt;Can you still produce this against the trunk now with the latest changes?  There has been quite a bit of rework...&lt;/p&gt;</comment>
                            <comment id="12531239" author="hibou" created="Sat, 29 Sep 2007 13:08:13 +0100"  >&lt;p&gt;well, I have attached a patch with a test. Add the test and you&apos;ll see if it has been fixed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12555336" author="hibou" created="Wed, 2 Jan 2008 16:32:12 +0000"  >&lt;p&gt;Finally I ran the test against the trunk. And the test is successful.&lt;br/&gt;
So here is the patch with just the unit test.&lt;/p&gt;
</comment>
                            <comment id="12555492" author="doronc" created="Thu, 3 Jan 2008 07:06:58 +0000"  >&lt;p&gt;The test passes for me too.&lt;br/&gt;
I will add the test anyhow and resolve this issue.&lt;/p&gt;</comment>
                            <comment id="12555494" author="doronc" created="Thu, 3 Jan 2008 07:35:28 +0000"  >&lt;p&gt;Issue was apparently solved along the way.&lt;br/&gt;
Test committed.&lt;br/&gt;
Thanks Nicolas!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12372405" name="LUCENE-766-r608138.patch" size="1398" author="hibou" created="Wed, 2 Jan 2008 16:32:12 +0000"/>
                            <attachment id="12348486" name="bugfix.patch" size="3927" author="hibou" created="Mon, 8 Jan 2007 10:29:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 29 Sep 2007 11:49:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12986</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310120" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Lucene Fields</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10121"><![CDATA[New]]></customfieldvalue>
    <customfieldvalue key="10120"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxyvo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>27282</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>