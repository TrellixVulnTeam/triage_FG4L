more performance improvements for snowball