IOExeception can cause loss of data due to premature segment deletion