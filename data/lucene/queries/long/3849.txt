if you have pages of a book as multivalued fields, with the default position increment gap
of analyzer.java (0), phrase queries won't work across pages if one ends with stopword(s).

This is because the 'trailing holes' are not taken into account in end(). So I think in
TokenStream.end(), subclasses of FilteringTokenFilter (e.g. stopfilter) should do:



super.end();
posIncAtt += skippedPositions;



One problem is that these filters need to 'add' to the posinc, but currently nothing clears
the attributes for end() [they are dirty, except offset which is set by the tokenizer].

Also the indexer should be changed to pull posIncAtt from end().