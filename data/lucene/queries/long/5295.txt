Similar motivation as LUCENE-5209 and same implementation.