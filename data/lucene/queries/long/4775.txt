Spinoff from LUCENE-3051.  This method is not thread-safe unless you hold IndexWriter's lock.