MergeState.DocMap could leverage MonotonicAppendingLongBuffer to save memory.