Single-pass grouping collector based on doc blocks