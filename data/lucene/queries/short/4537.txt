Move RateLimiter up to Directory and make it IOContext aware