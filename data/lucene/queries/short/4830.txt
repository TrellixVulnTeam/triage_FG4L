Sorter API: use an abstract doc map instead of an array