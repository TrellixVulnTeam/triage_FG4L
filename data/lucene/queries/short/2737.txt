Codec is not consistently passed in internal API