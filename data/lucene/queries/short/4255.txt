clean up analysis factory exception handling