ArrayIndexOutOfBoundsException when a segment has many, many terms