<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:48:27 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1998/PIG-1998.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1998] Allow macro to return void</title>
                <link>https://issues.apache.org/jira/browse/PIG-1998</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Pig macro is allowed to not have output alias. But this property isn&apos;t clear from macro definition and macro invocation (macro inline). Here we propose to make it clear:&lt;/p&gt;

&lt;p&gt;1. If a macro doesn&apos;t output any alias, it must specify void as return value. For example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  
define mymacro(...) returns void {
   ... ...
};
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2. If a macro doesn&apos;t output any alias, it must be invoked without return value. For example, to invoke above macro, just specify:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mymacro(...);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3. Any non-void return alias in the macro definition must exist in the macro body and be prefixed with $. For example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  
define mymacro(...) returns B {
   ... ...
   $B = filter ...;
};
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12504593">PIG-1998</key>
            <summary>Allow macro to return void</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rding">Richard Ding</assignee>
                                    <reporter username="rding">Richard Ding</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Apr 2011 21:34:34 +0100</created>
                <updated>Thu, 4 Aug 2011 01:35:11 +0100</updated>
                            <resolved>Tue, 3 May 2011 01:24:04 +0100</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>0.9.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13022393" author="rding" created="Wed, 20 Apr 2011 22:58:39 +0100"  >&lt;p&gt;Patch-test results:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     [exec] -1 overall.  
     [exec] 
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec] 
     [exec]     +1 tests included.  The patch appears to include 5 &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; or modified tests.
     [exec] 
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec] 
     [exec]     -1 javac.  The applied patch generated 952 javac compiler warnings (more than the trunk&apos;s current 948 warnings).
     [exec] 
     [exec]     +1 findbugs.  The patch does not introduce any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Findbugs warnings.
     [exec] 
     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13022813" author="rding" created="Thu, 21 Apr 2011 17:26:43 +0100"  >&lt;p&gt;Unit tests pass.&lt;/p&gt;</comment>
                            <comment id="13025433" author="xuefuz" created="Tue, 26 Apr 2011 22:10:10 +0100"  >&lt;p&gt;For patch &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1998&quot; title=&quot;Allow macro to return void&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1998&quot;&gt;&lt;del&gt;PIG-1998&lt;/del&gt;&lt;/a&gt;_1.patch,&lt;/p&gt;

&lt;p&gt;1. I don&apos;t see VOID keyword is defined or used in any of the grammar rules.&lt;/p&gt;

&lt;p&gt;2. Grammar rules inline_return_clause have overlap&lt;/p&gt;

&lt;p&gt;3. Will re-review once the patch is updated. &lt;/p&gt;</comment>
                            <comment id="13025509" author="rding" created="Wed, 27 Apr 2011 00:22:48 +0100"  >&lt;p&gt;Attaching a new patch that addresses Xuefu&apos;s review comments.&lt;/p&gt;</comment>
                            <comment id="13025600" author="xuefuz" created="Wed, 27 Apr 2011 05:28:18 +0100"  >&lt;p&gt;For patch &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1998&quot; title=&quot;Allow macro to return void&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1998&quot;&gt;&lt;del&gt;PIG-1998&lt;/del&gt;&lt;/a&gt;_2.patch:&lt;/p&gt;

&lt;p&gt;1. in the following grammar, the second rule should be just ^(RETURN_VAL). With that, &quot;return void&quot; is equivalent to return zero alias. So in the code, we don&apos;t need to do this kind of check: rets.size() == 1 &amp;amp;&amp;amp; rets.get(0).equals(&quot;void&quot;)&lt;/p&gt;

&lt;p&gt;+macro_return_clause &lt;br/&gt;
+    : RETURNS alias (COMMA alias)*&lt;br/&gt;
+        -&amp;gt; ^(RETURN_VAL alias+)&lt;br/&gt;
+    | RETURNS VOID &lt;br/&gt;
+        -&amp;gt; ^(RETURN_VAL VOID)&lt;/p&gt;

&lt;p&gt;2. The bigger concern is actually the newly added method validate(). I don&apos;t think the StreamingTokenizer will meet our needs. For instance, it&apos;s not able to recognized Pig single line comments such as:&lt;/p&gt;

&lt;p&gt; &amp;#8211; this is a single line comment.&lt;/p&gt;

&lt;p&gt;Even if this isn&apos;t a problem, the maintenance overhead could evolve to a nightmare for us in long run. I don&apos;t necessarily have a better idea, but I think we should at least give more thoughts on this.&lt;/p&gt;</comment>
                            <comment id="13025898" author="rding" created="Wed, 27 Apr 2011 18:14:11 +0100"  >&lt;p&gt;Patch 2 committed to both trunk and 0.9 branch. I&apos;ll add new patches to address additional review comments.&lt;/p&gt;</comment>
                            <comment id="13027218" author="rding" created="Fri, 29 Apr 2011 23:19:55 +0100"  >&lt;p&gt;The purpose of this validation is to give user an early warning when an alias in the returns clause doesn&apos;t appear in the macro as $&amp;lt;alias&amp;gt;. It performs a simple parsing using StreamTokenizer.&lt;/p&gt;</comment>
                            <comment id="13027926" author="xuefuz" created="Tue, 3 May 2011 00:42:06 +0100"  >&lt;p&gt;+1 Patch &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1998&quot; title=&quot;Allow macro to return void&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1998&quot;&gt;&lt;del&gt;PIG-1998&lt;/del&gt;&lt;/a&gt;_3.patch looks good.&lt;/p&gt;</comment>
                            <comment id="13027951" author="rding" created="Tue, 3 May 2011 01:24:04 +0100"  >&lt;p&gt;Patch committed to trunk and 0.9 branch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12476932" name="PIG-1998_1.patch" size="31811" author="rding" created="Wed, 20 Apr 2011 20:23:31 +0100"/>
                            <attachment id="12477457" name="PIG-1998_2.patch" size="33194" author="rding" created="Wed, 27 Apr 2011 00:22:48 +0100"/>
                            <attachment id="12477851" name="PIG-1998_3.patch" size="12311" author="rding" created="Fri, 29 Apr 2011 23:19:55 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 26 Apr 2011 21:10:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66115</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyauzb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97330</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>