<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:51:18 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-802/PIG-802.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-802] PERFORMANCE: not creating bags for ORDER BY</title>
                <link>https://issues.apache.org/jira/browse/PIG-802</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Order by should be changed to not use POPackage to put all of the tuples in a bag on the reduce side, as the bag is just immediately flattened. It can instead work like join does for the last input in the join. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12424840">PIG-802</key>
            <summary>PERFORMANCE: not creating bags for ORDER BY</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="serakesh">Rakesh Setty</assignee>
                                    <reporter username="olgan">Olga Natkovich</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 May 2009 19:20:06 +0100</created>
                <updated>Wed, 24 Mar 2010 22:13:06 +0000</updated>
                            <resolved>Tue, 15 Sep 2009 17:54:48 +0100</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12707064" author="pkamath" created="Thu, 7 May 2009 20:41:13 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-744&quot; title=&quot;PERFORMANCE: Bag creation can be more efficiently handled in order by&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-744&quot;&gt;&lt;del&gt;PIG-744&lt;/del&gt;&lt;/a&gt; is a duplicate - will be marking that one as duplicate.&lt;/p&gt;

&lt;p&gt;Pasting the summary from &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-744&quot; title=&quot;PERFORMANCE: Bag creation can be more efficiently handled in order by&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-744&quot;&gt;&lt;del&gt;PIG-744&lt;/del&gt;&lt;/a&gt; which has a little more detail:&lt;br/&gt;
Currently order by results in multiple map reduce jobs (2 or 3 depending on the script) of which the last one does the actual ordering. In this last map reduce job, we create a bag of values (each value being the entire tuple that is getting sorted) for each sort key(s) using POPackage in the reduce phase. Then we turn around and flatten the bag in the foreach following the package. So there is really no need for the bag. But to be generic and use the existing operators, we can be more efficient by tagging the POPackage to create bags which are backed by the Hadoop iterator itself. This way we do not create a bag by making a copy of each tuple from the hadoop iterator. This should help both performance and scalability by making better use of memory.&lt;/p&gt;</comment>
                            <comment id="12708551" author="pkamath" created="Tue, 12 May 2009 19:28:59 +0100"  >&lt;p&gt;Adding some more details:&lt;br/&gt;
A new kind of bag - ReadOnceBag needs to be implemented. This bag will have reference to the &quot;key&quot;  currently being processed and the iterator to values provided by hadoop in reduce(). The ReadOnceBag&apos;s iterator will simply iterate over the hadoop iterator at each call and construct a tuple by using the key and value (see POPackage.java for details on how this is done). POPackage should also be changed or a new class introduced which creates ReadOnceBags instead of regular bags. This creation of the bag should only initialize the bag with the key and iterator.&lt;/p&gt;</comment>
                            <comment id="12710425" author="serakesh" created="Mon, 18 May 2009 18:57:12 +0100"  >&lt;p&gt;Attaching the patch file.&lt;/p&gt;</comment>
                            <comment id="12710511" author="hadoopqa" created="Mon, 18 May 2009 23:04:45 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12408398/OrderByOptimization.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12408398/OrderByOptimization.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 775340.&lt;/p&gt;

&lt;p&gt;    -1 @author.  The patch appears to contain 1 @author tags which the Pig community has agreed to not allow in code contributions.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    -1 javadoc.  The javadoc tool appears to have generated 1 warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The applied patch generated 227 javac compiler warnings (more than the trunk&apos;s current 226 warnings).&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 4 new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/47/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/47/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/47/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/47/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/47/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/47/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12710948" author="serakesh" created="Wed, 20 May 2009 00:57:55 +0100"  >&lt;p&gt;Attaching the new patch&lt;/p&gt;</comment>
                            <comment id="12711222" author="serakesh" created="Wed, 20 May 2009 17:50:37 +0100"  >&lt;p&gt;Attaching new patch to remove a findbug warning. Unit tests are not required as this is not a new functionality, just a different implementation of an existing functionality.&lt;/p&gt;</comment>
                            <comment id="12711386" author="serakesh" created="Wed, 20 May 2009 23:06:10 +0100"  >&lt;p&gt;New patch file to remove two more FindBugs warnings. The other one looks like is unavoidable. &lt;/p&gt;</comment>
                            <comment id="12711769" author="pkamath" created="Thu, 21 May 2009 20:26:57 +0100"  >&lt;p&gt;Review comments:&lt;br/&gt;
In MRCompiler, does POPackageLite need to be used in the following too:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (limit!=-1) {
             POPackage pkg_c = new POPackage(new OperatorKey(scope,nig.getNextNodeId(scope)));
...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In POPackage, the following declarations :&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Iterator&amp;lt;NullableTuple&amp;gt; tupIter; 

Object key; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should have &quot;protected&quot; access specifier to make the intent that these are used in POPackageLite explicit.&lt;/p&gt;

&lt;p&gt;In ReadOnceBag.equals() you could also check if the keyInfo maps are equal.&lt;/p&gt;

&lt;p&gt;The getValueTuple() in ReadOnceBag had duplicate code from POPackage.getValueTuple(). Instead of having the same code in two places, I am wondering if you could just construct ReadOnceBag with a POPackageLite instance passed in the constructor. Then if you make the POPackageLite.getValueTuple() method public, you can just invoke it from ReadOnceBag code. This way the code remains in one place. &lt;/p&gt;</comment>
                            <comment id="12711772" author="serakesh" created="Thu, 21 May 2009 20:48:40 +0100"  >&lt;p&gt;I thought about having a POPackageLite instance as a parameter in the constructor of ReadOnceBag, but I thought it will make ReadOnceBag tied down to be very specific to POPackageLite and so it cannot be generic. So the choice we have to make I think is whether we want ReadOnceBag to be as generic as possible or we want to avoid duplicate code. What do you suggest?&lt;/p&gt;</comment>
                            <comment id="12711811" author="pkamath" created="Thu, 21 May 2009 22:16:44 +0100"  >&lt;p&gt;I think even in the future if ReadOnceBags are used in places other than order by, they would need to be used immediately after a POPackageLite. So tying the two together is not bad and would reduce code duplication. &lt;/p&gt;</comment>
                            <comment id="12712326" author="serakesh" created="Sat, 23 May 2009 01:39:46 +0100"  >&lt;p&gt;Attaching the modified patch. The detachInput method in POPackageLite will set key and tupIter to null. So ReadOnceBag maintains separate references to them. POPackageLite overloads the getValueTuple method with the additional key parameter to use the one provided by ReadOnceBag. The implementation of POPackage is untouched.&lt;/p&gt;</comment>
                            <comment id="12713181" author="pkamath" created="Tue, 26 May 2009 19:31:29 +0100"  >&lt;p&gt;Changes look good - still have a comment about the change in MRCompiler.java:&lt;br/&gt;
In MRCompiler, does POPackageLite need to be used in the following too:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (limit!=-1) {
             POPackage pkg_c = new POPackage(new OperatorKey(scope,nig.getNextNodeId(scope)));
...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="12713288" author="serakesh" created="Tue, 26 May 2009 23:12:39 +0100"  >&lt;p&gt;Latest patch with the correction for limit clause.&lt;/p&gt;</comment>
                            <comment id="12713294" author="pkamath" created="Tue, 26 May 2009 23:21:31 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12714266" author="hadoopqa" created="Fri, 29 May 2009 03:03:39 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12409087/OrderByOptimization.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12409087/OrderByOptimization.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 779788.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The applied patch generated 225 javac compiler warnings (more than the trunk&apos;s current 224 warnings).&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 2 new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/62/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/62/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/62/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/62/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/62/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/62/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12714541" author="serakesh" created="Fri, 29 May 2009 19:25:27 +0100"  >&lt;p&gt;Modified patch to remove the javac and findbugs warnings.&lt;/p&gt;</comment>
                            <comment id="12714594" author="hadoopqa" created="Fri, 29 May 2009 21:56:10 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12409408/OrderByOptimization.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12409408/OrderByOptimization.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 779788.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/64/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/64/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/64/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/64/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/64/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/64/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12714701" author="hudson" created="Sat, 30 May 2009 13:11:15 +0100"  >&lt;p&gt;Integrated in Pig-trunk #458 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-trunk/458/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-trunk/458/&lt;/a&gt;)&lt;br/&gt;
    : PERFORMANCE: not creating bags for ORDER BY (serakesh via olgan)&lt;/p&gt;</comment>
                            <comment id="12755572" author="alangates" created="Tue, 15 Sep 2009 17:54:48 +0100"  >&lt;p&gt;Fix checked in 30 May 2009&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12409408" name="OrderByOptimization.patch" size="19032" author="serakesh" created="Fri, 29 May 2009 19:25:27 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 7 May 2009 19:41:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164359</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaj2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95401</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>