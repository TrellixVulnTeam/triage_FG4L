<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:53:58 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2535/PIG-2535.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2535] Bug in new logical plan results in no output for join</title>
                <link>https://issues.apache.org/jira/browse/PIG-2535</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The below script is a snippet of a much larger script. The join in the script results in 0 output for Pig 0.8,0.9 and 0.10 though there are matching records.&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
event_serve = LOAD &apos;input1&apos;   USING MyMapLoader() AS (s:map[], m:map[], l:map[]);
raw = LOAD &apos;input2&apos;  USING MyMapLoader() AS (s:map[], m:map[], l:map[]);

SPLIT raw INTO
    serve_raw IF (( (chararray) (s#&apos;type&apos;) == &apos;0&apos;) AND ( (chararray) (s#&apos;source&apos;) == &apos;5&apos;)),
    cm_click_raw IF (( (chararray) (s#&apos;type&apos;) == &apos;1&apos;) AND ( (chararray) (s#&apos;source&apos;) == &apos;5&apos;));

cm_serve = FOREACH serve_raw GENERATE  s#&apos;cm_serve_id&apos; AS cm_event_guid,  s#&apos;cm_serve_timestamp_ms&apos; AS cm_receive_time, s#&apos;p_url&apos; AS ctx ;
cm_serve_lowercase = stream cm_serve through `tr [:upper:] [:lower:]`;
cm_serve_final = FOREACH cm_serve_lowercase GENERATE  $0 AS cm_event_guid, $1 AS cm_receive_time, $2 AS ctx;
filtered = FILTER event_serve BY (chararray) (s#&apos;filter_key&apos;) neq &apos;xxxx&apos; AND (chararray) (s#&apos;filter_key&apos;) neq &apos;yyyy&apos;;
event_serve_project = FOREACH filtered GENERATE s#&apos;event_guid&apos; AS event_guid, s#&apos;receive_time&apos; AS receive_time;
event_serve_join = join cm_serve_final by (cm_event_guid, cm_receive_time), event_serve_project by (event_guid, receive_time) PARALLEL 800;
STORE event_serve_join INTO &apos;output&apos; ;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The script produces correct results if I disable ColumnMapKeyPrune optimizer.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12542750">PIG-2535</key>
            <summary>Bug in new logical plan results in no output for join</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daijy">Daniel Dai</assignee>
                                    <reporter username="vivekp">Vivek Padmanabhan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Feb 2012 20:25:50 +0000</created>
                <updated>Thu, 26 Apr 2012 21:32:43 +0100</updated>
                            <resolved>Thu, 1 Mar 2012 07:58:29 +0000</resolved>
                                    <version>0.8.1</version>
                    <version>0.9.1</version>
                    <version>0.10.0</version>
                                    <fixVersion>0.10.0</fixVersion>
                    <fixVersion>0.9.3</fixVersion>
                    <fixVersion>0.11</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13210138" author="daijy" created="Fri, 17 Feb 2012 08:46:49 +0000"  >&lt;p&gt;MapKeysPruneHelper erroneously remove &apos;type&apos; and &apos;source&apos; which are split condition. Attach the draft patch. Vivek, can you give a try?&lt;/p&gt;</comment>
                            <comment id="13210156" author="vivekp" created="Fri, 17 Feb 2012 09:20:11 +0000"  >&lt;p&gt;Thanks Daniel. I ran the script with this patch, but it seems that now the script is generating infinite map outputs.&lt;br/&gt;
(&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2534&quot; title=&quot;Pig generating infinite map outputs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2534&quot;&gt;&lt;del&gt;PIG-2534&lt;/del&gt;&lt;/a&gt;) Pig generating infinite map outputs&lt;/p&gt;

&lt;p&gt;I am getting lots of ACCESSING_NON_EXISTENT_FIELD = 21,146,912,208 and this is keeping on increasing.&lt;/p&gt;</comment>
                            <comment id="13211925" author="vivekp" created="Mon, 20 Feb 2012 15:28:50 +0000"  >&lt;p&gt;Hi Daniel, the script goes through fine with the patch after applying output schema for &lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; cm_serve_lowercase = stream cm_serve through `tr &lt;span class=&quot;error&quot;&gt;&amp;#91;:upper:&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;:lower:&amp;#93;&lt;/span&gt;`;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
</comment>
                            <comment id="13212317" author="daijy" created="Tue, 21 Feb 2012 02:53:10 +0000"  >&lt;p&gt;Thanks Vivek for verifying. Attach a full patch.&lt;/p&gt;</comment>
                            <comment id="13217853" author="thejas" created="Tue, 28 Feb 2012 02:46:31 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13219889" author="daijy" created="Thu, 1 Mar 2012 07:57:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2535&quot; title=&quot;Bug in new logical plan results in no output for join&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2535&quot;&gt;&lt;del&gt;PIG-2535&lt;/del&gt;&lt;/a&gt;-2.patch resync with trunk.&lt;/p&gt;</comment>
                            <comment id="13219890" author="daijy" created="Thu, 1 Mar 2012 07:58:32 +0000"  >&lt;p&gt;Unit test pass. test-patch:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; -1 overall.  &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 tests included.  The patch appears to include 3 new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 javadoc.  The javadoc tool appears to have generated 1 warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 release audit.  The applied patch generated 533 release audit warnings (more than the trunk&apos;s current 530 warnings).&lt;/p&gt;

&lt;p&gt;javadoc and release audit warning is unrelated.&lt;/p&gt;

&lt;p&gt;Patch committed to 0.9/0.10/trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12514965" name="PIG-2535-0.patch" size="880" author="daijy" created="Fri, 17 Feb 2012 08:46:49 +0000"/>
                            <attachment id="12515314" name="PIG-2535-1.patch" size="2975" author="daijy" created="Tue, 21 Feb 2012 02:53:10 +0000"/>
                            <attachment id="12516655" name="PIG-2535-2.patch" size="3046" author="daijy" created="Thu, 1 Mar 2012 07:57:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Feb 2012 08:46:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228036</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy3tf3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56090</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>