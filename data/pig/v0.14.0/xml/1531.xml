<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:06:25 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1531/PIG-1531.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1531] Pig gobbles up error messages</title>
                <link>https://issues.apache.org/jira/browse/PIG-1531</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Consider the following. I have my own Storer implementing StoreFunc and I am throwing FrontEndException (and other Exceptions derived from PigException) in its various methods. I expect those error messages to be shown in error scenarios. Instead Pig gobbles up my error messages and shows its own generic error message like: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
010-07-31 14:14:25,414 [main] ERROR org.apache.pig.tools.grunt.Grunt - ERROR 2116: Unexpected error. Could not validate the output specification &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.partitoned
Details at logfile: /Users/ashutosh/workspace/pig/pig_1280610650690.log

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Instead I expect it to display my error messages which it stores away in that log file.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12470576">PIG-1531</key>
            <summary>Pig gobbles up error messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nrai">niraj rai</assignee>
                                    <reporter username="ashutoshc">Ashutosh Chauhan</reporter>
                        <labels>
                    </labels>
                <created>Sat, 31 Jul 2010 22:54:53 +0100</created>
                <updated>Fri, 17 Dec 2010 22:45:01 +0000</updated>
                            <resolved>Fri, 1 Oct 2010 23:24:30 +0100</resolved>
                                    <version>0.7.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12894320" author="ashutoshc" created="Sat, 31 Jul 2010 23:14:08 +0100"  >&lt;p&gt;This is because in InputOutputFileVisitor#visit() Pig defines its own &lt;tt&gt;errMsg&lt;/tt&gt; String and uses that to throw PlanValidationException. It should use the error String of the Exception it has caught. &lt;br/&gt;
I have not checked at other places. But I have a hunch that it happens at few other places in Pig  as well.  This is a real usability issue since generic message is usually useless and Pig misses an opportunity to provide an useful bit of information in error scenarios. From that point on, user has to go open the log file and scroll among tens of lines of stack trace and only if she is familiar with Pig will spot that error String. &lt;/p&gt;</comment>
                            <comment id="12894935" author="ashutoshc" created="Tue, 3 Aug 2010 17:55:07 +0100"  >&lt;p&gt;Another instance where it happens is when input location doesnt exists, error message shown is &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.pig.backend.executionengine.ExecException: ERROR 2118: Unable to create input splits &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; tmp_emtpy_1280539088
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Whereas underlying exception did have more useful String which gets lost in log file&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.hadoop.mapreduce.lib.input.InvalidInputException: Input path does not exist:
hdfs:&lt;span class=&quot;code-comment&quot;&gt;//machine.server.edu/tmp/pig/tmp_tables/tmp_empty_1280539088&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12902131" author="nrai" created="Tue, 24 Aug 2010 23:54:18 +0100"  >&lt;p&gt;Fixed the code where it gives the relevent error message rather than giving the hard coded one.&lt;/p&gt;
</comment>
                            <comment id="12902576" author="ashutoshc" created="Wed, 25 Aug 2010 19:55:18 +0100"  >&lt;ul&gt;
	&lt;li&gt;In addition to error Msg, you also need to set error code on the exception you are throwing.&lt;/li&gt;
	&lt;li&gt;Since you are catching exceptions thrown by user code (StoreFunc Interface) it is not safe to assume that e.getMessage() will be non-null or non-empty string. This will result in NPE. You need to check for it and provide a generic error Msg in those cases.&lt;/li&gt;
	&lt;li&gt;Generic error msg should also contain output location String. Since if user didnt provide it, that wont get printed. So, you can reword the message as &quot;Output location validation failed for: &amp;lt;location&amp;gt;. More Information to follow:&quot;&lt;/li&gt;
	&lt;li&gt;Since, PigException extends from IOException. The IOException you are catching can also be a PigException, you need to test if it is and then set the message and error code.&lt;/li&gt;
	&lt;li&gt;In case of non-existent input location I am still seeing the generic message &quot;ERROR 2997: Unable to recreate exception from backend error: org.apache.pig.backend.executionengine.ExecException: ERROR 2118: Unable to create input splits for: &lt;a href=&quot;file:///Users/chauhana/workspace/pig-1531/a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:///Users/chauhana/workspace/pig-1531/a&lt;/a&gt;&quot; Though the full stack trace is printed at the end which contains the underlying error String. Its more confusing because now there are three different error messages amid a java stack trace.&lt;/li&gt;
	&lt;li&gt;This warrants a testcase for regression purposes. (Infact error reporting behavior already changed since the time I opened this bug.)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12903743" author="nrai" created="Sat, 28 Aug 2010 01:57:19 +0100"  >&lt;p&gt;I have tried to accommodate all the recommendations from Ashutosh. I have changed the existing test case to validate the error message, in case the store directory exist. Writing test case for the case, when input file deos not exist was  more effort than fixing the actual fix. So, I verified it manually and they looked good.&lt;br/&gt;
Thanks&lt;br/&gt;
Niraj&lt;/p&gt;</comment>
                            <comment id="12904056" author="ashutoshc" created="Mon, 30 Aug 2010 01:33:04 +0100"  >&lt;p&gt;I took a look of the latest patch. There are two minor problems. Firstly, pigExec was always null and never assigned a value, so it resulted in NPE in certain code path. Second, the boolean logic in PigInputFormat needs &amp;amp;&amp;amp; instead of ||. I thought of correcting it and committing. But then realized hudson hasnt come back with results yet. So, I am uploading a new patch with those corrections and submitting to Hudson again. In this patch, I also refactored a code a bit, so its easier to read. Have a look and if its look fine to you. Can you run test-patch and unit tests and paste results here, so I can commit it.&lt;/p&gt;</comment>
                            <comment id="12904497" author="ashutoshc" created="Tue, 31 Aug 2010 02:57:14 +0100"  >&lt;p&gt;Niraj ran all the unit tests. All passed. No complaints from test-patch either. Committed to the trunk.&lt;br/&gt;
Thanks, Niraj !&lt;/p&gt;</comment>
                            <comment id="12911178" author="ashutoshc" created="Sun, 19 Sep 2010 09:44:28 +0100"  >&lt;p&gt;Peril of not writing unit test : Resurrection of bug. Argh..&lt;/p&gt;</comment>
                            <comment id="12911180" author="ashutoshc" created="Sun, 19 Sep 2010 09:58:49 +0100"  >&lt;p&gt;Added a test-case which fails on trunk. Pig still gobbles up error messages. Fix is to rethrow the message in the hierarchy. Attached patch containis the test case and the fix.&lt;/p&gt;</comment>
                            <comment id="12913048" author="ashutoshc" created="Tue, 21 Sep 2010 16:58:50 +0100"  >&lt;p&gt;Oh Hudson, oh well...&lt;/p&gt;

&lt;p&gt;Ran the full suite of 400 minutes of unit tests; all passed. Patch is ready for review.&lt;/p&gt;</comment>
                            <comment id="12916972" author="nrai" created="Fri, 1 Oct 2010 18:51:26 +0100"  >&lt;p&gt;reviewed the patch and made the required changes after discussion with Ashutosh. Ran test-patch and unit test and everything looks fine.&lt;br/&gt;
Ashutosh, please commit the patch, if you don&apos;t have any further comment.&lt;br/&gt;
Thanks&lt;br/&gt;
Niraj&lt;/p&gt;</comment>
                            <comment id="12917072" author="ashutoshc" created="Fri, 1 Oct 2010 23:24:29 +0100"  >&lt;p&gt;Committed to both trunk and 0.8. Thanks, Niraj!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12456145" name="PIG-1531_5.patch" size="5186" author="nrai" created="Fri, 1 Oct 2010 18:51:26 +0100"/>
                            <attachment id="12452983" name="PIG_1531.patch" size="3463" author="nrai" created="Tue, 24 Aug 2010 23:54:18 +0100"/>
                            <attachment id="12453327" name="PIG_1531_2.patch" size="7087" author="nrai" created="Sat, 28 Aug 2010 01:57:19 +0100"/>
                            <attachment id="12453396" name="pig-1531_3.patch" size="7097" author="ashutoshc" created="Mon, 30 Aug 2010 01:33:04 +0100"/>
                            <attachment id="12454968" name="pig-1531_4.patch" size="7497" author="ashutoshc" created="Sun, 19 Sep 2010 09:58:49 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 24 Aug 2010 22:54:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>165014</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyarfj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96755</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>