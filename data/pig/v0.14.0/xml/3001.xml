<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:56:41 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3001/PIG-3001.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3001] TestExecutableManager.testAddJobConfToEnv fails randomly</title>
                <link>https://issues.apache.org/jira/browse/PIG-3001</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The test in the Summary fails intermittently.&lt;br/&gt;
This is due to using a random number generator without seeding it.&lt;br/&gt;
We should avoid stochastic tests.&lt;br/&gt;
Furthermore, the test itself is ill conceived.&lt;/p&gt;

&lt;p&gt;Here the failure summary:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
12/10/23 11:02:48 WARN streaming.ExecutableManager: Property set in pig.streaming.environment not found in Configuration: &#57742;&#12008;&#43151;&#20999;&#62565;&#27503;
12/10/23 11:02:48 WARN streaming.ExecutableManager: Property set in pig.streaming.environment not found in Configuration: &#29395;&#20573;&#60593;
12/10/23 11:02:48 WARN streaming.ExecutableManager: Property set in pig.streaming.environment not found in Configuration: &#22691;&#52319;&#13068;&#768;&#50028;&#40761;&#39479;
12/10/23 11:02:48 WARN streaming.ExecutableManager: Property set in pig.streaming.environment not found in Configuration: &#54990;&#28412;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Error Message:
There should be no remaining pairs in the included map

Stacktrace:
junit.framework.AssertionFailedError: There should be no remaining pairs in the included map
	at org.apache.pig.impl.streaming.TestExecutableManager.testAddJobConfToEnv(TestExecutableManager.java:84)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12613295">PIG-3001</key>
            <summary>TestExecutableManager.testAddJobConfToEnv fails randomly</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12611880">PIG-2972</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cheolsoo">Cheolsoo Park</assignee>
                                    <reporter username="azaroth">Gianmarco De Francisci Morales</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Oct 2012 17:13:21 +0100</created>
                <updated>Fri, 22 Feb 2013 04:53:35 +0000</updated>
                            <resolved>Wed, 31 Oct 2012 01:24:44 +0000</resolved>
                                                    <fixVersion>0.11</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13483684" author="cheolsoo" created="Wed, 24 Oct 2012 23:44:49 +0100"  >&lt;p&gt;Uploading a patch that makes the test more stable. I made two changes.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Looking at the commit history, &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2971&quot; title=&quot;Add new parameter to specify the streaming environment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2971&quot;&gt;&lt;del&gt;PIG-2971&lt;/del&gt;&lt;/a&gt; made ExecutableManager#safeEnvName() obsolete. Now the user specifies which properties to be added as env. vars via a Pig property, so safeEnvName() is no longer used. I removed it.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Replaced RandomStringUtils.random() with RandomStringUtils.randomAlphanumeric(). RandomStringUtils.random() generates a string from the set of all characters, and sometimes the returned string is not proper to be used as an env. var. name as shown in this jira.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Testing done:&lt;br/&gt;
ant clean test -Dtestcase=TestExecutableManager&lt;/p&gt;</comment>
                            <comment id="13483732" author="cheolsoo" created="Thu, 25 Oct 2012 00:40:13 +0100"  >&lt;p&gt;On a second thought, I decided to keep safeEnvVarName(). It looks like it was dropped by &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2971&quot; title=&quot;Add new parameter to specify the streaming environment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2971&quot;&gt;&lt;del&gt;PIG-2971&lt;/del&gt;&lt;/a&gt; accidentally.&lt;/p&gt;

&lt;p&gt;Updating my patch.&lt;/p&gt;</comment>
                            <comment id="13483848" author="jcoveney" created="Thu, 25 Oct 2012 03:58:38 +0100"  >&lt;p&gt;Cheolsoo,&lt;/p&gt;

&lt;p&gt;I am not a fan of this policy (though I understand why we have it), but we generally make patches without whitespace changes. Can you upload a new version without whitespace changes?&lt;/p&gt;

&lt;p&gt;Thanks for the contribution. It looks good to me.&lt;br/&gt;
Jon&lt;/p&gt;</comment>
                            <comment id="13483851" author="cheolsoo" created="Thu, 25 Oct 2012 04:12:21 +0100"  >&lt;p&gt;I am sorry. I will upload a new patch without whitespace changes and update my other patches that include whitespace changes.&lt;/p&gt;

&lt;p&gt;Btw, I was wondering whether we should keep safeEnvVarName() or not. I can argue both ways:&lt;br/&gt;
+ It will be safer since un-proper chars are auto-converted to &apos;_&apos;, so we&apos;re less likely to see errors like this.&lt;br/&gt;
&amp;#45; The user has to remember non-alphanumeric chars are auto-converted to &apos;_&apos; when passed to the streaming process.&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="13483853" author="cheolsoo" created="Thu, 25 Oct 2012 04:19:39 +0100"  >&lt;p&gt;Updating a new patch with no whitespace changes.&lt;/p&gt;</comment>
                            <comment id="13483856" author="jcoveney" created="Thu, 25 Oct 2012 04:23:52 +0100"  >&lt;p&gt;No worries on the whitespace. Like I said: I wish it weren&apos;t so, but the worry is breaking old or in-transit patches.&lt;/p&gt;

&lt;p&gt;IMHO, I would prefer for it to simply fail out, since this on the front end. That said, I don&apos;t think that is currently an option since it would break a lot of scripts. I propose the following:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;In the case where there is a conversion, we should throw a warning&lt;/li&gt;
	&lt;li&gt;There can be a flag which sets whether or not we should instead error out. It&apos;ll default turned to no, but then people can set it in their confs.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I do not like things that automagically do things, though in some cases it could be inavoidable&lt;/p&gt;</comment>
                            <comment id="13483915" author="cheolsoo" created="Thu, 25 Oct 2012 07:01:13 +0100"  >&lt;p&gt;Updated the patch as follows:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Added a flag to toggle on/off auto-conversion. By default, auto-conversion is on.&lt;/li&gt;
	&lt;li&gt;Added a warning when converting non-alphanumeric chars to underscores.&lt;/li&gt;
	&lt;li&gt;Added two unit test cases: 1) auto-conversion, and 2) no auto-conversion.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13485252" author="rohini" created="Fri, 26 Oct 2012 23:38:22 +0100"  >&lt;p&gt;My vote is for removing the conversion altogether. Since it is a user setting which will be consumed by the user in his script, it is best left to the user to set it correctly. Converting it might make it unusable.  &lt;/p&gt;</comment>
                            <comment id="13485274" author="cheolsoo" created="Sat, 27 Oct 2012 00:22:29 +0100"  >&lt;p&gt;Thanks for your comment Rohini.&lt;/p&gt;

&lt;p&gt;That&apos;s definitely reasonable too. I will wait few more days just to see if anyone has a different opinion.&lt;/p&gt;</comment>
                            <comment id="13485357" author="azaroth" created="Sat, 27 Oct 2012 05:47:37 +0100"  >&lt;p&gt;I would also remove it, however backwards compatibility is an issue.&lt;br/&gt;
I am fine with deprecating it and show a warning to the user.&lt;br/&gt;
We can remove it altogether in next release.&lt;br/&gt;
(if we choose this way, let&apos;s open a Jira to keep track of it).&lt;/p&gt;</comment>
                            <comment id="13485706" author="rohini" created="Sun, 28 Oct 2012 20:25:24 +0000"  >&lt;p&gt;Gianmarco,&lt;br/&gt;
   I am all for backward compatibility. But providing env variables to streaming is a new feature in 0.11 &lt;span class=&quot;error&quot;&gt;&amp;#91;PIG-2900 and PIG-2971&amp;#93;&lt;/span&gt; and the convert setting is being introduced with this patch and was not there before. I could not think of a need or a use case where we need to convert the environment setting provided by the user which is going to be consumed by his script. If we have a use case scenario for it, then I have no objections to add the setting.&lt;/p&gt;</comment>
                            <comment id="13485710" author="azaroth" created="Sun, 28 Oct 2012 21:03:23 +0000"  >&lt;p&gt;Thanks Rohini, I had missed this bit.&lt;br/&gt;
Then I also vote for removing the conversion.&lt;/p&gt;</comment>
                            <comment id="13485806" author="cheolsoo" created="Mon, 29 Oct 2012 03:13:06 +0000"  >&lt;p&gt;Then, I will go back to my 1st patch that removes safeEnvVarName().&lt;/p&gt;

&lt;p&gt;Updating the patch.&lt;/p&gt;</comment>
                            <comment id="13487236" author="jcoveney" created="Tue, 30 Oct 2012 21:04:58 +0000"  >&lt;p&gt;+1 looks good to me. I agree with Rohini&apos;s opinion completely.&lt;/p&gt;</comment>
                            <comment id="13487434" author="cheolsoo" created="Wed, 31 Oct 2012 01:24:44 +0000"  >&lt;p&gt;Thanks Jon for reviewing it. Committed to trunk/0.11.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12611878">PIG-2971</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12605800">PIG-2900</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12550708" name="PIG-3001-2.patch" size="2569" author="cheolsoo" created="Thu, 25 Oct 2012 00:40:13 +0100"/>
                            <attachment id="12550738" name="PIG-3001-3.patch" size="1401" author="cheolsoo" created="Thu, 25 Oct 2012 04:19:39 +0100"/>
                            <attachment id="12550746" name="PIG-3001-4.patch" size="9633" author="cheolsoo" created="Thu, 25 Oct 2012 07:01:13 +0100"/>
                            <attachment id="12551149" name="PIG-3001-5.patch" size="2774" author="cheolsoo" created="Mon, 29 Oct 2012 03:13:06 +0000"/>
                            <attachment id="12550701" name="PIG-3001.patch" size="2774" author="cheolsoo" created="Wed, 24 Oct 2012 23:44:49 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 24 Oct 2012 22:44:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>250785</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4w0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62347</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>