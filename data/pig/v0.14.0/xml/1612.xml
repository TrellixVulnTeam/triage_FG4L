<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:50:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1612/PIG-1612.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1612] error reporting: PigException needs to have a way to indicate that its message is appropriate for user</title>
                <link>https://issues.apache.org/jira/browse/PIG-1612</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The error message printed to the user by pig is the message from the exception that is the &apos;root cause&apos; from the chain of getCause() of exception that has been thrown. But often the &apos;root cause&apos; exception does not have enough context that would make for a better error message. It should be possible for a PigException to indicate to the code that determines the error message that its getMessage() string should be used instead of that of the &apos;cause&apos; exception.&lt;/p&gt;

&lt;p&gt;The following code in LogUtils.java is used to determine the exception that is the &apos;root cause&apos; -&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; PigException getPigException(Throwable top) {
        Throwable current = top;
        Throwable pigException = top;

        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (current != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; current.getCause() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;){
            current = current.getCause();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;((current &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; PigException) &amp;amp;&amp;amp; (((PigException)current).getErrorCode() != 0)) {
                pigException = current;
            }
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (pigException &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; PigException? (PigException)pigException : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


</description>
                <environment></environment>
        <key id="12474114">PIG-1612</key>
            <summary>error reporting: PigException needs to have a way to indicate that its message is appropriate for user</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="laukik">Laukik Chitnis</assignee>
                                    <reporter username="thejas">Thejas M Nair</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Sep 2010 20:59:41 +0100</created>
                <updated>Thu, 4 Aug 2011 01:35:04 +0100</updated>
                            <resolved>Tue, 19 Apr 2011 01:29:49 +0100</resolved>
                                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12909418" author="thejas" created="Tue, 14 Sep 2010 21:05:46 +0100"  >&lt;p&gt;For example, in this exception stack trace -&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: org.apache.pig.impl.logicalLayer.parser.ParseException: Error merging schemas &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; union &lt;span class=&quot;code-keyword&quot;&gt;operator&lt;/span&gt; : Error merging schema: ({i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;}) with merged schema: ({l1::i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,l1::j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,l2::i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,l2::j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;}) of schemas : [{l1::i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,l1::j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,l2::i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,
l2::j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;}]
        at org.apache.pig.impl.logicalLayer.parser.QueryParser.UnionClause(QueryParser.java:3409)
        at org.apache.pig.impl.logicalLayer.parser.QueryParser.BaseExpr(QueryParser.java:1457)
        at org.apache.pig.impl.logicalLayer.parser.QueryParser.Expr(QueryParser.java:1010)
        at org.apache.pig.impl.logicalLayer.parser.QueryParser.Parse(QueryParser.java:797)
        at org.apache.pig.impl.logicalLayer.LogicalPlanBuilder.parse(LogicalPlanBuilder.java:63)
        at org.apache.pig.PigServer$Graph.parseQuery(PigServer.java:1593)
        ... 13 more
Caused by: org.apache.pig.impl.logicalLayer.schema.SchemaMergeException: ERROR 0: Error merging schema: ({i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;}) with merged schema: ({l1::i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,l1::j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,l2::i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,l2::j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;}) of schemas : [{l1::i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,l1::j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,l2::i: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;,l2::j: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;}]
        at org.apache.pig.impl.logicalLayer.schema.Schema.mergeSchemasByAlias(Schema.java:1652)
        at org.apache.pig.impl.logicalLayer.parser.QueryParser.UnionClause(QueryParser.java:3405)
        ... 18 more
Caused by: org.apache.pig.impl.logicalLayer.schema.SchemaMergeException: ERROR 0: Caught exception finding FieldSchema &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; aliasi
        at org.apache.pig.impl.logicalLayer.schema.Schema.getFieldSubNameMatchThrowSchemaMergeException(Schema.java:1787)
        at org.apache.pig.impl.logicalLayer.schema.Schema.mergeSchemaByAlias(Schema.java:1686)
        at org.apache.pig.impl.logicalLayer.schema.Schema.mergeSchemasByAlias(Schema.java:1646)
        ... 19 more
Caused by: org.apache.pig.impl.logicalLayer.FrontendException: ERROR 1025: Found more than one match: l1::i, l2::i
        at org.apache.pig.impl.logicalLayer.schema.Schema.getField(Schema.java:819)
        at org.apache.pig.impl.logicalLayer.schema.Schema.getFieldSubNameMatch(Schema.java:836)
        at org.apache.pig.impl.logicalLayer.schema.Schema.getFieldSubNameMatchThrowSchemaMergeException(Schema.java:1783)
        ... 21 more

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The pig statement that results in this error is a union command -&lt;br/&gt;
u = union onschema f, l3;&lt;/p&gt;

&lt;p&gt;The error message that is printed only says -  &apos;Found more than one match: l1::i, l2::i&apos; . It would be more useful for the user if we are able to say something on lines of  -&lt;br/&gt;
&quot;Error merging schema: (&lt;/p&gt;
{i: int,j: long}
&lt;p&gt;) with merged schema: (&lt;/p&gt;
{l1::i: int,l1::j: long,l2::i: int,l2::j: long}
&lt;p&gt;) of schemas : [&lt;/p&gt;
{l1::i: int,l1::j: long,l2::i: int,l2::j: long}
&lt;p&gt;]. Found more than one match: l1::i, l2::i&quot; (assuming this was the message generated exception from Schema.java:1652)&lt;/p&gt;
</comment>
                            <comment id="13020078" author="alangates" created="Thu, 14 Apr 2011 23:54:07 +0100"  >&lt;p&gt;Based on your example, it looks like the resulting error message is a concatenation of the higher level exception that claimed it was the &quot;right&quot; one and the lowest message.  Is that right?  &lt;/p&gt;

&lt;p&gt;What happens when multiple exceptions in the stack claim to be &quot;right&quot;.  Do we concatenate their messages or take the highest one in the stack?&lt;/p&gt;</comment>
                            <comment id="13020123" author="thejas" created="Fri, 15 Apr 2011 01:12:20 +0100"  >&lt;blockquote&gt;&lt;p&gt;Based on your example, it looks like the resulting error message is a concatenation of the higher level exception that claimed it was the &quot;right&quot; one and the lowest message. Is that right?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The decision to concatenate the message from the &apos;cause&apos; exception would be taken by the higher level exception. In this case it happens to do that . What is printed is the message of the exception that is selected as most appropriate to be shown to user.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;What happens when multiple exceptions in the stack claim to be &quot;right&quot;. Do we concatenate their messages or take the highest one in the stack?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;When an exception has this flag set, the assumption is that it has the right level of information that user needs. So in this case the highest one in stack that claims to be right is picked.&lt;/p&gt;


</comment>
                            <comment id="13020913" author="laukik" created="Mon, 18 Apr 2011 07:33:22 +0100"  >&lt;p&gt;Incorporating some minor changes from the code review.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;     [exec]
     [exec] +1 overall.
     [exec]
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec]
     [exec]     +1 tests included.  The patch appears to include 3 new or modified tests.
     [exec]
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec]
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec]
     [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.
     [exec]
     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.
     [exec]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13021357" author="thejas" created="Tue, 19 Apr 2011 01:29:49 +0100"  >&lt;p&gt;+1&lt;br/&gt;
Patch committed to trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12474970" name="PIG-1612-2.patch" size="5607" author="laukik" created="Wed, 30 Mar 2011 15:49:28 +0100"/>
                            <attachment id="12476582" name="PIG-1612-3.patch" size="6540" author="laukik" created="Mon, 18 Apr 2011 07:33:22 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 14 Apr 2011 22:54:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66162</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyasbj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96899</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>