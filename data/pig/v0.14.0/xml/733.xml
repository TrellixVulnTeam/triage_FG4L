<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:09:30 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-733/PIG-733.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-733] Order by sampling dumps entire sample to hdfs which causes dfs &quot;FileSystem closed&quot; error on large input</title>
                <link>https://issues.apache.org/jira/browse/PIG-733</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Order by has a sampling job which samples the input and creates a sorted list of sample items. CUrrently the number of items sampled is 100 per map task. So if the input is large resulting in many maps (say 50,000) the sample is big. This sorted sample is stored on dfs. The WeightedRangePartitioner computes quantile boundaries and weighted probabilities for repeating values in each map by reading the samples file from DFS. In queries with many maps (in the order of 50,000) the dfs read of the sample file fails with &quot;FileSystem closed&quot; error. This seems to point to a dfs issue wherein a big dfs file being read simultaneously by many dfs clients (in this case all maps) causes the clients to be closed. However on the pig side, loading the sample from each map in the final map reduce job and computing the quantile boundaries and weighted probabilities is inefficient. We should do this computation through a FindQuantiles udf in the same map reduce job which produces the sorted samples. This way lesser data is written to dfs and in the final map reduce job, the weightedRangePartitioner needs to just load the computed information.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12419415">PIG-733</key>
            <summary>Order by sampling dumps entire sample to hdfs which causes dfs &quot;FileSystem closed&quot; error on large input</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pkamath">Pradeep Kamath</assignee>
                                    <reporter username="pkamath">Pradeep Kamath</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Mar 2009 19:04:22 +0000</created>
                <updated>Wed, 24 Mar 2010 22:10:57 +0000</updated>
                            <resolved>Fri, 10 Apr 2009 03:36:14 +0100</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12694826" author="pkamath" created="Thu, 2 Apr 2009 00:32:57 +0100"  >&lt;p&gt;Attached patch which implements the fix described in the description of the issue&lt;/p&gt;</comment>
                            <comment id="12694855" author="hadoopqa" created="Thu, 2 Apr 2009 02:12:34 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12404402/PIG-733.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12404402/PIG-733.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 759376.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The applied patch generated 207 javac compiler warnings (more than the trunk&apos;s current 200 warnings).&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 5 new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/18/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/18/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/18/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/18/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/18/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/18/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12696244" author="pkamath" created="Mon, 6 Apr 2009 21:53:24 +0100"  >&lt;p&gt;Tests are not included in this patch since there are existing tests for order by.&lt;/p&gt;

&lt;p&gt;All core unit tests did pass and finbugs gave the same number of warnings with and without the patch (output below). The excess warnings produced by the patch have been addressed in the new version of the patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-733&quot; title=&quot;Order by sampling dumps entire sample to hdfs which causes dfs &amp;quot;FileSystem closed&amp;quot; error on large input&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-733&quot;&gt;&lt;del&gt;PIG-733&lt;/del&gt;&lt;/a&gt;-v2.patch).&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;=== CORE UNIT TESTS OUTPUT WITH PATCH====
[pradeepk@afterside:/tmp/PIG-733/trunk]


test-core:
    [mkdir] Created dir: /tmp/PIG-733/trunk/build/test/logs
    [junit] Running org.apache.pig.test.TestAdd
    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.056 sec
...
    [junit] Running org.apache.pig.test.TestTypeCheckingValidatorNoSchema
    [junit] Tests run: 13, Failures: 0, Errors: 0, Time elapsed: 0.629 sec
    [junit] Running org.apache.pig.test.TestUnion
    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 49.94 sec

test-contrib:

BUILD SUCCESSFUL
Total time: 77 minutes 47 seconds

=== FINDBUGS OUTPUT WITH PATCH====
[pradeepk@afterside:/tmp/PIG-733/trunk]

[pradeepk@chargesize:/tmp/PIG-733/trunk]ant -Dfindbugs.home=/homes/pradeepk/findbugs-1.3.8 findbugs
Buildfile: build.xml
...
findbugs:
    [mkdir] Created dir: /tmp/PIG-733/trunk/build/test/findbugs
 [findbugs] Executing findbugs from ant task
 [findbugs] Running FindBugs...
 [findbugs] Warnings generated: 665
 [findbugs] Calculating exit code...
 [findbugs] Setting &apos;bugs found&apos; flag (1)
 [findbugs] Exit code set to: 1
 [findbugs] Java Result: 1
 [findbugs] Output saved to /tmp/PIG-733/trunk/build/test/findbugs/pig-findbugs-report.xml
     [xslt] Processing /tmp/PIG-733/trunk/build/test/findbugs/pig-findbugs-report.xml to /tmp/PIG-733/trunk/build/test/findbugs/pig-findbugs-report.html
     [xslt] Loading stylesheet /homes/pradeepk/findbugs-1.3.8/src/xsl/default.xsl

=== FINDBUGS OUTPUT WITHOUT PATCH====
[pradeepk@chargesize:/tmp/svncheckout/trunk]ant -Dfindbugs.home=/homes/pradeepk/findbugs-1.3.8 findbugs
Buildfile: build.xml

check-for-findbugs:

...
findbugs:
    [mkdir] Created dir: /tmp/svncheckout/trunk/build/test/findbugs
 [findbugs] Executing findbugs from ant task
 [findbugs] Running FindBugs...
 [findbugs] Warnings generated: 665
 [findbugs] Calculating exit code...
 [findbugs] Setting &apos;bugs found&apos; flag (1)
 [findbugs] Exit code set to: 1
 [findbugs] Java Result: 1
 [findbugs] Output saved to /tmp/svncheckout/trunk/build/test/findbugs/pig-findbugs-report.xml
     [xslt] Processing /tmp/svncheckout/trunk/build/test/findbugs/pig-findbugs-report.xml to /tmp/svncheckout/trunk/build/test/findbugs/pig-findbugs-report.html
     [xslt] Loading stylesheet /homes/pradeepk/findbugs-1.3.8/src/xsl/default.xsl



&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12696416" author="gkesavan" created="Tue, 7 Apr 2009 07:11:09 +0100"  >&lt;p&gt;I&apos;m going to resubmit the patch to hudson .. &lt;/p&gt;</comment>
                            <comment id="12696442" author="hadoopqa" created="Tue, 7 Apr 2009 10:03:55 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12404769/PIG-733-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12404769/PIG-733-v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 759376.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 5 new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/21/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/21/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/21/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/21/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/21/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/21/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12696581" author="olgan" created="Tue, 7 Apr 2009 16:42:04 +0100"  >&lt;p&gt;The patch process still seems broken - Giri could you please investigate.&lt;/p&gt;

&lt;p&gt;Pradeep, since the patch has been sufficiently tested and passes outside of hudson, please, go ahead and commit it.&lt;/p&gt;</comment>
                            <comment id="12697717" author="pkamath" created="Fri, 10 Apr 2009 03:36:14 +0100"  >&lt;p&gt;patch committed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12404769" name="PIG-733-v2.patch" size="29121" author="pkamath" created="Mon, 6 Apr 2009 21:58:41 +0100"/>
                            <attachment id="12404402" name="PIG-733.patch" size="28782" author="pkamath" created="Thu, 2 Apr 2009 00:33:40 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 2 Apr 2009 01:12:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164300</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyai9j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95270</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>