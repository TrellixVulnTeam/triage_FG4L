<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:00:53 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3661/PIG-3661.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3661] Piggybank AvroStorage fails if used in more than one load or store statement</title>
                <link>https://issues.apache.org/jira/browse/PIG-3661</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;To reproduce:&lt;br/&gt;
A =load &apos;/tmp/data&apos; as (a1:int, a2:int, a3:int);&lt;br/&gt;
B = load &apos;/tmp/data1&apos; as (b1:chararray, b2:chararray, b3:chararray);&lt;br/&gt;
store A into &apos;/tmp/out/a&apos; using org.apache.pig.piggybank.storage.avro.AvroStorage();&lt;br/&gt;
store B into &apos;/tmp/out2/b&apos; using org.apache.pig.piggybank.storage.avro.AvroStorage();&lt;/p&gt;

&lt;p&gt;It either fails in the map job if schema is incompatible, or B gets schema of A and B merged leading to incorrect results.&lt;/p&gt;

&lt;p&gt;Reason is schema is stored and accessed from a property of UDFContext without using a context signature.&lt;/p&gt;

&lt;p&gt;UDFContext context = UDFContext.getUDFContext();&lt;br/&gt;
        Properties property = context.getUDFProperties(ResourceSchema.class);&lt;br/&gt;
        String prevSchemaStr = property.getProperty(AVRO_OUTPUT_SCHEMA_PROPERTY);&lt;/p&gt;</description>
                <environment></environment>
        <key id="12688111">PIG-3661</key>
            <summary>Piggybank AvroStorage fails if used in more than one load or store statement</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rohini">Rohini Palaniswamy</assignee>
                                    <reporter username="rohini">Rohini Palaniswamy</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Jan 2014 18:03:27 +0000</created>
                <updated>Tue, 15 Apr 2014 21:44:58 +0100</updated>
                            <resolved>Fri, 24 Jan 2014 22:24:42 +0000</resolved>
                                    <version>0.11.1</version>
                                    <fixVersion>0.12.1</fixVersion>
                    <fixVersion>0.13.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13880376" author="rohini" created="Thu, 23 Jan 2014 21:22:59 +0000"  >&lt;p&gt;This patch fixes other issues with AvroStorage as well apart from fixing multiple load and store&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Hidden files were not excluded (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3717&quot; title=&quot;AvroStorage is not filtering hidden files on directory recursion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3717&quot;&gt;&lt;del&gt;PIG-3717&lt;/del&gt;&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;mapred.input.dir was getting populated with all files instead of the top level directory making the conf very big&lt;/li&gt;
	&lt;li&gt;Default value was not set for a Union&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/17266/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/17266/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13881487" author="rohini" created="Fri, 24 Jan 2014 22:24:42 +0000"  >&lt;p&gt;Committed to trunk. Thanks Cheolsoo for the review.&lt;/p&gt;</comment>
                            <comment id="13960440" author="cheolsoo" created="Fri, 4 Apr 2014 22:22:55 +0100"  >&lt;p&gt;We discovered piggybank TestAvroStorage fails in branch 0.12 w/o this patch due to .svn files. Backported to 0.12.1.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12690788">PIG-3717</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12624915" name="PIG-3661-1.patch" size="28777" author="rohini" created="Thu, 23 Jan 2014 21:23:14 +0000"/>
                            <attachment id="12625102" name="PIG-3661-2.patch" size="29102" author="rohini" created="Fri, 24 Jan 2014 20:28:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 4 Apr 2014 21:22:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>367117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzl4p3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>367427</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>