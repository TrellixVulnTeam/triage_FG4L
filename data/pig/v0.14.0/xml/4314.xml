<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:00:15 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-4314/PIG-4314.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-4314] BigData_5 hang on some machine</title>
                <link>https://issues.apache.org/jira/browse/PIG-4314</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Hang for both tez and mr. Here is the log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-11-07 19:49:45,799 INFO [TezChild] relationalOperators.POPartialAgg: Aggregated 10000 raw tuples. Processed tuples before aggregation = 0, after aggregation = 676
2014-11-07 19:49:45,799 INFO [TezChild] relationalOperators.POPartialAgg: After reduction, processed map: 676; raw map: 0
2014-11-07 19:49:45,800 INFO [TezChild] relationalOperators.POPartialAgg: Observed reduction factor: from 10000 to 676 =&amp;gt; 14.
2014-11-07 19:49:45,992 INFO [TezChild] relationalOperators.POPartialAgg: Getting mem limits; considering 1 POPArtialAgg objects. with memory percentage 0.2
2014-11-07 19:49:46,290 INFO [TezChild] relationalOperators.POPartialAgg: Estimated total tuples to buffer, based on 10000 tuples that took up 2364864 bytes: 1052574
2014-11-07 19:49:46,290 INFO [TezChild] relationalOperators.POPartialAgg: Setting thresholds. Primary: 977390. Secondary: 75184
2014-11-07 19:49:50,641 INFO [Service &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] util.SpillableMemoryManager: first memory handler call - Collection threshold init = 216530944(211456K) used = 724849000(707860K) committed = 927989760(906240K) max = 1146093568(1119232K)
2014-11-07 19:49:50,644 INFO [Service &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] relationalOperators.POPartialAgg: Spill triggered by SpillableMemoryManager
2014-11-07 19:49:50,993 INFO [TezChild] relationalOperators.POPartialAgg: Aggregated 346545 raw tuples. Processed tuples before aggregation = 676, after aggregation = 1352
2014-11-07 19:49:50,998 INFO [TezChild] relationalOperators.POPartialAgg: Aggregated 1352 processed tuples to 676 tuples
2014-11-07 19:49:50,998 INFO [TezChild] relationalOperators.POPartialAgg: Avoided emitting records during spill memory call.
2014-11-07 19:49:51,046 INFO [Service &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] relationalOperators.POPartialAgg: Finished spill &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; SpillableMemoryManager call
2014-11-07 19:49:51,851 INFO [Service &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] util.SpillableMemoryManager: Spilled an estimate of 81943920 bytes from 1 objects. init = 216530944(211456K) used = 724849000(707860K) committed = 927989760(906240K) max = 1146093568(1119232K)
2014-11-07 19:49:59,644 INFO [Service &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] relationalOperators.POPartialAgg: Spill triggered by SpillableMemoryManager
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12753883">PIG-4314</key>
            <summary>BigData_5 hang on some machine</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daijy">Daniel Dai</assignee>
                                    <reporter username="daijy">Daniel Dai</reporter>
                        <labels>
                    </labels>
                <created>Sat, 8 Nov 2014 02:20:03 +0000</created>
                <updated>Fri, 21 Nov 2014 05:59:03 +0000</updated>
                            <resolved>Tue, 11 Nov 2014 18:15:56 +0000</resolved>
                                                    <fixVersion>0.14.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="14203146" author="daijy" created="Sat, 8 Nov 2014 02:21:35 +0000"  >&lt;p&gt;We shall always do spill if we are in handleNotification. Attach a patch.&lt;/p&gt;</comment>
                            <comment id="14203477" author="rohini" created="Sat, 8 Nov 2014 15:56:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt;,&lt;br/&gt;
   +1. Can we comment out the old code for now instead of removing it and put a TODO. I would like to go back and investigate for 0.14.1 why just aggregating is not good enough and it hangs. &lt;/p&gt;</comment>
                            <comment id="14203654" author="daijy" created="Sat, 8 Nov 2014 22:36:37 +0000"  >&lt;p&gt;Sure, I put a TODO tag in new patch.&lt;/p&gt;</comment>
                            <comment id="14203655" author="daijy" created="Sat, 8 Nov 2014 22:38:16 +0000"  >&lt;p&gt;Patch committed to both trunk and 0.14 branch. Thanks Rohini for review!&lt;/p&gt;</comment>
                            <comment id="14205839" author="daijy" created="Tue, 11 Nov 2014 02:27:39 +0000"  >&lt;p&gt;The patch does not completely solve the issue. See job hanging again. Here is the stack:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: BLOCKED (on object monitor)
	at org.apache.pig.impl.util.SpillableMemoryManager.registerSpillable(SpillableMemoryManager.java:327)
	- waiting to lock &amp;lt;0x00000000d9d02648&amp;gt; (a java.util.LinkedList)
	at org.apache.pig.data.DefaultAbstractBag.markSpillableIfNecessary(DefaultAbstractBag.java:129)
	at org.apache.pig.data.DefaultAbstractBag.add(DefaultAbstractBag.java:118)
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POPartialAgg.createValueTuple(POPartialAgg.java:482)
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POPartialAgg.aggregate(POPartialAgg.java:419)
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POPartialAgg.aggregateFirstLevel(POPartialAgg.java:453)
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POPartialAgg.aggregateBothLevels(POPartialAgg.java:436)
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POPartialAgg.getNextTuple(POPartialAgg.java:207)
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.PhysicalOperator.processInput(PhysicalOperator.java:307)
	at org.apache.pig.backend.hadoop.executionengine.physicalLayer.relationalOperators.POLocalRearrange.getNextTuple(POLocalRearrange.java:291)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBase.runPipeline(PigGenericMapBase.java:283)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBase.map(PigGenericMapBase.java:278)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigGenericMapBase.map(PigGenericMapBase.java:64)
	at org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:145)
	at org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:784)
	at org.apache.hadoop.mapred.MapTask.run(MapTask.java:341)
	at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:163)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1628)
	at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:158)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="14205844" author="daijy" created="Tue, 11 Nov 2014 02:33:46 +0000"  >&lt;p&gt;POPartialAgg.spill hold spillables and prevent POPartialAgg.aggregate to register bag. Revert &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4314&quot; title=&quot;BigData_5 hang on some machine&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4314&quot;&gt;&lt;del&gt;PIG-4314&lt;/del&gt;&lt;/a&gt;-2.patch and attach &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4314&quot; title=&quot;BigData_5 hang on some machine&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4314&quot;&gt;&lt;del&gt;PIG-4314&lt;/del&gt;&lt;/a&gt;-3.patch which does not use DefaultDataBag which need to register to SpillableMemoryManager.&lt;/p&gt;</comment>
                            <comment id="14206703" author="daijy" created="Tue, 11 Nov 2014 17:58:48 +0000"  >&lt;p&gt;Some refine on memory usage.&lt;/p&gt;</comment>
                            <comment id="14206706" author="rohini" created="Tue, 11 Nov 2014 18:01:38 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14206738" author="daijy" created="Tue, 11 Nov 2014 18:15:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4314&quot; title=&quot;BigData_5 hang on some machine&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4314&quot;&gt;&lt;del&gt;PIG-4314&lt;/del&gt;&lt;/a&gt;-4.patch committed to both trunk and 0.14 branch. Thanks again, Rohini!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12680350" name="PIG-4314-1.patch" size="1025" author="daijy" created="Sat, 8 Nov 2014 02:22:50 +0000"/>
                            <attachment id="12680436" name="PIG-4314-2.patch" size="1406" author="daijy" created="Sat, 8 Nov 2014 22:36:37 +0000"/>
                            <attachment id="12680727" name="PIG-4314-3.patch" size="1947" author="daijy" created="Tue, 11 Nov 2014 02:33:46 +0000"/>
                            <attachment id="12680824" name="PIG-4314-4.patch" size="1973" author="daijy" created="Tue, 11 Nov 2014 17:58:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 8 Nov 2014 15:56:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzw08v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>