<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:01:48 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2979/PIG-2979.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2979] Pig.jar doesn&apos;t work with hadoop-2.0.x</title>
                <link>https://issues.apache.org/jira/browse/PIG-2979</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;To reproduce, please do the following:&lt;/p&gt;

&lt;p&gt;1) ensure that no hadoop is installed and therefore no hadoop classes are present in classpath.&lt;br/&gt;
2) ant clean jar -Dhadoopversion=23&lt;br/&gt;
3) ./bin/pig -x local&lt;br/&gt;
4) fail with the following error: (you may not see this if slf4j is available in classpath.)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cheolsoo@localhost:~/workspace/pig-trunk $cat  /home/cheolsoo/workspace/pig-trunk/pig_1350687456711.log
Error before Pig is launched
----------------------------
ERROR 2998: Unhandled internal error. org/slf4j/LoggerFactory

java.lang.NoClassDefFoundError: org/slf4j/LoggerFactory
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;5) cp ./build/ivy/lib/Pig/slf4j-api-1.6.1.jar lib&lt;br/&gt;
6) ./bin/pig -x local&lt;br/&gt;
7) fail with the following error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cheolsoo@localhost:~/workspace/pig-trunk $cat /home/cheolsoo/workspace/pig-trunk/pig_1350687052995.log
Error before Pig is launched
----------------------------
ERROR 2999: Unexpected internal error. Failed to create DataStorage

java.lang.RuntimeException: Failed to create DataStorage
	at org.apache.pig.backend.hadoop.datastorage.HDataStorage.init(HDataStorage.java:75)
	at org.apache.pig.backend.hadoop.datastorage.HDataStorage.&amp;lt;init&amp;gt;(HDataStorage.java:58)
	at org.apache.pig.backend.hadoop.executionengine.HExecutionEngine.init(HExecutionEngine.java:204)
	at org.apache.pig.backend.hadoop.executionengine.HExecutionEngine.init(HExecutionEngine.java:117)
	at org.apache.pig.impl.PigContext.connect(PigContext.java:229)
	at org.apache.pig.PigServer.&amp;lt;init&amp;gt;(PigServer.java:213)
	at org.apache.pig.PigServer.&amp;lt;init&amp;gt;(PigServer.java:198)
	at org.apache.pig.tools.grunt.Grunt.&amp;lt;init&amp;gt;(Grunt.java:47)
	at org.apache.pig.Main.run(Main.java:535)
	at org.apache.pig.Main.main(Main.java:154)
Caused by: java.io.IOException: No FileSystem &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; scheme: file
	at org.apache.hadoop.fs.FileSystem.getFileSystemClass(FileSystem.java:2130)
	at org.apache.hadoop.fs.FileSystem.createFileSystem(FileSystem.java:2137)
	at org.apache.hadoop.fs.FileSystem.access$200(FileSystem.java:80)
	at org.apache.hadoop.fs.FileSystem$Cache.getInternal(FileSystem.java:2176)
	at org.apache.hadoop.fs.FileSystem$Cache.get(FileSystem.java:2158)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:302)
	at org.apache.hadoop.fs.FileSystem.get(FileSystem.java:158)
	at org.apache.pig.backend.hadoop.datastorage.HDataStorage.init(HDataStorage.java:72)
	... 9 more
================================================================================
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;8) cp ./build/ivy/lib/Pig/hadoop-common-2.0.0-alpha.jar lib&lt;br/&gt;
9) ./bin/pig -x local&lt;br/&gt;
10) works fine!&lt;/p&gt;

&lt;p&gt;In fact, this is also an issue with running e2e test in local mode:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ant clean
ant -Dharness.old.pig=old_pig -Dharness.cluster.conf=hadoop_conf_dir -Dharness.cluster.bin=hadoop_script test-e2e-deploy-local -Dhadoopversion=23
ant -Dharness.old.pig=old_pig -Dharness.cluster.conf=hadoop_conf_dir -Dharness.cluster.bin=hadoop_script test-e2e-local -Dhadoopversion=23
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The ant test-e2e-local fails with the following error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.NoClassDefFoundError: org/slf4j/LoggerFactory
        at org.apache.hadoop.security.authentication.util.KerberosName.&amp;lt;clinit&amp;gt;(KerberosName.java:42)
        at org.apache.hadoop.security.UserGroupInformation.ensureInitialized(UserGroupInformation.java:211)
        at org.apache.hadoop.security.UserGroupInformation.isSecurityEnabled(UserGroupInformation.java:274)
        at org.apache.hadoop.security.UserGroupInformation.getLoginUser(UserGroupInformation.java:531)
        at org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:512)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12611918">PIG-2979</key>
            <summary>Pig.jar doesn&apos;t work with hadoop-2.0.x</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12611880">PIG-2972</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cheolsoo">Cheolsoo Park</assignee>
                                    <reporter username="cheolsoo">Cheolsoo Park</reporter>
                        <labels>
                    </labels>
                <created>Mon, 15 Oct 2012 22:56:48 +0100</created>
                <updated>Fri, 22 Feb 2013 04:54:11 +0000</updated>
                            <resolved>Fri, 9 Nov 2012 00:43:15 +0000</resolved>
                                                    <fixVersion>0.11</fixVersion>
                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13482657" author="cheolsoo" created="Tue, 23 Oct 2012 21:35:38 +0100"  >&lt;p&gt;There are 2 issues:&lt;/p&gt;

&lt;p&gt;1) slf4j has to be bundled in pig.jar. Easy to fix.&lt;/p&gt;

&lt;p&gt;2) java.io.IOException: No FileSystem for scheme: file&lt;/p&gt;

&lt;p&gt;This is a regression from &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7549&quot; title=&quot;Use JDK ServiceLoader mechanism to find FileSystem implementations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7549&quot;&gt;&lt;del&gt;HADOOP-7549&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7549&quot; title=&quot;Use JDK ServiceLoader mechanism to find FileSystem implementations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7549&quot;&gt;&lt;del&gt;HADOOP-7549&lt;/del&gt;&lt;/a&gt; made the FileSystem implementation be configured by ServiceLoader instead of by configuration files. As part of changes, the &quot;fs.file.impl&quot; property is removed from core-default.xml.&lt;/p&gt;

&lt;p&gt;Now to map the scheme &quot;file://&quot; to the hadoop.fs.LocalFileSystem class, the fully qualified name of LocalFileSystem must be listed in the provider-configuration file (META-INF/services/org.apache.hadoop.fs.FileSystem) in pig.jar. However, it isn&apos;t.&lt;/p&gt;

&lt;p&gt;Here is the diff of META-INF/services/org.apache.hadoop.fs.FileSystem of hadoop-commom.jar and pig.jar:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;hadoop-commom.jar&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.hadoop.fs.LocalFileSystem
org.apache.hadoop.fs.viewfs.ViewFileSystem
org.apache.hadoop.fs.s3.S3FileSystem
org.apache.hadoop.fs.s3native.NativeS3FileSystem
org.apache.hadoop.fs.kfs.KosmosFileSystem
org.apache.hadoop.fs.ftp.FTPFileSystem
org.apache.hadoop.fs.HarFileSystem
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;pig.ajr&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.hadoop.hdfs.DistributedFileSystem
org.apache.hadoop.hdfs.HftpFileSystem
org.apache.hadoop.hdfs.HsftpFileSystem
org.apache.hadoop.hdfs.web.WebHdfsFileSystem
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13482743" author="cheolsoo" created="Tue, 23 Oct 2012 23:06:23 +0100"  >&lt;p&gt;The problem is that the provider-configuration file of hadoop-hdfs.jar overwrites that of hadoop-common.jar since both files have the same name.&lt;/p&gt;

&lt;p&gt;Attached is a patch that includes two changes:&lt;br/&gt;
1) bundle slf4j&amp;#42;.jar in pig.jar&lt;br/&gt;
2) exclude hadoop-hdfs.jar from pig.jar. Since pig.jar is meant to be used in local mode only, I don&apos;t think that hadoop-hdfs.jar is needed at all. Please correct me if you think otherwise.&lt;/p&gt;

&lt;p&gt;With the patch, &quot;ant e2e-test-local&quot; as well as &quot;./bin/pig -x local&quot; runs fine.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13493570" author="cheolsoo" created="Thu, 8 Nov 2012 22:32:56 +0000"  >&lt;p&gt;Bump for review. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13493635" author="rohini" created="Fri, 9 Nov 2012 00:19:06 +0000"  >&lt;p&gt;+1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13493643" author="cheolsoo" created="Fri, 9 Nov 2012 00:43:15 +0000"  >&lt;p&gt;Committed to trunk/0.11. Thanks Rohini for reviewing!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12612796">PIG-2993</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12550539" name="PIG-2979.patch" size="1078" author="cheolsoo" created="Tue, 23 Oct 2012 23:06:23 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 9 Nov 2012 00:19:06 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248836</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy3v3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56362</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>