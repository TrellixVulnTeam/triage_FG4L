<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:56:54 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1211/PIG-1211.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1211] Pig script runs half way after which it reports syntax error</title>
                <link>https://issues.apache.org/jira/browse/PIG-1211</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;I have a Pig script which is structured in the following way&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
register cp.jar

dataset = load &apos;/data/dataset/&apos; using PigStorage(&apos;\u0001&apos;) as (col1, col2, col3, col4, col5);

filtered_dataset = filter dataset by (col1 == 1);

proj_filtered_dataset = foreach filtered_dataset generate col2, col3;

rmf $output1;

store proj_filtered_dataset into &apos;$output1&apos; using PigStorage();

second_stream = foreach filtered_dataset  generate col2, col4, col5;

group_second_stream = group second_stream by col4;

output2 = foreach group_second_stream {
 a =  second_stream.col2
 b =   distinct second_stream.col5;
 c = order b by $0;
 generate 1 as key, group as keyword, MYUDF(c, 100) as finalcalc;
}

rmf  $output2;

--syntax error here
store output2 to &apos;$output2&apos; using PigStorage();

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I run this script using the Multi-query option, it runs successfully till the first store but later fails with a syntax error. &lt;/p&gt;

&lt;p&gt;The usage of HDFS option, &quot;rmf&quot; causes the first store to execute. &lt;/p&gt;

&lt;p&gt;The only option the I have is to run an explain before running his script &lt;/p&gt;

&lt;p&gt;grunt&amp;gt; explain -script myscript.pig -out explain.out&lt;/p&gt;

&lt;p&gt;or moving the rmf statements to the top of the script&lt;/p&gt;

&lt;p&gt;Here are some questions:&lt;/p&gt;

&lt;p&gt;a) Can we have an option to do something like &quot;checkscript&quot; instead of explain to get the same syntax error?  In this way I can ensure that I do not run for 3-4 hours before encountering a syntax error&lt;br/&gt;
b) Can pig not figure out a way to re-order the rmf statements since all the store directories are variables&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Viraj&lt;/p&gt;</description>
                <environment></environment>
        <key id="12446977">PIG-1211</key>
            <summary>Pig script runs half way after which it reports syntax error</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="viraj">Viraj Bhat</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Jan 2010 02:28:50 +0000</created>
                <updated>Fri, 17 Dec 2010 22:43:18 +0000</updated>
                            <resolved>Thu, 6 May 2010 01:09:08 +0100</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12859462" author="ashutoshc" created="Wed, 21 Apr 2010 19:14:36 +0100"  >&lt;blockquote&gt;&lt;p&gt;Can we have an option to do something like &quot;checkscript&quot; instead of explain to get the same syntax error? In this way I can ensure that I do not run for 3-4 hours before encountering a syntax error&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Though its possible to add something like checkscript. But, it will be a syntactic sugar, since it will do the same exact thing as explain does (but not printing the plan at the end). So,  I am thinking, shall we tell users to run explain to catch syntax errors, instead of adding this new command line option? What do others think ?&lt;/p&gt;</comment>
                            <comment id="12860419" author="viraj" created="Sat, 24 Apr 2010 00:29:17 +0100"  >&lt;p&gt;Ashutosh, I feel that the user may not be interested in running his script first using explain finding his syntax error and then again running it again to get his results.  &lt;br/&gt;
They expect Pig to tell them all the errors upfront before submitting a M/R job.&lt;/p&gt;

&lt;p&gt;Explain was not designed for checking syntax error in scripts. &lt;/p&gt;

&lt;p&gt;I believe that if you have a dump statement, explain -script will cause the script to run.&lt;/p&gt;

&lt;p&gt;Is it not possible for Pig to find out that there is an error with &quot;store&quot; syntax? &lt;/p&gt;

&lt;p&gt;Viraj&lt;/p&gt;</comment>
                            <comment id="12860614" author="ashutoshc" created="Sun, 25 Apr 2010 00:19:30 +0100"  >&lt;p&gt;Oh, I got confused. From your earlier comment, it occurred to me you are saying that we should add a -checkscript command line option. From your previous comment are you suggesting that we should add syntax checker which will always run (i.e., without needing any cmd line directive) before the query starts to execute and thereby catching as many user error as possible. I think this is a reasonable ask and will be useful to users. This might be the first step towards making a distinction between pig compile time and run-time explicit to user. If we go full length here, we might as well do what Milind suggested earlier (and in recent mail thread). We can add a &quot;compilation&quot; phase which first runs a syntax checker, then generates &quot;object code&quot; (essentially job jar) from pig script. This compiled object can then be handed over to run-time (hadoop cluster). Wow, pig-latin is evolving towards a &quot;true language&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;   &lt;/p&gt;</comment>
                            <comment id="12861106" author="viraj" created="Mon, 26 Apr 2010 22:00:07 +0100"  >&lt;p&gt;Ashutosh, yes as more and more people adopt Pig, they expect some type of guarantees, since Pig is designed to help people with no experience in writing M/R programs.&lt;/p&gt;

&lt;p&gt;If I am a novice user I have a small typo, do I wait for 3-4 hours to discover that there is a syntax error? I have not only wasted the CPU cycles but also the users productivity.&lt;/p&gt;

&lt;p&gt;The problem here is that dump and hadoop shell commands are treated differently in Pig scripts and Multi-query optimizations are ignored.&lt;/p&gt;

&lt;p&gt;I have listed what Milind and Dmitry is suggesting. Maybe this is the way future Pig Language will compile to give you a hadoop jar file in sequence or as a DAG.&lt;/p&gt;

&lt;p&gt;Pigcc -L myScript.pig -&amp;gt; parses pig script, generates logical plan, and stores it in myScript.pig.l&lt;/p&gt;

&lt;p&gt;Pigcc -P myScript.pig.l -&amp;gt; produces physical plan from the logical plan, and stores it in myScript.pig.p&lt;/p&gt;

&lt;p&gt;Pigcc -M myScript.pig.p -&amp;gt; produces map-reduce plan, myScript.pig.m&lt;/p&gt;

&lt;p&gt;Pig myScript.pig.m -&amp;gt; interprets the MR plan. This can be split into multiple sequential MR jobs plans too,  myScript.pig.m.&lt;/p&gt;
{1,2,3..}
&lt;p&gt;, so that a way to execute the pig script is to run&lt;/p&gt;

&lt;p&gt;Hadoop jar pigRT.jar myScript.pig.m.1&lt;br/&gt;
Hadoop jar pigRT.jar myScript.pig.m.2&lt;br/&gt;
Hadoop jar pigRT.jar myScript.pig.m.3&lt;br/&gt;
Hadoop jar pigRT.jar myScript.pig.m.4&lt;/p&gt;

&lt;p&gt;Thanks Viraj&lt;/p&gt;</comment>
                            <comment id="12864002" author="pradeepkth" created="Tue, 4 May 2010 22:18:25 +0100"  >&lt;p&gt;Attached patch addresses the issue by adding support for a check script option. For this purpose, the &quot;-c&quot; command line option is reused thus fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1382&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PIG-1382&lt;/a&gt; (Command line option -c doesn&apos;t work ...Currently this option is not used...).&lt;/p&gt;

&lt;p&gt;The implementation of this check option piggybacks on &quot;explain -script&quot; and just modifies the GruntParser code to not output the explain output. &lt;/p&gt;</comment>
                            <comment id="12864120" author="hadoopqa" created="Wed, 5 May 2010 03:22:14 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12443635/PIG-1211.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12443635/PIG-1211.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 941005.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 530 release audit warnings (more than the trunk&apos;s current 529 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/308/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/308/testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/308/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/308/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/308/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/308/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/308/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/308/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12864386" author="pradeepkth" created="Wed, 5 May 2010 17:13:51 +0100"  >&lt;p&gt;core unit tests are pass on my local machine - the errors reported above seem to be related to the environment. The release audit warning is due to a html file change and can be ignored - the patch is ready for review.&lt;/p&gt;</comment>
                            <comment id="12864589" author="thejas" created="Thu, 6 May 2010 00:47:04 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12864595" author="pradeepkth" created="Thu, 6 May 2010 01:09:08 +0100"  >&lt;p&gt;Patch committed to trunk&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12443635" name="PIG-1211.patch" size="23504" author="pradeepkth" created="Tue, 4 May 2010 22:18:25 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 21 Apr 2010 18:14:36 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164726</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10342"><![CDATA[Incompatible change]]></customfieldvalue>
    <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyantz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96172</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>-c (-cluster) was earlier documented as the option to provide cluster information - this was not being used in the Pig code though - with &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1211&quot; title=&quot;Pig script runs half way after which it reports syntax error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1211&quot;&gt;&lt;strike&gt;PIG-1211&lt;/strike&gt;&lt;/a&gt;, &amp;quot;-c&amp;quot; is being reused as the option to check syntax of the pig script </customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>