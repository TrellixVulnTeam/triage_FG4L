<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:58:00 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3261/PIG-3261.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3261] User set PIG_CLASSPATH entries must be prepended to the CLASSPATH, not appended</title>
                <link>https://issues.apache.org/jira/browse/PIG-3261</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Currently we are doing this wrong:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [ &lt;span class=&quot;code-quote&quot;&gt;&quot;$PIG_CLASSPATH&quot;&lt;/span&gt; != &quot;&quot; ]; then
    CLASSPATH=${CLASSPATH}:${PIG_CLASSPATH}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This means that anything added to CLASSPATH until that point will never be able to get overridden by a user set environment, which is wrong behavior. Hadoop libs for example are added to CLASSPATH, before this extension is called in bin/pig.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12639024">PIG-3261</key>
            <summary>User set PIG_CLASSPATH entries must be prepended to the CLASSPATH, not appended</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="qwertymaniac">Harsh J</assignee>
                                    <reporter username="qwertymaniac">Harsh J</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Mar 2013 01:47:21 +0000</created>
                <updated>Mon, 14 Oct 2013 17:45:48 +0100</updated>
                            <resolved>Sun, 7 Apr 2013 07:59:20 +0100</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.12.0</fixVersion>
                                    <component>grunt</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13613554" author="prkommireddi" created="Tue, 26 Mar 2013 06:29:56 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qwertymaniac&quot; class=&quot;user-hover&quot; rel=&quot;qwertymaniac&quot;&gt;Harsh J&lt;/a&gt;. Do you think user set classpath should always be added at the beginning? Or would it make sense to have a property similar to HADOOP_USER_CLASSPATH_FIRST ?&lt;/p&gt;</comment>
                            <comment id="13613608" author="qwertymaniac" created="Tue, 26 Mar 2013 08:21:11 +0000"  >&lt;p&gt;We can make it configurable and document that I guess; but its kinda odd to have to do two toggles to get an override done. In most cases of an override requirement, users are aware of the overriding so the secondary toggle seems a tad unnecessary.&lt;/p&gt;

&lt;p&gt;If you prefer that strongly, I&apos;ll send in another patch - let me know &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;An alternate fix would be to simply do the PIG_CLASSPATH addition before anything else is added to CLASSPATH, but this kinda position-in-code fix is harder to maintain over time.&lt;/p&gt;</comment>
                            <comment id="13613616" author="prkommireddi" created="Tue, 26 Mar 2013 08:31:32 +0000"  >&lt;p&gt;I am actually happy with this patch. Looking through hadoop JIRAs, documentation and comments in bin/hadoop script I could not clearly comprehend the reason for existence of the prop HADOOP_USER_CLASSPATH_FIRST. Making sure we don&apos;t miss it here if there&apos;s a legit reason, otherwise PIG_CLASSPATH is set generally when a user has certain custom jar/classpath requirements. Like you said, I don&apos;t think a user would set PIG_CLASSPATH but want default CLASSPATH to have a precedence.&lt;/p&gt;</comment>
                            <comment id="13613705" author="qwertymaniac" created="Tue, 26 Mar 2013 11:33:01 +0000"  >&lt;p&gt;IIRC the reason was to not have them step over the shipped library jars unintentionally with a simple HADOOP_CLASSPATH being set. I guess we can add a toggle instead of changing the behavior, would be safer. I&apos;ll update the patch.&lt;/p&gt;</comment>
                            <comment id="13614915" author="qwertymaniac" created="Wed, 27 Mar 2013 04:31:16 +0000"  >&lt;p&gt;Patch revised. Added an env-opt toggler PIG_USER_CLASSPATH_FIRST that preserves today&apos;s behavior if unset (default).&lt;/p&gt;

&lt;p&gt;Testing:&lt;/p&gt;

&lt;p&gt;Export:&lt;br/&gt;
&lt;tt&gt;export PIG_CLASSPATH=Foo&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Default behavior:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bash -x bin/pig
&#8230;
CLASSPATH=/Users/harshchouraria/Work/installs/pig/conf:/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/lib/tools.jar:Foo
&#8230;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Set toggle:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;export PIG_USER_CLASSPATH_FIRST=true&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bash -x bin/pig
&#8230;
CLASSPATH=Foo:/Users/harshchouraria/Work/installs/pig/conf:/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/lib/tools.jar
&#8230;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Disable toggle:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;export PIG_USER_CLASSPATH_FIRST=&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bash -x bin/pig
&#8230;
CLASSPATH=/Users/harshchouraria/Work/installs/pig/conf:/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/lib/tools.jar:Foo
&#8230;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Unset toggle:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;unset PIG_USER_CLASSPATH_FIRST&lt;/tt&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bash -x bin/pig
&#8230;
CLASSPATH=/Users/harshchouraria/Work/installs/pig/conf:/&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/lib/tools.jar:Foo
&#8230;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13614934" author="prkommireddi" created="Wed, 27 Mar 2013 05:02:27 +0000"  >&lt;blockquote&gt;
&lt;p&gt;IIRC the reason was to not have them step over the shipped library jars unintentionally with a simple HADOOP_CLASSPATH being set&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Based on that, I feel like keeping it simple and not having a toggle is better for following reasons:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Pig does not have a env file like hadoop does for specifying CLASSPATH. Most likely this would be set by the user, would be intentional and not be picked up from any of pig&apos;s env files.&lt;/li&gt;
	&lt;li&gt;Having a toggle for this seems like an additional step towards the same purpose.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;What do you think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qwertymaniac&quot; class=&quot;user-hover&quot; rel=&quot;qwertymaniac&quot;&gt;Harsh J&lt;/a&gt;? It would be nice to have some others weight in on this. I am leaning more towards your initial patch, though I am not opposed to the latest patch either.&lt;/p&gt;</comment>
                            <comment id="13614964" author="qwertymaniac" created="Wed, 27 Mar 2013 05:55:26 +0000"  >&lt;p&gt;I agree on both points from my own experience, but others have probably seen even more users than I.&lt;/p&gt;

&lt;p&gt;I&apos;m not so very active on the user lists either, but have been a long time subscriber and searching shows PIG_CLASSPATH&apos;s only ever used for UDF and library additives, and hence the other intention&apos;s users (i.e. those who want to override what Pig auto discovers) wouldn&apos;t mind this behavior change either. Of course, this data set does not represent all of the users &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13620644" author="prkommireddi" created="Wed, 3 Apr 2013 06:43:38 +0100"  >&lt;p&gt;Hey guys, can we have more people weigh in on this JIRA. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qwertymaniac&quot; class=&quot;user-hover&quot; rel=&quot;qwertymaniac&quot;&gt;Harsh J&lt;/a&gt; has a couple of patch&apos; uploaded and it would be good to see what approach makes more sense.&lt;/p&gt;</comment>
                            <comment id="13621155" author="knoguchi" created="Wed, 3 Apr 2013 19:34:52 +0100"  >&lt;p&gt;I prefer with PIG_USER_CLASSPATH_FIRST.  I&apos;ve seen too many random users including old pig jar in their custom UDFs...&lt;/p&gt;

&lt;p&gt;In our environment, we perform QE on set of frameworks. (hadoop, pig, oozie, etc)&lt;br/&gt;
And we tell our users, whenever they set HADOOP_USER_CLASSPATH_FIRST they are running outside of the QA-ed environment.  I want the same to apply within pig with PIG_USER_CLASSPATH_FIRST.&lt;/p&gt;
</comment>
                            <comment id="13621739" author="qwertymaniac" created="Thu, 4 Apr 2013 05:02:07 +0100"  >&lt;p&gt;Thanks for the comment from experience Koji! I think we can use the most latest patch then, if it looks good &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Re: Docs, I didn&apos;t find PIG_CLASSPATH documented anywhere and wasn&apos;t sure which doc page to add it to either, but if someone has a clue I&apos;ll doc both PIG_CLASSPATH and this on the pointed page and update the patch.&lt;/p&gt;</comment>
                            <comment id="13621742" author="prkommireddi" created="Thu, 4 Apr 2013 05:09:07 +0100"  >&lt;p&gt;Thanks Koji, that&apos;s a good explanation for needing PIG_USER_CLASSPATH_FIRST.&lt;/p&gt;

&lt;p&gt;Harsh, you can find reference to PIG_CLASSPATH here &lt;a href=&quot;http://pig.apache.org/docs/r0.11.1/start.html#Running+the+Pig+Scripts+in+Mapreduce+Mode&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://pig.apache.org/docs/r0.11.1/start.html#Running+the+Pig+Scripts+in+Mapreduce+Mode&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think you can add a note there (suggesting its optional) regarding PIG_USER_CLASSPATH_FIRST.&lt;/p&gt;</comment>
                            <comment id="13621839" author="qwertymaniac" created="Thu, 4 Apr 2013 06:59:50 +0100"  >&lt;p&gt;Thanks, here&apos;s docs added along where pointed. It also explains PIG_CLASSPATH&apos;s other uses.&lt;/p&gt;</comment>
                            <comment id="13621844" author="qwertymaniac" created="Thu, 4 Apr 2013 07:03:26 +0100"  >&lt;p&gt;Missed moving the list element tag, which I&apos;ve fixed in this patch.&lt;/p&gt;</comment>
                            <comment id="13623236" author="prkommireddi" created="Fri, 5 Apr 2013 02:20:05 +0100"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=qwertymaniac&quot; class=&quot;user-hover&quot; rel=&quot;qwertymaniac&quot;&gt;Harsh J&lt;/a&gt;, thanks for updating the patch. Documentation looks good, I tested by building the same. &lt;/p&gt;

&lt;p&gt;Minor nitpick, I would prefer nested-if in this case as &quot;$PIG_CLASSPATH&quot; is tested twice. But that&apos;s probably just me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; [ &lt;span class=&quot;code-quote&quot;&gt;&quot;$PIG_CLASSPATH&quot;&lt;/span&gt; != &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot; ] &amp;amp;&amp;amp; [ &quot;&lt;/span&gt;$PIG_USER_CLASSPATH_FIRST&lt;span class=&quot;code-quote&quot;&gt;&quot; == &quot;&lt;/span&gt;&quot; ]; then
    CLASSPATH=${CLASSPATH}:${PIG_CLASSPATH}
elif [ &lt;span class=&quot;code-quote&quot;&gt;&quot;$PIG_CLASSPATH&quot;&lt;/span&gt; != &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot; ] &amp;amp;&amp;amp; [ &quot;&lt;/span&gt;$PIG_USER_CLASSPATH_FIRST&lt;span class=&quot;code-quote&quot;&gt;&quot; != &quot;&lt;/span&gt;&quot; ]; then
    CLASSPATH=${PIG_CLASSPATH}:${CLASSPATH}
fi
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Otherwise, +1 (non-binding)&lt;/p&gt;</comment>
                            <comment id="13624381" author="qwertymaniac" created="Sat, 6 Apr 2013 10:37:50 +0100"  >&lt;p&gt;Certainly and anything for you!&lt;/p&gt;

&lt;p&gt;That&apos;d look better too; so done.&lt;/p&gt;

&lt;p&gt;Thanks for the reviews and comments &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13624760" author="daijy" created="Sun, 7 Apr 2013 07:59:20 +0100"  >&lt;p&gt;Patch committed to trunk. Thanks Harsh!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12577365" name="PIG-3261.patch" size="2340" author="qwertymaniac" created="Sat, 6 Apr 2013 10:37:50 +0100"/>
                            <attachment id="12576933" name="PIG-3261.patch" size="2434" author="qwertymaniac" created="Thu, 4 Apr 2013 07:03:26 +0100"/>
                            <attachment id="12576931" name="PIG-3261.patch" size="2225" author="qwertymaniac" created="Thu, 4 Apr 2013 06:59:50 +0100"/>
                            <attachment id="12575652" name="PIG-3261.patch" size="1305" author="qwertymaniac" created="Wed, 27 Mar 2013 04:31:16 +0000"/>
                            <attachment id="12575450" name="PIG-3261.patch" size="295" author="qwertymaniac" created="Tue, 26 Mar 2013 01:48:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 26 Mar 2013 06:29:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319494</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzcz6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319835</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>