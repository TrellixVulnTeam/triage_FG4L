<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:55:58 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1827/PIG-1827.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1827] When passing a parameter to Pig, if the value contains $ it has to be escaped for no apparent reason</title>
                <link>https://issues.apache.org/jira/browse/PIG-1827</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description></description>
                <environment></environment>
        <key id="12496871">PIG-1827</key>
            <summary>When passing a parameter to Pig, if the value contains $ it has to be escaped for no apparent reason</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rding">Richard Ding</assignee>
                                    <reporter username="julienledem">Julien Le Dem</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Jan 2011 21:53:40 +0000</created>
                <updated>Thu, 4 Aug 2011 01:34:57 +0100</updated>
                            <resolved>Fri, 13 May 2011 18:24:22 +0100</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.9.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13012717" author="rding" created="Tue, 29 Mar 2011 22:34:16 +0100"  >&lt;p&gt;The reason that one has to escape $ in this case is that Pig, by design, allows recursive parameter substitution. That is, a parameter value can contain another parameter key (prefixed by $). So if the value contains literal $, it must be escaped. &lt;/p&gt;</comment>
                            <comment id="13023034" author="rding" created="Fri, 22 Apr 2011 00:37:36 +0100"  >&lt;p&gt;Looked into it a little more. Actually, embedded Pig just use parameter substitution to perform parameter binding and it doesn&apos;t support recursive substitution. So it should be ok to remove the requirement that $ in parameter be escaped.&lt;/p&gt;</comment>
                            <comment id="13023409" author="rding" created="Fri, 22 Apr 2011 22:04:40 +0100"  >&lt;p&gt;Test-patch results:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     [exec] +1 overall.  
     [exec] 
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec] 
     [exec]     +1 tests included.  The patch appears to include 3 &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; or modified tests.
     [exec] 
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec] 
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec] 
     [exec]     +1 findbugs.  The patch does not introduce any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Findbugs warnings.
     [exec] 
     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13024833" author="rding" created="Mon, 25 Apr 2011 17:41:41 +0100"  >&lt;p&gt;Unit tests pass.&lt;/p&gt;</comment>
                            <comment id="13024970" author="julienledem" created="Mon, 25 Apr 2011 22:35:29 +0100"  >&lt;p&gt;Hi Richard,&lt;br/&gt;
thanks for taking care of this.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;in test/org/apache/pig/test/TestScriptLanguage.java&lt;br/&gt;
the test should verify that the value are properly passed to the script
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;testvar = &apos;abcd$py&apos;&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;testvar2 = &apos;$&apos;&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;testvar3 = &apos;\\\\\\\\$&apos;&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;testvar4 = &apos;abcd\\$py$&apos;&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;testvar5 = &apos;abcd\\$py&apos;&quot;&lt;/span&gt;,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;what about this?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;P = Pig.compile(\&quot;&lt;/span&gt;\&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt;a = load &apos;$input&apos;; b = foreach a generate $0,$1,$testvar,$testvar2,$testvar3,$testvar4,$testvar5; store b into &apos;$output&apos;;\&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt;\&lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;, 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;then you can check that you get the values in the output.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;we should check that the transformation is bijective.&lt;/p&gt;</comment>
                            <comment id="13025527" author="rding" created="Wed, 27 Apr 2011 01:26:19 +0100"  >&lt;p&gt;The new patch added a test case that supports $ as part of parameter:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
separator = &apos;$&apos;
P = Pig.compile(\&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt;\&lt;span class=&quot;code-quote&quot;&gt;&quot;a = load &apos;input&apos; using PigStorage(&apos;$separator&apos;);store a into &apos;output&apos;;\&quot;&lt;/span&gt;\&lt;span class=&quot;code-quote&quot;&gt;&quot;\&quot;&lt;/span&gt;)
Q = P.bind()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the other hand, Pig Latin doesn&apos;t support &apos;\$&apos; in its variables, string literals. &lt;/p&gt;</comment>
                            <comment id="13030838" author="julienledem" created="Mon, 9 May 2011 19:13:31 +0100"  >&lt;p&gt;right.&lt;br/&gt;
Please add a unit test to verify that fixNonEscapedDollarSign returns what we expect.&lt;/p&gt;</comment>
                            <comment id="13030848" author="julienledem" created="Mon, 9 May 2011 19:34:38 +0100"  >&lt;p&gt;After discussing with Richard and looking into the code of PreprocessorContext&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/pig/trunk/src/org/apache/pig/tools/parameters/PreprocessorContext.java?view=markup&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/pig/trunk/src/org/apache/pig/tools/parameters/PreprocessorContext.java?view=markup&lt;/a&gt;&lt;br/&gt;
There seems to be a bug here:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
235 	&lt;span class=&quot;code-comment&quot;&gt;//&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; litVal = Matcher.quoteReplacement(val);
&lt;/span&gt;236 	replaced_line = replaced_line.replaceFirst(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\$&quot;&lt;/span&gt;+key, val); 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the replacement (2nd) parameter of replaceFirst is not a plain string, it can contain references to the matched pattern like &quot;$0&quot; so $ in val must be escaped.&lt;br/&gt;
Does someone know why line 235 is commented out ?&lt;/p&gt;</comment>
                            <comment id="13030971" author="rding" created="Tue, 10 May 2011 01:33:23 +0100"  >&lt;p&gt;We should limit this jira to fix the issue in embedded Pig (i.e. workaround the general parameter substitution) and visit parameter substitution parser and related code in a separate jira.&lt;/p&gt;</comment>
                            <comment id="13030972" author="rding" created="Tue, 10 May 2011 01:34:38 +0100"  >&lt;p&gt;New patch added a unit test case as suggested.&lt;/p&gt;</comment>
                            <comment id="13032870" author="daijy" created="Fri, 13 May 2011 08:35:13 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13033141" author="rding" created="Fri, 13 May 2011 18:24:22 +0100"  >&lt;p&gt;Patch committed to trunk and 0.9 branch.&lt;/p&gt;</comment>
                            <comment id="13033285" author="julienledem" created="Fri, 13 May 2011 21:58:46 +0100"  >&lt;p&gt;I created &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2074&quot; title=&quot;When passing a parameter to Pig, if the value contains $ it has to be escaped because of a bug in PrecprocessorContext&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2074&quot;&gt;&lt;del&gt;PIG-2074&lt;/del&gt;&lt;/a&gt; to discuss the PreprocessorContext&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12496615">PIG-1819</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12477057" name="PIG-1827-1.patch" size="2733" author="rding" created="Fri, 22 Apr 2011 00:50:49 +0100"/>
                            <attachment id="12477461" name="PIG-1827_2.patch" size="5379" author="rding" created="Wed, 27 Apr 2011 01:26:19 +0100"/>
                            <attachment id="12478659" name="PIG-1827_3.patch" size="6395" author="rding" created="Tue, 10 May 2011 01:33:23 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 29 Mar 2011 21:34:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66195</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyatz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97167</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>