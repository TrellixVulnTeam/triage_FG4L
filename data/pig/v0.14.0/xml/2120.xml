<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:07:00 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2120/PIG-2120.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2120] UDFContext.getClientSystemProps() does not respect pig.properties</title>
                <link>https://issues.apache.org/jira/browse/PIG-2120</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;HBaseStorage is supposed to allow changing the default Caster via the pig.hbase.caster property. This does not work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12510107">PIG-2120</key>
            <summary>UDFContext.getClientSystemProps() does not respect pig.properties</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dvryaboy">Dmitriy V. Ryaboy</assignee>
                                    <reporter username="dvryaboy">Dmitriy V. Ryaboy</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 Jun 2011 17:07:30 +0100</created>
                <updated>Mon, 23 Jan 2012 07:31:22 +0000</updated>
                            <resolved>Mon, 20 Jun 2011 21:28:34 +0100</resolved>
                                    <version>0.8.0</version>
                    <version>0.8.1</version>
                    <version>0.9.0</version>
                    <version>0.10.0</version>
                                    <fixVersion>0.9.2</fixVersion>
                    <fixVersion>0.10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13048650" author="dvryaboy" created="Mon, 13 Jun 2011 17:55:49 +0100"  >&lt;p&gt;While fixing this, I discovered a bigger problem that&apos;s not HBaseStorage specific &amp;#8211; UDFContext.getUDFContext().getClientSystemProps() does NOT respect properties set in pig.properties.&lt;/p&gt;

&lt;p&gt;The attached patch fixes both issues.&lt;/p&gt;

&lt;p&gt;Tested manually, not sure how to write a proper unit test for this..&lt;/p&gt;</comment>
                            <comment id="13048686" author="alangates" created="Mon, 13 Jun 2011 19:13:24 +0100"  >&lt;p&gt;The UDFContext.setClientSystemProps() should just be changed to setClientSystemProps(Properties), rather than a second method added.  If it&apos;s left in there and called with no Properties it would override the properties from the file, causing confusion for the users.  This is not a public part of the API (specifically called out in the comments), so we are free to change it.&lt;/p&gt;

&lt;p&gt;You could write an automated test to make sure that properties passed in pig.properties and on the command line still make it to the backend via UDFContext.  This is an important thing to get right.&lt;/p&gt;</comment>
                            <comment id="13049313" author="dvryaboy" created="Tue, 14 Jun 2011 19:01:18 +0100"  >&lt;p&gt;I&apos;d have to shell out or something for that test &amp;#8211; the change is in Main.java...&lt;/p&gt;

&lt;p&gt;Which probably points out yet another bug. Is it just me or do we need to set UDFContext clientSystemProps in PigServer? Something like &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

Index: src/org/apache/pig/PigServer.java
===================================================================
--- src/org/apache/pig/PigServer.java	(revision 1135694)
+++ src/org/apache/pig/PigServer.java	(working copy)
@@ -1632,6 +1632,8 @@
          */
         &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void parseQuery() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; FrontendException {
             UDFContext.getUDFContext().reset();
+            UDFContext.getUDFContext().setClientSystemProps(pigContext.getProperties());
+
             &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; query = buildQuery();
 
             &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( query.isEmpty() ) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13051742" author="dvryaboy" created="Sun, 19 Jun 2011 23:52:41 +0100"  >&lt;p&gt;Patch attached.&lt;br/&gt;
Switched the UDFContext tests to local mode while I was in there.&lt;/p&gt;</comment>
                            <comment id="13052121" author="alangates" created="Mon, 20 Jun 2011 19:14:42 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13052202" author="dvryaboy" created="Mon, 20 Jun 2011 21:24:44 +0100"  >&lt;p&gt;Changing bug title to more accurately reflect the nature of the change&lt;/p&gt;</comment>
                            <comment id="13052204" author="dvryaboy" created="Mon, 20 Jun 2011 21:28:34 +0100"  >&lt;p&gt;Fixed in trunk.&lt;br/&gt;
Should I apply this to 0.9?&lt;/p&gt;</comment>
                            <comment id="13182822" author="dvryaboy" created="Mon, 9 Jan 2012 21:41:31 +0000"  >&lt;p&gt;Answer to self: yes, you should.&lt;/p&gt;</comment>
                            <comment id="13182847" author="dvryaboy" created="Mon, 9 Jan 2012 22:06:19 +0000"  >&lt;p&gt;Applied to 0.9&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12483101" name="PIG-2120.2.patch" size="5498" author="dvryaboy" created="Sun, 19 Jun 2011 23:52:41 +0100"/>
                            <attachment id="12482352" name="PIG-2120.patch" size="2354" author="dvryaboy" created="Mon, 13 Jun 2011 17:55:49 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 13 Jun 2011 18:13:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41694</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyavof:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97443</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>