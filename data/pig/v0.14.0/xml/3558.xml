<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:05:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3558/PIG-3558.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3558] ORC support for Pig</title>
                <link>https://issues.apache.org/jira/browse/PIG-3558</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Adding LoadFunc and StoreFunc for ORC.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12677170">PIG-3558</key>
            <summary>ORC support for Pig</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daijy">Daniel Dai</assignee>
                                    <reporter username="daijy">Daniel Dai</reporter>
                        <labels>
                            <label>porc</label>
                    </labels>
                <created>Fri, 1 Nov 2013 22:50:03 +0000</created>
                <updated>Fri, 21 Nov 2014 05:59:01 +0000</updated>
                            <resolved>Mon, 21 Jul 2014 05:37:22 +0100</resolved>
                                                    <fixVersion>0.14.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>17</watches>
                                                                <comments>
                            <comment id="13811736" author="daijy" created="Fri, 1 Nov 2013 22:59:36 +0000"  >&lt;p&gt;The patch depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5728&quot; title=&quot;Make ORC InputFormat/OutputFormat usable outside Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5728&quot;&gt;&lt;del&gt;HIVE-5728&lt;/del&gt;&lt;/a&gt;, which provide the InputFormat/OutputFormat Pig needs.&lt;/p&gt;</comment>
                            <comment id="13811752" author="daijy" created="Fri, 1 Nov 2013 23:16:24 +0000"  >&lt;p&gt;Also there is a binary file which cannot be put in patch. Copy &lt;a href=&quot;http://svn.apache.org/viewvc/hive/trunk/ql/src/test/resources/orc-file-11-format.orc?revision=1519868&amp;amp;view=co&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/hive/trunk/ql/src/test/resources/orc-file-11-format.orc?revision=1519868&amp;amp;view=co&lt;/a&gt; to test/org/apache/pig/builtin/orc. &lt;/p&gt;</comment>
                            <comment id="13818519" author="daijy" created="Sun, 10 Nov 2013 19:03:17 +0000"  >&lt;p&gt;Change the patch wrt the changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5728&quot; title=&quot;Make ORC InputFormat/OutputFormat usable outside Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5728&quot;&gt;&lt;del&gt;HIVE-5728&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13819564" author="daijy" created="Mon, 11 Nov 2013 23:04:58 +0000"  >&lt;p&gt;Still make OrcStruct public in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5728&quot; title=&quot;Make ORC InputFormat/OutputFormat usable outside Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5728&quot;&gt;&lt;del&gt;HIVE-5728&lt;/del&gt;&lt;/a&gt;. Updated patch accordingly.&lt;/p&gt;</comment>
                            <comment id="13843632" author="alangates" created="Mon, 9 Dec 2013 22:36:07 +0000"  >&lt;p&gt;+1.&lt;/p&gt;</comment>
                            <comment id="13843747" author="daijy" created="Tue, 10 Dec 2013 00:15:05 +0000"  >&lt;p&gt;Thanks Alan for review!&lt;/p&gt;

&lt;p&gt;Will commit once &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5728&quot; title=&quot;Make ORC InputFormat/OutputFormat usable outside Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5728&quot;&gt;&lt;del&gt;HIVE-5728&lt;/del&gt;&lt;/a&gt; is committed and there is a maven artifacts to build against.&lt;/p&gt;</comment>
                            <comment id="13902218" author="julienledem" created="Sat, 15 Feb 2014 00:58:02 +0000"  >&lt;p&gt;Is hive-exec the fat jar that assembles the runtime dependencies of hive in one jar?&lt;br/&gt;
Could we depend on the individual hive modules that we need instead?&lt;/p&gt;</comment>
                            <comment id="13902277" author="daijy" created="Sat, 15 Feb 2014 02:14:00 +0000"  >&lt;p&gt;Hive does not plan to make a separate jar for ORC unfortunately.&lt;/p&gt;</comment>
                            <comment id="13904574" author="dvryaboy" created="Tue, 18 Feb 2014 20:55:00 +0000"  >&lt;p&gt;I am pro adding ORC support in Pig, but against introducing massive dependencies.&lt;/p&gt;

&lt;p&gt;According to &lt;a href=&quot;http://mvnrepository.com/artifact/org.apache.hive/hive-exec/0.12.0&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mvnrepository.com/artifact/org.apache.hive/hive-exec/0.12.0&lt;/a&gt; the hive-exec jar for 0.12 is 9 megs, and hides within it specific versions of jackson, snappy, org.json, chunks of thrift, hadoop.io (?!), avro, commons, protobuf, and guava. If ORC authors are not interested in improving their dependency hygene, they have to live with the fact that their project is unlikely to get integrated into other projects.&lt;/p&gt;

&lt;p&gt;This is self-inflicted jar hell. Please don&apos;t do this. When ORC cleans up their dependencies, let&apos;s revisit.&lt;/p&gt;</comment>
                            <comment id="13904590" author="dvryaboy" created="Tue, 18 Feb 2014 21:06:17 +0000"  >&lt;p&gt;So that&apos;s a -1.&lt;/p&gt;

&lt;p&gt;I would +1 this if it was going into piggybank.&lt;/p&gt;

&lt;p&gt;Since this depends on unpublished changes, I&apos;d rather we unlink it from 0.13 release (as that would tie us to Hive&apos;s release schedule &amp;#8211; obviously we can&apos;t make a release that depends on a snapshot).&lt;/p&gt;</comment>
                            <comment id="13904598" author="daijy" created="Tue, 18 Feb 2014 21:10:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dvryaboy&quot; class=&quot;user-hover&quot; rel=&quot;dvryaboy&quot;&gt;Dmitriy V. Ryaboy&lt;/a&gt;, this is only compile time dependency. We don&apos;t need to ship hive-exec.jar in distribution. We already have hive-exec.jar compile time dependency in Pig, only need to upgrade version. Agree it is desired for Hive to clean up dependencies, but it will be hard to make it happen in a short time.&lt;/p&gt;</comment>
                            <comment id="13904600" author="daijy" created="Tue, 18 Feb 2014 21:11:13 +0000"  >&lt;p&gt;I am fine to unlink from 0.13 release though.&lt;/p&gt;</comment>
                            <comment id="13904627" author="dvryaboy" created="Tue, 18 Feb 2014 21:25:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt; not quite:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-      conf=&lt;span class=&quot;code-quote&quot;&gt;&quot;test-&amp;gt;master&quot;&lt;/span&gt; /&amp;gt;
+      conf=&lt;span class=&quot;code-quote&quot;&gt;&quot;compile-&amp;gt;master&quot;&lt;/span&gt; /&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13904641" author="daijy" created="Tue, 18 Feb 2014 21:40:30 +0000"  >&lt;p&gt;This is actually a downgrade. test dependency implies compile dependency.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;conf name=&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;compile&quot;&lt;/span&gt; visibility=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13904663" author="dvryaboy" created="Tue, 18 Feb 2014 21:54:24 +0000"  >&lt;p&gt;Help me understand this. My understanding is as follows: &lt;/p&gt;

&lt;p&gt;Compile is minimum required to compile main code. Test is minimum required to compile main code + stuff needed to test (hence, &quot;extends&quot;). Pushing a dependency up to compile means everything, not just test, needs the dependency. &lt;/p&gt;

&lt;p&gt;Also, the bump from 0.8 to 0.12 is 6 megs worth of code. That&apos;s a pretty big version bump.&lt;/p&gt;</comment>
                            <comment id="13904684" author="daijy" created="Tue, 18 Feb 2014 22:12:07 +0000"  >&lt;p&gt;Please ignore my previous comment. It is actually an upgrade not downgrade. Sorry for the confusion.&lt;/p&gt;</comment>
                            <comment id="13905824" author="daijy" created="Wed, 19 Feb 2014 18:36:13 +0000"  >&lt;p&gt;It is possible &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-860&quot; title=&quot;Persistent distributed cache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-860&quot;&gt;HIVE-860&lt;/a&gt; will clean up the hive-exec.jar. It might strip away guava/thrift etc from hive-exec.jar.&lt;/p&gt;</comment>
                            <comment id="13964465" author="chitnis" created="Wed, 9 Apr 2014 18:55:07 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt; When I run the unit tests in TestOrcStorage, they fail with NPE at OrcUtils.java:69&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; convertOrcToPig(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; obj, ObjectInspector oi, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;[] includedColumns) {
        &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; result;
69        &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (oi.getCategory()) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;because the ObjectInspector oi which should have been initialized in OrcStorage.setLocation() is still null.&lt;br/&gt;
Do you have an updated patch for passing unit tests?&lt;/p&gt;</comment>
                            <comment id="13965013" author="daijy" created="Thu, 10 Apr 2014 06:22:38 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chitnis&quot; class=&quot;user-hover&quot; rel=&quot;chitnis&quot;&gt;Mona Chitnis&lt;/a&gt;, the test failures are introduced by hdfs direct fetch &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3642&quot; title=&quot;Direct HDFS access for small jobs (fetch) &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3642&quot;&gt;&lt;del&gt;PIG-3642&lt;/del&gt;&lt;/a&gt;. I updated the patch to disable direct fetch in tests, and will open a Jira to fix hdfs direct access for Orc. The patch also reflect several bug fixes recently.&lt;/p&gt;</comment>
                            <comment id="13966108" author="chitnis" created="Fri, 11 Apr 2014 02:18:16 +0100"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt;. Some tests pass now and will continue testing this on my setup&lt;/p&gt;</comment>
                            <comment id="13968236" author="lbendig" created="Mon, 14 Apr 2014 12:04:56 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chitnis&quot; class=&quot;user-hover&quot; rel=&quot;chitnis&quot;&gt;Mona Chitnis&lt;/a&gt;, thanks for pointing out the issue with direct fetch. I filed a patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3888&quot; title=&quot;Direct fetch doesn&amp;#39;t differentiate between frontend and backend sides&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3888&quot;&gt;&lt;del&gt;PIG-3888&lt;/del&gt;&lt;/a&gt;) that fixes it, so you may re-enable fetch in TestOrcStorage#setup(). &lt;/p&gt;</comment>
                            <comment id="13968712" author="daijy" created="Mon, 14 Apr 2014 20:26:12 +0100"  >&lt;p&gt;That works, thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lbendig&quot; class=&quot;user-hover&quot; rel=&quot;lbendig&quot;&gt;Lorand Bendig&lt;/a&gt; for a quick fix. Remove the code for disabling &quot;opt.fetch&quot; in test.&lt;/p&gt;</comment>
                            <comment id="13986811" author="chitnis" created="Thu, 1 May 2014 18:49:58 +0100"  >&lt;p&gt;If Hive type Binary is equated to Pig&apos;s bytearray&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; getPrimaryFromOrc(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; obj, PrimitiveObjectInspector poi) {
        &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; result;
        &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (poi.getPrimitiveCategory()) {
        . . .
        &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; BINARY:
            result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DataByteArray(((BytesWritable) obj).copyBytes());
            &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is there a reason we cannot typecast it back to Binary during a store back to Orc? I can make it work by explicitly casting that column to int but I&apos;d like to confirm it doesnt violate any Hive metadata serialization.&lt;/p&gt;</comment>
                            <comment id="13987469" author="daijy" created="Fri, 2 May 2014 08:34:19 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chitnis&quot; class=&quot;user-hover&quot; rel=&quot;chitnis&quot;&gt;Mona Chitnis&lt;/a&gt; Not sure if I understand correctly. Hive BINARY has clear meaning, but Pig bytearray is not. It means unknown datatype where user does not explicitly declare the datatype. The real data can be anything not just DataByteArray. So it should be safe to convert Hive BINARY to Pig bytearray but not vice versa.&lt;/p&gt;</comment>
                            <comment id="13990285" author="chitnis" created="Tue, 6 May 2014 06:08:06 +0100"  >&lt;p&gt;Okay. Then when storing back into OrcStorage, we&apos;d have to do explicit cast on the column either at load or later.&lt;/p&gt;</comment>
                            <comment id="13990888" author="rohini" created="Tue, 6 May 2014 18:54:38 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt;,&lt;br/&gt;
   We should allow storing bytearray as binary in ORC if user has not done a explicit cast. Even in AvroStorage pig bytearray is translated to avro Type.BYTES and stored and we don&apos;t throw an error. I don&apos;t see hive binary being any different than pig bytearray(&lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Binary+DataType+Proposal&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/Binary+DataType+Proposal&lt;/a&gt; - Sometimes, user is just interested in few of those columns and doesn&apos;t want to bother about exact type information for rest of columns. In such cases, he may just declare the types of those columns as binary and Hive will not try to interpret those columns.)&lt;/p&gt;

&lt;p&gt;On a different note, can we have the class renamed to ORCStorage instead of OrcStorage as ORC is abbreviation of Optimized Row Columnar?&lt;/p&gt;</comment>
                            <comment id="13990889" author="rohini" created="Tue, 6 May 2014 18:57:03 +0100"  >&lt;blockquote&gt;&lt;p&gt;Okay. Then when storing back into OrcStorage, we&apos;d have to do explicit cast on the column either at load or later.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;  We should not be trying to cast into anything. The cast should be explicit from user.&lt;/p&gt;</comment>
                            <comment id="13991488" author="chitnis" created="Wed, 7 May 2014 03:29:33 +0100"  >&lt;p&gt;yes I meant user. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rohini&quot; class=&quot;user-hover&quot; rel=&quot;rohini&quot;&gt;Rohini Palaniswamy&lt;/a&gt; for storing the bytearray as binary in ORC, we need to add an ObjectInspector subclass similar to how JodaTimeObjectInspector or PigDecimalObjectInspector is handling the serde API. its minor and I can include it in my patch for tests.&lt;/p&gt;</comment>
                            <comment id="13996845" author="daijy" created="Tue, 13 May 2014 21:14:20 +0100"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t see hive binary being any different than pig bytearray&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Technically it is different. Pig bytearray means unknown data type. Consider the following script &amp;amp; UDF:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class MapGenerate &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; EvalFunc&amp;lt;Map&amp;gt; {
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Map exec(Tuple input) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        &lt;span class=&quot;code-comment&quot;&gt;// TODO Auto-generated method stub
&lt;/span&gt;        Map m = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap();
        m.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;(input.size()));
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; m;
    }
    
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Schema outputSchema(Schema input) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema.FieldSchema(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, DataType.MAP));
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a = load &apos;1.txt&apos; as (a0);
b = foreach a generate a0, MapGenerate(*) as m:map[];
c = group c by key;
dump c;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The group key will be of data type bytearray (since it is unknown), and the map key is NullableBytesWritable. NullableBytesWritable takes any Object instead of just DataByteArray to accommodate this case.&lt;/p&gt;

&lt;p&gt;It is possible we map Pig bytearray to binary, but must deal with the fact that the data may not be DataByteArray.&lt;/p&gt;</comment>
                            <comment id="13996986" author="rohini" created="Tue, 13 May 2014 23:28:13 +0100"  >&lt;p&gt;In that case can we allow Pig bytearray to binary, but throw error on runtime if it was not DataByteArray but some other object?&lt;/p&gt;</comment>
                            <comment id="13999169" author="daijy" created="Thu, 15 May 2014 20:53:19 +0100"  >&lt;p&gt;You can, the key point here is bytearray is not equal to binary. Instead of a semantic check like other datatype does, a runtime check is required for bytearray. &lt;/p&gt;</comment>
                            <comment id="14066987" author="daijy" created="Fri, 18 Jul 2014 23:19:41 +0100"  >&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-7423&quot; title=&quot;produce hive-exec-core.jar from ql module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-7423&quot;&gt;&lt;del&gt;HIVE-7423&lt;/del&gt;&lt;/a&gt;, we don&apos;t need to pull uber hive-exec.jar. Reattach the patch with this change.&lt;/p&gt;</comment>
                            <comment id="14067289" author="dvryaboy" created="Sat, 19 Jul 2014 01:33:54 +0100"  >&lt;p&gt;Nice.&lt;/p&gt;

&lt;p&gt;How much does this increase the weight of the pig build, and what packages does it pull in?&lt;/p&gt;

&lt;p&gt;I assume this won&apos;t get pushed to trunk until hive 0.14.0-SNAPSHOT becomes available as a stable version?&lt;/p&gt;</comment>
                            <comment id="14067407" author="daijy" created="Sat, 19 Jul 2014 07:27:19 +0100"  >&lt;p&gt;There will be 3 compile test dependency: hive-exec-core.jar, hive-common.jar, hive-serde.jar. Non of these will be packed into pig-withouthadoop.jar.&lt;/p&gt;

&lt;p&gt;We will not release Pig 0.14 with a snapshot dependency. But I&apos;d like to commit the patch to trunk sooner to facilitate follow up development.&lt;/p&gt;</comment>
                            <comment id="14068089" author="rohini" created="Mon, 21 Jul 2014 01:39:44 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14068191" author="daijy" created="Mon, 21 Jul 2014 05:37:22 +0100"  >&lt;p&gt;Patch committed to trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12727524">HIVE-7423</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12677124">HIVE-5728</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12611706" name="PIG-3558-1.patch" size="53998" author="daijy" created="Fri, 1 Nov 2013 22:56:21 +0000"/>
                            <attachment id="12613057" name="PIG-3558-2.patch" size="66061" author="daijy" created="Sun, 10 Nov 2013 19:03:17 +0000"/>
                            <attachment id="12613256" name="PIG-3558-3.patch" size="65823" author="daijy" created="Mon, 11 Nov 2013 23:04:58 +0000"/>
                            <attachment id="12639537" name="PIG-3558-4.patch" size="65688" author="daijy" created="Thu, 10 Apr 2014 06:22:38 +0100"/>
                            <attachment id="12640125" name="PIG-3558-5.patch" size="65587" author="daijy" created="Mon, 14 Apr 2014 20:26:12 +0100"/>
                            <attachment id="12656711" name="PIG-3558-6.patch" size="67587" author="daijy" created="Sat, 19 Jul 2014 08:01:27 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 9 Dec 2013 22:36:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356545</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzjb6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>356833</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>