<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:04:45 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-4064/PIG-4064.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-4064] Fix tez auto parallelism test failures</title>
                <link>https://issues.apache.org/jira/browse/PIG-4064</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Tests that hang:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;TestLimitVariable.testLimitVariable2&lt;/li&gt;
	&lt;li&gt;TestEvalPipeline2.testLocalRearrangeInReducer&lt;/li&gt;
	&lt;li&gt;TestEvalPipeline2.testLimitAutoReducer&lt;/li&gt;
	&lt;li&gt;TestEvalPipeline2.testForEachSameOriginColumn1&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Tests that fail:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;TestEvalPipeline2.testEmptySort (Divide by zero error)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12728661">PIG-4064</key>
            <summary>Fix tez auto parallelism test failures</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12704072">PIG-3840</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daijy">Daniel Dai</assignee>
                                    <reporter username="rohini">Rohini Palaniswamy</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Jul 2014 20:22:33 +0100</created>
                <updated>Fri, 21 Nov 2014 05:59:20 +0000</updated>
                            <resolved>Sat, 26 Jul 2014 19:03:50 +0100</resolved>
                                                    <fixVersion>0.14.0</fixVersion>
                                    <component>tez</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="14072628" author="daijy" created="Thu, 24 Jul 2014 01:30:24 +0100"  >&lt;p&gt;Seems some tests do not hang, I see exception instead.&lt;/p&gt;

&lt;p&gt;The patch fixes:&lt;br/&gt;
TestLimitVariable.testLimitVariable2: DataMovementType of all edges of the sort vertex is set to custom and wait for VertexManager to set it. However, this should only goes to the edge between partition vertex and sort vertex. The scalar edge should not be involved&lt;/p&gt;

&lt;p&gt;TestEvalPipeline2.testLocalRearrangeInReducer: SecondaryOptimizer does not handle two predecessors. When we process the first predecessor, we remove the foreach inner operators from the reduce side, and the second predecessor cannot see them&lt;/p&gt;

&lt;p&gt;TestEvalPipeline2.testLimitAutoReducer: the parallelism of sort vertex is set too high in TEZ (7). Reduce it to 2 fix the issue&lt;/p&gt;

&lt;p&gt;TestEvalPipeline2.testEmptySort: Fixed 0 quantile issue in FindQuantiles&lt;/p&gt;

&lt;p&gt;TestEvalPipeline2.testForEachSameOriginColumn1 seems to pass for me&lt;/p&gt;

&lt;p&gt;TestEvalPipeline2.testOrderByLimitJoin should be skipped for &lt;a href=&quot;https://issues.apache.org/jira/browse/TEZ-1257&quot; title=&quot;Error on empty partition when using OnFileUnorderedKVOutput and ShuffledMergedInput&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TEZ-1257&quot;&gt;&lt;del&gt;TEZ-1257&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14072753" author="rohini" created="Thu, 24 Jul 2014 04:40:29 +0100"  >&lt;p&gt;Looks good. Can you clarify a doubt though. TestEvalPipeline2.testLimitAutoReducer - Why for the same reducer bytes, the parallelism produced by MR and Tez is very different? What is the differentiating behavior?&lt;/p&gt;

&lt;p&gt;Also can you create a separate jira to fix secondary sort optimizer to support multiple predecessors. &lt;/p&gt;

&lt;p&gt;Could you also remove the below comments which are not valid anymore when checking in. &lt;br/&gt;
// MR SecondaryKeyOptimizer currently does not check for this case.  (Prashant fixed MR in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3827&quot; title=&quot;Custom partitioner is not picked up with secondary sort optimization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3827&quot;&gt;&lt;del&gt;PIG-3827&lt;/del&gt;&lt;/a&gt;)&lt;br/&gt;
//Let&apos;s add  combiner if possible.  (Copied over wrongly i believe)&lt;br/&gt;
//TODO: Case of from plan leaf being POUnion. (Don&apos;t think we have POUnion in Tez plan at all)&lt;/p&gt;</comment>
                            <comment id="14073834" author="daijy" created="Fri, 25 Jul 2014 00:27:49 +0100"  >&lt;p&gt;Attach patch with comment changes &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rohini&quot; class=&quot;user-hover&quot; rel=&quot;rohini&quot;&gt;Rohini Palaniswamy&lt;/a&gt; suggested.&lt;/p&gt;

&lt;p&gt;Created &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4072&quot; title=&quot;secondary sort optimizer to support multiple predecessors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4072&quot;&gt;PIG-4072&lt;/a&gt; for secondary sort optimizer with multiple predecessors.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;TestEvalPipeline2.testLimitAutoReducer - Why for the same reducer bytes, the parallelism produced by MR and Tez is very different? What is the differentiating behavior?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;MR use the bytes on disk and TEZ use bytes in memory. The difference is exaggerated when the data size is tiny.&lt;/p&gt;</comment>
                            <comment id="14073851" author="rohini" created="Fri, 25 Jul 2014 00:44:18 +0100"  >&lt;p&gt;Initially I thought the test was checking number of reducers/ part files. Just saw that it only does limit. So we should fix the actual cause of test hanging when too many tasks in this case instead of changing test case.&lt;/p&gt;</comment>
                            <comment id="14073853" author="daijy" created="Fri, 25 Jul 2014 00:47:49 +0100"  >&lt;p&gt;np, let me dig into that.&lt;/p&gt;</comment>
                            <comment id="14075207" author="daijy" created="Sat, 26 Jul 2014 02:49:19 +0100"  >&lt;p&gt;Take &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bikassaha&quot; class=&quot;user-hover&quot; rel=&quot;bikassaha&quot;&gt;Bikas Saha&lt;/a&gt;&apos;s suggestion to adjust PartitionerDefinedVertexManager. TestEvalPipeline2.testLimitAutoReducer does not hang. It fail to due &lt;a href=&quot;https://issues.apache.org/jira/browse/TEZ-1257&quot; title=&quot;Error on empty partition when using OnFileUnorderedKVOutput and ShuffledMergedInput&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TEZ-1257&quot;&gt;&lt;del&gt;TEZ-1257&lt;/del&gt;&lt;/a&gt; though.&lt;/p&gt;</comment>
                            <comment id="14075245" author="rohini" created="Sat, 26 Jul 2014 04:29:06 +0100"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt;. +1&lt;/p&gt;</comment>
                            <comment id="14075446" author="daijy" created="Sat, 26 Jul 2014 19:03:50 +0100"  >&lt;p&gt;Patch committed to trunk. Thanks Rohini for review!&lt;/p&gt;</comment>
                            <comment id="14075548" author="daijy" created="Sun, 27 Jul 2014 05:47:26 +0100"  >&lt;p&gt;The condition for scalar edge is not right. It is right for order by but not skewed join. Add a patch to fix that. This also remove an unintended change in the original patch.&lt;/p&gt;</comment>
                            <comment id="14075549" author="rohini" created="Sun, 27 Jul 2014 05:49:15 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12729613">PIG-4072</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12657500" name="PIG-4064-1.patch" size="10927" author="daijy" created="Thu, 24 Jul 2014 01:30:24 +0100"/>
                            <attachment id="12657716" name="PIG-4064-2.patch" size="10750" author="daijy" created="Fri, 25 Jul 2014 00:27:49 +0100"/>
                            <attachment id="12657964" name="PIG-4064-3.patch" size="12854" author="daijy" created="Sat, 26 Jul 2014 02:49:19 +0100"/>
                            <attachment id="12658012" name="PIG-4064-addendum.patch" size="1507" author="daijy" created="Sun, 27 Jul 2014 05:47:26 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 24 Jul 2014 00:30:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>406735</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzrul3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>406755</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>