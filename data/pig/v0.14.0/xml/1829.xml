<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:55:56 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1829/PIG-1829.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1829] &quot;0&quot; value seen in PigStat&apos;s map/reduce runtime, even when the job is successful</title>
                <link>https://issues.apache.org/jira/browse/PIG-1829</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Pig runtime calls JobClient.getMapTaskReports(jobId) and JobClient.getReduceTaskReports(jobId) to get statistics about numbers of maps/reducers, as well as max/min/avg time of these tasks. But from time to time, these calls return empty lists. When that happens pig is reports 0 values for the stats. &lt;/p&gt;

&lt;p&gt;The jobtracker keeps the stats information only for a limited duration based on the configuration parameters  mapred.jobtracker.completeuserjobs.maximum and mapred.job.tracker.retiredjobs.cache.size. Since pig collects the stats after jobs have finished running, it is possible that the stats for the initial jobs are no longer available. To have better chances of getting the stats, it should be collected as soon as the job is over. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12496979">PIG-1829</key>
            <summary>&quot;0&quot; value seen in PigStat&apos;s map/reduce runtime, even when the job is successful</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rding">Richard Ding</assignee>
                                    <reporter username="thejas">Thejas M Nair</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Jan 2011 20:48:47 +0000</created>
                <updated>Tue, 20 Dec 2011 19:58:02 +0000</updated>
                            <resolved>Tue, 1 Mar 2011 22:55:49 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12987887" author="sms" created="Fri, 28 Jan 2011 02:16:03 +0000"  >&lt;p&gt;The job is moved from memory to disk. Pig should query the job tracker history to retrieve the job to get the statistics.&lt;/p&gt;</comment>
                            <comment id="12987893" author="olgan" created="Fri, 28 Jan 2011 02:35:39 +0000"  >&lt;p&gt;Job tracker history is not indexed so you can&apos;t really do that without brining name node down.&lt;/p&gt;</comment>
                            <comment id="12988187" author="sms" created="Fri, 28 Jan 2011 19:18:32 +0000"  >&lt;p&gt;There are smart ways to lookup the job tracker history based on the directory structure ensuring that you do not bring the system down. Simultaneously, we can request the MapReduce team to create a hierarchical structure to enable such queries.&lt;/p&gt;</comment>
                            <comment id="12988189" author="olgan" created="Fri, 28 Jan 2011 19:22:53 +0000"  >&lt;p&gt;directory structure is not an official interface and in fact is has changed recently.&lt;/p&gt;</comment>
                            <comment id="12988191" author="sms" created="Fri, 28 Jan 2011 19:27:48 +0000"  >&lt;p&gt;Thats exactly what I state in the second half of my previous comment. We should work with the structure that is in place today and engage with the MapReduce team to standardize the access via APIs and not via directory structures. The directory structure has created problems in the past.&lt;/p&gt;</comment>
                            <comment id="12988203" author="olgan" created="Fri, 28 Jan 2011 19:59:33 +0000"  >&lt;p&gt;I agree that having standard API is useful. I don&apos;t think I like the idea of reading current structure because this will make it difficult to run against concurrent versions of Hadoop.&lt;/p&gt;

&lt;p&gt;I think we need to do further investigation and find other alternatives or just say that this will resolve once we have a reasonable support form Hadoop&lt;/p&gt;</comment>
                            <comment id="12988278" author="sms" created="Fri, 28 Jan 2011 22:20:49 +0000"  >&lt;p&gt;+1 for both - investigate further to check for options to retrieve the job from history and push for standardized access mechanisms.&lt;/p&gt;

&lt;p&gt;For now, can we document this behavior - the only concern I have is around the duration for which JT retains the job in memory. For e.g., if more than half the time we are unable to retrieve statistics, it will be a bit frustrating for the users.&lt;/p&gt;</comment>
                            <comment id="12988300" author="acmurthy" created="Fri, 28 Jan 2011 23:05:49 +0000"  >&lt;p&gt;Reading directly from JobHistory directory is a non-starter - permissions.&lt;/p&gt;

&lt;p&gt;We should investigate standard apis. For now getting stats right after job completion will work pretty much all the time. The JT has a the ability to be stats for completed jobs either from memory or disk for a reasonable amount of time after job-completion.&lt;/p&gt;</comment>
                            <comment id="12988306" author="sms" created="Fri, 28 Jan 2011 23:13:35 +0000"  >&lt;p&gt;A couple of questions:&lt;/p&gt;

&lt;p&gt;What are the bounds on the reasonable amount of time?&lt;br/&gt;
Are there any plans in place to support APIs to access job history?&lt;/p&gt;</comment>
                            <comment id="12988315" author="acmurthy" created="Fri, 28 Jan 2011 23:56:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;What are the bounds on the reasonable amount of time?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The JT has a configured limit on #jobs in memory and disk. So, one can customize it per-installation.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Are there any plans in place to support APIs to access job history?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-1941&quot; title=&quot;Need a servlet in JobTracker to stream contents of the job history file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-1941&quot;&gt;&lt;del&gt;MAPREDUCE-1941&lt;/del&gt;&lt;/a&gt; and Rumen.&lt;/p&gt;</comment>
                            <comment id="12988319" author="sms" created="Sat, 29 Jan 2011 00:04:17 +0000"  >&lt;p&gt;Linking it to &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-1941&quot; title=&quot;Need a servlet in JobTracker to stream contents of the job history file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-1941&quot;&gt;&lt;del&gt;MAPREDUCE-1941&lt;/del&gt;&lt;/a&gt; as per Arun&apos;s reference.&lt;/p&gt;</comment>
                            <comment id="12988320" author="sms" created="Sat, 29 Jan 2011 00:06:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;bq. What are the bounds on the reasonable amount of time?&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;The JT has a configured limit on #jobs in memory and disk. So, one can customize it per-installation.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Any range in practical usage, 1 minute, 5 minutes, 1 hour, etc? It will help to set expectation with the user.&lt;/p&gt;</comment>
                            <comment id="12988324" author="acmurthy" created="Sat, 29 Jan 2011 00:20:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;Any range in practical usage, 1 minute, 5 minutes, 1 hour, etc? It will help to set expectation with the user.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It is number of jobs. Typically it&apos;s 1000, so that last 1k jobs are around to query status.&lt;/p&gt;</comment>
                            <comment id="12988342" author="rding" created="Sat, 29 Jan 2011 00:55:58 +0000"  >&lt;p&gt;Current implementation is to get job stats after each patch of jobs is finished (i.e. jobs that can be ran in parallel). A short-term fix can be to poll the JobControl to get finished job (instead of waiting for completion of all the jobs in the patch). This could reduce the time window between a job is finished and its stats gets queried in cases where the running time of jobs in a patch varies.&lt;/p&gt;</comment>
                            <comment id="12988344" author="acmurthy" created="Sat, 29 Jan 2011 01:01:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;A short-term fix can be to poll the JobControl to get finished job (instead of waiting for completion of all the jobs in the patch). &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1 - this should suffice for a very long time. &lt;b&gt;smile&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="12996174" author="rding" created="Fri, 18 Feb 2011 00:40:55 +0000"  >&lt;p&gt;Implemented the polling of completed jobs before the batch execution completes. &lt;/p&gt;

&lt;p&gt;The output of test-patch:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     [exec] -1 overall.  
     [exec] 
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec] 
     [exec]     -1 tests included.  The patch doesn&apos;t appear to include any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; or modified tests.
     [exec]                         Please justify why no tests are needed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; patch.
     [exec] 
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec] 
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec] 
     [exec]     +1 findbugs.  The patch does not introduce any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Findbugs warnings.
     [exec] 
     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It&apos;s hard to test this with miniCluster. &lt;/p&gt;</comment>
                            <comment id="13001157" author="thejas" created="Tue, 1 Mar 2011 22:37:35 +0000"  >&lt;p&gt;+1 &lt;/p&gt;</comment>
                            <comment id="13001167" author="rding" created="Tue, 1 Mar 2011 22:56:43 +0000"  >&lt;p&gt;Unit tests pass. Patch committed to trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12535139">PIG-2429</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12469257">MAPREDUCE-1941</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12471350" name="PIG-1829.patch" size="6664" author="rding" created="Fri, 18 Feb 2011 00:40:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 28 Jan 2011 02:16:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66345</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyatzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97169</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>