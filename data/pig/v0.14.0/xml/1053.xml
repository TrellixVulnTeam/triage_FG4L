<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:00:05 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1053/PIG-1053.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1053] Consider moving to Hadoop for local mode</title>
                <link>https://issues.apache.org/jira/browse/PIG-1053</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;We need to consider moving Pig to use Hadoop&apos;s local mode instead of its own.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12439118">PIG-1053</key>
            <summary>Consider moving to Hadoop for local mode</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ankit.modi">Ankit Modi</assignee>
                                    <reporter username="alangates">Alan Gates</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Oct 2009 22:05:55 +0000</created>
                <updated>Fri, 14 May 2010 07:45:50 +0100</updated>
                            <resolved>Wed, 18 Nov 2009 19:19:49 +0000</resolved>
                                                    <fixVersion>0.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="12770237" author="alangates" created="Mon, 26 Oct 2009 22:17:48 +0000"  >&lt;p&gt;Currently Pig has its own backend implementation framework that it uses for executing Pig Latin scripts on a single box (as opposed to in a Hadoop cluster), referred to as local mode.  Having a separate implementation has several drawbacks:&lt;/p&gt;

&lt;p&gt;1) It does not offer the same functionality as Hadoop.  A number of things do not work, such as counters, slicers, etc.&lt;br/&gt;
2) UDFs (both eval and load/store functions) are often forced to understand both contexts, and test whether they are working in local or hadoop mode.&lt;br/&gt;
3) Additional code maintenance, as Pig is forced to maintain its own framework.  Going forward, as Pig attempts to leverage more Map Reduce functionality (see for example &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-966&quot; title=&quot;Proposed rework for LoadFunc, StoreFunc, and Slice/r interfaces&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-966&quot;&gt;&lt;del&gt;PIG-966&lt;/del&gt;&lt;/a&gt;) maintaining this separate mode is becoming a larger and larger effort.&lt;br/&gt;
4) It makes debugging harder for users and UDF writers, as the execution environment on a local box differs from that on the production cluster.&lt;/p&gt;

&lt;p&gt;Pig&apos;s local mode has one very serious advantage over Hadoop in local mode.  It is much faster, about 15 times faster.  Hadoop is designed for large data sets and thus is not optimized to handle the start up and tear down involved in small data jobs.&lt;/p&gt;

&lt;p&gt;For debugging of code, this performance factor should not be that big an issue.  Where the performance becomes prohibitive is functionality like ILLUSTRATE.  Taking 30 seconds to give a sample of data running through your script is excessive compared to 2 seconds.&lt;/p&gt;

&lt;p&gt;So, which of these pain points is worse?  Originally we felt the performance was more important.  But as we see many user complaints about the above listed drawbacks and relatively few users using local mode in performance intensive ways, we are wondering if we made that choice correctly.  Please give your feedback one way or another.&lt;/p&gt;</comment>
                            <comment id="12770314" author="zjffdu" created="Tue, 27 Oct 2009 00:38:08 +0000"  >&lt;p&gt;Agree,&lt;/p&gt;

&lt;p&gt;I always use hadoop&apos;s local mode for debug, it is more similar to hadoop&apos;s map reduce mode than pig&apos;s own local mode.&lt;br/&gt;
I agree with you that adding pig&apos;s own local mode will increase the complexity of pig and cost of maintenance.&lt;/p&gt;

&lt;p&gt;I think few people will use pig&apos;s local mode in production, users only use it for debugging. So performance is not a big problem. The similarity to real map reduce mode is more important.&lt;/p&gt;
</comment>
                            <comment id="12770336" author="rangadi" created="Tue, 27 Oct 2009 01:04:23 +0000"  >&lt;p&gt;a big +1.&lt;/p&gt;

&lt;p&gt;It is understandable from PIG developer&apos;s point of view to be annoyed by beginners complaining about run time with toy local inputs. may be clear heads-up in tutorial would reduce those.&lt;/p&gt;</comment>
                            <comment id="12770339" author="dvryaboy" created="Tue, 27 Oct 2009 01:08:52 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Although I do know of one user who only utilized Local Mode.  He didn&apos;t have big data, but found Pig Latin to be the best fit for his particular problem, due to support for nested structures.&lt;/p&gt;</comment>
                            <comment id="12772144" author="alangates" created="Fri, 30 Oct 2009 22:44:58 +0000"  >&lt;p&gt;For testing purposes we could simply change Main to tell PigContext the mode is MapReduce, even when the user selects local mode.  Assuming there are no configuration files in the classpath, this will result in using Hadoop in the local mode.&lt;/p&gt;

&lt;p&gt;However, for a real fix, we need to make sure that when the user says &quot;-x local&quot; Hadoop&apos;s LocalJobRunner and the local file system are chosen even if there are configuration files in the classpath.  I believe this would be accomplished by changing PigContext to in local mode still connect to MR and HDFS, but to do so with an empty Properties object rather than using the one that is passed in.  This would affect connect, init, setJobTrackerLocation, and perhaps other calls.&lt;/p&gt;
</comment>
                            <comment id="12779172" author="ankit.modi" created="Tue, 17 Nov 2009 22:18:26 +0000"  >&lt;p&gt;This patch fails in releaseAudit for two new html files.&lt;/p&gt;</comment>
                            <comment id="12779179" author="ankit.modi" created="Tue, 17 Nov 2009 22:36:50 +0000"  >&lt;p&gt;This patch has an issue with custom comparators ( OrderBy) in Local Mode ( Does not affect MapReduce mode ).&lt;/p&gt;

&lt;p&gt;Details:&lt;br/&gt;
Pig uses custom Comparators by setting OutputKeyComparator to the customComparator.class, and passing the jar path to JVM while starting the task.&lt;br/&gt;
In this new local mode a new JVM is not started. So hadoop does not have the classpath of customComparator and fails.&lt;/p&gt;

&lt;p&gt;A solution for the above problem would be to pass jarpath of customComparator in the &quot;classpath&quot; argument to JVM running pig.&lt;/p&gt;

&lt;p&gt;eg. CustomComparatorUse.pig&lt;br/&gt;
register custom.jar&lt;/p&gt;

&lt;p&gt;A = load &apos;file&apos;;B = order a by * using custompackage.customclass; &amp;#8211; Here hadoop&lt;br/&gt;
&amp;gt;&amp;gt; bails out giving ClassNotFoundException&lt;/p&gt;</comment>
                            <comment id="12779181" author="ankit.modi" created="Tue, 17 Nov 2009 22:45:02 +0000"  >&lt;p&gt;This patch has an issue with custom comparators ( OrderBy) in Local Mode ( Does not affect MapReduce mode ).&lt;/p&gt;

&lt;p&gt;Details:&lt;br/&gt;
Pig uses custom Comparators by setting OutputKeyComparator to the customComparator.class, and passing the jar path to JVM while starting the task.&lt;br/&gt;
In this new local mode a new JVM is not started. So hadoop does not have the classpath of customComparator and fails.&lt;/p&gt;

&lt;p&gt;A solution for the above problem would be to pass jarpath of customComparator in the &quot;classpath&quot; argument to JVM running pig.&lt;/p&gt;

&lt;p&gt;eg.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;CustomComparatorUse.pig&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
register custom.jar
A = load &apos;file&apos;;
B = order A by * using custompackage.customclass; --- Here hadoop bails out giving ClassNotFoundException
store B into &apos;file2&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;JVM Command&lt;br/&gt;
&lt;tt&gt;java -cp pig.jar org.pig.apache.Main -x local CustomComparatorUse.pig # This does not work&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Use this instead&lt;br/&gt;
&lt;tt&gt;java -cp pig.jar:&lt;font color=&quot;red&quot;&gt;custom.jar&lt;/font&gt; org.pig.apache.Main -x local CustomComparatorUse.pig&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="12779243" author="pkamath" created="Wed, 18 Nov 2009 01:30:50 +0000"  >&lt;p&gt;Wondering if we can catch the scenario explained in the previous comment and present and error message to the effect - &quot;custom comparators are not supported in local mode&quot;&lt;/p&gt;</comment>
                            <comment id="12779245" author="olgan" created="Wed, 18 Nov 2009 01:31:02 +0000"  >&lt;p&gt;I will be reviewing this patch&lt;/p&gt;</comment>
                            <comment id="12779248" author="olgan" created="Wed, 18 Nov 2009 01:43:27 +0000"  >&lt;p&gt;A few questions:&lt;/p&gt;

&lt;p&gt;TestMultiQueryLocal.java: I see that some of the calls changed like example below. What is the reason for that?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;PhysicalPlan pp = checkPhysicalPlan(lp, 1, 3, 17);&lt;br/&gt;
+            PhysicalPlan pp = checkPhysicalPlan(lp, 1, 3, 14);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Same question regarding changes in TestForEachNestedPlanLocal.java. My expectation was that things would not change.&lt;/p&gt;

&lt;p&gt;The rest looks good. &lt;/p&gt;</comment>
                            <comment id="12779249" author="hadoopqa" created="Wed, 18 Nov 2009 01:47:26 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12425265/hadoopLocal.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12425265/hadoopLocal.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 881008.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 22 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 356 release audit warnings (more than the trunk&apos;s current 354 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/158/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/158/testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/158/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/158/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/158/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/158/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/158/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/158/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12779252" author="ankit.modi" created="Wed, 18 Nov 2009 01:48:50 +0000"  >&lt;p&gt;PhysicalPlan in local mode had POCounter Operator before every POStore. This operator was used for getting stats.&lt;/p&gt;

&lt;p&gt;As we moved to Hadoop this operator is no longer used. Hence the plan size changed. So the numbers changed. &lt;/p&gt;</comment>
                            <comment id="12779344" author="hadoopqa" created="Wed, 18 Nov 2009 07:15:00 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12425289/hadoopLocal.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12425289/hadoopLocal.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 881008.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 22 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 356 release audit warnings (more than the trunk&apos;s current 354 warnings).&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/159/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/159/testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/159/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/159/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/159/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/159/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/159/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/159/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12779532" author="olgan" created="Wed, 18 Nov 2009 17:17:32 +0000"  >&lt;p&gt;release audit failures are in html. I will be committing the patch later today&lt;/p&gt;</comment>
                            <comment id="12779534" author="olgan" created="Wed, 18 Nov 2009 17:19:13 +0000"  >&lt;p&gt;Looks like the patch got resubmitted after my review - what has changed?&lt;/p&gt;</comment>
                            <comment id="12779606" author="olgan" created="Wed, 18 Nov 2009 19:19:49 +0000"  >&lt;p&gt;patch commited; thanks, Ankit&lt;/p&gt;</comment>
                            <comment id="12786948" author="zjffdu" created="Mon, 7 Dec 2009 15:31:04 +0000"  >&lt;p&gt;Since the removal of pig&apos;s own local mode, I think there&apos;s still some code clean up work needs to do. A lot of code related with the original pig local mode needs to be removed.  &lt;/p&gt;</comment>
                            <comment id="12787081" author="alangates" created="Mon, 7 Dec 2009 20:06:25 +0000"  >&lt;p&gt;Yes, there is a lot of code to remove.  We figured once we got the local map reduce mode working we could remove the extra code as we have time.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12425289" name="hadoopLocal.patch" size="28835" author="ankit.modi" created="Wed, 18 Nov 2009 02:02:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 27 Oct 2009 00:38:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164581</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyalyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95869</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>