<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:58:22 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-750/PIG-750.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-750] Use combiner when algebraic UDFs are used in expressions</title>
                <link>https://issues.apache.org/jira/browse/PIG-750</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Currently Pig uses combiner when all a,b, c,... are algebraic (e.g. SUM, AVG etc.) in foreach:&lt;/p&gt;

&lt;p&gt;foreach X generate a,b,c,... &lt;/p&gt;

&lt;p&gt; It&apos;s a performance improvement if it uses combiner when a mix of algebraic and non-algebraic functions are used as well.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12421933">PIG-750</key>
            <summary>Use combiner when algebraic UDFs are used in expressions</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thejas">Thejas M Nair</assignee>
                                    <reporter username="amirhyoussefi">Amir Youssefi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Apr 2009 00:59:55 +0100</created>
                <updated>Thu, 4 Aug 2011 01:34:50 +0100</updated>
                            <resolved>Sun, 19 Dec 2010 03:59:30 +0000</resolved>
                                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12699023" author="amirhyoussefi" created="Wed, 15 Apr 2009 03:06:24 +0100"  >&lt;p&gt;Other use-cases we need have in unit tests:&lt;/p&gt;

&lt;p&gt;1) foreach X generate SUM(a) * AVG(b), ...&lt;/p&gt;

&lt;p&gt;2) foreach X generate 1 / SUM(a) &lt;/p&gt;

&lt;p&gt;Currently, there is a work-around suggested to have all algebraic functions calculated in a foreach and then more expressions/mixes are calculated in a second foreach. This way combiner is used in the first foreach and we get combiner speed-up.&lt;/p&gt;</comment>
                            <comment id="12700195" author="ciemo" created="Fri, 17 Apr 2009 15:46:17 +0100"  >&lt;p&gt;Also consider the application of a scalar function to the result of an aggregation function:&lt;/p&gt;

&lt;p&gt;3) foreach X generate EXP(AVG(b))&lt;/p&gt;</comment>
                            <comment id="12913268" author="alangates" created="Tue, 21 Sep 2010 22:35:48 +0100"  >&lt;p&gt;Our performance tests have shown that having combiner and non-combiner functions in the same MR job actually severly slows things down.  We suspect that this is because you have to pass the bags for the non-combiner functions through the combiner and you pay for the multiple (de)serialization passes.&lt;/p&gt;

&lt;p&gt;However, the other things noted in this bug, such as the need to use the combiner when algebraic UDFs are involved in simple expressions is valid, and is along the lines of issues Thejas is working on for the combiner.  So I&apos;m assigning the issue to him.&lt;/p&gt;</comment>
                            <comment id="12972640" author="thejas" created="Fri, 17 Dec 2010 20:39:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-750&quot; title=&quot;Use combiner when algebraic UDFs are used in expressions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-750&quot;&gt;&lt;del&gt;PIG-750&lt;/del&gt;&lt;/a&gt;.1.patch - This patch also fixes jira &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-490&quot; title=&quot;Combiner not used when group elements referred to in tuple notation instead of flatten.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-490&quot;&gt;&lt;del&gt;PIG-490&lt;/del&gt;&lt;/a&gt; .&lt;br/&gt;
In test patch results, the release audit warning is a false alarm, it is complaining about a generated docs diff file.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; -1 overall.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 tests included.  The patch appears to include 6 new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 release audit.  The applied patch generated 501 release audit warnings (more than the trunk&apos;s current 500 warnings).&lt;/p&gt;

&lt;p&gt;I have run unit tests all pass, but I am running it again after some cosmetic changes.&lt;/p&gt;
</comment>
                            <comment id="12972718" author="daijy" created="Sat, 18 Dec 2010 01:22:45 +0000"  >&lt;p&gt;+1. Please put release notes.&lt;/p&gt;</comment>
                            <comment id="12972907" author="thejas" created="Sun, 19 Dec 2010 03:59:30 +0000"  >&lt;p&gt;Patch committed to trunk.&lt;/p&gt;</comment>
                            <comment id="12973357" author="scott_carey" created="Mon, 20 Dec 2010 20:50:40 +0000"  >&lt;p&gt;Awesome!&lt;/p&gt;

&lt;p&gt;This is a huge improvement for several of my use cases.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12466497" name="PIG-750.1.patch" size="68447" author="thejas" created="Fri, 17 Dec 2010 20:39:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Apr 2009 14:46:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66248</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaigv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95303</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>With changes in the patch, queries which have algebraic functions within expressions also will use combiner. This is as long as the bags from group-by are only input for algebraic expressions. If bag is projected or a non algebraic expression/udf has bag as input, combiner will not be used.&lt;br/&gt;
Combiner will be used in case of following foreach statements (that follow group) -&lt;br/&gt;
describe B ;&lt;br/&gt;
B: {group: int, A: {c1 : int, c2 : int, c3 : int}}&lt;br/&gt;
&lt;br/&gt;
1) foreach B generate SUM(A.c2) * AVG(A.c3), ...&lt;br/&gt;
2) foreach B generate 1 / SUM(A.c2)&lt;br/&gt;
3) foreach B generate EXP(AVG(A.c2))&lt;br/&gt;
4) foreach B generate group + SUM(A.c2)&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
Following statements will not use combiner -&lt;br/&gt;
1) foreach B generate A.c2, ...&lt;br/&gt;
2) foreach B generate EXP(c2) , SUM(c2) ... - Where EXP is non algebraic function&lt;br/&gt;
&lt;br/&gt;
In case of nested foreach statement, if it has limit, order, or filter , combiner does not get used (as before).&lt;br/&gt;
&lt;br/&gt;
This patch also fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-490&quot; title=&quot;Combiner not used when group elements referred to in tuple notation instead of flatten.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-490&quot;&gt;&lt;strike&gt;PIG-490&lt;/strike&gt;&lt;/a&gt;, foreach statements that access group elements also use combiner &lt;br/&gt;
for example -&lt;br/&gt;
1) foreach B generate group.$0, group.$1, COUNT(A);&lt;br/&gt;
1) foreach B generate group.c1, group.c2, COUNT(A);&lt;br/&gt;
</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>