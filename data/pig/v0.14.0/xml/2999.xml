<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:51:42 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2999/PIG-2999.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2999] Regression after PIG-2975: BinInterSedesTupleRawComparator secondary sort failing</title>
                <link>https://issues.apache.org/jira/browse/PIG-2999</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;I think I broke the build from &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2975&quot; title=&quot;TestTypedMap.testOrderBy failing with incorrect result &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2975&quot;&gt;&lt;del&gt;PIG-2975&lt;/del&gt;&lt;/a&gt;.  I see couple of tests failing at BinInterSedesTupleRawComparator. &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;12/10/22 22:26:15 WARN mapred.LocalJobRunner: job_local_0022
java.nio.BufferUnderflowException
	at java.nio.Buffer.nextGetIndex(Buffer.java:478)
	at java.nio.HeapByteBuffer.getLong(HeapByteBuffer.java:387)
	at org.apache.pig.data.BinInterSedes$BinInterSedesTupleRawComparator.compareBinInterSedesDatum(BinInterSedes.java:829)
	at org.apache.pig.data.BinInterSedes$BinInterSedesTupleRawComparator.compareBinSedesTuple(BinInterSedes.java:732)
	at org.apache.pig.data.BinInterSedes$BinInterSedesTupleRawComparator.compare(BinInterSedes.java:695)
	at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigSecondaryKeyComparator.compare(PigSecondaryKeyComparator.java:78)
	at org.apache.hadoop.mapred.Merger$MergeQueue.lessThan(Merger.java:373)
	at org.apache.hadoop.util.PriorityQueue.downHeap(PriorityQueue.java:139)
	at org.apache.hadoop.util.PriorityQueue.adjustTop(PriorityQueue.java:103)
	at org.apache.hadoop.mapred.Merger$MergeQueue.adjustPriorityQueue(Merger.java:335)
	at org.apache.hadoop.mapred.Merger$MergeQueue.next(Merger.java:350)
	at org.apache.hadoop.mapred.ReduceTask$4.next(ReduceTask.java:625)
	at org.apache.hadoop.mapreduce.ReduceContext.nextKeyValue(ReduceContext.java:117)
	at org.apache.hadoop.mapreduce.ReduceContext.nextKey(ReduceContext.java:92)
	at org.apache.hadoop.mapreduce.Reducer.run(Reducer.java:175)
	at org.apache.hadoop.mapred.ReduceTask.runNewReducer(ReduceTask.java:649)
	at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:417)
	at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:260)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12613094">PIG-2999</key>
            <summary>Regression after PIG-2975: BinInterSedesTupleRawComparator secondary sort failing</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12611880">PIG-2972</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knoguchi">Koji Noguchi</assignee>
                                    <reporter username="knoguchi">Koji Noguchi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Oct 2012 04:15:08 +0100</created>
                <updated>Fri, 22 Feb 2013 04:54:04 +0000</updated>
                            <resolved>Thu, 25 Oct 2012 01:14:17 +0100</resolved>
                                    <version>0.11</version>
                    <version>0.12.0</version>
                                    <fixVersion>0.11</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13482079" author="jcoveney" created="Tue, 23 Oct 2012 04:28:20 +0100"  >&lt;p&gt;Can you post the tests that you are failing that you see?&lt;/p&gt;</comment>
                            <comment id="13482081" author="jcoveney" created="Tue, 23 Oct 2012 04:31:27 +0100"  >&lt;p&gt;I have a theory on what it is.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; BinInterSedes.TINYBYTEARRAY:
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; BinInterSedes.SMALLBYTEARRAY:
            &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; BinInterSedes.BYTEARRAY: {
                type1 = DataType.BYTEARRAY;
                type2 = getGeneralizedDataType(dt2);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (type1 == type2) {
                    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; basz1 = readSize(bb1, dt1);
                    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; basz2 = readSize(bb2, dt2);
                    rc = org.apache.hadoop.io.WritableComparator.compareBytes(
                          bb1.array(), bb1.position(), basz1,
                          bb2.array(), bb2.position(), basz2);
                }
                &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the old code, the act of comparing would have advanced the respective pointers in the bytebuffer. In this case, now it doesn&apos;t. So now, after the comparison, assuming that the two are equal, it will keep going as if the next data type where the next byte (this would explain why the specific line in question it fails on is DateTime in code I bet is comparing Bytearrays).&lt;/p&gt;

&lt;p&gt;The solution is after doing the comparison, to skip ahead the bytebuffers.&lt;/p&gt;

&lt;p&gt;That&apos;s my guess, though.&lt;/p&gt;</comment>
                            <comment id="13482082" author="azaroth" created="Tue, 23 Oct 2012 04:34:06 +0100"  >&lt;p&gt;Most likely you are correct Jonathan.&lt;/p&gt;</comment>
                            <comment id="13482085" author="knoguchi" created="Tue, 23 Oct 2012 04:37:58 +0100"  >&lt;p&gt;During the performance test in pig-2975, I made a change inside compareBinInterSedesDatum for bytearray comparisons but didn&apos;t update the bytebuffer position after the read leading to random failures when bytebuffer is accessed afterwards.&lt;/p&gt;</comment>
                            <comment id="13482088" author="knoguchi" created="Tue, 23 Oct 2012 04:41:01 +0100"  >&lt;p&gt;Thanks Jonathan, Gianmarco. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can you post the tests that you are failing that you see?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;org.apache.pig.test.TestEvalPipelineLocal.testNestedPlanForCloning &lt;br/&gt;
org.apache.pig.test.TestPruneColumn.testCoGroup7 &lt;/p&gt;

&lt;p&gt;and more.  &lt;/p&gt;</comment>
                            <comment id="13482095" author="knoguchi" created="Tue, 23 Oct 2012 05:09:19 +0100"  >&lt;blockquote&gt;&lt;p&gt;and more. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;org.apache.pig.test.TestEvalPipeline.testNestedPlan&lt;br/&gt;
org.apache.pig.test.TestEvalPipeline.testNestedPlanWithExpressionAssignment&lt;br/&gt;
org.apache.pig.test.TestEvalPipeline.testNestedPlanForCloning&lt;br/&gt;
org.apache.pig.test.TestStreamingLocal.testSimpleOrderedReduceSideStreamingAfterFlatten&lt;br/&gt;
org.apache.pig.test.TestPigTupleRawComparator.testCompareDataBag&lt;br/&gt;
org.apache.pig.test.TestPigTupleRawComparator.compareInnerTuples&lt;br/&gt;
org.apache.pig.test.TestPigTupleRawComparator.testCompareCharArray&lt;br/&gt;
org.apache.pig.test.TestPigTupleRawComparator.testCompareEquals&lt;br/&gt;
org.apache.pig.test.TestForEachNestedPlanLocal.testNestedCrossTwoRelationsComplex&lt;br/&gt;
org.apache.pig.test.TestForEachNestedPlanLocal.testInnerOrderBy&lt;/p&gt;

&lt;p&gt;instead of fixing test failures in pig-2975, I introduced so many more failures.  Sorry guys.&lt;/p&gt;</comment>
                            <comment id="13482096" author="rohini" created="Tue, 23 Oct 2012 05:10:06 +0100"  >&lt;p&gt;+1 (non-binding) for the patch. I am also seeing failures.For eg. TestPigTupleRawComparator tests fail with OOM.  Had mentioned about the bb.position having to be incremented earlier to Koji, then retracted the statement when I looked at the code and thought the ByteBuffer was not accessed after that. But I was mistaken and it is accessed again in case of secondary sort.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
result = compareBinInterSedesDatum(bb1, bb2, mAsc);
                        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (result == 0)
                            result = compareBinInterSedesDatum(bb1, bb2, mSecondaryAsc);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="13482381" author="knoguchi" created="Tue, 23 Oct 2012 15:59:58 +0100"  >&lt;p&gt;After patch &apos;pig-2999-v1.txt&apos; is applied, previous new failing tests are going through.  However, I still see&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;junit.framework.AssertionFailedError: expected:&amp;lt;1.0&amp;gt; but was:&amp;lt;-1.0&amp;gt;
	at org.apache.pig.test.TestPigTupleRawComparator.testRandomTuples(TestPigTupleRawComparator.java:399)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This seems to be coming from DataByteArray.compare(byte[] b1, byte[] b2)&apos;s byte comparisons are different from WritableComparator.compareBytes. Checking.&lt;/p&gt;</comment>
                            <comment id="13482414" author="knoguchi" created="Tue, 23 Oct 2012 16:32:43 +0100"  >&lt;p&gt;In WritableComparator, it converts to &apos;int&apos; and then compare.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;123   public static int compareBytes(byte[] b1, int s1, int l1,
124                                  byte[] b2, int s2, int l2) {
125     int end1 = s1 + l1;
126     int end2 = s2 + l2;
127     for (int i = s1, j = s2; i &amp;lt; end1 &amp;amp;&amp;amp; j &amp;lt; end2; i++, j++) {
128       int a = (b1[i] &amp;amp; 0xff);
129       int b = (b2[j] &amp;amp; 0xff);
130       if (a != b) {
131         return a - b;
132       }
133     }
134     return l1 - l2;
135   }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;whereas, DataByteArray compares directly as byte.  To make it consistent with other shortcurts we added in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2975&quot; title=&quot;TestTypedMap.testOrderBy failing with incorrect result &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2975&quot;&gt;&lt;del&gt;PIG-2975&lt;/del&gt;&lt;/a&gt;, making the DataByteArray.compare simply call WritableComparator.compareBytes.  This fixes the TestPigTupleRawComparator.testRandomTuples failure.&lt;/p&gt;</comment>
                            <comment id="13482489" author="azaroth" created="Tue, 23 Oct 2012 18:26:18 +0100"  >&lt;p&gt;The patch looks good.&lt;br/&gt;
Running tests to make sure everything works.&lt;/p&gt;</comment>
                            <comment id="13482533" author="jcoveney" created="Tue, 23 Oct 2012 19:15:47 +0100"  >&lt;p&gt;+1. Gianmarco, you want to commit once the tests pass?&lt;/p&gt;</comment>
                            <comment id="13482538" author="azaroth" created="Tue, 23 Oct 2012 19:20:29 +0100"  >&lt;p&gt;Sure, I will take care of it.&lt;/p&gt;</comment>
                            <comment id="13482830" author="jcoveney" created="Wed, 24 Oct 2012 00:42:55 +0100"  >&lt;p&gt;Has this been committed?&lt;/p&gt;</comment>
                            <comment id="13482837" author="azaroth" created="Wed, 24 Oct 2012 00:53:11 +0100"  >&lt;p&gt;Not yet. I am running the full test suite to be sure we don&apos;t break other things, but it takes a while.&lt;/p&gt;</comment>
                            <comment id="13482839" author="cheolsoo" created="Wed, 24 Oct 2012 00:53:25 +0100"  >&lt;p&gt;Hi, I see that org.apache.pig.test.TestDataModel.testMultiFieldTupleCompareTo fails:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Testcase: testMultiFieldTupleCompareTo took 0.002 sec 
    FAILED
less than tuple with greater value expected:&amp;lt;-1&amp;gt; but was:&amp;lt;-2&amp;gt;
junit.framework.AssertionFailedError: less than tuple with greater value expected:&amp;lt;-1&amp;gt; but was:&amp;lt;-2&amp;gt;
    at org.apache.pig.test.TestDataModel.testMultiFieldTupleCompareTo(TestDataModel.java:377)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Do anyone also it this failure? I don&apos;t any other failures.&lt;/p&gt;</comment>
                            <comment id="13482934" author="knoguchi" created="Wed, 24 Oct 2012 04:50:23 +0100"  >&lt;blockquote&gt;&lt;p&gt;less than tuple with greater value expected:&amp;lt;-1&amp;gt; but was:&amp;lt;-2&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;DataByteArray.compare returns -1,0,+1 .&lt;br/&gt;
WritableComparator.compareBytes returns -n, 0, +n   &lt;/p&gt;

&lt;p&gt;It doesn&apos;t convert value back to -1 or +1. &lt;br/&gt;
In the test, can we wrap the result with Math.signum like we do in TestPigTupleRawComparator.java ?&lt;/p&gt;

{nofromat}
&lt;p&gt;377         assertEquals(&quot;less than tuple with greater value&quot;, -1, t1.compareTo(t2));&lt;br/&gt;
to &lt;br/&gt;
377         assertEquals(&quot;less than tuple with greater value&quot;, Math.signum(-1), Math.signum(t1.compareTo(t2)));&lt;br/&gt;
{noformat]&lt;/p&gt;</comment>
                            <comment id="13482936" author="azaroth" created="Wed, 24 Oct 2012 04:58:35 +0100"  >&lt;p&gt;Makes sense. Comparable only guarantees &amp;lt;0 ==0 and &amp;gt;0&lt;/p&gt;</comment>
                            <comment id="13483338" author="azaroth" created="Wed, 24 Oct 2012 16:57:10 +0100"  >&lt;p&gt;I see these tests fail:&lt;br/&gt;
org.apache.pig.impl.streaming.TestExecutableManager.testAddJobConfToEnv&lt;br/&gt;
	unit.framework.AssertionFailedError: There should be no remaining pairs in the included map at&lt;br/&gt;
	org.apache.pig.impl.streaming.TestExecutableManager.testAddJobConfToEnv(TestExecutableManager.java:84)&lt;/p&gt;

&lt;p&gt;org.apache.pig.test.TestDataModel.testMultiFieldTupleCompareTo&lt;br/&gt;
	less than tuple with greater value expected:&amp;lt;-1&amp;gt; but was:&amp;lt;-2&amp;gt;&lt;/p&gt;


&lt;p&gt;For the second one, the solution proposed by Koji is fine.&lt;br/&gt;
Not sure the first one is related (probably not).&lt;/p&gt;

&lt;p&gt;These tests also fail but I think they are not directly related to this patch.&lt;br/&gt;
org.apache.pig.test.TestJobSubmission.testReducerNumEstimation&lt;br/&gt;
org.apache.pig.test.TestMacroExpansion.testMacroAliasConversion&lt;br/&gt;
org.apache.pig.test.TestScriptLanguage.bindLocalVariableTest2&lt;br/&gt;
org.apache.pig.test.TestStreaming.testInputCacheSpecs &lt;/p&gt;

&lt;p&gt;Once the testMultiFieldTupleCompareTo test case is fixed I am OK with the patch.&lt;/p&gt;</comment>
                            <comment id="13483352" author="azaroth" created="Wed, 24 Oct 2012 17:14:18 +0100"  >&lt;p&gt;I checked TestExecutableManager and the patch has nothing to do with it.&lt;br/&gt;
I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3001&quot; title=&quot;TestExecutableManager.testAddJobConfToEnv fails randomly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3001&quot;&gt;&lt;del&gt;PIG-3001&lt;/del&gt;&lt;/a&gt; to address the issue.&lt;/p&gt;</comment>
                            <comment id="13483375" author="cheolsoo" created="Wed, 24 Oct 2012 17:44:17 +0100"  >&lt;p&gt;Hi Gianmarco,&lt;/p&gt;

&lt;p&gt;Thanks for sharing your result. I agree that the patch is good as long as TestDataModel is fixed.&lt;/p&gt;

&lt;p&gt;Here is my results.&lt;/p&gt;

&lt;p&gt;hadoop20:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;TestStreaming =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2973&quot; title=&quot;TestStreaming test times out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2973&quot;&gt;&lt;del&gt;PIG-2973&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestScriptLanguage =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2998&quot; title=&quot;Fix TestScriptLanguage and TestMacroExpansion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2998&quot;&gt;&lt;del&gt;PIG-2998&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestDataModel =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2999&quot; title=&quot;Regression after PIG-2975: BinInterSedesTupleRawComparator secondary sort failing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2999&quot;&gt;&lt;del&gt;PIG-2999&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestExecutableManager =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3001&quot; title=&quot;TestExecutableManager.testAddJobConfToEnv fails randomly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3001&quot;&gt;&lt;del&gt;PIG-3001&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestMacroExpansion.testMacroAliasConversion =&amp;gt; new. need a jira.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;hadoop23:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;TestStreaming =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2973&quot; title=&quot;TestStreaming test times out&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2973&quot;&gt;&lt;del&gt;PIG-2973&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestLoadStoreFuncLifeCycle =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2978&quot; title=&quot;TestLoadStoreFuncLifeCycle fails with hadoop-2.0.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2978&quot;&gt;&lt;del&gt;PIG-2978&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestScriptLanguage =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2998&quot; title=&quot;Fix TestScriptLanguage and TestMacroExpansion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2998&quot;&gt;&lt;del&gt;PIG-2998&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestDataModel =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2999&quot; title=&quot;Regression after PIG-2975: BinInterSedesTupleRawComparator secondary sort failing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2999&quot;&gt;&lt;del&gt;PIG-2999&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestPigServerWithMacros =&amp;gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2913&quot; title=&quot;org.apache.pig.test.TestPigServerWithMacros fails sometimes because it picks up previous minicluster configuration file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2913&quot;&gt;&lt;del&gt;PIG-2913&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TestMacroExpansion =&amp;gt; new. need a jira.&lt;/li&gt;
	&lt;li&gt;TestPigContext =&amp;gt; seen before. need a jira.&lt;/li&gt;
	&lt;li&gt;TestRegisteredJarVisibility =&amp;gt; seen before. need a jira.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;e2e:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;all the tests that were failing due to order by are passing now.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;But I don&apos;t see TestJobSubmission.testReducerNumEstimation failing. Could it be specific to your environment, or an intermittent failure?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13483387" author="cheolsoo" created="Wed, 24 Oct 2012 17:53:32 +0100"  >&lt;p&gt;On my other jenkins jobs, I actually see TestJobSubmission.testReducerNumEstimation failed once.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
12/10/24 02:30:56 FATAL master.HMaster: Unhandled exception. Starting shutdown.
java.net.BindException: Address already in use
	at sun.nio.ch.Net.bind(Native Method)
	at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:126)
	at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:59)
	at org.mortbay.jetty.nio.SelectChannelConnector.open(SelectChannelConnector.java:216)
	at org.apache.hadoop.http.HttpServer.start(HttpServer.java:564)
	at org.apache.hadoop.hbase.master.HMaster.startServiceThreads(HMaster.java:767)
	at org.apache.hadoop.hbase.master.HMaster.finishInitialization(HMaster.java:488)
	at org.apache.hadoop.hbase.master.HMaster.run(HMaster.java:338)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:662)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In my case, it was due to a port number conflict. HBase master couldn&apos;t get started.&lt;/p&gt;</comment>
                            <comment id="13483388" author="azaroth" created="Wed, 24 Oct 2012 17:54:52 +0100"  >&lt;p&gt;Hi Cheolsoo,&lt;/p&gt;

&lt;p&gt;Thanks for the summary.&lt;br/&gt;
I guess it is an intermittent failure:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Error Message

Unable to find region &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;  after 10 tries.
Stacktrace

org.apache.hadoop.hbase.client.NoServerForRegionException: Unable to find region &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;  after 10 tries.
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegionInMeta(HConnectionManager.java:677)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:586)
	at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:555)
	at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:171)
	at org.apache.hadoop.hbase.HBaseTestingUtility.startMiniHBaseCluster(HBaseTestingUtility.java:369)
	at org.apache.pig.test.TestJobSubmission.testReducerNumEstimation(TestJobSubmission.java:545)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13483416" author="cheolsoo" created="Wed, 24 Oct 2012 18:26:20 +0100"  >&lt;p&gt;TestMacroExpansion is a regression from &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2931&quot; title=&quot;$ signs in the replacement string make parameter substitution fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2931&quot;&gt;&lt;del&gt;PIG-2931&lt;/del&gt;&lt;/a&gt;, and this should be fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2998&quot; title=&quot;Fix TestScriptLanguage and TestMacroExpansion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2998&quot;&gt;&lt;del&gt;PIG-2998&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13483699" author="julienledem" created="Thu, 25 Oct 2012 00:00:27 +0100"  >&lt;p&gt;FYI TestPigTupleRawComparator fails with OOM because BinInterSedes is not reading the size of the map correctly and is trying to create a huge map.&lt;/p&gt;</comment>
                            <comment id="13483716" author="cheolsoo" created="Thu, 25 Oct 2012 00:18:34 +0100"  >&lt;p&gt;Here is a patch that incorporates all the proposed fixes.&lt;/p&gt;

&lt;p&gt;I verified that all the mentioned tests are fixed, and no regression is introduced.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13483753" author="azaroth" created="Thu, 25 Oct 2012 01:14:17 +0100"  >&lt;p&gt;Verified that failing tests pass locally.&lt;br/&gt;
+1&lt;/p&gt;

&lt;p&gt;Committed to trunk and 0.11.&lt;/p&gt;

&lt;p&gt;Thanks for fixing this Cheolsoo, Koji.&lt;/p&gt;</comment>
                            <comment id="13483758" author="cheolsoo" created="Thu, 25 Oct 2012 01:21:36 +0100"  >&lt;p&gt;Thanks for committing it Gianmarco!&lt;/p&gt;

&lt;p&gt;I am changing the assignee to Koji since he deserves the credit I think.&lt;/p&gt;</comment>
                            <comment id="13483832" author="knoguchi" created="Thu, 25 Oct 2012 03:21:19 +0100"  >&lt;p&gt;Thanks for fixing the mess I&apos;ve made!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I am changing the assignee to Koji since he deserves the credit I think.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t deserve a &apos;credit&apos; but rather a blame &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  I learned my lesson and I&apos;ll be extra careful from next time.  Thanks again for all your help and sorry for the trouble I&apos;ve caused.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12612000">PIG-2984</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12613385">PIG-3003</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12550409" name="pig-2999-v1.txt" size="880" author="knoguchi" created="Tue, 23 Oct 2012 04:37:58 +0100"/>
                            <attachment id="12550478" name="pig-2999-v2.txt" size="2157" author="knoguchi" created="Tue, 23 Oct 2012 16:32:43 +0100"/>
                            <attachment id="12550704" name="pig-2999-v3.txt" size="6066" author="cheolsoo" created="Thu, 25 Oct 2012 00:18:34 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 23 Oct 2012 03:28:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>250494</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4tgf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61928</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>