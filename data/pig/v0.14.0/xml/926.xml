<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:56:12 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-926/PIG-926.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-926] Merge-Join phase 2</title>
                <link>https://issues.apache.org/jira/browse/PIG-926</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;This jira is created to keep track of phase-2 work for MergeJoin. Various limitations exist in phase-1 for Merge Join which are listed on: &lt;a href=&quot;http://wiki.apache.org/pig/PigMergeJoin&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/pig/PigMergeJoin&lt;/a&gt; Those will be addressed here.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12433202">PIG-926</key>
            <summary>Merge-Join phase 2</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ashutoshc">Ashutosh Chauhan</assignee>
                                    <reporter username="ashutoshc">Ashutosh Chauhan</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Aug 2009 03:23:25 +0100</created>
                <updated>Wed, 24 Mar 2010 22:13:12 +0000</updated>
                            <resolved>Wed, 16 Sep 2009 01:02:55 +0100</resolved>
                                                    <fixVersion>0.4.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12743949" author="ashutoshc" created="Mon, 17 Aug 2009 03:25:22 +0100"  >&lt;p&gt;The attached first patch runs the full pipeline of right side in indexer before sampling the tuple from block. This has following advantages:&lt;br/&gt;
a) It addresses the concern which Pradeep pointed out in phase-1: &quot;Strictly we should not allow LOForeach since it could change sort order or position of join keys and hence invalidate the index - but we need it so that the Foreach introduced by the TypeCastInserter when there is a schema for either of the inputs remains.&quot; Now since pipeline is run before sampling the tuple, this becomes a non-issue.&lt;br/&gt;
b) Currently type information doesn&apos;t make it to the POSort which sorts the index entries in reduce task of index job. This works due to other reasons, but this patch fixes this.&lt;br/&gt;
c) It will improve on performance. Instead of always sampling the first record of the block, index now contains the entry of first record in the block for which join may happen, thus saving time spent in fetching right tuples over the network which couldn&apos;t be joined in any case.&lt;/p&gt;</comment>
                            <comment id="12744382" author="ashutoshc" created="Tue, 18 Aug 2009 07:13:37 +0100"  >&lt;p&gt;Additionally, with this approach, there will not be any need for inserting type casting in POMergeJoin while reading index entries. Thus, can get rid of unnecessary extra code there and keep things simple.  Will resubmit the patch including those changes.&lt;/p&gt;

&lt;p&gt;Forgot to mention previously, this is a follow-up work on &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-845&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PIG-845&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="12744596" author="ashutoshc" created="Tue, 18 Aug 2009 17:50:14 +0100"  >&lt;p&gt;Updated the patch as discussed in previous comments, Included a test case. Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="12744705" author="pkamath" created="Tue, 18 Aug 2009 22:00:39 +0100"  >&lt;p&gt;Review commments&lt;/p&gt;</comment>
                            <comment id="12744706" author="pkamath" created="Tue, 18 Aug 2009 22:01:34 +0100"  >&lt;p&gt;Review comments:&lt;br/&gt;
In MergeJoinIndexer:&lt;br/&gt;
Is there a reason MergeJoinIndexer is a subclass of RandomSampleLoader? It does not use numSamples or skipInterval and has its own getNext() - is there any benefit to inheritance?&lt;br/&gt;
I see that readObject() method has been removed - is this no longer needed?&lt;br/&gt;
Also for the case where right pipeline returns POStatus.STATUS_ERR, the code currently ignores it and continues. I am wondering in the worst case, if all iterations of running the&lt;br/&gt;
right pipeline result in POStatus.STATUS_ERR, MergeJoinIndexer would return null for the join key. If this happened from all maps, we would get an index will all null entries, in this&lt;br/&gt;
case, I think merge join succeeds with empty output which would be wrong (I am assuming POMergeJoin treats an index full of null entries as indicating that the right input is empty). If this would be the case, we should throw an ExecException on POStatus.STATUS_ERR.&lt;/p&gt;
</comment>
                            <comment id="12744752" author="hadoopqa" created="Tue, 18 Aug 2009 23:16:35 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12416886/mj_phase2_1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12416886/mj_phase2_1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 804406.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 1 new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/170/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/170/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/170/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/170/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/170/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/170/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12745161" author="ashutoshc" created="Wed, 19 Aug 2009 19:39:02 +0100"  >&lt;p&gt;Thanks for the review, Pradeep. My response is inline.&lt;/p&gt;

&lt;p&gt;Is there a reason MergeJoinIndexer is a subclass of RandomSampleLoader? It does not use numSamples or skipInterval and has its own getNext() - is there any benefit to inheritance?&lt;br/&gt;
&amp;gt;&amp;gt; Ya, its better not to have that dependency. Now, MergeJoinIndexer doesn&apos;t subclass RandomSampleLoader, instead implements LoadFunc itself.&lt;/p&gt;

&lt;p&gt;I see that readObject() method has been removed - is this no longer needed?&lt;br/&gt;
&amp;gt;&amp;gt; Ya, its not required anymore.&lt;/p&gt;

&lt;p&gt;Also for the case where right pipeline returns POStatus.STATUS_ERR, the code currently ignores it and continues. ..&lt;br/&gt;
&amp;gt;&amp;gt; I was following the usual practice of passing down ERR in the pipeline. But in this case it seems to throw ExecException right there. Updated the patch with it.&lt;/p&gt;

&lt;p&gt;Updated the patch with these changes.&lt;br/&gt;
FindBugs warning is harmless and can be ignored.&lt;/p&gt;</comment>
                            <comment id="12745181" author="pkamath" created="Wed, 19 Aug 2009 20:33:34 +0100"  >
&lt;p&gt;In MRCompiler:&lt;br/&gt;
You should change:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 indexerArgs[0] = rightLoader.getLFile().getFuncName();
to
 indexerArgs[0] = rightLoader.getLFile().getFuncSpec().toString();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to handle the case where the loader may have constructor args (like PigStorage(&quot;,&quot;) - PigStorage with comma as delim)&lt;/p&gt;

&lt;p&gt;In the error message when the loader does not implement SamplableLoader, you can change:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;This loader doesn&apos;t implement it.
to
&quot;The loader specified in &quot; + indexerArgs[0] + &quot; doesn&apos;t implement it&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Otherwise looks good.&lt;/p&gt;</comment>
                            <comment id="12745197" author="ashutoshc" created="Wed, 19 Aug 2009 22:07:52 +0100"  >&lt;p&gt;Updated patch addressing Pradeep&apos;s comments.&lt;/p&gt;</comment>
                            <comment id="12745270" author="hadoopqa" created="Thu, 20 Aug 2009 02:29:42 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12417053/mj_phase2_1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12417053/mj_phase2_1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 805684.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    -1 findbugs.  The patch appears to introduce 1 new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/175/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/175/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/175/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/175/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/175/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/175/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12745510" author="ashutoshc" created="Thu, 20 Aug 2009 18:26:45 +0100"  >&lt;p&gt;Findbugs warning is about dummyTuple. A dummyTuple is used as an argument to call appropriate overloaded getNext() of physical operator. Since this is just a marker, it is initialized as null and never updated. Findbugs thinks that it will always be null, which is true, but it doesn&apos;t affect in any way. There is no workaround to get rid of this warning.&lt;/p&gt;</comment>
                            <comment id="12745535" author="pkamath" created="Thu, 20 Aug 2009 19:09:22 +0100"  >&lt;p&gt;Patch committed - thanks for the contribution Ashutosh!&lt;/p&gt;</comment>
                            <comment id="12745922" author="hudson" created="Fri, 21 Aug 2009 12:59:32 +0100"  >&lt;p&gt;Integrated in Pig-trunk #529 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-trunk/529/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-trunk/529/&lt;/a&gt;)&lt;br/&gt;
    : Merge-Join phase 2 (ashutoshc via pradeepkth)&lt;/p&gt;</comment>
                            <comment id="12755809" author="alangates" created="Wed, 16 Sep 2009 01:02:55 +0100"  >&lt;p&gt;Patch committed 20 August 2009&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12417053" name="mj_phase2_1.patch" size="35191" author="ashutoshc" created="Wed, 19 Aug 2009 22:07:52 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Aug 2009 21:00:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164468</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyakj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95637</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>