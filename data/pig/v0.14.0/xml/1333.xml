<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:06:18 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1333/PIG-1333.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1333] API interface to Pig</title>
                <link>https://issues.apache.org/jira/browse/PIG-1333</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;It would be nice to make Pig more friendly for applications like workflow that would be executing pig scripts on user behalf.&lt;/p&gt;

&lt;p&gt;Currently, they would have to use pig command line to execute the code; however, this has limitation on the kind of output that would be delivered. For instance, it is hard to produce error information that is easy to use programatically or collect statistics.&lt;/p&gt;

&lt;p&gt;The proposal is to create a class that mimics the behavior of the Main but gives users a status object back. The the main code of pig would look somethig like:&lt;/p&gt;

&lt;p&gt;public static void main(String args[])&lt;/p&gt;
{
    PigStatus ps = PigMain.exec(args);
    exit (PigStatus.rc);
}

&lt;p&gt;We need to define the following:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Content of PigStatus. It should at least include&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;return code&lt;/li&gt;
	&lt;li&gt;error string&lt;/li&gt;
	&lt;li&gt;exception&lt;/li&gt;
	&lt;li&gt;statistics&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A way to propagate the status class through pig code&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12460396">PIG-1333</key>
            <summary>API interface to Pig</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rding">Richard Ding</assignee>
                                    <reporter username="olgan">Olga Natkovich</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 Mar 2010 21:22:24 +0000</created>
                <updated>Fri, 17 Dec 2010 22:43:59 +0000</updated>
                            <resolved>Wed, 23 Jun 2010 19:10:48 +0100</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="12869809" author="rding" created="Fri, 21 May 2010 00:33:48 +0100"  >
&lt;p&gt;I propose Pig add a new class PigRunner that has a run method that returns a PigStats object:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.apache.pig;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; class PigRunner {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; PigStats run(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {...}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The PigStats class will include the following methods:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isSuccessful() 

&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; getReturnCode() &lt;span class=&quot;code-comment&quot;&gt;// a list of &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; codes will be defined in PigRunner
&lt;/span&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getErrorMessage()

&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; getErrorCode() &lt;span class=&quot;code-comment&quot;&gt;// PigException&apos;s error code
&lt;/span&gt;
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; getNumberJobs() &lt;span class=&quot;code-comment&quot;&gt;// number of MR jobs &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; invocation
&lt;/span&gt;
JobPlan getJobPlan() &lt;span class=&quot;code-comment&quot;&gt;// DAG of MR jobs (a.k.a. an OperatorPlan)
&lt;/span&gt;
List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; getOutputLocations() 

&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; getNumberRecords(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; location) &lt;span class=&quot;code-comment&quot;&gt;// number of records in the given output location
&lt;/span&gt;
&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; getNumberBytes(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; location)  &lt;span class=&quot;code-comment&quot;&gt;// number of bytes in the given location
&lt;/span&gt;
... ... &lt;span class=&quot;code-comment&quot;&gt;// a few more&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;A job in the JobPlan will include these methods:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getAlias() &lt;span class=&quot;code-comment&quot;&gt;// the alias associated with &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; job
&lt;/span&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; getFeature()  &lt;span class=&quot;code-comment&quot;&gt;// the Pig feature associated with &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; job
&lt;/span&gt;
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; getNumberMaps() 

&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; getNumberReduces() 

... ... &lt;span class=&quot;code-comment&quot;&gt;// a few more methods on job statistics retrieved from Hadoop
&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12872737" author="rding" created="Fri, 28 May 2010 01:08:15 +0100"  >&lt;p&gt;This patch implements the proposed API.&lt;/p&gt;</comment>
                            <comment id="12872894" author="hadoopqa" created="Fri, 28 May 2010 09:32:27 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12445727/PIG-1333.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12445727/PIG-1333.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 949057.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 99 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/14/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/14/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12873145" author="hadoopqa" created="Fri, 28 May 2010 21:42:03 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12445786/PIG-1333.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12445786/PIG-1333.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 949057.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 99 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The applied patch generated 147 javac compiler warnings (more than the trunk&apos;s current 139 warnings).&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 395 release audit warnings (more than the trunk&apos;s current 385 warnings).&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/16/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/16/testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/16/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/16/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/16/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/16/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/16/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h1.grid.sp2.yahoo.net/16/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12873161" author="rding" created="Fri, 28 May 2010 23:04:06 +0100"  >&lt;p&gt;The release audit warnings are all html related and can be ignored. The javac warnings are caused by using deprecated classes (such as Hadoop Counters) which can&apos;t be suppressed.&lt;/p&gt;</comment>
                            <comment id="12876105" author="olgan" created="Mon, 7 Jun 2010 02:22:19 +0100"  >&lt;p&gt;Patch looks good. A few comments and questions:&lt;/p&gt;

&lt;p&gt;(1) General comment. This patch is very large and combines multiple different issues that could have been separated into multiple patches to make it easier to review and test&lt;br/&gt;
(2) We are missing script level feature collection. (I see the one at job level.) For each script, we want to collect overall script features such as different operators: join, order by, etc., is it a multiquery, does it have UDF. Also, we would want to know if combiner was used and whether the script spilled but maybe both of those can be at the job level.&lt;br/&gt;
(3) We need to add separate comment to the JIRA marked as documentation that describes PigRunner since it is a new interface that we need to include in 0.8.0 documentation.&lt;br/&gt;
(4) MapReduceLauncher. Why was exception handling and temp store handling code removed?&lt;br/&gt;
(5) OutputStats assumes that location is a path which might not be true for non-file stores.&lt;br/&gt;
(6) ScriptState: There are maps/hashes optimized for enums (&lt;a href=&quot;http://java.sun.com/j2se/1.5.0/docs/api/java/util/EnumMap.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/j2se/1.5.0/docs/api/java/util/EnumMap.html&lt;/a&gt;)&lt;br/&gt;
(7) Why JobStats is derived from an operator?&lt;br/&gt;
(8) Why did JOB_NAME_PREFIX got removed from PigContext?&lt;br/&gt;
(9) Why do we need to synchronize getTemporaryFile?&lt;/p&gt;</comment>
                            <comment id="12876111" author="dvryaboy" created="Mon, 7 Jun 2010 04:15:20 +0100"  >&lt;p&gt;That&apos;s a heck of a patch. I am really looking forward to having this available.&lt;/p&gt;

&lt;p&gt;Not sure you need the map in the PIG_FEATURE enum.  You can get an enum by offset using PIG_FEATURE.values(), so no need for the constructor; you can get a string representation using pigFeature.name() or pigFeature.toString(), so no need for getString(); and you can get the ordinal using pigFeature.ordinal(). Granted, the ordinals are 0-based, but you can just throw in an dummy value for the 0th spot to preserve all the offsets as they are.&lt;/p&gt;

&lt;p&gt;I see that you explicitly pull out the known and enumerated Pig counters. Any reason not to make all other job counters available as well via the same interface?&lt;/p&gt;
</comment>
                            <comment id="12877585" author="rding" created="Thu, 10 Jun 2010 22:42:38 +0100"  >&lt;p&gt;Thanks for reviewing the patch. My comments are inline.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(1) General comment. This patch is very large and combines multiple different issues that could have been separated into multiple patches to make it easier to review and test&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In this patch JobStats and OutputStats replaced the HJob as the return value of execution of a pig script. This results in several deprecated/removed classes. I also go through the unit tests to replace most of the deprecated methods used there and this causes modification of  many test classes. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(2) We are missing script level feature collection. (I see the one at job level.) For each script, we want to collect overall script features such as different operators: join, order by, etc., is it a multiquery, does it have UDF. Also, we would want to know if combiner was used and whether the script spilled but maybe both of those can be at the job level.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;ll add the script level features, in addition to the job level feature. The value of job level feature (pig.job.feature is the key in job xml) will be a string, but the value of script level feature (pig.script.features) will be a bit set represented by a long.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(3) We need to add separate comment to the JIRA marked as documentation that describes PigRunner since it is a new interface that we need to include in 0.8.0 documentation.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Will do.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(4) MapReduceLauncher. Why was exception handling and temp store handling code removed?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Exception handling is still there. Handling of temp stores for failed jobs is moved to JobStats.  &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(5) OutputStats assumes that location is a path which might not be true for non-file stores.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It isn&apos;t necessary to use path in OutputStats (just trying to get a more readable short name for location). I&apos;ll move it.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(6) ScriptState: There are maps/hashes optimized for enums (&lt;a href=&quot;http://java.sun.com/j2se/1.5.0/docs/api/java/util/EnumMap.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/j2se/1.5.0/docs/api/java/util/EnumMap.html&lt;/a&gt;)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Dmitriy also commented on this. I&apos;ll modified the usage of emums based on the comments.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(7) Why JobStats is derived from an operator?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The JobGraph of the script is a derived class from BaseOperatorPlan (in experimental package) whose elements are Operators. JobStats is derived from Operator in order to use the methods on the base class. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(8) Why did JOB_NAME_PREFIX got removed from PigContext?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;JOB_NAME_PREFIX is still there. What is removed is the private member &apos;jobName&apos; which isn&apos;t used in the class and whose getter and setter had been removed long time ago. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;(9) Why do we need to synchronize getTemporaryFile?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;ll remove the synchronize on this method. It was copied from the corresponding deprecated method.&lt;/p&gt;</comment>
                            <comment id="12877588" author="rding" created="Thu, 10 Jun 2010 22:53:46 +0100"  >&lt;p&gt;Thanks Dmitriy for the suggestion on enums. It will simplify the code.&lt;/p&gt;

&lt;p&gt;Right now the job counters we retrieve are&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
MAP_INPUT_RECORDS
MAP_OUTPUT_RECORDS
REDUCE_INPUT_RECORDS
REDUCE_OUTPUT_RECORDS
HDFS_BYTES_WRITTEN
SPILLABLE_MEMORY_MANAGER_SPILL_COUNT
PROACTIVE_SPILL_COUNT
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;plus Pig MultiStore counters.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure we should make all Hadoop counters available through the new API. How useful will it be to the users?  I&apos;m open to suggestions. &lt;/p&gt;</comment>
                            <comment id="12877607" author="rding" created="Thu, 10 Jun 2010 23:39:59 +0100"  >&lt;p&gt;Now I also think this patch is too large &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I&apos;ll break it into two: one patch for this jira that concentrates on implementing the new API, the other patch will address the code cleanup in a different jira. &lt;/p&gt;</comment>
                            <comment id="12877611" author="olgan" created="Thu, 10 Jun 2010 23:48:15 +0100"  >&lt;p&gt;+1 to that! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12878732" author="dvryaboy" created="Mon, 14 Jun 2010 21:30:48 +0100"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m not sure we should make all Hadoop counters available through the new API. How useful will it be to the users? I&apos;m open to suggestions. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Can&apos;t speak for other users, but we use counters quite a bit with Elephant Bird and some internal code for keeping track of timed out service requests, unparsable records, and more. The @MonitoredUDF annotation I proposed in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1427&quot; title=&quot;Monitor and kill runaway UDFs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1427&quot;&gt;&lt;del&gt;PIG-1427&lt;/del&gt;&lt;/a&gt; uses counters to report on runaway udfs that get killed.&lt;/p&gt;

&lt;p&gt;I think the question isn&apos;t so much why would you expose them, as why wouldn&apos;t you expose them...&lt;/p&gt;</comment>
                            <comment id="12878776" author="rding" created="Mon, 14 Jun 2010 23:16:27 +0100"  >&lt;p&gt;Hi Dmitriy, &lt;/p&gt;

&lt;p&gt;Let me try to clarify the requirement: what you are asking for is to have the new API expose the Hadoop counters, such as&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class JobStats {

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Counters getCounters();

    ......

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;so users can get the counter they are interested in. &lt;/p&gt;</comment>
                            <comment id="12878826" author="dvryaboy" created="Tue, 15 Jun 2010 02:57:11 +0100"  >&lt;p&gt;Yup.&lt;/p&gt;</comment>
                            <comment id="12878869" author="hadoopqa" created="Tue, 15 Jun 2010 07:43:44 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12447048/PIG-1333_1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12447048/PIG-1333_1.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 953798.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 11 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 387 release audit warnings (more than the trunk&apos;s current 383 warnings).&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/329/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/329/testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/329/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/329/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/329/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/329/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/329/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/329/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12879046" author="rding" created="Tue, 15 Jun 2010 19:00:58 +0100"  >&lt;p&gt;Hi Dmitriy, &lt;/p&gt;

&lt;p&gt;I added the new method on JobStats class:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class JobStats {

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Counters getHadoopCounters();

    ......
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can you please review the patch? &lt;/p&gt;</comment>
                            <comment id="12880950" author="dvryaboy" created="Mon, 21 Jun 2010 21:38:19 +0100"  >&lt;p&gt;My apologies for the delayed review. &lt;br/&gt;
Overall, looks great.&lt;/p&gt;

&lt;p&gt;A few comments:&lt;/p&gt;

&lt;p&gt;You should add the new visibility annotations to new classes (JobStats should be Public and Evolving, for example). &lt;/p&gt;

&lt;p&gt;Why is MapReduceLauncher suppressing deprecation warning? &lt;/p&gt;

&lt;p&gt;It is currently possible to have cogroup, groupBy, and hashJoin all be true in MapReduceOper as they are independent variabes. I don&apos;t see that happening in the code, but making the three states (+ fourth state, &quot;none&quot;) an enum and storing the enum value in a single variable is more defensive and might save us from potential bugs down the line. This change can be confined to MapReduceOper since you would just have to change the accessor methods slightly.&lt;/p&gt;

&lt;p&gt;Why is MAX_SCRIPT_SIZE so short? Is it an arbitrary number? We produce significantly longer scrips all the time. I assume it&apos;s to save on space; perhaps you can make it controllable by some property? &lt;/p&gt;

&lt;p&gt;In ScriptState, the error message &quot;LOG.warn(&quot;unable to get job predecessors&quot;, e);&quot; should be modified to include information about the job to assist debugging.&lt;/p&gt;

&lt;p&gt;Same class. getAlias method &amp;#8211; perhaps it makes sense to set the alias to a default if you encounter a visitorException?&lt;/p&gt;

&lt;p&gt;I am not very familiar with the visitors, but it looks like normally, PhyPlanVisitor spawns a walker for the internal plans of Filter, CollectedGroup, and so on; this behavior appears to be gone from AliasVisitor. Should it be reproduced in AliasVisitor?&lt;/p&gt;

&lt;p&gt;Just a style thing, but I prefer writing setter methods that return self instead of being void &amp;#8211; that way you can chain them together.&lt;/p&gt;

&lt;p&gt;Everything else looks good.&lt;/p&gt;</comment>
                            <comment id="12881459" author="rding" created="Wed, 23 Jun 2010 00:48:39 +0100"  >&lt;p&gt;New patch to address the review comments.&lt;/p&gt;</comment>
                            <comment id="12881470" author="rding" created="Wed, 23 Jun 2010 01:05:14 +0100"  >&lt;p&gt;A few comments about the comments:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Why is MAX_SCRIPT_SIZE so short? Is it an arbitrary number? We produce significantly longer scrips all the time. I assume it&apos;s to save on space; perhaps you can make it controllable by some property?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is a compromise. Next release of Hadoop will completely fix this problem (no limit on the length of the scripts). Until then, we won&apos;t allow users to change this setting and inadvertently affect Hadoop performance. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I am not very familiar with the visitors, but it looks like normally, PhyPlanVisitor spawns a walker for the internal plans of Filter, CollectedGroup, and so on; this behavior appears to be gone from AliasVisitor. Should it be reproduced in AliasVisitor?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think the top-level aliases are enough to identify the operators. No need to use alias in the inner plans.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Just a style thing, but I prefer writing setter methods that return self instead of being void - that way you can chain them together.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree with you on this. But I also want to be consistent with the style used through out Pig. So I didn&apos;t change the setters. &lt;/p&gt;
</comment>
                            <comment id="12881513" author="dvryaboy" created="Wed, 23 Jun 2010 02:58:40 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12881586" author="hadoopqa" created="Wed, 23 Jun 2010 08:10:20 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12447767/PIG-1333_3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12447767/PIG-1333_3.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 957046.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 11 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    -1 javac.  The applied patch generated 140 javac compiler warnings (more than the trunk&apos;s current 138 warnings).&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 391 release audit warnings (more than the trunk&apos;s current 387 warnings).&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    -1 contrib tests.  The patch failed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/347/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/347/testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/347/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/347/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/347/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/347/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/347/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/347/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12881772" author="rding" created="Wed, 23 Jun 2010 18:28:55 +0100"  >&lt;p&gt;The unit test failures are not related to the patch (l run core tests locally and it&apos;s successful).  Release audit warnings are all html related, and additional javac warnings are due to using a couple of deprecated Hadoop classes.&lt;/p&gt;

&lt;p&gt;I&apos;m going to commit the patch shortly.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12445786" name="PIG-1333.patch" size="299362" author="rding" created="Fri, 28 May 2010 16:38:04 +0100"/>
                            <attachment id="12447048" name="PIG-1333_1.patch" size="188549" author="rding" created="Mon, 14 Jun 2010 19:24:33 +0100"/>
                            <attachment id="12447154" name="PIG-1333_2.patch" size="188725" author="rding" created="Tue, 15 Jun 2010 18:58:32 +0100"/>
                            <attachment id="12447767" name="PIG-1333_3.patch" size="190046" author="rding" created="Wed, 23 Jun 2010 00:48:39 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 20 May 2010 23:33:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164830</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyap8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96401</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>A new API (org.apache.pig.PigRunner) is added that allows users to execute a Pig script within a Java program and gets a PigStats object as a return value.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>documentation</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>