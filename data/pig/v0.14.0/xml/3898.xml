<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:06:35 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3898/PIG-3898.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3898] Refactor PPNL for non-MR execution engine</title>
                <link>https://issues.apache.org/jira/browse/PIG-3898</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Currently, PPNL assumes the MR plan, and thus, it&apos;s not compatible with non-MR execution engine. To support non-MR execution engines, I propose we changed initialPlanNotification() method as follows-&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;from&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void initialPlanNotification(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; scriptId, MROperPlan plan);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;to&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void initialPlanNotification(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; scriptId, OperatorPlan&amp;lt;?&amp;gt; plan);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Since MROperPlan and TezOperPlan are a subclass of OperatorPlan, this method can take both plans. In addition, if we add a new execution engine in the future, it won&apos;t break the interface again as long as we build the operator plan as a subclass of OperatorPlan.&lt;/p&gt;

&lt;p&gt;With this approach, applications such as Ambrose / Lipstick should be able to dynamically cast OperatorPlan to a concrete subclass depending on the ExecType.&lt;/p&gt;

&lt;p&gt;One disadvantage is that this isn&apos;t backward compatible with Pig 0.12 and older. But it only requires minor changes, and backward compatibility will be broken one time only.&lt;/p&gt;

&lt;p&gt;I also considered an alternative approach, for example, adding a new PPNL for Tez. But this approach has two problems.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Pig registers PPNL via the Main function, and right now, only one PPNL can be registered. So having more than one PPNLs requires quite a few code changes in Main, ScriptState, and so on.&lt;/li&gt;
	&lt;li&gt;Multiple PPNL interfaces mean multiple PPNL implementations. This results in more (duplicate) code in applications such as Ambrose / Lipstick.&lt;/li&gt;
&lt;/ol&gt;

</description>
                <environment></environment>
        <key id="12708894">PIG-3898</key>
            <summary>Refactor PPNL for non-MR execution engine</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cheolsoo">Cheolsoo Park</assignee>
                                    <reporter username="cheolsoo">Cheolsoo Park</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Apr 2014 21:06:31 +0100</created>
                <updated>Mon, 7 Jul 2014 19:08:10 +0100</updated>
                            <resolved>Thu, 24 Apr 2014 17:22:27 +0100</resolved>
                                                    <fixVersion>tez-branch</fixVersion>
                    <fixVersion>0.13.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13971931" author="prkommireddi" created="Wed, 16 Apr 2014 21:43:02 +0100"  >&lt;p&gt;I&apos;m a +1 on the first approach. It&apos;s the right thing to do in this case, in terms of method signature having a base Interface rather than an implementation (OperatorPlan vs MROperPlan). PPNL is marked evolving which tells the the compatibility can be broken between minor releases (though not desired). It&apos;s unfortunate that we need to be doing it and users need to adjust, but sooner we make the change the better IMHO.&lt;/p&gt;

&lt;p&gt;Let&apos;s also send out a note to Pig user mailing list in case we all agree to go ahead with approach 1.&lt;/p&gt;</comment>
                            <comment id="13971950" author="rohini" created="Wed, 16 Apr 2014 22:00:45 +0100"  >&lt;p&gt;+1 on first approach. Ambrose and Lipstick are the ones affected. Twitter folks already gave their ok in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3419&quot; title=&quot;Pluggable Execution Engine &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3419&quot;&gt;&lt;del&gt;PIG-3419&lt;/del&gt;&lt;/a&gt; for incompatibility w.r.t Ambrose. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3419?focusedCommentId=13753863&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13753863&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PIG-3419?focusedCommentId=13753863&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13753863&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3419?focusedCommentId=13753912&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13753912&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/PIG-3419?focusedCommentId=13753912&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13753912&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Are there any other known usages of PPNL by others?&lt;/p&gt;</comment>
                            <comment id="13971956" author="prkommireddi" created="Wed, 16 Apr 2014 22:06:10 +0100"  >&lt;p&gt;PPNL is a public interface, so we need to assume it&apos;s used by folks in ways we aren&apos;t aware. We use it at Salesforce. I remember another user having filed a JIRA around an issue with ScriptState that he discovered with the use of PPNL.&lt;/p&gt;</comment>
                            <comment id="13971994" author="prkommireddi" created="Wed, 16 Apr 2014 22:47:16 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cheolsoo&quot; class=&quot;user-hover&quot; rel=&quot;cheolsoo&quot;&gt;Cheolsoo Park&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rohini&quot; class=&quot;user-hover&quot; rel=&quot;rohini&quot;&gt;Rohini Palaniswamy&lt;/a&gt; on second thoughts, do you feel we should use this as an opportunity to not expose OperatorPlan and instead expose a trimmed down version of it? Exposing OperatorPlan itself seems a bit risky (if we ever plan to change things around later).&lt;/p&gt;

&lt;p&gt;Not sure how it affects the downstream users in terms of the extent to which one would need to make changes in PPNL custom impls.&lt;/p&gt;</comment>
                            <comment id="13972142" author="cheolsoo" created="Thu, 17 Apr 2014 01:39:42 +0100"  >&lt;p&gt;Thank you everyone for your comments. I am uploading my wip patches.&lt;/p&gt;

&lt;p&gt;The changes include-&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Update initialPlanNotification() in PPNL as suggested.&lt;/li&gt;
	&lt;li&gt;Move non-MR specific code from MRScriptState to ScriptState. &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3419&quot; title=&quot;Pluggable Execution Engine &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3419&quot;&gt;&lt;del&gt;PIG-3419&lt;/del&gt;&lt;/a&gt; moved too much code to MRScriptState, so I am moving back to ScriptState whatever is applicable to both MR and Tez.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Regarding exposing OperatorPlan in the API, I agree that we should avoid it if possible. But since Ambrose and Lipstick use it heavily, it won&apos;t be easy to take it back at this point. Nevertheless, it&apos;s definitely worth to discuss.&lt;/p&gt;</comment>
                            <comment id="13974335" author="aniket486" created="Fri, 18 Apr 2014 19:27:12 +0100"  >&lt;p&gt;+1 on the change and the patch.&lt;/p&gt;</comment>
                            <comment id="13979903" author="cheolsoo" created="Thu, 24 Apr 2014 17:22:27 +0100"  >&lt;p&gt;Committed to trunk and tez branch.&lt;/p&gt;

&lt;p&gt;Thank you Aniket for the review!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12640561" name="PIG-3898-1-tez.patch" size="53457" author="cheolsoo" created="Thu, 17 Apr 2014 01:39:42 +0100"/>
                            <attachment id="12640560" name="PIG-3898-1-trunk.patch" size="43289" author="cheolsoo" created="Thu, 17 Apr 2014 01:39:42 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Apr 2014 20:43:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>387217</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzok4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>387480</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>