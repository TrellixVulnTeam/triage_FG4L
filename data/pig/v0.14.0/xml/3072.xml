<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:58:24 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3072/PIG-3072.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3072] Pig job reporting negative progress</title>
                <link>https://issues.apache.org/jira/browse/PIG-3072</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Our users pointed out that their jobs reporting negative progress.&lt;/p&gt;

&lt;p&gt;2012-11-02 21:43:11,538 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO &lt;br/&gt;
org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;-795% complete&lt;br/&gt;
...&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;(due to TFileRecordReader)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12618627">PIG-3072</key>
            <summary>Pig job reporting negative progress</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knoguchi">Koji Noguchi</assignee>
                                    <reporter username="knoguchi">Koji Noguchi</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Dec 2012 20:22:08 +0000</created>
                <updated>Mon, 14 Oct 2013 17:45:49 +0100</updated>
                            <resolved>Tue, 4 Dec 2012 23:55:36 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.12.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13509032" author="knoguchi" created="Mon, 3 Dec 2012 20:46:17 +0000"  >&lt;p&gt;&apos;pos&apos; inside TFileRecordReader was never updated.  Using fileIn.getPos() instead for reporting progress.&lt;/p&gt;</comment>
                            <comment id="13509304" author="rohini" created="Mon, 3 Dec 2012 23:05:19 +0000"  >&lt;p&gt;Just a minor comment. Can we create the &quot;basic.tfile&quot; using Util.createTempFileDelOnExit(). Tests clash because of hardcoded file paths and it is hard to run unit tests for different versions at the same time. At least for newer tests we should try to avoid using hardcoded paths. &lt;/p&gt;</comment>
                            <comment id="13509334" author="knoguchi" created="Mon, 3 Dec 2012 23:42:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can we create the &quot;basic.tfile&quot; using Util.createTempFileDelOnExit().&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That makes sense. &lt;br/&gt;
Since Util.createTempFileDelOnExit() creates an empty file and TFileRecordWriter was failing with &quot;File already exists&quot; error, I added an extra delete before passing the path to TFileRecordWriter.&lt;/p&gt;</comment>
                            <comment id="13509345" author="rohini" created="Mon, 3 Dec 2012 23:54:13 +0000"  >&lt;p&gt;+1. Will commit soon.&lt;/p&gt;</comment>
                            <comment id="13509500" author="knoguchi" created="Tue, 4 Dec 2012 04:36:59 +0000"  >&lt;p&gt;(Minor changes to previous v02 patch.)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Added comment in TFileRecordReader.  &quot;//TFile.Reader reads into buffer so, progress is updated in chunks.&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Printing out progress to stderr.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Changed loop size from 1000 to 25000 so that at least progress changes once for codec=&apos;none&apos;. 66%-&amp;gt;99%  For &apos;gz&apos;, it immediately jumps to 99% with this small tfile.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Added one extra check to make sure value is being read by recordReader. (curval == LOOP_SIZE)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13509920" author="rohini" created="Tue, 4 Dec 2012 18:18:57 +0000"  >&lt;p&gt;Koji,&lt;br/&gt;
   Can you use HadoopShims to create the TaskAttemptContext in your test. The test fails to compile with H23.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; [javac] /apache/pig/trunk/test/org/apache/pig/test/TestTmpFileCompression.java:369: org.apache.hadoop.mapreduce.TaskAttemptContext is abstract; cannot be instantiated
    [javac]                             new TaskAttemptContext(conf, new TaskAttemptID()));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13509989" author="knoguchi" created="Tue, 4 Dec 2012 20:15:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can you use HadoopShims to create the TaskAttemptContext in your test. The test fails to compile with H23.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks Rohini.  Uploading another patch with your suggestion.  &lt;/p&gt;

&lt;p&gt;Ran both&lt;br/&gt;
$ ant clean test -Dtestcase=TestTmpFileCompression&lt;br/&gt;
$ ant -Dhadoopversion=23 clean test -Dtestcase=TestTmpFileCompression&lt;/p&gt;</comment>
                            <comment id="13510137" author="rohini" created="Tue, 4 Dec 2012 23:56:07 +0000"  >&lt;p&gt;Committed to trunk. Thanks Koji.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12555826" name="pig-3072-v01.txt" size="4382" author="knoguchi" created="Mon, 3 Dec 2012 20:46:17 +0000"/>
                            <attachment id="12555852" name="pig-3072-v02.txt" size="4517" author="knoguchi" created="Mon, 3 Dec 2012 23:42:36 +0000"/>
                            <attachment id="12555893" name="pig-3072-v03.txt" size="4931" author="knoguchi" created="Tue, 4 Dec 2012 04:36:59 +0000"/>
                            <attachment id="12555980" name="pig-3072-v04.txt" size="5212" author="knoguchi" created="Tue, 4 Dec 2012 20:15:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 3 Dec 2012 23:05:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>295787</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyxsjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>231133</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>