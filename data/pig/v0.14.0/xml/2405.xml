<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:54:08 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2405/PIG-2405.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2405] svn tags/release-0.9.1: some unit test case failed with open JDK</title>
                <link>https://issues.apache.org/jira/browse/PIG-2405</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test org.apache.pig.test.TestDataModel FAILED&lt;br/&gt;
Testcase: testTupleToString took 0.004 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
toString expected:&amp;lt;...ad a little lamb)},[&lt;a href=&quot;#world,goodbye#all&quot;&gt;hello#world,goodbye#all&lt;/a&gt;],42,5000000000,3.14...&amp;gt; but was:&amp;lt;...ad a little lamb)},[&lt;a href=&quot;#all,hello#world&quot;&gt;goodbye#all,hello#world&lt;/a&gt;],42,5000000000,3.14...&amp;gt;&lt;br/&gt;
junit.framework.ComparisonFailure: toString expected:&amp;lt;...ad a little lamb)},[&lt;a href=&quot;#world,goodbye#all&quot;&gt;hello#world,goodbye#all&lt;/a&gt;],42,5000000000,3.14...&amp;gt; but was:&amp;lt;...ad a little lamb)},[&lt;a href=&quot;#all,hello#world&quot;&gt;goodbye#all,hello#world&lt;/a&gt;],42,5000000000,3.14...&amp;gt;&lt;br/&gt;
         at org.apache.pig.test.TestDataModel.testTupleToString(TestDataModel.java:269&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test org.apache.pig.test.TestHBaseStorage FAILED&lt;br/&gt;
Tests run: 18, Failures: 0, Errors: 12, Time elapsed: 188.612 sec&lt;/p&gt;

&lt;p&gt;Testcase: testHeterogeneousScans took 0.018 sec&lt;br/&gt;
        Caused an ERROR&lt;br/&gt;
java.io.FileNotFoundException: /root/pigtest/conf/hadoop-site.xml (Too many open files)&lt;br/&gt;
java.lang.RuntimeException: java.io.FileNotFoundException: /root/pigtest/conf/hadoop-site.xml (Too many open files)&lt;br/&gt;
        at org.apache.hadoop.conf.Configuration.loadResource(Configuration.java:1162)&lt;br/&gt;
        at org.apache.hadoop.conf.Configuration.loadResources(Configuration.java:1035)&lt;br/&gt;
        at org.apache.hadoop.conf.Configuration.getProps(Configuration.java:980)&lt;br/&gt;
        at org.apache.hadoop.conf.Configuration.get(Configuration.java:436)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.&amp;lt;init&amp;gt;(HConnectionManager.java:271)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HConnectionManager.getConnection(HConnectionManager.java:155)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:167)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:130)&lt;br/&gt;
        at org.apache.pig.test.TestHBaseStorage.prepareTable(TestHBaseStorage.java:809)&lt;br/&gt;
        at org.apache.pig.test.TestHBaseStorage.testHeterogeneousScans(TestHBaseStorage.java:741)&lt;br/&gt;
Caused by: java.io.FileNotFoundException: /root/pigtest/conf/hadoop-site.xml (Too many open files)&lt;br/&gt;
        at java.io.FileInputStream.&amp;lt;init&amp;gt;(FileInputStream.java:112)&lt;br/&gt;
        at java.io.FileInputStream.&amp;lt;init&amp;gt;(FileInputStream.java:72)&lt;br/&gt;
        at sun.net.www.protocol.file.FileURLConnection.connect(FileURLConnection.java:70)&lt;br/&gt;
        at sun.net.www.protocol.file.FileURLConnection.getInputStream(FileURLConnection.java:161)&lt;br/&gt;
        at org.apache.xerces.impl.XMLEntityManager.setupCurrentEntity(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.impl.XMLVersionDetector.determineDocVersion(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.parsers.DOMParser.parse(Unknown Source)&lt;br/&gt;
        at org.apache.xerces.jaxp.DocumentBuilderImpl.parse(Unknown Source)&lt;br/&gt;
        at javax.xml.parsers.DocumentBuilder.parse(Unknown Source)&lt;br/&gt;
        at org.apache.hadoop.conf.Configuration.loadResource(Configuration.java:1079)&lt;/p&gt;

&lt;p&gt;        Caused an ERROR&lt;br/&gt;
Could not resolve the DNS name of hostname:39611&lt;br/&gt;
java.lang.IllegalArgumentException: Could not resolve the DNS name of hostname:39611&lt;br/&gt;
        at org.apache.hadoop.hbase.HServerAddress.checkBindAddressCanBeResolved(HServerAddress.java:105)&lt;br/&gt;
        at org.apache.hadoop.hbase.HServerAddress.&amp;lt;init&amp;gt;(HServerAddress.java:66)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegionInMeta(HConnectionManager.java:755)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:590)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HConnectionManager$HConnectionImplementation.locateRegion(HConnectionManager.java:555)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:171)&lt;br/&gt;
        at org.apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:145)&lt;br/&gt;
        at org.apache.pig.test.TestHBaseStorage.deleteAllRows(TestHBaseStorage.java:120)&lt;br/&gt;
        at org.apache.pig.test.TestHBaseStorage.tearDown(TestHBaseStorage.java:112)&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test org.apache.pig.test.TestMRCompiler FAILED&lt;br/&gt;
Testcase: testSortUDF1 took 0.045 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
null expected:&amp;lt;...---MapReduce(20,SUM,&lt;span class=&quot;error&quot;&gt;&amp;#91;COUNT,TestMRCompiler$WeirdComparator&amp;#93;&lt;/span&gt;) - -18:&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  ...&amp;gt; but was:&amp;lt;...---MapReduce(20,SUM,&lt;span class=&quot;error&quot;&gt;&amp;#91;TestMRCompiler$WeirdComparator,COUNT&amp;#93;&lt;/span&gt;) - -18:&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  ...&amp;gt;&lt;br/&gt;
junit.framework.ComparisonFailure: null expected:&amp;lt;...---MapReduce(20,SUM,&lt;span class=&quot;error&quot;&gt;&amp;#91;COUNT,TestMRCompiler$WeirdComparator&amp;#93;&lt;/span&gt;) - -18:&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  ...&amp;gt; but was:&amp;lt;...---MapReduce(20,SUM,&lt;span class=&quot;error&quot;&gt;&amp;#91;TestMRCompiler$WeirdComparator,COUNT&amp;#93;&lt;/span&gt;) - -18:&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  ...&amp;gt;&lt;br/&gt;
        at org.apache.pig.test.TestMRCompiler.run(TestMRCompiler.java:1080)&lt;br/&gt;
        at org.apache.pig.test.TestMRCompiler.testSortUDF1(TestMRCompiler.java:791&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test org.apache.pig.test.TestNewPlanLogToPhyTranslationVisitor FAILED&lt;br/&gt;
(1)&lt;br/&gt;
Testcase: testSimplePlan took 0.675 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
expected:&amp;lt;class org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject&amp;gt; but was:&amp;lt;class org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.ConstantExpression&amp;gt;&lt;br/&gt;
junit.framework.AssertionFailedError: expected:&amp;lt;class org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.POProject&amp;gt; but was:&amp;lt;class org.apache.pig.backend.hadoop.executionengine.physicalLayer.expressionOperators.ConstantExpression&amp;gt;&lt;br/&gt;
        at org.apache.pig.test.TestNewPlanLogToPhyTranslationVisitor.testSimplePlan(TestNewPlanLogToPhyTranslationVisitor.java:127)&lt;br/&gt;
(2)&lt;br/&gt;
Testcase: testJoinPlan took 0.064 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
expected:&amp;lt;0&amp;gt; but was:&amp;lt;1&amp;gt;&lt;br/&gt;
junit.framework.AssertionFailedError: expected:&amp;lt;0&amp;gt; but was:&amp;lt;1&amp;gt;&lt;br/&gt;
        at org.apache.pig.test.TestNewPlanLogToPhyTranslationVisitor.testJoinPlan(TestNewPlanLogToPhyTranslationVisitor.java:158)&lt;br/&gt;
(3)&lt;br/&gt;
Testcase: testMultiStore took 0.041 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
expected:&amp;lt;0&amp;gt; but was:&amp;lt;1&amp;gt;&lt;br/&gt;
junit.framework.AssertionFailedError: expected:&amp;lt;0&amp;gt; but was:&amp;lt;1&amp;gt;&lt;br/&gt;
        at org.apache.pig.test.TestNewPlanLogToPhyTranslationVisitor.testMultiStore(TestNewPlanLogToPhyTranslationVisitor.java:239)&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test org.apache.pig.test.TestPruneColumn FAILED&lt;br/&gt;
(1)&lt;br/&gt;
Testcase: testMapKey2 took 7.1 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
null&lt;br/&gt;
junit.framework.AssertionFailedError: null&lt;br/&gt;
        at org.apache.pig.test.TestPruneColumn.testMapKey2(TestPruneColumn.java:1206)&lt;br/&gt;
(2)&lt;br/&gt;
Testcase: testMapKey3 took 7.088 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
null&lt;br/&gt;
junit.framework.AssertionFailedError: null&lt;br/&gt;
        at org.apache.pig.test.TestPruneColumn.testMapKey3(TestPruneColumn.java:1222)&lt;br/&gt;
(3)&lt;br/&gt;
Testcase: testMapKeyInSplit1 took 7.1 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
null&lt;br/&gt;
junit.framework.AssertionFailedError: null&lt;br/&gt;
        at org.apache.pig.test.TestPruneColumn.testMapKeyInSplit1(TestPruneColumn.java:1296)&lt;br/&gt;
(4)&lt;br/&gt;
Testcase: testSharedSchemaObject took 7.1 sec&lt;br/&gt;
        FAILED&lt;br/&gt;
null&lt;br/&gt;
junit.framework.AssertionFailedError: null&lt;br/&gt;
        at org.apache.pig.test.TestPruneColumn.testSharedSchemaObject(TestPruneColumn.java:1619)&lt;/p&gt;</description>
                <environment>&lt;p&gt;ant-1.8.2&lt;br/&gt;
open jdk: 1.6&lt;/p&gt;</environment>
        <key id="12534181">PIG-2405</key>
            <summary>svn tags/release-0.9.1: some unit test case failed with open JDK</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fang fang chen">fang fang chen</assignee>
                                    <reporter username="fang fang chen">fang fang chen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Dec 2011 13:01:25 +0000</created>
                <updated>Fri, 22 Feb 2013 04:53:44 +0000</updated>
                            <resolved>Thu, 8 Nov 2012 04:48:16 +0000</resolved>
                                    <version>0.9.1</version>
                                    <fixVersion>0.11</fixVersion>
                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13281361" author="fang fang chen" created="Wed, 23 May 2012 03:24:33 +0100"  >&lt;p&gt;Before testing pig UT, we should increase &quot;max user processes&quot; and &quot;open files&quot; variables by &quot;ulimit&quot;. This is workaround for &quot;Too many files&quot; error.&lt;/p&gt;</comment>
                            <comment id="13281364" author="fang fang chen" created="Wed, 23 May 2012 03:26:25 +0100"  >&lt;p&gt;The left failures are caused by HashMap. The outputs in open source JDK are also correct.&lt;/p&gt;</comment>
                            <comment id="13281453" author="daijy" created="Wed, 23 May 2012 09:21:46 +0100"  >&lt;p&gt;I am sure this is the cause for some unit test failures for OpenJDK and Sun JDK 1.7. Would you like to submit a patch?&lt;/p&gt;</comment>
                            <comment id="13281461" author="fang fang chen" created="Wed, 23 May 2012 09:46:53 +0100"  >&lt;p&gt;Will try my best to fix this when available.&lt;/p&gt;</comment>
                            <comment id="13454741" author="fang fang chen" created="Thu, 13 Sep 2012 09:47:11 +0100"  >&lt;p&gt;Current all UT passed.&lt;br/&gt;
2405_1.patch is for TestDataModel, TestNewPlanLogToPhyTranslationVisitor, TestMRCompiler  &lt;br/&gt;
2405_2.patch is for TestPruneColumn&lt;/p&gt;</comment>
                            <comment id="13454742" author="fang fang chen" created="Thu, 13 Sep 2012 09:50:08 +0100"  >&lt;p&gt;Patch files are based on pig-trunk.&lt;/p&gt;</comment>
                            <comment id="13479352" author="lrangel" created="Thu, 18 Oct 2012 21:59:57 +0100"  >&lt;p&gt;in TestDataModel, the underlying problem is using an order-independent structure in an order-dependent test. What about keeping it simple and removing the HashMap from the Tuple, instead of replacing it with a LinkedHashMap?&lt;/p&gt;</comment>
                            <comment id="13490419" author="fang fang chen" created="Mon, 5 Nov 2012 02:50:25 +0000"  >&lt;p&gt;This patch is for branch 0.11.&lt;/p&gt;</comment>
                            <comment id="13490474" author="cheolsoo" created="Mon, 5 Nov 2012 06:33:20 +0000"  >&lt;p&gt;Hi Fangfang,&lt;/p&gt;

&lt;p&gt;I ran the test cases that you mentioned (TestDataModel, TestNewPlanLogToPhyTranslationVisitor, TestMRCompiler, and TestPruneColumn) with trunk using OpenJDK 1.6. But I cannot reproduce the failures. Can you verify that you still see these failures with the current trunk, or is there anything that I have to do to reproduce them?&lt;/p&gt;

&lt;p&gt;I tested with&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1405587&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;revision 1405587&lt;/a&gt;.&lt;/li&gt;
	&lt;li&gt;java version &quot;1.6.0_24&quot;&lt;br/&gt;
OpenJDK Runtime Environment (IcedTea6 1.11.5) (6b24-1.11.5-0ubuntu1~12.04.1)&lt;br/&gt;
OpenJDK 64-Bit Server VM (build 20.0-b12, mixed mode)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13490488" author="fang fang chen" created="Mon, 5 Nov 2012 07:41:45 +0000"  >&lt;p&gt;Hi Cheolsoo Park,&lt;/p&gt;

&lt;p&gt;With current trunk/0.11 branch, I still encounter output order problem to TestDataModel, TestMRCompiler, and TestPruneColumn with OpenSource JDK, and did not with TestNewPlanLogToPhyTranslationVisitor. Seems this UT has been modified a lot.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

</comment>
                            <comment id="13490823" author="cheolsoo" created="Mon, 5 Nov 2012 18:53:07 +0000"  >&lt;p&gt;Hi Fangfang,&lt;/p&gt;

&lt;p&gt;Thank for the clarification. Your changes seem reasonable, but I have a few comments as below.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Please remove tabs.&lt;/li&gt;
	&lt;li&gt;Please use Unix newline chars (i.e. no CRs).&lt;/li&gt;
	&lt;li&gt;Regarding TestPruneColumn, can&apos;t we use reg. exp. instead of sorting log messages? If I am not mistaken, the sortLogMessages() method is added to sort entries inside the &quot;[ ]&quot;. But the same can be done by reg. exp. For example, the following pattern will match all &lt;span class=&quot;error&quot;&gt;&amp;#91;key1,key2&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;key2,key1&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;key1, key2&amp;#93;&lt;/span&gt;, and &lt;span class=&quot;error&quot;&gt;&amp;#91;key2, key1&amp;#93;&lt;/span&gt;. I think that this is simpler. Do you agree?
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;.*\\[((key2,[ ]?key1)|(key1,[ ]?key2))\\]&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Regarding TestMRCompiler, I would prefer to fix the test rather than changing the code like Rohini commented in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2908&quot; title=&quot;Fix unit tests to work with jdk7&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2908&quot;&gt;&lt;del&gt;PIG-2908&lt;/del&gt;&lt;/a&gt;. But I don&apos;t have a better suggestion, so I won&apos;t disagree with your solution.
&lt;blockquote&gt;&lt;p&gt; Fang has solved it by changing it to a LinkedHashMap in MapReduceOper.java and OperatorPlan.java. I have just modified tests to sort the entrySet results and then assert. If LinkedHashMap approach is preferred, I can remove TestNewPlanLogToPhyTranslationVisitor from this patch. But in general, would prefer not changing code for tests to work.&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Can you please update the patch and upload it to the RB?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13490859" author="rohini" created="Mon, 5 Nov 2012 19:41:13 +0000"  >&lt;p&gt;I think we should avoid changing to LinkedHashMap. Recently, for a different project for test result comparison where the order was required we moved from LinkedHashMap to TreeMap because the order of insertion into LinkedHashMap was different in jdk7 and LinkedHashMap did not work because of that to compare golden files. That might not be the case here because we insert iterating over an array. But would still prefer sorting the test results when comparing instead of changing code to use LinkedHashMap or TreeMap. &lt;/p&gt;</comment>
                            <comment id="13490863" author="cheolsoo" created="Mon, 5 Nov 2012 19:50:31 +0000"  >&lt;p&gt;Thanks Rohini for your comment. Sure, agreed. But I don&apos;t really have a better suggestion on how to fix TestMRCompiler otherwise. I am open to better suggestions.&lt;/p&gt;</comment>
                            <comment id="13491249" author="fang fang chen" created="Tue, 6 Nov 2012 06:42:15 +0000"  >&lt;p&gt;For 0.11 branch.&lt;/p&gt;</comment>
                            <comment id="13491251" author="fang fang chen" created="Tue, 6 Nov 2012 06:42:50 +0000"  >&lt;p&gt;For trunk branch.&lt;/p&gt;</comment>
                            <comment id="13491253" author="fang fang chen" created="Tue, 6 Nov 2012 06:45:23 +0000"  >&lt;p&gt;Hi Cheolsoo,&lt;/p&gt;

&lt;p&gt;Thanks for your review.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;You are right, the sortLogMessages() method is sorting the output with some spacial order.&lt;/li&gt;
	&lt;li&gt;Actually, I though about to fix by using reg. exp. as which is much more simpler. The reason of not use it is we need to do the same steps to all related test cases(current 4 tests). In future, if we need to add new tests, the same action would also be needed.&lt;/li&gt;
	&lt;li&gt;Besides, the reg. exp. will be too complex when there are too many items in [], like:&lt;br/&gt;
&quot;Map key required for raw: $0-&amp;gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;cm_serve_id, cm_serve_timestamp_ms, p_url, source, type&amp;#93;&lt;/span&gt;&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So I insist the original fix. Do you agree? Please let me know if I miss anything. Thanks.&lt;br/&gt;
I regenerated the patch files by following &quot;how to contribute&quot; steps, and attach them at &quot;Attachments&quot;. Could you please tell what is &quot;RB&quot;? Please help load them to RB and let me know if modifications are needed. Thanks&lt;/p&gt;</comment>
                            <comment id="13491255" author="fang fang chen" created="Tue, 6 Nov 2012 06:49:31 +0000"  >&lt;p&gt;BTW, following is the test-patch result, and the failure is not caused by the patches. There are  &lt;span class=&quot;error&quot;&gt;&amp;#91;javadoc&amp;#93;&lt;/span&gt; 38 warnings in original trunk branch. I will open a JIRA for this.&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; -1 overall.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 tests included.  The patch appears to include 12 new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 javadoc.  The javadoc tool appears to have generated 1 warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;
</comment>
                            <comment id="13491261" author="cheolsoo" created="Tue, 6 Nov 2012 07:02:08 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;RB is review board: &lt;a href=&quot;https://reviews.apache.org&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;I still see tabs in your patch. Please use 4 spaces instead.&lt;/li&gt;
	&lt;li&gt;OK, let&apos;s sort log messages then.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;But can you please comment on Rohini&apos;s comment? She doesn&apos;t seem to agree with replacing HashMap with LinkedHashMap in &lt;tt&gt;MapReduceOper.java&lt;/tt&gt; and &lt;tt&gt;OperatorPlan.java&lt;/tt&gt;. I understand that you can&apos;t sort the result to fix TestMRCompiler. But I also agree with Rohini that we should avoid modifying code if possible. Unfortunately, I don&apos;t really have a better idea.&lt;/p&gt;</comment>
                            <comment id="13491298" author="fang fang chen" created="Tue, 6 Nov 2012 08:09:51 +0000"  >&lt;p&gt;Agree with you and Rohini that we should avoid modifying core code.&lt;br/&gt;
Will generate new patches based via sorting outputs.&lt;/p&gt;</comment>
                            <comment id="13491303" author="fang fang chen" created="Tue, 6 Nov 2012 08:15:22 +0000"  >&lt;p&gt;Yes, you are right. We can not sort the output&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Maybe we can generate two kinds of golden files. Any concern?&lt;/p&gt;</comment>
                            <comment id="13491322" author="fang fang chen" created="Tue, 6 Nov 2012 08:51:24 +0000"  >&lt;p&gt;Update patches: remove tabs.&lt;/p&gt;</comment>
                            <comment id="13491394" author="fang fang chen" created="Tue, 6 Nov 2012 11:19:36 +0000"  >&lt;p&gt;Hi Rohini and Cheolsoo,&lt;/p&gt;

&lt;p&gt;TestMRCompiler is fixed by sorting UDFs in this class. Remove all the LinkedHash... change set now. This patch works for both 0.11 and trunk branch.&lt;br/&gt;
Current change set should be OK. Please help review. &lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13491420" author="fang fang chen" created="Tue, 6 Nov 2012 12:43:03 +0000"  >&lt;p&gt;Loaded the patch to RB:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/7898/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/7898/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13492696" author="rohini" created="Wed, 7 Nov 2012 21:03:52 +0000"  >&lt;p&gt;+1 from me. Actually did not realize that TestMRCompiler case was more complicated until I saw Cheolsoo&apos;s comment that he does not have a better suggestion. After taking a deeper look, I couldn&apos;t think of one too without changing src code. This one is a pretty good solution. Thanks for fixing this Fang. I will let Cheolsoo take a final look and commit because he has been working with you so far.&lt;/p&gt;</comment>
                            <comment id="13492729" author="cheolsoo" created="Wed, 7 Nov 2012 21:43:34 +0000"  >&lt;p&gt;Hi Fangfang,&lt;/p&gt;

&lt;p&gt;I was running tests with your new patch in the RB to commit it, but I found that TestPruneColumn.testStream2 fails. I believe that you omitted the following change in your new patch.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;TestPruneColumn.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-        assertTrue(checkLogFileMessage(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]{&lt;span class=&quot;code-quote&quot;&gt;&quot;Map key required &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; event_serve: $0-&amp;gt;[key4, key3]&quot;&lt;/span&gt;, 
-                &lt;span class=&quot;code-quote&quot;&gt;&quot;Map key required &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; cm_data_raw: $0-&amp;gt;[key4, key3, key5]&quot;&lt;/span&gt;}));
+        assertTrue(checkLogFileMessage(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]{&lt;span class=&quot;code-quote&quot;&gt;&quot;Map key required &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; event_serve: $0-&amp;gt;[key3, key4]&quot;&lt;/span&gt;, 
+                &lt;span class=&quot;code-quote&quot;&gt;&quot;Map key required &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; cm_data_raw: $0-&amp;gt;[key3, key4, key5]&quot;&lt;/span&gt;}));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can you please upload a new patch to this JIRA? I will commit it as soon as you upload a new patch.&lt;/p&gt;

&lt;p&gt;I also have a super minor comment. This is just a suggestion, so I won&apos;t insist. I found that you replaced &lt;tt&gt;assertEquals&lt;/tt&gt; with &lt;tt&gt;assertTrue&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;TestPruneColumn.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;([2#1,1#1])&quot;&lt;/span&gt;, t.toString());
+        assertTrue(TestHelper.sortString(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\[(.*)\\]&quot;&lt;/span&gt;, t.toString(), &lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;)
+                .equals(&lt;span class=&quot;code-quote&quot;&gt;&quot;([1#1, 2#1])&quot;&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can you please not change assertEquals to assertTrue? We made a good amount of effort to modernize test code in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3006&quot; title=&quot;Modernize a chunk of the tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3006&quot;&gt;&lt;del&gt;PIG-3006&lt;/del&gt;&lt;/a&gt;, and this was one of patterns that we fixed.&lt;/p&gt;

&lt;p&gt;Thanks for your patience!&lt;/p&gt;</comment>
                            <comment id="13492918" author="fang fang chen" created="Thu, 8 Nov 2012 02:54:50 +0000"  >&lt;p&gt;Hi Cheolsoo,&lt;/p&gt;

&lt;p&gt;Sorry for missing fix. Updated the patch based on your comments. &lt;br/&gt;
Thanks for your comments.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13492951" author="cheolsoo" created="Thu, 8 Nov 2012 04:48:16 +0000"  >&lt;p&gt;Committed to trunk/0.11. Thank you for your contribution, Fagnfang!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12606329">PIG-2908</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12552602" name="PIG-2405-trunk.patch" size="7092" author="fang fang chen" created="Thu, 8 Nov 2012 02:47:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 23 May 2012 08:21:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>219903</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4au7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>58912</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>