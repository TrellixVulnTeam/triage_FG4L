<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:04:03 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1075/PIG-1075.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1075] Error in Cogroup when key fields types don&apos;t match</title>
                <link>https://issues.apache.org/jira/browse/PIG-1075</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;When Cogrouping 2 relations on multiple key fields, pig throws an error if the corresponding types don&apos;t match. &lt;br/&gt;
Consider the following script:-&lt;br/&gt;
A = LOAD &apos;data&apos; USING PigStorage() as (a:chararray, b:int, c:int);&lt;br/&gt;
B = LOAD &apos;data&apos; USING PigStorage() as (a:chararray, b:chararray, c:int);&lt;br/&gt;
C = CoGROUP A BY (a,b,c), B BY (a,b,c);&lt;br/&gt;
D = FOREACH C GENERATE FLATTEN(A), FLATTEN(B);&lt;br/&gt;
describe D;&lt;br/&gt;
dump D;&lt;/p&gt;

&lt;p&gt;The complete stack trace of the error thrown is&lt;/p&gt;

&lt;p&gt;Pig Stack Trace&lt;br/&gt;
---------------&lt;br/&gt;
ERROR 1051: Cannot cast to Unknown&lt;/p&gt;

&lt;p&gt;org.apache.pig.impl.logicalLayer.FrontendException: ERROR 1001: Unable to describe schema for alias D&lt;br/&gt;
        at org.apache.pig.PigServer.dumpSchema(PigServer.java:436)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.processDescribe(GruntParser.java:233)&lt;br/&gt;
        at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:253)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:168)&lt;br/&gt;
        at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:144)&lt;br/&gt;
        at org.apache.pig.tools.grunt.Grunt.exec(Grunt.java:89)&lt;br/&gt;
        at org.apache.pig.Main.main(Main.java:397)&lt;br/&gt;
Caused by: org.apache.pig.impl.plan.PlanValidationException: ERROR 0: An unexpected exception caused the validation to stop&lt;br/&gt;
        at org.apache.pig.impl.plan.PlanValidator.validateSkipCollectException(PlanValidator.java:104)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.validators.TypeCheckingValidator.validate(TypeCheckingValidator.java:40)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.validators.TypeCheckingValidator.validate(TypeCheckingValidator.java:30)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.validators.LogicalPlanValidationExecutor.validate(LogicalPlanValidationExecutor.java:83)&lt;br/&gt;
        at org.apache.pig.PigServer.compileLp(PigServer.java:821)&lt;br/&gt;
        at org.apache.pig.PigServer.dumpSchema(PigServer.java:428)&lt;br/&gt;
        ... 6 more&lt;br/&gt;
Caused by: org.apache.pig.impl.logicalLayer.validators.TypeCheckerException: ERROR 1060: Cannot resolve COGroup output schema&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.validators.TypeCheckingVisitor.visit(TypeCheckingVisitor.java:2463)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.LOCogroup.visit(LOCogroup.java:372)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.LOCogroup.visit(LOCogroup.java:45)&lt;br/&gt;
        at org.apache.pig.impl.plan.DependencyOrderWalker.walk(DependencyOrderWalker.java:69)&lt;br/&gt;
        at org.apache.pig.impl.plan.PlanVisitor.visit(PlanVisitor.java:51)&lt;br/&gt;
        at org.apache.pig.impl.plan.PlanValidator.validateSkipCollectException(PlanValidator.java:101)&lt;br/&gt;
        ... 11 more&lt;br/&gt;
Caused by: org.apache.pig.impl.logicalLayer.validators.TypeCheckerException: ERROR 1051: Cannot cast to Unknown&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.validators.TypeCheckingVisitor.insertAtomicCastForCOGroupInnerPlan(TypeCheckingVisitor.java:2552)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.validators.TypeCheckingVisitor.visit(TypeCheckingVisitor.java:2451)&lt;br/&gt;
        ... 16 more&lt;/p&gt;

&lt;p&gt;The error message does not help the user in identifying the issue clearly especially if the pig script is large and complex.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12440000">PIG-1075</key>
            <summary>Error in Cogroup when key fields types don&apos;t match</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rding">Richard Ding</assignee>
                                    <reporter username="ankur">Ankur</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Nov 2009 07:01:54 +0000</created>
                <updated>Fri, 14 May 2010 07:45:54 +0100</updated>
                            <resolved>Thu, 17 Dec 2009 00:50:30 +0000</resolved>
                                    <version>0.5.0</version>
                                    <fixVersion>0.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12774222" author="ankur" created="Fri, 6 Nov 2009 07:03:31 +0000"  >&lt;p&gt;Pig should throw an error message that better identifies the cause of the problem.&lt;/p&gt;</comment>
                            <comment id="12790509" author="rding" created="Tue, 15 Dec 2009 01:24:13 +0000"  >&lt;p&gt;This patch moves the error up to the parser and gives a better error message for cogroup statement with incompatible group types:&lt;/p&gt;

&lt;p&gt;Caused by: org.apache.pig.impl.logicalLayer.FrontendException: ERROR 1110: Cogroup column 1 has incompatible types: chararray versus int&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.LOCogroup.getTupleGroupBySchema(LOCogroup.java:499)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.LOCogroup.getSchema(LOCogroup.java:325)&lt;br/&gt;
        at org.apache.pig.impl.logicalLayer.parser.QueryParser.Parse(QueryParser.java:779)&lt;/p&gt;</comment>
                            <comment id="12790951" author="hadoopqa" created="Tue, 15 Dec 2009 21:09:21 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12427991/PIG-1075.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12427991/PIG-1075.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 890596.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/124/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/124/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/124/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/124/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/124/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/124/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12791689" author="olgan" created="Thu, 17 Dec 2009 00:03:31 +0000"  >&lt;p&gt;+1 on the change. will be committing it shortly.&lt;/p&gt;</comment>
                            <comment id="12791708" author="olgan" created="Thu, 17 Dec 2009 00:50:30 +0000"  >&lt;p&gt;patch committed. thanks Richard!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12427991" name="PIG-1075.patch" size="2450" author="rding" created="Tue, 15 Dec 2009 01:24:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 Dec 2009 01:24:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164601</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyam87:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95912</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>