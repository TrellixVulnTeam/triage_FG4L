<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:52:22 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2509/PIG-2509.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2509] Util.getSchemaFromString fails with java.lang.NullPointerException when a tuple in a bag has no name (as when used in MongoStorage UDF)</title>
                <link>https://issues.apache.org/jira/browse/PIG-2509</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The MongoStorage UDF ( &lt;a href=&quot;https://github.com/mongodb/mongo-hadoop&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/mongodb/mongo-hadoop&lt;/a&gt; ) fails on its call to Util.getSchemaFromString when a tuple is not named.  The call succeeds when the tuple is explicitly named.  As tuple naming is optional, this is a bug.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;http://www.mail-archive.com/user%40pig.apache.org/msg04199.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/user%40pig.apache.org/msg04199.html&lt;/a&gt; and &lt;a href=&quot;http://www.mail-archive.com/dev%40pig.apache.org/msg08016.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/dev%40pig.apache.org/msg08016.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This makes me sad &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;No, genetics!&lt;/p&gt;</environment>
        <key id="12541513">PIG-2509</key>
            <summary>Util.getSchemaFromString fails with java.lang.NullPointerException when a tuple in a bag has no name (as when used in MongoStorage UDF)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jcoveney">Jonathan Coveney</assignee>
                                    <reporter username="russell.jurney">Russell Jurney</reporter>
                        <labels>
                            <label>fun</label>
                            <label>happy</label>
                            <label>mongo</label>
                            <label>pants</label>
                            <label>sad</label>
                            <label>udf</label>
                            <label>util</label>
                    </labels>
                <created>Mon, 6 Feb 2012 21:56:06 +0000</created>
                <updated>Wed, 25 Jul 2012 05:04:59 +0100</updated>
                            <resolved>Thu, 1 Mar 2012 23:42:03 +0000</resolved>
                                    <version>0.9.1</version>
                                    <fixVersion>0.10.0</fixVersion>
                    <fixVersion>0.11</fixVersion>
                                    <component>piggybank</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13201658" author="russell.jurney" created="Mon, 6 Feb 2012 22:04:02 +0000"  >&lt;p&gt;See also &lt;a href=&quot;https://jira.mongodb.org/browse/HADOOP-19&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://jira.mongodb.org/browse/HADOOP-19&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13201728" author="russell.jurney" created="Mon, 6 Feb 2012 22:45:37 +0000"  >&lt;p&gt;The offending code that is called is here: class org.apache.pig.newplan.logical.Util&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;    public static LogicalSchema.LogicalFieldSchema translateFieldSchema(Schema.FieldSchema fs) {      &lt;br/&gt;
        LogicalSchema newSchema = null;&lt;br/&gt;
        if (fs.schema!=null) &lt;/p&gt;
{
            newSchema = translateSchema(fs.schema);
        }

&lt;p&gt;        LogicalSchema.LogicalFieldSchema newFs = new LogicalSchema.LogicalFieldSchema(fs.alias, newSchema, fs.type);&lt;br/&gt;
        return newFs;&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;This function translates the new LogicalSchema into old Schema format required&lt;/li&gt;
	&lt;li&gt;by PhysicalOperators&lt;/li&gt;
	&lt;li&gt;@param schema LogicalSchema to be converted to Schema&lt;/li&gt;
	&lt;li&gt;@return Schema that is converted from LogicalSchema&lt;/li&gt;
	&lt;li&gt;@throws FrontendException&lt;br/&gt;
     */&lt;br/&gt;
    public static Schema translateSchema(LogicalSchema schema) {       &lt;br/&gt;
        if (schema == null) 
{
            return null;
        }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;        Schema s2 = new Schema();&lt;br/&gt;
        List&amp;lt;LogicalSchema.LogicalFieldSchema&amp;gt; ll = schema.getFields();&lt;br/&gt;
        for (LogicalSchema.LogicalFieldSchema f: ll) {&lt;br/&gt;
            Schema.FieldSchema f2 = null;&lt;br/&gt;
            try &lt;/p&gt;
{
                f2 = new Schema.FieldSchema(f.alias, translateSchema(f.schema), f.type);
                f2.canonicalName = ((Long)f.uid).toString();
                s2.add(f2);
            }
&lt;p&gt; catch (FrontendException e) {&lt;br/&gt;
            }&lt;br/&gt;
        }&lt;/p&gt;

&lt;p&gt;        return s2;&lt;br/&gt;
    }&lt;/p&gt;</comment>
                            <comment id="13203852" author="jcoveney" created="Wed, 8 Feb 2012 19:05:48 +0000"  >&lt;p&gt;The fix basically just allows a tuple where it is explicitly called &quot;null:&quot; as in the case of &quot;b:&lt;/p&gt;
{null:(a:int)}
&lt;p&gt;&quot;. In such a case, it will just throw out the tuple name, which will make it equivalent to &quot;b:&lt;/p&gt;
{(a:int)}
&lt;p&gt;&quot;. Russell ran it and it worked. Russell, I did change it slightly, so it&apos;d be lovely if you can try it again just to be sure.&lt;/p&gt;

&lt;p&gt;I successfully applied to 0.9 and ran &quot;ant test-commit&quot;, and applied it to 0.10 and 0.11 and ran &quot;ant -Dtestcase=TestSchema test.&quot;&lt;/p&gt;</comment>
                            <comment id="13216641" author="russell.jurney" created="Sun, 26 Feb 2012 05:54:36 +0000"  >&lt;p&gt;I have applied this patch, and have been using it since.  It works.  Tests pass.  Can we resolve and include this in 0.10?&lt;/p&gt;</comment>
                            <comment id="13216642" author="russell.jurney" created="Sun, 26 Feb 2012 05:55:12 +0000"  >&lt;p&gt;Tested. Working well in MongoStorage.&lt;/p&gt;</comment>
                            <comment id="13218396" author="jcoveney" created="Tue, 28 Feb 2012 17:52:07 +0000"  >&lt;p&gt;This was closed incorrectly, and needs to be reviewed and committed&lt;/p&gt;</comment>
                            <comment id="13220488" author="daijy" created="Thu, 1 Mar 2012 23:42:03 +0000"  >&lt;p&gt;Unit test pass. test-patch:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; -1 overall.  &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 tests included.  The patch appears to include 3 new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 javadoc.  The javadoc tool appears to have generated 1 warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 javac.  The applied patch generated 904 javac compiler warnings (more than the trunk&apos;s current 900 warnings).&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 release audit.  The applied patch generated 533 release audit warnings (more than the trunk&apos;s current 530 warnings).&lt;/p&gt;

&lt;p&gt;javac warning is caused by Antlr. javadoc and release audit warning is not related.&lt;/p&gt;

&lt;p&gt;I don&apos;t feel a compelling reason to check it into 0.9 branch. Commit into 0.10/trunk first.&lt;/p&gt;

&lt;p&gt;Thanks Jonathan!&lt;/p&gt;</comment>
                            <comment id="13421989" author="russell.jurney" created="Wed, 25 Jul 2012 05:04:59 +0100"  >&lt;p&gt;MongoStorage is still not working when tuples aren&apos;t named, but as there is no longer a call to Util.getSchemaFromString at all in mongo-hadoop, this problem appears to be unrelated.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12513845" name="PIG-2509-0.patch" size="1558" author="jcoveney" created="Wed, 8 Feb 2012 19:06:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Feb 2012 19:05:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>226800</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaxjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97746</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>