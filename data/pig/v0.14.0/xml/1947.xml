<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:52:40 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1947/PIG-1947.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1947] Incorrect line number is reported during parsing</title>
                <link>https://issues.apache.org/jira/browse/PIG-1947</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;In case of errors in script, Pig parser doesn&apos;t report correct the line number always. For example:&lt;/p&gt;

&lt;p&gt;script:&lt;/p&gt;

&lt;p&gt;A = load &apos;x&apos; as ( u:int, v:chararray );&lt;br/&gt;
sh ls -l;&lt;br/&gt;
B = foreach A generate u + v;&lt;br/&gt;
store B into &apos;y&apos;;&lt;/p&gt;

&lt;p&gt;error reported:&lt;/p&gt;

&lt;p&gt;2011-03-30 17:48:04,649 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1039: &amp;lt;file line.pig, line 2, column 25&amp;gt; (Name: Add Type: int Uid: 7)incompatible types in Add Operator left hand side:Unknown right hand side:Unknown&lt;/p&gt;

&lt;p&gt;Incorrect line number is also reported when a single line contains multiple Pig statement, such as:&lt;br/&gt;
A = load &apos;x&apos; as( u:int, v:chararray); B = foreach A generate u + v;&lt;br/&gt;
store B into &apos;y&apos;;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12502939">PIG-1947</key>
            <summary>Incorrect line number is reported during parsing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="xuefuz">Xuefu Zhang</assignee>
                                    <reporter username="xuefuz">Xuefu Zhang</reporter>
                        <labels>
                    </labels>
                <created>Thu, 31 Mar 2011 01:53:09 +0100</created>
                <updated>Wed, 5 Oct 2011 01:07:37 +0100</updated>
                                            <version>0.9.0</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13014072" author="xuefuz" created="Thu, 31 Mar 2011 18:09:57 +0100"  >&lt;p&gt;There were issues with previous release as well. For instance, for the following query,&lt;/p&gt;

&lt;p&gt;A = load &apos;x&apos; as ( u:int, v:chararray );&lt;br/&gt;
sh ls;&lt;br/&gt;
B = foreach A generate u , v; C = distinct &apos;xxx&apos;;&lt;br/&gt;
store C into &apos;y&apos;;&lt;/p&gt;

&lt;p&gt;The error message:&lt;/p&gt;

&lt;p&gt;2011-03-31 10:02:56,186 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1000: Error during parsing. Encountered &quot; &amp;lt;QUOTEDSTRING&amp;gt; &quot;\&apos;xxx\&apos; &quot;&quot; at line 3, column 14.&lt;br/&gt;
Was expecting one of:&lt;br/&gt;
    &amp;lt;IDENTIFIER&amp;gt; ...&lt;br/&gt;
    &quot;(&quot; ...&lt;br/&gt;
    &quot;(&quot; ...&lt;/p&gt;

&lt;p&gt;While correct line number is reported, &apos;xxx&apos; is nowhere near column 14.&lt;/p&gt;

&lt;p&gt;The point is that we need a better design to handle the error origin as the process of parsing happens in two different parsers.&lt;/p&gt;</comment>
                            <comment id="13014111" author="olgan" created="Thu, 31 Mar 2011 19:12:56 +0100"  >&lt;p&gt;If this is not a regression and if fixing it as we move grunt to antlr would be significantly easier, I am ok delaying this till 10. However, if we can have a short term fix that is easy to implement, I would prefer that rout.&lt;/p&gt;

&lt;p&gt;Main concern is that if users will get an impression that new parser is not any better or even worse while also dealing with inevitable new bugs, 0.9 release will not be very popular.&lt;/p&gt;</comment>
                            <comment id="13014127" author="xuefuz" created="Thu, 31 Mar 2011 19:33:19 +0100"  >&lt;p&gt;The problem is of partly regression (line #) and partly heritage (column #). I think I can put a fix in QueryParser, which may not be perfect but eliminating the need of touching Grunt parser at this time. Then, we can revisit the issue in 0.10.&lt;/p&gt;</comment>
                            <comment id="13014133" author="olgan" created="Thu, 31 Mar 2011 19:41:56 +0100"  >&lt;p&gt;sounds like a good plan!&lt;/p&gt;</comment>
                            <comment id="13014310" author="xuefuz" created="Fri, 1 Apr 2011 00:59:07 +0100"  >&lt;p&gt;Temporary fix for the issue. With this patch, Pig is able to correctly report line/column number for batch processing. For interactive mode, The line number can be wrong, which probably doesn&apos;t matter as user should assume it&apos;s the last line entered, and the column number can be also wrong, which is the same for previous version anyway.&lt;/p&gt;

&lt;p&gt;We shall fully address the issue in the next release when we replace the grunt parser. &lt;/p&gt;</comment>
                            <comment id="13017757" author="xuefuz" created="Sat, 9 Apr 2011 00:50:10 +0100"  >&lt;p&gt;Updated the patch with test case.&lt;br/&gt;
Test-patch run:&lt;/p&gt;

&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; +1 overall.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 tests included.  The patch appears to include 3 new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;</comment>
                            <comment id="13017763" author="thejas" created="Sat, 9 Apr 2011 00:55:29 +0100"  >&lt;p&gt;Looks good. +1&lt;/p&gt;</comment>
                            <comment id="13018019" author="xuefuz" created="Sun, 10 Apr 2011 04:49:04 +0100"  >&lt;p&gt;patch &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1947&quot; title=&quot;Incorrect line number is reported during parsing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1947&quot;&gt;PIG-1947&lt;/a&gt;-2.patch is committed to trunk.&lt;/p&gt;</comment>
                            <comment id="13019928" author="xuefuz" created="Thu, 14 Apr 2011 18:27:35 +0100"  >&lt;p&gt;The issue is partly addressed in 0.9.0. However, fully addressing the issue requires significant work, which puts this case a good candidate to future releases.&lt;/p&gt;</comment>
                            <comment id="13019945" author="olgan" created="Thu, 14 Apr 2011 18:53:18 +0100"  >&lt;p&gt;Can you please specify what cases were addressed and what work is remaning?&lt;/p&gt;</comment>
                            <comment id="13019952" author="xuefuz" created="Thu, 14 Apr 2011 19:07:26 +0100"  >&lt;p&gt;Because currently a user script is parsed by at least two parsers (grunt parser and query parser), the line number is lost or incorrect reported due to a simplistic design. To fully address the problem, the following is required:&lt;/p&gt;

&lt;p&gt;1. Grunt parser needs to be changed to passing more information to query parser about the source location of each line of the query. Right now, only a line number is passed alone.&lt;/p&gt;

&lt;p&gt;2. Query parser needs a more sophisticated design to capture the source location of the script received from grunt parser. Currently, it caches the script lines in a list, which cannot fully recover the locations when query is subsequently parsed.&lt;/p&gt;

&lt;p&gt;3. A clear semantic of line number is to be defined in interactive mode, especially in case of invalid query lines.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12475869" name="PIG-1947-2.patch" size="3292" author="xuefuz" created="Sat, 9 Apr 2011 00:50:10 +0100"/>
                            <attachment id="12475172" name="PIG-1947.patch" size="2033" author="xuefuz" created="Fri, 1 Apr 2011 00:59:07 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 31 Mar 2011 18:12:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46088</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaunz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97279</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>