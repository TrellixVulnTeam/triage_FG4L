<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:04:00 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3046/PIG-3046.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3046] An empty file name in -Dpig.additional.jars throws an error</title>
                <link>https://issues.apache.org/jira/browse/PIG-3046</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;This issue was raised on the user mailing list. To reproduce it, please run the following command in MR mode:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
pig -Dpig.additional.jars=&amp;lt;jar1&amp;gt;::&amp;lt;jar2&amp;gt; &amp;lt;pig script&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As can be seen, I put &lt;tt&gt;::&lt;/tt&gt; in the middle of &lt;tt&gt;-Dpig.additional.jars&lt;/tt&gt;, and this causes the following error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.IllegalArgumentException: Can not create a Path from
an empty string at org.apache.hadoop.fs.Path.checkPathArg(Path.java:82)
at org.apache.hadoop.fs.Path.&amp;lt;init&amp;gt;(Path.java:90)
at org.apache.hadoop.fs.Path.&amp;lt;init&amp;gt;(Path.java:45)
at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler.shipToHDFS(JobControlCompiler.java:1455)
at
org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler.putJarOnClassPathThroughDistributedCache(JobControlCompiler.java:1432)
at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler.getJob(JobControlCompiler.java:508)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Although it&apos;s not too hard to see what&apos;s wrong, it&apos;s not always easy to track down where an empty file name is from. In particular if various environment variables are set in another start-up script, it&apos;s time-consuming to identify the root cause.&lt;/p&gt;

&lt;p&gt;In fact, Pig should just skip an empty file name instead attempts to convert it to a path and throws an exception like this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12615922">PIG-3046</key>
            <summary>An empty file name in -Dpig.additional.jars throws an error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prkommireddi">Prashant Kommireddi</assignee>
                                    <reporter username="cheolsoo">Cheolsoo Park</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Tue, 13 Nov 2012 17:14:58 +0000</created>
                <updated>Mon, 14 Oct 2013 17:46:29 +0100</updated>
                            <resolved>Wed, 14 Nov 2012 17:55:53 +0000</resolved>
                                    <version>0.10.0</version>
                    <version>0.11</version>
                                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13496358" author="mcz" created="Tue, 13 Nov 2012 17:32:38 +0000"  >&lt;p&gt;Also this issue occurs whenever you specify in the -Dpig.additional.jars a directory path instead of the file path. This is quite often happening because its advised on forums to include HIVE_HOME and HADOOP_HOME in the PIG_CLASSPATH which is then passed to  -Dpig.additional.jars.&lt;/p&gt;</comment>
                            <comment id="13496488" author="prkommireddi" created="Tue, 13 Nov 2012 19:56:35 +0000"  >&lt;p&gt;Should pig.additional.jars support globbing, something like &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-Dpig.additonal.jars=/home/pig/jars/*.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or we rather check for jars within if the path is a directory?&lt;br/&gt;
I think Pig already supports globbing via REGISTER.&lt;/p&gt;

&lt;p&gt;I am not sure why we need HIVE_HOME or HADOOP_HOME to be shipped to HDFS, those confs are required only on the client?&lt;/p&gt;</comment>
                            <comment id="13496497" author="cheolsoo" created="Tue, 13 Nov 2012 20:04:29 +0000"  >&lt;p&gt;Hi Prashant,&lt;/p&gt;

&lt;p&gt;You&apos;re probably right that you can workaround this problem in many ways. I opened this jira because it&apos;s trivial to skip an empty string when handling &lt;tt&gt;pig.additional.jars&lt;/tt&gt; in Pig, and that seems to improve usability. Let me know if you think otherwise.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13496514" author="prkommireddi" created="Tue, 13 Nov 2012 20:31:19 +0000"  >&lt;p&gt;Hi Cheolsoo,&lt;/p&gt;

&lt;p&gt;How do you feel about making the quick easy fix on this ticket (I can add a patch soon). And open a new one for adding globbing support?&lt;/p&gt;
</comment>
                            <comment id="13496554" author="cheolsoo" created="Tue, 13 Nov 2012 21:16:46 +0000"  >&lt;p&gt;Sure!&lt;/p&gt;</comment>
                            <comment id="13496605" author="prkommireddi" created="Tue, 13 Nov 2012 22:18:01 +0000"  >&lt;p&gt;Patch contains a fix for empty jar path. This does not handle the case when a user specifies a directory instead of a jar file. We will handle that in a separate JIRA where all jars within a dir can be loaded.&lt;/p&gt;</comment>
                            <comment id="13496616" author="dreambird" created="Tue, 13 Nov 2012 22:27:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=prkommireddi&quot; class=&quot;user-hover&quot; rel=&quot;prkommireddi&quot;&gt;Prashant Kommireddi&lt;/a&gt;, not insist on it, but I think it might be better it is WARN instead of INFO&lt;/p&gt;</comment>
                            <comment id="13496620" author="prkommireddi" created="Tue, 13 Nov 2012 22:30:52 +0000"  >&lt;p&gt;You are right!&lt;/p&gt;</comment>
                            <comment id="13496624" author="dreambird" created="Tue, 13 Nov 2012 22:36:17 +0000"  >&lt;p&gt;also, the patch seems also impact the common REGISTER jar function. I think in registerJar(String name), which already handle this to some extend&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;......
if (!f.canRead()) {
                    int errCode = 4002;
                    String msg = &quot;Can&apos;t read jar file: &quot; + name;
                    throw new FrontendException(msg, errCode, PigException.USER_ENVIRONMENT);
                  }
......
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;our fix should be specifically for -Dpig.additional.jars, should we handle this before it goes to function registerJar(String name) ?&lt;/p&gt;</comment>
                            <comment id="13496635" author="dreambird" created="Tue, 13 Nov 2012 22:48:11 +0000"  >&lt;p&gt;this patch handles it in function addJarsFromProperties()&lt;/p&gt;</comment>
                            <comment id="13496638" author="dreambird" created="Tue, 13 Nov 2012 22:50:03 +0000"  >&lt;p&gt;actually I think even &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3046&quot; title=&quot;An empty file name in -Dpig.additional.jars throws an error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3046&quot;&gt;&lt;del&gt;PIG-3046&lt;/del&gt;&lt;/a&gt;_2.patch is not proper enough. I am working on another patch, thanks.&lt;/p&gt;</comment>
                            <comment id="13496644" author="prkommireddi" created="Tue, 13 Nov 2012 22:59:26 +0000"  >&lt;p&gt;registerJar is the common place where jars are added. It does not make a lot of sense to do it specifically for pig.additional.jars only. A call PigServer.registerJar(&quot;&quot;) is valid and making a change to addJarsFromProperties only would not handle that.&lt;/p&gt;

&lt;p&gt;Also, registerJar(String name) does not handle the case as you have mentioned in the snippet above. If you take a look at the following &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
URL resource = locateJarFromResources(name);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You will notice that &quot;resource&quot; in case of an empty string is not null and if(!f.canRead) loop never gets invoked.&lt;/p&gt;</comment>
                            <comment id="13496902" author="cheolsoo" created="Wed, 14 Nov 2012 06:45:10 +0000"  >&lt;p&gt;+1 for Prashant&apos;s patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3046&quot; title=&quot;An empty file name in -Dpig.additional.jars throws an error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3046&quot;&gt;&lt;del&gt;PIG-3046&lt;/del&gt;&lt;/a&gt;_1.patch).&lt;/p&gt;

&lt;p&gt;I will commit it after running tests.&lt;/p&gt;

&lt;p&gt;@Johnny,&lt;br/&gt;
I think that you misunderstood something. Let me know if you have any questions/concerns.&lt;/p&gt;</comment>
                            <comment id="13496910" author="cheolsoo" created="Wed, 14 Nov 2012 07:02:29 +0000"  >&lt;p&gt;@Prashant,&lt;br/&gt;
Can you make a very small change to your patch? Can you please move your code to after &lt;tt&gt;if(name != null)&lt;/tt&gt; in &lt;tt&gt;registerJar(String name)&lt;/tt&gt;. Since &lt;tt&gt;registerJar(String name)&lt;/tt&gt; is a public method, I think that it&apos;s possible for somebody to call it with a null. Then, a NullPointerException will be thrown.&lt;/p&gt;

&lt;p&gt;Also, is there any reason why you didn&apos;t use &lt;tt&gt;name.isEmpty()&lt;/tt&gt;?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13496915" author="prkommireddi" created="Wed, 14 Nov 2012 07:20:42 +0000"  >&lt;p&gt;Thanks for the review, Cheolsoo. Added a new patch.&lt;/p&gt;</comment>
                            <comment id="13497283" author="cheolsoo" created="Wed, 14 Nov 2012 17:55:54 +0000"  >&lt;p&gt;Committed to trunk. Thanks Prashant!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12553387" name="PIG-3046.patch" size="1014" author="prkommireddi" created="Tue, 13 Nov 2012 22:18:01 +0000"/>
                            <attachment id="12553389" name="PIG-3046_1.patch" size="1014" author="prkommireddi" created="Tue, 13 Nov 2012 22:30:52 +0000"/>
                            <attachment id="12553397" name="PIG-3046_2.patch" size="631" author="dreambird" created="Tue, 13 Nov 2012 22:48:11 +0000"/>
                            <attachment id="12553467" name="PIG-3046_3.patch" size="979" author="prkommireddi" created="Wed, 14 Nov 2012 07:20:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Nov 2012 17:32:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>257502</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hydxg7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>115283</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>