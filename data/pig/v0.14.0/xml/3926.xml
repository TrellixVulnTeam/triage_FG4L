<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:58:58 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3926/PIG-3926.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3926] ROUND_TO function: rounds double/float to fixed number of decimal places</title>
                <link>https://issues.apache.org/jira/browse/PIG-3926</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The too-often used trick of rounding to a fixed number of decimal places by writing &apos;1000 * Math.round(num / 1000.0)&apos; is not only unsightly, it&apos;s numerically imprecise (&lt;a href=&quot;http://stackoverflow.com/a/12684082/41857&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://stackoverflow.com/a/12684082/41857&lt;/a&gt;). The attached patch adds a function to do this.&lt;/p&gt;

&lt;p&gt;ROUND_TO(val, digits) accepts a single float or double value, along with an integer number of digits, and returns the value to that number of decimal places &lt;/p&gt;

&lt;p&gt;Examples:  &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ROUND_TO(3.14159f, 3) -- returns a &lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt; 3.142
ROUND_TO(3.14159d, 0) -- returns a &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; 3.0.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I also added unit tests for ROUND &amp;#8211; there were none before that I could find.&lt;/p&gt;

&lt;p&gt;I don&apos;t know how to write a unit test that the schema correctly routes to FloatRoundTo and DoubleRoundTo &amp;#8211; if the ones I provided are insufficient please point me to a simple example to emulate.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12712735">PIG-3926</key>
            <summary>ROUND_TO function: rounds double/float to fixed number of decimal places</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mrflip">Philip (flip) Kromer</assignee>
                                    <reporter username="mrflip">Philip (flip) Kromer</reporter>
                        <labels>
                            <label>builtin</label>
                            <label>function</label>
                            <label>math</label>
                    </labels>
                <created>Wed, 7 May 2014 02:48:09 +0100</created>
                <updated>Mon, 7 Jul 2014 19:07:50 +0100</updated>
                            <resolved>Sun, 11 May 2014 00:04:28 +0100</resolved>
                                    <version>0.12.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13991470" author="mrflip" created="Wed, 7 May 2014 02:49:08 +0100"  >&lt;p&gt;The first patch adds unit tests for RANDOM; the second adds the flavors of ROUND_TO and tests for same.&lt;/p&gt;</comment>
                            <comment id="13993668" author="cheolsoo" created="Fri, 9 May 2014 17:21:16 +0100"  >&lt;p&gt;+1. I&apos;ll commit it shortly.&lt;/p&gt;</comment>
                            <comment id="13993674" author="cheolsoo" created="Fri, 9 May 2014 17:27:06 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mrflip&quot; class=&quot;user-hover&quot; rel=&quot;mrflip&quot;&gt;Philip (flip) Kromer&lt;/a&gt;, thank you for the contribution! Committed to trunk.&lt;/p&gt;

&lt;p&gt;I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3932&quot; title=&quot;Document ROUND_TO builtin UDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3932&quot;&gt;&lt;del&gt;PIG-3932&lt;/del&gt;&lt;/a&gt; for documentation and assigned it to you. Can you update the built-in function doc please?&lt;/p&gt;</comment>
                            <comment id="13994103" author="mrflip" created="Sat, 10 May 2014 02:34:39 +0100"  >&lt;p&gt;Sure thing!&lt;/p&gt;

&lt;p&gt;Also, the function does not get the skipped-on-null behavior because the second arg is non-null; I&apos;ll fix that in the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3932&quot; title=&quot;Document ROUND_TO builtin UDF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3932&quot;&gt;&lt;del&gt;PIG-3932&lt;/del&gt;&lt;/a&gt; unless you&apos;d rather I re-open.&lt;/p&gt;</comment>
                            <comment id="13994123" author="cheolsoo" created="Sat, 10 May 2014 04:09:54 +0100"  >&lt;p&gt;Please attach the fix as addendum patch here. I&apos;ll commit it. Thanks!&lt;/p&gt;</comment>
                            <comment id="13994165" author="mrflip" created="Sat, 10 May 2014 07:42:22 +0100"  >&lt;ul&gt;
	&lt;li&gt;ROUND_TO returns NULL given a NULL value (rather than failing)&lt;/li&gt;
	&lt;li&gt;It now by default rounds to the nearest neighbor, choosing the &lt;em&gt;even&lt;/em&gt; digit for ties: ROUND_TO(-2.5,1) == -2.0, ROUND_TO(-1.5,1) == -2.0. See &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/java/math/RoundingMode.html#HALF_EVEN:&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://docs.oracle.com/javase/7/docs/api/java/math/RoundingMode.html#HALF_EVEN:&lt;/a&gt; &quot;This is the rounding mode that statistically minimizes cumulative error when applied repeatedly over a sequence of calculations &lt;span class=&quot;error&quot;&gt;&amp;#91;... and&amp;#93;&lt;/span&gt; is analogous to the rounding policy used for float and double arithmetic in Java&quot;&lt;/li&gt;
	&lt;li&gt;You can specify the rounding mode using an optional third parameter, supplying the integer value of one of the rounding modes: &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/api/constant-values.html#java.math&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://docs.oracle.com/javase/7/docs/api/constant-values.html#java.math&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Added more test cases.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13994166" author="mrflip" created="Sat, 10 May 2014 07:43:54 +0100"  >&lt;p&gt;Patch is &lt;b&gt;in addition&lt;/b&gt; to the previous ones: please apply &lt;/p&gt;

&lt;p&gt;1. 0001-Unit-tests-for-ROUND.patch&lt;br/&gt;
2. 0002-ROUND_TO-UDF-safely-rounds-values-to-given-precision.patch&lt;br/&gt;
3. 0001-ROUND_TO-handles-nulls-accepts-rounding-mode.patch&lt;/p&gt;

&lt;p&gt;in that order.&lt;/p&gt;</comment>
                            <comment id="13994323" author="cheolsoo" created="Sun, 11 May 2014 00:04:28 +0100"  >&lt;p&gt;All patches committed to trunk. Note I removed a unused variable &lt;tt&gt;dbl&lt;/tt&gt; in TestBuiltin.java while committing.&lt;/p&gt;

&lt;p&gt;Thank you Philip for the awesome work!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12713335">PIG-3932</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12644252" name="0001-ROUND_TO-handles-nulls-accepts-rounding-mode.patch" size="22716" author="mrflip" created="Sat, 10 May 2014 07:43:54 +0100"/>
                            <attachment id="12643674" name="0001-Unit-tests-for-ROUND.patch" size="1759" author="mrflip" created="Wed, 7 May 2014 02:49:38 +0100"/>
                            <attachment id="12643675" name="0002-ROUND_TO-UDF-safely-rounds-values-to-given-precision.patch" size="13546" author="mrflip" created="Wed, 7 May 2014 02:49:38 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 9 May 2014 16:21:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391051</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzp7hb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391273</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>The ROUND_TO(val, digits[, mode]) function accepts a single float or double value, along with an integer number of digits, and returns the value to that number of decimal places. For example, ROUND_TO(3.14159f, 3) returns 3.142f (a float); ROUND_TO(3.14159d, 0) returns 3.0d (a double); and ROUND_TO(1234.56d, -2) returns 1200d. The optional third argument controls the rounding mode; see the documentation.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>