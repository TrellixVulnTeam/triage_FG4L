<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:56:58 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1218/PIG-1218.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1218] Use distributed cache to store samples</title>
                <link>https://issues.apache.org/jira/browse/PIG-1218</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Currently, in the case of skew join and order by we use sample that is just written to the dfs (not distributed cache) and, as the result, get opened and copied around more than necessary. This impacts query performance and also places unnecesary load on the name node&lt;/p&gt;</description>
                <environment></environment>
        <key id="12455215">PIG-1218</key>
            <summary>Use distributed cache to store samples</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rding">Richard Ding</assignee>
                                    <reporter username="olgan">Olga Natkovich</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Feb 2010 19:22:02 +0000</created>
                <updated>Fri, 14 May 2010 07:46:51 +0100</updated>
                            <resolved>Fri, 19 Feb 2010 23:49:08 +0000</resolved>
                                                    <fixVersion>0.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12829305" author="acmurthy" created="Wed, 3 Feb 2010 22:44:57 +0000"  >&lt;p&gt;I&apos;d also suggest we increase replication factor for the sample-file in HDFS before adding it to the distributed-cache.&lt;/p&gt;</comment>
                            <comment id="12832284" author="rding" created="Wed, 10 Feb 2010 23:19:29 +0000"  >&lt;p&gt;This patch uses Hadoop DistributedCache to cache the sample files used by order by and skewed join, as well as the side files used in FR join.&lt;/p&gt;

&lt;p&gt;When a HDFS file is added to the DistributedCache,  Pig generates a symlink to the file and, at runtime, this symlink is used to open the file  from the local working directory of the task. To avoid symlink colision, instead of using file name, a symlink name is generated by using a combination of the hashcode of the file path and the current timestamp. &lt;/p&gt;

&lt;p&gt;The replication factor for the sample file in HDFS is not changed with this patch. The reasons are that we&apos;re not clear what&apos;s the right factor to increase, and the work to implement the change in Pig is not trivail. &lt;/p&gt;
</comment>
                            <comment id="12832288" author="dvryaboy" created="Wed, 10 Feb 2010 23:29:19 +0000"  >&lt;p&gt;Richard, does this have any implications on the size of relations that can be used for FR Joins? &lt;/p&gt;</comment>
                            <comment id="12832320" author="rding" created="Thu, 11 Feb 2010 00:27:29 +0000"  >&lt;p&gt;There is no hard limit on file size for DistributedCache. The files in the DistributedCache are copied to all nodes before the job starts. So the large files will impact the performance due to the transmission of files to all nodes.&lt;/p&gt;</comment>
                            <comment id="12832401" author="hadoopqa" created="Thu, 11 Feb 2010 07:00:39 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12435515/PIG-1218.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12435515/PIG-1218.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 908324.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/200/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/200/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/200/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/200/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/200/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/200/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12832713" author="olgan" created="Thu, 11 Feb 2010 22:40:29 +0000"  >&lt;p&gt;Looks like this patch is for trunk. Since we are planning to merge LSR branch onto trunk next week, it would be better if this patch directly applied to LSR.&lt;/p&gt;</comment>
                            <comment id="12832718" author="rding" created="Thu, 11 Feb 2010 22:46:58 +0000"  >&lt;p&gt;It makes sense since the merge to the branch isn&apos;t trivial. I&apos;ll do the merge with this jira.&lt;/p&gt;</comment>
                            <comment id="12834593" author="rding" created="Wed, 17 Feb 2010 01:35:09 +0000"  >&lt;p&gt;The second patch is for LSR branch and ready for review.&lt;/p&gt;</comment>
                            <comment id="12834957" author="pkamath" created="Wed, 17 Feb 2010 19:43:00 +0000"  >&lt;p&gt;+1 Patch mostly looks good - couple of comments:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;In a couple of places instead of using Configuration and JobConf based on PigMapReduce.sJobConf, you should create a new Configiuration(false) and new JobConf(false) so we create fresh datastructures without any properties coming from the Map reduce based datastructures.&lt;/li&gt;
	&lt;li&gt;Since partitionFile is no longer used in POPartitionRearrange.java we should remove it.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;You can make these changes and go ahead and commit it if it passes tests&lt;/p&gt;</comment>
                            <comment id="12834960" author="ashutoshc" created="Wed, 17 Feb 2010 19:47:34 +0000"  >&lt;p&gt;On trunk - patch&lt;br/&gt;
In POFRJoin#setUpHashMap()&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
POLoad ld = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; POLoad(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; OperatorKey(&lt;span class=&quot;code-quote&quot;&gt;&quot;Repl File Loader&quot;&lt;/span&gt;, 1L),
                    replFile, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should it be?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 POLoad ld = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; POLoad(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; OperatorKey(&lt;span class=&quot;code-quote&quot;&gt;&quot;Repl File Loader&quot;&lt;/span&gt;, NodeIdGenerator.getGenerator().getNextNodeId(&lt;span class=&quot;code-quote&quot;&gt;&quot;Repl File Loader&quot;&lt;/span&gt;)),
                    replfile, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also following can be moved out of for loop to avoid multiple connect() on pc.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 PigContext pc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PigContext(ExecType.MAPREDUCE, props);                  
            pc.connect();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In jobControlCompiler#setupDistributedCacheForFRJoin()&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FRJoinDistributedCacheVisitor(mro.reducePlan, pigContext, conf)
                .visit();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Do we need this? Isn&apos;t FR Join a map-side join. So, if POFRJoin ends up in mro.reducePlan thats a bug, no?&lt;/p&gt;</comment>
                            <comment id="12835384" author="rding" created="Thu, 18 Feb 2010 20:27:02 +0000"  >&lt;p&gt;Updated the patch to address the comments of Pradeep and Ashutosh.&lt;/p&gt;</comment>
                            <comment id="12835418" author="rding" created="Thu, 18 Feb 2010 21:37:01 +0000"  >&lt;p&gt;The patch 3 includes all of patch 2 plus distributed cache for merge join&apos;s index file (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1079&quot; title=&quot;Modify merge join to use distributed cache to maintain the index&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1079&quot;&gt;&lt;del&gt;PIG-1079&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="12836042" author="pkamath" created="Fri, 19 Feb 2010 23:49:08 +0000"  >&lt;p&gt;Committed patch &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1218&quot; title=&quot;Use distributed cache to store samples&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1218&quot;&gt;&lt;del&gt;PIG-1218&lt;/del&gt;&lt;/a&gt;_2.patch since the merge join changes need to be re-worked and will be handled in a different patch.&lt;/p&gt;

&lt;p&gt;Thanks Richard!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12435515" name="PIG-1218.patch" size="35026" author="rding" created="Wed, 10 Feb 2010 23:19:29 +0000"/>
                            <attachment id="12436243" name="PIG-1218_2.patch" size="29011" author="rding" created="Thu, 18 Feb 2010 20:27:02 +0000"/>
                            <attachment id="12436250" name="PIG-1218_3.patch" size="31266" author="rding" created="Thu, 18 Feb 2010 21:37:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Feb 2010 22:44:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164732</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyanwv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96185</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>