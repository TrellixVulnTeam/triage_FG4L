<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:03:07 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3726/PIG-3726.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3726] Ranking empty records leads to NullPointerException</title>
                <link>https://issues.apache.org/jira/browse/PIG-3726</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;steps to reproduce:&lt;/p&gt;

&lt;p&gt;1) create an empty file on hdfs (e.g. /user/root/test/empty.txt)&lt;br/&gt;
2) execute the following pig script:&lt;/p&gt;

&lt;p&gt;records = LOAD &apos;/user/root/test/empty.txt&apos; AS (Amount: DOUBLE);&lt;br/&gt;
ranked = RANK records BY Amount DESC;&lt;br/&gt;
DUMP ranked;&lt;/p&gt;

&lt;p&gt;3) on console you will get &quot; ERROR org.apache.pig.tools.grunt.Grunt - ERROR 2043: Unexpected error during execution.&quot; and in pig&apos;s logs you will see:&lt;/p&gt;

&lt;p&gt;Pig Stack Trace&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
---------------
ERROR 2043: Unexpected error during execution.

org.apache.pig.impl.logicalLayer.FrontendException: ERROR 1066: Unable to open iterator &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; alias ranked
at org.apache.pig.PigServer.openIterator(PigServer.java:880)
at org.apache.pig.tools.grunt.GruntParser.processDump(GruntParser.java:774)
at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:372)
at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:198)
at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:173)
at org.apache.pig.tools.grunt.Grunt.exec(Grunt.java:84)
at org.apache.pig.Main.run(Main.java:607)
at org.apache.pig.Main.main(Main.java:156)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.hadoop.util.RunJar.main(RunJar.java:212)
Caused by: org.apache.pig.PigException: ERROR 1002: Unable to store alias ranked
at org.apache.pig.PigServer.storeEx(PigServer.java:982)
at org.apache.pig.PigServer.store(PigServer.java:942)
at org.apache.pig.PigServer.openIterator(PigServer.java:855)
... 12 more
Caused by: org.apache.pig.backend.executionengine.ExecException: ERROR 2043: Unexpected error during execution.
at org.apache.pig.PigServer.launchPlan(PigServer.java:1333)
at org.apache.pig.PigServer.executeCompiledLogicalPlan(PigServer.java:1307)
at org.apache.pig.PigServer.storeEx(PigServer.java:978)
... 14 more
Caused by: java.lang.RuntimeException: Error to read counters into Rank operation counterSize 0
at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler.saveCounters(JobControlCompiler.java:386)
at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler.updateMROpPlan(JobControlCompiler.java:332)
at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher.launchPig(MapReduceLauncher.java:387)
at org.apache.pig.PigServer.launchPlan(PigServer.java:1322)
... 16 more
Caused by: java.lang.NullPointerException
at org.apache.hadoop.mapreduce.counters.Limits.filterName(Limits.java:44)
at org.apache.hadoop.mapreduce.counters.Limits.filterGroupName(Limits.java:52)
at org.apache.hadoop.mapreduce.counters.AbstractCounters.getGroup(AbstractCounters.java:220)
at org.apache.hadoop.mapred.Counters.getGroup(Counters.java:113)
at org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler.saveCounters(JobControlCompiler.java:360)
... 19 more
================================================================================
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12691390">PIG-3726</key>
            <summary>Ranking empty records leads to NullPointerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jarcec">Jarek Jarcec Cecho</assignee>
                                    <reporter username="mtelizhyn">Mykhaylo Telizhyn</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Jan 2014 15:05:44 +0000</created>
                <updated>Mon, 7 Jul 2014 19:08:04 +0100</updated>
                            <resolved>Fri, 31 Jan 2014 18:27:34 +0000</resolved>
                                    <version>0.12.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13882896" author="jarcec" created="Mon, 27 Jan 2014 15:36:55 +0000"  >&lt;p&gt;I&apos;ve noticed the same problem as well and have very similar patch to this one &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13882905" author="mtelizhyn" created="Mon, 27 Jan 2014 15:49:15 +0000"  >&lt;p&gt;Hi Jarek! You are welcome to submit you patch here &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.  &lt;/p&gt;</comment>
                            <comment id="13883773" author="jarcec" created="Tue, 28 Jan 2014 05:17:59 +0000"  >&lt;p&gt;Sure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mtelizhyn&quot; class=&quot;user-hover&quot; rel=&quot;mtelizhyn&quot;&gt;Mykhaylo Telizhyn&lt;/a&gt;, here is patch that I was working on just yesterday!  As you can see, it&apos;s very similar to yours &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The reason why I did not submitted it yet is that I wasn&apos;t sure whether my (our) approach is entirely correct. Method &lt;tt&gt;saveCounters&lt;/tt&gt; is written in a way to throw an exception if the RANK counters are not present. I&apos;m assuming that the counters might be missing from many reasons and the only valid case that we want to cover is when the input relation is empty. I wanted poke around a bit to see if that is indeed the case. Will be happy to hear others thoughts.&lt;/p&gt;</comment>
                            <comment id="13883896" author="mtelizhyn" created="Tue, 28 Jan 2014 08:30:29 +0000"  >&lt;p&gt;Sure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jarcec&quot; class=&quot;user-hover&quot; rel=&quot;jarcec&quot;&gt;Jarek Jarcec Cecho&lt;/a&gt;, I think your approach is covering better the case when the input relation is empty. So please free to commit your patch.&lt;/p&gt;</comment>
                            <comment id="13884956" author="jarcec" created="Wed, 29 Jan 2014 03:19:19 +0000"  >&lt;p&gt;Thank you for your feedback &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mtelizhyn&quot; class=&quot;user-hover&quot; rel=&quot;mtelizhyn&quot;&gt;Mykhaylo Telizhyn&lt;/a&gt;. I went ahead and added the check to ensure that the only acceptable option for missing RANK counters is when the relation is empty.&lt;/p&gt;</comment>
                            <comment id="13887963" author="daijy" created="Fri, 31 Jan 2014 18:27:34 +0000"  >&lt;p&gt;+1. Patch committed to trunk. Thanks Jarek!&lt;/p&gt;</comment>
                            <comment id="13888008" author="jarcec" created="Fri, 31 Jan 2014 18:54:29 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mtelizhyn&quot; class=&quot;user-hover&quot; rel=&quot;mtelizhyn&quot;&gt;Mykhaylo Telizhyn&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12625779" name="PIG-3726.patch" size="3186" author="jarcec" created="Wed, 29 Jan 2014 03:19:19 +0000"/>
                            <attachment id="12625523" name="PIG-3726.patch" size="2406" author="jarcec" created="Tue, 28 Jan 2014 05:17:59 +0000"/>
                            <attachment id="12625366" name="emptyRecordsNPE.patch" size="3283" author="mtelizhyn" created="Mon, 27 Jan 2014 15:08:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 27 Jan 2014 15:36:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>370135</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzln6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>370437</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>