<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:07:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-949/PIG-949.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-949] Zebra Bug: splitting map into multiple column group using storage hint causes unexpected behaviour</title>
                <link>https://issues.apache.org/jira/browse/PIG-949</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Hi &lt;/p&gt;

&lt;p&gt; The storage hint&lt;br/&gt;
specification plays a important part whether the output table is readable or not&lt;/p&gt;

&lt;p&gt;say if we have have the map &apos;map&apos;.&lt;/p&gt;

&lt;p&gt;One can split the map into a column group using [map#&lt;/p&gt;
{k1}, map#{k2}...] &lt;br/&gt;
however the remaining map field will automatically be added to the default group.&lt;br/&gt;
&lt;br/&gt;
if user try to create a new column group for the remaining fields as follows&lt;br/&gt;
&lt;br/&gt;
[map#{k1}
&lt;p&gt;, map#&lt;/p&gt;
{k2}
&lt;p&gt;, ..]&lt;span class=&quot;error&quot;&gt;&amp;#91;map&amp;#93;&lt;/span&gt; i.e create a seperate column group&lt;/p&gt;

&lt;p&gt;the table writer will create the table.&lt;/p&gt;

&lt;p&gt;however, if one tries to load the created table via pig or via map reduce using TableInputFormat&lt;/p&gt;

&lt;p&gt;then the reader  have problem reading the map&lt;/p&gt;

&lt;p&gt;We get the following stack trace&lt;/p&gt;

&lt;p&gt;09/09/09 00:09:45 INFO mapred.JobClient: Task Id : attempt_200908191538_33939_m_000021_2, Status : FAILED&lt;br/&gt;
java.io.IOException: getValue() failed: null&lt;br/&gt;
        at org.apache.hadoop.zebra.io.BasicTable$Reader$BTScanner.getValue(BasicTable.java:775)&lt;br/&gt;
        at org.apache.hadoop.zebra.mapred.TableRecordReader.next(TableInputFormat.java:717)&lt;br/&gt;
        at org.apache.hadoop.zebra.mapred.TableRecordReader.next(TableInputFormat.java:651)&lt;br/&gt;
        at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.moveToNext(MapTask.java:191)&lt;br/&gt;
        at org.apache.hadoop.mapred.MapTask$TrackedRecordReader.next(MapTask.java:175)&lt;br/&gt;
        at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:48)&lt;br/&gt;
        at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:356)&lt;br/&gt;
        at org.apache.hadoop.mapred.MapTask.run(MapTask.java:305)&lt;br/&gt;
        at org.apache.hadoop.mapred.Child.main(Child.java:170)&lt;/p&gt;



&lt;p&gt;Alok&lt;/p&gt;</description>
                <environment>&lt;p&gt;linux&lt;/p&gt;</environment>
        <key id="12435261">PIG-949</key>
            <summary>Zebra Bug: splitting map into multiple column group using storage hint causes unexpected behaviour</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yanz">Yan Zhou</assignee>
                                    <reporter username="aloknsingh">Alok Singh</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Sep 2009 23:41:40 +0100</created>
                <updated>Wed, 24 Mar 2010 22:14:39 +0000</updated>
                            <resolved>Fri, 25 Sep 2009 23:30:46 +0100</resolved>
                                    <version>0.4.0</version>
                                    <fixVersion>0.5.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12754353" author="jing1234" created="Fri, 11 Sep 2009 22:15:21 +0100"  >&lt;p&gt;Thanks Alok. &lt;br/&gt;
I am able to reproduce the problem. &lt;br/&gt;
I was only using i/o layer (not pig loader) to test map split. &lt;br/&gt;
This is what I did:&lt;br/&gt;
  final static String STR_SCHEMA = &quot;m1:map(string),m2:map(map(int))&quot;;&lt;br/&gt;
  final static String STR_STORAGE = &quot;[m1#&lt;/p&gt;
{a}];&lt;a href=&quot;#{x|y}&quot;&gt;m2#{x|y}&lt;/a&gt;; &lt;a href=&quot;#{b}, m2#{z}&quot;&gt;m1#{b}, m2#{z}&lt;/a&gt;;&lt;span class=&quot;error&quot;&gt;&amp;#91;m1&amp;#93;&lt;/span&gt;&quot;;&lt;br/&gt;
.......create table and insert data ......&lt;br/&gt;
&lt;br/&gt;
load:  String projection = new String(&quot;m1#{a}
&lt;p&gt;&quot;);&lt;/p&gt;

&lt;p&gt;I only got null returned. &lt;/p&gt;

&lt;p&gt;============&lt;/p&gt;

&lt;p&gt;Without storage hint &lt;span class=&quot;error&quot;&gt;&amp;#91;m1&amp;#93;&lt;/span&gt;, everything works fine. , i.e. &lt;br/&gt;
 final static String STR_STORAGE = &quot;[m1#&lt;/p&gt;
{a}];&lt;a href=&quot;#{x|y}&quot;&gt;m2#{x|y}&lt;/a&gt;; &lt;a href=&quot;#{b}, m2#{z}&quot;&gt;m1#{b}, m2#{z}&lt;/a&gt;&quot;;&lt;br/&gt;
 .......create table and insert data ......&lt;br/&gt;
load:  String projection = new String(&quot;m1#{a}
&lt;p&gt;&quot;);&lt;br/&gt;
I am able to get value m1#&lt;/p&gt;
{a}
&lt;p&gt;. &lt;/p&gt;

&lt;p&gt;Zebra team is working on the fix.&lt;/p&gt;
</comment>
                            <comment id="12755094" author="yanz" created="Mon, 14 Sep 2009 18:34:35 +0100"  >&lt;p&gt;The problem is caused by not adding &quot;ColumnMappingEntry&quot;s from the key-split specs in storage info to an  explicitly specified MAP item in storage info, thus causing missing CGs as needed by the key-split specs. Everything falls apart thereafter. Will create a patch for R1 patch release soon.&lt;/p&gt;</comment>
                            <comment id="12757996" author="hadoopqa" created="Mon, 21 Sep 2009 20:07:37 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12420202/Pig_949.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12420202/Pig_949.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 816832.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/40/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/40/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/40/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/40/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/40/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/40/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12758074" author="yanz" created="Tue, 22 Sep 2009 01:17:19 +0100"  >&lt;p&gt;The test case is &lt;/p&gt;

&lt;p&gt;contrib/zebra/src/test/org/apache/hadoop/zebra/io/TestJira949.java&lt;/p&gt;</comment>
                            <comment id="12758328" author="rangadi" created="Tue, 22 Sep 2009 19:08:17 +0100"  >&lt;p&gt;Yan, please include the test case in the patch. &lt;/p&gt;

&lt;p&gt;Also I would suggest a regular name for the test case file something like &apos;TestMapAcrossMultipleCGs.java&apos; or something shorter. Inside the file you could mention JIRA number in the comment.&lt;/p&gt;

&lt;p&gt;Raghu.&lt;/p&gt;</comment>
                            <comment id="12758387" author="yanz" created="Tue, 22 Sep 2009 20:33:18 +0100"  >&lt;p&gt;Test case added.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Yan&lt;/p&gt;
</comment>
                            <comment id="12758450" author="yanz" created="Tue, 22 Sep 2009 22:32:29 +0100"  >&lt;p&gt;change the unit test case to TestNonDefaultWholeMapSplit&lt;/p&gt;</comment>
                            <comment id="12758535" author="hadoopqa" created="Wed, 23 Sep 2009 02:45:26 +0100"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12420313/Pig_949.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12420313/Pig_949.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 817739.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 2 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/9/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/9/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/9/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/9/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/9/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/9/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12759773" author="chaow" created="Fri, 25 Sep 2009 22:59:20 +0100"  >&lt;p&gt;Already viewed the patch +1&lt;/p&gt;</comment>
                            <comment id="12759789" author="rangadi" created="Fri, 25 Sep 2009 23:30:33 +0100"  >&lt;p&gt;I just committed this. Thanks Yan for the fix and Jing for the test!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12420313" name="Pig_949.patch" size="11527" author="yanz" created="Tue, 22 Sep 2009 22:32:29 +0100"/>
                            <attachment id="12420304" name="Pig_949.patch" size="11463" author="yanz" created="Tue, 22 Sep 2009 20:16:03 +0100"/>
                            <attachment id="12420202" name="Pig_949.patch" size="717" author="yanz" created="Mon, 21 Sep 2009 17:14:42 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 11 Sep 2009 21:15:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164488</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaktb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95683</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>