<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:58:05 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3269/PIG-3269.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3269] In operator support</title>
                <link>https://issues.apache.org/jira/browse/PIG-3269</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;This is another language improvement using the same approach as in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3268&quot; title=&quot;Case statement support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3268&quot;&gt;&lt;del&gt;PIG-3268&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Currently, Pig has no support for IN operator. To mimic it, users often have to concatenate several OR operators.&lt;/p&gt;

&lt;p&gt;For example,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a = LOAD &apos;1.txt&apos; USING PigStorage(&apos;,&apos;) AS (i:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);
b = FILTER a BY 
   (i == 1) OR
   (i == 22) OR
   (i == 333) OR
   (i == 4444) OR
   (i == 55555);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But this can be re-rewritten in a more compact manner using IN operator as follows: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a = LOAD &apos;1.txt&apos; USING PigStorage(&apos;,&apos;) AS (i:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);
b = FILTER a BY i IN (1,22,333,4444,55555);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I propose that we implement IN operator in the following manner:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Add built-in UDFs that take expressions as args. Take for example the aforementioned IN operator, we can define a UDF such as &lt;tt&gt;builtInUdf(i, 1, 22, 333, 4444, 55555)&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;Add syntactical sugar for these built-in UDFs.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12641283">PIG-3269</key>
            <summary>In operator support</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cheolsoo">Cheolsoo Park</assignee>
                                    <reporter username="cheolsoo">Cheolsoo Park</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Apr 2013 00:05:35 +0100</created>
                <updated>Sat, 21 Dec 2013 23:56:22 +0000</updated>
                            <resolved>Wed, 17 Apr 2013 17:50:22 +0100</resolved>
                                    <version>0.11</version>
                                    <fixVersion>0.12.0</fixVersion>
                                    <component>internal-udfs</component>
                    <component>parser</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13625043" author="cheolsoo" created="Mon, 8 Apr 2013 00:08:55 +0100"  >&lt;p&gt;Attached is a patch that implements my proposal. I will add unit tests shortly.&lt;/p&gt;

&lt;p&gt;Please let me know if anyone has an opinion. Thanks!&lt;/p&gt;
</comment>
                            <comment id="13625298" author="cheolsoo" created="Mon, 8 Apr 2013 12:34:48 +0100"  >&lt;p&gt;I realized that I don&apos;t need a limit on number of operands. Since the return type of my UDF is always Boolean, I don&apos;t have to implement &lt;tt&gt;getArgToFuncMapping&lt;/tt&gt; unlike case statement.&lt;/p&gt;

&lt;p&gt;Updating the patch.&lt;/p&gt;</comment>
                            <comment id="13625388" author="cheolsoo" created="Mon, 8 Apr 2013 15:03:44 +0100"  >&lt;p&gt;ReviewBoard request: &lt;a href=&quot;https://reviews.apache.org/r/10337/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/10337/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13627130" author="cheolsoo" created="Tue, 9 Apr 2013 22:25:20 +0100"  >&lt;p&gt;Incorporated Aniket&apos;s comments in RB.&lt;/p&gt;</comment>
                            <comment id="13630825" author="cheolsoo" created="Sat, 13 Apr 2013 01:37:51 +0100"  >&lt;p&gt;The current patch break &lt;tt&gt;TestQueryParser&lt;/tt&gt; and &lt;tt&gt;TestMacroExpansion&lt;/tt&gt; because it introduces a new reserved keyword &quot;IN&quot;. But this backward incompatibility can be avoided by &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3122&quot; title=&quot;Operators should not implicitly become reserved keywords&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3122&quot;&gt;&lt;del&gt;PIG-3122&lt;/del&gt;&lt;/a&gt;, so I am going to wait until &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3122&quot; title=&quot;Operators should not implicitly become reserved keywords&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3122&quot;&gt;&lt;del&gt;PIG-3122&lt;/del&gt;&lt;/a&gt; is committed before I commit my patch.&lt;/p&gt;</comment>
                            <comment id="13634191" author="cheolsoo" created="Wed, 17 Apr 2013 17:44:00 +0100"  >&lt;p&gt;All unit tests pass after adding IN to the whitelist. I am attaching the updated patch for the record.&lt;/p&gt;</comment>
                            <comment id="13634196" author="cheolsoo" created="Wed, 17 Apr 2013 17:50:22 +0100"  >&lt;p&gt;I committed to trunk given +1 from Aniket in RB. Thank you Aniket for reviewing the patch!&lt;/p&gt;</comment>
                            <comment id="13664377" author="aniket486" created="Wed, 22 May 2013 19:23:29 +0100"  >&lt;p&gt;UDF approach to IN operator is not friendly with ProjectionPushdown. We need to change this list of or-expressions. Should I open another jira for this?&lt;/p&gt;</comment>
                            <comment id="13664397" author="cheolsoo" created="Wed, 22 May 2013 19:33:52 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aniket486&quot; class=&quot;user-hover&quot; rel=&quot;aniket486&quot;&gt;Aniket Mokashi&lt;/a&gt;, yes, let&apos;s open another jira to convert it to or-expressions. Feel free to own it or assign it to me. Either way is fine with me. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13664423" author="aniket486" created="Wed, 22 May 2013 20:12:43 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cheolsoo&quot; class=&quot;user-hover&quot; rel=&quot;cheolsoo&quot;&gt;Cheolsoo Park&lt;/a&gt;, I have opened &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3336&quot; title=&quot;Change IN operator to use or-expressions instead of EvalFunc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3336&quot;&gt;&lt;del&gt;PIG-3336&lt;/del&gt;&lt;/a&gt; for this (and assigned it to you &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; )&lt;/p&gt;</comment>
                            <comment id="13854917" author="russell.jurney" created="Sat, 21 Dec 2013 20:09:45 +0000"  >&lt;p&gt;Does this work for searching IN a bag of tuples?&lt;/p&gt;</comment>
                            <comment id="13855003" author="cheolsoo" created="Sat, 21 Dec 2013 23:56:22 +0000"  >&lt;p&gt;No, it doesn&apos;t.&lt;/p&gt;

&lt;p&gt;If you do, &lt;tt&gt;&quot;( tuple ) IN ( { bag } )&quot;&lt;/tt&gt;, it will error out because the types of lhs and rhs are not compatible, i.e. tuple cannot be compared with bag. The IN is internally converted to concatenated OR expressions, i.e. &lt;tt&gt;(lhs == rhs_1) OR (lhs == rhs_2)&lt;/tt&gt;, so the type of lhs and rhs must be the same.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12648949">PIG-3336</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12643272">PIG-3280</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12577514" name="PIG-3269-2.patch" size="6018" author="cheolsoo" created="Mon, 8 Apr 2013 12:34:48 +0100"/>
                            <attachment id="12577536" name="PIG-3269-3.patch" size="17246" author="cheolsoo" created="Mon, 8 Apr 2013 15:04:07 +0100"/>
                            <attachment id="12577895" name="PIG-3269-4.patch" size="17151" author="cheolsoo" created="Tue, 9 Apr 2013 22:25:20 +0100"/>
                            <attachment id="12579151" name="PIG-3269-5.patch" size="16517" author="cheolsoo" created="Wed, 17 Apr 2013 17:44:00 +0100"/>
                            <attachment id="12577470" name="PIG-3269.patch" size="7606" author="cheolsoo" created="Mon, 8 Apr 2013 00:08:55 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 22 May 2013 18:23:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>321699</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzdctb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322044</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Pig now supports IN operator, and it can be used in any conditional expressions. For example,&lt;br/&gt;
bar = FILTER foo BY i IN (&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;);</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>