<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:01:10 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1874/PIG-1874.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1874] Make PigServer work in a multithreading environment</title>
                <link>https://issues.apache.org/jira/browse/PIG-1874</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;This means that PigServers should work if one creates separate PigServer instances for each thread (PigServers are not synchronized). &lt;/p&gt;


</description>
                <environment></environment>
        <key id="12500102">PIG-1874</key>
            <summary>Make PigServer work in a multithreading environment</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rding">Richard Ding</assignee>
                                    <reporter username="rding">Richard Ding</reporter>
                        <labels>
                    </labels>
                <created>Tue, 1 Mar 2011 21:38:54 +0000</created>
                <updated>Thu, 4 Aug 2011 01:34:40 +0100</updated>
                            <resolved>Fri, 11 Mar 2011 20:09:40 +0000</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.9.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13001257" author="sms" created="Wed, 2 Mar 2011 02:37:05 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13004894" author="rding" created="Thu, 10 Mar 2011 00:29:57 +0000"  >&lt;p&gt;Attaching patch for review.&lt;/p&gt;

&lt;p&gt;This patch removed the static variables from PigServer and PigContext classes. It also made UDFContext instance thread local.&lt;/p&gt;

&lt;p&gt;To avoid sharing PigContext object, users should use following constructors to create PigServer instance in each thread:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; PigServer(ExecType execType) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; ExecException;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; PigServer(ExecType execType, Properties properties) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; ExecException;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="13005183" author="alangates" created="Thu, 10 Mar 2011 17:29:03 +0000"  >&lt;p&gt;Changes looks good.  What kind of testing are we doing to make sure we can have PigServers running in multiple threads with no clashes?&lt;/p&gt;</comment>
                            <comment id="13005804" author="rding" created="Fri, 11 Mar 2011 19:52:02 +0000"  >&lt;p&gt;Attaching patch that added a unit test for UDFContext. There also are existing unit tests for parallel execution of bound script in embedded Pig.&lt;/p&gt;

&lt;p&gt;Test-patch output:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     [exec] -1 overall.  
     [exec] 
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec] 
     [exec]     +1 tests included.  The patch appears to include 6 &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; or modified tests.
     [exec] 
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec] 
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec] 
     [exec]     +1 findbugs.  The patch does not introduce any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Findbugs warnings.
     [exec] 
     [exec]     -1 release audit.  The applied patch generated 541 release audit warnings (more than the trunk&apos;s current 540 warnings).
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The release audit warning is html releted.&lt;/p&gt;</comment>
                            <comment id="13005813" author="rding" created="Fri, 11 Mar 2011 20:09:40 +0000"  >&lt;p&gt;Patch committed to trunk.&lt;/p&gt;</comment>
                            <comment id="13053923" author="vbarat" created="Thu, 23 Jun 2011 16:33:46 +0100"  >&lt;p&gt;Thanks guys ! You save my life with this patch !&lt;/p&gt;</comment>
                            <comment id="13055422" author="thomasm" created="Mon, 27 Jun 2011 10:28:48 +0100"  >&lt;p&gt;Be aware that the current implementation seems to have a memory leak if you reuse the threads.&lt;/p&gt;

&lt;p&gt;I have executed 1000s of (very small) pig jobs in parallel using a java.util.ExecutorService (fixed size thread pool)&lt;br/&gt;
and I ran into memory problems after 3-4 hours. (Statistics related ?)&lt;/p&gt;

&lt;p&gt;My workaround: Spawning a new thread for each PigServer and let the garbage collector do the clean up.&lt;/p&gt;



</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473221" name="PIG-1874.patch" size="10553" author="rding" created="Thu, 10 Mar 2011 00:29:57 +0000"/>
                            <attachment id="12473425" name="PIG-1874_1.patch" size="15459" author="rding" created="Fri, 11 Mar 2011 19:52:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 2 Mar 2011 02:37:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66311</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyau8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97211</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>