<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:00:20 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1277/PIG-1277.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1277] Pig should give error message when cogroup on tuple keys of different inner type</title>
                <link>https://issues.apache.org/jira/browse/PIG-1277</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;When we cogroup on a tuple, if the inner type of tuple does not match, we treat them as different keys. This is confusing. It is desirable to give error/warnings when it happens.&lt;/p&gt;

&lt;p&gt;Here is one example:&lt;br/&gt;
UDF:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class MapGenerate &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; EvalFunc&amp;lt;Map&amp;gt; {
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Map exec(Tuple input) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        &lt;span class=&quot;code-comment&quot;&gt;// TODO Auto-generated method stub
&lt;/span&gt;        Map m = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap();
        m.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;(input.size()));
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; m;
    }
    
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Schema outputSchema(Schema input) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema.FieldSchema(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, DataType.MAP));
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pig script: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a = load &apos;1.txt&apos; as (a0);
b = foreach a generate a0, MapGenerate(*) as m:map[];
c = foreach b generate a0, m#&apos;key&apos; as key;
d = load &apos;2.txt&apos; as (c0, c1);
e = cogroup c by (a0, key), d by (c0, c1);
dump e;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;1.txt&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2.txt&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1 1
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;User expected result (which is not right):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
((1,1),{(1,1)},{(1,1)})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Real result:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
((1,1),{(1,1)},{})
((1,1),{},{(1,1)})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We shall give user the message that we can not merge the key due to the type mismatch.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12458279">PIG-1277</key>
            <summary>Pig should give error message when cogroup on tuple keys of different inner type</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="alangates">Alan Gates</assignee>
                                    <reporter username="daijy">Daniel Dai</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Mar 2010 19:02:03 +0000</created>
                <updated>Thu, 4 Aug 2011 01:35:12 +0100</updated>
                            <resolved>Fri, 24 Dec 2010 01:32:27 +0000</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.9.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12972320" author="daijy" created="Fri, 17 Dec 2010 01:02:58 +0000"  >&lt;p&gt;The patch also aim to solve &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-999&quot; title=&quot;sorting on map-value fails if map-value is not of bytearray type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-999&quot;&gt;&lt;del&gt;PIG-999&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1065&quot; title=&quot;In-determinate behaviour of Union when there are 2 non-matching schema&amp;#39;s&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1065&quot;&gt;&lt;del&gt;PIG-1065&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12972615" author="alangates" created="Fri, 17 Dec 2010 19:43:59 +0000"  >&lt;p&gt;Comments:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;I&apos;m not sure the null handling in NullableBytesWritable.getValueAsPigType is the same.  Previously it would check specifically if the value had been marked as null.  Now it looks like if there isn&apos;t an entry in the first slot of the tuple (which I think would be what would happen if it were null) it will throw an exception.  I think you want to return the isNull check, and make sure the constructors properly set that value.&lt;/li&gt;
	&lt;li&gt;I don&apos;t understand the change in LOUnion.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="12972705" author="daijy" created="Sat, 18 Dec 2010 00:23:54 +0000"  >&lt;p&gt;Response to Alan&apos;s comments:&lt;br/&gt;
1. Yes, you are right. It introduces some subtle differences. When we see a null value, we set mNull flag, and put null into a tuple. We do read the null back; however, in NullableBytesWritable, we rely on mNull flag to do the comparison, which may results wrong result. I will change it.&lt;/p&gt;

&lt;p&gt;2. LOUnion is a bug fix. We shall get null schema if union two different schema. It is to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1065&quot; title=&quot;In-determinate behaviour of Union when there are 2 non-matching schema&amp;#39;s&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1065&quot;&gt;&lt;del&gt;PIG-1065&lt;/del&gt;&lt;/a&gt;. Since &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1065&quot; title=&quot;In-determinate behaviour of Union when there are 2 non-matching schema&amp;#39;s&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1065&quot;&gt;&lt;del&gt;PIG-1065&lt;/del&gt;&lt;/a&gt; is more of the same nature, I don&apos;t want to put fix in a separate patch.&lt;/p&gt;</comment>
                            <comment id="12972706" author="daijy" created="Sat, 18 Dec 2010 00:25:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1277&quot; title=&quot;Pig should give error message when cogroup on tuple keys of different inner type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1277&quot;&gt;&lt;del&gt;PIG-1277&lt;/del&gt;&lt;/a&gt;-2.patch address Alan&apos;s review comments.&lt;/p&gt;</comment>
                            <comment id="12973296" author="alangates" created="Mon, 20 Dec 2010 18:47:20 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12974695" author="daijy" created="Thu, 23 Dec 2010 18:51:36 +0000"  >&lt;p&gt;test-patch result:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; -1 overall.  &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 tests included.  The patch appears to include 9 new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 release audit.  The applied patch generated 468 release audit warnings (more than the trunk&apos;s current 464 warnings).&lt;/p&gt;

&lt;p&gt;Release audit warning is because changed NullableBytesWritable construct triggered a new jdiff file.&lt;/p&gt;

&lt;p&gt;Unit test:&lt;br/&gt;
    all pass&lt;/p&gt;

&lt;p&gt;end-to-end test:&lt;br/&gt;
    all pass&lt;/p&gt;</comment>
                            <comment id="12974812" author="daijy" created="Fri, 24 Dec 2010 01:32:26 +0000"  >&lt;p&gt;Patch committed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12437539">PIG-999</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12439479">PIG-1065</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12466432" name="PIG-1277-1.patch" size="8566" author="daijy" created="Fri, 17 Dec 2010 01:02:58 +0000"/>
                            <attachment id="12466517" name="PIG-1277-2.patch" size="8567" author="daijy" created="Sat, 18 Dec 2010 00:25:29 +0000"/>
                            <attachment id="12466909" name="PIG-1277-3.patch" size="18380" author="daijy" created="Thu, 23 Dec 2010 18:51:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Dec 2010 19:43:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66105</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaolj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96296</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>