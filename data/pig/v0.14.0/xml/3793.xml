<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:54:06 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3793/PIG-3793.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3793] Provide info on number of LogicalRelationalOperator(s) used in the script through LogicalPlanData</title>
                <link>https://issues.apache.org/jira/browse/PIG-3793</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Its useful to have an understanding of how many operators are being used in the script via the API. This could allow admins to enforce checks/restrictions on the length/complexity of the plan in user scripts.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12698509">PIG-3793</key>
            <summary>Provide info on number of LogicalRelationalOperator(s) used in the script through LogicalPlanData</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="prkommireddi">Prashant Kommireddi</assignee>
                                    <reporter username="prkommireddi">Prashant Kommireddi</reporter>
                        <labels>
                    </labels>
                <created>Mon, 3 Mar 2014 21:20:48 +0000</created>
                <updated>Mon, 7 Jul 2014 19:08:02 +0100</updated>
                            <resolved>Thu, 6 Mar 2014 00:31:55 +0000</resolved>
                                    <version>0.13.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                    <component>data</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13921091" author="cheolsoo" created="Wed, 5 Mar 2014 17:44:57 +0000"  >&lt;p&gt;+1.&lt;/p&gt;

&lt;p&gt;#1&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=prkommireddi&quot; class=&quot;user-hover&quot; rel=&quot;prkommireddi&quot;&gt;Prashant Kommireddi&lt;/a&gt;, can you add the following annotations to LogicalPlanData? I imagine we continue to improve it.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@InterfaceAudience.Public
@InterfaceStability.Evolving
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;#2&lt;br/&gt;
Please remove trailing white spaces when committing the patch. Thanks!&lt;/p&gt;</comment>
                            <comment id="13921711" author="prkommireddi" created="Thu, 6 Mar 2014 00:30:09 +0000"  >&lt;p&gt;Made the changes and committed to trunk. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cheolsoo&quot; class=&quot;user-hover&quot; rel=&quot;cheolsoo&quot;&gt;Cheolsoo Park&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13921946" author="kyunghoj" created="Thu, 6 Mar 2014 03:03:44 +0000"  >&lt;p&gt;I guess it depends on how the class LogicalPlanData is used, but wouldn&apos;t it be safer to compute the number of LogicalRelationOperators (sources and sinks too) on the fly? Then, it doesn&apos;t need to assume that the LogicalPlan is not changed. &lt;/p&gt;

&lt;p&gt;For example, getNumLogicalRelationOperators() can be changed as follows: &lt;/p&gt;

&lt;p&gt;diff --git a/src/org/apache/pig/newplan/logical/relational/LogicalPlanData.java b/src/org/apache/pi&lt;br/&gt;
index 17a2045..82df2a8 100644&lt;br/&gt;
&amp;#8212; a/src/org/apache/pig/newplan/logical/relational/LogicalPlanData.java&lt;br/&gt;
+++ b/src/org/apache/pig/newplan/logical/relational/LogicalPlanData.java&lt;br/&gt;
@@ -80,7 +80,16 @@ public class LogicalPlanData {&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;p&gt;      */&lt;br/&gt;
     public int getNumLogicalRelationOperators() {&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return this.numLogicalRelationalOperators;&lt;br/&gt;
+        int numLogicalRelationalOperators = 0;&lt;br/&gt;
+        Iterator&amp;lt;Operator&amp;gt; ops = this.lp.getOperators();&lt;br/&gt;
+&lt;br/&gt;
+        while (ops.hasNext()) 
{
+            Operator op = ops.next();
+            if (op instanceof LogicalRelationalOperator)
+                numLogicalRelationalOperators++;
+        }
&lt;p&gt;+&lt;br/&gt;
+        return numLogicalRelationalOperators;&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     /**&lt;/p&gt;
</comment>
                            <comment id="13922116" author="prkommireddi" created="Thu, 6 Mar 2014 07:42:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kyunghoj&quot; class=&quot;user-hover&quot; rel=&quot;kyunghoj&quot;&gt;Kyungho Jeon&lt;/a&gt; thanks for bringing this up. I did think about this and went with the other approach of going through LogicalPlan at the time of LogicalPlanData&apos;s creation. The other approach would require us going through the LogicalPlan for each of the method calls which would be expensive. I agree it could be documented better &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13922703" author="kyunghoj" created="Thu, 6 Mar 2014 16:23:27 +0000"  >&lt;p&gt;Thank you for the response. I found that &lt;tt&gt;LogicalPlanData&lt;/tt&gt; instance is created and initialized when &lt;tt&gt;PigServer.getLogicalPlanData()&lt;/tt&gt; is called. Then, my concern becomes less significant. &lt;/p&gt;

&lt;p&gt;But now I am thinking that &lt;tt&gt;LogicalPlanData&lt;/tt&gt; should work as an interface (in a general meaning, not a Java interface) to &lt;tt&gt;LogicalPlan&lt;/tt&gt; rather than a stateful object, considering that the class was added to avoid exposing &lt;tt&gt;LogicalPlan&lt;/tt&gt;. It won&apos;t be a problem in current Pig implementation right now. But if someone (like me, actually) is playing with &lt;tt&gt;LogicalPlan&lt;/tt&gt; and its optimizers, for example &lt;tt&gt;AddForEach&lt;/tt&gt;, then the fact that &lt;tt&gt;LogicalPlanData&lt;/tt&gt; computes and keeps the value might be confusing. &lt;/p&gt;

&lt;p&gt;I have been following Pig for a year but I am still a newbie. Please forgive my pestering. I am just trying to understand the implementation. Any comment will be appreciated!&lt;/p&gt;</comment>
                            <comment id="13922950" author="prkommireddi" created="Thu, 6 Mar 2014 19:39:25 +0000"  >&lt;p&gt;It&apos;s cool, that&apos;s how the project evolves. Ideas are always welcome &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Sounds like you have a use-case where &lt;tt&gt;PigServer.registerQuery(String)&lt;/tt&gt; could be followed by a call to &lt;tt&gt;LogicalPlanData. getNumLogicalRelationOperators()&lt;/tt&gt; - both interleaved and multiple times. Basically registering queries and seeing how LP changes through the various registers. Would it suffice to have a &lt;tt&gt;resetLogicalPlanData()&lt;/tt&gt; method on PigServer that recomputes the &lt;tt&gt;LogicalPlanData&lt;/tt&gt; ?&lt;/p&gt;</comment>
                            <comment id="13923575" author="kyunghoj" created="Fri, 7 Mar 2014 05:12:34 +0000"  >&lt;p&gt;Okay, I was confused. As &lt;tt&gt;PigServer&lt;/tt&gt; is the only interface that Pig users can use for submitting a query and Pig doesn&apos;t expose &lt;tt&gt;LogicalPlan&lt;/tt&gt;, there&apos;s no way to mutate currDAG.lp. So now I believe the current &lt;tt&gt;getNumLogicalRelationOperators()&lt;/tt&gt; implementation is reasonable and having &lt;tt&gt;resetLogicalPlanData()&lt;/tt&gt; will be sufficient. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12632360" name="PIG-3793.patch" size="6973" author="prkommireddi" created="Mon, 3 Mar 2014 21:31:49 +0000"/>
                            <attachment id="12632979" name="PIG-3793_2.patch" size="8099" author="prkommireddi" created="Thu, 6 Mar 2014 00:30:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 5 Mar 2014 17:44:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>376867</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzmslb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>377162</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Exposes methods getNumLogicalRelationOperators(), getNumSources() and  getNumSinks() on LogicalPlanData. </customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>