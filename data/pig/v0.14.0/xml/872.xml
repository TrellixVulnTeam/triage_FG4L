<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:49:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-872/PIG-872.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-872] use distributed cache for the replicated data set in FR join</title>
                <link>https://issues.apache.org/jira/browse/PIG-872</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Currently, the replicated file is read directly from DFS by all maps. If the number of the concurrent maps is huge, we can overwhelm the NameNode with open calls.&lt;/p&gt;

&lt;p&gt;Using distributed cache will address the issue and might also give a performance boost since the file will be copied locally once and the reused by all tasks running on the same machine.&lt;/p&gt;

&lt;p&gt;The basic approach would be to use cacheArchive to place the file into the cache on the frontend and on the backend, the tasks would need to refer to the data using path from the cache.&lt;/p&gt;

&lt;p&gt;Note that cacheArchive does not work in Hadoop local mode. (Not a problem for us right now as we don&apos;t use it.)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12429630">PIG-872</key>
            <summary>use distributed cache for the replicated data set in FR join</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sriranjan">Sriranjan Manjunath</assignee>
                                    <reporter username="olgan">Olga Natkovich</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Jul 2009 18:33:39 +0100</created>
                <updated>Fri, 14 May 2010 07:45:38 +0100</updated>
                            <resolved>Mon, 23 Nov 2009 22:01:17 +0000</resolved>
                                                    <fixVersion>0.7.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12727648" author="pkamath" created="Mon, 6 Jul 2009 18:59:12 +0100"  >&lt;p&gt;Distributed cache can be used for the case where the &quot;replicate&quot; input for the fragment-replicate join is a file present on DFS at query start time. When the replicate input is an intermediate output in the query (say the output of a filter), the client side will know the filename of this intermediate output - but we have to check that hadoop will honor the ditributed cache property only while launching the job corresponding to the FR join (so that at that time, the file is present on dfs) - if this is not the case, the approach may not work for intermediate output scenarios.&lt;/p&gt;</comment>
                            <comment id="12727660" author="milindb" created="Mon, 6 Jul 2009 19:09:45 +0100"  >&lt;p&gt;A couple of things:&lt;/p&gt;

&lt;p&gt;As Pradeep says, only the hadoop job that performs FR join needs to add the replicated dataset to distributed cache.&lt;/p&gt;

&lt;p&gt;Second, make sure that the replicated dataset has high replication, such as 10 (or the same replication as job.jar). For already materialized dataset, Pig need not do anything but only warn if the replication factor is small (e.g. 3) But if the replicated dataset is being produced as an intermediate output by Pig, it needs to be generated with high replication factor. &lt;/p&gt;</comment>
                            <comment id="12778678" author="sriranjan" created="Tue, 17 Nov 2009 01:21:26 +0000"  >&lt;p&gt;I have verified that the job.xml has mapred.cache.files set to the replicated files.&lt;/p&gt;</comment>
                            <comment id="12778732" author="hadoopqa" created="Tue, 17 Nov 2009 05:30:57 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12425174/PIG_872.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12425174/PIG_872.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 881008.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/157/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/157/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/157/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/157/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/157/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/157/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12779110" author="olgan" created="Tue, 17 Nov 2009 20:32:44 +0000"  >&lt;p&gt;I am reviewing this patch&lt;/p&gt;</comment>
                            <comment id="12779238" author="olgan" created="Wed, 18 Nov 2009 01:09:38 +0000"  >&lt;p&gt;Patch looks good. A couple of comments:&lt;/p&gt;

&lt;p&gt;(1) Looks like the newly added test just have a plain replicated join. I think this is already covered in TestFRJoin.java.&lt;br/&gt;
(2) JobControlCompiler.java&quot; 943 lines: the comment says that the fragmented input is usually null and that it is the first one. Would it be more clear if we just started with the second file and did not have to check for null every time since null in any other position should be treated as error.&lt;/p&gt;</comment>
                            <comment id="12779256" author="ashutoshc" created="Wed, 18 Nov 2009 01:56:39 +0000"  >&lt;p&gt;There already exists MapReduceOper.getFragment() which will return the index of fragmented input in replFiles[]. This index should be used to identify the fragmented input instead of null check. And then as Olga suggested any other null is an error.&lt;/p&gt;</comment>
                            <comment id="12779867" author="sriranjan" created="Thu, 19 Nov 2009 08:16:34 +0000"  >&lt;p&gt;Olga, I agree with your 1st point. I will get rid of the test case.&lt;br/&gt;
To rectify 2, shouldn&apos;t maprReduceOper.getReplFiles() return only the replicated files? What&apos;s the rationale behind returning a null for the fragmented input? I could change it to what Ashutosh suggested, but it would just be cleaner if fragmented input was not represented by a null.&lt;/p&gt;</comment>
                            <comment id="12780148" author="olgan" created="Thu, 19 Nov 2009 17:20:29 +0000"  >&lt;p&gt;I am fine if you want to remove it as long as it does not break any existing functionality. I am not sure why it is present in the list.&lt;/p&gt;</comment>
                            <comment id="12780174" author="ashutoshc" created="Thu, 19 Nov 2009 18:02:54 +0000"  >&lt;p&gt;I think original intent was &lt;b&gt;not&lt;/b&gt; to hard code the fact that fragmented input should be the first input. I think its good to have that flexibility (e.g., if we later decide that ordering of join inputs should be consistent across different join algorithms and thus fragmented input should be last, in line with symmetric hash join). This has led to this twisted need for having fragmented input represented as null in replFiles[].  Nonetheless, it could be fixed such that replFiles[] consist of exactly n-1 values with no nulls. However, that will make this patch bigger and is kind of orthogonal to this issue. So, I will suggest to track that in separate jira, if we think that is something that should be fixed.&lt;/p&gt;</comment>
                            <comment id="12781318" author="sriranjan" created="Mon, 23 Nov 2009 06:36:18 +0000"  >&lt;p&gt;Fixed both the issues.&lt;/p&gt;</comment>
                            <comment id="12781415" author="hadoopqa" created="Mon, 23 Nov 2009 14:47:28 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12425805/PIG_872.patch.1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12425805/PIG_872.patch.1&lt;/a&gt;&lt;br/&gt;
  against trunk revision 882818.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    -1 core tests.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/165/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/165/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/165/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/165/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/165/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/165/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12781435" author="olgan" created="Mon, 23 Nov 2009 15:38:15 +0000"  >&lt;p&gt;resubmitting the patch. looks like we had problems running tests&lt;/p&gt;</comment>
                            <comment id="12781560" author="hadoopqa" created="Mon, 23 Nov 2009 19:24:52 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12425805/PIG_872.patch.1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12425805/PIG_872.patch.1&lt;/a&gt;&lt;br/&gt;
  against trunk revision 882818.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/51/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/51/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/51/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/51/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/51/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/51/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12781647" author="olgan" created="Mon, 23 Nov 2009 22:01:17 +0000"  >&lt;p&gt;Patch committed. Thanks Sri for contributing.&lt;/p&gt;

&lt;p&gt;(The patch did not need additional unit tests because it is improvement of the existing functionality and the current tests are sufficient. Also, there is no programatic way to test this change and manual testing has been deployed.)&lt;/p&gt;</comment>
                            <comment id="12783728" author="olgan" created="Mon, 30 Nov 2009 16:24:46 +0000"  >&lt;p&gt;patch committed to 0.6.0 branch&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12425805" name="PIG_872.patch.1" size="7509" author="sriranjan" created="Mon, 23 Nov 2009 06:36:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 6 Jul 2009 17:59:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164423</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyajw7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95534</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>