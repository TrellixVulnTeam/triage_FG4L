<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:59:36 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2166/PIG-2166.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2166] UDFs to join a bag</title>
                <link>https://issues.apache.org/jira/browse/PIG-2166</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Get several request for a UDF to flatten a bag. Seems reasonable to create one in builtin:&lt;br/&gt;
1. BagToTuple: &lt;/p&gt;
{(a),(b),(c)}
&lt;p&gt; -&amp;gt; (a,b,c)&lt;br/&gt;
2. BagToString(delimit=&quot;_&quot;): {(a),(b),(c) -&amp;gt; &quot;a_b_c&quot;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12514147">PIG-2166</key>
            <summary>UDFs to join a bag</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hluu">Hien Luu</assignee>
                                    <reporter username="daijy">Daniel Dai</reporter>
                        <labels>
                            <label>newbie</label>
                            <label>simple</label>
                    </labels>
                <created>Fri, 15 Jul 2011 02:07:39 +0100</created>
                <updated>Fri, 22 Feb 2013 04:54:12 +0000</updated>
                            <resolved>Fri, 15 Jun 2012 23:01:01 +0100</resolved>
                                                    <fixVersion>0.11</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13275913" author="julienledem" created="Tue, 15 May 2012 17:54:34 +0100"  >&lt;p&gt;We should not say &quot;flatten&quot; in that case. What about saying &quot;join&quot; ?&lt;/p&gt;</comment>
                            <comment id="13276056" author="daijy" created="Tue, 15 May 2012 18:55:05 +0100"  >&lt;p&gt;Sounds good.&lt;/p&gt;</comment>
                            <comment id="13279128" author="alangates" created="Fri, 18 May 2012 20:53:20 +0100"  >&lt;p&gt;-1 to join.  We already use that for another concept.  What&apos;s wrong with BagToTuple and BagToString?&lt;/p&gt;</comment>
                            <comment id="13279202" author="julienledem" created="Fri, 18 May 2012 22:23:31 +0100"  >&lt;p&gt;Hi Alan, I was merely commenting on the title of the JIRA, not the UDF name.&lt;/p&gt;</comment>
                            <comment id="13279595" author="hluu" created="Sat, 19 May 2012 19:19:10 +0100"  >&lt;p&gt;Hi Daniel,&lt;/p&gt;

&lt;p&gt;These two UDFs will perform flattening only at the first level right? They don&apos;t need to recursively flatten nested bags, do they? &lt;/p&gt;

&lt;p&gt;For example:&lt;br/&gt;
Input: {(a),&lt;/p&gt;
{(b,c)},(d)} the output will be (a,{(b,c)}
&lt;p&gt;,d) or should it be (a,b,c,d)&lt;/p&gt;

&lt;p&gt;I don&apos;t think they should, but just wanted to double check.&lt;/p&gt;</comment>
                            <comment id="13279988" author="daijy" created="Mon, 21 May 2012 08:15:59 +0100"  >&lt;p&gt;Hi, Hien, I don&apos;t think either. BagToTuple({(a),&lt;/p&gt;
{(b,c)},(d)}) should be (a,{(b,c)}
&lt;p&gt;,d). Otherwise, the result is ambiguous. &lt;/p&gt;
</comment>
                            <comment id="13281704" author="thejas" created="Wed, 23 May 2012 17:25:10 +0100"  >&lt;p&gt;Bags in pig are expected to be bags containing tuples. So the bag should actually be - {(a),(&lt;/p&gt;
{(b,c)}),(d)}, and the output of BagToTuple on it should be same as what Daniel said - (a,{(b,c)}
&lt;p&gt;,d) . &lt;/p&gt;</comment>
                            <comment id="13281714" author="azaroth" created="Wed, 23 May 2012 17:40:05 +0100"  >&lt;p&gt;I think we need at least 2 delimiters, one for bag elements (which are tuples) and one for tuple elements (which are anything), but I am not sure it is worth supporting nested structures in the tuples.&lt;/p&gt;</comment>
                            <comment id="13284160" author="hluu" created="Sun, 27 May 2012 15:15:43 +0100"  >&lt;p&gt;I tried my best to follow the convention about what exception to throw in UDF.  Let me know if I missed anything.&lt;/p&gt;</comment>
                            <comment id="13284164" author="hluu" created="Sun, 27 May 2012 15:26:12 +0100"  >&lt;p&gt;I was testing these UDFs in a Pig script by modifying one of the scripts in tutorial directory.  It was a manual testing so it is not ideal.  &lt;/p&gt;

&lt;p&gt;The testing through calling the exec method is in class TestBuiltInBagToTupleOrString.java.&lt;/p&gt;

&lt;p&gt;For these two UDFs, is it necessary to test them in a Pig script?  &lt;/p&gt;</comment>
                            <comment id="13285866" author="daijy" created="Wed, 30 May 2012 19:17:41 +0100"  >&lt;p&gt;Hi, Hien,&lt;br/&gt;
Patch looks good. For BagToString, it is better to have a default delimit, so it does not complain if we don&apos;t pass a delimit. &lt;/p&gt;

&lt;p&gt;It also makes sense to add some e2e tests to test/e2e/pig/tests/nightly.conf. You can use the input file studentcomplextab10k which contains bag. Refer to &lt;a href=&quot;https://cwiki.apache.org/confluence/display/PIG/HowToTest&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/PIG/HowToTest&lt;/a&gt; for how to run e2e tests.&lt;/p&gt;</comment>
                            <comment id="13286311" author="hluu" created="Thu, 31 May 2012 05:39:11 +0100"  >&lt;p&gt;I ran in a problem when trying to generate test data using the command &quot;ant -Dharness.old.pig=old_pig -Dharness.cluster.conf=hadoop_conf_dir -Dharness.cluster.bin=hadoop_script test-e2e-deploy&quot; on &lt;a href=&quot;https://cwiki.apache.org/confluence/display/PIG/HowToTest&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/PIG/HowToTest&lt;/a&gt; page.&lt;/p&gt;

&lt;p&gt;Can&apos;t locate IPC/Run.pm in @INC (@INC contains: . . . ./libexec . . ./libexec /Library/Perl/Updates/5.10.0 /System/Library/Perl/&lt;/p&gt;

&lt;p&gt;Then I tried to install IPC::Run perl module and ran into another error.&lt;/p&gt;

&lt;p&gt;On cpan.org, there is paragraph:&lt;br/&gt;
&quot;OSX comes with Perl pre-installed, in order to build and install your own modules you will need to install the &apos;developer&apos; package which can be found on your OSX install DVD (you only need the &apos;unix tools&apos;). Once you have done this you can use all of the tools mentioned above.&quot;&lt;/p&gt;

&lt;p&gt;Do you know the &apos;developer&apos; package it is talking about?&lt;/p&gt;

&lt;p&gt;BTW, I am on Mac OSX.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Hien&lt;/p&gt;</comment>
                            <comment id="13286317" author="daijy" created="Thu, 31 May 2012 05:56:07 +0100"  >&lt;p&gt;You need to install IPC::Run module. I usually download it from &lt;a href=&quot;http://search.cpan.org/~toddr/IPC-Run-0.91/lib/IPC/Run.pm&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://search.cpan.org/~toddr/IPC-Run-0.91/lib/IPC/Run.pm&lt;/a&gt;, build and install it.&lt;/p&gt;</comment>
                            <comment id="13286676" author="thejas" created="Thu, 31 May 2012 16:56:07 +0100"  >&lt;p&gt;this might also work for you - cpan install IPC::Run&lt;/p&gt;</comment>
                            <comment id="13286692" author="hluu" created="Thu, 31 May 2012 17:10:22 +0100"  >&lt;p&gt;I had to upgrade to xcode version 3.2 to get over the IPC::Run installation error.  It was complaining about missing some header file.&lt;/p&gt;

&lt;p&gt;Does it really take 10 hours to complete the e2e tests when running in local mode?  Is there a way to run a specific set of tests only?&lt;/p&gt;</comment>
                            <comment id="13286700" author="thejas" created="Thu, 31 May 2012 17:14:04 +0100"  >&lt;blockquote&gt;&lt;p&gt;Is there a way to run a specific set of tests only?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, for example to run the test number 1 in Checkin test group, add the following param to command line:   &lt;tt&gt;-Dtests.to.run=&quot;-t Checkin_1&quot;&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="13286705" author="prkommireddi" created="Thu, 31 May 2012 17:18:23 +0100"  >&lt;p&gt;You can also run a single unit test if you would like &lt;a href=&quot;https://cwiki.apache.org/PIG/howtotest.html#HowToTest-Runningasingleunittest&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/PIG/howtotest.html#HowToTest-Runningasingleunittest&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13286721" author="julienledem" created="Thu, 31 May 2012 17:33:35 +0100"  >&lt;p&gt;Here is an example of how you could test your UDF in a pig script from a java unit test:&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/pig/trunk/test/org/apache/pig/builtin/mock/TestMockStorage.java?revision=1331070&amp;amp;view=markup&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/pig/trunk/test/org/apache/pig/builtin/mock/TestMockStorage.java?revision=1331070&amp;amp;view=markup&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13286729" author="hluu" created="Thu, 31 May 2012 17:40:53 +0100"  >&lt;p&gt;Cool. Thanks for the answers and suggestions.  Very helpful.&lt;/p&gt;</comment>
                            <comment id="13288280" author="hluu" created="Mon, 4 Jun 2012 00:11:59 +0100"  >&lt;p&gt;Added support for default delimiter in BagToString UDF and more tests using embedded PigServer.&lt;/p&gt;</comment>
                            <comment id="13288285" author="hluu" created="Mon, 4 Jun 2012 00:19:04 +0100"  >&lt;p&gt;I tried to add more tests to nightly.conf and I kept getting an error when trying to run it.&lt;/p&gt;

&lt;p&gt;Here is the command I used to run a specific test:&lt;/p&gt;

&lt;p&gt;ant -Dharness.old.pig=/Users/hluu/dev/pig_project/pig/old_pig/pig-0.10.0 -Dharness.cluster.conf=hadoop_conf_dir -Dharness.cluster.bin=hadoop_script test-e2e-local -Dtests.to.run=&quot;-t BagToString_1&quot;&lt;/p&gt;

&lt;p&gt;The test log file is attached and the error is on line 412.&lt;/p&gt;

&lt;p&gt;Here is line 412:&lt;/p&gt;

&lt;p&gt;ERROR TestDriver::run at : 470 Failed to run test BagToString_1 &amp;lt;Unable to open file $&lt;/p&gt;
{PH_BENCHMARK_CACHE_PATH}
&lt;p&gt;/BagToString_1_benchmark.pig to write pig script, No such file or directory&lt;br/&gt;
&amp;gt;&lt;/p&gt;


&lt;p&gt;Any ideas? What is PH_BENCHMARK_CACHE_PATH?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="13289821" author="daijy" created="Tue, 5 Jun 2012 23:55:00 +0100"  >&lt;p&gt;It is the cache directory for benchmark files. &lt;/p&gt;</comment>
                            <comment id="13290285" author="hluu" created="Wed, 6 Jun 2012 18:31:07 +0100"  >&lt;p&gt;How do I set a value for this environment variable?&lt;/p&gt;

&lt;p&gt;I tried to add an environment variable to my .bash_profile like below and still ran into the same issue:&lt;/p&gt;

&lt;p&gt;export PH_BENCHMARK_CACHE_PATH=/Users/hluu/dev/pig_project/pig/cache&lt;/p&gt;

&lt;p&gt;Here is the error in the test harness log file (&amp;lt;pig home&amp;gt;/test/e2e/pig/testdist/out/log/test_harnesss_1339002322):&lt;/p&gt;


&lt;p&gt;sort ./out/pigtest/hluu/hluu.1339002409/Distinct_1.out/out_original&lt;br/&gt;
ERROR TestDriver::run at : 470 Failed to run test Distinct_1 &amp;lt;Unable to open file $&lt;/p&gt;
{PH_BENCHMARK_CACHE_PATH}
&lt;p&gt;/Distinct_1_benchmark.pig to write pig script, No such file or directory&lt;br/&gt;
&amp;gt;&lt;/p&gt;


&lt;p&gt;This issue is blocking my progress.  Please let me know what needs to be done so I can move forward.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="13290315" author="daijy" created="Wed, 6 Jun 2012 19:19:38 +0100"  >&lt;p&gt;We fixed it on trunk and 0.10 branch. Please try &quot;svn up&quot;, and run again. (Don&apos;t need PH_BENCHMARK_CACHE_PATH)&lt;/p&gt;</comment>
                            <comment id="13290753" author="hluu" created="Thu, 7 Jun 2012 04:31:13 +0100"  >&lt;p&gt;Awesome.  I was able to make some progress after &quot;svn up&quot;.&lt;/p&gt;</comment>
                            <comment id="13292149" author="daijy" created="Sat, 9 Jun 2012 02:17:22 +0100"  >&lt;p&gt;Hi, Hien,&lt;br/&gt;
Are you able to run e2e tests? Do you need any help?&lt;/p&gt;</comment>
                            <comment id="13292185" author="hluu" created="Sat, 9 Jun 2012 04:30:51 +0100"  >&lt;p&gt;Yes, I am able to run e2e tests.  I am hoping to finish adding tests to nightly.conf this weekend &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13293635" author="hluu" created="Tue, 12 Jun 2012 15:00:00 +0100"  >&lt;p&gt;Added 2 test groups to nightly.conf.  A total of 4 tests and they all passed.&lt;/p&gt;</comment>
                            <comment id="13295947" author="daijy" created="Fri, 15 Jun 2012 23:01:01 +0100"  >&lt;p&gt;+1.&lt;/p&gt;

&lt;p&gt;Patch committed to trunk.&lt;/p&gt;

&lt;p&gt;Thanks Hien!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12531831" name="PIG-2166-e2e.diff" size="35036" author="hluu" created="Tue, 12 Jun 2012 15:00:00 +0100"/>
                            <attachment id="12530713" name="PIG-2166.diff" size="27312" author="hluu" created="Mon, 4 Jun 2012 00:11:59 +0100"/>
                            <attachment id="12529890" name="bagtotuplestring.diff" size="19401" author="hluu" created="Sun, 27 May 2012 15:15:43 +0100"/>
                            <attachment id="12530714" name="test_harnesss_1338753364" size="72002" author="hluu" created="Mon, 4 Jun 2012 00:19:04 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 May 2012 16:54:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>67988</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyavxb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97483</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>