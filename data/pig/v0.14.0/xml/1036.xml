<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:56:49 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1036/PIG-1036.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1036] Fragment-replicate left outer join</title>
                <link>https://issues.apache.org/jira/browse/PIG-1036</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description></description>
                <environment></environment>
        <key id="12438753">PIG-1036</key>
            <summary>Fragment-replicate left outer join</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ankit.modi">Ankit Modi</assignee>
                                    <reporter username="olgan">Olga Natkovich</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Oct 2009 22:22:00 +0100</created>
                <updated>Wed, 24 Mar 2010 22:15:57 +0000</updated>
                            <resolved>Tue, 3 Nov 2009 23:28:13 +0000</resolved>
                                                    <fixVersion>0.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12771171" author="ankit.modi" created="Wed, 28 Oct 2009 22:43:25 +0000"  >&lt;p&gt;This patch fails in findBugs as I had modified the line that contained findBugs warnings earlier.&lt;/p&gt;

&lt;p&gt;It also fails on ReleaseAudit for html ( doc ) file for POFRJoin&lt;/p&gt;</comment>
                            <comment id="12771175" author="ankit.modi" created="Wed, 28 Oct 2009 22:46:47 +0000"  >&lt;p&gt;This patch fails in findBugs as I had modified **&lt;b&gt;lines (4 lines of constructors)&lt;/b&gt;** that contained findBugs warnings earlier. &lt;/p&gt;</comment>
                            <comment id="12771184" author="olgan" created="Wed, 28 Oct 2009 23:06:51 +0000"  >&lt;p&gt;Any findbug warnings that can&apos;t be fixed, must go into the exclusion file. We can&apos;t commit any patches that increase the count for findbugs or javac warnings.&lt;/p&gt;</comment>
                            <comment id="12771192" author="dvryaboy" created="Wed, 28 Oct 2009 23:20:40 +0000"  >&lt;p&gt;This is in the old POFRJoin too, but looking at the constructors, there&apos;s a lurking NPE:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; POFRJoin(OperatorKey k) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; PlanException, ExecException {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;(k,-1,&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, -1, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
     }

[...]
 &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; POFRJoin(OperatorKey k, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; rp, List&amp;lt;PhysicalOperator&amp;gt; inp, 
    List&amp;lt;List&amp;lt;PhysicalPlan&amp;gt;&amp;gt; ppLists, List&amp;lt;List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Byte&lt;/span&gt;&amp;gt;&amp;gt; keyTypes, 
    FileSpec[] replFiles, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; fragment, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isLeftOuter) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; ExecException{
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(k,rp,inp);
        
        phyPlanLists = ppLists;
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fragment = fragment;
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.keyTypes = keyTypes;
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.replFiles = replFiles;
        replicates = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Map[ppLists.size()]; &lt;span class=&quot;code-comment&quot;&gt;// BANG
&lt;/span&gt;[...]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;size() is getting called on an object that might be null.&lt;br/&gt;
Perhaps input list, ppLists, keyTypes, and FileSpec[] should be initialized to empty objects instead of nulls when they are not set?&lt;/p&gt;
</comment>
                            <comment id="12771195" author="olgan" created="Wed, 28 Oct 2009 23:28:14 +0000"  >&lt;p&gt;Actually, in a separate findbugs patch, I am removing all the extra constructors because they do cause NPE. &lt;/p&gt;</comment>
                            <comment id="12771436" author="hadoopqa" created="Thu, 29 Oct 2009 14:50:05 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12423507/LeftOuterFRJoin.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12423507/LeftOuterFRJoin.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 830757.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/30/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/30/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12771489" author="ankit.modi" created="Thu, 29 Oct 2009 17:24:12 +0000"  >&lt;p&gt;Updated with the new SVN trunk. Findbugs are removed automatically with Olgan&apos;s changes.&lt;br/&gt;
Even ReleaseAudit warnings are removed.&lt;/p&gt;</comment>
                            <comment id="12771622" author="hadoopqa" created="Thu, 29 Oct 2009 21:16:31 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12423594/LeftOuterFRJoin.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12423594/LeftOuterFRJoin.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 831051.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/129/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/129/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/129/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/129/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/129/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/129/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12772157" author="pkamath" created="Fri, 30 Oct 2009 23:07:33 +0000"  >&lt;p&gt;In the unit tests in TestFRJoin, there is a check made for the output tuples using hasmaps and also using TestHelper.compareBags() - are both required?&lt;/p&gt;

&lt;p&gt;In QueryParser.jjt we currently have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1974         &lt;span class=&quot;code-comment&quot;&gt;// in the &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; of &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; joins, only two
&lt;/span&gt;| 1975         &lt;span class=&quot;code-comment&quot;&gt;// inputs are allowed
&lt;/span&gt;| 1976         isOuter = (isLeftOuter || isRightOuter || isFullOuter);
| 1977         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(isOuter &amp;amp;&amp;amp; gis.size() &amp;gt; 2) {
| 1978           &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ParseException(&lt;span class=&quot;code-quote&quot;&gt;&quot;(left|right|full) &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; joins are only supported &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; two inputs&quot;&lt;/span&gt;);
| 1979         }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think left outer join should only be supported for 2 way FR joins - looks like the code supports &amp;gt;=2 inputs - &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 867                 &lt;span class=&quot;code-comment&quot;&gt;// This condition may not reach, as a join has more than one side
&lt;/span&gt;   868                 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( innerFlags.length &amp;gt;= 2 ) {
   869                     isLeftOuter = !innerFlags[1];
   870                 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In the code below, TupleFactory.getInstance() can be replaced with mTupleFactory. Also there should be checks to see if the second input&lt;br/&gt;
has a schema and we should rely on that to determine how many nulls are needed. Left outer join should only be supported for the case&lt;br/&gt;
where second input has a schema (assuming we only support 2 way FR join) to be consistent in all our implementations of left join. &lt;br/&gt;
209                         Tuple nullTuple = TupleFactory.getInstance().newTuple(iter.next().get(0).size());   &lt;/p&gt;

&lt;p&gt;Why is an array of Bags (nullBags) used? should this be nullTuples since what we really want is just 1 null tuple - also if we only&lt;br/&gt;
support 2 way left outer join, this would just be a nullTuple instead of an array.&lt;/p&gt;
</comment>
                            <comment id="12773145" author="ankit.modi" created="Tue, 3 Nov 2009 19:39:59 +0000"  >&lt;p&gt;Attaching a new patch.&lt;/p&gt;

&lt;p&gt;The join now only supports two way Left join. &lt;br/&gt;
Join requires a schema to be mandatory be present on the right side, and it is used to determine the number of null fields/columns in nullTuple.&lt;/p&gt;

&lt;p&gt;As its a two way join we use nullBag instead of an Array of nullBag. &lt;br/&gt;
A DataBag is used instead of a Tuple to maintain consistency on the result Type of ConstantExpression.&lt;/p&gt;</comment>
                            <comment id="12773149" author="ankit.modi" created="Tue, 3 Nov 2009 19:46:52 +0000"  >&lt;p&gt;Also the the patch fixes two wrong error codes in &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;LogToPhyTranslationVisitor.updateWithEmptyBagCheck&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
                &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; errCode = 1109;  &lt;span class=&quot;code-comment&quot;&gt;// was 1105
&lt;/span&gt;                &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; msg = &lt;span class=&quot;code-quote&quot;&gt;&quot;Input (&quot;&lt;/span&gt; + joinInput.getAlias() + &lt;span class=&quot;code-quote&quot;&gt;&quot;) &quot;&lt;/span&gt; +
                        &lt;span class=&quot;code-quote&quot;&gt;&quot;on which &lt;span class=&quot;code-keyword&quot;&gt;outer&lt;/span&gt; join is desired should have a valid schema&quot;&lt;/span&gt;;
      ....
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (FrontendException e) {
            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; errCode = 2104;  &lt;span class=&quot;code-comment&quot;&gt;// was 2014
&lt;/span&gt;....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12773229" author="pkamath" created="Tue, 3 Nov 2009 21:53:55 +0000"  >&lt;p&gt;+1, will commit once hudson QA comes back.&lt;/p&gt;</comment>
                            <comment id="12773273" author="hadoopqa" created="Tue, 3 Nov 2009 23:19:41 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12423944/LeftOuterFRJoin.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12423944/LeftOuterFRJoin.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 832086.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 6 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/137/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/137/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/137/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/137/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/137/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/137/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12773278" author="pkamath" created="Tue, 3 Nov 2009 23:28:13 +0000"  >&lt;p&gt;Patch committed, thanks Ankit!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12423944" name="LeftOuterFRJoin.patch" size="32747" author="ankit.modi" created="Tue, 3 Nov 2009 19:39:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 28 Oct 2009 22:43:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164564</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyalrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95839</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>