<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:06:51 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2347/PIG-2347.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2347] Fix Pig Unit tests for hadoop 23</title>
                <link>https://issues.apache.org/jira/browse/PIG-2347</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;This is the continuation work for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2125&quot; title=&quot;Make Pig work with hadoop .NEXT&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2125&quot;&gt;&lt;del&gt;PIG-2125&lt;/del&gt;&lt;/a&gt;. There are still 20+ unit test suit for hadoop 23. We need to fix them.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12529984">PIG-2347</key>
            <summary>Fix Pig Unit tests for hadoop 23</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daijy">Daniel Dai</assignee>
                                    <reporter username="daijy">Daniel Dai</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Nov 2011 00:23:32 +0000</created>
                <updated>Thu, 2 May 2013 03:29:47 +0100</updated>
                            <resolved>Sat, 31 Dec 2011 18:33:10 +0000</resolved>
                                    <version>0.9.1</version>
                    <version>0.10.0</version>
                    <version>0.11</version>
                                    <fixVersion>0.9.2</fixVersion>
                    <fixVersion>0.10.0</fixVersion>
                    <fixVersion>0.11</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13161815" author="tomwhite" created="Fri, 2 Dec 2011 19:49:12 +0000"  >&lt;p&gt;Tests that were failing were due to incomplete classpaths causing class not found exceptions. With this patch I get past that but now hit &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-3389&quot; title=&quot;MRApps loads the &amp;#39;mrapp-generated-classpath&amp;#39; file with classpath from the build machine&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-3389&quot;&gt;&lt;del&gt;MAPREDUCE-3389&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13163982" author="tomwhite" created="Tue, 6 Dec 2011 23:54:47 +0000"  >&lt;p&gt;Here&apos;s a new patch which generates a classpath file to take advantage of &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-3389&quot; title=&quot;MRApps loads the &amp;#39;mrapp-generated-classpath&amp;#39; file with classpath from the build machine&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-3389&quot;&gt;&lt;del&gt;MAPREDUCE-3389&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;However, lots of tests are still failing. For example, TestAccumulator times out, with the following exception in the log (see attached syslog file)&lt;/p&gt;

&lt;p&gt;Exception: org.apache.hadoop.yarn.exceptions.impl.pb.YarnRemoteExceptionPBImpl: Application doesn&apos;t exist in cache appattempt_1323213758124_0001_000001&lt;/p&gt;

&lt;p&gt;I&apos;m not sure what is happening here, any pointers appreciated.&lt;/p&gt;</comment>
                            <comment id="13163993" author="daijy" created="Wed, 7 Dec 2011 00:17:16 +0000"  >&lt;p&gt;Thanks, Tom! I will take a look. There is still lots of tests fail for me as well. &lt;/p&gt;</comment>
                            <comment id="13165715" author="ahmed.radwan" created="Fri, 9 Dec 2011 00:46:10 +0000"  >&lt;p&gt;Thanks Tom! I have tried the new patch on a small (4-node) hadoop-0.23 cluster.&lt;br/&gt;
I checked out trunk, applied your patch, but I also needed to manually edit the build.xml to change the &quot;hadoopversion&quot; to &quot;23&quot; (otherwise it doesn&apos;t run: ERROR org.apache.pig.tools.grunt.Grunt - ERROR 2998: Unhandled internal error. org.apache.hadoop.mapred.jobcontrol.JobControl.addJob(Lorg/apache/hadoop/mapred/jobcontrol/Job;)Ljava/lang/String&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Changing the version to 23 and rebuilding solves this issue. I have run some basic Pig scripts without problems.&lt;/p&gt;

&lt;p&gt;Can we add a command line argument to ant to specify the hadoopVersion so we don&apos;t need to manually edit the build.xml?&lt;/p&gt;</comment>
                            <comment id="13165717" author="thw" created="Fri, 9 Dec 2011 00:52:18 +0000"  >&lt;p&gt;ant -Dhadoopversion=23 clean test&lt;/p&gt;
</comment>
                            <comment id="13167815" author="daijy" created="Mon, 12 Dec 2011 21:20:27 +0000"  >&lt;p&gt;Arun Murthy provides &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2347&quot; title=&quot;Fix Pig Unit tests for hadoop 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2347&quot;&gt;&lt;del&gt;PIG-2347&lt;/del&gt;&lt;/a&gt;-1.patch, which fix a large amount of failures related to MiniMRYarnCluster and counters. Now I see 22 failed test suits:&lt;br/&gt;
TestEvalPipeline&lt;br/&gt;
TestEvalPipeline2&lt;br/&gt;
TestEvalPipelineLocal&lt;br/&gt;
TestFRJoin&lt;br/&gt;
TestFRJoin2&lt;br/&gt;
TestGrunt&lt;br/&gt;
TestHBaseStorage&lt;br/&gt;
TestJobSubmission&lt;br/&gt;
TestJoinSmoke&lt;br/&gt;
TestKeyTypeDiscoveryVisitor&lt;br/&gt;
TestMergeJoin&lt;br/&gt;
TestMultiQuery&lt;br/&gt;
TestMultiQueryBasic&lt;br/&gt;
TestMultiQueryCompiler&lt;br/&gt;
TestNestedForeach&lt;br/&gt;
TestParser&lt;br/&gt;
TestPigRunner&lt;br/&gt;
TestPruneColumn&lt;br/&gt;
TestScalarAliases&lt;br/&gt;
TestScriptLanguage&lt;br/&gt;
TestScriptUDF&lt;br/&gt;
TestSkewedJoin&lt;/p&gt;</comment>
                            <comment id="13168758" author="tomwhite" created="Tue, 13 Dec 2011 21:45:06 +0000"  >&lt;p&gt;Arun/Daniel - thanks for the update. I ran a few of the tests that were previously failing for me (e.g. TestAccumulator) and they now pass.&lt;/p&gt;

&lt;p&gt;Apart from the change to PigStatsUtil, I think this could be committed, and the remaining failures fixed in another JIRA. I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-3542&quot; title=&quot;Support &amp;quot;FileSystemCounter&amp;quot; legacy counter group name for compatibility&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-3542&quot;&gt;&lt;del&gt;MAPREDUCE-3542&lt;/del&gt;&lt;/a&gt; to fix the counter name incompatibility.&lt;/p&gt;</comment>
                            <comment id="13168810" author="acmurthy" created="Tue, 13 Dec 2011 22:53:01 +0000"  >&lt;p&gt;More fixes to ensure Pig uses multiple NMs for unit tests.&lt;/p&gt;

&lt;p&gt;With this and &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-3537&quot; title=&quot;DefaultContainerExecutor has a race condn. with multiple concurrent containers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-3537&quot;&gt;&lt;del&gt;MAPREDUCE-3537&lt;/del&gt;&lt;/a&gt; we are down to 15 test failures.&lt;/p&gt;</comment>
                            <comment id="13168817" author="acmurthy" created="Tue, 13 Dec 2011 23:00:20 +0000"  >&lt;p&gt;Related: TestJobSubmission fails because Pig depends on hbase-0.90.0 which doesn&apos;t play nice with hadoop-0.23.&lt;/p&gt;

&lt;p&gt;I guess we should bump up hbase version to 0.90.x or 0.92?&lt;/p&gt;</comment>
                            <comment id="13168832" author="tomwhite" created="Tue, 13 Dec 2011 23:08:14 +0000"  >&lt;p&gt;Yes to 0.92, although it has not been released yet.&lt;/p&gt;</comment>
                            <comment id="13168930" author="acmurthy" created="Wed, 14 Dec 2011 00:46:55 +0000"  >&lt;p&gt;So, hbase-0.92 will work with hadoop-0.23 by default? Or is it a different mvn profile?&lt;/p&gt;</comment>
                            <comment id="13168943" author="tomwhite" created="Wed, 14 Dec 2011 01:05:27 +0000"  >&lt;p&gt;A different profile (pass -Dhadoop.profile=23).&lt;/p&gt;</comment>
                            <comment id="13168973" author="acmurthy" created="Wed, 14 Dec 2011 01:50:34 +0000"  >&lt;p&gt;Ok, this means hbase-0.92 will have to ship jars of both profiles? (20.2xx &amp;amp; 23)? Is that already the case?&lt;/p&gt;</comment>
                            <comment id="13168983" author="rvs" created="Wed, 14 Dec 2011 01:57:55 +0000"  >&lt;p&gt;HBase 0.92 has decided to make dependency on hadoop optional. Downstream of HBase is now required to manage that explicitly.&lt;/p&gt;</comment>
                            <comment id="13169005" author="acmurthy" created="Wed, 14 Dec 2011 02:22:47 +0000"  >&lt;p&gt;So, if pig depends on hadoop-0.23 and hbase-0.92 it should work fine?&lt;/p&gt;</comment>
                            <comment id="13169008" author="rvs" created="Wed, 14 Dec 2011 02:26:21 +0000"  >&lt;p&gt;@Arun: correct. The HBase .jar is agnostic to the version of the Hadoop that it runs against. The hbase-0.92-test.jar, however, is not. So if you&apos;re depending on any code from there &amp;#8211; your original comment applies.&lt;/p&gt;</comment>
                            <comment id="13169089" author="acmurthy" created="Wed, 14 Dec 2011 05:35:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rvs&quot; class=&quot;user-hover&quot; rel=&quot;rvs&quot;&gt;Roman Shaposhnik&lt;/a&gt; Pig needs both hbase-0.92.jar and hbase-0.92-test.jar. Will hbase-0.92 ship with test jars for both hadoop-0.20.2xx and hadoop-0.23?&lt;/p&gt;</comment>
                            <comment id="13169090" author="acmurthy" created="Wed, 14 Dec 2011 05:37:31 +0000"  >&lt;p&gt;Updated patch, should fix TestFRJoin also.&lt;/p&gt;</comment>
                            <comment id="13169722" author="rvs" created="Wed, 14 Dec 2011 21:39:27 +0000"  >&lt;p&gt;@Arun, not currently. There&apos;s a plan to make test artifact Hadoop version agnostic, though: &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4850&quot; title=&quot;hbase tests need to be made Hadoop version agnostic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4850&quot;&gt;HBASE-4850&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13170026" author="acmurthy" created="Thu, 15 Dec 2011 08:23:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-3563&quot; title=&quot;LocalJobRunner doesn&amp;#39;t handle Jobs using o.a.h.mapreduce.OutputCommitter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-3563&quot;&gt;&lt;del&gt;MAPREDUCE-3563&lt;/del&gt;&lt;/a&gt; fixes a couple of Pig unit tests too.&lt;/p&gt;</comment>
                            <comment id="13174498" author="thw" created="Wed, 21 Dec 2011 23:36:17 +0000"  >&lt;p&gt;Patch for 0.9 branch that includes relevant portion of trunk changes plus conditional exclude of JobHistoryLoader for 0.23&lt;/p&gt;
</comment>
                            <comment id="13175122" author="daijy" created="Thu, 22 Dec 2011 22:42:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2347&quot; title=&quot;Fix Pig Unit tests for hadoop 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2347&quot;&gt;&lt;del&gt;PIG-2347&lt;/del&gt;&lt;/a&gt;-3.patch should fix all 23 unit tests theoretically. I still haven&apos;t finish a complete successful run in 23 yet, but I want to share early so folks can help test.&lt;/p&gt;

&lt;p&gt;There are still couple of holes:&lt;br/&gt;
1. &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2446&quot; title=&quot;Fix map input bytes for hadoop 20.203+&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2446&quot;&gt;PIG-2446&lt;/a&gt;, Arun is still investigating alternatives for map input bytes&lt;br/&gt;
2. &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2433&quot; title=&quot;Jython import module not working if module path is in classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2433&quot;&gt;&lt;del&gt;PIG-2433&lt;/del&gt;&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2449&quot; title=&quot;register statement fail to change classloader in JobSubmitter thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2449&quot;&gt;PIG-2449&lt;/a&gt;, which are test failures revealed in 23 test, but they are not 23 related&lt;br/&gt;
3. TestHBaseStorage &amp;amp; TestJobSubmission.testReducerNumEstimation are blocked by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4850&quot; title=&quot;hbase tests need to be made Hadoop version agnostic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4850&quot;&gt;HBASE-4850&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I skip the above mentioned tests for 23 in the patch.&lt;/p&gt;</comment>
                            <comment id="13176007" author="daijy" created="Mon, 26 Dec 2011 20:10:58 +0000"  >&lt;p&gt;Tests run complete successfully for both 20 and 23 with &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2347&quot; title=&quot;Fix Pig Unit tests for hadoop 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2347&quot;&gt;&lt;del&gt;PIG-2347&lt;/del&gt;&lt;/a&gt;-3.patch.&lt;/p&gt;</comment>
                            <comment id="13176275" author="daijy" created="Tue, 27 Dec 2011 19:21:52 +0000"  >&lt;p&gt;test-patch result:&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; -1 overall.  &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 tests included.  The patch appears to include 43 new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; &lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 release audit.  The applied patch generated 508 release audit warnings (more than the trunk&apos;s current 500 warnings).&lt;/p&gt;

&lt;p&gt;The only new file is excluded-tests-23, which has no way to add Apache header. So ignore release audit warning.&lt;/p&gt;

&lt;p&gt;Patch is ready for review.&lt;/p&gt;</comment>
                            <comment id="13176416" author="thejas" created="Wed, 28 Dec 2011 02:40:02 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13176419" author="daijy" created="Wed, 28 Dec 2011 02:49:26 +0000"  >&lt;p&gt;Patch committed to trunk/0.10. I need to do some resync for 0.9 branch.&lt;/p&gt;</comment>
                            <comment id="13176509" author="daijy" created="Wed, 28 Dec 2011 08:00:21 +0000"  >&lt;p&gt;Attach patch for 0.9 branch &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2347&quot; title=&quot;Fix Pig Unit tests for hadoop 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2347&quot;&gt;&lt;del&gt;PIG-2347&lt;/del&gt;&lt;/a&gt;-3_0.9.patch.&lt;/p&gt;</comment>
                            <comment id="13177878" author="thw" created="Sat, 31 Dec 2011 02:43:50 +0000"  >&lt;p&gt;For 0.9, had to make a small change to the ivy.xml to get past CNF exception (missing slf4j-api dependency):&lt;/p&gt;


&lt;p&gt;     &amp;lt;dependency org=&quot;org.slf4j&quot; name=&quot;slf4j-log4j12&quot; rev=&quot;$&lt;/p&gt;
{slf4j-log4j12.version}
&lt;p&gt;&quot;&lt;br/&gt;
      conf=&quot;compile-&amp;gt;master;test-&amp;gt;default&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;In general it looks like we could rely more on the maven dependencies (refer to default configuration rather than master and if necessary blacklist problematic dependencies).&lt;/p&gt;</comment>
                            <comment id="13178059" author="daijy" created="Sat, 31 Dec 2011 18:25:57 +0000"  >&lt;p&gt;All unit tests pass on 0.9 branch as well.&lt;/p&gt;</comment>
                            <comment id="13178060" author="daijy" created="Sat, 31 Dec 2011 18:33:10 +0000"  >&lt;p&gt;Patch also committed to 0.9 branch.&lt;/p&gt;</comment>
                            <comment id="13178097" author="thw" created="Sun, 1 Jan 2012 00:37:17 +0000"  >&lt;p&gt;Thanks Daniel. Please change default hadoopversion back to 20. As result of avro update from 1.4.1 to 1.5.3 there is a compile error in piggybank. I will update &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2410&quot; title=&quot;Piggybank does not compile in 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2410&quot;&gt;&lt;del&gt;PIG-2410&lt;/del&gt;&lt;/a&gt; to account for the same.&lt;/p&gt;</comment>
                            <comment id="13178100" author="daijy" created="Sun, 1 Jan 2012 02:32:40 +0000"  >&lt;p&gt;Yes, default version should be 20. I change it back. Thanks Thomas.&lt;/p&gt;</comment>
                            <comment id="13178507" author="thw" created="Mon, 2 Jan 2012 18:53:03 +0000"  >&lt;p&gt;PigAvroDatumWriter for 0.9 piggybank as separate patch.&lt;/p&gt;</comment>
                            <comment id="13178519" author="daijy" created="Mon, 2 Jan 2012 19:21:06 +0000"  >&lt;p&gt;+1 for PigAvroDatumWriter change.&lt;/p&gt;</comment>
                            <comment id="13178626" author="daijy" created="Tue, 3 Jan 2012 04:53:06 +0000"  >&lt;p&gt;I committed &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2347&quot; title=&quot;Fix Pig Unit tests for hadoop 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2347&quot;&gt;&lt;del&gt;PIG-2347&lt;/del&gt;&lt;/a&gt;-AvroDatumWriter.java to 0.9 branch to fix piggybank compilation failure. Thanks Thomas!&lt;/p&gt;</comment>
                            <comment id="13179673" author="tomwhite" created="Wed, 4 Jan 2012 17:39:26 +0000"  >&lt;p&gt;&amp;gt; Tests run complete successfully for both 20 and 23 with &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2347&quot; title=&quot;Fix Pig Unit tests for hadoop 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2347&quot;&gt;&lt;del&gt;PIG-2347&lt;/del&gt;&lt;/a&gt;-3.patch.&lt;/p&gt;

&lt;p&gt;Daniel, is this running test-commit, test-core, or test-unit?&lt;/p&gt;</comment>
                            <comment id="13179724" author="daijy" created="Wed, 4 Jan 2012 18:25:11 +0000"  >&lt;p&gt;It&apos;s all unit tests, include test-commit, test-core, test-unit. Are you able to run?&lt;/p&gt;</comment>
                            <comment id="13179734" author="rvs" created="Wed, 4 Jan 2012 18:40:50 +0000"  >&lt;p&gt;Daniel, we&apos;re seeing ~100 test failures when the tests are executed against the tip of the branch-0.9:&lt;br/&gt;
  &lt;a href=&quot;http://bigtop01.cloudera.org:8080/view/0.23%20Unit%20Tests/job/Bigtop-hadoop23-pig-unit-test/lastCompletedBuild/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/view/0.23%20Unit%20Tests/job/Bigtop-hadoop23-pig-unit-test/lastCompletedBuild/testReport/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Do you have any suggestions for us as what could be wrong. E.g.:&lt;br/&gt;
  &lt;a href=&quot;http://bigtop01.cloudera.org:8080/view/0.23%20Unit%20Tests/job/Bigtop-hadoop23-pig-unit-test/lastCompletedBuild/testReport/org.apache.pig.test/TestAccumulator/testAccumWithBuildinAvg/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/view/0.23%20Unit%20Tests/job/Bigtop-hadoop23-pig-unit-test/lastCompletedBuild/testReport/org.apache.pig.test/TestAccumulator/testAccumWithBuildinAvg/&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="13179749" author="daijy" created="Wed, 4 Jan 2012 18:56:30 +0000"  >&lt;p&gt;I see lots of &quot;Too many open files&quot; errors. Seems like you still hit &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-3586&quot; title=&quot;Lots of AMs hanging around in PIG testing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-3586&quot;&gt;&lt;del&gt;MAPREDUCE-3586&lt;/del&gt;&lt;/a&gt;. Can you check if you have lots of MRAppMaster process running? Can you try to remove .ivy2 and pull all jars again?&lt;/p&gt;</comment>
                            <comment id="13180009" author="rvs" created="Thu, 5 Jan 2012 00:10:26 +0000"  >&lt;p&gt;Thanks for the suggestion. I&apos;ve added removal of .m2 and .ivy2 caches and also I&apos;m running the # of process monitoring script. So far it seems that the issue is not really relate to the # of processes. But I&apos;ll let the testrun finish:&lt;br/&gt;
   &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/Bigtop-hadoop23-pig-unit-test/13/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/Bigtop-hadoop23-pig-unit-test/13/console&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13180015" author="daijy" created="Thu, 5 Jan 2012 00:17:05 +0000"  >&lt;p&gt;If TestAccumulator fails, I bet a lot test cases will fail. &lt;/p&gt;

&lt;p&gt;Have you run it locally? Thomas and I run the tests on several different machines, the result seems good.&lt;/p&gt;</comment>
                            <comment id="13180044" author="daijy" created="Thu, 5 Jan 2012 00:36:25 +0000"  >&lt;p&gt;I still see &quot;Too many open files&quot;, is that hit the system limit?&lt;/p&gt;</comment>
                            <comment id="13180056" author="rvs" created="Thu, 5 Jan 2012 01:00:21 +0000"  >&lt;p&gt;The previous limit was a couple of thousand open files. I bumped it to 32768 (as confirmed by ulimit -a) and re-started the tests.&lt;/p&gt;</comment>
                            <comment id="13180754" author="daijy" created="Thu, 5 Jan 2012 19:33:38 +0000"  >&lt;p&gt;Hi, Roman,&lt;br/&gt;
I see #15 finish, seems it takes much more time than on my machine (mine takes 8h). TestSkewedJoin &amp;amp; TestEvalPipeline2 fail due to timeout, might blame to the slowness. You can try to increase timeout in build.xml. Many of other failures seems related to ant 1.8 (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2172&quot; title=&quot;Fix test failure for ant 1.8.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2172&quot;&gt;&lt;del&gt;PIG-2172&lt;/del&gt;&lt;/a&gt;). Use ant 1.7 should solve the issue. &lt;/p&gt;</comment>
                            <comment id="13188298" author="daijy" created="Wed, 18 Jan 2012 06:16:27 +0000"  >&lt;p&gt;Some new development in hadoop23 require commons-httpclient.jar. &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2347&quot; title=&quot;Fix Pig Unit tests for hadoop 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2347&quot;&gt;&lt;del&gt;PIG-2347&lt;/del&gt;&lt;/a&gt;-4.patch add it.&lt;/p&gt;</comment>
                            <comment id="13188317" author="dvryaboy" created="Wed, 18 Jan 2012 07:29:24 +0000"  >&lt;p&gt;Daniel, seems odd that commons-httpclient is required by hadoop23. This library has been EOLed and replaced by httpcore and httpclient (see &lt;a href=&quot;http://hc.apache.org/httpclient-3.x/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hc.apache.org/httpclient-3.x/&lt;/a&gt;). We pull that in via requiring httpcomponents.version=4.1.  What was the failure you got without commons-httpclient?&lt;/p&gt;</comment>
                            <comment id="13188321" author="daijy" created="Wed, 18 Jan 2012 07:41:08 +0000"  >&lt;p&gt;Here is the stack:&lt;br/&gt;
java.lang.NoClassDefFoundError: org/apache/commons/httpclient/HttpMethod&lt;br/&gt;
	at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:458)&lt;br/&gt;
Caused by: java.lang.ClassNotFoundException: org.apache.commons.httpclient.HttpMethod&lt;br/&gt;
	at java.net.URLClassLoader$1.run(URLClassLoader.java:202)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at java.net.URLClassLoader.findClass(URLClassLoader.java:190)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:306)&lt;br/&gt;
	at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:247)&lt;br/&gt;
	... 1 more&lt;/p&gt;

&lt;p&gt;This happens when running local mode test (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2480&quot; title=&quot;TestUDFContext.testUDFContext failing against hadoop 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2480&quot;&gt;&lt;del&gt;PIG-2480&lt;/del&gt;&lt;/a&gt;, Harsh&apos;s comment)&lt;/p&gt;</comment>
                            <comment id="13188434" author="dvryaboy" created="Wed, 18 Jan 2012 13:12:02 +0000"  >&lt;p&gt;I see, thanks. &lt;/p&gt;

&lt;p&gt;This is a Hadoop 0.23 bug, not a Pig issue. Theoretically Hadoop should be listing commons-httpclient as a dependency in its pom, it should come in from ivy via transitive dependencies, and automatically get on the classpath.&lt;/p&gt;

&lt;p&gt;In fact, that&apos;s happening: if I remove this dependency from ivy/libraries.properties, it still shows up in build/ivy/lib/Pig when I build for hadoop 20, but not if I build for hadoop 23.&lt;/p&gt;

&lt;p&gt;Should be fixed upstream...&lt;/p&gt;</comment>
                            <comment id="13188494" author="acmurthy" created="Wed, 18 Jan 2012 15:20:05 +0000"  >&lt;p&gt;Dmitriy - hadoop does declare a dep on commons-httpclient in our pom. The problem is that Pig doesn&apos;t do transitive closure of Hadoop&apos;s deps for various reasons (differences in versions etc.) and hence we have to manually include them in Pig. I agree this isn&apos;t ideal, but I don&apos;t see a way around without a massive change in Pig. &lt;/p&gt;</comment>
                            <comment id="13188516" author="dvryaboy" created="Wed, 18 Jan 2012 15:55:56 +0000"  >&lt;p&gt;Arun &amp;#8211; it&apos;s not a big deal to include it, I am just curious why it works for 20 and doesn&apos;t work for 23, given the same Pig. Commons-httpclient does get pulled in via transitive dependencies when we depend on 0.20 progeny.&lt;/p&gt;</comment>
                            <comment id="13188604" author="thw" created="Wed, 18 Jan 2012 18:42:52 +0000"  >&lt;p&gt;@Dmitriy: 0.20 is referenced through its default configuration (which will allow for the dependencies to be pulled), while 0.23 uses master, which will only pull the artifact. We should really try to improve this to let ivy/maven do the work for 0.23, the current setup is quite fragile and verbose.&lt;/p&gt;

&lt;p&gt; conf=&quot;hadoop20-&amp;gt;default&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;vs.&lt;/p&gt;

&lt;p&gt; conf=&quot;hadoop23-&amp;gt;master&quot;/&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13188635" author="dvryaboy" created="Wed, 18 Jan 2012 19:16:55 +0000"  >&lt;p&gt;Thanks for the explanation.&lt;br/&gt;
I tried switching the conf to &quot;default&quot; and got a few maven errors.. Seems like default pulls in the world, and master pulls in nothing.. perhaps a &quot;runtime&quot; target or some minimal set of dependencies could be published. But that&apos;s a separate issue, probably better surfaced on the Hadoop project(s).&lt;/p&gt;

&lt;p&gt;fwiw, here are the errors I got when pulling default conf:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

[ivy:resolve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:resolve] 		::          UNRESOLVED DEPENDENCIES         ::
[ivy:resolve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:resolve] 		:: commons-daemon#commons-daemon;1.0.3: java.text.ParseException: inconsistent module descriptor file found in &apos;http:&lt;span class=&quot;code-comment&quot;&gt;//repo2.maven.org/maven2/commons-daemon/commons-daemon/1.0.3/commons-daemon-1.0.3.pom&apos;: bad organisation: expected=&apos;commons-daemon&apos; found=&apos;org.apache.commons&apos;; 
&lt;/span&gt;[ivy:resolve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:resolve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:resolve] 		::              FAILED DOWNLOADS            ::
[ivy:resolve] 		:: ^ see resolution messages &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; details  ^ ::
[ivy:resolve] 		::::::::::::::::::::::::::::::::::::::::::::::
[ivy:resolve] 		:: com.sun.jdmk#jmxtools;1.2.1!jmxtools.jar
[ivy:resolve] 		:: com.sun.jmx#jmxri;1.2.1!jmxri.jar
[ivy:resolve] 		::::::::::::::::::::::::::::::::::::::::::::::
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13188647" author="thw" created="Wed, 18 Jan 2012 19:24:43 +0000"  >&lt;p&gt;Those are issues with dependency POMs. You can see excludes for those elsewhere in the file:&lt;/p&gt;

&lt;p&gt;        &amp;lt;exclude org=&quot;commons-daemon&quot; module=&quot;commons-daemon&quot;/&amp;gt;&amp;lt;!-&lt;del&gt;bad POM&lt;/del&gt;-&amp;gt;&lt;br/&gt;
        &amp;lt;exclude org=&quot;org.apache.commons&quot; module=&quot;commons-daemon&quot;/&amp;gt;&amp;lt;!-&lt;del&gt;bad POM&lt;/del&gt;-&amp;gt;&lt;/p&gt;

&lt;p&gt;I think we should follow the hbase setup in which we specifically exclude what we don&apos;t want vs. excluding all.&lt;/p&gt;</comment>
                            <comment id="13188731" author="azaroth" created="Wed, 18 Jan 2012 22:01:21 +0000"  >&lt;p&gt;I am not an expert but I think the errors are just due to maven1 vs maven2 naming conventions and should be easily solvable.&lt;br/&gt;
I will try to have a look into it soonish.&lt;/p&gt;

&lt;p&gt;I am not sure I would like to have a blacklist rather than a whitelist.&lt;br/&gt;
Pulling in dependencies without control is itself a fragile setup.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12510475">PIG-2125</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12536110">PIG-2446</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12536224">PIG-2449</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12535891">MAPREDUCE-3586</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12528776">BIGTOP-162</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12534266">PIG-2410</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12535551">PIG-2433</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12535038">MAPREDUCE-3542</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12534890">MAPREDUCE-3537</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12535267">MAPREDUCE-3563</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12530933">MAPREDUCE-3389</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12507061" name="PIG-2347-1.patch" size="9515" author="daijy" created="Mon, 12 Dec 2011 21:20:27 +0000"/>
                            <attachment id="12507259" name="PIG-2347-2.patch" size="8889" author="acmurthy" created="Tue, 13 Dec 2011 22:53:01 +0000"/>
                            <attachment id="12508459" name="PIG-2347-3.patch" size="54161" author="daijy" created="Thu, 22 Dec 2011 22:42:49 +0000"/>
                            <attachment id="12510521" name="PIG-2347-3_0.9.patch" size="5461" author="daijy" created="Fri, 13 Jan 2012 20:13:12 +0000"/>
                            <attachment id="12510960" name="PIG-2347-4.patch" size="1065" author="daijy" created="Wed, 18 Jan 2012 06:16:27 +0000"/>
                            <attachment id="12509069" name="PIG-2347-AvroDatumWriter.java" size="1739" author="thw" created="Mon, 2 Jan 2012 18:53:02 +0000"/>
                            <attachment id="12507305" name="PIG-2347.patch" size="9571" author="acmurthy" created="Wed, 14 Dec 2011 05:37:31 +0000"/>
                            <attachment id="12506336" name="PIG-2347.patch" size="11285" author="tomwhite" created="Tue, 6 Dec 2011 23:54:46 +0000"/>
                            <attachment id="12505923" name="PIG-2347.patch" size="6882" author="tomwhite" created="Fri, 2 Dec 2011 19:49:12 +0000"/>
                            <attachment id="12506337" name="syslog" size="68105" author="tomwhite" created="Tue, 6 Dec 2011 23:54:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 2 Dec 2011 19:49:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>215843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy3ts7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56149</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>