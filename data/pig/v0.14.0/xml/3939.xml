<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:00:37 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3939/PIG-3939.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3939] SPRINTF function to format strings using a printf-style template</title>
                <link>https://issues.apache.org/jira/browse/PIG-3939</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Pig should provide a function to format output using java.util.Formatter (printf-style) templates.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SPRINTF(
    &apos;%6s|%-8s|%2$,10d %2$8x %3$1TFT%&amp;lt;tT%&amp;lt;tz&apos;, 
    &apos;yay&apos;, 1234567, ToMilliSeconds(CurrentTime()))
--  &apos;   yay|1234567 | 1,234,567   12d687 2014-05-15T08:22:26-0500&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve written a UDF implementing SPRINTF(...), a variable-arguments function that accepts a string and any number of objects and returns a string. It counts on the java.util.Formatter to do its type-conversion, which works quite well. It doesn&apos;t appreciates pig&apos;s Dates for datetime formats (&apos;%t&apos;), but is quite happy to use epoch milliseconds for these as shown above.&lt;/p&gt;

&lt;p&gt;Patch forthcoming.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12714486">PIG-3939</key>
            <summary>SPRINTF function to format strings using a printf-style template</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mrflip">Philip (flip) Kromer</assignee>
                                    <reporter username="mrflip">Philip (flip) Kromer</reporter>
                        <labels>
                            <label>builtin</label>
                            <label>formatted</label>
                            <label>function</label>
                            <label>string</label>
                            <label>udf</label>
                    </labels>
                <created>Thu, 15 May 2014 14:28:58 +0100</created>
                <updated>Fri, 21 Nov 2014 05:59:07 +0000</updated>
                            <resolved>Sun, 8 Jun 2014 00:44:58 +0100</resolved>
                                                    <fixVersion>0.14.0</fixVersion>
                                    <component>impl</component>
                    <component>internal-udfs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13998820" author="mrflip" created="Thu, 15 May 2014 15:57:43 +0100"  >&lt;p&gt;code, test, docs for sprintf attached. &lt;/p&gt;</comment>
                            <comment id="13998865" author="mrflip" created="Thu, 15 May 2014 17:00:35 +0100"  >&lt;p&gt;Hold on merging this &amp;#8211; have to finish the last part of the test function&lt;/p&gt;</comment>
                            <comment id="13999739" author="mrflip" created="Fri, 16 May 2014 12:02:26 +0100"  >&lt;p&gt;Tests direct call and also in simulated pig script&lt;/p&gt;</comment>
                            <comment id="13999821" author="lbendig" created="Fri, 16 May 2014 15:17:40 +0100"  >&lt;p&gt;Thanks for updating the docs for CONCAT at the same time. This was missing from &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3444&quot; title=&quot;CONCAT with 2+ input parameters fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3444&quot;&gt;&lt;del&gt;PIG-3444&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14002376" author="cheolsoo" created="Mon, 19 May 2014 21:57:03 +0100"  >&lt;p&gt;This is great! Few minor comments-&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Your unit test case fails for me-
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Testcase: testSPRINTF took 0.013 sec
        FAILED
expected:&amp;lt;...993.142 1991-02-03T0[2:00:00-06]00&amp;gt; but was:&amp;lt;...993.142 1991-02-03T0[0:00:00-08]00&amp;gt;
junit.framework.AssertionFailedError: expected:&amp;lt;...993.142 1991-02-03T0[2:00:00-06]00&amp;gt; but was:&amp;lt;...993.142 1991-02-03T0[0:00:00-08]00&amp;gt;
        at org.apache.pig.test.TestBuiltin.testSPRINTF(TestBuiltin.java:2469)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;A couple of java warnings in SPRINTF.java-&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
	&lt;li&gt;formatter is not closed.&lt;/li&gt;
	&lt;li&gt;Unused imports
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pig.EvalFunc.SchemaType;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pig.backend.executionengine.ExecException;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Delete the following lines-
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-comment&quot;&gt;// List&amp;lt;FuncSpec&amp;gt; funcList = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;FuncSpec&amp;gt;();
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// Schema s = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema();
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// s.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema.FieldSchema(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, DataType.CHARARRAY));
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// s.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Schema.FieldSchema(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, DataType.CHARARRAY));
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// funcList.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FuncSpec(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getClass().getName(), s));
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; funcList;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14003749" author="mrflip" created="Tue, 20 May 2014 19:03:58 +0100"  >&lt;p&gt;Updated to fix the comments.&lt;/p&gt;

&lt;p&gt;Dates in Java are irrevocably sucky, which we knew; the reason your test failed is that the millisecond timestamp I had in there was correctly interpreted as an epoch offset in UTC but rendered by printf() according to the current locale. Given that the %t doohickeys are kinda fiddly anyway, this isn&apos;t worth working around. I chose to&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;document that %t formats exist,&lt;/li&gt;
	&lt;li&gt;but warn people not to use them, and recommend supplying dates as a string prepared with ToString(datetime) instead, and&lt;/li&gt;
	&lt;li&gt;include the %t in the test format, applying a brief act of violence to make a string according to how Java does it. I used full class paths because I don&apos;t want to import the Date classes at package scope.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The alternative is to just declare the %t formatters as undefined behavior &amp;#8211; that is, we don&apos;t describe their use except to say &quot;don&apos;t use them&quot;, but we also don&apos;t try to check to see if they were used.&lt;/p&gt;</comment>
                            <comment id="14008518" author="cheolsoo" created="Mon, 26 May 2014 02:54:43 +0100"  >&lt;p&gt;The test still fails for me.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Testcase: testSPRINTF took 0.012 sec
        FAILED
expected:&amp;lt;...993.142 1991-02-03T0[2:00:00-06]00&amp;gt; but was:&amp;lt;...993.142 1991-02-03T0[3:00:00-05]00&amp;gt;
junit.framework.AssertionFailedError: expected:&amp;lt;...993.142 1991-02-03T0[2:00:00-06]00&amp;gt; but was:&amp;lt;...993.142 1991-02-03T0[3:00:00-05]00&amp;gt;
        at org.apache.pig.test.TestBuiltin.testSPRINTF(TestBuiltin.java:2469)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can we just remove &lt;tt&gt;%t&lt;/tt&gt; in the test?&lt;/p&gt;</comment>
                            <comment id="14011086" author="lbendig" created="Wed, 28 May 2014 14:37:26 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mrflip&quot; class=&quot;user-hover&quot; rel=&quot;mrflip&quot;&gt;Philip (flip) Kromer&lt;/a&gt; I&apos;ve created a separate jira (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3966&quot; title=&quot;Document variable input arguments of UDFs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3966&quot;&gt;&lt;del&gt;PIG-3966&lt;/del&gt;&lt;/a&gt;) for the CONCAT docs update as I&apos;d like to have it in 0.13.0.&lt;/p&gt;</comment>
                            <comment id="14016257" author="mrflip" created="Tue, 3 Jun 2014 07:15:51 +0100"  >&lt;p&gt;Updated patch removes the test for %t, discourages its use.&lt;/p&gt;</comment>
                            <comment id="14021022" author="cheolsoo" created="Sun, 8 Jun 2014 00:37:09 +0100"  >&lt;p&gt;+1. Will commit it today.&lt;/p&gt;</comment>
                            <comment id="14021024" author="cheolsoo" created="Sun, 8 Jun 2014 00:44:58 +0100"  >&lt;p&gt;Committed to trunk. Thank you Philip!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12645838" name="0001-PIG-3939-SPRINTF-function-to-format-strings-using-a-.patch" size="15818" author="mrflip" created="Tue, 20 May 2014 19:03:58 +0100"/>
                            <attachment id="12648083" name="0001-PIG-3939-addendum-SPRINTF-function-to-format-strings-v2.patch" size="14966" author="mrflip" created="Tue, 3 Jun 2014 07:15:51 +0100"/>
                            <attachment id="12645216" name="0001-SPRINTF-function-to-format-strings-using-a-printf-st.patch" size="15159" author="mrflip" created="Fri, 16 May 2014 12:02:26 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 16 May 2014 14:17:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>392799</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzphx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>392973</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>The SPRINTF function formats strings with printf-style templates: SPRINTF(&amp;#39;%6s|%-8s|%2$,10d %2$8x %3$1TFT%&amp;lt;tT%&amp;lt;tz&amp;#39;, &amp;#39;yay&amp;#39;, 1234567, ToMilliSeconds(CurrentTime())) =&amp;gt; &amp;#39;   yay|1234567 | 1,234,567   12d687 2014-05-15T08:22:26-0500&amp;#39;.&lt;br/&gt;
</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>