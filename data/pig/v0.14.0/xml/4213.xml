<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:06:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-4213/PIG-4213.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-4213] CSVExcelStorage not quoting texts containing \r (CR) when storing</title>
                <link>https://issues.apache.org/jira/browse/PIG-4213</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Managing tweets information I found that someone wrote a multiline tweet in Mac OS 9 (or bellow). When exporting the text, it is not being quoted so LibreOffice can&apos;t import the cell properly (don&apos;t try Excel 2007 because it&apos;s bugged).&lt;/p&gt;

&lt;p&gt;I suggest including the CR case in the same way as commented in &lt;a href=&quot;http://svn.apache.org/viewvc/pig/tags/release-0.12.1/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/CSVExcelStorage.java?view=markup#l315&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/pig/tags/release-0.12.1/contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/CSVExcelStorage.java?view=markup#l315&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12744997">PIG-4213</key>
            <summary>CSVExcelStorage not quoting texts containing \r (CR) when storing</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="alfonso.nishikawa">Alfonso Nishikawa</assignee>
                                    <reporter username="alfonso.nishikawa">Alfonso Nishikawa</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Sep 2014 18:12:01 +0100</created>
                <updated>Tue, 6 Jan 2015 16:40:59 +0000</updated>
                            <resolved>Tue, 6 Jan 2015 01:06:53 +0000</resolved>
                                    <version>0.12.0</version>
                                    <fixVersion>0.15.0</fixVersion>
                                    <component>piggybank</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="14153624" author="alfonso.nishikawa" created="Tue, 30 Sep 2014 20:31:52 +0100"  >&lt;p&gt;I upload a proposal patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4213&quot; title=&quot;CSVExcelStorage not quoting texts containing \r (CR) when storing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4213&quot;&gt;&lt;del&gt;PIG-4213&lt;/del&gt;&lt;/a&gt;v1.patch). Tests included (I tried my best). I assume TestLoader does not break lines by CR (\r), but tests are prepared to expose me if I am wrong &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
I couldn&apos;t test since I am not at home and this Celeron from 2005 in front of me can&apos;t handle the build...&lt;/p&gt;</comment>
                            <comment id="14153625" author="alfonso.nishikawa" created="Tue, 30 Sep 2014 20:32:51 +0100"  >&lt;p&gt;Errata from comment above: &apos;TestLoader&apos; where should be &apos;TextLoader&apos;.&lt;/p&gt;</comment>
                            <comment id="14153714" author="daijy" created="Tue, 30 Sep 2014 21:28:59 +0100"  >&lt;p&gt;Thanks Alfonso, but the patch break 3 tests in TestCSVExcelStorage, can you take a look?&lt;/p&gt;</comment>
                            <comment id="14153753" author="alfonso.nishikawa" created="Tue, 30 Sep 2014 22:09:07 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt;, Sure! Working on it  (on a suitable computer) &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Many thanks!&lt;/p&gt;</comment>
                            <comment id="14155384" author="alfonso.nishikawa" created="Wed, 1 Oct 2014 21:00:04 +0100"  >&lt;p&gt;After researching, I share some conclusions before finishing the patch:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;CSVExcelStorage&lt;/tt&gt; uses &lt;tt&gt;PigTextInputFormat&lt;/tt&gt;, which extends &lt;tt&gt;TextInputFormat&lt;/tt&gt;, which instantiates &lt;tt&gt;LineRecordReader&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;LineRecordReader&lt;/tt&gt; splits the input by &lt;tt&gt;\r&lt;/tt&gt; considering CR a linefeed.&lt;/li&gt;
	&lt;li&gt;Reading data with &lt;tt&gt;CSVExcelStorage&lt;/tt&gt; will treat &lt;tt&gt;\r&lt;/tt&gt; the same as &lt;tt&gt;\n&lt;/tt&gt; and &lt;tt&gt;\r\n&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;Reading data with &lt;tt&gt;CSVExcelStorage&lt;/tt&gt; will substitute any alone &lt;tt&gt;\r&lt;/tt&gt; in the input for a &lt;tt&gt;\n&lt;/tt&gt;, but anyway, this reading behavior is the same as used to be and can&apos;t be fixed since it belongs to &lt;tt&gt;LineRecordReader&lt;/tt&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;this implies:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;What can be fixed is the output regarding to this ticket: quote when there is a &lt;tt&gt;\r&lt;/tt&gt; present.&lt;/li&gt;
	&lt;li&gt;What can not be fixed is the fact that the operation &lt;tt&gt;load(store&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;)&lt;/tt&gt; will not be idempotent if there is any CR present. But this behavior, again, is the same as it was before this patch.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I will check this in a while &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14155431" author="alfonso.nishikawa" created="Wed, 1 Oct 2014 21:19:00 +0100"  >&lt;p&gt;I upload the file &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12672395/12672395_PIG-4213_tests_updated_CR_before.patch&quot; title=&quot;PIG-4213_tests_updated_CR_before.patch attached to PIG-4213&quot;&gt;PIG-4213_tests_updated_CR_before.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; to show the expected behavior when there are &lt;tt&gt;\r&lt;/tt&gt; in the input when LOADing, as my previous comment specifies.&lt;/p&gt;

&lt;p&gt;Do not apply before the final patch. This patch is only a proof.&lt;/p&gt;</comment>
                            <comment id="14157044" author="alfonso.nishikawa" created="Thu, 2 Oct 2014 20:40:29 +0100"  >&lt;p&gt;I upload the file &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12672616/12672616_PIG-4213v2.patch&quot; title=&quot;PIG-4213v2.patch attached to PIG-4213&quot;&gt;PIG-4213v2.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; with the patch, the tests updated shown in &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12672395/12672395_PIG-4213_tests_updated_CR_before.patch&quot; title=&quot;PIG-4213_tests_updated_CR_before.patch attached to PIG-4213&quot;&gt;PIG-4213_tests_updated_CR_before.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; and two new tests: one checking that when &lt;tt&gt;YES_MULTILINE&lt;/tt&gt; is set, fields with &lt;tt&gt;\r&lt;/tt&gt; are quoted, and another test that checks that when &lt;tt&gt;NO_MULTILINE&lt;/tt&gt; is set, fields with &lt;tt&gt;\r&lt;/tt&gt; are not quoted.&lt;/p&gt;</comment>
                            <comment id="14157249" author="alfonso.nishikawa" created="Thu, 2 Oct 2014 22:48:20 +0100"  >&lt;p&gt;Uploaded &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12672657/12672657_PIG-4213v3.patch&quot; title=&quot;PIG-4213v3.patch attached to PIG-4213&quot;&gt;PIG-4213v3.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; with both new tests unified in one method.&lt;/p&gt;</comment>
                            <comment id="14226057" author="alfonso.nishikawa" created="Wed, 26 Nov 2014 11:44:21 +0000"  >&lt;p&gt;Patch: &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-4213&quot; title=&quot;CSVExcelStorage not quoting texts containing \r (CR) when storing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-4213&quot;&gt;&lt;del&gt;PIG-4213&lt;/del&gt;&lt;/a&gt;v3.patch&lt;/p&gt;</comment>
                            <comment id="14265456" author="daijy" created="Tue, 6 Jan 2015 01:06:53 +0000"  >&lt;p&gt;Patch committed to trunk. Thanks Alfonso!&lt;/p&gt;</comment>
                            <comment id="14266356" author="alfonso.nishikawa" created="Tue, 6 Jan 2015 16:40:59 +0000"  >&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12672395" name="PIG-4213_tests_updated_CR_before.patch" size="3746" author="alfonso.nishikawa" created="Wed, 1 Oct 2014 21:19:00 +0100"/>
                            <attachment id="12672098" name="PIG-4213v1.patch" size="5735" author="alfonso.nishikawa" created="Tue, 30 Sep 2014 20:31:52 +0100"/>
                            <attachment id="12672616" name="PIG-4213v2.patch" size="9347" author="alfonso.nishikawa" created="Thu, 2 Oct 2014 20:51:39 +0100"/>
                            <attachment id="12672657" name="PIG-4213v3.patch" size="8887" author="alfonso.nishikawa" created="Thu, 2 Oct 2014 22:48:20 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 30 Sep 2014 20:28:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzuib3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>