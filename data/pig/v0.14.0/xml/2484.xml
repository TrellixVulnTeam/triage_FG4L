<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:08:32 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2484/PIG-2484.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2484] Fix several e2e test failures/aborts for 23</title>
                <link>https://issues.apache.org/jira/browse/PIG-2484</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;There are still a couple of e2e test aborts/failures for hadoop23. Most of them are due to test infrastructure, minor backward incompatibility change in 23, or recent changes in Pig. Here is a list:&lt;/p&gt;

&lt;p&gt;Scripting_1/Scripting_2: &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-3700&quot; title=&quot;If a resource in job.jar start with ./, we cannot get it in the backend&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-3700&quot;&gt;MAPREDUCE-3700&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Native_3: 23 test need a hadoop23-steaming.jar&lt;/p&gt;

&lt;p&gt;MonitoredUDF_1: Seems related to guava upgrade (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2460&quot; title=&quot;Use guava 11 instead of r06&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2460&quot;&gt;&lt;del&gt;PIG-2460&lt;/del&gt;&lt;/a&gt;), Pig&apos;s guava is newer than hadoop23&apos;s&lt;/p&gt;

&lt;p&gt;UdfException_1, UdfException_2, UdfException_3, UdfException_4: Error message change&lt;/p&gt;

&lt;p&gt;Checkin_2, GroupAggFunc_7, GroupAggFunc_9, GroupAggFunc_12, GroupAggFunc_13, Types_6, Scalar_1: float precision&lt;/p&gt;

&lt;p&gt;Limit_2: The specific output records change, test infrastructure should allow this&lt;/p&gt;</description>
                <environment></environment>
        <key id="12539074">PIG-2484</key>
            <summary>Fix several e2e test failures/aborts for 23</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="daijy">Daniel Dai</assignee>
                                    <reporter username="daijy">Daniel Dai</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Jan 2012 00:05:08 +0000</created>
                <updated>Sat, 25 Aug 2012 01:17:14 +0100</updated>
                            <resolved>Sat, 21 Jan 2012 01:03:35 +0000</resolved>
                                    <version>0.9.2</version>
                    <version>0.10.0</version>
                    <version>0.11</version>
                                    <fixVersion>0.10.0</fixVersion>
                    <fixVersion>0.9.3</fixVersion>
                    <fixVersion>0.11</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13189570" author="dvryaboy" created="Fri, 20 Jan 2012 02:08:37 +0000"  >&lt;p&gt;For MonitoredUDF &amp;#8211; we should be putting our jars ahead of hadoop&apos;s. &lt;/p&gt;</comment>
                            <comment id="13189581" author="daijy" created="Fri, 20 Jan 2012 02:40:38 +0000"  >&lt;p&gt;Exactly. In hadoop 20.x, I see an option HADOOP_USER_CLASSPATH_FIRST (though guava never cause an issue in 20.x since 20.x does not use guava). However, I didn&apos;t see an equivalent option in hadoop 23. I will follow up with hadoop folks.&lt;/p&gt;</comment>
                            <comment id="13189587" author="daijy" created="Fri, 20 Jan 2012 02:52:32 +0000"  >&lt;p&gt;Attached &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2484&quot; title=&quot;Fix several e2e test failures/aborts for 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2484&quot;&gt;&lt;del&gt;PIG-2484&lt;/del&gt;&lt;/a&gt;-1.patch in an attempt to fix all e2e tests (or disable in 23). We also need to copy hadoop-0.23.0-streaming.jar into test/e2e/pig/lib.&lt;/p&gt;</comment>
                            <comment id="13190197" author="thejas" created="Fri, 20 Jan 2012 23:39:24 +0000"  >&lt;p&gt;+1&lt;br/&gt;
The 23 specific test case parameters are very useful. We know what to revisit later (ignore23 etc).&lt;br/&gt;
I think we should see if the &quot; register &apos;./python/scriptingudf.py&apos;.. &quot; use case would work with hadoop 23 if pig removes the &quot;./&quot; prefix. Opened &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2486&quot; title=&quot;python register command does not work in hadoop 0.23 when file path starts with &amp;quot;./&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2486&quot;&gt;&lt;del&gt;PIG-2486&lt;/del&gt;&lt;/a&gt; to track that.&lt;/p&gt;</comment>
                            <comment id="13190227" author="daijy" created="Sat, 21 Jan 2012 00:56:03 +0000"  >&lt;p&gt;MonitoredUDF_1 exposes a general issue of mapreduce, how to override hadoop libraries. We see similar issue in AvroLoader as well. &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-1938&quot; title=&quot;Ability for having user&amp;#39;s classes take precedence over the system classes for tasks&amp;#39; classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-1938&quot;&gt;&lt;del&gt;MAPREDUCE-1938&lt;/del&gt;&lt;/a&gt; uses HADOOP_USER_CLASSPATH_FIRST (frontend) and mapreduce.user.classpath.first (backend). But that patch does not go into hadoop23. We need to push hadoop folks to apply this patch to 23, or provide a mechanism to solve the issue.&lt;/p&gt;</comment>
                            <comment id="13190237" author="daijy" created="Sat, 21 Jan 2012 01:03:35 +0000"  >&lt;p&gt;Patch committed to 0.10/trunk. I don&apos;t commit to 0.9 branch now, but we may when we feel a need.&lt;/p&gt;</comment>
                            <comment id="13428950" author="rohini" created="Mon, 6 Aug 2012 02:27:36 +0100"  >&lt;p&gt;Patch for Branch 0.9. &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Removed ignore for Scripting_1 and Scripting_2 as &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2761&quot; title=&quot;With hadoop23 importing modules inside python script does not work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2761&quot;&gt;&lt;del&gt;PIG-2761&lt;/del&gt;&lt;/a&gt; fixes the issue.&lt;/li&gt;
	&lt;li&gt;Included the benchmark patch from &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2711&quot; title=&quot;e2e harness: cache benchmark results between test runs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2711&quot;&gt;&lt;del&gt;PIG-2711&lt;/del&gt;&lt;/a&gt; to make testing faster.&lt;/li&gt;
	&lt;li&gt;Additional tests fixed from what is mentioned in the description. Will create a patch for these for 0.10 and trunk on a separate jira.&lt;br/&gt;
1)ClassResolution&lt;/li&gt;
	&lt;li&gt;Fully qualified UDF names were not used.&lt;br/&gt;
2)Native_x_Local &lt;/li&gt;
	&lt;li&gt;This was failing as local.conf did not set mapredjars&lt;br/&gt;
3)Jython_Macro_1_Local&lt;/li&gt;
	&lt;li&gt;- Was failing because the input file was the data directory itself instead&lt;br/&gt;
of studenttab10K. In case of mapred and local, the number of files under data&lt;br/&gt;
directory was different so Jython_Macro_1 passed with the benchmark created during mapred, but&lt;br/&gt;
Jython_Macro_1_local failed with the benchmark from mapred.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Still Failing Tests not addressed in the patch:&lt;br/&gt;
1)Jython_CompileBindRun_3_local&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Problem exists with 0.10 also. It launches 3 threads to launch multiple jobs. But with LocalJobRunner it does not work as all write to test/e2e/pig/testdist/build/test/mapred/local/localRunner/job_local_0001.xml and parsing it fails with org.xml.sax.SAXParseException: Content is not allowed in trailing section.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Additional steps for checkin:&lt;br/&gt;
  test/e2e/pig/lib/hadoop-0.23.0-streaming.jar is not part of the patch. Copy file from branch-0.10 and svn add before committing the patch.&lt;/p&gt;</comment>
                            <comment id="13428954" author="rohini" created="Mon, 6 Aug 2012 02:54:10 +0100"  >&lt;p&gt;Still Failing Tests not addressed in the patch:&lt;br/&gt;
2) MonitoredUDF_1_Local&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;It is skipped only for 0.23 mapred and not 0.23 local.&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13430431" author="rohini" created="Tue, 7 Aug 2012 17:59:37 +0100"  >&lt;p&gt;Did some debugging to see why the float precision is different between 20 and 23 to ensure that is not a cause for concern. Summing up of doubles in java has known issues (&lt;a href=&quot;http://www.velocityreviews.com/forums/t139008-java-double-precision.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.velocityreviews.com/forums/t139008-java-double-precision.html&lt;/a&gt;). The precision differs based on the order in which the numbers are summed up. That is the reason for precision differing between H20 and H23. The order in which key and values come to the output.collect from the map are same, but when the reduce of the combiner is called the order of values in Iterable&amp;lt;values&amp;gt; is different in 20 and 23. There must be some algo change somewhere for grouping of elements for the combiner. Did not take time and dig deeper to see what the actual change in mapred is. &lt;br/&gt;
  We should be able to safely ignore the float precision change in the e2e tests.&lt;/p&gt;</comment>
                            <comment id="13430496" author="daijy" created="Tue, 7 Aug 2012 19:21:59 +0100"  >&lt;p&gt;Commit &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2484&quot; title=&quot;Fix several e2e test failures/aborts for 23&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2484&quot;&gt;&lt;del&gt;PIG-2484&lt;/del&gt;&lt;/a&gt;-4-branch0.9.patch to 0.9 branch as per requested by Rohini. Note this patch also include fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2859&quot; title=&quot;Fix few e2e test failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2859&quot;&gt;&lt;del&gt;PIG-2859&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13434441" author="rohini" created="Tue, 14 Aug 2012 20:51:40 +0100"  >&lt;p&gt;test/e2e/pig/lib/hadoop-0.23.0-streaming.jar also needs to be checked in. It was not part of the patch as it is a binary. Had mentioned it as a additional step during checkin. &lt;/p&gt;</comment>
                            <comment id="13441662" author="daijy" created="Sat, 25 Aug 2012 01:17:14 +0100"  >&lt;p&gt;Added hadoop-0.23.0-streaming.jar to 0.9 branch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12539071">MAPREDUCE-3700</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12469213">MAPREDUCE-1938</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12511213" name="PIG-2484-1.patch" size="12152" author="daijy" created="Fri, 20 Jan 2012 02:37:31 +0000"/>
                            <attachment id="12511238" name="PIG-2484-2.patch" size="16309" author="daijy" created="Fri, 20 Jan 2012 08:19:10 +0000"/>
                            <attachment id="12511321" name="PIG-2484-3.patch" size="16545" author="daijy" created="Fri, 20 Jan 2012 21:12:58 +0000"/>
                            <attachment id="12539230" name="PIG-2484-4-branch0.9.patch" size="22237" author="rohini" created="Mon, 6 Aug 2012 02:27:36 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Jan 2012 02:08:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>224576</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy3tnr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>56129</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>