<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:04:10 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-671/PIG-671.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-671] typechecker does not throw an error when multiple arguments are passed to COUNT</title>
                <link>https://issues.apache.org/jira/browse/PIG-671</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;In this example, the agggregate function COUNT is passed multiple arguments and does not throw an error.&lt;/p&gt;



&lt;p&gt;TEST: Aggregate_184&lt;/p&gt;

&lt;p&gt; A =LOAD &apos;/user/pig/tests/data/types/DataAll&apos; USING PigStorage() AS ( Fint:int, Flong:long, Fdouble:double, Ffloat:float, Fchar:chararray, Fchararray:chararray, Fbytearray:bytearray, Fmap:map[], Fbag:BAG&lt;/p&gt;
{ t:tuple( name, age, avg ) }
&lt;p&gt;, Ftuple&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; name:chararray, age:int, avg:float) );&lt;br/&gt;
B =GROUP A ALL; &lt;br/&gt;
X =FOREACH B GENERATE COUNT ( A.$0, A.$0 ); &lt;br/&gt;
STORE X INTO &apos;/user/pig/tests/results/araceli.1234381533/AggregateFunc_184.out&apos; USING PigStorage();&lt;/p&gt;</description>
                <environment>&lt;p&gt;i686 i386 GNU/Linux&lt;/p&gt;</environment>
        <key id="12414690">PIG-671</key>
            <summary>typechecker does not throw an error when multiple arguments are passed to COUNT</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="deepujain">Deepak Kumar V</assignee>
                                    <reporter username="araceli">Araceli Henley</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Feb 2009 19:38:45 +0000</created>
                <updated>Thu, 4 Aug 2011 01:34:44 +0100</updated>
                            <resolved>Wed, 23 Mar 2011 15:44:15 +0000</resolved>
                                    <version>0.9.0</version>
                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13003825" author="deepujain" created="Tue, 8 Mar 2011 06:11:00 +0000"  >&lt;p&gt;COUNT.exec() always retrieves the first item from input tuple which it assumes is a bag and counts the numbers of items in the bag. &lt;br/&gt;
Even if we pass multiple arguments to COUNT(), it will always pick the first argument.&lt;/p&gt;

&lt;p&gt;There are few ways we go through this&lt;br/&gt;
a) Leave as is cause it returns correct result for counting the number of items in the first argument.&lt;br/&gt;
OR&lt;br/&gt;
b) Make a check for the size of the input tuple in COUNT.exec() and if it is not 1 then throw ExecException()  or IllegalArgumentException &lt;/p&gt;
{might be correct}
&lt;p&gt;which will cause the Map job to fail.&lt;/p&gt;

&lt;p&gt;Let me know how to we go about it.&lt;/p&gt;</comment>
                            <comment id="13003883" author="deepujain" created="Tue, 8 Mar 2011 10:08:35 +0000"  >&lt;p&gt;Here is the final approach:&lt;br/&gt;
Include public List&amp;lt;FuncSpec&amp;gt; getArgToFuncMapping() throws FrontendException in Count.java which will take care of number of arguments , their data types for COUNT.&lt;/p&gt;

&lt;p&gt;I have the patch ready and have tested it. If anyone is not working on it, can this bug be assigned to me so that i can submit the patch for review.&lt;/p&gt;</comment>
                            <comment id="13003985" author="thejas" created="Tue, 8 Mar 2011 15:06:28 +0000"  >&lt;p&gt;Deepak,&lt;br/&gt;
I can&apos;t find your name in the drop down to assign it to you. Can you assign it to yourself ?&lt;/p&gt;</comment>
                            <comment id="13004014" author="deepujain" created="Tue, 8 Mar 2011 16:06:16 +0000"  >&lt;p&gt;I could not locate the option to re-assign the defect to me. Can you point me.&lt;/p&gt;


&lt;p&gt;UserName: deepujain&lt;br/&gt;
Name: Deepak Kumar V&lt;br/&gt;
if that helps in assigning the issue.&lt;/p&gt;</comment>
                            <comment id="13004087" author="alangates" created="Tue, 8 Mar 2011 17:45:39 +0000"  >&lt;p&gt;Any changes we make have to still work in two scenarios:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
B = group A by x;
C = foreach B generate group, COUNT(A);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
B = group A by x;
C = foreach B generate group, COUNT(A.$0);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think what you&apos;re proposing to do with getArgToFuncMapping meets this, but we want to be sure to test that.&lt;/p&gt;</comment>
                            <comment id="13004096" author="deepujain" created="Tue, 8 Mar 2011 17:58:04 +0000"  >&lt;p&gt;The following scenarios were tested with the patch.&lt;br/&gt;
input.txt&lt;br/&gt;
1 2 3 4&lt;br/&gt;
a b c d&lt;br/&gt;
r s t u&lt;/p&gt;

&lt;p&gt;Script #1:&lt;br/&gt;
grunt&amp;gt; a = load &apos;test.txt&apos; ;              &lt;br/&gt;
grunt&amp;gt; b = group a all;                   &lt;br/&gt;
grunt&amp;gt; x = foreach b generate COUNT(a);&lt;br/&gt;
grunt&amp;gt; dump x;         &lt;br/&gt;
Output(s):&lt;br/&gt;
Successfully stored records in: &quot;file:/tmp/temp451361479/tmp-1035885131&quot;&lt;br/&gt;
(3)&lt;/p&gt;

&lt;p&gt;Script #2:&lt;br/&gt;
grunt&amp;gt; a = load &apos;test.txt&apos; ;              &lt;br/&gt;
grunt&amp;gt; b = group a all;                   &lt;br/&gt;
grunt&amp;gt; x = foreach b generate COUNT(a.$0);&lt;br/&gt;
grunt&amp;gt; dump x;         &lt;br/&gt;
Output(s):&lt;br/&gt;
Successfully stored records in: &quot;file:/tmp/temp451361479/tmp1005936870&quot;&lt;br/&gt;
(3)&lt;/p&gt;

&lt;p&gt;Script #3:&lt;br/&gt;
grunt&amp;gt; a = load &apos;test.txt&apos; ;              &lt;br/&gt;
grunt&amp;gt; b = group a all;                   &lt;br/&gt;
grunt&amp;gt; x = foreach b generate COUNT(a.$0,a.$0);&lt;br/&gt;
grunt&amp;gt; dump x;&lt;br/&gt;
2011-03-08 23:26:54,554 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1045: Could not infer the matching function for org.apache.pig.builtin.COUNT as multiple or none of them fit. Please use an explicit cast.&lt;/p&gt;

&lt;p&gt;Script #4:&lt;br/&gt;
grunt&amp;gt; a = load &apos;test.txt&apos; ;              &lt;br/&gt;
grunt&amp;gt; b = group a all;                   &lt;br/&gt;
grunt&amp;gt; x = foreach b generate COUNT(a.$0,a);   &lt;br/&gt;
grunt&amp;gt; dump x;                              &lt;br/&gt;
2011-03-08 23:26:59,397 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1045: Could not infer the matching function for org.apache.pig.builtin.COUNT as multiple or none of them fit. Please use an explicit cast.&lt;br/&gt;
grunt&amp;gt; &lt;/p&gt;</comment>
                            <comment id="13005739" author="deepujain" created="Fri, 11 Mar 2011 17:40:33 +0000"  >&lt;p&gt;Patch with fix and test case.&lt;/p&gt;</comment>
                            <comment id="13005790" author="deepujain" created="Fri, 11 Mar 2011 19:08:03 +0000"  >&lt;p&gt;Please review the patch submitted on 11/Mar.&lt;/p&gt;</comment>
                            <comment id="13006972" author="alangates" created="Tue, 15 Mar 2011 15:30:49 +0000"  >&lt;p&gt;Reviewing the patch.&lt;/p&gt;</comment>
                            <comment id="13008042" author="alangates" created="Thu, 17 Mar 2011 18:02:01 +0000"  >&lt;p&gt;Patch looks good.  I&apos;m running the tests and test-patch.&lt;/p&gt;</comment>
                            <comment id="13008196" author="alangates" created="Thu, 17 Mar 2011 22:40:12 +0000"  >&lt;p&gt;Results of test-patch:&lt;/p&gt;

&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; -1 overall.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 tests included.  The patch appears to include 3 new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 release audit.  The applied patch generated 539 release audit warnings (more than the trunk&apos;s current 538 warnings).&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;As far as I can tell you can ignore this release audit warning.&lt;/p&gt;</comment>
                            <comment id="13008311" author="deepujain" created="Fri, 18 Mar 2011 03:45:41 +0000"  >&lt;p&gt;Hi Allan,&lt;br/&gt;
What do you mean by release audit warning ?&lt;/p&gt;</comment>
                            <comment id="13009331" author="alangates" created="Mon, 21 Mar 2011 19:43:52 +0000"  >&lt;p&gt;test-patch uses a tool to audit the files and make sure they are ok to release (have appropriate headers, etc.)  But it gives a lot of bogus warnings, of which this seems to be one.&lt;/p&gt;

&lt;p&gt;The unit tests pass, so I&apos;ll check this in.&lt;/p&gt;</comment>
                            <comment id="13009342" author="alangates" created="Mon, 21 Mar 2011 20:11:51 +0000"  >&lt;p&gt;Patch checked in.  Thanks Deepak.&lt;/p&gt;</comment>
                            <comment id="13009996" author="deepujain" created="Wed, 23 Mar 2011 05:01:24 +0000"  >&lt;p&gt;Yee-Haw&lt;br/&gt;
2nd Commit.&lt;/p&gt;</comment>
                            <comment id="13009997" author="deepujain" created="Wed, 23 Mar 2011 05:02:32 +0000"  >&lt;p&gt;Should i move the issue to resolved state? (Resolve Issue)&lt;/p&gt;</comment>
                            <comment id="13010185" author="alangates" created="Wed, 23 Mar 2011 15:44:15 +0000"  >&lt;p&gt;Actually, I&apos;m supposed to do that when I check in the patch.  Thanks for catching that.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12473412" name="PIG-671.txt" size="10672" author="deepujain" created="Fri, 11 Mar 2011 17:40:33 +0000"/>
                            <attachment id="12473019" name="PIG-671.txt" size="1594" author="deepujain" created="Tue, 8 Mar 2011 18:11:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 Mar 2011 06:11:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66286</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyahj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95151</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>The fix is tested against 0.9 Pig source.&lt;br/&gt;
Unit test cases included.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>