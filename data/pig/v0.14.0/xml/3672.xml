<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:59:07 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3672/PIG-3672.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3672] Pig should not check for hardcoded file system implementations</title>
                <link>https://issues.apache.org/jira/browse/PIG-3672</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;QueryParserUtils.java has the code - &lt;br/&gt;
result.add(&quot;hdfs://&quot;&lt;ins&gt;thisHost&lt;/ins&gt;&quot;:&quot;+uri.getPort());&lt;/p&gt;

&lt;p&gt;I propose to make it generic like - &lt;br/&gt;
result.add(uri.getScheme() + &quot;://&quot;&lt;ins&gt;thisHost&lt;/ins&gt;&quot;:&quot;+uri.getPort());&lt;/p&gt;

&lt;p&gt;Similarly jobControlCompiler.java has - &lt;br/&gt;
if (!outputPathString.contains(&quot;://&quot;) || outputPathString.startsWith(&quot;hdfs://&quot;)) {&lt;/p&gt;

&lt;p&gt; I have a patch version which I ran passing unit tests on. Will be uploading it shortly.  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12689398">PIG-3672</key>
            <summary>Pig should not check for hardcoded file system implementations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rohini">Rohini Palaniswamy</assignee>
                                    <reporter username="suhassatish">Suhas Satish</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Jan 2014 23:30:30 +0000</created>
                <updated>Mon, 7 Jul 2014 19:07:50 +0100</updated>
                            <resolved>Wed, 30 Apr 2014 15:01:01 +0100</resolved>
                                    <version>0.10.0</version>
                    <version>0.12.0</version>
                    <version>0.11.1</version>
                                    <fixVersion>0.13.0</fixVersion>
                                    <component>data</component>
                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13874240" author="suhassatish" created="Fri, 17 Jan 2014 00:58:23 +0000"  >&lt;p&gt;This patch addresses the hdfs:// hardcoding and calls generic uri.getScheme() to get the file system implementation. &lt;/p&gt;</comment>
                            <comment id="13874871" author="rohini" created="Fri, 17 Jan 2014 15:32:21 +0000"  >&lt;p&gt;Few comments:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;WeightedRangePartitioner.java and MapredUtil.java&lt;br/&gt;
     Please do not add custom file formats. You can iterate through the configuration and if the key starts with &quot;fs.&quot; and ends with &quot;.impl&quot; set that in the new configuration so that it is generic. Wondering how this was working before for s3. &lt;/li&gt;
	&lt;li&gt;QueryParserUtils.java&lt;br/&gt;
    a) Can you add the Utils.hasFileSystemImpl check for the scheme before adding to remote host. hbase:// currently is skipped because there is no host. But this would future proof for other schemes that pig might support in future which has host as well but no filesystem implementation. &lt;br/&gt;
    b) If har is the scheme, then you need to return hdfs:// in the remote host&lt;/li&gt;
	&lt;li&gt;JobControlCompiler.java&lt;br/&gt;
   !fileuri.getScheme().equals(&quot;file:///&quot;) condition is wrong. Even if &lt;a href=&quot;file://&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file://&lt;/a&gt; we should write to output directory. You can just change &lt;br/&gt;
if (!outputPathString.contains(&quot;://&quot;) || outputPathString.startsWith(&quot;hdfs://&quot;)) { &lt;br/&gt;
to &lt;br/&gt;
if (Utils.hasFileSystemImpl(new Path(outputPathString), conf)) {&lt;br/&gt;
   That should take care of fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1424&quot; title=&quot;Error logs of streaming should not be placed in output location&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1424&quot;&gt;PIG-1424&lt;/a&gt; as well.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13875475" author="suhassatish" created="Sat, 18 Jan 2014 01:32:44 +0000"  >&lt;ul&gt;
	&lt;li&gt;Removed custom file formats from WeightedRangePartitioner.java and MapredUtil.java as I realized this was not really required and was not being used anywhere.&lt;/li&gt;
	&lt;li&gt;QueryParserUtils.java
	&lt;ul&gt;
		&lt;li&gt;a) Do you mean to add the check at the code block shown in the diff below  ? The problem with this is that there is no access to Configuration object in QueryParserUtils.java. Do you have recommendations on how and where to instantiate a conf object to pass into Utils.hasFileSystemImpl as an argument?&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;blockquote&gt;
&lt;p&gt;                  String scheme = uri.getScheme();&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (scheme!=null &amp;amp;&amp;amp; scheme.toLowerCase().equals(&quot;hdfs&quot;)||sc&lt;br/&gt;
+                 if (scheme!=null &amp;amp;&amp;amp; Utils.hasFileSystemImpl(p,conf)) {&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;b) Is this currently being returned correctly for &quot;har&quot; in trunk? If so,  this change would handle it right?
&lt;blockquote&gt;
&lt;p&gt;                 if (scheme!=null &amp;amp;&amp;amp; Utils.hasFileSystemImpl(p,conf)) {&lt;br/&gt;
                     if (uri.getHost()==null)&lt;br/&gt;
                         continue;&lt;br/&gt;
                     String thisHost = uri.getHost().toLowerCase();&lt;br/&gt;
                     if (scheme.toLowerCase().equals(&quot;har&quot;)) {&lt;br/&gt;
                         if (thisHost.startsWith(HAR_PREFIX)) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
                             thisHost = thisHost.substring(HAR_PREFIX.length());
                         }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;			 scheme=&quot;hdfs&quot;;&lt;br/&gt;
                     }&lt;br/&gt;
                     if (!uri.getHost().isEmpty() &amp;amp;&amp;amp; &lt;br/&gt;
                             !thisHost.equals(defaultHost)) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
                         if (uri.getPort()!=-1)
                             result.add(scheme + &amp;quot;}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;                 }&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;JobControlCompiler.java&lt;br/&gt;
This has been taken care of as -
&lt;blockquote&gt;
&lt;p&gt;                String outputPathString = st.getSFile().getFileName();&lt;br/&gt;
 		if (Utils.hasFileSystemImpl(new Path(outputPathString), conf)) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
                    conf.set(&amp;quot;pig.streaming.log.dir&amp;quot;,
                            new Path(outputPathString, LOG_DIR).toString());
                }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else {&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13882557" author="rohini" created="Mon, 27 Jan 2014 04:15:03 +0000"  >&lt;p&gt;Logic looks fine. &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3672&quot; title=&quot;Pig should not check for hardcoded file system implementations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3672&quot;&gt;&lt;del&gt;PIG-3672&lt;/del&gt;&lt;/a&gt;-2.patch does not compile as it does not include imports for Utils class and conf is a unknown variable (Create configuration from pigContext.getProperties()). Please fix them. Also please format the code. &lt;/p&gt;</comment>
                            <comment id="13887103" author="dvryaboy" created="Thu, 30 Jan 2014 21:43:44 +0000"  >&lt;p&gt;cancelling patch available status given Rohini&apos;s comments &amp;#8211; please make patch available again when a new patch is submitted&lt;/p&gt;</comment>
                            <comment id="13932165" author="rohini" created="Wed, 12 Mar 2014 18:44:29 +0000"  >&lt;p&gt;We hit some issues with webhdfs and I have a patch. Also Utils.hasFileSystemImpl() logic needs to change for hadoop-2. Assigning to myself. &lt;/p&gt;</comment>
                            <comment id="13977081" author="rohini" created="Tue, 22 Apr 2014 18:25:51 +0100"  >&lt;p&gt;This patch&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;handles recent change in hadoop (&lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-7549&quot; title=&quot;Use JDK ServiceLoader mechanism to find FileSystem implementations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-7549&quot;&gt;&lt;del&gt;HADOOP-7549&lt;/del&gt;&lt;/a&gt;) w.r.t to getting filesystem implementations.&lt;/li&gt;
	&lt;li&gt;handles configuring mapreduce.job.hdfs-servers correctly for other schemes like webhdfs, viewfs, etc.&lt;/li&gt;
	&lt;li&gt;Fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3796&quot; title=&quot;PigStats output bytes written not collected for relative paths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3796&quot;&gt;&lt;del&gt;PIG-3796&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13980606" author="daijy" created="Fri, 25 Apr 2014 02:30:20 +0100"  >&lt;p&gt;+1 for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3672&quot; title=&quot;Pig should not check for hardcoded file system implementations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3672&quot;&gt;&lt;del&gt;PIG-3672&lt;/del&gt;&lt;/a&gt;-3.patch&lt;/p&gt;
</comment>
                            <comment id="13985548" author="rohini" created="Wed, 30 Apr 2014 15:01:01 +0100"  >&lt;p&gt;Committed to trunk. Thanks Daniel for the reivew.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12698748">PIG-3796</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12623557" name="PIG-3672-1.patch" size="4587" author="suhassatish" created="Fri, 17 Jan 2014 01:44:00 +0000"/>
                            <attachment id="12623764" name="PIG-3672-2.patch" size="2493" author="suhassatish" created="Sat, 18 Jan 2014 01:41:49 +0000"/>
                            <attachment id="12641286" name="PIG-3672-3.patch" size="46032" author="rohini" created="Tue, 22 Apr 2014 18:26:36 +0100"/>
                            <attachment id="12623552" name="PIG-3672.patch" size="6242" author="suhassatish" created="Fri, 17 Jan 2014 00:57:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Jan 2014 15:32:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>368365</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxu95b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>293</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>