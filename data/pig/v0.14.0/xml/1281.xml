<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:48:53 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1281/PIG-1281.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1281] Detect org.apache.pig.data.DataByteArray cannot be cast to org.apache.pig.data.Tuple type of errors at Compile Type during creation of logical plan</title>
                <link>https://issues.apache.org/jira/browse/PIG-1281</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;This is more of an enhancement request, where we can detect simple errors during compile time during creation of Logical plan rather than at the backend.&lt;/p&gt;

&lt;p&gt;I created a script which contains an error which gets detected in the backend as a cast error when in fact we can detect it in the front end(group is a single element so group.$0 projection operation will not work).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
inputdata = LOAD &apos;/user/viraj/mymapdata&apos; AS (co1, col2, col3, col4);

projdata = FILTER inputdata BY (col1 is not &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);

groupprojdata = GROUP projdata BY col1;

cleandata = FOREACH groupprojdata {
                     bagproj = projdata.col1;
                     dist_bags = DISTINCT bagproj;
                     GENERATE group.$0 as newcol1, COUNT(dist_bags) as newcol2;
                      };

cleandata1 = GROUP cleandata by newcol2;

cleandata2 = FOREACH cleandata1 { GENERATE group.$0 as finalcol1, COUNT(cleandata.newcol1) as finalcol2; };

ordereddata = ORDER cleandata2 by finalcol2;

store into &apos;finalresult&apos; using PigStorage();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12458328">PIG-1281</key>
            <summary>Detect org.apache.pig.data.DataByteArray cannot be cast to org.apache.pig.data.Tuple type of errors at Compile Type during creation of logical plan</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thejas">Thejas M Nair</assignee>
                                    <reporter username="viraj">Viraj Bhat</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Mar 2010 01:03:06 +0000</created>
                <updated>Thu, 4 Aug 2011 01:34:38 +0100</updated>
                            <resolved>Wed, 20 Apr 2011 23:44:36 +0100</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12892462" author="olgan" created="Mon, 26 Jul 2010 22:01:45 +0100"  >&lt;p&gt;0.9 release will be dedicated to improved error handling.&lt;/p&gt;</comment>
                            <comment id="12929803" author="olgan" created="Mon, 8 Nov 2010 23:14:35 +0000"  >&lt;p&gt;Discussed this with Daniel. Here is what needs to happen:&lt;/p&gt;

&lt;p&gt;(1) If type is specified at load time or through cast, typechecker should detect the problem.&lt;br/&gt;
(2) Otherwise, frontend needs to insert cast to a tuple and let backend figure out if the real data contains the tuple.&lt;/p&gt;

&lt;p&gt;Neither of this is happenning right now.&lt;/p&gt;

&lt;p&gt;Please, note that the problem with the script identified in the ticket can&apos;t be detected at frontend because the type info is missing.&lt;/p&gt;</comment>
                            <comment id="12929804" author="olgan" created="Mon, 8 Nov 2010 23:15:08 +0000"  >&lt;p&gt;Asigning to Thejas as he will be working on porting the typechecker to the new logical plan&lt;/p&gt;</comment>
                            <comment id="13020106" author="thejas" created="Fri, 15 Apr 2011 00:40:24 +0100"  >&lt;blockquote&gt;
&lt;p&gt;Discussed this with Daniel. Here is what needs to happen:&lt;br/&gt;
(1) If type is specified at load time or through cast, typechecker should detect the problem.&lt;br/&gt;
(2) Otherwise, frontend needs to insert cast to a tuple and let backend figure out if the real data contains the tuple.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The col.$0 syntax is applicable to both tuple and bag. So casting it to Tuple is not right. &lt;br/&gt;
I think pig should ideally at run time determine if the input is a Tuple or Bag and return column(s) or bag(s).&lt;br/&gt;
That is more than a type checker change, I will open another jira to test/fix that. (I need (to create) a LoadFunc that does not return a schema, but also returns tuple or bag objects).&lt;br/&gt;
I will address the case (1) in this jira.&lt;/p&gt;
</comment>
                            <comment id="13020450" author="thejas" created="Fri, 15 Apr 2011 23:01:35 +0100"  >&lt;p&gt;Created &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1997&quot; title=&quot;define semantics of referring to a column within bytearray column &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1997&quot;&gt;PIG-1997&lt;/a&gt; to address the case when column is of type bytearray.&lt;/p&gt;</comment>
                            <comment id="13022387" author="xuefuz" created="Wed, 20 Apr 2011 22:48:01 +0100"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Had a discussion with Thejas about the root of the problem. The puzzle we have right now is caused by two issues:&lt;/p&gt;

&lt;p&gt;1. bag proj and tuple proj share the same syntax, so no casting can be effectively applied.&lt;br/&gt;
2. bytearray is used as unknown(unspecified) type as well as real byte sequence type.&lt;/p&gt;

&lt;p&gt;The patch only catches the illegal projection where the type is known, and not either tuple type or bag type.&lt;/p&gt;</comment>
                            <comment id="13022405" author="thejas" created="Wed, 20 Apr 2011 23:44:36 +0100"  >&lt;p&gt;unit test and test-patch passed.&lt;br/&gt;
Patch committed to trunk and 0.9 branch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12504114">PIG-1992</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12504415">PIG-1997</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12476498" name="PIG-1281.1.patch" size="13549" author="thejas" created="Sat, 16 Apr 2011 00:31:40 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 26 Jul 2010 21:01:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66325</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaonj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96305</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>