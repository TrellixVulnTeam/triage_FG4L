<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:01:29 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1917/PIG-1917.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1917] NativeMapReduce does not Allow Configuration Parameters containing Spaces </title>
                <link>https://issues.apache.org/jira/browse/PIG-1917</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;In Pig, NativeMapReduce does not allow Configuration parameters which contain spaces.&lt;/p&gt;

&lt;p&gt;Considering a simple pig script with &lt;em&gt;wordcount&lt;/em&gt; as Native M-R job.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;nativeMR.pig&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
A = load &apos;input/WordCountInput.txt&apos;;
B = MAPREDUCE &apos;hadoop-examples.jar&apos; Store A into &apos;inputDir&apos; Load &apos;outputDir&apos; as (word:chararray, count:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;) `wordcount -Dmapred.job.map.memory.mb=3072 -Dmapred.child.java.opts=&lt;span class=&quot;code-quote&quot;&gt;&quot;-Xmx1536m -Xss128k&quot;&lt;/span&gt; inputDir outputDir`;
store B into &apos;output/WordCount&apos; using PigStorage;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above pig script fails while launching native MAPREDUCE job. Because space after &lt;em&gt;-Dmapred.child.java.opts=&quot;-Xmx1536m&lt;/em&gt; makes&lt;br/&gt;
&lt;em&gt;-Xss128k&quot;&lt;/em&gt; as the first argument to &lt;em&gt;wordcount&lt;/em&gt;&lt;br/&gt;
Even with other example M-R program, the parameter &lt;em&gt;mapred.child.java.opts&lt;/em&gt; was assigned &lt;em&gt;&quot;-Xmx1536m&lt;/em&gt; in Jobconf.&lt;/p&gt;

&lt;p&gt;Physical plan, Logical plan, and M-R plan of pig show double quotes. &lt;br/&gt;
For example, here is the corresponding M-R Plan for the native M-R &quot;MAPREDUCE&quot; statement.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
MapReduce node scope-13
hadoop jar hadoop-examples.jar wordcount -Dmapred.job.map.memory.mb=3072 -Dmapred.child.java.opts=&lt;span class=&quot;code-quote&quot;&gt;&quot;-Xmx1536m -Xss128k&quot;&lt;/span&gt; inputDir outputDir
--------
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On executing above M-R job after copying  &apos;input/WordCountInput.txt&apos; into &apos;inputDir/&apos;, as Hadoop Job, this ran successfully.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ *hadoop jar hadoop-examples.jar wordcount -Dmapred.job.map.memory.mb=3072 -Dmapred.child.java.opts=&lt;span class=&quot;code-quote&quot;&gt;&quot;-Xmx1536m -Xss128k&quot;&lt;/span&gt; inputDir outputDir*
11/03/18 14:23:29 INFO input.FileInputFormat: Total input paths to process : 1
11/03/18 14:23:29 INFO mapred.JobClient: Running job: job_201103181353_0007
11/03/18 14:23:30 INFO mapred.JobClient:  map 0% reduce 0%
11/03/18 14:23:37 INFO mapred.JobClient:  map 100% reduce 0%
11/03/18 14:23:49 INFO mapred.JobClient:  map 100% reduce 100%
11/03/18 14:23:51 INFO mapred.JobClient: Job complete: job_201103181353_0007
...
...

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Whereas, when  &lt;em&gt;-Dmapred.child.java.opts=-Xmx1536m&lt;/em&gt; was used, the &lt;b&gt;nativeMR.pig&lt;/b&gt; executed successfully.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12501771">PIG-1917</key>
            <summary>NativeMapReduce does not Allow Configuration Parameters containing Spaces </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thejas">Thejas M Nair</assignee>
                                    <reporter username="miteshsjat">Mitesh Singh Jat</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Mar 2011 09:47:44 +0000</created>
                <updated>Thu, 4 Aug 2011 01:34:37 +0100</updated>
                            <resolved>Tue, 12 Apr 2011 23:31:18 +0100</resolved>
                                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13017197" author="thejas" created="Fri, 8 Apr 2011 00:05:41 +0100"  >&lt;p&gt;The pig parser is parsing the argument &quot;-Dmapred.child.java.opts=&apos;-Xmx1536m -Xss128k&apos;&quot; to native mapreduce as two arguments &quot;-Dmapred.child.java.opts=&apos;-Xmx1536m&quot; and &quot;-Xss128k&apos;&quot; .&lt;/p&gt;

&lt;p&gt;To support this use case, we need to parse it as one argument and remove the single quotes, similar to what bash shell does  - &quot;-Dmapred.child.java.opts=-Xmx1536m -Xss128k&quot; (note the missing single quotes). &lt;/p&gt;

&lt;p&gt;In general, quoted arguments should be unquoted before being given as argument to native-mapreduce or streaming command, to simulate what the shell does. This would be a change in behavior that is not backward compatible. But it is a problem only if users rely on the delimiter quotes being included in the argument.&lt;/p&gt;</comment>
                            <comment id="13017219" author="thejas" created="Fri, 8 Apr 2011 01:33:39 +0100"  >&lt;p&gt;To avoid breaking backward compatibility while supporting this use case, one option would be to have a way to switch to the mode that supports this use case.&lt;/p&gt;

&lt;p&gt;Maybe by adding a &quot; using &apos;unquote-mode&apos; &quot; to the command ?&lt;/p&gt;

&lt;p&gt;eg . &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
B = MAPREDUCE &apos;hadoop-examples.jar&apos; Store A into &apos;inputDir&apos; Load &apos;outputDir&apos; as (word:chararray, count:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)  
`wordcount -Dmapred.job.map.memory.mb=3072 -Dmapred.child.java.opts=&lt;span class=&quot;code-quote&quot;&gt;&quot;-Xmx1536m -Xss128k&quot;&lt;/span&gt; inputDir outputDir` using &apos;unquote-mode&apos;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or maybe by setting a system property on commandline - &lt;br/&gt;
-Dpig.unquote.cmdstring=&apos;true&apos;&lt;br/&gt;
I think adding a system property is better, as it does not pollute the syntax.&lt;/p&gt;


&lt;p&gt;In 0.9, maybe we can make the unquote mode the default mode.&lt;/p&gt;
</comment>
                            <comment id="13017678" author="thejas" created="Fri, 8 Apr 2011 22:52:59 +0100"  >&lt;p&gt;The change to parse  &quot;-Dmapred.child.java.opts=&apos;-Xmx1536m -Xss128k&apos;&quot; as one argument is also going to break backward compatibility, if any existing pig script is (accidentally) relying on that behavior. So making this change only for 0.9. &lt;br/&gt;
Also, instead of unquoting all arguments, only the &quot;-D&quot; property arguments will be unquoted. This change will only affect Native map-reduce statements (ie, not streaming command).&lt;/p&gt;</comment>
                            <comment id="13019054" author="rding" created="Tue, 12 Apr 2011 22:18:32 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13019093" author="thejas" created="Tue, 12 Apr 2011 23:31:18 +0100"  >&lt;p&gt;Unit test and test-patch passed.&lt;br/&gt;
Patch committed to trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12475999" name="PIG-1917.1.patch" size="6813" author="thejas" created="Mon, 11 Apr 2011 15:10:53 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 7 Apr 2011 23:05:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66329</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyauhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97249</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>