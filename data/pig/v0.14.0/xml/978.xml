<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:01:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-978/PIG-978.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-978] ERROR 2100 (hdfs://localhost/tmp/temp175740929/tmp-1126214010 does not exist) and ERROR 2999: (Unexpected internal error. null) when using Multi-Query optimization</title>
                <link>https://issues.apache.org/jira/browse/PIG-978</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;I have  Pig script of this form.. which I execute using Multi-query optimization.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
A = load &apos;/user/viraj/firstinput&apos; using PigStorage();
B = group ....
C = ..agrregation function
store C into &apos;/user/viraj/firstinputtempresult/days1&apos;;
..
Atab = load &apos;/user/viraj/secondinput&apos; using PigStorage();
Btab = group ....
Ctab = ..agrregation function
store Ctab into &apos;/user/viraj/secondinputtempresult/days1&apos;;
..
E = load &apos;/user/viraj/firstinputtempresult/&apos; using PigStorage();
F = group 
G = aggregation function
store G into &apos;/user/viraj/finalresult1&apos;;

Etab = load &apos;/user/viraj/secondinputtempresult/&apos; using PigStorage();
Ftab = group 
Gtab = aggregation function
store Gtab into &apos;/user/viraj/finalresult2&apos;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;2009-07-20 22:05:44,507 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.tools.grunt.GruntParser - ERROR 2100: hdfs://localhost/tmp/temp175740929/tmp-1126214010 does not exist. Details at logfile: /homes/viraj/pigscripts/pig_1248127173601.log)  &lt;/p&gt;

&lt;p&gt;is due to the mismatch of store/load commands. The script first stores files into the &apos;days1&apos; directory (store C into &apos;/user/viraj/firstinputtempresult/days1&apos; using PigStorage()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, but it later loads from the top level directory (E = load &apos;/user/viraj/firstinputtempresult/&apos; using PigStorage()) instead of the original directory (/user/viraj/firstinputtempresult/days1).&lt;/p&gt;

&lt;p&gt;The current multi-query optimizer can&apos;t solve the dependency between these two commands--they have different load file paths. So the jobs will run concurrently and result in the errors.&lt;/p&gt;

&lt;p&gt;The solution is to add &apos;exec&apos; or &apos;run&apos; command after the first two stores . This will force the first two store commands to run before the rest commands.&lt;/p&gt;

&lt;p&gt;It would be nice to see this fixed as a part of an enhancement to the Multi-query. We either disable the Multi-query or throw a warning/error message, so that the user can correct his load/store statements.&lt;/p&gt;

&lt;p&gt;Viraj&lt;/p&gt;</description>
                <environment></environment>
        <key id="12436654">PIG-978</key>
            <summary>ERROR 2100 (hdfs://localhost/tmp/temp175740929/tmp-1126214010 does not exist) and ERROR 2999: (Unexpected internal error. null) when using Multi-Query optimization</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chandec">Corinne Chandel</assignee>
                                    <reporter username="viraj">Viraj Bhat</reporter>
                        <labels>
                    </labels>
                <created>Sat, 26 Sep 2009 00:04:21 +0100</created>
                <updated>Wed, 24 Mar 2010 22:15:55 +0000</updated>
                            <resolved>Tue, 1 Dec 2009 21:49:48 +0000</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.6.0</fixVersion>
                                    <component>documentation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12762337" author="olgan" created="Mon, 5 Oct 2009 21:06:47 +0100"  >&lt;p&gt;Richard, please, provide information necessary to document this issue.&lt;/p&gt;</comment>
                            <comment id="12762339" author="olgan" created="Mon, 5 Oct 2009 21:07:31 +0100"  >&lt;p&gt;Viraj,&lt;/p&gt;

&lt;p&gt;We have no plan to address this dependency. This will need to be documented as one of the implicit dependencies that need to be resolved by the user.&lt;/p&gt;</comment>
                            <comment id="12770227" author="rding" created="Mon, 26 Oct 2009 21:55:53 +0000"  >&lt;p&gt;In Pig Latin Manual, this is called &quot;Implicit Dependencies in Multi-Query Execution&quot;: &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;b&gt;Implicit Dependencies&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;If a script has dependencies on the execution order outside of what Pig knows about, execution may fail. For instance, in this script MYUDF might try to read from out1, a file that A was just stored into. However, Pig does not know that MYUDF depends on the out1 file and might submit the jobs producing the out2 and out1 files at the same time. To make the script work (to ensure that the right execution order is enforced) add the exec statement. The exec statement will trigger the execution of the statements that produce the out1 file.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The Pig script in this Jira shows another form of those &quot;implicit dependencies&quot; in multi-query scripts. Namely, the store/load operators have different file paths, but the load operator actually depends the store operator. An exec statement should be inserted between the store and load statements to ensure the right execution order is enforced.&lt;/p&gt;</comment>
                            <comment id="12783873" author="chandec" created="Mon, 30 Nov 2009 22:07:56 +0000"  >&lt;p&gt;Patch file.&lt;/p&gt;

&lt;p&gt;Upated Pig Latin Users Guide: Implicit Dependencies&lt;/p&gt;</comment>
                            <comment id="12783875" author="chandec" created="Mon, 30 Nov 2009 22:09:56 +0000"  >&lt;p&gt;Apply patch to trunk: &lt;a href=&quot;http://svn.apache.org/repos/asf/hadoop/pig/trunk&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/hadoop/pig/trunk&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Note: No new test code required; changes to documentation only.&lt;/p&gt;</comment>
                            <comment id="12784087" author="hadoopqa" created="Tue, 1 Dec 2009 06:58:18 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12426454/pig-latin-users-guide.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12426454/pig-latin-users-guide.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 885465.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +0 tests included.  The patch appears to be a documentation patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/69/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/69/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/69/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/69/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/69/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/69/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12784415" author="olgan" created="Tue, 1 Dec 2009 20:52:09 +0000"  >&lt;p&gt;Corinne,&lt;/p&gt;

&lt;p&gt;The comment from Richard is that exec or run should go after the second store but in your example, it is after the third one.&lt;/p&gt;</comment>
                            <comment id="12784443" author="chandec" created="Tue, 1 Dec 2009 21:27:28 +0000"  >&lt;p&gt;Patch #2 (moved EXEC statement).&lt;/p&gt;

&lt;p&gt;Opps. I actually walked over asked Richard where the EXEC should go, but I guess things got mixed up.&lt;/p&gt;</comment>
                            <comment id="12784454" author="olgan" created="Tue, 1 Dec 2009 21:49:48 +0000"  >&lt;p&gt;Patch committed to both the trunk and 0.6 branch. Thanks, Corinne!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12426581" name="pig-latin-users-guide-2.patch" size="2809" author="chandec" created="Tue, 1 Dec 2009 21:27:28 +0000"/>
                            <attachment id="12426454" name="pig-latin-users-guide.patch" size="2809" author="chandec" created="Mon, 30 Nov 2009 22:07:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 5 Oct 2009 20:06:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164515</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyal3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95731</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>