<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:49:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2746/PIG-2746.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2746] Pig doesn&apos;t detect all forms of compression extensions properly</title>
                <link>https://issues.apache.org/jira/browse/PIG-2746</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The PigStorage has the following snippet.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void setCompression(Path path, Job job) {
     	&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; location=path.getName();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (location.endsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;.bz2&quot;&lt;/span&gt;) || location.endsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;.bz&quot;&lt;/span&gt;)) {
            FileOutputFormat.setCompressOutput(job, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
            FileOutputFormat.setOutputCompressorClass(job,  BZip2Codec.class);
        }  &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (location.endsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;.gz&quot;&lt;/span&gt;)) {
            FileOutputFormat.setCompressOutput(job, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
            FileOutputFormat.setOutputCompressorClass(job, GzipCodec.class);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            FileOutputFormat.setCompressOutput( job, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This limits it to only work with STORE filenames provided as &apos;output.gz&apos; or &apos;output.bz2&apos; and for the rest (like LZO) one has to specify codecs and manually enable compression.&lt;/p&gt;

&lt;p&gt;Ideally Pig can rely on Hadoop&apos;s extension-to-codec detector instead of having this ladder.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12560124">PIG-2746</key>
            <summary>Pig doesn&apos;t detect all forms of compression extensions properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="qwertymaniac">Harsh J</assignee>
                                    <reporter username="qwertymaniac">Harsh J</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Jun 2012 07:35:57 +0100</created>
                <updated>Thu, 2 May 2013 03:29:54 +0100</updated>
                                            <version>0.8.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13292661" author="prkommireddi" created="Mon, 11 Jun 2012 07:46:55 +0100"  >&lt;p&gt;Hi Harsh, where can I find the code for extension-to-codec on hadoop?&lt;/p&gt;</comment>
                            <comment id="13292698" author="qwertymaniac" created="Mon, 11 Jun 2012 09:59:46 +0100"  >&lt;p&gt;Should be doable in 0.20/1.0 at least via using the Path over the registered codec factory:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
CompressionCodecFactory cf = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CompressionCodecFactory(getConf());
CompressionCodec codec = cf.getCodec(p);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll have to test this one&apos;s validity cross-versions (1 vs. 2) and then post a patch.&lt;/p&gt;</comment>
                            <comment id="13292754" author="qwertymaniac" created="Mon, 11 Jun 2012 12:18:52 +0100"  >&lt;p&gt;This patch ought to do it. However, where are the storage compression tests? I could not find them in PigStorage or in TestCompressedFiles tests? Should I add a new one with BZ2 (since its java-based and won&apos;t be platform dependent)?&lt;/p&gt;</comment>
                            <comment id="13292758" author="qwertymaniac" created="Mon, 11 Jun 2012 12:27:49 +0100"  >&lt;p&gt;I didn&apos;t pay attention to Pig&apos;s code style last round and used Hadoop&apos;s style instead. Fixed indentation in this one.&lt;/p&gt;</comment>
                            <comment id="13295462" author="qwertymaniac" created="Fri, 15 Jun 2012 06:44:34 +0100"  >&lt;p&gt;Ping, any comments on the patch and if a specific test is required (in case this isn&apos;t covered already) where can I find a good STORE example to add a test?&lt;/p&gt;</comment>
                            <comment id="13393499" author="daijy" created="Sun, 17 Jun 2012 09:31:13 +0100"  >&lt;p&gt;Any new compressions supported other than lzo?&lt;/p&gt;</comment>
                            <comment id="13393504" author="qwertymaniac" created="Sun, 17 Jun 2012 10:01:14 +0100"  >&lt;p&gt;Daniel,&lt;/p&gt;

&lt;p&gt;Unsure if I understood your question right:&lt;/p&gt;

&lt;p&gt;This code will support whatever has been provided in the compression codecs list of Hadoop (Wherein LZO has to be registered). In 1.x the property is called io.compression.codecs.&lt;/p&gt;

&lt;p&gt;It removes need to have per-codec/extension code, and relies on the codec itself to accept an extension and provide itself.&lt;/p&gt;</comment>
                            <comment id="13393505" author="qwertymaniac" created="Sun, 17 Jun 2012 10:02:23 +0100"  >&lt;p&gt;Or if you ask generally what all other codecs exist, there&apos;s deflate (default), snappy, lz4 in Hadoop itself today, and many more out there (A pluggable interface, CompressionCodec is).&lt;/p&gt;</comment>
                            <comment id="13393599" author="daijy" created="Sun, 17 Jun 2012 21:10:26 +0100"  >&lt;p&gt;Hi, Harsh,&lt;br/&gt;
All I want to see if there is a way to create a proper test case. It is hard to include a lzo test. If we can have some new compression which is easy to include in e2e test, that will be great.&lt;/p&gt;</comment>
                            <comment id="13400004" author="qwertymaniac" created="Sat, 23 Jun 2012 19:02:12 +0100"  >&lt;p&gt;Daniel,&lt;/p&gt;

&lt;p&gt;We can use BZ2 as that is a non-native codec and can work for tests. I&apos;ve updated the patch to add a new test method (none of the existing tests seem to cover this area), that uses bz2 automatically, via TestPigStorage.&lt;/p&gt;</comment>
                            <comment id="13401664" author="qwertymaniac" created="Tue, 26 Jun 2012 21:32:17 +0100"  >&lt;p&gt;Daniel/Others,&lt;/p&gt;

&lt;p&gt;Does the provided test suffice? Is there anything else you&apos;d like me to address to get this in? Do let me know!&lt;/p&gt;</comment>
                            <comment id="13402440" author="daijy" created="Wed, 27 Jun 2012 19:32:44 +0100"  >&lt;p&gt;Sounds good. &lt;/p&gt;

&lt;p&gt;Patch committed to trunk.&lt;/p&gt;

&lt;p&gt;Thanks Harsh!&lt;/p&gt;</comment>
                            <comment id="13407739" author="daijy" created="Fri, 6 Jul 2012 07:30:32 +0100"  >&lt;p&gt;The patch break TestBZip.testBz2. See &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2391&quot; title=&quot;Bzip_2 test is broken&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2391&quot;&gt;&lt;del&gt;PIG-2391&lt;/del&gt;&lt;/a&gt;. Revert the patch temporarily until we have a new patch.&lt;/p&gt;</comment>
                            <comment id="13407751" author="qwertymaniac" created="Fri, 6 Jul 2012 08:12:40 +0100"  >&lt;p&gt;Thanks for reverting this Daniel. I am sorry I didn&apos;t see that test.&lt;/p&gt;

&lt;p&gt;I went over that JIRA and it looks like the issue was that the &apos;.bz&apos; files were not detected by the factory approach (essentially Bzip2Codec rejected knowing .bz files, not the factory itself).&lt;/p&gt;

&lt;p&gt;I&apos;ve opened &lt;a href=&quot;https://issues.apache.org/jira/browse/HADOOP-8570&quot; title=&quot;Bzip2Codec should accept .bz files too&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HADOOP-8570&quot;&gt;HADOOP-8570&lt;/a&gt; for tackling this upstream. For the moment, Pig can use a temporary workaround with a note, for which I&apos;ll re-attach my patch.&lt;/p&gt;</comment>
                            <comment id="13408127" author="daijy" created="Fri, 6 Jul 2012 17:23:12 +0100"  >&lt;p&gt;Thanks for quick response. I am happy to review your new patch.&lt;/p&gt;</comment>
                            <comment id="13408667" author="qwertymaniac" created="Sat, 7 Jul 2012 14:19:58 +0100"  >&lt;p&gt;Here&apos;s a patch that evolves over the previous one, but adds in a wrapper for .bz to not regress (in comparison with the older conditions).&lt;/p&gt;</comment>
                            <comment id="13408837" author="daijy" created="Sun, 8 Jul 2012 03:58:21 +0100"  >&lt;p&gt;Hi, Harsh,&lt;br/&gt;
I get several test failure due to NPE in PigStorage:416&lt;/p&gt;</comment>
                            <comment id="13500560" author="julienledem" created="Mon, 19 Nov 2012 19:43:19 +0000"  >&lt;p&gt;Will go in a future release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12597701">HADOOP-8570</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12535527" name="PIG-2746.patch" size="3756" author="qwertymaniac" created="Sat, 7 Jul 2012 14:19:58 +0100"/>
                            <attachment id="12533187" name="PIG-2746.patch" size="3365" author="qwertymaniac" created="Sat, 23 Jun 2012 19:02:12 +0100"/>
                            <attachment id="12531663" name="PIG-2746.patch" size="1803" author="qwertymaniac" created="Mon, 11 Jun 2012 12:27:49 +0100"/>
                            <attachment id="12531659" name="PIG-2746.patch" size="1837" author="qwertymaniac" created="Mon, 11 Jun 2012 12:18:52 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 11 Jun 2012 06:46:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>255761</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy9p6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>90559</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>