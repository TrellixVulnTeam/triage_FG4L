<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:09:17 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3169/PIG-3169.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3169] Remove intermediate data after a job finishes</title>
                <link>https://issues.apache.org/jira/browse/PIG-3169</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;When using Grunt, intermediate data and distributed caches files are left in &apos;pig.temp.dir&apos; until the session is closed. It would be nice to cleanup files as they are no longer needed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12631197">PIG-3169</key>
            <summary>Remove intermediate data after a job finishes</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mwagner">Mark Wagner</assignee>
                                    <reporter username="mwagner">Mark Wagner</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Feb 2013 02:58:26 +0000</created>
                <updated>Mon, 14 Oct 2013 17:45:46 +0100</updated>
                            <resolved>Tue, 30 Apr 2013 18:17:39 +0100</resolved>
                                                    <fixVersion>0.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13581334" author="jcoveney" created="Tue, 19 Feb 2013 15:03:02 +0000"  >&lt;p&gt;+1, and committed. Thanks Mark!&lt;/p&gt;</comment>
                            <comment id="13582390" author="cheolsoo" created="Wed, 20 Feb 2013 18:12:01 +0000"  >&lt;p&gt;I am sorry to reopen this, but this broke the following unit test:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Testcase: test8 took 27.959 sec
    Caused an ERROR
Testcase: test9 took 27.192 sec
    Caused an ERROR
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;To reproduce, please run:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ant clean test -Dtestcase=TestSplitStore
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13582412" author="cheolsoo" created="Wed, 20 Feb 2013 18:55:47 +0000"  >&lt;p&gt;The issue is that the test cases generate input files under /tmp and use them across MR jobs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
pig.registerQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;A = LOAD &apos;&quot;&lt;/span&gt; + Util.generateURI(tmpFile.toString(), pig.getPigContext()) + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos;;&quot;&lt;/span&gt;);
pig.registerQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;Split A into A1 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; $0&amp;lt;=10, A2 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; $0&amp;gt;10;&quot;&lt;/span&gt;);
pig.registerQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;Store A1 into &apos;&quot;&lt;/span&gt; + FileLocalizer.getTemporaryPath(pigContext) + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos;;&quot;&lt;/span&gt;);
pig.openIterator(&lt;span class=&quot;code-quote&quot;&gt;&quot;A2&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The &quot;store A1&quot; is the 1st job, and &quot;openIterator(A2)&quot; is the 2nd job. Since the input file was deleted after the 1st job, &quot;openIterator(A2)&quot; fails to load it.&lt;/p&gt;

&lt;p&gt;Attached is a patch that remove &quot;deleteTempFiles()&quot; from PigServer. I think having it only in GruntParser serves the original motivation of this jira. Please let me know anyone thinks otherwise.&lt;/p&gt;</comment>
                            <comment id="13582529" author="mwagner" created="Wed, 20 Feb 2013 21:21:58 +0000"  >&lt;p&gt;Thanks for catching that, Cheolsoo. I only ran test-commit before, but have confirmed that the test fails now.&lt;/p&gt;

&lt;p&gt;Unfortunately, the call in GruntParser only takes care of intermediate data from dump commands. The PigServer call handles all intermediate data for jobs that STORE from Grunt. Without the PigServer call, intermediate results will still be left in /tmp until a DUMP or the session ends. In general, &quot;deleteTempFiles()&quot; seems to be heavy-handed for this. I think it&apos;s better to build more granular controls into FileLocalizer.&lt;/p&gt;</comment>
                            <comment id="13582538" author="cheolsoo" created="Wed, 20 Feb 2013 21:28:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mwagner&quot; class=&quot;user-hover&quot; rel=&quot;mwagner&quot;&gt;Mark Wagner&lt;/a&gt;, thank you for the clarification!&lt;/p&gt;

&lt;p&gt;In that case, why don&apos;t we modify the test cases so that they can use a non-temporary path for input files? I didn&apos;t want to prevent unit tests from generating files in /tmp because we have to remember that when writing unit test. But if necessary, we can do. What do you suggest?&lt;/p&gt;</comment>
                            <comment id="13582542" author="cheolsoo" created="Wed, 20 Feb 2013 21:30:06 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I think it&apos;s better to build more granular controls into FileLocalizer&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;In fact, you can control the relevant root dir by &quot;pig.temp.dir&quot;.&lt;/p&gt;</comment>
                            <comment id="13582650" author="mwagner" created="Wed, 20 Feb 2013 23:21:04 +0000"  >&lt;p&gt;The test aren&apos;t failing when reading the input file, they are going back to read intermediate data from the first job and failing because it has been deleted after the previous store. This is an actual regression then, not just a problem with the test case.&lt;/p&gt;

&lt;p&gt;I&apos;ll look into this a bit more, but until then it&apos;s probably best to apply your hotfix, Cheolsoo. I don&apos;t expect GruntParser to have an equivalent bug.&lt;/p&gt;</comment>
                            <comment id="13582696" author="cheolsoo" created="Thu, 21 Feb 2013 00:06:49 +0000"  >&lt;blockquote&gt;
&lt;p&gt;they are going back to read intermediate data from the first job and failing because it has been deleted after the previous store&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Please correct me if I am wrong, but I have a sightly different understanding. If you print out what&apos;s causing failure in the test, that&apos;s not the intermediate output file from a previous job but the input file. Here is what I did to verify it:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fn = Util.generateURI(tmpFile.toString(), pig.getPigContext());
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;blah: &quot;&lt;/span&gt;+ fn);
pig.registerQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;A = LOAD &apos;&quot;&lt;/span&gt; + fn + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos;;&quot;&lt;/span&gt;);
pig.registerQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;Split A into A1 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; $0&amp;lt;=10, A2 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; $0&amp;gt;10;&quot;&lt;/span&gt;);
pig.registerQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;Store A1 into &apos;&quot;&lt;/span&gt; + FileLocalizer.getTemporaryPath(pigContext) + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos;;&quot;&lt;/span&gt;);
pig.openIterator(&lt;span class=&quot;code-quote&quot;&gt;&quot;A2&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now here is the test log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
blah: hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost.localdomain:45150/tmp/temp2039910329/tmp-2001898725
&lt;/span&gt;...
ERROR 2118: Input path does not exist: hdfs:&lt;span class=&quot;code-comment&quot;&gt;//localhost.localdomain:45150/tmp/temp2039910329/tmp-2001898725&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As can be seen, the input file (/tmp/temp2039910329/tmp-2001898725) is deleted after the 1st job, and that makes the 2nd job fail. In fact, I can verify this by doing explain on A1 and A2 as well. For example, if I do the following in Pig,&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
A = LOAD &apos;1.txt&apos;;
Split A into A1 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; $0&amp;lt;=10, A2 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; $0&amp;gt;10;
Explain A1;
Explain A2;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It gives me the following output, and I can see both A1 and A2 share the same input: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
A1: Store(fakefile:org.apache.pig.builtin.PigStorage) - scope-7
|
|---A1: Filter[bag] - scope-2
    |   |
    |   Less Than or Equal[&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;] - scope-6
    |   |
    |   |---Cast[&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;] - scope-4
    |   |   |
    |   |   |---Project[bytearray][0] - scope-3
    |   |
    |   |---Constant(10) - scope-5
    |
    |---A: Load(file:&lt;span class=&quot;code-comment&quot;&gt;///home/cheolsoo/workspace/pig-git-2/1.txt:org.apache.pig.builtin.PigStorage) - scope-0--------
&lt;/span&gt;
...

A2: Store(fakefile:org.apache.pig.builtin.PigStorage) - scope-19
|
|---A2: Filter[bag] - scope-14
    |   |
    |   Greater Than[&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;] - scope-18
    |   |
    |   |---Cast[&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;] - scope-16
    |   |   |
    |   |   |---Project[bytearray][0] - scope-15
    |   |
    |   |---Constant(10) - scope-17
    |
    |---A: Load(file:&lt;span class=&quot;code-comment&quot;&gt;///home/cheolsoo/workspace/pig-git-2/1.txt:org.apache.pig.builtin.PigStorage) - scope-12--------&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Sorry for the long message, but I wanted to make sure that we are on the same page before deciding how to fix this.&lt;/p&gt;</comment>
                            <comment id="13582770" author="mwagner" created="Thu, 21 Feb 2013 01:33:20 +0000"  >&lt;p&gt;Ah, you are absolutely correct. I didn&apos;t realize generateURI copied the file over.&lt;/p&gt;

&lt;p&gt;Towards a fix: Like you said, it doesn&apos;t seem right to require unit tests (and other classes) to worry about having their temporary files deleted, especially when it&apos;s indirect like in this case. PigServer should probably do its own cleanup of intermediate data after executions rather than removing all temporary files. Does anybody have any input on this?&lt;/p&gt;</comment>
                            <comment id="13585277" author="cheolsoo" created="Sun, 24 Feb 2013 03:42:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mwagner&quot; class=&quot;user-hover&quot; rel=&quot;mwagner&quot;&gt;Mark Wagner&lt;/a&gt;, do you want to rework your patch then? For now, we may just revert the commit.&lt;/p&gt;</comment>
                            <comment id="13585675" author="mwagner" created="Mon, 25 Feb 2013 07:15:07 +0000"  >&lt;p&gt;Yes, let&apos;s do that.&lt;/p&gt;</comment>
                            <comment id="13585686" author="cheolsoo" created="Mon, 25 Feb 2013 07:30:32 +0000"  >&lt;p&gt;OK, I reverted the commit in trunk.&lt;/p&gt;</comment>
                            <comment id="13624268" author="mwagner" created="Sat, 6 Apr 2013 02:48:11 +0100"  >&lt;p&gt;I&apos;ve reworked this. Since this relates mostly to MR intermediate data, and not temporary files in general, I&apos;ve made MRLauncher walk the execution plan and delete all the intermediate data itself, leaving other temporary files alone.&lt;/p&gt;</comment>
                            <comment id="13634259" author="mwagner" created="Wed, 17 Apr 2013 19:03:00 +0100"  >&lt;p&gt;I was missing a license header. I&apos;ve added it now.&lt;/p&gt;</comment>
                            <comment id="13637663" author="cheolsoo" created="Sun, 21 Apr 2013 23:15:59 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mwagner&quot; class=&quot;user-hover&quot; rel=&quot;mwagner&quot;&gt;Mark Wagner&lt;/a&gt;, thank you very much for updating the patch. I have a few comments:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Since you&apos;re deleting temp files after each job in MRLauncher, Main and PigServer no longer need to call &lt;tt&gt;FileLocalizer.deleteTempFiles()&lt;/tt&gt; before exit, do they? You mentioned &quot;leaving other temporary files alone&quot; in your comment. I guess you mean temporary files that the user specified as output. For example,
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Store A1 into &apos;&lt;span class=&quot;code-quote&quot;&gt;&quot; + FileLocalizer.getTemporaryPath(pigContext) + &quot;&lt;/span&gt;&apos;;&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;These temporary files should be deleted by the user (or unit tests) explicitly. Are there any other temporary files that Pig needs to clean up? If not, would you like to remove &lt;tt&gt;FileLocalizer.deleteTempFiles()&lt;/tt&gt; from Main and PigServer since they&apos;re redundant?&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;In addition, can you think about how to update FileLocalizer? Currently, FileLocalizer maintains a queue to keep track of temp files generated by &lt;tt&gt;FileLocalizer.getTemporaryPath()&lt;/tt&gt;. When &lt;tt&gt;FileLocalizer.deleteTempFiles()&lt;/tt&gt; is called, they will be poped off and deleted. With your patch, this queue is going to be out-of-sync since &lt;tt&gt;FileLocalizer.delete()&lt;/tt&gt; does not update the queue. So when &lt;tt&gt;FileLocalizer.deleteTempFiles()&lt;/tt&gt; is called, quite a few IOExceptions will be caught in the following code for non-existent files:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void deleteTempFiles() {
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (!toDelete().isEmpty()) {
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            ElementDescriptor elem = toDelete().pop();
            elem.delete();
        } 
        &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
            log.error(e);
        }
    }
    setInitialized(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;tt&gt;elem.delete()&lt;/tt&gt; is essentially a RPC call to NN, so I find it wasteful to make such a call when we already know the file doesn&apos;t exist. In fact, I thought about whether we can completely eliminate this queue. But I think it&apos;s still convenient to have it because unit tests use it clean up multiple temp files. Probably, we replace the queue with a map and make &lt;tt&gt;FileLocalizer.delete()&lt;/tt&gt; update it while deleting files? Thoughts?&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;Regarding MRIntermediateDataVisitor, why not delete temp files when it&apos;s visiting stores instead of returning the list of files and running an extra iteration to delete them? Wouldn&apos;t the former be more efficient?&lt;/li&gt;
	&lt;li&gt;If we do 3, can we call the visitor StoreCleaner instead of StoreFinder? You&apos;re using both names now. It would be good to use a single name.
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (mr.mapPlan != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; mr.mapPlan.size() &amp;gt; 0) {
+            StoreFinder finder = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StoreFinder(mr.mapPlan);
+            finder.visit();
+        }
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (mr.combinePlan != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; mr.combinePlan.size() &amp;gt; 0) {
+            StoreFinder cleaner = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StoreFinder(mr.combinePlan);
+            cleaner.visit();
+        }
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (mr.reducePlan != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; mr.reducePlan.size() &amp;gt; 0) {
+            StoreFinder cleaner = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StoreFinder(mr.reducePlan);
+            cleaner.visit();
+        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Please feel free to disagree with me.&lt;/p&gt;</comment>
                            <comment id="13637832" author="mwagner" created="Mon, 22 Apr 2013 09:21:13 +0100"  >&lt;p&gt;Thanks for taking a look &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;That could be one examples. Others I was thinking of are distributed cache jars, the result of an openIterator call (DUMP), and other user created temporary files like the one that was causing the previous test failures. So I think the deleteTempFiles call is still necessary. Those are all much smaller relative to the intermediate data though.&lt;/li&gt;
	&lt;li&gt;Yes, a set structure would probably be more appropriate for FileLocalizer. I&apos;ll do that.&lt;/li&gt;
	&lt;li&gt;That&apos;s what I wanted to do, but it seems the plan gets destroyed when it&apos;s executed so I can&apos;t walk it afterwords and clean up while walking.&lt;/li&gt;
	&lt;li&gt;My mistake. Those should be consistent.&lt;/li&gt;
&lt;/ol&gt;

</comment>
                            <comment id="13638161" author="cheolsoo" created="Mon, 22 Apr 2013 17:48:57 +0100"  >&lt;p&gt;Agreed. Thank you for the clarification!&lt;/p&gt;</comment>
                            <comment id="13638714" author="mwagner" created="Tue, 23 Apr 2013 03:05:50 +0100"  >&lt;p&gt;Because all the temporary files are under relativeRoot, the order does matter to a degree. That&apos;s why it currently uses a stack. I see two options:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3169&quot; title=&quot;Remove intermediate data after a job finishes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3169&quot;&gt;&lt;del&gt;PIG-3169&lt;/del&gt;&lt;/a&gt;.4.patch: Handles the &quot;relativeRoot&quot; element specially and manually deletes it.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3169&quot; title=&quot;Remove intermediate data after a job finishes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3169&quot;&gt;&lt;del&gt;PIG-3169&lt;/del&gt;&lt;/a&gt;.5.patch: Don&apos;t keep track of all the different files. Instead, just recursively delete the root temporary directory. The one problem with this is the deprecated method getTemporaryPath(ElementDescriptor, PigContext) which could make temporary files in other locations. However, this is only ever called using a null ElementDescriptor in the codebase and has been deprecated since &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1454&quot; title=&quot;Consider clean up backend code&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1454&quot;&gt;&lt;del&gt;PIG-1454&lt;/del&gt;&lt;/a&gt; (0.8.0). Should we take this opportunity to purge the deprecated methods?&lt;/p&gt;</comment>
                            <comment id="13639336" author="cheolsoo" created="Tue, 23 Apr 2013 19:13:26 +0100"  >&lt;p&gt;Let&apos;s do option #2! I think it&apos;s safe to remove &lt;tt&gt;getTemporaryPath(ElementDescriptor, PigContext)&lt;/tt&gt; in 0.12. Do you mind updating the patch by removing this method?&lt;/p&gt;

&lt;p&gt;Btw, you have unused imports in MapReduceLauncher.java and FileLocalizer.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;gt; +&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.Set;
&amp;gt; +&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.pig.backend.datastorage.ElementDescriptor;

&amp;gt; +&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.HashSet;
&amp;gt; +&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.Set;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I am running unit tests with &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3169&quot; title=&quot;Remove intermediate data after a job finishes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3169&quot;&gt;&lt;del&gt;PIG-3169&lt;/del&gt;&lt;/a&gt;.5.patch now. I will let you know if I see any failures.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13643351" author="mwagner" created="Sat, 27 Apr 2013 00:12:11 +0100"  >&lt;p&gt;New patch. I&apos;ve removed the deprecated method that could have caused problems. test-commit passed, I&apos;m running the rest of the tests now.&lt;/p&gt;</comment>
                            <comment id="13645730" author="cheolsoo" created="Tue, 30 Apr 2013 18:10:13 +0100"  >&lt;p&gt;+1. All unit tests pass except TestPigContext.testImportList, which is a known issue (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3286&quot; title=&quot;TestPigContext.testImportList fails in trunk&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3286&quot;&gt;&lt;del&gt;PIG-3286&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="13645745" author="cheolsoo" created="Tue, 30 Apr 2013 18:17:39 +0100"  >&lt;p&gt;Committed to trunk. Thank you Mark!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12570167" name="PIG-3169-hotfix.patch" size="575" author="cheolsoo" created="Wed, 20 Feb 2013 18:55:47 +0000"/>
                            <attachment id="12568361" name="PIG-3169.1.patch" size="1180" author="mwagner" created="Thu, 7 Feb 2013 02:59:27 +0000"/>
                            <attachment id="12577344" name="PIG-3169.2.patch" size="6400" author="mwagner" created="Sat, 6 Apr 2013 02:49:48 +0100"/>
                            <attachment id="12579165" name="PIG-3169.3.patch" size="7207" author="mwagner" created="Wed, 17 Apr 2013 19:03:00 +0100"/>
                            <attachment id="12579961" name="PIG-3169.4.patch" size="11313" author="mwagner" created="Tue, 23 Apr 2013 03:05:50 +0100"/>
                            <attachment id="12579962" name="PIG-3169.5.patch" size="11066" author="mwagner" created="Tue, 23 Apr 2013 03:06:00 +0100"/>
                            <attachment id="12580778" name="PIG-3169.6.patch" size="12021" author="mwagner" created="Sat, 27 Apr 2013 00:12:11 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 19 Feb 2013 15:03:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>311693</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzbn2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>312039</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>