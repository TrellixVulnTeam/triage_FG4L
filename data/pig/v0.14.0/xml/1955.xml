<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:54:14 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1955/PIG-1955.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1955] PhysicalOperator has a member variable (non-static) Log object that is non-transient, this causes serialization errors</title>
                <link>https://issues.apache.org/jira/browse/PIG-1955</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;I found this while trying to write unit tests. Creating a local PigServer to test my LoadFunc caused a serialization of the PhysicalOperator class, which failed due to:&lt;br/&gt;
..&lt;br/&gt;
Caused by: java.io.NotSerializableException: org.apache.commons.logging.impl.Log4JCategoryLog&lt;br/&gt;
..&lt;/p&gt;


&lt;p&gt;this is easily fixed by adding the transient keyword to the definition of log.&lt;/p&gt;

&lt;p&gt;e.g.&lt;/p&gt;

&lt;p&gt;on trunk:&lt;br/&gt;
    private final transient Log log = LogFactory.getLog(getClass());&lt;br/&gt;
on the 0.8 tag:&lt;br/&gt;
    private transient Log log = LogFactory.getLog(getClass());&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12503058">PIG-1955</key>
            <summary>PhysicalOperator has a member variable (non-static) Log object that is non-transient, this causes serialization errors</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="woody.anderson@gmail.com">Woody Anderson</assignee>
                                    <reporter username="woody.anderson@gmail.com">Woody Anderson</reporter>
                        <labels>
                    </labels>
                <created>Thu, 31 Mar 2011 19:26:15 +0100</created>
                <updated>Mon, 23 Apr 2012 18:13:40 +0100</updated>
                            <resolved>Wed, 6 Apr 2011 18:11:52 +0100</resolved>
                                    <version>0.8.0</version>
                    <version>0.9.0</version>
                                    <fixVersion>0.9.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13014125" author="woody.anderson@gmail.com" created="Thu, 31 Mar 2011 19:27:56 +0100"  >&lt;p&gt;this doesn&apos;t have all of the unit test trimmings, but is that all really needed to mark a logger as transient?&lt;/p&gt;</comment>
                            <comment id="13014146" author="woody.anderson@gmail.com" created="Thu, 31 Mar 2011 20:20:09 +0100"  >&lt;p&gt;Ok. Unfortunately, this issue is more pervasive than i originally thought.&lt;/p&gt;

&lt;p&gt;The &apos;simple&apos; fix that is attached makes  the PO logger transient protected and  removes the loggers from all subclasses which are defined often incorrectly (non-transient members) and inconsistently.&lt;/p&gt;

&lt;p&gt;Personally, when i define loggers i always make them private and STATIC so that there is no getClass() call. this makes finding the class where the log line resides in source code much simpler to find. I dislike loggers that define themselves with getClass() b/c logging code in A.java will report as class B in output if class B extends class A.&lt;/p&gt;

&lt;p&gt;I did not change this behavior b/c perhaps someone has their reasons for doing what they did. I did however remove some of the static loggers simply to ensure consistency (the majority were done with member variables).&lt;/p&gt;

&lt;p&gt;The change to static private is also not such a big deal if anyone agrees we should consistently go that way instead.&lt;/p&gt;</comment>
                            <comment id="13014815" author="rding" created="Fri, 1 Apr 2011 21:31:30 +0100"  >&lt;p&gt;I think we should make loggers static (and final). The problem with transient is that it doesn&apos;t work the way you expect. As it is transient, the logger would not be serialized, and when the object is deserialized, the logger is initialized to null (default value). &lt;/p&gt;</comment>
                            <comment id="13015622" author="woody.anderson@gmail.com" created="Mon, 4 Apr 2011 22:19:40 +0100"  >&lt;p&gt;Agreed, i prefer the static approach.&lt;/p&gt;</comment>
                            <comment id="13015664" author="dvryaboy" created="Mon, 4 Apr 2011 23:31:14 +0100"  >&lt;p&gt;Guys, does this look like a manifestation of the same bug? Email on the pig user list: &lt;a href=&quot;http://pig.markmail.org/thread/4s76qv3eo6ivszee&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://pig.markmail.org/thread/4s76qv3eo6ivszee&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13015687" author="rding" created="Tue, 5 Apr 2011 00:55:56 +0100"  >&lt;p&gt;It&apos;s different. Log4JLogger implements Serializable interface. The error in the email happened during the deserialization. It looks like a class mismatch between client and server.  &lt;/p&gt;</comment>
                            <comment id="13015702" author="rding" created="Tue, 5 Apr 2011 01:31:09 +0100"  >&lt;p&gt;Patch looks good. I&apos;ll commit the patch after running test-patch and unit tests.&lt;/p&gt;</comment>
                            <comment id="13016434" author="rding" created="Wed, 6 Apr 2011 18:09:15 +0100"  >&lt;p&gt;Test-patch result:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     [exec] -1 overall.  
     [exec] 
     [exec]     +1 @author.  The patch does not contain any @author tags.
     [exec] 
     [exec]     -1 tests included.  The patch doesn&apos;t appear to include any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; or modified tests.
     [exec]                         Please justify why no tests are needed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; patch.
     [exec] 
     [exec]     +1 javadoc.  The javadoc tool did not generate any warning messages.
     [exec] 
     [exec]     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.
     [exec] 
     [exec]     +1 findbugs.  The patch does not introduce any &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Findbugs warnings.
     [exec] 
     [exec]     +1 release audit.  The applied patch does not increase the total number of release audit warnings.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Unit tests pass (with update of one golden file).&lt;/p&gt;</comment>
                            <comment id="13016437" author="rding" created="Wed, 6 Apr 2011 18:11:52 +0100"  >&lt;p&gt;Patch committed to trunk. Thanks Woody!&lt;/p&gt;</comment>
                            <comment id="13108946" author="jeromatron" created="Tue, 20 Sep 2011 20:18:21 +0100"  >&lt;p&gt;Not sure if there are any updates to 0.8.x planned, but if so, would be nice to backport since it&apos;s a pretty clean backport.  I can attach an updated patch if so.  (There were just a few places where the hunk fails locally, but applying the changes manually worked)&lt;/p&gt;</comment>
                            <comment id="13109167" author="alangates" created="Wed, 21 Sep 2011 02:21:41 +0100"  >&lt;p&gt;I&apos;m not aware of any plans to make a 0.8.2 release, but you can upload a patch here in case others want the same fix.&lt;/p&gt;</comment>
                            <comment id="13109578" author="jeromatron" created="Wed, 21 Sep 2011 16:32:11 +0100"  >&lt;p&gt;Attaching a patch that cleanly applies against 0.8.1.  I tested it with what was locally failing and it fixed the problem.&lt;/p&gt;</comment>
                            <comment id="13259735" author="jeromatron" created="Mon, 23 Apr 2012 18:13:40 +0100"  >&lt;p&gt;Granting license.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12475143" name="1955-po.patch" size="21289" author="woody.anderson@gmail.com" created="Thu, 31 Mar 2011 20:20:09 +0100"/>
                            <attachment id="12523821" name="1955-static-0_8_1.patch" size="20728" author="jeromatron" created="Mon, 23 Apr 2012 18:13:40 +0100"/>
                            <attachment id="12495382" name="1955-static-0_8_1.patch" size="20728" author="jeromatron" created="Wed, 21 Sep 2011 16:32:10 +0100"/>
                            <attachment id="12475429" name="1955-static.patch" size="20770" author="woody.anderson@gmail.com" created="Mon, 4 Apr 2011 22:19:40 +0100"/>
                            <attachment id="12475141" name="1955.patch" size="699" author="woody.anderson@gmail.com" created="Thu, 31 Mar 2011 19:27:56 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 1 Apr 2011 20:31:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35765</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaupr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97287</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>fix Serialzeable bug in PhysicalOperator, mark log as transient</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>