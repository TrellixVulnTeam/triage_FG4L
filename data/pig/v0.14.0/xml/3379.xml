<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:11:06 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3379/PIG-3379.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3379] Alias reuse in nested foreach causes PIG script to fail</title>
                <link>https://issues.apache.org/jira/browse/PIG-3379</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The following script fails:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;temp.pig&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Events = LOAD &apos;x&apos; AS (eventTime:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;, deviceId:chararray, eventName:chararray);
Events = FOREACH Events GENERATE eventTime, deviceId, eventName;
EventsPerMinute = GROUP Events BY (eventTime / 60000);
EventsPerMinute = FOREACH EventsPerMinute {
  DistinctDevices = DISTINCT Events.deviceId;
  nbDevices = SIZE(DistinctDevices);

  DistinctDevices = FILTER Events BY eventName == &apos;xuaHeartBeat&apos;;
  nbDevicesWatching = SIZE(DistinctDevices);

  GENERATE $0*60000 as timeStamp, nbDevices as nbDevices, nbDevicesWatching as nbDevicesWatching;
}
EventsPerMinute = FILTER EventsPerMinute BY timeStamp &amp;gt;= 0  AND timeStamp &amp;lt; 100000;
A = FOREACH EventsPerMinute GENERATE timeStamp;
describe A;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With the error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2013-07-16 11:31:20,450 [main] ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1025: 
&amp;lt;file /home/xzhang/Documents/temp.pig, line 14, column 37&amp;gt; Invalid field projection. Projected field [timeStamp] does not exist in schema: deviceId:chararray.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Using distinct alias name for the 2nd &quot;DistinctDevices&quot; fixes the problem. As an observation, removing the last filter statement also fixes the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12658087">PIG-3379</key>
            <summary>Alias reuse in nested foreach causes PIG script to fail</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="xuefuz">Xuefu Zhang</assignee>
                                    <reporter username="xuefuz">Xuefu Zhang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Jul 2013 19:37:26 +0100</created>
                <updated>Mon, 14 Oct 2013 17:46:19 +0100</updated>
                            <resolved>Fri, 23 Aug 2013 22:07:12 +0100</resolved>
                                    <version>0.11.1</version>
                                    <fixVersion>0.12.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13710085" author="xuefuz" created="Tue, 16 Jul 2013 19:59:12 +0100"  >&lt;p&gt;It seems related to &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1271&quot; title=&quot;Provide a more flexible data format to load complex field (bag/tuple/map) in PigStorage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1271&quot;&gt;PIG-1271&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2530&quot; title=&quot;Reusing alias name in nested foreach causes incorrect results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2530&quot;&gt;&lt;del&gt;PIG-2530&lt;/del&gt;&lt;/a&gt;, but both were marked as fixed.&lt;/p&gt;</comment>
                            <comment id="13726588" author="xuefuz" created="Thu, 1 Aug 2013 17:37:21 +0100"  >&lt;p&gt;Correction, I meant &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1721&quot; title=&quot;New logical plan: script fail when reuse foreach inner alias&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1721&quot;&gt;&lt;del&gt;PIG-1721&lt;/del&gt;&lt;/a&gt; instead in above comment.&lt;/p&gt;</comment>
                            <comment id="13733884" author="daijy" created="Thu, 8 Aug 2013 20:37:25 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;Xuefu Zhang&lt;/a&gt;, seems we can have a simpler fix. Attach &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3379&quot; title=&quot;Alias reuse in nested foreach causes PIG script to fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3379&quot;&gt;&lt;del&gt;PIG-3379&lt;/del&gt;&lt;/a&gt;-draft.patch. &lt;/p&gt;

&lt;p&gt;How do you think?&lt;/p&gt;</comment>
                            <comment id="13733919" author="xuefuz" created="Thu, 8 Aug 2013 21:15:18 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=daijy&quot; class=&quot;user-hover&quot; rel=&quot;daijy&quot;&gt;Daniel Dai&lt;/a&gt; Thanks for your suggestion. While your patch does make &quot;describe A&quot; work, it generates the wrong result with the new test case in my patch. Further, the following is shown in the logical plan for &quot;EventsPerMinute&quot;, in which we only have one &quot;DistinctDevices&quot; operator, which is incorrect. My original patch was to fix this, making sure that the projected impression is pointing to the right operator. Please let me know your further thoughts.&lt;/p&gt;

&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---EventsPerMinute: (Name: LOForEach Schema: timeStamp#141:long,nbDevices#142:long,nbDevicesWatching#143:long)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   (Name: LOGenerate&lt;span class=&quot;error&quot;&gt;&amp;#91;false,false,false&amp;#93;&lt;/span&gt; Schema: timeStamp#141:long,nbDevices#142:long,nbDevicesWatching#143:long)ColumnPrune:InputUids=&lt;span class=&quot;error&quot;&gt;&amp;#91;135, 134&amp;#93;&lt;/span&gt;ColumnPrune:OutputUids=&lt;span class=&quot;error&quot;&gt;&amp;#91;141, 143, 142&amp;#93;&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   (Name: Multiply Type: long Uid: 141)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---group:(Name: Project Type: long Uid: 134 Input: 0 Column: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---(Name: Cast Type: long Uid: 139)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---(Name: Constant Type: int Uid: 139)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   (Name: UserFunc(org.apache.pig.builtin.BagSize) Type: long Uid: 142)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---DistinctDevices:(Name: Project Type: bag Uid: 135 Input: 1 Column: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   (Name: UserFunc(org.apache.pig.builtin.BagSize) Type: long Uid: 143)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---DistinctDevices:(Name: Project Type: bag Uid: 135 Input: 1 Column: &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---(Name: LOInnerLoad&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; Schema: group#134:long)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---DistinctDevices: (Name: LOFilter Schema: eventTime#106:long,deviceId#107:chararray,eventName#108:chararray)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   (Name: Equal Type: boolean Uid: 138)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---eventName:(Name: Project Type: chararray Uid: 108 Input: 0 Column: 2)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---(Name: Constant Type: chararray Uid: 137)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;---Events: (Name: LOInnerLoad&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; Schema: eventTime#106:long,deviceId#107:chararray,eventName#108:chararray)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
</comment>
                            <comment id="13733924" author="xuefuz" created="Thu, 8 Aug 2013 21:16:38 +0100"  >&lt;p&gt;Repost the logical plan snippet.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    |---EventsPerMinute: (Name: LOForEach Schema: timeStamp#141:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,nbDevices#142:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,nbDevicesWatching#143:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;)
        |   |
        |   (Name: LOGenerate[&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;] Schema: timeStamp#141:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,nbDevices#142:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,nbDevicesWatching#143:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;)ColumnPrune:InputUids=[135, 134]ColumnPrune:OutputUids=[141, 143, 142]
        |   |   |
        |   |   (Name: Multiply Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 141)
        |   |   |
        |   |   |---group:(Name: Project Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 134 Input: 0 Column: (*))
        |   |   |
        |   |   |---(Name: Cast Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 139)
        |   |       |
        |   |       |---(Name: Constant Type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; Uid: 139)
        |   |   |
        |   |   (Name: UserFunc(org.apache.pig.builtin.BagSize) Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 142)
        |   |   |
        |   |   |---DistinctDevices:(Name: Project Type: bag Uid: 135 Input: 1 Column: (*))
        |   |   |
        |   |   (Name: UserFunc(org.apache.pig.builtin.BagSize) Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 143)
        |   |   |
        |   |   |---DistinctDevices:(Name: Project Type: bag Uid: 135 Input: 1 Column: (*))
        |   |
        |   |---(Name: LOInnerLoad[0] Schema: group#134:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;)
        |   |
        |   |---DistinctDevices: (Name: LOFilter Schema: eventTime#106:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,deviceId#107:chararray,eventName#108:chararray)
        |       |   |
        |       |   (Name: Equal Type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; Uid: 138)
        |       |   |
        |       |   |---eventName:(Name: Project Type: chararray Uid: 108 Input: 0 Column: 2)
        |       |   |
        |       |   |---(Name: Constant Type: chararray Uid: 137)
        |       |
        |       |---Events: (Name: LOInnerLoad[1] Schema: eventTime#106:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,deviceId#107:chararray,eventName#108:chararray)
        |


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13734247" author="daijy" created="Fri, 9 Aug 2013 01:24:14 +0100"  >&lt;p&gt;Yes, you are right, it&apos;s not the dangling branch, it&apos;s the incorrect inner plan. Let me take a look again.&lt;/p&gt;</comment>
                            <comment id="13748184" author="daijy" created="Fri, 23 Aug 2013 02:32:40 +0100"  >&lt;p&gt;Missing LODistinct in the posted logical plan. Should be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    |---EventsPerMinute: (Name: LOForEach Schema: timeStamp#56:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,nbDevices#57:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,nbDevicesWatching#58:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;)
        |   |
        |   (Name: LOGenerate[&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;,&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;] Schema: timeStamp#56:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,nbDevices#57:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,nbDevicesWatching#58:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;)ColumnPrune:InputUids=[50, 49]ColumnPrune:OutputUids=[58, 57, 56]
        |   |   |
        |   |   (Name: Multiply Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 56)
        |   |   |
        |   |   |---group:(Name: Project Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 49 Input: 0 Column: (*))
        |   |   |
        |   |   |---(Name: Cast Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 54)
        |   |       |
        |   |       |---(Name: Constant Type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; Uid: 54)
        |   |   |
        |   |   (Name: UserFunc(org.apache.pig.builtin.BagSize) Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 57)
        |   |   |
        |   |   |---DistinctDevices:(Name: Project Type: bag Uid: 50 Input: 1 Column: (*))
        |   |   |
        |   |   (Name: UserFunc(org.apache.pig.builtin.BagSize) Type: &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; Uid: 58)
        |   |   |
        |   |   |---DistinctDevices:(Name: Project Type: bag Uid: 50 Input: 2 Column: (*))
        |   |
        |   |---(Name: LOInnerLoad[0] Schema: group#49:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;)
        |   |
        |   |---DistinctDevices: (Name: LODistinct Schema: deviceId#22:chararray)
        |   |   |
        |   |   |---1-3: (Name: LOForEach Schema: deviceId#22:chararray)
        |   |       |   |
        |   |       |   (Name: LOGenerate[&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;] Schema: deviceId#22:chararray)
        |   |       |   |   |
        |   |       |   |   deviceId:(Name: Project Type: chararray Uid: 22 Input: 0 Column: (*))
        |   |       |   |
        |   |       |   |---(Name: LOInnerLoad[1] Schema: deviceId#22:chararray)
        |   |       |
        |   |       |---Events: (Name: LOInnerLoad[1] Schema: eventTime#21:&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;,deviceId#22:chararray,eventName#23:chararray)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The plan looks right.&lt;/p&gt;

&lt;p&gt;Talked with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=xuefuz&quot; class=&quot;user-hover&quot; rel=&quot;xuefuz&quot;&gt;Xuefu Zhang&lt;/a&gt;, the idea is to use projectedOperator instead of alias at the time we convert alias to position. The newly introduced projectedOperator is only used in alias translation. After that, input# and col# will be use as the coordinates of ProjectExpression. Patch looks good. I will commit it once tests pass.&lt;/p&gt;</comment>
                            <comment id="13748985" author="daijy" created="Fri, 23 Aug 2013 22:07:12 +0100"  >&lt;p&gt;Patch committed to trunk. Thanks Xuefu!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12596916" name="PIG-3379-draft.patch" size="1181" author="daijy" created="Thu, 8 Aug 2013 20:37:25 +0100"/>
                            <attachment id="12596204" name="PIG-3379.patch" size="12987" author="xuefuz" created="Mon, 5 Aug 2013 21:08:49 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 8 Aug 2013 19:37:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>338281</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzg6vr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>338601</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>