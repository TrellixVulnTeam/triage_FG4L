<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:50:23 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1149/PIG-1149.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1149] Allow instantiation of SampleLoaders with parametrized LoadFuncs</title>
                <link>https://issues.apache.org/jira/browse/PIG-1149</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Currently, it is not possible to instantiate a SampleLoader with something like PigStorage(&apos;:&apos;).  We should allow passing parameters to the loaders being sampled.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12443300">PIG-1149</key>
            <summary>Allow instantiation of SampleLoaders with parametrized LoadFuncs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dvryaboy">Dmitriy V. Ryaboy</assignee>
                                    <reporter username="dvryaboy">Dmitriy V. Ryaboy</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Dec 2009 20:51:51 +0000</created>
                <updated>Fri, 14 May 2010 07:46:29 +0100</updated>
                            <resolved>Mon, 21 Dec 2009 20:06:08 +0000</resolved>
                                                    <fixVersion>0.7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12790563" author="dvryaboy" created="Tue, 15 Dec 2009 05:18:48 +0000"  >&lt;p&gt;Due to the string being parsed a few times along the way, three backslashes need to precede the escaped quote in PigLatin. Which means six backslashes when expressing PigLatin as a string in Java. &lt;/p&gt;</comment>
                            <comment id="12791218" author="hadoopqa" created="Wed, 16 Dec 2009 05:53:38 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12428005/pig_1149.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12428005/pig_1149.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 890596.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/126/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/126/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/126/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/126/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/126/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h8.grid.sp2.yahoo.net/126/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12792573" author="alangates" created="Fri, 18 Dec 2009 18:42:54 +0000"  >&lt;p&gt;Changes look fine.&lt;/p&gt;

&lt;p&gt;Pradeep, will this apply as is to the load-store redesign branch or will we need a separate patch for that?&lt;/p&gt;</comment>
                            <comment id="12792578" author="pkamath" created="Fri, 18 Dec 2009 18:56:46 +0000"  >&lt;p&gt;I tried applying it on the branch and it failed:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;:/tmp/load-store-redesign]patch -p0 &amp;lt; /homes/pradeepk/dev/pig-apache/pig/trunk/pig_1149.patch 
patching file src/org/apache/pig/impl/builtin/SampleLoader.java
Hunk #1 succeeded at 31 with fuzz 2 (offset -4 lines).
Hunk #2 FAILED at 46.
1 out of 2 hunks FAILED -- saving rejects to file src/org/apache/pig/impl/builtin/SampleLoader.java.rej
patching file test/org/apache/pig/test/TestPoissonSampleLoader.java
[pradeepk@chargesize:/tmp/load-store-redesign]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Since Thejas worked on &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1062&quot; title=&quot;load-store-redesign branch: change SampleLoader and subclasses to work with new LoadFunc interface &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1062&quot;&gt;&lt;del&gt;PIG-1062&lt;/del&gt;&lt;/a&gt;, he might be in a better position to check whether this patch needs changes.&lt;/p&gt;</comment>
                            <comment id="12792627" author="thejas" created="Fri, 18 Dec 2009 20:25:19 +0000"  >&lt;p&gt;I notice that this patch is using org.mortbay.log instead of org.apache.commons.logging. That is not used anywhere else in pig code. Should we replace that with org.apache.commons.logging ?&lt;/p&gt;

&lt;p&gt;A small change is required to get the patch working with load-store branch. It no longer requires the load func to implement SampleLoader interface, and that interface has been removed. I can submit the modified patch. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        loader = (SamplableLoader)PigContext.instantiateFuncFromSpec(funcSpec);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;changes to &lt;br/&gt;
+        loader = (LoadFunc)PigContext.instantiateFuncFromSpec(funcSpec);&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12792636" author="dvryaboy" created="Fri, 18 Dec 2009 20:50:04 +0000"  >&lt;p&gt;The log reference and the log.info call can be completely removed (I can post a new patch, or you can just remove the change when integrating the patch).  That&apos;s Eclipse being &quot;helpful&quot;...&lt;/p&gt;

&lt;p&gt;I already made a patch for LSR branch, but TestPoissonSampleLoader fails on both tests. The not sure why the first one fails, but in the second one (the one I added), the problem is that when I fetch the first result, I get an unexpected number of fields &amp;#8211; the tuple looks like this:&lt;/p&gt;

&lt;p&gt;(100,apple1,aaa0,&#18774;&#14392;_pig_inTeRnal-spEcial_roW_num_tuple3kt579CFLehkblah,300L)&lt;/p&gt;

&lt;p&gt;I don&apos;t recall &amp;#8211; does the special stuff get inserted into every row, or just the last one? What should I &quot;properly&quot; expect?&lt;/p&gt;</comment>
                            <comment id="12792689" author="thejas" created="Fri, 18 Dec 2009 22:57:56 +0000"  >&lt;p&gt;The first test case failure is known, I will be fixing that with a patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1094&quot; title=&quot;Fix unit tests corresponding to source changes so far&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1094&quot;&gt;&lt;del&gt;PIG-1094&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;The special string gets added to the last row only. But that looks unnecessary. I will be removing that with a new patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1062&quot; title=&quot;load-store-redesign branch: change SampleLoader and subclasses to work with new LoadFunc interface &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1062&quot;&gt;&lt;del&gt;PIG-1062&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;You can submit your patch for LSR branch patch, by checking for 5 columns in your test case. I will change your new test case as well when I submit  new &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1062&quot; title=&quot;load-store-redesign branch: change SampleLoader and subclasses to work with new LoadFunc interface &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1062&quot;&gt;&lt;del&gt;PIG-1062&lt;/del&gt;&lt;/a&gt; patch (to check for 4 columns).&lt;/p&gt;</comment>
                            <comment id="12792698" author="thejas" created="Fri, 18 Dec 2009 23:43:06 +0000"  >&lt;p&gt;I spoke too soon about the special string being unnecessary. GetMemNumRows uses it. I will add some comments to document that in PoissonSampleLoader .&lt;br/&gt;
In previous comment,  &quot;special string gets added to the last row only&quot;  should be &quot;special string gets added to the last &lt;b&gt;sample&lt;/b&gt; row only&quot;.&lt;/p&gt;</comment>
                            <comment id="12792779" author="dvryaboy" created="Sat, 19 Dec 2009 05:01:19 +0000"  >&lt;p&gt;Attaching patch for lsr branch.&lt;br/&gt;
I also retabbed the involved files to replace tabs with spaces, and got rid of some unused imports.&lt;/p&gt;

&lt;p&gt;Note the FIXME in the test case, as discussed.&lt;/p&gt;</comment>
                            <comment id="12793269" author="thejas" created="Mon, 21 Dec 2009 17:20:21 +0000"  >&lt;p&gt;+1 to the lsr branch version.&lt;br/&gt;
But the FIXME comment in the test case is not correct. There does not have to be &amp;gt; 1 samples sampled for every map, if the number of rows are very small. Though this behavior is different from earlier version of the trunk version of poisson sampler, it satisfies the requirements as per &lt;a href=&quot;http://wiki.apache.org/pig/PigSampler&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/pig/PigSampler&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1062&quot; title=&quot;load-store-redesign branch: change SampleLoader and subclasses to work with new LoadFunc interface &quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1062&quot;&gt;&lt;del&gt;PIG-1062&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
I can remove the FIXME comment as part of the patch I am going to submit to fix the other test case.&lt;/p&gt;</comment>
                            <comment id="12793321" author="olgan" created="Mon, 21 Dec 2009 19:53:07 +0000"  >&lt;p&gt;patch pig_1149.patch is committed to the trunk.&lt;/p&gt;</comment>
                            <comment id="12793326" author="pkamath" created="Mon, 21 Dec 2009 20:06:08 +0000"  >&lt;p&gt;Patch for lsr branch also committed, thanks Dmitriy!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12428005" name="pig_1149.patch" size="3866" author="dvryaboy" created="Tue, 15 Dec 2009 05:15:58 +0000"/>
                            <attachment id="12428526" name="pig_1149_lsr-branch.patch" size="6999" author="dvryaboy" created="Sat, 19 Dec 2009 05:01:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Dec 2009 05:53:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41725</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyan47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96056</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>