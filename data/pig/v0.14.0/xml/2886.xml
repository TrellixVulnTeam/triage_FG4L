<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:55:18 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2886/PIG-2886.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2886] Add Scan TimeRange to HBaseStorage </title>
                <link>https://issues.apache.org/jira/browse/PIG-2886</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;I have a client that wants to use pig.  They are using MR now.  They can&apos;t use PIG right now because they only want to fetch the last day&apos;s worth of data in HBase.  A filter with time range would require reading all the HStore files.  If we hold major compaction until after the fetch and use Scan Time Range we only need to read very little in compression. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12604311">PIG-2886</key>
            <summary>Add Scan TimeRange to HBaseStorage </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="malaskat">Ted Malaska</assignee>
                                    <reporter username="ted.m">Ted Malaska</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Wed, 22 Aug 2012 01:39:23 +0100</created>
                <updated>Tue, 26 Feb 2013 14:51:57 +0000</updated>
                            <resolved>Sun, 2 Sep 2012 23:01:59 +0100</resolved>
                                    <version>0.9.0</version>
                    <version>0.9.1</version>
                    <version>0.9.2</version>
                                    <fixVersion>0.11</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13439191" author="ted.m" created="Wed, 22 Aug 2012 01:45:18 +0100"  >&lt;p&gt;Submitted fix with pull request from tmalaska/pig github.  Let me know what I need to get this into PIG.  My client would like to use HBaseStorage from PIG instead of a fixed version I gave them in a jar.&lt;/p&gt;</comment>
                            <comment id="13439195" author="cheolsoo" created="Wed, 22 Aug 2012 01:53:09 +0100"  >&lt;p&gt;Hi Ted, I think that you need to post your patch to this jira and wait for a committer to review/commit it. Please refer to:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://cwiki.apache.org/confluence/display/PIG/HowToContribute&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/PIG/HowToContribute&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13439197" author="ted.m" created="Wed, 22 Aug 2012 02:00:54 +0100"  >&lt;p&gt;OK, Sounds good. I can&apos;t do it tonight.  I&apos;ll read the directions and do it tomorrow.&lt;/p&gt;</comment>
                            <comment id="13439215" author="ted.m" created="Wed, 22 Aug 2012 02:30:08 +0100"  >&lt;p&gt;Adds timeRange to HBaseStorage&lt;/p&gt;</comment>
                            <comment id="13439273" author="billgraham" created="Wed, 22 Aug 2012 05:57:05 +0100"  >&lt;p&gt;Thanks for the patch Ted! The code looks good, just a few nits about style mainly.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;That patch has a bunch of diff info about your git internal files, so it doesn&apos;t apply.&lt;/li&gt;
	&lt;li&gt;Standard indents in Pig are 4 spaces (no tabs).&lt;/li&gt;
	&lt;li&gt;Use a single space after brackets and between close parens and open brackets in your else/if statements.&lt;/li&gt;
	&lt;li&gt;else should be on one line, i.e., } else {&lt;/li&gt;
	&lt;li&gt;A pair of empty newlines were added after the &lt;tt&gt;ignoreWhitespace_&lt;/tt&gt; block, which should be removed.&lt;/li&gt;
	&lt;li&gt;Typos: TimeRagne and &quot;Timestamp most be&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Also would you please add a unit test to TestHBaseStorage.&lt;/p&gt;

</comment>
                            <comment id="13439999" author="ted.m" created="Thu, 23 Aug 2012 03:08:11 +0100"  >&lt;p&gt;Making progress.  Need to check some more things before I&apos;m totally done.&lt;/p&gt;</comment>
                            <comment id="13440270" author="ted.m" created="Thu, 23 Aug 2012 14:08:43 +0100"  >&lt;p&gt;Question.  &lt;/p&gt;

&lt;p&gt;I added the test cases and ran the following command and I noticed the TestHBaseStore doesn&apos;t run.&lt;/p&gt;

&lt;p&gt;ant -Djavac.args=&quot;-Xlint -Xmaxwarns 1000&quot; clean jar test-commit&lt;/p&gt;

&lt;p&gt;I&apos;m thinking that because TestHBaseStorage doesn&apos;t extend TestCase, also no other classes call TestHBaseStorage.&lt;/p&gt;

&lt;p&gt;So the question is: Is there a design reason why TestHBaseStorage is not running when running unit test?  Is it ok if I make TestHBaseStorage run during unit tests?&lt;/p&gt;</comment>
                            <comment id="13440367" author="billgraham" created="Thu, 23 Aug 2012 16:11:15 +0100"  >&lt;p&gt;Only a subset of tests run during test-commit. test will run all of them (and take a while).  Also annotations are used to indicate that that class contains tests.&lt;/p&gt;

&lt;p&gt;You can do this to test just one test:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ant clean test -Dtestcase=TestHBaseStorage
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13443559" author="ted.m" created="Tue, 28 Aug 2012 22:30:27 +0100"  >&lt;p&gt;Thanks Bill,&lt;/p&gt;

&lt;p&gt;I tried running TestHBaseStorage and it freezes on SetUp.  &lt;/p&gt;

&lt;p&gt;&amp;gt;public void setUp() throws Exception &lt;/p&gt;
{
&amp;gt;        // This is needed by Pig
&amp;gt;    	
&amp;gt;        cluster = MiniCluster.buildCluster();
&amp;gt;        conf = cluster.getConfiguration();
&amp;gt;
&amp;gt;        util = new HBaseTestingUtility(conf);
&amp;gt;        util.startMiniZKCluster();
&amp;gt;        util.startMiniHBaseCluster(1, 1);
&amp;gt;    }

&lt;p&gt;Just wondering if you know what I&apos;m missing to make this work.  Hopefully I will get time in the next couple of days to research this.&lt;/p&gt;</comment>
                            <comment id="13443636" author="cheolsoo" created="Wed, 29 Aug 2012 00:08:24 +0100"  >&lt;p&gt;Hi Ted,&lt;/p&gt;

&lt;p&gt;Regarding TestHBaseStorage, does it hang in hadoop 20 or 23? I assume that you&apos;re not setting &quot;-Dhadoopversion&quot; so using hadoop 20 by default. In hadoop 20, TestHBaseStorage passes for me with your patch. I.e. &quot;ant clean test -Dtestcase=TestHBaseStorage -Dhadoopversion=20&quot; passes.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[junit] Running org.apache.pig.test.TestHBaseStorage
[junit] Tests run: 23, Failures: 0, Errors: 0, Time elapsed: 131.728 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If it doesn&apos;t pass for you, it should be some environment issue. (e.g. did you set umask 0022?)&lt;/p&gt;

&lt;p&gt;However, it does time out in hadoop 23, and I believe that it&apos;s expected since hbase jar from the maven repository is not binary compatible with hadoop 23. I.e. &quot;ant clean test -Dtestcase=TestHBaseStorage -Dhadoopversion=23&quot; fails with time out error, and the following error can be found in the test log (build/test/logs/TEST-org.apache.pig.test.TestHBaseStorage.txt):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.hdfs.protocol.FSConstants$SafeModeAction
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:247)
    ... 7 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I ran into the same issue while bumping hbase to 0.94, but it seem applied to 0.90 (current version in trunk) as well. Please see &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5680&quot; title=&quot;Improve compatibility warning about HBase with Hadoop 0.23.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5680&quot;&gt;&lt;del&gt;HBASE-5680&lt;/del&gt;&lt;/a&gt; for more details.&lt;/p&gt;

&lt;p&gt;Please anyone corrects me if I am wrong about TestHBaseStorage in hadoop 23.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13443640" author="ted.m" created="Wed, 29 Aug 2012 00:16:18 +0100"  >&lt;p&gt;Great thanks.  Got it.  &lt;/p&gt;

&lt;p&gt;I was first doing in on my local (no Hadoop) and it would freezy.  Then I tried it on CDH4 and it didn&apos;t work either.  I will try it on CDH3 tonight.&lt;/p&gt;

&lt;p&gt;By the way do you see anything else in the code I should add or clean up.&lt;/p&gt;

&lt;p&gt;I should have time to work on it tonight.&lt;/p&gt;

&lt;p&gt;Ted Malaska  &lt;/p&gt;</comment>
                            <comment id="13444694" author="dvryaboy" created="Thu, 30 Aug 2012 06:26:04 +0100"  >&lt;p&gt;Hi Ted,&lt;br/&gt;
Great to see clouderians contributing to Pig again! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Couple of notes:&lt;/p&gt;

&lt;p&gt;minTimeRange, maxTimeRange &amp;#8211; maybe better names would be minTimestamp and maxTimestamp ?&lt;br/&gt;
That&apos;s the signature for HBase&apos;s scanTimeRange.&lt;/p&gt;

&lt;p&gt;Also, please fix up documentation &amp;#8211; minTimestamp in scan.setTimeRange is &lt;b&gt;inclusive&lt;/b&gt; (so, not strictly greater then). maxTimestamp is, indeed, exclusive &amp;#8211; the range is [min, max)&lt;/p&gt;

&lt;p&gt;space between } and &quot;else&quot; around maxTimeRange  handling.&lt;/p&gt;

&lt;p&gt;HBase scan also provides setTimestamp(). Might as well throw that in?&lt;/p&gt;

&lt;p&gt;Does your client care about # of returned versions? That&apos;s a much tricker change.. &lt;/p&gt;

</comment>
                            <comment id="13446169" author="ted.m" created="Fri, 31 Aug 2012 18:45:41 +0100"  >&lt;p&gt;Thx will work on it now.&lt;/p&gt;</comment>
                            <comment id="13446698" author="ted.m" created="Sat, 1 Sep 2012 14:22:53 +0100"  >&lt;p&gt;Cleaned things up.  Change maxTimeRange and minTimeRange to maxTimestamp and minTimestamp.  Plus I added a timestamp option.  Along with unit tests.&lt;/p&gt;</comment>
                            <comment id="13446700" author="ted.m" created="Sat, 1 Sep 2012 14:28:17 +0100"  >&lt;p&gt;Hey Dmitriy,&lt;/p&gt;

&lt;p&gt;I made the changes you requested and added in the setTimestamp() option.  &lt;/p&gt;

&lt;p&gt;I would love to do the # of versions change, but can I do that in another jira issue so I can have this one closed. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13446829" author="ted.m" created="Sun, 2 Sep 2012 00:32:23 +0100"  >&lt;p&gt;Found two type-os.  I will have the fix and the maxVersion functionality soon&lt;/p&gt;</comment>
                            <comment id="13446830" author="ted.m" created="Sun, 2 Sep 2012 00:32:37 +0100"  >&lt;p&gt;Making more changes&lt;/p&gt;</comment>
                            <comment id="13446839" author="dvryaboy" created="Sun, 2 Sep 2012 01:33:54 +0100"  >&lt;p&gt;Let&apos;s keep the issue of multiple versions separate &amp;#8211; it&apos;s not entirely clear how those should be returned (a bag?)&lt;/p&gt;</comment>
                            <comment id="13446840" author="ted.m" created="Sun, 2 Sep 2012 01:35:16 +0100"  >&lt;p&gt;OK sounds good.  I will just update the type-o then&lt;/p&gt;</comment>
                            <comment id="13446841" author="dvryaboy" created="Sun, 2 Sep 2012 01:35:44 +0100"  >&lt;p&gt;Ted, let me know if you want me to review, k? Wasn&apos;t clear to me from the last message if you are in a &apos;done&apos; state or if you are just posting intermediate work right now.&lt;/p&gt;</comment>
                            <comment id="13446842" author="ted.m" created="Sun, 2 Sep 2012 01:37:01 +0100"  >&lt;p&gt;Give me a couple minutes I need to check in a new comment and help message&lt;/p&gt;</comment>
                            <comment id="13446843" author="dvryaboy" created="Sun, 2 Sep 2012 01:40:01 +0100"  >&lt;p&gt;Ok I&apos;ll take a look tomorrow. Going rogue for a bit, disconnecting &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="13446845" author="ted.m" created="Sun, 2 Sep 2012 01:46:37 +0100"  >&lt;p&gt;Fixed type-os&lt;/p&gt;</comment>
                            <comment id="13447036" author="dvryaboy" created="Sun, 2 Sep 2012 23:00:14 +0100"  >&lt;p&gt;Urk.. git patch. You need to generate it with &apos;git diff --no-prefix&apos; otherwise we can&apos;t apply it. I mean, we can, and I did, but for next time, --no-prefix makes life easier &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="13447038" author="dvryaboy" created="Sun, 2 Sep 2012 23:01:59 +0100"  >&lt;p&gt;Applied to trunk.&lt;/p&gt;

&lt;p&gt;As there any need to apply this to 0.10 branch?&lt;/p&gt;

&lt;p&gt;Not sure we&apos;ll release a 0.10.1 branch at this point..&lt;/p&gt;</comment>
                            <comment id="13447046" author="ted.m" created="Sun, 2 Sep 2012 23:43:47 +0100"  >&lt;p&gt;Wow thx.  Sorry about the --no-prefix I will make sure to do that in the future.&lt;/p&gt;</comment>
                            <comment id="13587172" author="zeph" created="Tue, 26 Feb 2013 14:51:45 +0000"  >&lt;p&gt;seems to duplicate (and fix) &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1832&quot; title=&quot;Support timestamp in HBaseStorage when storing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1832&quot;&gt;PIG-1832&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12497084">PIG-1832</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12509691">PIG-2114</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12541850" name="PIG-2886-0.patch" size="6598" author="ted.m" created="Wed, 22 Aug 2012 02:30:08 +0100"/>
                            <attachment id="12542073" name="PIG-2886-1.patch" size="13635" author="ted.m" created="Thu, 23 Aug 2012 03:08:11 +0100"/>
                            <attachment id="12543423" name="PIG-2886-2.patch" size="10077" author="ted.m" created="Sat, 1 Sep 2012 14:22:53 +0100"/>
                            <attachment id="12543457" name="PIG-2886-3.patch" size="10808" author="ted.m" created="Sun, 2 Sep 2012 01:46:37 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 22 Aug 2012 00:53:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>256476</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyb0vb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98284</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Added the ability to set HBase Scan&amp;#39;s maxTimestamp, minTimestamp and timestamp in HBaseStorage.  I also added unit tests.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>HBaseStorage timeRange timeStamp</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>