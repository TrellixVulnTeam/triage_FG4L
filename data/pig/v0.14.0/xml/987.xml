<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:10:24 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-987/PIG-987.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-987] [zebra] Zebra Column Group Access Control</title>
                <link>https://issues.apache.org/jira/browse/PIG-987</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Access Control: when processes try to read from the column groups, Zebra should be able to handle allowed vs. disallowed user/application accesses.  The security is eventuallt granted by corresponding  HDFS security of the data stored.&lt;/p&gt;

&lt;p&gt;Expected behavior when column group permissions are set:&lt;/p&gt;

&lt;p&gt;    When user selects only columns that they do not have permissions to access, Zebra should return error with message &quot;Error #: Permission denied for accessing column &amp;lt;column name or names&amp;gt; &lt;/p&gt;

&lt;p&gt;Access control applies to an entire column group, so all columns in a column group have same permissions. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12437041">PIG-987</key>
            <summary>[zebra] Zebra Column Group Access Control</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yanz">Yan Zhou</assignee>
                                    <reporter username="yanz">Yan Zhou</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Oct 2009 18:15:30 +0100</created>
                <updated>Thu, 2 May 2013 03:29:20 +0100</updated>
                            <resolved>Fri, 9 Oct 2009 06:14:45 +0100</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12761274" author="yanz" created="Thu, 1 Oct 2009 18:22:14 +0100"  >&lt;p&gt;A29_ColumnGroupSecurity.patch is the patch file name.&lt;/p&gt;</comment>
                            <comment id="12761327" author="hadoopqa" created="Thu, 1 Oct 2009 21:20:47 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12421038/A29_ColumnGroupSecurity.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12421038/A29_ColumnGroupSecurity.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 820394.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 38 new or modified tests.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    -1 release audit.  The applied patch generated 288 release audit warnings (more than the trunk&apos;s current 281 warnings).&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/54/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/54/testReport/&lt;/a&gt;&lt;br/&gt;
Release audit warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/54/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/54/artifact/trunk/patchprocess/releaseAuditDiffWarnings.txt&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/54/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/54/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/54/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/54/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12761365" author="yanz" created="Thu, 1 Oct 2009 23:11:15 +0100"  >&lt;p&gt;During STORE, the storage hint is enhanced to take a new &quot;secure by&quot;  section, e.g., &lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;c1,c2&amp;#93;&lt;/span&gt; secure by group:secure perm:640&lt;/p&gt;

&lt;p&gt;meaning the column group of columns &quot;c1&quot; and &quot;c2&quot; will belong to group &quot;secure&quot; with file permission octal value of 0640 which, in turn, means read+write for user, read for group and non for others.&lt;/p&gt;

&lt;p&gt;After Zebra table creation, all files and directories inside the secured column group will have the same permision and group membership within the table.&lt;/p&gt;

&lt;p&gt;If a column group is not secured, the default behavoir is determined by the HADOOP MAP/REDUCE  default permision and group membership set upon the new files and directories.&lt;/p&gt;</comment>
                            <comment id="12761645" author="yanz" created="Fri, 2 Oct 2009 18:09:56 +0100"  >&lt;p&gt;The extra warnings were generated on 7 modified java files that were generated JAVACC code generator. Should be ignored.&lt;/p&gt;</comment>
                            <comment id="12762733" author="gauravj" created="Tue, 6 Oct 2009 19:42:11 +0100"  >
&lt;p&gt;Patch Reviewed&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12762812" author="rangadi" created="Wed, 7 Oct 2009 00:27:13 +0100"  >&lt;p&gt;I tried to commit this patch. &apos;ant test&apos; says all the tests fail, where as only one two tests fail without the patch.&lt;/p&gt;

&lt;p&gt;Does Hudson actual run Zebra tests?&lt;/p&gt;</comment>
                            <comment id="12762824" author="yanz" created="Wed, 7 Oct 2009 01:31:02 +0100"  >&lt;p&gt;I checked Hudson test results and they do not seem to run Zebra.&lt;/p&gt;

&lt;p&gt;But I ran &quot;ant test&quot; in contrib/zebra directory and they passed. What errors did you get? I suspect some env issue at your end.&lt;/p&gt;</comment>
                            <comment id="12762825" author="rangadi" created="Wed, 7 Oct 2009 01:41:46 +0100"  >&lt;p&gt;I am attaching &lt;tt&gt;mapred.TestCheckin.txt&lt;/tt&gt; that passes without the patch.&lt;/p&gt;

&lt;p&gt;btw, not all tests pass even without the patch. What is the environment required? I did a fresh check out, and ran &apos;ant test&apos;.&lt;/p&gt;

&lt;p&gt;I guess the tests failures on trunk are related to lzo. But I didn&apos;t expect more failures with the patch.&lt;/p&gt;

&lt;p&gt;Looks like &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-991&quot; title=&quot;[zebra] A few minor bugs as described in the Description section&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-991&quot;&gt;&lt;del&gt;PIG-991&lt;/del&gt;&lt;/a&gt; removes the lzo dependency. I will try with that patch included.&lt;/p&gt;</comment>
                            <comment id="12762827" author="chaow" created="Wed, 7 Oct 2009 01:54:04 +0100"  >&lt;p&gt;I ran into the same issue also.&lt;/p&gt;

&lt;p&gt;I did a fresh checkout from apache trunk and ran &quot;ant test&quot;, there are 14 test cases failed.&lt;/p&gt;

&lt;p&gt;Actually, they are caused by some incompatible exception type between pig and zebra. It seems pig already moved on with the change (IOException changed to IndexOutofBoundException), but zebra is behind a bit in this.&lt;/p&gt;
</comment>
                            <comment id="12762829" author="rangadi" created="Wed, 7 Oct 2009 02:08:58 +0100"  >&lt;p&gt;Not sure if this is related to PIG. When I applied &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-991&quot; title=&quot;[zebra] A few minor bugs as described in the Description section&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-991&quot;&gt;&lt;del&gt;PIG-991&lt;/del&gt;&lt;/a&gt; over this, the tests passed (except the ones that fail on trunk).&lt;/p&gt;</comment>
                            <comment id="12762854" author="yanz" created="Wed, 7 Oct 2009 04:50:29 +0100"  >&lt;p&gt;It&apos;s because this patch expose the env problem using lzo as compression that 991 eventually fixes.&lt;/p&gt;

&lt;p&gt;Can you commit 991&apos;s patch along with this? What are tthe failures from trunk? What are the error messages?&lt;/p&gt;</comment>
                            <comment id="12762871" author="rangadi" created="Wed, 7 Oct 2009 06:09:29 +0100"  >&lt;p&gt;Even with &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-991&quot; title=&quot;[zebra] A few minor bugs as described in the Description section&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-991&quot;&gt;&lt;del&gt;PIG-991&lt;/del&gt;&lt;/a&gt; included, I am seeing lzo related failures. Could you run tests on a clean checkout? If you didn&apos;t see the errors before then you probably have lzo set up in your environment, which is not a requirement. &lt;/p&gt;
</comment>
                            <comment id="12763127" author="yanz" created="Wed, 7 Oct 2009 18:00:53 +0100"  >&lt;p&gt;This patch has additional test scripts that do not use the nodefault lzo compression. Its application should be followed by the one in &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-991&quot; title=&quot;[zebra] A few minor bugs as described in the Description section&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-991&quot;&gt;&lt;del&gt;PIG-991&lt;/del&gt;&lt;/a&gt; to pass all Zebra-related tests.&lt;/p&gt;</comment>
                            <comment id="12763133" author="yanz" created="Wed, 7 Oct 2009 18:06:32 +0100"  >&lt;p&gt;I have attached a new patch that removes the use of lzo in 6 test scripts.  Accordingly, patches of 2 &quot;downstream&quot; Jiras, &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-986&quot; title=&quot;[zebra] Zebra Column Group Naming Support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-986&quot;&gt;&lt;del&gt;PIG-986&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-992&quot; title=&quot;[zebra] Separate Schema-related files into a &amp;quot;Schema&amp;quot; package&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-992&quot;&gt;&lt;del&gt;PIG-992&lt;/del&gt;&lt;/a&gt;, will also be updated; while the other three &quot;downstream&quot; patches, &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-991&quot; title=&quot;[zebra] A few minor bugs as described in the Description section&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-991&quot;&gt;&lt;del&gt;PIG-991&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-993&quot; title=&quot;[zebra] Abitlity to drop a column group in a table&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-993&quot;&gt;&lt;del&gt;PIG-993&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-944&quot; title=&quot;Zebra schema is taken from Pig through TableStorer&amp;#39;s construct&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-944&quot;&gt;&lt;del&gt;PIG-944&lt;/del&gt;&lt;/a&gt;, need not to be changed.&lt;/p&gt;</comment>
                            <comment id="12763200" author="rangadi" created="Wed, 7 Oct 2009 20:17:44 +0100"  >&lt;p&gt;Attachments :&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;tmp-987-plus-991.patch : latest patch here + patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-991&quot; title=&quot;[zebra] A few minor bugs as described in the Description section&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-991&quot;&gt;&lt;del&gt;PIG-991&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;TEST-org.apache.hadoop.zebra.io.TestCheckin.txt : output of the failed tests.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Yan,  looks like lzo related errors are fixed with the combined patch. But there are still some failures. I think some of these failures exist on trunk as well.&lt;/p&gt;</comment>
                            <comment id="12763325" author="yanz" created="Thu, 8 Oct 2009 01:57:27 +0100"  >&lt;p&gt;I see the following errors in your attached log:&lt;/p&gt;

&lt;p&gt;chgrp: changing group of `/home/raghu/h/pig-commit/build/contrib/zebra/test/data/TestColumnGroupNullSplits&apos;: Operation not permitted&lt;/p&gt;

&lt;p&gt;So I believen your tests has encountered disk permission problems. Note that we are testing the feature of &quot;column group security&quot; so having property permission settings is necessary for the tests to pass.&lt;/p&gt;</comment>
                            <comment id="12763346" author="rangadi" created="Thu, 8 Oct 2009 04:47:06 +0100"  >&lt;p&gt;I finally got some time look into this. Yes. I think the it should be fixed in the tests. TestColumnGroup.java says :  &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    ColumnGroup.Writer writer = new ColumnGroup.Writer(path, strSchema, sorted,
        &quot;pig&quot;, &quot;gz&quot;, &quot;gauravj&quot;, &quot;users&quot;, (short) Short.parseShort(&quot;755&quot;, 8), false, conf);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;using local FS. How can we expect users to have a user name &quot;gauravj&quot; on their machines and run as superusers &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;? just can not be done.&lt;/p&gt;

&lt;p&gt;If the test wants to run with these permissions we should do :&lt;br/&gt;
 a) use HDFS (MiniDFSCluster) rather than local filesystem. The tester has all the permissions on a MiniDFS.&lt;br/&gt;
 b) minor : use a generic name than gauravj.&lt;/p&gt;</comment>
                            <comment id="12763361" author="yanz" created="Thu, 8 Oct 2009 05:47:22 +0100"  >&lt;p&gt;I don&apos;t think the owner name is a problem because in this release it has no effect at all.&lt;/p&gt;

&lt;p&gt;The log complains about &quot;chgrp changing group ... is not permitted&quot;.  Can you chgrp a local FS  file to a group called &quot;users&quot; on your box?&lt;/p&gt;</comment>
                            <comment id="12763516" author="rangadi" created="Thu, 8 Oct 2009 16:12:08 +0100"  >&lt;p&gt;&amp;gt; Can you chgrp a local FS file to a group called &quot;users&quot; on your box?&lt;br/&gt;
No.&lt;/p&gt;

&lt;p&gt;Its the same problem. I don&apos;t have a group called &quot;users&quot;.. and I don&apos;t think we can require others to have it.&lt;/p&gt;

&lt;p&gt;I didn&apos;t know owner is ignored. It is still allowed by storage hint?&lt;/p&gt;</comment>
                            <comment id="12763781" author="yanz" created="Fri, 9 Oct 2009 02:49:27 +0100"  >&lt;p&gt;remove the hardcoded group name  from a few test scripts.  This patch and the ones in Pig-991 and Pig-986 are ready to be comitted. But please hold on commiting Pig-992 and afterwards.&lt;/p&gt;</comment>
                            <comment id="12763836" author="rangadi" created="Fri, 9 Oct 2009 05:40:53 +0100"  >&lt;p&gt;Thanks Yan. It might be better to remove gauravj also since it is ignored anyway. &lt;/p&gt;

&lt;p&gt;This implies column access control is not tested in this patch, right?&lt;/p&gt;</comment>
                            <comment id="12763846" author="rangadi" created="Fri, 9 Oct 2009 06:14:45 +0100"  >&lt;p&gt;I just committed this. Thanks Yan!&lt;/p&gt;</comment>
                            <comment id="12764041" author="yanz" created="Fri, 9 Oct 2009 15:47:20 +0100"  >&lt;p&gt;Will remove gauravj .&lt;/p&gt;

&lt;p&gt;There is a TestColumnSecurity test script but it only works on a real cluster and is not part of checkin/nightly tests. I will add it in the next patch for Pig-986. Thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12434793">PIG-945</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12437142">PIG-991</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12421691" name="ColumnGroupSecurity.patch" size="106052" author="yanz" created="Fri, 9 Oct 2009 02:40:32 +0100"/>
                            <attachment id="12421539" name="ColumnGroupSecurity.patch" size="106058" author="yanz" created="Wed, 7 Oct 2009 18:00:53 +0100"/>
                            <attachment id="12421063" name="ColumnGroupSecurity.patch" size="106082" author="yanz" created="Thu, 1 Oct 2009 21:55:45 +0100"/>
                            <attachment id="12421562" name="TEST-org.apache.hadoop.zebra.io.TestCheckin.txt" size="31030" author="rangadi" created="Wed, 7 Oct 2009 20:17:44 +0100"/>
                            <attachment id="12421478" name="TEST-org.apache.hadoop.zebra.mapred.TestCheckin.txt" size="2266" author="rangadi" created="Wed, 7 Oct 2009 01:41:46 +0100"/>
                            <attachment id="12421563" name="tmp-987-plus-991.patch" size="117075" author="rangadi" created="Wed, 7 Oct 2009 20:17:44 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 1 Oct 2009 20:20:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164524</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy9qqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>90811</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>