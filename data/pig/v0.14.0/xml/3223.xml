<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:49:55 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3223/PIG-3223.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3223] AvroStorage does not handle comma separated input paths</title>
                <link>https://issues.apache.org/jira/browse/PIG-3223</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;In pig 0.11, a patch was issued to AvroStorage to support globs and comma separated input paths (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2492&quot; title=&quot;AvroStorage should recognize globs and commas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2492&quot;&gt;&lt;del&gt;PIG-2492&lt;/del&gt;&lt;/a&gt;).  While this function works fine for glob-formatted input paths, it fails when issued a standard comma separated list of paths.  fs.globStatus does not seem to be able to parse out such a list, and a java.net.URISyntaxException is thrown when toURI is called on the path.  &lt;/p&gt;

&lt;p&gt;I have a working fix for this, but it&apos;s extremely ugly (basically checking if the string of input paths is globbed, otherwise splitting on &quot;,&quot;).  I&apos;m sure there&apos;s a more elegant solution.  I&apos;d be happy to post the relevant methods and &quot;fixes&quot; if necessary.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12634533">PIG-3223</key>
            <summary>AvroStorage does not handle comma separated input paths</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dreambird">Johnny Zhang</assignee>
                                    <reporter username="mkramer">Michael Kramer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Feb 2013 00:55:01 +0000</created>
                <updated>Mon, 14 Oct 2013 17:46:43 +0100</updated>
                            <resolved>Mon, 6 May 2013 03:56:37 +0100</resolved>
                                    <version>0.10.0</version>
                    <version>0.11</version>
                                    <fixVersion>0.12.0</fixVersion>
                    <fixVersion>0.11.2</fixVersion>
                                    <component>piggybank</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13590143" author="dreambird" created="Fri, 1 Mar 2013 01:20:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mkramer&quot; class=&quot;user-hover&quot; rel=&quot;mkramer&quot;&gt;Michael Kramer&lt;/a&gt;, I am willing to continue working on this item. Seems very interesting. Do you mind post your current patch?&lt;/p&gt;</comment>
                            <comment id="13590952" author="mkramer" created="Fri, 1 Mar 2013 21:21:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dreambird&quot; class=&quot;user-hover&quot; rel=&quot;dreambird&quot;&gt;Johnny Zhang&lt;/a&gt;That&apos;s great Johnny.  I&apos;m attaching the patch now.  I&apos;ve modified the getSubDirs method call in AvroStorageUtils and added a rather ugly isGlob helper function.  I imagine there&apos;s a better filesystem api call that already takes care of these issues. &lt;/p&gt;</comment>
                            <comment id="13595165" author="mkramer" created="Wed, 6 Mar 2013 22:00:10 +0000"  >&lt;p&gt;It appears by returning the boolean status of the recursed &quot;getSubDirs&quot; method always results in &quot;false&quot;.  I&apos;m attaching a patch that reverts back to the original logic of discarding the recursive boolean statuses and just returning true if the first entrance into the method succeeds.&lt;/p&gt;</comment>
                            <comment id="13599488" author="dreambird" created="Mon, 11 Mar 2013 23:42:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mkramer&quot; class=&quot;user-hover&quot; rel=&quot;mkramer&quot;&gt;Michael Kramer&lt;/a&gt;, my apologize for late reply. Actually I found you properly can load comma separated avro file when using globe wrap it. like&lt;/p&gt;

&lt;p&gt;in = LOAD &apos;test_dir1/&lt;/p&gt;
{test_glob1.avro,test_glob2.avro,test_glob3.avro}
&lt;p&gt;&apos; USING org.apache.pig.piggybank.storage.avro.AvroStorage ();&lt;/p&gt;

&lt;p&gt;Does this satisfy your requirement? If this is the case, there is no code change required. &lt;br/&gt;
There is no test cover it right now, I just added one more test case to TestAvroStorage to make sure it won&apos;t break in the future.&lt;/p&gt;
</comment>
                            <comment id="13600675" author="cheolsoo" created="Wed, 13 Mar 2013 00:53:30 +0000"  >&lt;p&gt;Johnny is correct. Comma-separated lists must be surrounded by &quot;{ }&quot;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dreambird&quot; class=&quot;user-hover&quot; rel=&quot;dreambird&quot;&gt;Johnny Zhang&lt;/a&gt;, in fact, this is covered by the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
test_dir1/test_glob{1,2,3}.avro
test_dir1/test_glob{3,2,1}.avro
{test_dir1,test_dir2}/test_glob*.avro
{test_dir2,test_dir1}/test_glob*.avro
test_dir{1,2}/file_that_does_not_exist*.avro
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;These test cases go through the same code path as your test case does (test_dir1/{test_glob1.avro,test_glob2.avro,test_glob3.avro}).&lt;/p&gt;</comment>
                            <comment id="13600691" author="dreambird" created="Wed, 13 Mar 2013 01:17:38 +0000"  >&lt;p&gt;thanks for the comments, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cheolsoo&quot; class=&quot;user-hover&quot; rel=&quot;cheolsoo&quot;&gt;Cheolsoo Park&lt;/a&gt;, I think if this is the case, we can close the jira. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mkramer&quot; class=&quot;user-hover&quot; rel=&quot;mkramer&quot;&gt;Michael Kramer&lt;/a&gt;, please let us know if you have any other concern.&lt;/p&gt;</comment>
                            <comment id="13602921" author="mkramer" created="Fri, 15 Mar 2013 00:15:32 +0000"  >&lt;p&gt;The problem is when we&apos;re dealing with comma separated paths that aren&apos;t enclosed by {}.  Globs put restrictions on fully qualified hdfs paths. If we&apos;re dealing with non-globbed input paths, which PigStorage does handle, this function breaks, i.e if I passed testdir1/,testdir2/ as input, it would fail. It also fails with something like &lt;/p&gt;
{hdfs://namenode:8020/testdir1/,hdfs://namenode:8020/testdir2}
&lt;p&gt;/* &lt;/p&gt;</comment>
                            <comment id="13602925" author="mkramer" created="Fri, 15 Mar 2013 00:17:10 +0000"  >&lt;p&gt;If the goal here is to mirror the functionality of PigStorage, then I think we&apos;d want to support the same variations in input path formatting.&lt;/p&gt;</comment>
                            <comment id="13602940" author="mkramer" created="Fri, 15 Mar 2013 00:34:08 +0000"  >&lt;p&gt;Furthermore, the driving force for us comes from how Oozie constructs input paths.  If comma separated paths aren&apos;t supported in this way, AvroStorage as is can&apos;t be used with Oozie. &lt;/p&gt;</comment>
                            <comment id="13603011" author="cheolsoo" created="Fri, 15 Mar 2013 01:36:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mkramer&quot; class=&quot;user-hover&quot; rel=&quot;mkramer&quot;&gt;Michael Kramer&lt;/a&gt;, thank you for the clarification.&lt;/p&gt;

&lt;p&gt;You&apos;re right:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;PigStorage supports commma-separated input paths.&lt;/li&gt;
	&lt;li&gt;The fully qualified paths such as {hdfs://namenode:8020/testdir1/,hdfs://namenode:8020/testdir2} don&apos;t work in AvroStorage.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I am not against adding the support for comma-separated list like you suggest.&lt;/p&gt;

&lt;p&gt;That said, I don&apos;t understand your use case:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The driving force for us comes from how Oozie constructs input paths. If comma separated paths aren&apos;t supported in this way, AvroStorage as is can&apos;t be used with Oozie.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Can you please provide your Oozie workflow and Pig script? Why do input paths need to be fully qualified paths?&lt;/p&gt;</comment>
                            <comment id="13603652" author="mkramer" created="Fri, 15 Mar 2013 18:31:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cheolsoo&quot; class=&quot;user-hover&quot; rel=&quot;cheolsoo&quot;&gt;Cheolsoo Park&lt;/a&gt;, thanks for getting back to me so quickly!  &lt;/p&gt;

&lt;p&gt;We&apos;re using variable substitution and input path generation via Oozie Coordinator.  We include the hdfs://namenode:8020 at the beginning of our path templates, which I think is pretty standard (e.g. something like &amp;lt;uri-template&amp;gt;${nameNode}/data/&amp;lt;/uri-template&amp;gt; )  When Oozie constructs input paths to be passed to the pig script or map reduce job, it enumerates the paths via a comma separated list, something like  hdfs://namenode:8020/data/1,hdfs://namenode:8020/data/2.  This is how we figured out AvroStorage was breaking in the first place.  &lt;/p&gt;

&lt;p&gt;A good coordinator/workflow example that is indicative of the types of workflows we&apos;re running can be found in the Oozie source examples: &lt;a href=&quot;https://github.com/apache/oozie/blob/trunk/examples/src/main/apps/aggregator/coordinator.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/oozie/blob/trunk/examples/src/main/apps/aggregator/coordinator.xml&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13606658" author="cheolsoo" created="Tue, 19 Mar 2013 18:46:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mkramer&quot; class=&quot;user-hover&quot; rel=&quot;mkramer&quot;&gt;Michael Kramer&lt;/a&gt;, thanks for the explanation.&lt;/p&gt;

&lt;p&gt;I actually asked an Oozie developer about this, and you&apos;re right that Oozie recommends to include the &quot;hdfs://namenode:8020&quot; in the path since the same Oozie server might be used for multiple Hadoop clusters. I agree that comma-separated input paths should be supported by AvroStorage.&lt;/p&gt;</comment>
                            <comment id="13608025" author="dreambird" created="Wed, 20 Mar 2013 19:06:27 +0000"  >&lt;p&gt;Thanks for clarification, I will post patch soon.&lt;/p&gt;</comment>
                            <comment id="13611027" author="dreambird" created="Fri, 22 Mar 2013 18:20:10 +0000"  >&lt;p&gt;the latest patch makes AvroStorage working for comma separated input. The patch also adds two test cases for below inputs&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; testCommaSeparated1 = getInputFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;test_dir1/test_glob1.avro,test_dir1/test_glob2.avro,test_dir1/test_glob3.avro&quot;&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; testCommaSeparated2 = getInputFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;test_dir1/*, test_dir2/test_glob4.avro, test_dir2/test_glob5.avro&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13611505" author="prkommireddi" created="Sat, 23 Mar 2013 01:13:41 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dreambird&quot; class=&quot;user-hover&quot; rel=&quot;dreambird&quot;&gt;Johnny Zhang&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;I have a question regarding the current approach - why isn&apos;t the globbing implemented in PigAvroInputFormat? Overriding listStatus(JobContext job) should be cleaner, unless I am missing something very specific to Avro?&lt;/p&gt;</comment>
                            <comment id="13616066" author="dreambird" created="Thu, 28 Mar 2013 05:27:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=prkommireddi&quot; class=&quot;user-hover&quot; rel=&quot;prkommireddi&quot;&gt;Prashant Kommireddi&lt;/a&gt;, sorry I don&apos;t know why globbing is implemented in AvroStorage this way. Maybe a good idea to follow &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3015&quot; title=&quot;Rewrite of AvroStorage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3015&quot;&gt;&lt;del&gt;PIG-3015&lt;/del&gt;&lt;/a&gt; to polish AvroStorage implementation. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13625897" author="dreambird" created="Mon, 8 Apr 2013 23:05:15 +0100"  >&lt;p&gt;this is the review board link&lt;/p&gt;</comment>
                            <comment id="13647780" author="viraj" created="Thu, 2 May 2013 19:23:29 +0100"  >&lt;p&gt;Hi Johnny are you planning to work on this patch. Meanwhile I will post an updated patch, which I got working on Pig 0.11 and trunk.&lt;br/&gt;
Viraj&lt;/p&gt;</comment>
                            <comment id="13647785" author="dreambird" created="Thu, 2 May 2013 19:29:05 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=viraj&quot; class=&quot;user-hover&quot; rel=&quot;viraj&quot;&gt;Viraj Bhat&lt;/a&gt;, thanks for your comments &amp;amp; patch, my previous patch got some comments from Rohini on the review board, I am going to update a revised on later today. I will review your patch as well. Thanks!&lt;/p&gt;</comment>
                            <comment id="13647834" author="rohini" created="Thu, 2 May 2013 20:32:43 +0100"  >&lt;p&gt;I think we should get this patch into 0.11 also to benefit current users as trunk has a rewrite of AvroStorage. Without comma separated paths, it is not possible to use it with oozie if one is consuming data from more than one directory. &lt;/p&gt;</comment>
                            <comment id="13647938" author="dreambird" created="Thu, 2 May 2013 22:50:05 +0100"  >&lt;p&gt;@Rohini and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=viraj&quot; class=&quot;user-hover&quot; rel=&quot;viraj&quot;&gt;Viraj Bhat&lt;/a&gt;, thanks for your comments. I appreciate. Is that OK to still keep this jira in my queue (I notice the sssignee changed) so that I can deliver my contribution completely? I am actually working on revising the patch at this moment &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Thanks. &lt;/p&gt;</comment>
                            <comment id="13647944" author="viraj" created="Thu, 2 May 2013 22:54:51 +0100"  >&lt;p&gt;Sorry please assign this Jira to yourself and continue. Since I already had a patch and I thought of uploading it.. Somehow could not get an option to attach the patch hence I changed the owner.&lt;br/&gt;
Viraj&lt;/p&gt;</comment>
                            <comment id="13647996" author="viraj" created="Thu, 2 May 2013 23:48:49 +0100"  >&lt;p&gt;Updated patch from Viraj&lt;/p&gt;</comment>
                            <comment id="13648055" author="dreambird" created="Fri, 3 May 2013 01:25:46 +0100"  >&lt;p&gt;post the revised patch based on Rohini&apos;s comments, I also run TestAvroStorage and it pass for me. Thanks.&lt;/p&gt;</comment>
                            <comment id="13648078" author="dreambird" created="Fri, 3 May 2013 02:00:26 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rohini&quot; class=&quot;user-hover&quot; rel=&quot;rohini&quot;&gt;Rohini Palaniswamy&lt;/a&gt;, could you please review the latest patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12581645/PIG-3223.patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12581645/PIG-3223.patch.txt&lt;/a&gt; ?&lt;br/&gt;
new added test cases in TestAvroStorage is also clean. Please let me know any concern regarding to the implementation, I will revised it as soon as possible!&lt;br/&gt;
Let me know if you want me post another patch for 0.11 branch too!&lt;/p&gt;

&lt;p&gt;I also tried Viraj&apos;s patch &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3223&quot; title=&quot;AvroStorage does not handle comma separated input paths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3223&quot;&gt;&lt;del&gt;PIG-3223&lt;/del&gt;&lt;/a&gt;.viraj.txt&apos;, it not clean on trunk&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;patching file contrib/piggybank/java/src/main/java/org/apache/pig/piggybank/storage/avro/AvroStorage.java
patching file contrib/piggybank/java/src/test/java/org/apache/pig/piggybank/test/storage/avro/TestAvroStorage.java
Hunk #2 succeeded at 45 (offset 1 line).
Hunk #3 succeeded at 72 (offset 1 line).
Hunk #4 succeeded at 91 with fuzz 1 (offset 1 line).
Hunk #5 succeeded at 1005 (offset 19 lines).
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;also the TestAvroStorage test failed&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    &amp;lt;error message=&quot;Error during parsing. java.net.URISyntaxException: Illegal character in scheme name at index 4: test_glob1.avro,file:&quot; type=&quot;org.apache.pig.impl.logicalLayer.FrontendException&quot;&amp;gt;org.apache.pig.impl.logicalLayer.FrontendException: ERROR 1000: Error during parsing. java.net.URISyntaxException: Illegal character in scheme name at index 4: test_glob1.avro,file:
        at org.apache.pig.PigServer$Graph.parseQuery(PigServer.java:1670)
        at org.apache.pig.PigServer$Graph.registerQuery(PigServer.java:1608)
        at org.apache.pig.PigServer.registerQuery(PigServer.java:565)
        at org.apache.pig.PigServer.registerQuery(PigServer.java:578)
        at org.apache.pig.piggybank.test.storage.avro.TestAvroStorage.testAvroStorage(TestAvroStorage.java:1058)
        at org.apache.pig.piggybank.test.storage.avro.TestAvroStorage.testAvroStorage(TestAvroStorage.java:1051)
        at org.apache.pig.piggybank.test.storage.avro.TestAvroStorage.testComma1(TestAvroStorage.java:1020)
Caused by: Failed to parse: java.net.URISyntaxException: Illegal character in scheme name at index 4: test_glob1.avro,file:
        at org.apache.pig.parser.QueryParserDriver.parse(QueryParserDriver.java:191)
        at org.apache.pig.PigServer$Graph.parseQuery(PigServer.java:1661)
Caused by: java.lang.IllegalArgumentException: java.net.URISyntaxException: Illegal character in scheme name at index 4: test_glob1.avro,file:
        at org.apache.hadoop.fs.Path.initialize(Path.java:148)
        at org.apache.hadoop.fs.Path.&amp;amp;lt;init&amp;amp;gt;(Path.java:126)
        at org.apache.hadoop.fs.Path.&amp;amp;lt;init&amp;amp;gt;(Path.java:50)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1084)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globPathsLevel(FileSystem.java:1087)
        at org.apache.hadoop.fs.FileSystem.globStatusInternal(FileSystem.java:1023)
        at org.apache.hadoop.fs.FileSystem.globStatus(FileSystem.java:987)
        at org.apache.pig.piggybank.storage.avro.AvroStorageUtils.getAllSubDirs(AvroStorageUtils.java:120)
        at org.apache.pig.piggybank.storage.avro.AvroStorage.getSchema(AvroStorage.java:387)
        at org.apache.pig.newplan.logical.relational.LOLoad.getSchemaFromMetaData(LOLoad.java:174)
        at org.apache.pig.newplan.logical.relational.LOLoad.&amp;amp;lt;init&amp;amp;gt;(LOLoad.java:88)
        at org.apache.pig.parser.LogicalPlanBuilder.buildLoadOp(LogicalPlanBuilder.java:856)
        at org.apache.pig.parser.LogicalPlanGenerator.load_clause(LogicalPlanGenerator.java:3256)
        at org.apache.pig.parser.LogicalPlanGenerator.op_clause(LogicalPlanGenerator.java:1335)
        at org.apache.pig.parser.LogicalPlanGenerator.general_statement(LogicalPlanGenerator.java:819)
        at org.apache.pig.parser.LogicalPlanGenerator.statement(LogicalPlanGenerator.java:537)
        at org.apache.pig.parser.LogicalPlanGenerator.query(LogicalPlanGenerator.java:412)
        at org.apache.pig.parser.QueryParserDriver.parse(QueryParserDriver.java:181)
Caused by: java.net.URISyntaxException: Illegal character in scheme name at index 4: test_glob1.avro,file:
        at java.net.URI$Parser.fail(URI.java:2809)
        at java.net.URI$Parser.checkChars(URI.java:2982)
        at java.net.URI$Parser.parse(URI.java:3009)
        at java.net.URI.&amp;amp;lt;init&amp;amp;gt;(URI.java:736)
        at org.apache.hadoop.fs.Path.initialize(Path.java:145)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13648089" author="viraj" created="Fri, 3 May 2013 02:16:00 +0100"  >&lt;p&gt;Johnny, Thanks let me check as to why it is failing in trunk. I never tested on trunk, as I thought this was only going to be committed in Pig 0.11. &lt;/p&gt;</comment>
                            <comment id="13648704" author="dreambird" created="Fri, 3 May 2013 20:31:51 +0100"  >&lt;p&gt;latest patch addressed Rohini&apos;s comments in RB&lt;/p&gt;</comment>
                            <comment id="13648852" author="dreambird" created="Fri, 3 May 2013 23:40:26 +0100"  >&lt;p&gt;Rohini, thanks for your +1 on RB. Here is the patch for branch 0.11. Could please help commit the patch (to trunk and 0.11)? Appreciate.&lt;/p&gt;</comment>
                            <comment id="13649490" author="rohini" created="Mon, 6 May 2013 03:56:37 +0100"  >&lt;p&gt;+1. Committed to 0.11.2 and trunk. Thanks Johnny&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12571647" name="AvroStorage.patch" size="28708" author="mkramer" created="Fri, 1 Mar 2013 21:21:48 +0000"/>
                            <attachment id="12572406" name="AvroStorage.patch-2" size="28708" author="mkramer" created="Wed, 6 Mar 2013 22:02:50 +0000"/>
                            <attachment id="12571648" name="AvroStorageUtils.patch" size="26294" author="mkramer" created="Fri, 1 Mar 2013 21:21:48 +0000"/>
                            <attachment id="12572407" name="AvroStorageUtils.patch-2" size="26277" author="mkramer" created="Wed, 6 Mar 2013 22:02:50 +0000"/>
                            <attachment id="12581758" name="PIG-3223.branch-0.11.patch.txt" size="7995" author="dreambird" created="Fri, 3 May 2013 23:40:26 +0100"/>
                            <attachment id="12581735" name="PIG-3223.patch.txt" size="7959" author="dreambird" created="Fri, 3 May 2013 20:31:51 +0100"/>
                            <attachment id="12581645" name="PIG-3223.patch.txt" size="7819" author="dreambird" created="Fri, 3 May 2013 01:32:59 +0100"/>
                            <attachment id="12581644" name="PIG-3223.patch.txt" size="7996" author="dreambird" created="Fri, 3 May 2013 01:25:46 +0100"/>
                            <attachment id="12575060" name="PIG-3223.patch.txt" size="7977" author="dreambird" created="Fri, 22 Mar 2013 18:14:57 +0000"/>
                            <attachment id="12573212" name="PIG-3223.patch.txt" size="2197" author="dreambird" created="Mon, 11 Mar 2013 23:43:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 1 Mar 2013 01:20:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315026</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzc7n3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315370</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>