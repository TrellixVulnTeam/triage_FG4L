<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:01:17 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-970/PIG-970.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-970] Support of HBase 0.20.0</title>
                <link>https://issues.apache.org/jira/browse/PIG-970</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The support of HBase is currently very limited and restricted to HBase 0.18.0.&lt;br/&gt;
Because the next releases of PIG will support Hadoop 0.20.0, they should also support HBase 0.20.0.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12436125">PIG-970</key>
            <summary>Support of HBase 0.20.0</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zjffdu">Jeff Zhang</assignee>
                                    <reporter username="vbarat">Vincent BARAT</reporter>
                        <labels>
                    </labels>
                <created>Sat, 19 Sep 2009 17:51:16 +0100</created>
                <updated>Wed, 24 Mar 2010 22:15:55 +0000</updated>
                            <resolved>Thu, 5 Nov 2009 17:57:16 +0000</resolved>
                                    <version>0.3.0</version>
                                    <fixVersion>0.6.0</fixVersion>
                                    <component>impl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12757677" author="vbarat" created="Sat, 19 Sep 2009 17:56:38 +0100"  >&lt;p&gt;This small patch ports the current HBase 0.18.0 related code source to HBase 0.20.0. This patch works for me. It applies on the trunk of PIG as of revision 816619. Unfortunately, I was unable to make the TestHBaseStorage unit test work correctly, but it seems to be a problem with my environment (classpath).&lt;br/&gt;
Someone else will have to test it and complete the patch (it lacks the hbase-0.20.0 jar file). &lt;/p&gt;</comment>
                            <comment id="12759626" author="alangates" created="Fri, 25 Sep 2009 18:05:39 +0100"  >&lt;p&gt;In addition to adding hbase-0.20.0.jar to the lib directory did you add hbase-0.20.0-test?  &lt;/p&gt;</comment>
                            <comment id="12759727" author="vbarat" created="Fri, 25 Sep 2009 21:24:37 +0100"  >&lt;p&gt;Yes, but I was unable to make the TestHBaseStorage work. I guess it was just a matter of environement, since the errors were related to a classes not found.&lt;br/&gt;
I didn&apos;t waste too much time on that actually...&lt;br/&gt;
I will try again.&lt;/p&gt;</comment>
                            <comment id="12759732" author="vbarat" created="Fri, 25 Sep 2009 21:35:10 +0100"  >&lt;p&gt;To show you better what I did on the jar files side, here is the patch I made on the build.xml file.&lt;/p&gt;</comment>
                            <comment id="12759736" author="alangates" created="Fri, 25 Sep 2009 21:41:51 +0100"  >&lt;p&gt;The issue was the missing Zookeeper lib.  I added that, and now I get what looks like a real hbase error.  I have no idea what it means, so I&apos;ll let you take a look.  I&apos;ve attached both a new patch (with the changes to build.xml to pick up the right libs) and the error log from the test run.&lt;/p&gt;</comment>
                            <comment id="12759941" author="vbarat" created="Sat, 26 Sep 2009 20:57:01 +0100"  >&lt;p&gt;Thanks to your patch, I succeeded in running the TestBaseStorage test (see attached log).&lt;br/&gt;
I do not reproduce your error, which may come from your enthronement.&lt;/p&gt;</comment>
                            <comment id="12770866" author="zjffdu" created="Wed, 28 Oct 2009 10:03:20 +0000"  >&lt;p&gt;Any progress on this issue ?&lt;br/&gt;
It looks like it&apos;s still opened&lt;/p&gt;</comment>
                            <comment id="12770974" author="alangates" created="Wed, 28 Oct 2009 16:12:04 +0000"  >&lt;p&gt;I haven&apos;t been able to get the unit test to pass in my environment.&lt;/p&gt;</comment>
                            <comment id="12772461" author="zjffdu" created="Mon, 2 Nov 2009 08:33:54 +0000"  >&lt;p&gt;Vincent, I do not know how you pass TestHBaseStorage using your patch. Because hbase 0.20 integrate zookeeper , so TestHBaseStorage has to be updated accordingly.&lt;/p&gt;

&lt;p&gt;I submit the patch including the source code and jars.  (one tricky thing is that MiniZookeeperCluster&apos;s client port is 21810 which is hard coded in source code level, while the default zookeeper&apos;s port is 2181. so I attach hbase-site.xml to override the client port of zookeeper to make it the same as MiniZookeeperCluster) &lt;/p&gt;
</comment>
                            <comment id="12772464" author="hadoopqa" created="Mon, 2 Nov 2009 08:44:30 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12423811/zookeeper-hbase-1329.jar&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12423811/zookeeper-hbase-1329.jar&lt;/a&gt;&lt;br/&gt;
  against trunk revision 831481.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    +1 tests included.  The patch appears to include 92 new or modified tests.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/136/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-h7.grid.sp2.yahoo.net/136/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12772465" author="zjffdu" created="Mon, 2 Nov 2009 08:54:20 +0000"  >&lt;p&gt;this patch works on my machine, but it seems that I have no right to put the jars into pig trunk, so anyone could help validate the patch on pig trunk ?&lt;/p&gt;

&lt;p&gt;Thank you in advance.&lt;/p&gt;</comment>
                            <comment id="12772781" author="alangates" created="Tue, 3 Nov 2009 00:17:29 +0000"  >&lt;p&gt;Patch doesn&apos;t include binary files.  I&apos;ll pull together the latest patch plus the jars and test it.&lt;/p&gt;</comment>
                            <comment id="12773103" author="alangates" created="Tue, 3 Nov 2009 18:34:45 +0000"  >&lt;p&gt;When I run TestHBaseStorage now I get:&lt;/p&gt;

&lt;p&gt;Testcase: testLoadFromHBase took 592.908 sec&lt;br/&gt;
    Caused an ERROR&lt;br/&gt;
Unable to open iterator for alias a&lt;br/&gt;
org.apache.pig.impl.logicalLayer.FrontendException: ERROR 1066: Unable to open iterator for alias a&lt;br/&gt;
    at org.apache.pig.PigServer.openIterator(PigServer.java:481)&lt;br/&gt;
    at org.apache.pig.test.TestHBaseStorage.testLoadFromHBase(TestHBaseStorage.java:170)&lt;br/&gt;
Caused by: org.apache.pig.backend.executionengine.ExecException: ERROR 6015: During execution, encountered a Hadoop error.&lt;br/&gt;
    at .apache.hadoop.hbase.client.HConnectionManager$TableServers.locateRootRegion(HConnectionManager.java:922)&lt;br/&gt;
    at .apache.hadoop.hbase.client.HConnectionManager$TableServers.locateRegion(HConnectionManager.java:573)&lt;br/&gt;
    at .apache.hadoop.hbase.client.HConnectionManager$TableServers.relocateRegion(HConnectionManager.java:555)&lt;br/&gt;
    at .apache.hadoop.hbase.client.HConnectionManager$TableServers.locateRegionInMeta(HConnectionManager.java:686)&lt;br/&gt;
    at .apache.hadoop.hbase.client.HConnectionManager$TableServers.locateRegion(HConnectionManager.java:582)&lt;br/&gt;
    at .apache.hadoop.hbase.client.HConnectionManager$TableServers.relocateRegion(HConnectionManager.java:555)&lt;br/&gt;
    at .apache.hadoop.hbase.client.HConnectionManager$TableServers.locateRegionInMeta(HConnectionManager.java:686)&lt;br/&gt;
    at .apache.hadoop.hbase.client.HConnectionManager$TableServers.locateRegion(HConnectionManager.java:586)&lt;br/&gt;
    at .apache.hadoop.hbase.client.HConnectionManager$TableServers.locateRegion(HConnectionManager.java:549)&lt;br/&gt;
    at .apache.hadoop.hbase.client.HTable.&amp;lt;init&amp;gt;(HTable.java:125)&lt;br/&gt;
    at .apache.pig.backend.hadoop.hbase.HBaseSlice.init(HBaseSlice.java:159)&lt;br/&gt;
    at .apache.pig.backend.hadoop.executionengine.mapReduceLayer.SliceWrapper.makeReader(SliceWrapper.java:129)&lt;br/&gt;
    at .apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigInputFormat.getRecordReader(PigInputFormat.java:258)&lt;br/&gt;
    at .apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:338)&lt;br/&gt;
    at .apache.hadoop.mapred.MapTask.run(MapTask.java:307)&lt;br/&gt;
Caused by: org.apache.hadoop.hbase.client.NoServerForRegionException: Timed out trying to locate root region&lt;/p&gt;

&lt;p&gt;Let me know if you&apos;d like to see the whole log.&lt;/p&gt;</comment>
                            <comment id="12773297" author="zjffdu" created="Tue, 3 Nov 2009 23:59:13 +0000"  >&lt;p&gt;yes, Alan, Could you attach the whole log including the logs of task tracker&lt;br/&gt;
Thank you.&lt;/p&gt;</comment>
                            <comment id="12773302" author="alangates" created="Wed, 4 Nov 2009 00:17:19 +0000"  >&lt;p&gt;Test run results plus logs.&lt;/p&gt;</comment>
                            <comment id="12773309" author="zjffdu" created="Wed, 4 Nov 2009 00:32:30 +0000"  >&lt;p&gt;Alan, do you have  file hbase-site.xml in folder test ? ( I put it in my patch)&lt;/p&gt;

&lt;p&gt;Because I look into the logs and find that the map task is attempting to connect to zookeeper at port 2181, but the the port of MiniZookeeperCluster is 21810.  So there should be a file hbase-site.xml in folder test to override the configuration just like they did in hbase trunk.&lt;/p&gt;
</comment>
                            <comment id="12773314" author="alangates" created="Wed, 4 Nov 2009 00:48:20 +0000"  >&lt;p&gt;Yes, it&apos;s there.&lt;/p&gt;</comment>
                            <comment id="12773339" author="zjffdu" created="Wed, 4 Nov 2009 01:47:53 +0000"  >&lt;p&gt;Well, it&apos;s weird.&lt;/p&gt;

&lt;p&gt;Alan, could check again that the pig-0.6.0-dev-withouthadoop.jar have file hbase-site.xml, and in this file hbase.zookeeper.property.clientPort is set to 21810 ?&lt;/p&gt;
</comment>
                            <comment id="12773348" author="alangates" created="Wed, 4 Nov 2009 02:05:56 +0000"  >&lt;p&gt;afterside:~/src/pig/&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-970&quot; title=&quot;Support of HBase 0.20.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-970&quot;&gt;&lt;del&gt;PIG-970&lt;/del&gt;&lt;/a&gt;-3/trunk&amp;gt; jar tf pig-withouthadoop.jar | grep hbase&lt;br/&gt;
org/apache/pig/backend/hadoop/hbase/&lt;br/&gt;
org/apache/pig/backend/hadoop/hbase/HBaseSlice.class&lt;br/&gt;
org/apache/pig/backend/hadoop/hbase/HBaseStorage.class&lt;/p&gt;</comment>
                            <comment id="12773366" author="zjffdu" created="Wed, 4 Nov 2009 03:14:52 +0000"  >&lt;p&gt;Alan, I find the problem.  Before in eclipse I put the output folder to build/classes which is conflict with the output folder in build.xml. So it hides the problem.&lt;/p&gt;

&lt;p&gt;Now I add one line in build.xml:&lt;/p&gt;
 &lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;copy file=&lt;span class=&quot;code-quote&quot;&gt;&quot;${basedir}/test/hbase-site.xml&quot;&lt;/span&gt; tofile=&lt;span class=&quot;code-quote&quot;&gt;&quot;${test.build.classes}/hbase-site.xml&quot;&lt;/span&gt;/&amp;gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So that the test case code can find hbase-site.xml in classpath.&lt;/p&gt;
</comment>
                            <comment id="12774003" author="alangates" created="Thu, 5 Nov 2009 17:57:16 +0000"  >&lt;p&gt;I have checked in the patch.  Thank you Jeff and Vincent for you patience and persistence in getting this in.&lt;/p&gt;

&lt;p&gt;I propose that we also check this into the 0.5 branch since that branch is on 0.20, and currently hbase integration is broken in 0.5.&lt;/p&gt;</comment>
                            <comment id="12774007" author="dvryaboy" created="Thu, 5 Nov 2009 18:03:52 +0000"  >&lt;p&gt;Didn&apos;t 0.5 go out already? Are you thinking we will need 0.5.1 before 0.6 comes out?&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12423999" name="Pig_HBase_0.20.0.patch" size="16710" author="zjffdu" created="Wed, 4 Nov 2009 03:14:52 +0000"/>
                            <attachment id="12423976" name="TEST-org.apache.pig.test.TestHBaseStorage.txt" size="286950" author="alangates" created="Wed, 4 Nov 2009 00:17:19 +0000"/>
                            <attachment id="12420634" name="TEST-org.apache.pig.test.TestHBaseStorage.txt" size="164980" author="vbarat" created="Sat, 26 Sep 2009 20:57:01 +0100"/>
                            <attachment id="12420601" name="TEST-org.apache.pig.test.TestHBaseStorage.txt" size="37047" author="alangates" created="Fri, 25 Sep 2009 21:41:51 +0100"/>
                            <attachment id="12420599" name="build.xml.path" size="1432" author="vbarat" created="Fri, 25 Sep 2009 21:35:09 +0100"/>
                            <attachment id="12423809" name="hbase-0.20.0-test.jar" size="1916683" author="zjffdu" created="Mon, 2 Nov 2009 08:28:55 +0000"/>
                            <attachment id="12423808" name="hbase-0.20.0.jar" size="1530035" author="zjffdu" created="Mon, 2 Nov 2009 08:28:55 +0000"/>
                            <attachment id="12420127" name="pig-hbase-0.20.0-support.patch" size="2660" author="vbarat" created="Sat, 19 Sep 2009 17:56:38 +0100"/>
                            <attachment id="12420600" name="pig-hbase-20-v2.patch" size="5501" author="alangates" created="Fri, 25 Sep 2009 21:41:51 +0100"/>
                            <attachment id="12423977" name="test-output.tgz" size="37977" author="alangates" created="Wed, 4 Nov 2009 00:17:19 +0000"/>
                            <attachment id="12423811" name="zookeeper-hbase-1329.jar" size="1109768" author="zjffdu" created="Mon, 2 Nov 2009 08:30:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 25 Sep 2009 17:05:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164508</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyal0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95717</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>hbase</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>