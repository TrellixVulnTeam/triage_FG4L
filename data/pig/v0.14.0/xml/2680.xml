<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:48:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2680/PIG-2680.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2680] TOBAG output schema reporting</title>
                <link>https://issues.apache.org/jira/browse/PIG-2680</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;TOBAG only reports an output schema beyond {{&lt;/p&gt;
{(NULL)}
&lt;p&gt;}} when all input field schemas match deeply, including field schema aliases. This seems wrong to me. Shouldn&apos;t it just require recursive type equality?&lt;/p&gt;

&lt;p&gt;For relevant code, see:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc/pig/tags/release-0.9.2/src/org/apache/pig/builtin/TOBAG.java?view=markup#l142&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/pig/tags/release-0.9.2/src/org/apache/pig/builtin/TOBAG.java?view=markup#l142&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; nullEquals(Schema currentSchema, Schema newSchema) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(currentSchema == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;){
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(newSchema != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;){
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
            }
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; currentSchema.equals(newSchema);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The included patch modifies the return line to use &lt;tt&gt;Schema.equals(currentSchema, newSchema, false, true)&lt;/tt&gt; to avoid alias matching requirement.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12553707">PIG-2680</key>
            <summary>TOBAG output schema reporting</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hazen">Andy Schlaikjer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 May 2012 06:09:42 +0100</created>
                <updated>Sun, 6 Jan 2013 23:56:59 +0000</updated>
                            <resolved>Tue, 8 May 2012 23:52:12 +0100</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.11</fixVersion>
                    <fixVersion>0.10.1</fixVersion>
                                    <component>internal-udfs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13267535" author="jcoveney" created="Thu, 3 May 2012 17:00:26 +0100"  >&lt;p&gt;This looks good to me. I will try to commit it this weekend if I have a chance to run test-commit against 0.10 and 0.11 (I am still in Asia).&lt;/p&gt;</comment>
                            <comment id="13268169" author="jcoveney" created="Fri, 4 May 2012 07:23:25 +0100"  >&lt;p&gt;Andy,&lt;/p&gt;

&lt;p&gt;I am testing this now and it looks good. One thing you still need to do is update the comments in TOBAG, because it explicitly makes note of the fact that if the schema of the tuples does not agree, that it will return a null schema. Now, it will take the first one.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Jon&lt;/p&gt;</comment>
                            <comment id="13268500" author="hazen" created="Fri, 4 May 2012 17:23:19 +0100"  >&lt;p&gt;Hi Jon, Thanks for the test! As for the documented semantics of the UDF, they haven&apos;t really changed-- I&apos;ve just relaxed the constraint on alias matching. If there&apos;s a mismatch on types at any level, the same null output schema will be returned.&lt;/p&gt;</comment>
                            <comment id="13268829" author="jcoveney" created="Sat, 5 May 2012 01:54:09 +0100"  >&lt;p&gt;This comes from the current comments on TOBAG:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 67  *  example 3
 68  *  grunt&amp;gt; describe a;                                                             
 69  *  a: {a0: (x: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;),a1: (y: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)}
 70  * -- note that the &lt;span class=&quot;code-keyword&quot;&gt;inner&lt;/span&gt; schema is different because the alises (x &amp;amp; y) are different
 71  *  grunt&amp;gt; b = foreach a generate TOBAG(a0,a1);                                    
 72  *  grunt&amp;gt; describe b;                                                             
 73  *  b: {{NULL}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;your patch changes that. It&apos;s an ok change IMHO, since it is a more permissive change and the old version would have forced people to manually cast if the schema mattered, but we still need to update the comments accordingly, as in the above example, it&apos;d now be b: &lt;tt&gt;(x:int)&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="13269337" author="hazen" created="Mon, 7 May 2012 04:00:17 +0100"  >&lt;p&gt;I totally missed that bit. Thanks for pasting the example. I&apos;ll update the patch to include changes to the javadoc. Let me know if you like how it reads.&lt;/p&gt;</comment>
                            <comment id="13269338" author="hazen" created="Mon, 7 May 2012 04:00:45 +0100"  >&lt;p&gt;Updated patch which includes updates to javadoc.&lt;/p&gt;</comment>
                            <comment id="13270912" author="jcoveney" created="Tue, 8 May 2012 23:51:11 +0100"  >&lt;p&gt;Committed. Thanks for the submissions, Andy! r1335807 and r1335806&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12525797" name="fixes_tobag_input_schema_validation-r2.patch" size="2543" author="hazen" created="Mon, 7 May 2012 04:00:45 +0100"/>
                            <attachment id="12525393" name="fixes_tobag_input_schema_validation.patch" size="462" author="hazen" created="Thu, 3 May 2012 06:11:05 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 3 May 2012 16:00:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>237901</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxwojz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14465</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>