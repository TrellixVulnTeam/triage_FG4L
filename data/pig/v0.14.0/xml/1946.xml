<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:52:39 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1946/PIG-1946.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1946] HBaseStorage constructor syntax is error prone</title>
                <link>https://issues.apache.org/jira/browse/PIG-1946</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Using &lt;tt&gt;HBaseStorage&lt;/tt&gt; like so seems like a reasonable thing to do, but it will yield unexpected results:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
STORE result INTO &apos;hbase:&lt;span class=&quot;code-comment&quot;&gt;//foo&apos; USING
&lt;/span&gt; org.apache.pig.backend.hadoop.hbase.HBaseStorage(
 &apos;info:first_name, info:last_name&apos;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem us that a column named &lt;tt&gt;info:first_name,&lt;/tt&gt; will be created, with the trailing comma included. I&apos;ve had numerous developers get tripped up on this issue since everywhere else in Pig variables are separated by commas, so I propose we fix it.&lt;/p&gt;

&lt;p&gt;I propose we trim leading/trailing commas from column names, but I&apos;m open to other ideas.&lt;/p&gt;

&lt;p&gt;Also should we accept column names that are comman-delimited without spaces?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12502938">PIG-1946</key>
            <summary>HBaseStorage constructor syntax is error prone</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="billgraham">Bill Graham</assignee>
                                    <reporter username="billgraham">Bill Graham</reporter>
                        <labels>
                    </labels>
                <created>Thu, 31 Mar 2011 01:51:38 +0100</created>
                <updated>Sat, 16 Jul 2011 16:16:47 +0100</updated>
                            <resolved>Sat, 16 Jul 2011 16:16:39 +0100</resolved>
                                                    <fixVersion>0.10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13013779" author="eyang" created="Thu, 31 Mar 2011 02:24:55 +0100"  >&lt;p&gt;An alternative is to modify the syntax like:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;STORE result INTO &apos;hbase://foo&apos; USING
 org.apache.pig.backend.hadoop.hbase.HBaseStorage(
 &apos;info:first_name info:last_name&apos;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Eliminate comma from the syntax completely.  It may have some readability issue with this approach.&lt;/p&gt;

&lt;p&gt;Having that said, the problem can be solved in more user friendly manner by improving the parser to filter prefix and suffix of comma, and comma only cases.&lt;/p&gt;

&lt;p&gt;Maybe this issue can be defined more accurately with: &quot;Improve syntax parsing for HBaseStorage constructor&quot;.&lt;/p&gt;</comment>
                            <comment id="13013840" author="billgraham" created="Thu, 31 Mar 2011 06:55:58 +0100"  >&lt;p&gt;Eric, the syntax you show is the current syntax - the tokens are split on space to get the columns. Hence the issue when there are also commas in the mix. In addition to supporting the current syntax of:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&apos;info:first_name info:last_name&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I propose we also support these variations:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&apos;info:first_name info:last_name&apos;
&apos;info:first_name,info:last_name&apos;
&apos;info:first_name, info:last_name&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Only downside is that we wouldn&apos;t be backward compatible with a user who has column names with commas in them. This seems to me like an odd thing to do, but who knows. &lt;/p&gt;

&lt;p&gt;Anyone think we need to support column names with commas in them?&lt;/p&gt;
</comment>
                            <comment id="13013846" author="dvryaboy" created="Thu, 31 Mar 2011 07:04:58 +0100"  >&lt;p&gt;I think this is a good change, the comma thing trips even me up.&lt;br/&gt;
People who put commas in column names get what they deserve &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. Though perhaps we can allow some escaping (sometimes column names are autogenerated).&lt;/p&gt;</comment>
                            <comment id="13026859" author="billgraham" created="Fri, 29 Apr 2011 06:39:18 +0100"  >&lt;p&gt;This patch is ready for review. It allows commas and/or spaces to be used as column delimiters.&lt;/p&gt;</comment>
                            <comment id="13031006" author="dvryaboy" created="Tue, 10 May 2011 05:28:25 +0100"  >&lt;p&gt;Bill, sorry it took me a while to get to this. Looks good, but I just confirmed that commas are valid in column names.. we should add escaping.&lt;/p&gt;</comment>
                            <comment id="13031050" author="billgraham" created="Tue, 10 May 2011 07:36:35 +0100"  >&lt;p&gt;No problem. Dmitriy, have you found the list of valid characters for column descriptors? I feel like I&apos;ve seen it before somewhere but I can&apos;t find it. After a quick test, I can write column descriptor with any character I try so I&apos;m at a loss for a valid escaping scheme.&lt;/p&gt;</comment>
                            <comment id="13031065" author="dvryaboy" created="Tue, 10 May 2011 08:02:59 +0100"  >&lt;p&gt;This is for column families: &lt;a href=&quot;http://hbase.apache.org/xref/org/apache/hadoop/hbase/HColumnDescriptor.html#278&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hbase.apache.org/xref/org/apache/hadoop/hbase/HColumnDescriptor.html#278&lt;/a&gt; &lt;br/&gt;
(no slashes, colons, or ISOControl chars, and no starting with &quot;.&quot;).  I believe columns are similar.&lt;/p&gt;</comment>
                            <comment id="13033148" author="billgraham" created="Fri, 13 May 2011 18:40:21 +0100"  >&lt;p&gt;The column descriptors take anything I can throw at them:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hbase(main):001:0&amp;gt;  create &apos;t1&apos;, {NAME =&amp;gt; &apos;f1&apos;, VERSIONS =&amp;gt; 5}                     
0 row(s) in 0.6400 seconds

hbase(main):002:0&amp;gt; put &apos;t1&apos;, &apos;r1&apos;, &apos;f1:!@#$%)(:+_-=\][{}|;:&quot;&amp;gt;&amp;lt;,./?`~&apos;, &apos;value&apos;     
0 row(s) in 0.0660 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m also able to create column families with both &apos;/&apos; and &apos;\&apos; in them. Any suggestions for a valid encoding scheme?&lt;/p&gt;</comment>
                            <comment id="13044664" author="dvryaboy" created="Mon, 6 Jun 2011 01:40:01 +0100"  >&lt;p&gt;Coming back to this after a long break..&lt;br/&gt;
We can do the standard backslash escaping (with &lt;br class=&quot;atl-forced-newline&quot; /&gt; meaning a real backslash) but that will look horrible in Pig code, where you have to escape each backslash for the parser first.&lt;/p&gt;

&lt;p&gt;Maybe an optional &quot;-literalColumns&quot; flag that makes us revert to space-delimited column names? &lt;/p&gt;

&lt;p&gt;I don&apos;t really see an elegant way out of this right now.&lt;/p&gt;</comment>
                            <comment id="13044690" author="billgraham" created="Mon, 6 Jun 2011 04:29:41 +0100"  >&lt;p&gt;How about we say that commas are the default delimiter (with or without spaces), but this can be overriden with the &quot;-constructorDelimiter&quot; param. That would allow those pesky comma users to specify some other character as their delimiter. Kinda like sed.&lt;/p&gt;</comment>
                            <comment id="13044955" author="eyang" created="Mon, 6 Jun 2011 17:57:02 +0100"  >&lt;p&gt;Take it one step further, what does -constructorDelimiter look like with space delimiter?&lt;/p&gt;</comment>
                            <comment id="13044969" author="billgraham" created="Mon, 6 Jun 2011 18:23:49 +0100"  >&lt;p&gt;I was thinking any combination of comma and space would always be used to delimit by default. If -constructorDelimiter is specified we can either say: a.) same logic but sub comma out for -constructorDelimiter; or b.) Only use -constructorDelimiter as the delimiter in which case spaces would be part of the column descriptor if found.&lt;/p&gt;

&lt;p&gt;I lean towards a.) but if allowing people to use spaces in column names is valid, then we should do b.).&lt;/p&gt;

&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="13044980" author="eyang" created="Mon, 6 Jun 2011 18:50:34 +0100"  >&lt;p&gt;a) should be the sensible thing to do.  b) is unlikely to mix well with rest of pig syntax anyways.&lt;/p&gt;</comment>
                            <comment id="13045126" author="dvryaboy" created="Mon, 6 Jun 2011 22:26:46 +0100"  >&lt;p&gt;Spaces are legal:&lt;/p&gt;


&lt;p&gt;hbase(main):011:0&amp;gt; put &apos;dropme&apos;, &apos;id1&apos;, &apos;columns:foo bar&apos;, &apos;value&apos;&lt;br/&gt;
0 row(s) in 0.0060 seconds&lt;/p&gt;

&lt;p&gt;hbase(main):012:0&amp;gt; scan &apos;dropme&apos;&lt;br/&gt;
ROW                                           COLUMN+CELL                                                                                                                          &lt;br/&gt;
 id1                                          column=columns:foo bar, timestamp=1307395400107, value=value                &lt;/p&gt;

&lt;p&gt;So I think that means 2 flags are needed: -d (delimiter, space by default) and -ignoreTrailingCommas (true by default, turn off to force trailing commas to be treated as part of the column name)&lt;/p&gt;</comment>
                            <comment id="13045217" author="billgraham" created="Tue, 7 Jun 2011 01:05:53 +0100"  >&lt;p&gt;@Dmitriy, the goal of this JIRA is to make the default delimiter any combination of comma and space (not just space), since that&apos;s the way Pig works everywhere else. We can achieve that and provide the ability to go outside of that as needed with just one param (-constructorDelimiter) that overrides this behavior with the field of the users choice. This would be option b.) above.&lt;/p&gt;</comment>
                            <comment id="13045227" author="dvryaboy" created="Tue, 7 Jun 2011 01:47:14 +0100"  >&lt;p&gt;my suggestion would make &quot;foo bar&quot; and &quot;foo, bar&quot; both work by default, though &quot;foo,bar&quot; would not. Given the lax rules governing column naming in HBase I now think that&apos;s acceptable.&lt;/p&gt;

&lt;p&gt;I think it&apos;s confusing to have a -d parameter whose default value of &quot;a comma followed by zero or more spaces, or 1 or more spaces&quot; cannot be supplied as a value in the constructor.&lt;/p&gt;</comment>
                            <comment id="13045782" author="billgraham" created="Wed, 8 Jun 2011 06:02:59 +0100"  >&lt;p&gt;The intent of this JIRA is to allow &quot;foo bar&quot;, &quot;foo, bar&quot; and &quot;foo,bar&quot; all work in the constructor by default, since that&apos;s how the AS clause works and every other list of fields within Pig and, more importantly, that&apos;s how users are currently specifying the params in the constructor. Hence, this is the exact problem I think we should fix.&lt;/p&gt;</comment>
                            <comment id="13046089" author="dvryaboy" created="Wed, 8 Jun 2011 18:19:57 +0100"  >&lt;p&gt;Ok so maybe the semantics should be something like -d specifies the delimiter, and the delimiter can always be surrounded by an arbitrary number of spaces (\s) unless -ignoreWhitespace is set to false.&lt;/p&gt;</comment>
                            <comment id="13046262" author="billgraham" created="Wed, 8 Jun 2011 23:30:00 +0100"  >&lt;p&gt;+1 on that last suggestion, sounds good to me. I&apos;ll work on the patch.&lt;/p&gt;</comment>
                            <comment id="13064954" author="thejas" created="Thu, 14 Jul 2011 00:38:31 +0100"  >&lt;p&gt;Removing the patch-available state as &lt;/p&gt;</comment>
                            <comment id="13064956" author="thejas" created="Thu, 14 Jul 2011 00:39:46 +0100"  >&lt;blockquote&gt;&lt;p&gt;+1 on that last suggestion, sounds good to me. I&apos;ll work on the patch.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Removing the patch-available state as Bill is working on a new patch. &lt;br/&gt;
patch-available state is being used for finding jira&apos;s that are ready for review. &lt;/p&gt;</comment>
                            <comment id="13064971" author="billgraham" created="Thu, 14 Jul 2011 01:16:10 +0100"  >&lt;p&gt;Thanks for changing that state. The patch was reviewed but now I&apos;m working on a new one. I should have something to submit soon. &lt;/p&gt;</comment>
                            <comment id="13065525" author="billgraham" created="Thu, 14 Jul 2011 21:52:00 +0100"  >&lt;p&gt;Attaching a new patch with the changes suggested. I&apos;ve created a new unit test for speed, since the param testing for this bug doesn&apos;t require the mini cluster to be run.&lt;/p&gt;

&lt;p&gt;Also, I named the delimiter field &lt;tt&gt;-delim&lt;/tt&gt; instead of &lt;tt&gt;-d&lt;/tt&gt; since the former is more consistent with existing param naming in {{HBaseStorage}]. Let me know if you disagree.&lt;/p&gt;

&lt;p&gt;FYI, this patch can also be found on git here: &lt;a href=&quot;https://github.com/billonahill/pig/tree/pig_1946&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/billonahill/pig/tree/pig_1946&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13065737" author="dvryaboy" created="Fri, 15 Jul 2011 07:12:10 +0100"  >&lt;p&gt;Looks good. The test passed. The purist in me wants to make you do &quot;true&quot;.equalsIgnoreCase(value) instead of (value == null || !value.equalsIgnoreCase(&quot;true&quot;)), and to pull out the column parsing behavior into its own function.&lt;/p&gt;

&lt;p&gt;You generated the patch from git &amp;#8211; that&apos;s not friendly to the automated patch machinery; you have to use &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;git diff --no-patch&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; to generate legit patches.&lt;/p&gt;

&lt;p&gt;If you have time to make the changes, that would be awesome. If not I will try to fit it in.&lt;/p&gt;

&lt;p&gt;Thanks for the work on this!&lt;/p&gt;</comment>
                            <comment id="13066075" author="billgraham" created="Fri, 15 Jul 2011 18:04:09 +0100"  >&lt;p&gt;All good suggestions, here&apos;s patch #3.&lt;/p&gt;

&lt;p&gt;The &lt;tt&gt;-&lt;del&gt;no-patch&lt;/tt&gt; option doesn&apos;t seem to be valid in git merge. I tried &lt;tt&gt;&lt;/del&gt;-no-prefix&lt;/tt&gt; but the format still looks gitish. Any other suggestions for an SVN-friendly git patch? I&apos;ve made manual changes in the past when applying git patches to SVN, but I&apos;d love to find a way to not require that.&lt;/p&gt;</comment>
                            <comment id="13066442" author="dvryaboy" created="Sat, 16 Jul 2011 16:13:04 +0100"  >&lt;p&gt;I meant &amp;lt;pre&amp;gt;--no-prefix&amp;lt;/pre&amp;gt;.&lt;/p&gt;

&lt;p&gt;+1. Will commit to 0.10.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12477731" name="PIG-1946_1.patch" size="6572" author="billgraham" created="Fri, 29 Apr 2011 06:38:01 +0100"/>
                            <attachment id="12486502" name="PIG-1946_2.patch" size="12004" author="billgraham" created="Thu, 14 Jul 2011 21:52:00 +0100"/>
                            <attachment id="12486643" name="PIG-1946_3.patch" size="13970" author="billgraham" created="Fri, 15 Jul 2011 18:04:09 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 31 Mar 2011 01:24:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>67914</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaunr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97278</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>More friendly HBaseStorage constructor syntax.</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>