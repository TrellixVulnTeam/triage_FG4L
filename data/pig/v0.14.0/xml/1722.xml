<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:56:37 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1722/PIG-1722.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1722] PiggyBank AllLoader - Load multiple file formats in one load statement</title>
                <link>https://issues.apache.org/jira/browse/PIG-1722</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;This gives the ability to point one loader at a directory and have multiple formats loaded and used in the same query&lt;/p&gt;

&lt;p&gt;----- Overview -----&lt;/p&gt;

&lt;p&gt;Lets say we have a directory with files:&lt;br/&gt;
 /logs/myfile.lzo&lt;br/&gt;
 /logs/myfile.rc&lt;br/&gt;
 /logs/myfile.bz2&lt;br/&gt;
 /logs/myfile.gz&lt;/p&gt;

&lt;p&gt;To load these currently requires multiple loaders, load statements in pig and then have the query perform a union on these.&lt;/p&gt;

&lt;p&gt;With this Loader the query becomes:&lt;br/&gt;
a = LOAD &apos;/logs/&apos; USING  org.apache.pig.piggybank.storage.AllLoader();&lt;/p&gt;

&lt;p&gt;The AllLoader will use the mapping property in the $PIG_HOME/conf/pig.properties&lt;/p&gt;

&lt;p&gt;file.extension.loaders that can be setup as:&lt;/p&gt;

&lt;p&gt;file.extension.loaders=gz:org.apache.pig.builtin.PigStorage(),bz2:org.apache.pig.builtin.PigStorage(),lzo:com.twitter.elephantbird.pig.load.LzoTextLoader(), rc:org.apache.pig.piggybank.storage.HiveColumnarLoader()&lt;/p&gt;

&lt;p&gt;The formats of this property is:&lt;/p&gt;

&lt;p&gt;-&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;file extension&amp;#93;&lt;/span&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;loader func spec&amp;#93;&lt;/span&gt;&lt;br/&gt;
-&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;file-extension&amp;#93;&lt;/span&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;optional path tag&amp;#93;&lt;/span&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;loader func spec&amp;#93;&lt;/span&gt;&lt;br/&gt;
-&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;file-extension&amp;#93;&lt;/span&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;optional path tag&amp;#93;&lt;/span&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;sequence file key value writer class name&amp;#93;&lt;/span&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;loader func spec&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;----- File path tagging: -----&lt;/p&gt;

&lt;p&gt;Loaders can also be chosen based on folder names in the file path:&lt;br/&gt;
e.g.&lt;br/&gt;
file.extension.loaders:gz:type1:Type1Loader(), gz:type2:Type2Loader()&lt;/p&gt;

&lt;p&gt;So that if you have /logs/type1/mylog and /logs/type2/mylog&lt;br/&gt;
doing : a = LOAD &apos;/logs/&apos; USING  org.apache.pig.piggybank.storage.AllLoader();  will use Type1Loader for mylog in /logs/type1 and Type2Loader for mylog in /logs/type2&lt;/p&gt;

&lt;p&gt;----- File content guessing: -----&lt;/p&gt;

&lt;p&gt;If the files do not have extensions the AllLoader will try to guess the type of file by looking at the first three bytes mapping the following bytes to each extension:&lt;/p&gt;

&lt;p&gt;[ -119, 76, 90 ] = lzo&lt;br/&gt;
[ 31, -117, 8 ] = gz&lt;br/&gt;
[ 66, 90, 104 ] = bz2&lt;br/&gt;
[ 83, 69, 81 ] = seq&lt;/p&gt;

&lt;p&gt;----- Loader selection based on sequence file writer class -----&lt;/p&gt;

&lt;p&gt;Loaders can be configured to be selected based on the getKeyClassName of the Sequence File.&lt;br/&gt;
e.g. &lt;br/&gt;
file.extension.loaders:seq::org.apache.hadoop.hive.ql.io.RCFile:HiveColumnarLoader &lt;br/&gt;
will use the HiveColumnarLoader loader for all sequence files that have been written with org.apache.hadoop.hive.ql.io.RCFile as the KeyClassName.&lt;/p&gt;

&lt;p&gt;All $ extensions are removed from the getKeyClassName&apos;s return value.&lt;/p&gt;

&lt;p&gt;----- Path Partition Handling -----&lt;/p&gt;

&lt;p&gt;Hive style partitioning is supported in the Loader itself so that if you have /logs/type=1 /logs/type=2 /logs/type=3&lt;br/&gt;
The partition columns will be recougnised as &quot;type&quot; and filtering can be done like type&amp;lt;=2 etc.&lt;/p&gt;

&lt;p&gt;For this current implementation filtering expressions should be passed into the AllLoader&apos;s constructor e.g.&lt;/p&gt;


&lt;p&gt;a = LOAD &apos;/logs/&apos; USING  org.apache.pig.piggybank.storage.AllLoader(&apos;type&amp;lt;=2&apos;); will load only files that are in /logs/type=1 and /logs/type=2&lt;/p&gt;


</description>
                <environment></environment>
        <key id="12479809">PIG-1722</key>
            <summary>PiggyBank AllLoader - Load multiple file formats in one load statement</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gerritjvv">Gerrit Jansen van Vuuren</assignee>
                                    <reporter username="gerritjvv">Gerrit Jansen van Vuuren</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Nov 2010 16:29:48 +0000</created>
                <updated>Thu, 4 Aug 2011 01:34:56 +0100</updated>
                            <resolved>Tue, 16 Nov 2010 18:24:52 +0000</resolved>
                                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12931437" author="gerritjvv" created="Fri, 12 Nov 2010 16:32:21 +0000"  >&lt;p&gt;---- Schema Selection &amp;#8212;&lt;/p&gt;

&lt;p&gt;This Loader uses the JsonMetadata class in piggybank to try and load json schema&apos;s if they are available in the path.  &lt;br/&gt;
If no json schema is available null would be returned by the AllLoader in the getSchema method.&lt;/p&gt;


</comment>
                            <comment id="12931503" author="alangates" created="Fri, 12 Nov 2010 19:25:18 +0000"  >&lt;p&gt;Patch looks good.  Tests pass.  It has good documentation.  One issue is it uses tabs instead of spaces.  I&apos;ve fixed that.  I&apos;ll commit this shortly.&lt;/p&gt;</comment>
                            <comment id="12931515" author="gerritjvv" created="Fri, 12 Nov 2010 20:05:52 +0000"  >&lt;p&gt;Thanks, sorry about the tabs, I did the auto-formatting in eclipse but will check it to do TABS=4spaces &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12932580" author="alangates" created="Tue, 16 Nov 2010 18:24:52 +0000"  >&lt;p&gt;Patch checked in.  Thank you Gerrit for contributing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12459466" name="PIG-1722.patch" size="59133" author="gerritjvv" created="Fri, 12 Nov 2010 17:09:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Nov 2010 19:25:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66207</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyatcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97066</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1722&quot; title=&quot;PiggyBank AllLoader - Load multiple file formats in one load statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1722&quot;&gt;&lt;strike&gt;PIG-1722&lt;/strike&gt;&lt;/a&gt;.patch</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>