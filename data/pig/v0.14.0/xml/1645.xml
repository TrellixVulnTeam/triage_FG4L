<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:09:08 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1645/PIG-1645.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1645] Using both small split combination and temporary file compression on a query of ORDER BY may cause crash</title>
                <link>https://issues.apache.org/jira/browse/PIG-1645</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;The stack looks like the following:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException at java.util.Arrays.binarySearch(Arrays.java:2043) at&lt;br/&gt;
org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.partitioners.WeightedRangePartitioner.getPartition(WeightedRangePartitioner.java:72) at&lt;br/&gt;
org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.partitioners.WeightedRangePartitioner.getPartition(WeightedRangePartitioner.java:52) at &lt;br/&gt;
org.apache.hadoop.mapred.MapTask$NewOutputCollector.write(MapTask.java:565) at&lt;br/&gt;
org.apache.hadoop.mapreduce.TaskInputOutputContext.write(TaskInputOutputContext.java:80) at&lt;br/&gt;
org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapReduce$Map.collect(PigMapReduce.java:116) at&lt;br/&gt;
org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapBase.runPipeline(PigMapBase.java:238) at&lt;br/&gt;
org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapBase.map(PigMapBase.java:231) at&lt;br/&gt;
org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigMapBase.map(PigMapBase.java:53) at&lt;br/&gt;
org.apache.hadoop.mapreduce.Mapper.run(Mapper.java:144) at&lt;br/&gt;
org.apache.hadoop.mapred.MapTask.runNewMapper(MapTask.java:638) at&lt;br/&gt;
org.apache.hadoop.mapred.MapTask.run(MapTask.java:314) at org.apache.hadoop.mapred.Child$4.run(Child.java:217) at&lt;br/&gt;
java.security.AccessController.doPrivileged(Native Method) at javax.security.auth.Subject.doAs(Subject.java:396) at&lt;br/&gt;
org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1062) at&lt;br/&gt;
org.apache.hadoop.mapred.Child.main(Child.java:211) &lt;/p&gt;</description>
                <environment></environment>
        <key id="12474893">PIG-1645</key>
            <summary>Using both small split combination and temporary file compression on a query of ORDER BY may cause crash</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yanz">Yan Zhou</assignee>
                                    <reporter username="yanz">Yan Zhou</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Sep 2010 02:50:10 +0100</created>
                <updated>Fri, 17 Dec 2010 22:46:01 +0000</updated>
                            <resolved>Sat, 25 Sep 2010 04:58:42 +0100</resolved>
                                    <version>0.8.0</version>
                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12914128" author="yanz" created="Thu, 23 Sep 2010 18:56:28 +0100"  >&lt;p&gt;The problem is that both RandomSampleLoader and PossionSampleLoader have internal states from the previous invocations that should be reset when a different underlying split is worked on under the same umbrella split when the split combination (&lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1518&quot; title=&quot;multi file input format for loaders&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1518&quot;&gt;&lt;del&gt;PIG-1518&lt;/del&gt;&lt;/a&gt;) is on.&lt;/p&gt;

&lt;p&gt;When temporary file compression is disabled, Pig internal storage will create empty files which will be discarded by split combiner, making the only non-empty split as the only split to be worked on, so it is ok in this case.&lt;/p&gt;</comment>
                            <comment id="12914510" author="yanz" created="Fri, 24 Sep 2010 17:08:30 +0100"  >&lt;p&gt;test-core passed.&lt;/p&gt;

&lt;p&gt;test-patch results:&lt;/p&gt;

&lt;p&gt;     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt; -1 overall.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 @author.  The patch does not contain any @author tags.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;                         Please justify why no tests are needed for this patch.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;exec&amp;#93;&lt;/span&gt;     -1 release audit.  The applied patch generated 459 release audit warnings (more than the trunk&apos;s current 457 warnings).&lt;/p&gt;

&lt;p&gt;The scenario is trully a corner case. The following query &lt;b&gt;might&lt;/b&gt; have caused the problem:&lt;/p&gt;

&lt;p&gt;A = load &apos;/tmp/test/jsTst2.txt&apos; as (fn, age:int);&lt;br/&gt;
B = load &apos;/tmp/test/sample.txt&apos; as (fn, age:int);&lt;br/&gt;
C = join A by fn, B by fn USING &apos;replicated&apos;;&lt;br/&gt;
D = ORDER C BY B::age;&lt;br/&gt;
dump D;&lt;/p&gt;

&lt;p&gt;where sample.txt has only one row that contains one record that has the same join key as a single record in jsTst2.txt which should have size of several HDFS blocks. Even so, it is random to see a failure, as it depends upon whether any of the logically empty files is placed in the first underlying split of the list of splits combined. Compute nodes&apos; host names seem to play a role too.  Running in local mode seems to see no failure.&lt;/p&gt;

&lt;p&gt;The 2 release audit warnings are due to jdiff. No new file added.&lt;/p&gt;</comment>
                            <comment id="12914541" author="yanz" created="Fri, 24 Sep 2010 18:07:06 +0100"  >&lt;p&gt;The possibility of failure also depends upon the block distribution since the split combination makes use of that info.&lt;/p&gt;</comment>
                            <comment id="12914556" author="thejas" created="Fri, 24 Sep 2010 18:47:55 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12914751" author="yanz" created="Sat, 25 Sep 2010 04:58:42 +0100"  >&lt;p&gt;Patch committed to both trunk and the 0.8 branch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12455500" name="PIG-1645.patch" size="2113" author="yanz" created="Fri, 24 Sep 2010 17:08:30 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 24 Sep 2010 17:47:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>165099</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyasov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>96959</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>