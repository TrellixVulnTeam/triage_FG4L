<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:05:32 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-2910/PIG-2910.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-2910] Add function to read schema from outout of Schema.toString()</title>
                <link>https://issues.apache.org/jira/browse/PIG-2910</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;I want to toString() schemas and send them to the backend via UDFContext. At the moment this requires writing your own toString() method that Utils.getSchemaFromString() can read. Making a readable schema for the backend would be an improvement.&lt;/p&gt;

&lt;p&gt;I spoke with Thejas, who believes this is a bug. The workaround for the moment is, for example:&lt;/p&gt;

&lt;p&gt;String schemaString = inputSchema.toString().substring(1, inputSchema.toString().length() - 1);&lt;/p&gt;

&lt;p&gt;// Set the input schema for processing&lt;br/&gt;
UDFContext context = UDFContext.getUDFContext();&lt;br/&gt;
Properties udfProp = context.getUDFProperties(this.getClass());&lt;/p&gt;

&lt;p&gt;udfProp.setProperty(&quot;horton.json.udf.schema&quot;, schemaString);&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;schema = Utils.getSchemaFromString(strSchema);&lt;/p&gt;</description>
                <environment></environment>
        <key id="12606501">PIG-2910</key>
            <summary>Add function to read schema from outout of Schema.toString()</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="initialcontext">Eli Reisman</assignee>
                                    <reporter username="russell.jurney">Russell Jurney</reporter>
                        <labels>
                            <label>newbie</label>
                    </labels>
                <created>Fri, 7 Sep 2012 00:08:26 +0100</created>
                <updated>Fri, 22 Feb 2013 04:53:49 +0000</updated>
                            <resolved>Sat, 13 Oct 2012 03:19:05 +0100</resolved>
                                    <version>0.9.2</version>
                    <version>0.10.0</version>
                    <version>0.11</version>
                    <version>0.10.1</version>
                                    <fixVersion>0.11</fixVersion>
                                    <component>impl</component>
                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13470602" author="initialcontext" created="Fri, 5 Oct 2012 20:56:03 +0100"  >&lt;p&gt;Would something like this work, or are we talking about composing a new representation of a Schema (not a String) and passing it directly to the back end through some other channel?&lt;/p&gt;</comment>
                            <comment id="13470633" author="russell.jurney" created="Fri, 5 Oct 2012 21:40:08 +0100"  >&lt;p&gt;In looking at the toString code, it looked like a () was added around both bags and tuples - without checking the type. Thejas was able to reproduce and address the problem. It might be better to fix the code at the source of the issue - the toString method but... this works for me. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13471904" author="initialcontext" created="Mon, 8 Oct 2012 22:59:56 +0100"  >&lt;p&gt;I can fix it in the toString() instead. Also, if its OK to publish use of UDFContext into the Schema namespace, I can put the hardcoded properties name String and the context itself inside the method call to keep client code from knowing how this transfer of schema to the Properties is implemented? Sound good? &lt;/p&gt;

&lt;p&gt;I have not sat down and poured over the Pig code yet the way I need to so I can recognize the optimal solution for some of these JIRA&apos;s yet off the top of my head. I was not aware whether removing the outer indication of the TUPLE or BAG container in the toString() would break other code, or just plain confuse people who use toString() on Schemas for their own reasons. Anyway, a serious &quot;Pig study weekend&quot; needs to be next on my list before I get to put up too many more patches!&lt;/p&gt;</comment>
                            <comment id="13472438" author="initialcontext" created="Tue, 9 Oct 2012 15:49:40 +0100"  >&lt;p&gt;This just removes the obligatory &apos;(&apos; and &apos;)&apos; in toString() call, was this more what you had in mind? It passes &apos;ant compile-test&apos;&lt;/p&gt;

&lt;p&gt;I might throw up another version of the first patch too. If this is a common workflow (passing the schema through Properties) it might be nice to have?&lt;/p&gt;</comment>
                            <comment id="13472941" author="thejas" created="Wed, 10 Oct 2012 03:36:48 +0100"  >&lt;p&gt;The extra parenthesis added by Schema.toString() are curly braces. I believe this is because the schema when thought of as a schema of a relation, is a schema of a bag. I don&apos;t think the &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-2910&quot; title=&quot;Add function to read schema from outout of Schema.toString()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-2910&quot;&gt;&lt;del&gt;PIG-2910&lt;/del&gt;&lt;/a&gt;-2.patch will fix the issue.&lt;/p&gt;

&lt;p&gt;But changing the behavior of either Schema.toString() or Utils.getSchemaFromString() will break backward compatibility. I think we should just add a new function Utils.getSchemaFromBagSchemaString() and comment that people should use this one to get schema back from output of Schema.toString(). &lt;/p&gt;

&lt;p&gt;The use of input schema of udf, during udf execution is not very common. I don&apos;t think we should serialize it for all udfs.&lt;/p&gt;</comment>
                            <comment id="13473534" author="initialcontext" created="Wed, 10 Oct 2012 21:32:45 +0100"  >&lt;p&gt;That makes a lot of sense. Is 2910-3 patch a bit more like it then?&lt;/p&gt;</comment>
                            <comment id="13473535" author="thejas" created="Wed, 10 Oct 2012 21:35:42 +0100"  >&lt;p&gt;Yes, The changes in 2910-3 patch look good. Can you please add a test case, and also add a comment that this schema string has &quot;{}&quot; around it, and that is why the substring is being done ?&lt;/p&gt;</comment>
                            <comment id="13473565" author="initialcontext" created="Wed, 10 Oct 2012 22:11:06 +0100"  >&lt;p&gt;sorry wrong button!&lt;/p&gt;</comment>
                            <comment id="13473567" author="initialcontext" created="Wed, 10 Oct 2012 22:12:06 +0100"  >&lt;p&gt;how&apos;s this? while writing a test I found one in TestSchema that seems built for this purpose (see patch) so I modified it. this passes &apos;ant compile-test&apos;&lt;/p&gt;

&lt;p&gt;Thanks for the advice!&lt;/p&gt;</comment>
                            <comment id="13475503" author="thejas" created="Sat, 13 Oct 2012 03:19:05 +0100"  >&lt;p&gt;+1 Patch committed to trunk.&lt;br/&gt;
Eli, Thanks for the patch!&lt;/p&gt;</comment>
                            <comment id="13475797" author="initialcontext" created="Sun, 14 Oct 2012 09:24:29 +0100"  >&lt;p&gt;My pleasure, thank you!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12548030" name="PIG-2910-1.patch" size="2379" author="initialcontext" created="Fri, 5 Oct 2012 20:56:03 +0100"/>
                            <attachment id="12548407" name="PIG-2910-2.patch" size="614" author="initialcontext" created="Tue, 9 Oct 2012 15:49:40 +0100"/>
                            <attachment id="12548626" name="PIG-2910-3.patch" size="1584" author="initialcontext" created="Wed, 10 Oct 2012 21:32:45 +0100"/>
                            <attachment id="12548633" name="PIG-2910-4.patch" size="2550" author="initialcontext" created="Wed, 10 Oct 2012 22:12:06 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Oct 2012 19:56:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>242072</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxwd0n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12596</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>