<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:52:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-814/PIG-814.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-814] Make Binstorage more robust when data contains record markers</title>
                <link>https://issues.apache.org/jira/browse/PIG-814</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;When the inputstream for BinStorage is at a position where the data has the record marker sequence, the code incorrectly assumes that it is at the beginning of a record (tuple) and calls DataReaderWriter.readDatum() trying to read the tuple. The problem is more likely when RandomSampleLoader (used in order by implementation) skips the input stream for sampling and calls Binstorage.getNext(). The code should be more robust in such cases&lt;/p&gt;</description>
                <environment></environment>
        <key id="12426072">PIG-814</key>
            <summary>Make Binstorage more robust when data contains record markers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pkamath">Pradeep Kamath</assignee>
                                    <reporter username="pkamath">Pradeep Kamath</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 May 2009 00:11:48 +0100</created>
                <updated>Wed, 24 Mar 2010 22:11:01 +0000</updated>
                            <resolved>Fri, 22 May 2009 21:30:40 +0100</resolved>
                                    <version>0.3.0</version>
                                    <fixVersion>0.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12712197" author="pkamath" created="Fri, 22 May 2009 19:28:52 +0100"  >&lt;p&gt;The basic issue is that we use ctrl-A,ctrl-B,ctrl-C sequence to identify beginning of a record in binstorage format. We&lt;br/&gt;
keep parsing the inputstream till we see this sequence. After seeing this sequence, we send the input stream to another&lt;br/&gt;
function to read the tuple which represents the record. The tuple itself is stored in Binstorage by first having a byte&lt;br/&gt;
representing the tuple type(tuple marker), followed by the tuple size which is stored as an integer (in java&lt;br/&gt;
serialization format) and then the actual tuple fields each stored in java serialization format with a type marker&lt;br/&gt;
prefix.&lt;/p&gt;

&lt;p&gt;An exception is thrown when the data itself has ctrl-A,ctrl-B,ctrl-C (maybe in the serialized form of a&lt;br/&gt;
field in some tuple). This can happen when the RandomSampleLoader (used in ordre by ) tries to uniformly sample 100 tuples and lands in some&lt;br/&gt;
part of the data which has this sequence but is not a RECORD begin sequence put in by BinStorage.&lt;/p&gt;

&lt;p&gt;The fix will be to look for ctrl-A,ctrl-B,ctrl-c and additionally TUPLEMARKER before trying to read the tuple. This&lt;br/&gt;
decreases the probability of finding all these four markers in the data as well ( and it also fixes the error for this&lt;br/&gt;
particular query).&lt;/p&gt;</comment>
                            <comment id="12712200" author="pkamath" created="Fri, 22 May 2009 19:35:41 +0100"  >&lt;p&gt;The patch also contains a simple fix for enable split by &apos;file&apos; in the load statement - in this case, pig should not try to split the input file by block size, but process the entire file in a map.&lt;/p&gt;</comment>
                            <comment id="12712203" author="olgan" created="Fri, 22 May 2009 19:38:46 +0100"  >&lt;p&gt;+1, please commit&lt;/p&gt;</comment>
                            <comment id="12712234" author="hadoopqa" created="Fri, 22 May 2009 21:10:12 +0100"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12408830/PIG-814.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12408830/PIG-814.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision 777334.&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no tests are needed for this patch.&lt;/p&gt;

&lt;p&gt;    +1 javadoc.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    +1 javac.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    +1 findbugs.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    +1 release audit.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    +1 core tests.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    +1 contrib tests.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/54/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/54/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/54/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/54/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/54/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-Patch-minerva.apache.org/54/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12712241" author="pkamath" created="Fri, 22 May 2009 21:30:40 +0100"  >&lt;p&gt;This patch fixes existing code which is tested in other tests, hence no tests were included.&lt;/p&gt;

&lt;p&gt;Patch committed.&lt;/p&gt;</comment>
                            <comment id="12712410" author="hudson" created="Sat, 23 May 2009 12:40:36 +0100"  >&lt;p&gt;Integrated in Pig-trunk #451 (See &lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Pig-trunk/451/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hudson.zones.apache.org/hudson/job/Pig-trunk/451/&lt;/a&gt;)&lt;br/&gt;
    :Make Binstorage more robust when data contains record markers (pradeepkth)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12408830" name="PIG-814.patch" size="2784" author="pkamath" created="Fri, 22 May 2009 19:22:45 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 22 May 2009 18:38:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164371</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyaj7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>95422</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>