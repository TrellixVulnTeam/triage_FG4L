<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:09:28 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-3367/PIG-3367.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-3367] Add assert keyword (operator) in pig</title>
                <link>https://issues.apache.org/jira/browse/PIG-3367</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Assert operator can be used for data validation. With assert you can write script as following-&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a = load &apos;something&apos; as (a0:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;, a1:&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; a by a0 &amp;gt; 0, &apos;a cant be negative &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; reasons&apos;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This script will fail if assert is violated.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12655062">PIG-3367</key>
            <summary>Add assert keyword (operator) in pig</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="aniket486">Aniket Mokashi</assignee>
                                    <reporter username="aniket486">Aniket Mokashi</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Jun 2013 04:19:05 +0100</created>
                <updated>Sat, 29 Nov 2014 00:23:11 +0000</updated>
                            <resolved>Fri, 20 Sep 2013 17:06:54 +0100</resolved>
                                                    <fixVersion>0.12.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13694446" author="alexlevenson" created="Thu, 27 Jun 2013 04:28:24 +0100"  >&lt;p&gt;I think you should be able to provide a message:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; a by a0 &amp;gt; 0, &apos;a cant be negative &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; reasons&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13694447" author="alexlevenson" created="Thu, 27 Jun 2013 04:28:42 +0100"  >&lt;p&gt;It might even be nice to require a message&lt;/p&gt;</comment>
                            <comment id="13694454" author="aniket486" created="Thu, 27 Jun 2013 04:45:10 +0100"  >&lt;p&gt;Good suggestion! I will add that to the requirement.&lt;/p&gt;</comment>
                            <comment id="13694456" author="aniket486" created="Thu, 27 Jun 2013 04:47:39 +0100"  >&lt;p&gt;We also need to decide if we want to fail fast if assertion fails (Terminate the job instantaneously). However, I am not sure if hadoop/pig has a friendly mechanism to do so.&lt;/p&gt;</comment>
                            <comment id="13694465" author="alexlevenson" created="Thu, 27 Jun 2013 05:02:55 +0100"  >&lt;p&gt;also: adding a keyword means that some scripts will fail (ones that had relations named assert)&lt;br/&gt;
I remember that happening with the &quot;rank&quot; keyword.&lt;/p&gt;

&lt;p&gt;What&apos;s the big win from having this built into the language opposed to as a UDF? &lt;br/&gt;
The potential to fail fast the entire script instead of letting each task fail one by one?&lt;/p&gt;

&lt;p&gt;Could a UDF (especially a new builtin one like this) have the same ability to fail fast the whole script?&lt;/p&gt;</comment>
                            <comment id="13694832" author="julienledem" created="Thu, 27 Jun 2013 17:11:16 +0100"  >&lt;p&gt;I was thinking we could make the syntax part of FOREACH.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;B = FOREACH A GENERATE a, b, c ASSERT a &amp;gt;= 0, b IS NOT NULL;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;That way it is easy to integrate asserts in the flow.&lt;/p&gt;

&lt;p&gt;The advantage of having it part of the language:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the error message can be clear without extra user input.&lt;/li&gt;
	&lt;li&gt;it&apos;s more natural than doing a filter that does not filter. Also if the filter is not in the predecessors of a STORE, it won&apos;t be executed.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;A UDF can stop the job by throwing an exception. Although the task will retry before failing completely.&lt;/p&gt;

&lt;p&gt;For reference, the UDF based syntax:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;FILTER members BY ASSERT( (member_id &amp;gt;= 0 ? 1 : 0), &apos;Doh! Some member ID is negative.&apos; );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yes adding new keywords is inconvenient when the keyword was used for relation or column names.&lt;br/&gt;
When a field collides with a keyword it is sometimes difficult to rename it.&lt;br/&gt;
I think we should:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;try to avoid new keywords if possible&lt;/li&gt;
	&lt;li&gt;provide a mechanism to escape field names to facilitate fixing conflicts when they happen (using quotes or a similar mechanism)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13694950" author="alexlevenson" created="Thu, 27 Jun 2013 19:51:34 +0100"  >&lt;p&gt;Making it part of foreach looks more readable.&lt;br/&gt;
I think there should still be an option for custom error messages.&lt;/p&gt;</comment>
                            <comment id="13695007" author="arahuja" created="Thu, 27 Jun 2013 20:57:03 +0100"  >&lt;p&gt;Isn&apos;t this available with &lt;a href=&quot;http://linkedin.github.io/datafu/docs/javadoc/datafu/pig/util/ASSERT.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://linkedin.github.io/datafu/docs/javadoc/datafu/pig/util/ASSERT.html&lt;/a&gt;, so it this mainly about bringing it into the language?&lt;/p&gt;</comment>
                            <comment id="13695047" author="aniket486" created="Thu, 27 Jun 2013 21:47:02 +0100"  >&lt;p&gt;@&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=arahuja&quot; class=&quot;user-hover&quot; rel=&quot;arahuja&quot;&gt;Arun Ahuja&lt;/a&gt;, correct. We feel that it should be part of the language itself. Very useful indeed.&lt;/p&gt;</comment>
                            <comment id="13695856" author="aniket486" created="Fri, 28 Jun 2013 23:09:22 +0100"  >&lt;blockquote&gt;&lt;p&gt;&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;B = FOREACH A GENERATE a, b, c ASSERT a &amp;gt;= 0, b IS NOT NULL;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think this is a little ambiguous. Does that mean following is a right syntax?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;B = FOREACH A GENERATE a, b, c ASSERT d &amp;gt;= 0;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think assert should be it&apos;s own statement- just like other languages.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;A UDF can stop the job by throwing an exception. Although the task will retry before failing completely.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Do we want to have a mechanism to identify and fast-fail? (It would be hacky, (publish a counter and client kills it etc.) but useful for this case).&lt;/p&gt;</comment>
                            <comment id="13758821" author="aniket486" created="Thu, 5 Sep 2013 07:33:12 +0100"  >&lt;p&gt;I have attached a patch, but it does not have fast-fail mechanism yet. I will open a jira to have a generic framework for fail-fast from a UDF and modify assert to use that later.&lt;/p&gt;</comment>
                            <comment id="13759418" author="aniket486" created="Thu, 5 Sep 2013 21:33:53 +0100"  >&lt;p&gt;I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3452&quot; title=&quot;Framework to fail-fast jobs based on exceptions in UDFs (useful for assert)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3452&quot;&gt;PIG-3452&lt;/a&gt; to add fail-fast mechanism.&lt;/p&gt;</comment>
                            <comment id="13769985" author="julienledem" created="Tue, 17 Sep 2013 22:20:43 +0100"  >&lt;p&gt;Looks good to me.&lt;br/&gt;
Is there a way you can factor out some of the content of buildAssertOp() ? It looks like some of this would be common with other methods.&lt;/p&gt;</comment>
                            <comment id="13770038" author="aniket486" created="Tue, 17 Sep 2013 22:54:40 +0100"  >&lt;p&gt;Incorporated code review comments&lt;/p&gt;</comment>
                            <comment id="13773118" author="aniket486" created="Fri, 20 Sep 2013 17:06:45 +0100"  >&lt;p&gt;Committed to trunk. Thanks Julien for the review!&lt;/p&gt;</comment>
                            <comment id="13778454" author="cheolsoo" created="Thu, 26 Sep 2013 05:21:03 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aniket486&quot; class=&quot;user-hover&quot; rel=&quot;aniket486&quot;&gt;Aniket Mokashi&lt;/a&gt;, would you mind updating the documentation - &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3483&quot; title=&quot;Document ASSERT keyword&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3483&quot;&gt;&lt;del&gt;PIG-3483&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="13779038" author="aniket486" created="Thu, 26 Sep 2013 19:06:42 +0100"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cheolsoo&quot; class=&quot;user-hover&quot; rel=&quot;cheolsoo&quot;&gt;Cheolsoo Park&lt;/a&gt;, I will try to wrap it up today.&lt;/p&gt;</comment>
                            <comment id="13872480" author="daijy" created="Wed, 15 Jan 2014 19:30:32 +0000"  >&lt;p&gt;Seems the syntax:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; a by a0 &amp;gt; 0, &apos;a cant be negative &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; reasons&apos;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;does not work, Grunt parser will complain. We will need to use the following syntax:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
b = &lt;span class=&quot;code-keyword&quot;&gt;assert&lt;/span&gt; a by a0 &amp;gt; 0, &apos;a cant be negative &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; reasons&apos;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is that expected?&lt;/p&gt;</comment>
                            <comment id="14228565" author="russell.jurney" created="Sat, 29 Nov 2014 00:22:10 +0000"  >&lt;p&gt;This JIRA doesn&apos;t work. I don&apos;t think it ever worked. What is up with that?&lt;/p&gt;</comment>
                            <comment id="14228566" author="russell.jurney" created="Sat, 29 Nov 2014 00:23:11 +0000"  >&lt;p&gt;To answer my own question, see &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-3670&quot; title=&quot;Fix assert in Pig script&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-3670&quot;&gt;&lt;del&gt;PIG-3670&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12670631">PIG-3483</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12603688" name="PIG-3367-2.patch" size="10735" author="aniket486" created="Tue, 17 Sep 2013 22:54:40 +0100"/>
                            <attachment id="12601568" name="PIG-3367.patch" size="12710" author="aniket486" created="Thu, 5 Sep 2013 07:29:59 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Jun 2013 03:28:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>335339</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzforb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>335663</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>