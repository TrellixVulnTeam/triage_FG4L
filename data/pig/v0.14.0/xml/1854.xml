<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 04:57:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/PIG-1854/PIG-1854.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[PIG-1854] Pig returns exit code 0 for the failed Pig script .</title>
                <link>https://issues.apache.org/jira/browse/PIG-1854</link>
                <project id="12310730" key="PIG">Pig</project>
                    <description>&lt;p&gt;Pig returns exit code 0 for the some of the failed Pig scripts. Due to this workflow system like Oozie showing the &quot;succeeded&quot; status instead of &quot;killed&quot; status.&lt;/p&gt;

&lt;p&gt;Illustrative example&lt;br/&gt;
---------------------&lt;/p&gt;

&lt;p&gt;Suppose in Pig script we have following statement:&lt;/p&gt;

&lt;p&gt;$ cat move.pig&lt;br/&gt;
fs -mv /user/jerry/a.txt /user/tom/&lt;/p&gt;

&lt;p&gt;On executing the pig script, script failed with following exception&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;tom@abc &amp;#93;&lt;/span&gt;$ pig move.pig &lt;br/&gt;
2011-02-14 06:48:08,354 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  org.apache.pig.Main - Logging error messages to: /home/tom/pig_1297666088350.log&lt;br/&gt;
2011-02-14 06:48:08,652 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine - Connecting to hadoop file system at: hdfs://abc-nn:8020&lt;br/&gt;
2011-02-14 06:48:09,542 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine - Connecting to map-reduce job tracker at: abc-jt:50300&lt;br/&gt;
mv: org.apache.hadoop.security.AccessControlException: Permission denied: user=tom, access=WRITE, inode=&quot;jobs&quot;:jerry:users:rwxr-xr-x&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;tom@abc &amp;#93;&lt;/span&gt;$&lt;/p&gt;


&lt;p&gt;But when executed the similar Pig script through Oozie workflow, Pig script failed but Oozie show the &quot;succeeded&quot; status message instead of &quot;killed&quot; status as return exit code is 0.&lt;/p&gt;

&lt;p&gt;From logs of workflow launcher job:&lt;/p&gt;

&lt;p&gt;stdout logs&lt;br/&gt;
-----------&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; Invoking Pig command line now &amp;gt;&amp;gt;&amp;gt;&lt;/p&gt;

&lt;p&gt;Apache Pig version 0.7.0.20.100.1.1007220309 (r966485) &lt;br/&gt;
compiled Jul 22 2010, 03:09:21&lt;/p&gt;

&lt;p&gt;807  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to hadoop file system at: hdfs://abc-nn:8020/&lt;br/&gt;
853  &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine  - Connecting to map-reduce job tracker at: abc-jt:50300&lt;/p&gt;

&lt;p&gt;&amp;lt;&amp;lt;&amp;lt; Invocation of Pig command completed &amp;lt;&amp;lt;&amp;lt;&lt;/p&gt;

&lt;p&gt; Hadoop Job IDs executed by Pig: &lt;/p&gt;

&lt;p&gt;&amp;lt;&amp;lt;&amp;lt; Invocation of Main class completed &amp;lt;&amp;lt;&amp;lt;&lt;/p&gt;


&lt;p&gt;Oozie Launcher, capturing output data:&lt;br/&gt;
=======================&lt;br/&gt;
#&lt;br/&gt;
#Mon Feb 14 06:46:00 UTC 2011&lt;br/&gt;
hadoopJobs=&lt;/p&gt;

&lt;p&gt;=======================&lt;/p&gt;

&lt;p&gt;Oozie Launcher ends&lt;/p&gt;


&lt;p&gt;stderr logs&lt;br/&gt;
-----------&lt;br/&gt;
mv: org.apache.hadoop.security.AccessControlException: Permission denied: user=tom, access=WRITE, inode=&quot;jobs&quot;:jerry:users:rwxr-xr-x&lt;/p&gt;


&lt;p&gt;One more scenario where Pig script failed but exit code is 0 and no exception occurred for this failure.&lt;/p&gt;


&lt;p&gt;stdout logs&lt;br/&gt;
-----------&lt;br/&gt;
&amp;gt;&amp;gt;&amp;gt; Invoking Pig command line now &amp;gt;&amp;gt;&amp;gt;&lt;/p&gt;


&lt;p&gt;Apache Pig version 0.7.0.20.100.1.1007220309 (r966485) &lt;br/&gt;
compiled Jul 22 2010, 03:09:21&lt;br/&gt;
...&lt;br/&gt;
...&lt;br/&gt;
48247 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher  - 100% complete&lt;br/&gt;
48248 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher  - 1 map reduce job(s) failed!&lt;br/&gt;
48306 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; ERROR org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher  - Failed to produce result in: &quot;hdfs://abc-nn/user/jerry/feature-keys&quot;&lt;br/&gt;
48307 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher  - Failed!&lt;/p&gt;

&lt;p&gt;&amp;lt;&amp;lt;&amp;lt; Invocation of Pig command completed &amp;lt;&amp;lt;&amp;lt;&lt;/p&gt;

&lt;p&gt; Hadoop Job IDs executed by Pig: job_201102080811_28852&lt;/p&gt;

&lt;p&gt;&amp;lt;&amp;lt;&amp;lt; Invocation of Main class completed &amp;lt;&amp;lt;&amp;lt;&lt;/p&gt;

&lt;p&gt;Oozie Launcher, capturing output data:&lt;br/&gt;
=======================&lt;br/&gt;
#&lt;br/&gt;
#Sat Feb 12 04:13:53 UTC 2011&lt;br/&gt;
hadoopJobs=job_201102080811_28852&lt;/p&gt;

&lt;p&gt;=======================&lt;/p&gt;

&lt;p&gt;Oozie Launcher ends&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12498509">PIG-1854</key>
            <summary>Pig returns exit code 0 for the failed Pig script .</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rding">Richard Ding</assignee>
                                    <reporter username="peeyushb">Peeyush Bishnoi</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Feb 2011 09:03:15 +0000</created>
                <updated>Mon, 25 Apr 2011 22:27:05 +0100</updated>
                            <resolved>Fri, 18 Feb 2011 22:08:37 +0000</resolved>
                                    <version>0.7.0</version>
                    <version>0.8.0</version>
                                    <fixVersion>0.8.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12994580" author="rding" created="Tue, 15 Feb 2011 00:10:03 +0000"  >&lt;p&gt;The problem is that Pig doesn&apos;t check the return code while calling method FsShell.run. This works fine in interactive mode since the error message is written to the stdout. The fix checks the return code and throws an IOException in batch mode.&lt;/p&gt;</comment>
                            <comment id="12994585" author="olgan" created="Tue, 15 Feb 2011 00:18:19 +0000"  >&lt;p&gt;changes look good. One question - are we guaranteed -1 return from FSShell for all errors or should we be testing for non-0 return instead?&lt;/p&gt;</comment>
                            <comment id="12994597" author="rding" created="Tue, 15 Feb 2011 00:44:18 +0000"  >&lt;p&gt;You&apos;re right. Change the checking of return code from -1 to none-zero.&lt;/p&gt;</comment>
                            <comment id="12994607" author="olgan" created="Tue, 15 Feb 2011 01:11:54 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12994921" author="rding" created="Tue, 15 Feb 2011 18:34:05 +0000"  >&lt;p&gt;patch committed to both trunk and 0.8 branch.&lt;/p&gt;</comment>
                            <comment id="12996603" author="rding" created="Fri, 18 Feb 2011 21:45:57 +0000"  >&lt;p&gt;Here is another case: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
a = load &apos;nonexisting.file&apos;;
b = filter a by $0 &amp;gt; 0;
c = group b by $0;
d = join c by $0, b by $0;
store d into &apos;output&apos;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The script fails due to non-existing input file, but the return code is 0.&lt;/p&gt;</comment>
                            <comment id="12996605" author="olgan" created="Fri, 18 Feb 2011 21:54:57 +0000"  >&lt;p&gt;Unless this two issues are related, lets use a separate JIRA to track.&lt;/p&gt;</comment>
                            <comment id="12996612" author="rding" created="Fri, 18 Feb 2011 22:08:37 +0000"  >&lt;p&gt;Opened &lt;a href=&quot;https://issues.apache.org/jira/browse/PIG-1862&quot; title=&quot;Pig returns exit code 0 for the failed Pig script due to non-existing input directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;PIG-1862&quot;&gt;&lt;del&gt;PIG-1862&lt;/del&gt;&lt;/a&gt; to trunk the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12471045" name="PIG-1854.patch" size="3509" author="rding" created="Tue, 15 Feb 2011 00:44:18 +0000"/>
                            <attachment id="12471039" name="PIG-1854.patch" size="3510" author="rding" created="Tue, 15 Feb 2011 00:10:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 Feb 2011 00:10:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>165218</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyau4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>97193</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>