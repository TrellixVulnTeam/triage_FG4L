<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:29:10 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-186/BOOKKEEPER-186.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-186] Bookkeeper throttling - permits is not released when read has failed from all replicas</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-186</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;Permit is not releasing in the case when there is no quorum available and the readEntries operation failed from all replicas.&lt;/p&gt;

&lt;p&gt;Following is the condition where it checks the failure in quorum and invoking ReadCallback:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;void sendRead(ArrayList&amp;lt;InetSocketAddress&amp;gt; ensemble, LedgerEntry entry, int lastErrorCode) {
   if (entry.nextReplicaIndexToReadFrom &amp;gt;= lh.metadata.quorumSize) {
      // we are done, the read has failed from all replicas, just fail the
      // read
      submitCallback(lastErrorCode);
      return;
   }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12546760">BOOKKEEPER-186</key>
            <summary>Bookkeeper throttling - permits is not released when read has failed from all replicas</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rakeshr">Rakesh R</assignee>
                                    <reporter username="rakeshr">Rakesh R</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Mar 2012 10:49:48 +0000</created>
                <updated>Mon, 22 Oct 2012 15:50:15 +0100</updated>
                            <resolved>Mon, 19 Mar 2012 14:46:04 +0000</resolved>
                                    <version>4.0.0</version>
                                    <fixVersion>4.1.0</fixVersion>
                                    <component>bookkeeper-client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13231050" author="rakeshr" created="Fri, 16 Mar 2012 10:52:22 +0000"  >&lt;p&gt;&lt;ins&gt;Suggestion:&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;Since permits is acquired for each entries, we couldn&apos;t keep the release logic inside submitCallback. IMO, it would be fine to place &apos;lh.opCounterSem.release();&apos; before submitCallback(lastErrorCode); &lt;/p&gt;</comment>
                            <comment id="13231261" author="rakeshr" created="Fri, 16 Mar 2012 14:54:16 +0000"  >&lt;p&gt;I have attached the trunk patch with few test cases. Please be so kind to review and commit the fix.&lt;/p&gt;</comment>
                            <comment id="13232003" author="hustlmsp" created="Sat, 17 Mar 2012 16:32:34 +0000"  >&lt;p&gt;well spotted. the patch is also good.&lt;/p&gt;

&lt;p&gt;just some comments:&lt;br/&gt;
1) it would be better to add apache license at the header of newly added file.&lt;br/&gt;
2) why use &apos;Test&apos;? is null OK?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
lh.asyncReadEntries(0, throttle-1, bookieReadCallback, &lt;span class=&quot;code-quote&quot;&gt;&quot;Test&quot;&lt;/span&gt;); 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13232169" author="rakeshr" created="Sun, 18 Mar 2012 05:02:00 +0000"  >&lt;p&gt;Resubmitting the patch with apache license. Null is ok, I just given a name for testing.&lt;/p&gt;</comment>
                            <comment id="13232203" author="rakeshr" created="Sun, 18 Mar 2012 07:16:02 +0000"  >&lt;p&gt;Oh ok!...I will upload the patch tmrw with apache license at the header of newly added file.&lt;/p&gt;</comment>
                            <comment id="13232533" author="rakeshr" created="Mon, 19 Mar 2012 10:04:14 +0000"  >&lt;p&gt;@Sijie.&lt;br/&gt;
Uploaded latest patch with the comments fixed.&lt;/p&gt;</comment>
                            <comment id="13232572" author="ikelly" created="Mon, 19 Mar 2012 11:46:35 +0000"  >&lt;p&gt;lgtm +1&lt;/p&gt;</comment>
                            <comment id="13232613" author="hustlmsp" created="Mon, 19 Mar 2012 13:43:17 +0000"  >&lt;p&gt;+1. will commit it later.&lt;/p&gt;</comment>
                            <comment id="13232620" author="hustlmsp" created="Mon, 19 Mar 2012 14:03:12 +0000"  >&lt;p&gt;committed as r1302458. thanks, Rakesh.&lt;/p&gt;</comment>
                            <comment id="13232645" author="hudson" created="Mon, 19 Mar 2012 14:46:14 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk #418 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/418/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/418/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-186&quot; title=&quot;Bookkeeper throttling - permits is not released when read has failed from all replicas&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-186&quot;&gt;&lt;del&gt;BOOKKEEPER-186&lt;/del&gt;&lt;/a&gt;: Bookkeeper throttling - permits is not released when read has failed from all replicas (Rakesh R via sijie) (Revision 1302458)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
sijie : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/BookieThrottleTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13233180" author="rakeshr" created="Tue, 20 Mar 2012 04:10:47 +0000"  >&lt;p&gt;Thanks Sijie. Presently the state of Assignee is &apos;Unassigned&apos;. Could you please assign it to me&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13233217" author="hustlmsp" created="Tue, 20 Mar 2012 05:14:43 +0000"  >&lt;p&gt;actually, when I resolved the issue, I tried to assign it to you, but I could not find your name in the list, I had no idea why? &lt;/p&gt;</comment>
                            <comment id="13233219" author="hustlmsp" created="Tue, 20 Mar 2012 05:20:08 +0000"  >&lt;p&gt;maybe you can assign it to yourself &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13233281" author="fpj" created="Tue, 20 Mar 2012 07:20:08 +0000"  >&lt;p&gt;Done.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12518880" name="BOOKKEEPER-186_trunk-1.patch" size="5981" author="rakeshr" created="Mon, 19 Mar 2012 10:04:14 +0000"/>
                            <attachment id="12518821" name="BOOKKEEPER-186_trunk.patch" size="5179" author="rakeshr" created="Sun, 18 Mar 2012 05:01:53 +0000"/>
                            <attachment id="12518677" name="BOOKKEEPER-186_trunk.patch" size="5179" author="rakeshr" created="Fri, 16 Mar 2012 14:52:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 17 Mar 2012 16:32:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>231918</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4s5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61717</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>