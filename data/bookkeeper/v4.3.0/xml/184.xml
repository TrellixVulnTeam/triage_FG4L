<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:29:09 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-184/BOOKKEEPER-184.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-184] CompactionTest failing on Jenkins</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-184</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;the compaction test hanging on Jenkins. &lt;/p&gt;

&lt;p&gt;Ivan did some investigation on this issue, and found that it wasn&apos;t hanging, it was just taking a really long time. He suggested that it is because it does a lot of I/O, theres a couple of ways we could reduce this.&lt;br/&gt;
1. Only create 1 bookie&lt;br/&gt;
2. Not inherit from BaseTestCase&lt;br/&gt;
3. Reduce the number of entries&lt;/p&gt;</description>
                <environment></environment>
        <key id="12546194">BOOKKEEPER-184</key>
            <summary>CompactionTest failing on Jenkins</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ikelly">Ivan Kelly</assignee>
                                    <reporter username="hustlmsp">Sijie Guo</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Mar 2012 07:21:18 +0000</created>
                <updated>Mon, 22 Oct 2012 15:50:15 +0100</updated>
                            <resolved>Thu, 15 Mar 2012 09:44:36 +0000</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                                    <component>bookkeeper-server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13228267" author="jiraposter@reviews.apache.org" created="Tue, 13 Mar 2012 08:13:36 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/4304/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/4304/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for bookkeeper.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;he compaction test hanging on Jenkins.&lt;/p&gt;

&lt;p&gt;Ivan did some investigation on this issue, and found that it wasn&apos;t hanging, it was just taking a really long time. He suggested that it is because it does a lot of I/O, theres a couple of ways we could reduce this.&lt;br/&gt;
1. Only create 1 bookie&lt;br/&gt;
2. Not inherit from BaseTestCase&lt;br/&gt;
3. Reduce the number of entries&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-184&quot; title=&quot;CompactionTest failing on Jenkins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-184&quot;&gt;&lt;del&gt;BOOKKEEPER-184&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-184&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/BOOKKEEPER-184&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/CompactionTest.java 34dcc74 &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestReadTimeout.java 8da000e &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/HierarchicalLedgerDeleteTest.java 6fd1c5c &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/LedgerLayoutTest.java 8235ce5 &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/TestLedgerManager.java 099eb7c &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BaseTestCase.java 0fe5aba &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java PRE-CREATION &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookieJournalRollingTest.java 17f5da2 &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookieZKExpireTest.java ee5d24e &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/IndexCorruptionTest.java 5dcb964 &lt;br/&gt;
  bookkeeper-server/src/test/java/org/apache/bookkeeper/test/LedgerDeleteTest.java 5364fdd &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/4304/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/4304/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Sijie&lt;/p&gt;
</comment>
                            <comment id="13228269" author="hustlmsp" created="Tue, 13 Mar 2012 08:16:03 +0000"  >&lt;p&gt;attach a patch according to Ivan&apos;s suggestion.&lt;/p&gt;

&lt;p&gt;1) move bookkeeper related code into BookKeeperClusterTestCase, which don&apos;t need to run multiple time for different digestType. BaseTestCase inherits BookKeeperClusterTestCase, which is used to test digestType related cases.&lt;/p&gt;

&lt;p&gt;2) reduce num of bookies to 1 in CompactionTest&lt;/p&gt;

&lt;p&gt;3) reduce number of entries to 100 in CompactionTest&lt;/p&gt;</comment>
                            <comment id="13228324" author="ikelly" created="Tue, 13 Mar 2012 11:24:04 +0000"  >&lt;p&gt;Did you figure out why the test cases were not failing? Before this change, the disabling of compaction in #testDisableCompaction had no affect. However, the test still passed happily, which indicates that the test wasn&apos;t correct.&lt;/p&gt;</comment>
                            <comment id="13228342" author="hustlmsp" created="Tue, 13 Mar 2012 11:57:18 +0000"  >&lt;p&gt;the disabling of compaction did work before this change, which use #restartBookies()&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// before restartBookies
&lt;/span&gt;2012-03-13 19:43:05,553 - INFO  - [main:GarbageCollectorThread@169] - Minor Compaction : enabled=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, threshold=0.10000000149011612, interval=2000
2012-03-13 19:43:05,553 - INFO  - [main:GarbageCollectorThread@171] - Major Compaction : enabled=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, threshold=0.5, interval=4000

&lt;span class=&quot;code-comment&quot;&gt;// after restartBookies
&lt;/span&gt;2012-03-13 19:43:35,123 - INFO  - [main:GarbageCollectorThread@169] - Minor Compaction : enabled=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, threshold=0.0, interval=2000
2012-03-13 19:43:35,123 - INFO  - [main:GarbageCollectorThread@171] - Major Compaction : enabled=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, threshold=0.0, interval=4000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;because ServerConfiguration is a CompositeConfiguration. A CompositeConfiguration object contains a list of other configuration objects. When properties are accessed from a composite configuration the object takes the passed in property key and iterates over the list of the contained configurations. So when we changed baseConf, the changes would be took placed thru CompositeConfiguration.&lt;/p&gt;

&lt;p&gt;This change use #restartBookies(baseConf), which just make code more clearly. it is same as #restartBookies()&lt;/p&gt;
</comment>
                            <comment id="13230024" author="ikelly" created="Thu, 15 Mar 2012 09:44:36 +0000"  >&lt;p&gt;Committed as 1300862. Thanks Sijie.&lt;/p&gt;</comment>
                            <comment id="13230036" author="hudson" created="Thu, 15 Mar 2012 10:16:22 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk #410 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/410/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/410/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-184&quot; title=&quot;CompactionTest failing on Jenkins&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-184&quot;&gt;&lt;del&gt;BOOKKEEPER-184&lt;/del&gt;&lt;/a&gt;: CompactionTest failing on Jenkins (sijie via ivank) (Revision 1300862)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/CompactionTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestReadTimeout.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/HierarchicalLedgerDeleteTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/LedgerLayoutTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/TestLedgerManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BaseTestCase.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookKeeperClusterTestCase.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookieJournalRollingTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookieZKExpireTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/IndexCorruptionTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/LedgerDeleteTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13230087" author="ikelly" created="Thu, 15 Mar 2012 11:42:26 +0000"  >&lt;p&gt;Regarding the test working before the change, I had read the logs wrong. It was working fine &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, just slow&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12518159" name="BK-184.diff" size="32401" author="hustlmsp" created="Tue, 13 Mar 2012 08:16:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Mar 2012 08:13:36 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>231352</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4s67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61720</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>