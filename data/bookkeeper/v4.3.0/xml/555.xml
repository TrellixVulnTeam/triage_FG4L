<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:27:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-555/BOOKKEEPER-555.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-555] Make BookieServer use Netty rather than a custom IO server</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-555</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;Move from the custom NIO server to netty. This will make it easier to do things like add more server side threads and support SSL.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12629097">BOOKKEEPER-555</key>
            <summary>Make BookieServer use Netty rather than a custom IO server</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12634161">BOOKKEEPER-575</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ikelly">Ivan Kelly</assignee>
                                    <reporter username="ikelly">Ivan Kelly</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Jan 2013 16:49:32 +0000</created>
                <updated>Thu, 2 May 2013 03:30:00 +0100</updated>
                            <resolved>Tue, 12 Feb 2013 10:17:39 +0000</resolved>
                                                    <fixVersion>4.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13561776" author="ikelly" created="Thu, 24 Jan 2013 17:19:47 +0000"  >&lt;p&gt;First cut at the patch. I need to get tests back up to 100% and run some benchmarks to ensure performance isn&apos;t taking a hit.&lt;/p&gt;</comment>
                            <comment id="13565637" author="ikelly" created="Tue, 29 Jan 2013 18:45:23 +0000"  >&lt;p&gt;Patch is code complete, and should be passing all tests 100%. I have yet to benchmark.&lt;/p&gt;</comment>
                            <comment id="13565647" author="hadoopqa" created="Tue, 29 Jan 2013 18:54:28 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-555&quot; title=&quot;Make BookieServer use Netty rather than a custom IO server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-555&quot;&gt;&lt;del&gt;BOOKKEEPER-555&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12567022/0002-BOOKKEEPER-555-Netty-Server-for-Bookie.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;0002-BOOKKEEPER-555-Netty-Server-for-Bookie.patch&lt;/a&gt; downloaded at Tue Jan 29 18:50:40 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; patch does not compile&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 2 new Findbugs warning(s) in module(s) &lt;span class=&quot;error&quot;&gt;&amp;#91;bookkeeper-server&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt; - patch does not compile, cannot run testcases&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; distro tarball fails with the patch&lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/257/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/257/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13567540" author="ikelly" created="Thu, 31 Jan 2013 11:05:51 +0000"  >&lt;p&gt;I&apos;ve benchmarked a single bookie with and without the netty server, using bookkeeper-benchmark/bin/benchmark bookie. I ran each 5 times.&lt;/p&gt;

&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Throughput &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Stddev &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Latency &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Stddev &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; netty    &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 22988.4     &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 1656.9  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 1.5      &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 0.1     &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; no netty &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 20785.6     &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 1220.4  &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 1.5      &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 0.1     &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;So netty even gives a slight improvement. Therefore, I think this change it ready to go. &lt;/p&gt;

&lt;p&gt;The precommit failure is due to the fact that &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-556&quot; title=&quot;BookieServerMXBean#getServerState makes no sense&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-556&quot;&gt;&lt;del&gt;BOOKKEEPER-556&lt;/del&gt;&lt;/a&gt; is required. I&apos;ll kick it off again once &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-556&quot; title=&quot;BookieServerMXBean#getServerState makes no sense&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-556&quot;&gt;&lt;del&gt;BOOKKEEPER-556&lt;/del&gt;&lt;/a&gt; is in.&lt;/p&gt;</comment>
                            <comment id="13568255" author="fpj" created="Thu, 31 Jan 2013 23:54:36 +0000"  >&lt;p&gt;+1, it looks great, Ivan. It also only worked after applying &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-556&quot; title=&quot;BookieServerMXBean#getServerState makes no sense&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-556&quot;&gt;&lt;del&gt;BOOKKEEPER-556&lt;/del&gt;&lt;/a&gt;, it would be good to commit them both together.&lt;/p&gt;

&lt;p&gt;If no one else expresses a concern with this patch, I&apos;ll commit it along with &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-556&quot; title=&quot;BookieServerMXBean#getServerState makes no sense&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-556&quot;&gt;&lt;del&gt;BOOKKEEPER-556&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13568319" author="hustlmsp" created="Fri, 1 Feb 2013 01:00:16 +0000"  >&lt;p&gt;I haven&apos;t go through the details on this patch. but just one comment about ChannelGroup. There is a known race condition when shutdown a channel group and adding a opened channel into channel group. if a channel added after closed, ChannelGroup doesn&apos;t take the responsibility of closing it. Then netty would hang. This issue would exist in Hedwig server too, but it is fine for Hedwig server, since there is no shutdown hook. But it might be bad for bookie server, since there is a shutdown hook. A bookie might hang on shutting down. It would better to extend DefaultChannelGroup to provide a cleanup feature, like CleanupChannelMap in hedwig client.&lt;/p&gt;

&lt;p&gt;similar solution in async-http-client: &lt;a href=&quot;http://asynchttpclient.github.com/async-http-client/apidocs/com/ning/http/util/CleanupChannelGroup.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://asynchttpclient.github.com/async-http-client/apidocs/com/ning/http/util/CleanupChannelGroup.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13571555" author="ikelly" created="Tue, 5 Feb 2013 18:32:59 +0000"  >&lt;p&gt;Added cleanup channel group.&lt;/p&gt;</comment>
                            <comment id="13571570" author="hadoopqa" created="Tue, 5 Feb 2013 18:45:33 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-555&quot; title=&quot;Make BookieServer use Netty rather than a custom IO server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-555&quot;&gt;&lt;del&gt;BOOKKEEPER-555&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12568048/0002-BOOKKEEPER-555-Netty-Server-for-Bookie.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;0002-BOOKKEEPER-555-Netty-Server-for-Bookie.patch&lt;/a&gt; downloaded at Tue Feb  5 18:41:32 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; patch does not compile&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 3 new Findbugs warning(s) in module(s) &lt;span class=&quot;error&quot;&gt;&amp;#91;bookkeeper-server&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt; - patch does not compile, cannot run testcases&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; distro tarball fails with the patch&lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/260/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/260/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13572304" author="ikelly" created="Wed, 6 Feb 2013 10:03:09 +0000"  >&lt;p&gt;Build failed because &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-556&quot; title=&quot;BookieServerMXBean#getServerState makes no sense&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-556&quot;&gt;&lt;del&gt;BOOKKEEPER-556&lt;/del&gt;&lt;/a&gt; is not in&lt;/p&gt;</comment>
                            <comment id="13575113" author="hustlmsp" created="Sat, 9 Feb 2013 08:19:56 +0000"  >&lt;p&gt;lgtm +1. will retrigger the commit job. after that, will commit it.&lt;/p&gt;</comment>
                            <comment id="13575114" author="hustlmsp" created="Sat, 9 Feb 2013 08:20:22 +0000"  >&lt;p&gt;re-trigger the commit job.&lt;/p&gt;</comment>
                            <comment id="13575264" author="hustlmsp" created="Sat, 9 Feb 2013 20:59:02 +0000"  >&lt;p&gt;seems that the patch has some conflicts, rebase to latest trunk. and trigger the pre commit job.&lt;/p&gt;</comment>
                            <comment id="13575295" author="hadoopqa" created="Sat, 9 Feb 2013 22:51:24 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-555&quot; title=&quot;Make BookieServer use Netty rather than a custom IO server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-555&quot;&gt;&lt;del&gt;BOOKKEEPER-555&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12568716/BOOKKEEPER-555.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-555.patch&lt;/a&gt; downloaded at Sat Feb  9 22:21:10 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 1 new Findbugs warning(s) in module(s) &lt;span class=&quot;error&quot;&gt;&amp;#91;bookkeeper-server&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 815&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/263/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/263/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13575350" author="hustlmsp" created="Sun, 10 Feb 2013 06:06:15 +0000"  >&lt;p&gt;cancel the patch until findbug error is addressed.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ikelly&quot; class=&quot;user-hover&quot; rel=&quot;ikelly&quot;&gt;Ivan Kelly&lt;/a&gt; seems the findbug error is from CleanupChannelGroup. it warns that &apos;doesn&apos;t override equals&apos;. but I am not sure we need to override this method, since we don&apos;t modify the class too much.&lt;/p&gt;</comment>
                            <comment id="13575352" author="rakeshr" created="Sun, 10 Feb 2013 06:11:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;-1 the patch seems to introduce 1 new Findbugs warning(s) in module(s) &lt;span class=&quot;error&quot;&gt;&amp;#91;bookkeeper-server&amp;#93;&lt;/span&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I think equals overriding will not cause any issues, its giving warning as CleanupChannelGroup has new field &apos;closed&apos; defined.&lt;/p&gt;

&lt;p&gt;Hi Ivan/Sijie, Sorry to pitch in late as I got free time today only. &lt;br/&gt;
By the way netty impl looks very nice. Just have few suggestions, could you please go through. As there is no functional problems, feel free riasing another jira to fix valid comments and go ahead with committing the current patch.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@ChannelPipelineCoverage annotation has been deprecated&lt;br/&gt;
and use the alternative @Sharable annotation&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Creates a new group with the specified name in CleanupChannelGroup like, rather than using the generated name.&lt;br/&gt;
DefaultChannelGroup()
{
   super(&quot;bookieServerCnxns&quot;);
}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I feel BookieRequestHandler can override channelDisconnected, channelConnected and do logging, will make debug much easier in  fluctuating env.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Haven&apos;t seen the following var is used anywhere in BookieRequestHandler, please remove.&lt;br/&gt;
private final ServerConfiguration conf;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&apos;boolean success = false;&apos; in BookieRequestHandler is not required and please remove it, as read logic is using &apos;errorCode == BookieProtocol.EOK&apos; to differentiate success/failure.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;please organize imports for the classes:&lt;br/&gt;
BookieNettyServer, BookieServer, BookieServerBean&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13575748" author="ikelly" created="Mon, 11 Feb 2013 12:04:42 +0000"  >&lt;p&gt;New patch addresses Rakesh&apos;s comments except for the import thing. What do you mean by organise? Alphabetize?&lt;/p&gt;</comment>
                            <comment id="13575765" author="hadoopqa" created="Mon, 11 Feb 2013 12:41:32 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-555&quot; title=&quot;Make BookieServer use Netty rather than a custom IO server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-555&quot;&gt;&lt;del&gt;BOOKKEEPER-555&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12568814/0001-BOOKKEEPER-555-Netty-Server-for-Bookie.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;0001-BOOKKEEPER-555-Netty-Server-for-Bookie.patch&lt;/a&gt; downloaded at Mon Feb 11 12:11:12 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 815&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/264/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/264/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13575781" author="rakeshr" created="Mon, 11 Feb 2013 13:29:47 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ivank%40yahoo-inc.com&quot; class=&quot;user-hover&quot; rel=&quot;ivank@yahoo-inc.com&quot;&gt;Ivan Kelly&lt;/a&gt; for the patch.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;What do you mean by organise? Alphabetize?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Unused imports exists in these classes(BookieNettyServer, BookieServer, BookieServerBean), just wants to clear it&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13575815" author="ikelly" created="Mon, 11 Feb 2013 14:43:04 +0000"  >&lt;p&gt;Ah, had completely missed those. Fixed now.&lt;/p&gt;</comment>
                            <comment id="13575832" author="hadoopqa" created="Mon, 11 Feb 2013 15:21:41 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-555&quot; title=&quot;Make BookieServer use Netty rather than a custom IO server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-555&quot;&gt;&lt;del&gt;BOOKKEEPER-555&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12568824/0001-BOOKKEEPER-555-Netty-Server-for-Bookie.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;0001-BOOKKEEPER-555-Netty-Server-for-Bookie.patch&lt;/a&gt; downloaded at Mon Feb 11 14:51:12 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 815&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/266/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/266/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13576362" author="rakeshr" created="Tue, 12 Feb 2013 04:18:09 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ikelly&quot; class=&quot;user-hover&quot; rel=&quot;ikelly&quot;&gt;Ivan Kelly&lt;/a&gt;, latest patch looks nice. Apart from the following point, the patch is ready to go in +1.&lt;/p&gt;

&lt;p&gt;Just one clarification, latest patch BookieRequestHandler is not having @Sharable annotation. In my previous comment I mentioned to replace the @ChannelPipelineCoverage(which is deprecated) with @Sharable. Am I missing anything?&lt;/p&gt;</comment>
                            <comment id="13576494" author="ikelly" created="Tue, 12 Feb 2013 09:42:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;Rakesh R&lt;/a&gt; Re: @Sharable, you should put @Sharable on a ChannelHandler if more than one pipeline is going to use that ChannelHandler. Current we create a new handler per pipeline, and this doesn&apos;t seem to cause any performance issues. We could however share the ChannelHandler (and the decoder/encoder) as none of these actually old any state. However, I&apos;d like to do that in a future JIRA and push this one in now, as there are a couple of things waiting on this.&lt;/p&gt;

&lt;p&gt;Therefore, since I have a +1, I&apos;m going to push in.&lt;/p&gt;</comment>
                            <comment id="13576519" author="ikelly" created="Tue, 12 Feb 2013 10:17:39 +0000"  >&lt;p&gt;Committed r1445085. Thanks for reviewing guys.&lt;/p&gt;</comment>
                            <comment id="13576543" author="hudson" created="Tue, 12 Feb 2013 11:00:10 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk #99 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/99/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/99/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-555&quot; title=&quot;Make BookieServer use Netty rather than a custom IO server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-555&quot;&gt;&lt;del&gt;BOOKKEEPER-555&lt;/del&gt;&lt;/a&gt;: Make BookieServer use Netty rather than a custom IO server (ivank) (Revision 1445085)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtoEncoding.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtocol.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestHandler.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServerBean.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/NIOServerFactory.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ResponseBuilder.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/BookieInitializationTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookieZKExpireTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/NIOServerFactoryTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12629098">BOOKKEEPER-556</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12568824" name="0001-BOOKKEEPER-555-Netty-Server-for-Bookie.patch" size="79972" author="ikelly" created="Mon, 11 Feb 2013 14:43:04 +0000"/>
                            <attachment id="12568814" name="0001-BOOKKEEPER-555-Netty-Server-for-Bookie.patch" size="78537" author="ikelly" created="Mon, 11 Feb 2013 12:04:42 +0000"/>
                            <attachment id="12568048" name="0002-BOOKKEEPER-555-Netty-Server-for-Bookie.patch" size="77765" author="ikelly" created="Tue, 5 Feb 2013 18:32:58 +0000"/>
                            <attachment id="12567022" name="0002-BOOKKEEPER-555-Netty-Server-for-Bookie.patch" size="77181" author="ikelly" created="Tue, 29 Jan 2013 18:45:23 +0000"/>
                            <attachment id="12566330" name="0002-BOOKKEEPER-555-Netty-Server-for-Bookie.patch" size="75464" author="ikelly" created="Thu, 24 Jan 2013 17:19:47 +0000"/>
                            <attachment id="12568716" name="BOOKKEEPER-555.patch" size="75334" author="hustlmsp" created="Sat, 9 Feb 2013 20:59:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 29 Jan 2013 18:54:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>308872</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hz7h4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>287746</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>