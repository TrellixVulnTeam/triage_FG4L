<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:33:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-156/BOOKKEEPER-156.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-156] BookieJournalRollingTest failing </title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-156</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;The test fails for me intermittently. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12540288">BOOKKEEPER-156</key>
            <summary>BookieJournalRollingTest failing </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ikelly">Ivan Kelly</assignee>
                                    <reporter username="fpj">Flavio Junqueira</reporter>
                        <labels>
                    </labels>
                <created>Sun, 29 Jan 2012 10:40:45 +0000</created>
                <updated>Mon, 22 Oct 2012 15:50:16 +0100</updated>
                            <resolved>Wed, 8 Feb 2012 10:41:41 +0000</resolved>
                                    <version>4.0.0</version>
                                    <fixVersion>4.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13195729" author="fpj" created="Sun, 29 Jan 2012 11:02:15 +0000"  >&lt;p&gt;I haven&apos;t turned on logging, so I only have the exception thrown for now:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-------------------------------------------------------------------------------
Test set: org.apache.bookkeeper.test.BookieJournalRollingTest
-------------------------------------------------------------------------------
Tests run: 4, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 46.702 sec &amp;lt;&amp;lt;&amp;lt; FAILURE!
testJournalRollingWithoutSyncup[0](org.apache.bookkeeper.test.BookieJournalRollingTest)  Time elapsed: 1.887 sec  &amp;lt;&amp;lt;&amp;lt; ERROR!
org.apache.bookkeeper.client.BKException$ZKException
        at org.apache.bookkeeper.client.BKException.create(BKException.java:64)
        at org.apache.bookkeeper.client.BookKeeper.createLedger(BookKeeper.java:293)
        at org.apache.bookkeeper.client.BookKeeper.createLedger(BookKeeper.java:260)
        at org.apache.bookkeeper.test.BookieJournalRollingTest.writeLedgerEntries(BookieJournalRollingTest.java:79)
        at org.apache.bookkeeper.test.BookieJournalRollingTest.testJournalRollingWithoutSyncup(BookieJournalRollingTest.java:206)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The creation of the ledger is failing, but this is not giving the exact error code. I&apos;ll run it again with logging on to see if we can get the error code. I suspect that it could be because the bookie servers have not started (restartBookies call) by the time we try to create the ledger in that test. &lt;/p&gt;
</comment>
                            <comment id="13197829" author="fpj" created="Wed, 1 Feb 2012 13:29:17 +0000"  >&lt;p&gt;Adding log output for a run that failed.&lt;/p&gt;</comment>
                            <comment id="13197875" author="hustlmsp" created="Wed, 1 Feb 2012 14:41:56 +0000"  >&lt;p&gt;hmm, it seems that 3 bookie are up but bkc can&apos;t read enough bookies.&lt;/p&gt;

&lt;p&gt;in BaseTestCase#startNewBookie, it waits until the bookie znode is available. but it didn&apos;t in BaseTestCase#restartBookies.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void startNewBookie(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; port)
            &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, InterruptedException, KeeperException {
        File f = File.createTempFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;bookie&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;);
        tmpDirs.add(f);
        f.delete();
        f.mkdir();

        ServerConfiguration conf = newServerConfiguration(port, HOSTPORT, f, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File[] { f }); 

        BookieServer server = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BookieServer(conf);
        server.start();
        bs.add(server);

        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;(bkc.getZkHandle().exists(&lt;span class=&quot;code-quote&quot;&gt;&quot;/ledgers/available/&quot;&lt;/span&gt; + InetAddress.getLocalHost().getHostAddress() + &lt;span class=&quot;code-quote&quot;&gt;&quot;:&quot;&lt;/span&gt; + port,    &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;) == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(500);
        }   

        bkc.readBookiesBlocking();
        LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;New bookie on port &quot;&lt;/span&gt; + port + &lt;span class=&quot;code-quote&quot;&gt;&quot; has been created.&quot;&lt;/span&gt;);
    } 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;change #restartBookies to use #startNewBookie may resolve this issue.&lt;/p&gt;</comment>
                            <comment id="13197910" author="fpj" created="Wed, 1 Feb 2012 15:39:11 +0000"  >&lt;p&gt;I&apos;m not sure if this a problem anymore. I ran it in a computer with little memory and apparently it caused the same problem in other tests as well. After killing some apps and getting memory back, I can&apos;t reproduce the problem. But, if we should be using #startNewBookie instead, then I suggest we make the change. What do you think?&lt;/p&gt;</comment>
                            <comment id="13198500" author="hustlmsp" created="Thu, 2 Feb 2012 03:00:40 +0000"  >&lt;p&gt;I agree to make the change which make the test more robust. &lt;/p&gt;

&lt;p&gt;Attach a patch of this change.&lt;/p&gt;</comment>
                            <comment id="13203457" author="ikelly" created="Wed, 8 Feb 2012 10:41:41 +0000"  >&lt;p&gt;Committed as 1241855&lt;/p&gt;</comment>
                            <comment id="13203486" author="hudson" created="Wed, 8 Feb 2012 11:22:20 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk #349 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/349/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/349/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-156&quot; title=&quot;BookieJournalRollingTest failing &quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-156&quot;&gt;&lt;del&gt;BOOKKEEPER-156&lt;/del&gt;&lt;/a&gt;: BookieJournalRollingTest failing (Sijie Guo via ivank)&lt;/p&gt;

&lt;p&gt;ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BaseTestCase.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12512906" name="BK-156.diff" size="2978" author="hustlmsp" created="Thu, 2 Feb 2012 03:00:40 +0000"/>
                            <attachment id="12512752" name="org.apache.bookkeeper.test.BookieJournalRollingTest-output.txt" size="135975" author="fpj" created="Wed, 1 Feb 2012 13:29:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 1 Feb 2012 14:41:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>225701</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4s4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61713</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>