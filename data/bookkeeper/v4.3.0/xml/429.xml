<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:32:25 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-429/BOOKKEEPER-429.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-429] Provide separate read and write threads in the bookkeeper server</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-429</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;The current bookkeeper server is single threaded. The same thread handles reads and writes. When reads are slow (possibly because of excessive seeks), add entry operations suffer in terms of latencies. Providing separate read and write threads helps in reducing add entry latencies and increasing throughput even when we&apos;re facing slow reads. Having a single read thread also results in low disk utilization because seeks can&apos;t be ordered efficiently by the OS. Multiple read threads would help in improving the read throughput. &lt;/p&gt;

&lt;p&gt;Discussion on this can be found at &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/zookeeper-bookkeeper-dev/201209.mbox/%3cCAOLhyDQpzn-v10zyNFwUd_h0qzRxtmJgTTx7a9eoFoHYytyJbA@mail.gmail.com%3e&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/zookeeper-bookkeeper-dev/201209.mbox/%3cCAOLhyDQpzn-v10zyNFwUd_h0qzRxtmJgTTx7a9eoFoHYytyJbA@mail.gmail.com%3e&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Reviewboard : &lt;a href=&quot;https://reviews.apache.org/r/7560/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/7560/&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611303">BOOKKEEPER-429</key>
            <summary>Provide separate read and write threads in the bookkeeper server</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="i0exception">Aniruddha</assignee>
                                    <reporter username="i0exception">Aniruddha</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Oct 2012 08:27:58 +0100</created>
                <updated>Tue, 21 Jan 2014 04:28:15 +0000</updated>
                            <resolved>Tue, 21 Jan 2014 04:05:37 +0000</resolved>
                                    <version>4.2.0</version>
                                    <fixVersion>4.3.0</fixVersion>
                                    <component>bookkeeper-server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13476838" author="hustlmsp" created="Tue, 16 Oct 2012 08:57:48 +0100"  >&lt;p&gt;Update my comments in review board. Please check.&lt;/p&gt;</comment>
                            <comment id="13484788" author="hustlmsp" created="Fri, 26 Oct 2012 09:34:47 +0100"  >&lt;p&gt;Cancel it until a new patch is attached.&lt;/p&gt;</comment>
                            <comment id="13701409" author="hustlmsp" created="Sat, 6 Jul 2013 21:54:43 +0100"  >&lt;p&gt;there are two parts in this patch, one is improve concurrency of bookie implementation, while the other part is separating read and write threads. created &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-643&quot; title=&quot;Improve concurrency of entry logger&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-643&quot;&gt;&lt;del&gt;BOOKKEEPER-643&lt;/del&gt;&lt;/a&gt; to handle the improvement to make this patch simpler to focus on separating read and write threads.&lt;/p&gt;</comment>
                            <comment id="13701411" author="hustlmsp" created="Sat, 6 Jul 2013 22:05:08 +0100"  >&lt;p&gt;rebased &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=i0exception&quot; class=&quot;user-hover&quot; rel=&quot;i0exception&quot;&gt;Aniruddha&lt;/a&gt;&apos;s patch. The new patch focuses on separating write threads from read threads. since the trunk code uses netty in bookie server, so introduce a requestprocessor interface to align with the PacketProcessor in previous patch. &lt;/p&gt;</comment>
                            <comment id="13701418" author="hadoopqa" created="Sat, 6 Jul 2013 22:37:20 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-429&quot; title=&quot;Provide separate read and write threads in the bookkeeper server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-429&quot;&gt;&lt;del&gt;BOOKKEEPER-429&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12591091/BOOKKEEPER-429.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-429.diff&lt;/a&gt; downloaded at Sat Jul  6 21:11:21 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 1 new RAT warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 856&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/409/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/409/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13713738" author="ikelly" created="Fri, 19 Jul 2013 15:58:15 +0100"  >&lt;p&gt;Patch looks good. There&apos;s a few things that need to be fixed before submission though.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;MultipleThreadReadTest.java needs a license, it should probably be in the proto package as it&apos;s testing functionality there.&lt;/li&gt;
	&lt;li&gt;RequestProcessor.java should be in proto package also. It deals with RPC stuff.&lt;/li&gt;
	&lt;li&gt;The executors should be created with a thread factory so that the worker threads have meaningful names.&lt;/li&gt;
	&lt;li&gt;I don&apos;t think we should allow 0 worker threads to be configured. It only exists for one test. It&apos;d be better to fix the test.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Sorry for taking so long to get to these. I&apos;ve had a very busy couple of weeks.&lt;/p&gt;</comment>
                            <comment id="13719279" author="hustlmsp" created="Thu, 25 Jul 2013 07:12:04 +0100"  >&lt;p&gt;&amp;gt;&amp;gt; MultipleThreadReadTest.java needs a license, it should probably be in the proto package as it&apos;s testing functionality there.&lt;/p&gt;

&lt;p&gt;I think it is an overall functionality not just protocol. if you feels strongly about it, I could move. just let me know.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; RequestProcessor.java should be in proto package also. It deals with RPC stuff.&lt;/p&gt;

&lt;p&gt;in future, it could be used to support chained request processor, to support like authentication handling. so I put the interface in a processor package to make it clean. I don&apos;t want to make proto too fat.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; I don&apos;t think we should allow 0 worker threads to be configured. It only exists for one test. It&apos;d be better to fix the test.&lt;/p&gt;

&lt;p&gt;user could configure write thread to 0 which leverage netty threads to handle writes and configure read threads to a sensible number, so read would not block writes. so we don&apos;t have to spawn too much threads.&lt;/p&gt;

&lt;p&gt;the test problem could be addressed in a different ticket. &lt;/p&gt;

&lt;p&gt;I will address comment 3).&lt;/p&gt;</comment>
                            <comment id="13720430" author="hustlmsp" created="Fri, 26 Jul 2013 06:46:25 +0100"  >&lt;p&gt;addressed comment 3).&lt;/p&gt;</comment>
                            <comment id="13720480" author="hadoopqa" created="Fri, 26 Jul 2013 08:06:42 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-429&quot; title=&quot;Provide separate read and write threads in the bookkeeper server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-429&quot;&gt;&lt;del&gt;BOOKKEEPER-429&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12594331/BOOKKEEPER-429.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-429.diff&lt;/a&gt; downloaded at Fri Jul 26 06:40:17 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 1 new RAT warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 863&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/440/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/440/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13809276" author="ikelly" created="Wed, 30 Oct 2013 16:11:23 +0000"  >&lt;p&gt;rebased to trunk. It shows some test regressions.&lt;/p&gt;</comment>
                            <comment id="13809305" author="hadoopqa" created="Wed, 30 Oct 2013 16:39:50 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-429&quot; title=&quot;Provide separate read and write threads in the bookkeeper server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-429&quot;&gt;&lt;del&gt;BOOKKEEPER-429&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12611103/0001-BOOKKEEPER-429-Provide-separate-read-and-write-threa.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;0001-BOOKKEEPER-429-Provide-separate-read-and-write-threa.patch&lt;/a&gt; downloaded at Wed Oct 30 16:12:19 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 886&lt;br/&gt;
.    Tests failed: 0&lt;br/&gt;
.    Tests errors: 3&lt;/p&gt;

&lt;p&gt;.    The patch failed the following testcases:&lt;/p&gt;

&lt;p&gt;.      &lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/526/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/526/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13809900" author="rakeshr" created="Thu, 31 Oct 2013 04:08:35 +0000"  >&lt;p&gt;Failure reason:- In the patch, its defined the number of worker threads to zero. While creating threadpool by Journal, it passes this configured value to the threadpool executor and is causing the exception. Is there any specific reason to set the configuration as zero.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; SlowBookieTest() {
         &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(4);
+        baseConf.setNumAddWorkerThreads(0);
+        baseConf.setNumReadWorkerThreads(0);
     }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thread pool expects a non-zero +ve number. Otw will throw exception as follows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ThreadPoolExecutor.java
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (corePoolSize &amp;lt; 0 ||
            maximumPoolSize &amp;lt;= 0 ||
            maximumPoolSize &amp;lt; corePoolSize ||
            keepAliveTime &amp;lt; 0)
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13809959" author="hustlmsp" created="Thu, 31 Oct 2013 05:53:47 +0000"  >&lt;p&gt;did you see the real exception thrown by this? if not, please check the patch first as it doesn&apos;t create thread pool executor with 0 worker threads.&lt;/p&gt;</comment>
                            <comment id="13809996" author="rakeshr" created="Thu, 31 Oct 2013 07:22:53 +0000"  >&lt;p&gt;Please find the below trace which I&apos;ve seen from the jenkins report.&lt;br/&gt;
&lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/526/testReport/junit/org.apache.bookkeeper.client/SlowBookieTest/testSlowBookie/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/526/testReport/junit/org.apache.bookkeeper.client/SlowBookieTest/testSlowBookie/&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.IllegalArgumentException
	at java.util.concurrent.ThreadPoolExecutor.&amp;lt;init&amp;gt;(ThreadPoolExecutor.java:589)
	at java.util.concurrent.ThreadPoolExecutor.&amp;lt;init&amp;gt;(ThreadPoolExecutor.java:514)
	at java.util.concurrent.Executors.newFixedThreadPool(Executors.java:84)
	at org.apache.bookkeeper.bookie.Journal.&amp;lt;init&amp;gt;(Journal.java:493)
	at org.apache.bookkeeper.bookie.Bookie.&amp;lt;init&amp;gt;(Bookie.java:422)
	at org.apache.bookkeeper.proto.BookieServer.newBookie(BookieServer.java:87)
	at org.apache.bookkeeper.proto.BookieServer.&amp;lt;init&amp;gt;(BookieServer.java:76)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13810002" author="hustlmsp" created="Thu, 31 Oct 2013 07:41:39 +0000"  >&lt;p&gt;ok, this doesn&apos;t exist in my patch, only existed after Ivan rebased the patch, as this comes from Journal&apos;s change. will revisit this after then when I had time.&lt;/p&gt;</comment>
                            <comment id="13810296" author="ikelly" created="Thu, 31 Oct 2013 14:31:58 +0000"  >&lt;p&gt;ya, I saw the NUM_ADD_WORKER_THREADS already existed when rebasing. I assumed it was like this in the twitter branch. Never occurred this was the problem when the failure happened, and I didn&apos;t have time to look deeper. Journal and dispatcher threads should use separate pools though, so one of these options should be renamed.&lt;/p&gt;</comment>
                            <comment id="13818234" author="hustlmsp" created="Sat, 9 Nov 2013 18:45:03 +0000"  >&lt;p&gt;attached a new patch to provide a setting for num journal callback threads.&lt;/p&gt;</comment>
                            <comment id="13818255" author="hadoopqa" created="Sat, 9 Nov 2013 19:59:45 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-429&quot; title=&quot;Provide separate read and write threads in the bookkeeper server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-429&quot;&gt;&lt;del&gt;BOOKKEEPER-429&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12613000/BOOKKEEPER-429.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-429.diff&lt;/a&gt; downloaded at Sat Nov  9 19:31:41 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 1 new RAT warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 886&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/530/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/530/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13875106" author="ikelly" created="Fri, 17 Jan 2014 19:02:19 +0000"  >&lt;p&gt;Rebased and added apache license to MultipleThreadReadTest.&lt;/p&gt;

&lt;p&gt;This patch looks ready to go, so +1 from me. Merge it when you&apos;ve glanced over the rebase. There&apos;s no real change. It only needed a rebase because of shuffled imports, which highlights why they shouldn&apos;t be shuffled unnecessarily, no matter how ugly they are.&lt;/p&gt;</comment>
                            <comment id="13875221" author="hadoopqa" created="Fri, 17 Jan 2014 20:12:28 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-429&quot; title=&quot;Provide separate read and write threads in the bookkeeper server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-429&quot;&gt;&lt;del&gt;BOOKKEEPER-429&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12623708/0001-BOOKKEEPER-429-Provide-separate-read-and-write-threa.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;0001-BOOKKEEPER-429-Provide-separate-read-and-write-threa.patch&lt;/a&gt; downloaded at Fri Jan 17 19:44:00 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 891&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/559/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/559/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13877165" author="hustlmsp" created="Tue, 21 Jan 2014 04:05:37 +0000"  >&lt;p&gt;+1 for the new patch.&lt;/p&gt;

&lt;p&gt;committed as r1559917. thanks Aniriuddha for the patch, Ivan for reviewing this.&lt;/p&gt;</comment>
                            <comment id="13877174" author="hudson" created="Tue, 21 Jan 2014 04:28:15 +0000"  >&lt;p&gt;FAILURE: Integrated in bookkeeper-trunk #516 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/516/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/516/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-429&quot; title=&quot;Provide separate read and write threads in the bookkeeper server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-429&quot;&gt;&lt;del&gt;BOOKKEEPER-429&lt;/del&gt;&lt;/a&gt;: Provide separate read and write threads in the bookkeeper server (Aniruddha via sijie) (sijie: rev 1559917)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/processor&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/processor/RequestProcessor.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestHandler.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestProcessor.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/SlowBookieTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookieReadWriteTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/MultipleThreadReadTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12656497">BOOKKEEPER-643</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12623708" name="0001-BOOKKEEPER-429-Provide-separate-read-and-write-threa.patch" size="53061" author="ikelly" created="Fri, 17 Jan 2014 19:02:19 +0000"/>
                            <attachment id="12611103" name="0001-BOOKKEEPER-429-Provide-separate-read-and-write-threa.patch" size="54007" author="ikelly" created="Wed, 30 Oct 2013 16:11:23 +0000"/>
                            <attachment id="12548822" name="BK-429.patch" size="111619" author="i0exception" created="Fri, 12 Oct 2012 00:24:51 +0100"/>
                            <attachment id="12613000" name="BOOKKEEPER-429.diff" size="53691" author="hustlmsp" created="Sat, 9 Nov 2013 18:45:03 +0000"/>
                            <attachment id="12594331" name="BOOKKEEPER-429.diff" size="51473" author="hustlmsp" created="Fri, 26 Jul 2013 06:46:25 +0100"/>
                            <attachment id="12591091" name="BOOKKEEPER-429.diff" size="51114" author="hustlmsp" created="Sat, 6 Jul 2013 22:05:08 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Oct 2012 07:57:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247276</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy243z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>46149</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>