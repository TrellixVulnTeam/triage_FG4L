<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:32:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-428/BOOKKEEPER-428.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-428] Expose command options in bookie scripts to disable/enable auto recovery temporarily</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-428</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;Administrators can invoke disable/enable autorecovery options through bookie shell.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12611112">BOOKKEEPER-428</key>
            <summary>Expose command options in bookie scripts to disable/enable auto recovery temporarily</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12553925">BOOKKEEPER-237</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rakeshr">Rakesh R</assignee>
                                    <reporter username="rakeshr">Rakesh R</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Oct 2012 04:08:09 +0100</created>
                <updated>Thu, 2 May 2013 03:29:58 +0100</updated>
                            <resolved>Fri, 14 Dec 2012 19:27:48 +0000</resolved>
                                    <version>4.0.0</version>
                                    <fixVersion>4.2.0</fixVersion>
                                    <component>bookkeeper-auto-recovery</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13472957" author="rakeshr" created="Wed, 10 Oct 2012 04:09:43 +0100"  >&lt;p&gt;The idea is to do necessary changes in AutoRecoveryMain interface to invoke ZkLedgerUnderreplicationManager.disableLedgerReplication() and ZkLedgerUnderreplicationManager.enableLedgerReplication().&lt;/p&gt;

&lt;p&gt;Also expose command options &apos;enable, disable&apos; in bookie scripts: bookkeeper, /bookkeeper-daemon.sh&lt;/p&gt;
</comment>
                            <comment id="13473082" author="vinayrpet" created="Wed, 10 Oct 2012 09:14:49 +0100"  >&lt;p&gt;Hi Rakesh,&lt;/p&gt;

&lt;p&gt;I got that You want to implement Bookie Shell command to disable auto-recovery to be disabled.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;You are expecting shell command to stop auto recovery in only local node..? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt; If this is the case, you can directly stop the auto recovery daemon. Right?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;or you want to stop recovery service in all nodes by just one command..?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt; I agree, In this case need some changes in AutoRecoveryMain. May be we can create some znode in zookeeper and based on that we can decide whether to enable/disable the service.&lt;/p&gt;</comment>
                            <comment id="13473950" author="rakeshr" created="Thu, 11 Oct 2012 09:25:21 +0100"  >&lt;p&gt;@Vinay, &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I agree, In this case need some changes in AutoRecoveryMain. May be we can create some znode in zookeeper and based on that we can decide whether to enable/disable the service.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, the same is already implemented as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-278&quot; title=&quot;Ability to disable auto recovery temporarily&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-278&quot;&gt;&lt;del&gt;BOOKKEEPER-278&lt;/del&gt;&lt;/a&gt;, please have a look at it. Here just exposing admin command to operate on.&lt;/p&gt;</comment>
                            <comment id="13483492" author="rakeshr" created="Wed, 24 Oct 2012 20:15:31 +0100"  >&lt;p&gt;Attached patch, which has the following command options for toggling autorecovery. Could you please review. Thanks&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 -d,--disable      Disable auto recovery of underreplicated ledgers
 -e,--enable       Enable auto recovery of underreplicated ledgers
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13484184" author="umamaheswararao" created="Thu, 25 Oct 2012 16:15:47 +0100"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  zk = ZkUtils.createConnectedZookeeperClient(
                    conf.getZkServers(), conf.getZkTimeout());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;seems like, We have to re-base the patch to reflect newly modified Zkutils API (changed as part of BK-424).&lt;/p&gt;</comment>
                            <comment id="13484349" author="rakeshr" created="Thu, 25 Oct 2012 19:26:03 +0100"  >&lt;p&gt;Thanks Uma. Latest patch addressing Uma&apos;s comment.&lt;/p&gt;</comment>
                            <comment id="13486646" author="umamaheswararao" created="Tue, 30 Oct 2012 04:55:53 +0000"  >&lt;p&gt;Hi Rakesh,&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Currently we missed options to document anywhere as a help message.&lt;/li&gt;
	&lt;li&gt;Actually I feel that the shell interactions can go to BookieShell class and provide an AutoRecEndisableCmd in that.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;add them to the map:&lt;/p&gt;
 &lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 commands.put(CMD_METAFORMAT, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MetaFormatCmd());
        commands.put(CMD_BOOKIEFORMAT, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BookieFormatCmd());
        commands.put(CMD_RECOVER, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RecoverCmd());
        commands.put(CMD_LEDGER, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LedgerCmd());
        commands.put(CMD_READLOG, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ReadLogCmd());
        commands.put(CMD_READJOURNAL, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ReadJournalCmd());
        commands.put(CMD_LASTMARK, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LastMarkCmd());
        commands.put(CMD_HELP, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HelpCmd());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;on handling #2 my first comment will be covered as part of it as it has separate HelpCmd exposed via shell.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I also feel that, we can have a test that should check there are no further replications proceeding after disabling it. That test would be a functional test to ensure end-end.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks,&lt;br/&gt;
Uma&lt;/p&gt;</comment>
                            <comment id="13487148" author="ikelly" created="Tue, 30 Oct 2012 19:26:22 +0000"  >&lt;p&gt;+1 for adding it to bookie shell&lt;/p&gt;</comment>
                            <comment id="13532395" author="ikelly" created="Fri, 14 Dec 2012 15:41:31 +0000"  >&lt;p&gt;Hey guys, I&apos;ve moved the command into BookieShell. I&apos;ll update &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-375&quot; title=&quot;Document about Auto replication service in BK&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-375&quot;&gt;&lt;del&gt;BOOKKEEPER-375&lt;/del&gt;&lt;/a&gt; also.&lt;/p&gt;</comment>
                            <comment id="13532442" author="umamaheswararao" created="Fri, 14 Dec 2012 16:43:26 +0000"  >&lt;p&gt;Thanks Ivan for the patch update. I have just reviewed the change. Looks good to me. +1&lt;/p&gt;

&lt;p&gt;pending jenkins result.&lt;/p&gt;</comment>
                            <comment id="13532552" author="hadoopqa" created="Fri, 14 Dec 2012 18:53:50 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-428&quot; title=&quot;Expose command options in bookie scripts to disable/enable auto recovery temporarily&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-428&quot;&gt;&lt;del&gt;BOOKKEEPER-428&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12560985/0001-BOOKKEEPER-428-Expose-command-options-in-bookie-scri.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;0001-BOOKKEEPER-428-Expose-command-options-in-bookie-scri.patch&lt;/a&gt; downloaded at Fri Dec 14 18:32:37 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 499&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/122/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/122/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13532570" author="fpj" created="Fri, 14 Dec 2012 19:27:48 +0000"  >&lt;p&gt;+1, Thanks, Rakesh, Ivan. Committed revision 1422054.&lt;/p&gt;</comment>
                            <comment id="13532572" author="fpj" created="Fri, 14 Dec 2012 19:30:09 +0000"  >&lt;p&gt;Forgot to add Rakesh as the main author of this patch to CHANGES.txt. Committed revision 1422056.&lt;/p&gt;</comment>
                            <comment id="13532629" author="hudson" created="Fri, 14 Dec 2012 20:21:33 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk #864 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/864/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/864/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-428&quot; title=&quot;Expose command options in bookie scripts to disable/enable auto recovery temporarily&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-428&quot;&gt;&lt;del&gt;BOOKKEEPER-428&lt;/del&gt;&lt;/a&gt;: Expose command options in bookie scripts to disable/enable auto recovery temporarily (rakesh, ivank via fpj) (Revision 1422056)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-428&quot; title=&quot;Expose command options in bookie scripts to disable/enable auto recovery temporarily&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-428&quot;&gt;&lt;del&gt;BOOKKEEPER-428&lt;/del&gt;&lt;/a&gt;: Expose command options in bookie scripts to disable/enable auto recovery temporarily (ivank via fpj) (Revision 1422054)&lt;/p&gt;

&lt;p&gt;     Result = UNSTABLE&lt;br/&gt;
fpj : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;fpj : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/replication/AuditorLedgerCheckerTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12604372">BOOKKEEPER-375</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12560985" name="0001-BOOKKEEPER-428-Expose-command-options-in-bookie-scri.patch" size="11374" author="ikelly" created="Fri, 14 Dec 2012 15:41:31 +0000"/>
                            <attachment id="12550825" name="BOOKKEEPER-428-1.patch" size="11276" author="rakeshr" created="Thu, 25 Oct 2012 19:21:52 +0100"/>
                            <attachment id="12550669" name="BOOKKEEPER-428.patch" size="11209" author="rakeshr" created="Wed, 24 Oct 2012 20:12:21 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Oct 2012 08:14:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>246582</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy1mdr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>43277</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>