<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:31:53 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-673/BOOKKEEPER-673.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-673] Ledger length can be inaccurate in failure case</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-673</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;Ledger length can be inconsistent if a ledger is closed by a writing client that encounters an error. For example, in a cluster with 3 bookies, and an ledger with a q3e3 configuration, if a bookie dies, the client will close the ledger when it fails to write an entry. However, it has already added the length of the failed entry to the local ledger length, and this is what is stored to zk.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12664811">BOOKKEEPER-673</key>
            <summary>Ledger length can be inaccurate in failure case</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hustlmsp">Sijie Guo</assignee>
                                    <reporter username="ikelly">Ivan Kelly</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Aug 2013 12:00:38 +0100</created>
                <updated>Fri, 30 May 2014 15:33:15 +0100</updated>
                            <resolved>Mon, 14 Oct 2013 17:32:44 +0100</resolved>
                                                    <fixVersion>4.3.0</fixVersion>
                    <fixVersion>4.2.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13746596" author="hustlmsp" created="Wed, 21 Aug 2013 18:25:50 +0100"  >&lt;p&gt;is there any application relying on this length field rather than the LAC field? if this length field is a critical part as LAC, should we also fix it in 4.2.2?&lt;/p&gt;

&lt;p&gt;from technical perspective, it should be an easy and straightforward fix: since we keep pending add ops in a queue, we could decrement the length when error out pending add ops during closing.&lt;/p&gt;</comment>
                            <comment id="13747267" author="vinayrpet" created="Thu, 22 Aug 2013 06:50:30 +0100"  >&lt;p&gt;Good finding Ivan. This issue might be there from the long time I think.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;is there any application relying on this length field rather than the LAC field?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I don&apos;t think so, if yes, it would have been found long back. &lt;br/&gt;
From inside BK client code, this field value doesn&apos;t harm as of now.&lt;/p&gt;</comment>
                            <comment id="13747363" author="ikelly" created="Thu, 22 Aug 2013 09:30:20 +0100"  >&lt;blockquote&gt;&lt;p&gt;is there any application relying on this length field rather than the LAC field?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;As Vinay said, if they were, they would have seen this already. As they haven&apos;t, i&apos;d push this out to 4.3.0 and a possible 4.2.3. I&apos;d like to get 4.2.2 out this week, and as such, I&apos;d like to avoid any scope creep.&lt;/p&gt;</comment>
                            <comment id="13763938" author="hustlmsp" created="Wed, 11 Sep 2013 04:59:04 +0100"  >&lt;p&gt;generated a straightforward patch to decrement entry length when error out entries.&lt;/p&gt;</comment>
                            <comment id="13764079" author="hadoopqa" created="Wed, 11 Sep 2013 08:42:29 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-673&quot; title=&quot;Ledger length can be inaccurate in failure case&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-673&quot;&gt;&lt;del&gt;BOOKKEEPER-673&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12602517/BOOKKEEPER-673.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-673.patch&lt;/a&gt; downloaded at Wed Sep 11 07:15:10 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 880&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/491/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/491/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13794253" author="ikelly" created="Mon, 14 Oct 2013 17:32:44 +0100"  >&lt;p&gt;Committed r1531970. Thanks Sijie&lt;/p&gt;</comment>
                            <comment id="13794286" author="hudson" created="Mon, 14 Oct 2013 18:15:03 +0100"  >&lt;p&gt;SUCCESS: Integrated in bookkeeper-trunk #401 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/401/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/401/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-673&quot; title=&quot;Ledger length can be inaccurate in failure case&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-673&quot;&gt;&lt;del&gt;BOOKKEEPER-673&lt;/del&gt;&lt;/a&gt;: Ledger length can be inaccurate in failure case (sijie via ivank) (ivank: rev 1531970)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerCloseTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14013691" author="ikelly" created="Fri, 30 May 2014 15:33:15 +0100"  >&lt;p&gt;Committed revision 1598614 to branch 4.2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12602517" name="BOOKKEEPER-673.patch" size="5103" author="hustlmsp" created="Wed, 11 Sep 2013 04:59:04 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 21 Aug 2013 17:25:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>344754</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzhanj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>345054</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>