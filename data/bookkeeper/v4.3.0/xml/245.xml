<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:28:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-245/BOOKKEEPER-245.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-245] Intermittent failures in PersistanceManager tests</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-245</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;TestLocalDBPersistenceManagerBlackBox sometimes fails&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. As does TestBookKeeperPersistenceManagerWhiteBox&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/481/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/481/&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/498/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/498/&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12554464">BOOKKEEPER-245</key>
            <summary>Intermittent failures in PersistanceManager tests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ikelly">Ivan Kelly</assignee>
                                    <reporter username="ikelly">Ivan Kelly</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 May 2012 11:55:32 +0100</created>
                <updated>Mon, 22 Oct 2012 15:50:18 +0100</updated>
                            <resolved>Thu, 10 May 2012 10:58:10 +0100</resolved>
                                                    <fixVersion>4.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13271304" author="ikelly" created="Wed, 9 May 2012 11:59:31 +0100"  >&lt;p&gt;TestLocalDBPersistenceManagerBlackBox failure is caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2074&quot; title=&quot;NullPointerException when two threads load sort factory concurrently&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2074&quot;&gt;&lt;del&gt;DERBY-2074&lt;/del&gt;&lt;/a&gt;. Bumping the derby dependency fixes it.&lt;/p&gt;

&lt;p&gt;TestBookKeeperPersistenceManagerWhiteBox fails because the PM thinks that it doesn&apos;t own the topic. This is because we randomly clear the topic list so that we will use multiple ledgers. If we do this on the last iteration of the outer loop, when we try to scan it will think that we don&apos;t own the topic. The solution is to acquire the topic before to scan to ensure that we have it.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// once in every 10 times, give up ledger
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (r.nextInt(10) == 9) {
    &lt;span class=&quot;code-comment&quot;&gt;// Make the bkpm lose its memory
&lt;/span&gt;    bkpm.topicInfos.clear();
    numPrevLedgers++;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13271308" author="ikelly" created="Wed, 9 May 2012 12:02:13 +0100"  >&lt;p&gt;The patch fixes as stated in previous comment, and also fixes it so that if the white box bug manifests, it shows as a proper exception, and not a NPE.&lt;/p&gt;</comment>
                            <comment id="13271391" author="hustlmsp" created="Wed, 9 May 2012 14:04:20 +0100"  >&lt;p&gt;yes, ur right. I did find this issue and fix it in &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-191&quot; title=&quot;Hub server should change ledger to write, so consumed messages have chance to be garbage collected.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-191&quot;&gt;&lt;del&gt;BOOKKEEPER-191&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;It would be better to fix it in separated issue. thanks Ivan. the patch looks good to me. +1&lt;/p&gt;</comment>
                            <comment id="13272230" author="ikelly" created="Thu, 10 May 2012 10:58:12 +0100"  >&lt;p&gt;Committing as r1336569. Thanks for reviewing Sijie.&lt;/p&gt;</comment>
                            <comment id="13272315" author="hudson" created="Thu, 10 May 2012 14:23:29 +0100"  >&lt;p&gt;Integrated in bookkeeper-trunk #502 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/502/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/502/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-245&quot; title=&quot;Intermittent failures in PersistanceManager tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-245&quot;&gt;&lt;del&gt;BOOKKEEPER-245&lt;/del&gt;&lt;/a&gt;: Intermittent failures in PersistanceManager tests (ivank) (Revision 1336569)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/pom.xml&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/server/persistence/TestBookkeeperPersistenceManagerWhiteBox.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526141" name="BOOKKEEPER-245.diff" size="2212" author="ikelly" created="Wed, 9 May 2012 12:02:13 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 9 May 2012 13:04:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>238706</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4rv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61670</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>