<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:25:58 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-592/BOOKKEEPER-592.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-592] allow application to recommend ledger data locality</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-592</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;For application like hbase WAL, it will be useful if application like hbase can give a hint to bk about application&apos;s preferred ledger location. In that way, application can fail over to specific machines where one of the ledger replica is located; the recovery time will be faster. Another scenario is hbase&apos;s support for hot standby region server where read request can be served from a different machine other than the active region server. That requires the hot standby region server to read from ledger. If the ledger is on the same machine as standby region server, the performance will be better.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12638478">BOOKKEEPER-592</key>
            <summary>allow application to recommend ledger data locality</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hustlmsp">Sijie Guo</assignee>
                                    <reporter username="mingma">Ming Ma</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Mar 2013 10:04:34 +0000</created>
                <updated>Mon, 1 Dec 2014 04:46:37 +0000</updated>
                            <resolved>Wed, 12 Jun 2013 17:42:22 +0100</resolved>
                                                    <fixVersion>4.3.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13641894" author="fpj" created="Thu, 25 Apr 2013 16:34:04 +0100"  >&lt;p&gt;Suggesting a set of bookies or bookie properties (e.g., rack locality) to drive the selection of bookies when creating a ledger is not hard to do, it is mostly a problem of designing the API change. One difficulty I&apos;m seeing is that we might end up diverging if there are bookie crashes and we change the ensemble. We would need to keep that information with the metadata and use it to drive the selection when replacing bookies.&lt;/p&gt;</comment>
                            <comment id="13645260" author="hustlmsp" created="Tue, 30 Apr 2013 06:13:43 +0100"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
We would need to keep that information with the metadata and use it to drive the selection when replacing bookies.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;why we need to keep information with metadata? should IP address be enough for selection? putting information with metadata, you had to consider metadata update, backward compatibility issue?&lt;/p&gt;

&lt;p&gt;my thought is to have an EnsembleSelectionPolicy interface, which has an method #newEnsemble(Set&amp;lt;InetSocketAddress&amp;gt; knownBookies, int ensembleSize).&lt;/p&gt;

&lt;p&gt;have a method in BookKeeper #setEnsembleSelectionPolicy().&lt;/p&gt;


&lt;p&gt;by default, we provide a random selection policy. and user could implement its selection policy based on rack information or other application properties. how does it sound?&lt;/p&gt;</comment>
                            <comment id="13659217" author="hustlmsp" created="Thu, 16 May 2013 05:45:09 +0100"  >&lt;p&gt;we are working on a rackaware ensemble placement, which is similar as the ticket here.&lt;/p&gt;

&lt;p&gt;attach a patch of this work, so we could get some agreement on this part.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;abstract an EnsemblePlacementPolicy interface from BookieWatcher.&lt;/li&gt;
	&lt;li&gt;separate the original ensemble select algorithm into DefaultEnsemblePlacementPolicy, which choose bookie randomly.&lt;/li&gt;
	&lt;li&gt;provide a simple rack aware policy using hadoop&apos;s network topology library to build rack topology : choose the ensemble based on rack locality, which ensure there is at least two racks per write quorum. if this constraint could not be met, fallback to choose bookie randomly. the algorithm is simple and straightforward right now: pick up a bookie from the remote rack based on previous bookie to ensure there are at lease two racks per write quorum.&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13659218" author="hustlmsp" created="Thu, 16 May 2013 05:47:43 +0100"  >&lt;p&gt;in this patch, we expose the EnsemblePlacementPolicy to the application, so application could provide its customized policy, which would meet the requirement here.&lt;/p&gt;</comment>
                            <comment id="13659244" author="hadoopqa" created="Thu, 16 May 2013 06:26:50 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-592&quot; title=&quot;allow application to recommend ledger data locality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-592&quot;&gt;&lt;del&gt;BOOKKEEPER-592&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12583428/BOOKKEEPER-592.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-592.patch&lt;/a&gt; downloaded at Thu May 16 04:55:43 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 2 line(s) longer than 120 characters&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 848&lt;br/&gt;
.    Tests failed: 0&lt;br/&gt;
.    Tests errors: 2&lt;/p&gt;

&lt;p&gt;.    The patch failed the following testcases:&lt;/p&gt;

&lt;p&gt;.      &lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/341/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/341/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13659535" author="ikelly" created="Thu, 16 May 2013 14:55:16 +0100"  >&lt;p&gt;Nice work Sijie. It would be good to have a pluggable interface here, that you could specify ensemblePlacementPolicy=com.foobar.myCustomPolicy.class in the config. This way, keeping the data local could be implemented and plugged in.&lt;/p&gt;

&lt;p&gt;Also, EnsemblePlacementPolicy#getBookies and EnsemblePlacementPolicy#onClusterChanged seem to be duplicating functionally between implementations. Notifying them of changes should trigger any wider behaviour, so why not keep the list of bookies in the BookieWatcher, and then pass them to newEnsemble and replaceBookie on invokation?&lt;/p&gt;</comment>
                            <comment id="13659724" author="hustlmsp" created="Thu, 16 May 2013 18:12:51 +0100"  >&lt;blockquote&gt;
&lt;p&gt;ensemblePlacementPolicy=com.foobar.myCustomPolicy.class in the config&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;will make it configurable and constructed by reflection.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;so why not keep the list of bookies in the BookieWatcher, and then pass them to newEnsemble and replaceBookie on invokation?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;if keeping the list of bookies in the watcher, each time newEnsemble or replaceBookie needs to rebuilt the topology of the list of bookies, which it might be an expensive operation for some implementations (e.g. built rack topology).&lt;/p&gt;
</comment>
                            <comment id="13660485" author="fpj" created="Fri, 17 May 2013 09:44:50 +0100"  >&lt;p&gt;This is pretty awesome, Sijie! Thanks for doing it.&lt;/p&gt;

&lt;p&gt;When you have a chance, could you please have a look at the tests that failed in Jenkins:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    org.apache.bookkeeper.client.TestRackawareEnsemblePlacementPolicy.testNewEnsembleWithMultipleRacks
    org.apache.bookkeeper.client.TestRackawareEnsemblePlacementPolicy.testNewEnsembleWithEnoughRacks
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13660785" author="ikelly" created="Fri, 17 May 2013 16:20:41 +0100"  >&lt;blockquote&gt;
&lt;p&gt;if keeping the list of bookies in the watcher, each time newEnsemble or replaceBookie needs to rebuilt the topology of the list of bookies, which it might be an expensive operation for some implementations (e.g. built rack topology).&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Good point. This only applies to #onClusterChanged though. BookieWatcher#getBookies() is only used by the listBookies admin call, and BookieWatcher is still responsible for reading the bookies from zk, so really #getBookies doesn&apos;t belong in the PlacementPolicy.&lt;/p&gt;</comment>
                            <comment id="13661238" author="hustlmsp" created="Sat, 18 May 2013 04:05:16 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;Flavio Junqueira&lt;/a&gt; will take at look the failures this weekend.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ikelly&quot; class=&quot;user-hover&quot; rel=&quot;ikelly&quot;&gt;Ivan Kelly&lt;/a&gt; since cluster change is passed to EnsemblePlacementPolicy, it would be easy to getBookies from policy. Otherwise, two copies of bookies list need to be kept, one in bookie watcher, the other one in ensemble policy. I don&apos;t know how to handle this part gracefully, so I just add #getBookies interface in PlacementPolicy.&lt;/p&gt;</comment>
                            <comment id="13662733" author="hustlmsp" created="Tue, 21 May 2013 07:15:10 +0100"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;add ensemble placement policy as a client configuration setting and construct it by reflection.&lt;/li&gt;
	&lt;li&gt;fixed failed test cases.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13662773" author="hadoopqa" created="Tue, 21 May 2013 08:22:58 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-592&quot; title=&quot;allow application to recommend ledger data locality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-592&quot;&gt;&lt;del&gt;BOOKKEEPER-592&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12583970/BOOKKEEPER-592.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-592.patch&lt;/a&gt; downloaded at Tue May 21 06:51:57 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 2 line(s) longer than 120 characters&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 1 new Findbugs warning(s) in module(s) &lt;span class=&quot;error&quot;&gt;&amp;#91;bookkeeper-server&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 848&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/344/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/344/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13662846" author="ikelly" created="Tue, 21 May 2013 10:48:39 +0100"  >&lt;blockquote&gt;&lt;p&gt;&lt;br/&gt;
since cluster change is passed to EnsemblePlacementPolicy, it would be easy to getBookies from policy. Otherwise, two copies of bookies list need to be kept, one in bookie watcher, the other one in ensemble policy. I don&apos;t know how to handle this part gracefully, so I just add #getBookies interface in PlacementPolicy.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;One way would be to have BookieWatcher#getBookies read the bookies directly rather than returning the previously read list. &lt;/p&gt;</comment>
                            <comment id="13663828" author="hustlmsp" created="Wed, 22 May 2013 07:11:49 +0100"  >&lt;p&gt;removed #getBookies interface from EnsemblePlacementPolicy and fixed findbug error.&lt;/p&gt;</comment>
                            <comment id="13663882" author="hadoopqa" created="Wed, 22 May 2013 08:19:57 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-592&quot; title=&quot;allow application to recommend ledger data locality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-592&quot;&gt;&lt;del&gt;BOOKKEEPER-592&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12584250/BOOKKEEPER-592.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-592.patch&lt;/a&gt; downloaded at Wed May 22 06:48:42 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 1 line(s) with trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 2 line(s) longer than 120 characters&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 848&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/345/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/345/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13671315" author="fpj" created="Fri, 31 May 2013 11:47:13 +0100"  >&lt;p&gt;For some reason the review board didn&apos;t accept the file sijie uploaded, so I regenerated the patch and I&apos;m uploading it. There is no change to the actual patch.&lt;/p&gt;</comment>
                            <comment id="13671347" author="hadoopqa" created="Fri, 31 May 2013 12:17:34 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-592&quot; title=&quot;allow application to recommend ledger data locality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-592&quot;&gt;&lt;del&gt;BOOKKEEPER-592&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12585579/bookkeeper-592.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bookkeeper-592.patch&lt;/a&gt; downloaded at Fri May 31 10:51:07 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 1 line(s) with trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 2 line(s) longer than 120 characters&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 848&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/348/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/348/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13671632" author="ikelly" created="Fri, 31 May 2013 17:43:08 +0100"  >&lt;p&gt;Apart from the formatting issues, this patch pulls in hadoop-common, which transitively pulls in a whole bunch of dependencies. You need to update &lt;span class=&quot;error&quot;&gt;&amp;#91;bookkeeper,hedwig&amp;#93;&lt;/span&gt;-server/src/main/resource/&lt;span class=&quot;error&quot;&gt;&amp;#91;LICENSE.txt,NOTICE.txt&amp;#93;&lt;/span&gt; to reflect this. Or we could decide to not do binaries releases anymore.&lt;/p&gt;</comment>
                            <comment id="13675171" author="fpj" created="Tue, 4 Jun 2013 21:07:53 +0100"  >&lt;p&gt;Review board link:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/11574/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/11574/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It sounds like there are still long lines and trailing spaces in the latest patch. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13675857" author="ikelly" created="Wed, 5 Jun 2013 13:20:04 +0100"  >&lt;p&gt;Regarding the hadoop-commons dependency, it seems the import you use have almost no dependencies on anything else, and as such, we can just copy the code itself over and include it in our tree without pulling in all the other stuff hadoop-commons has. It has the problem that it will be hard to get fixes to this code, but it does mean much easier maintenance of LICENCE and NOTICE, and a much smaller dependency tree.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/ivankelly/bookkeeper/tree/topology-from-hadoop/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/topology&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/ivankelly/bookkeeper/tree/topology-from-hadoop/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/topology&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13680961" author="hustlmsp" created="Wed, 12 Jun 2013 06:48:31 +0100"  >&lt;p&gt;attach a new patch to address Ivan and Flavio comments.&lt;/p&gt;

&lt;p&gt;1) import hadoop net sub package into bookkeeper&lt;br/&gt;
2) comments in Flavio&apos;s review board.&lt;/p&gt;</comment>
                            <comment id="13681003" author="hadoopqa" created="Wed, 12 Jun 2013 08:00:49 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-592&quot; title=&quot;allow application to recommend ledger data locality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-592&quot;&gt;&lt;del&gt;BOOKKEEPER-592&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12587372/BOOKKEEPER-592.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-592.patch&lt;/a&gt; downloaded at Wed Jun 12 06:59:01 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; Patch failed to apply to head of branch&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;</comment>
                            <comment id="13681319" author="ikelly" created="Wed, 12 Jun 2013 16:09:49 +0100"  >&lt;p&gt;Patch was generated with prefixes so couldn&apos;t apply. I removed the patch prefixes, uploading again to trigger build&lt;/p&gt;</comment>
                            <comment id="13681340" author="hadoopqa" created="Wed, 12 Jun 2013 16:42:58 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-592&quot; title=&quot;allow application to recommend ledger data locality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-592&quot;&gt;&lt;del&gt;BOOKKEEPER-592&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12587448/BOOKKEEPER-592.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-592.diff&lt;/a&gt; downloaded at Wed Jun 12 15:16:53 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 848&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/358/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/358/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13681372" author="ikelly" created="Wed, 12 Jun 2013 17:39:43 +0100"  >&lt;p&gt;New patch is good. +1. Committing.&lt;/p&gt;</comment>
                            <comment id="13681373" author="ikelly" created="Wed, 12 Jun 2013 17:42:22 +0100"  >&lt;p&gt;Committed as r1492274. Thanks Sijie.&lt;/p&gt;</comment>
                            <comment id="13681392" author="hudson" created="Wed, 12 Jun 2013 18:10:29 +0100"  >&lt;p&gt;Integrated in bookkeeper-trunk #239 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/239/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/239/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-592&quot; title=&quot;allow application to recommend ledger data locality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-592&quot;&gt;&lt;del&gt;BOOKKEEPER-592&lt;/del&gt;&lt;/a&gt;: allow application to recommend ledger data locality (sijie via ivank) (Revision 1492274)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcher.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicy.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/Configurable.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net/AbstractDNSToSwitchMapping.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net/CachedDNSToSwitchMapping.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net/CommonConfigurationKeys.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net/DNSToSwitchMapping.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetUtils.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopology.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net/Node.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NodeBase.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/Shell.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/LedgerRecoveryTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/TestRackawareEnsemblePlacementPolicy.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/util/StaticDNSResolver.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12459529">BOOKKEEPER-13</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12648562">BOOKKEEPER-612</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12587448" name="BOOKKEEPER-592.diff" size="161110" author="ikelly" created="Wed, 12 Jun 2013 16:09:49 +0100"/>
                            <attachment id="12587372" name="BOOKKEEPER-592.patch" size="161262" author="hustlmsp" created="Wed, 12 Jun 2013 06:48:31 +0100"/>
                            <attachment id="12584250" name="BOOKKEEPER-592.patch" size="64995" author="hustlmsp" created="Wed, 22 May 2013 07:11:49 +0100"/>
                            <attachment id="12583970" name="BOOKKEEPER-592.patch" size="64971" author="hustlmsp" created="Tue, 21 May 2013 07:15:10 +0100"/>
                            <attachment id="12583428" name="BOOKKEEPER-592.patch" size="60754" author="hustlmsp" created="Thu, 16 May 2013 05:45:09 +0100"/>
                            <attachment id="12585579" name="bookkeeper-592.patch" size="64222" author="fpj" created="Fri, 31 May 2013 11:47:13 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 25 Apr 2013 15:34:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>318954</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzcvuv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319295</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>