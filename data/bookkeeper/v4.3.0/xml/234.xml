<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:27:23 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-234/BOOKKEEPER-234.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-234] EntryLogger will throw NPE, if any dir does not exist or IO Errors.</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-234</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;I think, Entry log should check the exitance of directories, before going to get the last Log entries. Because, listFiles will retunr null on non existant directories or any IO Errors. We have to add the check for directory existnace check and null checks in side getLastLogID api in EntryLogger.&lt;/p&gt;

&lt;p&gt;We may need to handle in LedgerCacheImpl also.&lt;/p&gt;

&lt;p&gt;Do we need to add them in bad disks list? and others will refer this list before they use the dirs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12553749">BOOKKEEPER-234</key>
            <summary>EntryLogger will throw NPE, if any dir does not exist or IO Errors.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="umamaheswararao">Uma Maheswara Rao G</assignee>
                                    <reporter username="umamaheswararao">Uma Maheswara Rao G</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 May 2012 13:53:57 +0100</created>
                <updated>Mon, 22 Oct 2012 15:50:19 +0100</updated>
                            <resolved>Wed, 9 May 2012 09:52:38 +0100</resolved>
                                    <version>4.1.0</version>
                                    <fixVersion>4.1.0</fixVersion>
                                    <component>bookkeeper-server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13269938" author="umamaheswararao" created="Mon, 7 May 2012 20:47:40 +0100"  >&lt;p&gt;Attached the patch, which addresses the issue in EntryLogger.&lt;/p&gt;</comment>
                            <comment id="13270294" author="hustlmsp" created="Tue, 8 May 2012 08:43:24 +0100"  >&lt;p&gt;lgtm +1&lt;/p&gt;</comment>
                            <comment id="13270320" author="umamaheswararao" created="Tue, 8 May 2012 09:39:12 +0100"  >&lt;p&gt;Thanks a lot, Sijie for the review!&lt;/p&gt;</comment>
                            <comment id="13270483" author="ikelly" created="Tue, 8 May 2012 15:19:42 +0100"  >&lt;p&gt;Where are you seeing the error occurring? There&apos;s a check when Bookie is created already to ensure that the directories exist.&lt;/p&gt;</comment>
                            <comment id="13270529" author="umamaheswararao" created="Tue, 8 May 2012 16:18:34 +0100"  >&lt;p&gt;Yep, Ivan, I have seen it in checkEnvironment call. If directory does not exist then it is creating it.&lt;/p&gt;

&lt;p&gt;Yes, In my  testing environment it happened on the the startup of BK, unfortunately dirs have been cleaned(through some test scripts) . I am assuming that, after this step(checkEnvironment) only that might have happend. So, I directly verified that EntryLogger code and found that peice for NPE possibility. Do we need to throw the exception if we meet that situation, as we may not have Version files and all right? Now I can see this is very very rare case. Do we need to handle it?&lt;/p&gt;</comment>
                            <comment id="13270536" author="ikelly" created="Tue, 8 May 2012 16:27:50 +0100"  >&lt;p&gt;I think this is a very exceptional scenario (where the directory is deleted, after checkEnvironment and while the bookie is running). We shouldn&apos;t allow the bookie to continue as normal if an admin is doing this. That said NPEs are ugly. It would be better if the entry logger checked for the existence of the directory, and if it doesn&apos;t exist, throw a FileNotFoundException. &lt;/p&gt;</comment>
                            <comment id="13270556" author="umamaheswararao" created="Tue, 8 May 2012 16:40:18 +0100"  >&lt;p&gt;true...Let me update the patch with this change in some time.&lt;/p&gt;</comment>
                            <comment id="13270812" author="umamaheswararao" created="Tue, 8 May 2012 21:52:14 +0100"  >&lt;p&gt;Attached the patch as discussed.&lt;/p&gt;</comment>
                            <comment id="13271218" author="ikelly" created="Wed, 9 May 2012 09:39:54 +0100"  >&lt;p&gt;Committed as r1335996. Thanks Uma.&lt;/p&gt;</comment>
                            <comment id="13271222" author="hudson" created="Wed, 9 May 2012 09:53:37 +0100"  >&lt;p&gt;Integrated in bookkeeper-trunk #498 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/498/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/498/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-234&quot; title=&quot;EntryLogger will throw NPE, if any dir does not exist or IO Errors.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-234&quot;&gt;&lt;del&gt;BOOKKEEPER-234&lt;/del&gt;&lt;/a&gt;: EntryLogger will throw NPE, if any dir does not exist or IO Errors. (umamaheswararao via ivank) (Revision 1335996)&lt;/p&gt;

&lt;p&gt;     Result = UNSTABLE&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogger.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/EntryLogTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526040" name="BOOKKEEPER-234.patch" size="2580" author="umamaheswararao" created="Tue, 8 May 2012 21:52:14 +0100"/>
                            <attachment id="12525907" name="BOOKKEEPER-234.patch" size="2251" author="umamaheswararao" created="Mon, 7 May 2012 20:46:59 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 May 2012 07:43:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>237956</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4rsf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61658</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>