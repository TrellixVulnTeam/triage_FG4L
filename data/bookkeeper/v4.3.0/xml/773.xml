<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:29:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-773/BOOKKEEPER-773.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-773] Provide admin tool to rename bookie identifier in Cookies</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-773</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;The idea of this JIRA to implement a mechanism to efficiently rename the bookie identifier present in the Cookies. Cookie information will be present in:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ledger &amp;amp; journal directories in each Bookie server&lt;/li&gt;
	&lt;li&gt;cookies znode in ZooKeeper&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12729705">BOOKKEEPER-773</key>
            <summary>Provide admin tool to rename bookie identifier in Cookies</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12655537">BOOKKEEPER-639</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rakeshr">Rakesh R</assignee>
                                    <reporter username="rakeshr">Rakesh R</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Jul 2014 12:17:03 +0100</created>
                <updated>Mon, 29 Sep 2014 18:33:38 +0100</updated>
                            <resolved>Mon, 29 Sep 2014 15:29:49 +0100</resolved>
                                                    <fixVersion>4.3.0</fixVersion>
                                    <component>bookkeeper-server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14074392" author="rakeshr" created="Fri, 25 Jul 2014 14:41:28 +0100"  >&lt;p&gt;I&apos;m attaching a patch which exposes &lt;em&gt;renamebookieincookies&lt;/em&gt; cmd. &lt;/p&gt;

&lt;p&gt;This admin command has to be executed in each bookie server machine. When executing it will update the given &apos;tobookieId&apos; into the cookies. Let me try adding test cases, meantime I&apos;d like to know any comments on the approach. Thanks!&lt;/p&gt;</comment>
                            <comment id="14080403" author="hustlmsp" created="Thu, 31 Jul 2014 03:30:45 +0100"  >&lt;p&gt;1. use BookieSocketAddress constructor with a string. don&apos;t do it yourself.&lt;br/&gt;
2. you&apos;d better change bookie id path if bookie id is changed. so the correct sequence would be&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;read cookie from zookeeper.&lt;/li&gt;
	&lt;li&gt;change the bookie id and update it back to zookeeper to use same zk path.&lt;/li&gt;
	&lt;li&gt;update cookie into local directories.&lt;/li&gt;
	&lt;li&gt;create new cookie with new zk path with new bookie id&lt;/li&gt;
	&lt;li&gt;delete the old one.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14080832" author="rakeshr" created="Thu, 31 Jul 2014 14:13:26 +0100"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hustlmsp&quot; class=&quot;user-hover&quot; rel=&quot;hustlmsp&quot;&gt;Sijie Guo&lt;/a&gt; for the reviews. After seeing the comments, I think the command format in the proposed patch will not work well. It will be difficult to deal with the case of identifying and deleting the old cookie from zk. &lt;/p&gt;

&lt;p&gt;&lt;em&gt;Rename command format&lt;/em&gt; would be :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
renamebookieincookies -useHostNameAsBookieID &amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sequence would be:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;read cookie from zookeeper. For reading it will invert useHostNameAsBookieID flag value to the configuration, then read the previous cookie zPath. If cookie doesn&apos;t exists in zk, log cause and exit with -1.&lt;/li&gt;
	&lt;li&gt;generate new cookie. Here it will set the given &apos;useHostNameAsBookieID&apos; flag value to the configuration and get the Bookie.getBookieAddress(conf). Write this new cookie to zk.&lt;/li&gt;
	&lt;li&gt;update new cookie into local directories.&lt;/li&gt;
	&lt;li&gt;create new cookie with new zk path with new bookie id&lt;/li&gt;
	&lt;li&gt;delete the old one. Here it will invert useHostNameAsBookieID flag value and get the previous cookie zPath&lt;/li&gt;
&lt;/ol&gt;


&lt;blockquote&gt;&lt;p&gt;change the bookie id and update it back to zookeeper to use same zk path.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think this is not required and can be removed ?&lt;/p&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
I&apos;ve attached new patch to understand the flow better. Whats your opinion ?&lt;/p&gt;</comment>
                            <comment id="14082003" author="hustlmsp" created="Fri, 1 Aug 2014 08:06:39 +0100"  >&lt;blockquote&gt;
&lt;p&gt;    change the bookie id and update it back to zookeeper to use same zk path.&lt;/p&gt;

&lt;p&gt;I think this is not required and can be removed ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;it is good to have to make sure a bookie couldn&apos;t start if it fails in the middle of renaming cookie. changing the bookie id first would prevent a bookie start since cookies will not match. it would remind people to finish renaming cookie.&lt;/p&gt;

&lt;p&gt;I would suggest not generating cookie from configuration. or at lease you should verify the cookie matches the cookie you read from zookeeper before setting new bookie id. &lt;/p&gt;

&lt;p&gt;regarding the above comments, the flow looks good to me.&lt;/p&gt;

&lt;p&gt;other comments on your patch:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;you should handle the case that the new cookie was already created in zookeeper, in previous rename run. and added test case for it.&lt;/li&gt;
	&lt;li&gt;incorrect option description: opts.addOption(&quot;l&quot;, &quot;useHostNameAsBookieID&quot;, true, &quot;Ledger ID&quot;);&lt;/li&gt;
	&lt;li&gt;I don&apos;t understand why you need to bump cookie version. there isn&apos;t cookie format changes.&lt;/li&gt;
	&lt;li&gt;why you need to test 3 bookies? why can&apos;t just test one bookie?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14082638" author="hadoopqa" created="Fri, 1 Aug 2014 19:05:20 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12659132/003-BOOKKEEPER-773-rename-bookieid-in-cookies.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;003-BOOKKEEPER-773-rename-bookieid-in-cookies.patch&lt;/a&gt; downloaded at Fri Aug  1 17:01:37 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 23 new Javadoc warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 864&lt;br/&gt;
.    Tests failed: 15&lt;br/&gt;
.    Tests errors: 21&lt;/p&gt;

&lt;p&gt;.    The patch failed the following testcases:&lt;/p&gt;

&lt;p&gt;.      testAsyncSubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubRegular)&lt;br/&gt;
.      testSyncUnsubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubRegular)&lt;br/&gt;
.      testAsyncUnsubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubRegular)&lt;br/&gt;
.      testSyncHubSubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubRegular)&lt;br/&gt;
.      testAsyncHubSubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubRegular)&lt;br/&gt;
.      testSyncHubUnsubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubRegular)&lt;br/&gt;
.      testAsyncHubUnsubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubRegular)&lt;br/&gt;
.      testPublishWithBookKeeperError&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubRegular)&lt;br/&gt;
.      testAsyncSubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubSSL)&lt;br/&gt;
.      testSyncUnsubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubSSL)&lt;br/&gt;
.      testAsyncUnsubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubSSL)&lt;br/&gt;
.      testSyncHubSubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubSSL)&lt;br/&gt;
.      testAsyncHubSubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubSSL)&lt;br/&gt;
.      testSyncHubUnsubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubSSL)&lt;br/&gt;
.      testAsyncHubUnsubscribeWithInvalidSubscriberId&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;(org.apache.hedwig.server.integration.TestHedwigHubSSL)&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/656/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/656/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14083634" author="rakeshr" created="Sat, 2 Aug 2014 18:22:28 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hustlmsp&quot; class=&quot;user-hover&quot; rel=&quot;hustlmsp&quot;&gt;Sijie Guo&lt;/a&gt; I&apos;ve reworked and attached new patch addressing the comments. Please look at this. Thanks!&lt;/p&gt;</comment>
                            <comment id="14086736" author="fpj" created="Tue, 5 Aug 2014 21:54:19 +0100"  >&lt;p&gt;I&apos;m curious to know how often one needs to execute such a command. This is a rare command to use, yes? I also don&apos;t like such long names for commands, what about &quot;bkrename&quot; or &quot;renamebookie&quot;?&lt;/p&gt;

&lt;p&gt;The order of execution in the patch:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+                // creates new cookie and write to zookeeper
+                Cookie newCookie = cookie.copy();
+                newCookie.writeToZooKeeper(zk, newConf);
+
+                LOG.info(&quot;Updating cookie file present in journalDirectory {}&quot;, journalDirectory);
+                LOG.info(&quot;Updating cookie file present in ledgerDirectories {}&quot;, ledgerDirectories);
+                newCookie.writeToDirectory(journalDirectory);
+                for (File dir : ledgerDirectories) {
+                    newCookie.writeToDirectory(dir);
+                }
+                cookie.deleteFromZooKeeper(zk, conf);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;seems to swap 3 and 4 in this sequence:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;3. update new cookie into local directories.
4. create new cookie with new zk path with new bookie id
5. delete the old one. 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14087336" author="rakeshr" created="Wed, 6 Aug 2014 07:45:38 +0100"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;Flavio Junqueira&lt;/a&gt; for the comments.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I&apos;m curious to know how often one needs to execute such a command. This is a rare command to use, yes? I also don&apos;t like such long names for commands, what about &quot;bkrename&quot; or &quot;renamebookie&quot;?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, its rare command. Actually we need to rename both (1)ledgers and (2)cookies and this will be done separately through two different bk commands. I&apos;ve included the target entity(ledger/cookie) also in the command to become more self explanatory. Thats the reason name becomes long.&lt;/p&gt;

&lt;p&gt;How about the following, is that fine for you ?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bkrenameinledger &amp;lt;currentBookieId&amp;gt; &amp;lt;toBookieId&amp;gt;
bkrenameincookie -useHostNameAsBookieID &amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;&lt;p&gt;seems to swap 3 and 4 in this sequence:&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yeah, I&apos;ll do it.&lt;/p&gt;</comment>
                            <comment id="14087361" author="hustlmsp" created="Wed, 6 Aug 2014 08:19:01 +0100"  >&lt;p&gt;a minor comment: it would be better to use a Builder pattern for Cookie, rather than modifying the fields in place.&lt;/p&gt;</comment>
                            <comment id="14091716" author="fpj" created="Sat, 9 Aug 2014 11:18:14 +0100"  >&lt;p&gt;I forgot why we need to to do the two commands separately. I was actually thinking that you could do something like:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;bkrename -ledger &amp;lt;currentBookieId&amp;gt; &amp;lt;toBookieId&amp;gt;
bkrename -cookie -useHostNameAsBookieId &amp;lt;true|false&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;This is cleaner, but it opens up to people doing &quot;bkrename -ledger -cookie....&quot;, which we could of course fail if it is really needed. Just a suggestion...&lt;/p&gt;</comment>
                            <comment id="14094374" author="hadoopqa" created="Tue, 12 Aug 2014 18:38:54 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12659132/003-BOOKKEEPER-773-rename-bookieid-in-cookies.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;003-BOOKKEEPER-773-rename-bookieid-in-cookies.patch&lt;/a&gt; downloaded at Tue Aug 12 17:34:18 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; Patch failed to apply to head of branch&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;</comment>
                            <comment id="14094403" author="rakeshr" created="Tue, 12 Aug 2014 18:56:51 +0100"  >&lt;blockquote&gt;&lt;p&gt;I forgot why we need to to do the two commands separately.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ledger renaming can be done from any server but cookie updates needs to be executed on each server as it has to update the filesystem directories. That was my thoughts when proposing two separate commands. Now I could see a better way of clubbing these two as a single command like below. Does this sounds good ?. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bkrename -useHostNameAsBookieId &amp;lt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;|&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Sequence would be:&lt;br/&gt;
step-1. First update the cookie by following the same sequence discussed above in this JIRA.&lt;br/&gt;
step-2. Then update the ledger metadata by following the sequence discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-634&quot; title=&quot;Provide admin tool to rename bookie identifier in ledger metadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-634&quot;&gt;&lt;del&gt;BOOKKEEPER-634&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
In both the steps, invert useHostNameAsBookieID flag value to get the previous Bookieid.&lt;/p&gt;</comment>
                            <comment id="14096138" author="hadoopqa" created="Wed, 13 Aug 2014 22:14:13 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12659132/003-BOOKKEEPER-773-rename-bookieid-in-cookies.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;003-BOOKKEEPER-773-rename-bookieid-in-cookies.patch&lt;/a&gt; downloaded at Wed Aug 13 21:09:47 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; Patch failed to apply to head of branch&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;</comment>
                            <comment id="14110373" author="hustlmsp" created="Tue, 26 Aug 2014 07:32:47 +0100"  >&lt;p&gt;you could club two commands together as what &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;Flavio Junqueira&lt;/a&gt; suggested. but -1 on doing two actions together. I would prefer each command would simply only do one thing.&lt;/p&gt;</comment>
                            <comment id="14110374" author="hustlmsp" created="Tue, 26 Aug 2014 07:32:59 +0100"  >&lt;p&gt;and please rebase your patch.&lt;/p&gt;</comment>
                            <comment id="14110389" author="rakeshr" created="Tue, 26 Aug 2014 07:42:41 +0100"  >&lt;p&gt;Thanks Sijie for the feedback. I&apos;ll rebase it as soon as possible, I&apos;m little busy with other internal schedules&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14119941" author="rakeshr" created="Wed, 3 Sep 2014 16:12:59 +0100"  >&lt;p&gt;I failed to see a way to define &apos;-ledger&apos; and &apos;-cookie&apos; options through org.apache.commons.cli.Options. These are two different options with their own mandatory arguments. Also, atleast one is mandatory for &apos;bkrename&apos; command. Is there any way to achieve this ?&lt;/p&gt;</comment>
                            <comment id="14124330" author="hustlmsp" created="Sat, 6 Sep 2014 06:15:42 +0100"  >&lt;p&gt;why couldn&apos;t you validate this in the command?&lt;/p&gt;</comment>
                            <comment id="14124410" author="rakeshr" created="Sat, 6 Sep 2014 11:00:52 +0100"  >&lt;p&gt;If I understood your point correctly, should have a parsing logic within the command instead of using &apos;org.apache.commons.cli.Options. But how to implement #getOptions() and #getUsage() for this command as this have two separate set of commands for -ledger and -cookie, isn&apos;t it?&lt;/p&gt;</comment>
                            <comment id="14125036" author="rakeshr" created="Sun, 7 Sep 2014 21:06:02 +0100"  >&lt;p&gt;I&apos;ve tried an approach and attached the same. In the patch please see BookieRename command impl in BookieShell.java class to know the validation/getOptions/getUsage. Will this kind of validations and argument listing makes things more complex?. Now I also feels to move this JIRA to 4.3.1 so that will get some more time to make it simple.&lt;/p&gt;</comment>
                            <comment id="14126148" author="fpj" created="Mon, 8 Sep 2014 22:35:55 +0100"  >&lt;p&gt;I also don&apos;t understand why you&apos;re failing to validate. I do understand that there are two groups of parameters, but it isn&apos;t uncommon that tools/applications have different commands (e.g., svn). The execution of a parameter becomes dependent on the command.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Now I also feels to move this JIRA to 4.3.1&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;4.3.1 is supposed to be a bug fix release, and I believe this is part of a new feature... not ideal.  &lt;/p&gt;</comment>
                            <comment id="14126576" author="hustlmsp" created="Tue, 9 Sep 2014 05:16:56 +0100"  >&lt;p&gt;I don&apos;t understand why it complex too.&lt;/p&gt;

&lt;p&gt;still a few comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;you should put those two branches into two functions, rather than have too much code.&lt;/li&gt;
	&lt;li&gt;you could get all the options from command line first, and validate the options and then execute different functions according to different options.&lt;/li&gt;
	&lt;li&gt;it would be better to have test cases for renameBookieIdInLedger &amp;amp; renameBookieIdInCookie&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14126579" author="hustlmsp" created="Tue, 9 Sep 2014 05:19:03 +0100"  >&lt;p&gt;and as &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;Flavio Junqueira&lt;/a&gt; pointed out, 4.3.1 is only a bug fix release. but if you think you need more time to finish this, I think it is OK to put this in 4.3.1, since these two tickets are mostly about a tool and the feature is only in.&lt;/p&gt;</comment>
                            <comment id="14126948" author="fpj" created="Tue, 9 Sep 2014 14:01:37 +0100"  >&lt;p&gt;It really depends on how urgent having this tool is. If it is a blocker, then we should hold the release until this is in. If this isn&apos;t a blocker and isn&apos;t ready for 4.3.0, why not push it to 4.4.0?&lt;/p&gt;
</comment>
                            <comment id="14128244" author="rakeshr" created="Wed, 10 Sep 2014 10:18:17 +0100"  >&lt;blockquote&gt;&lt;p&gt;If it is a blocker, then we should hold the release until this is in.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;No, its not a blocker&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;If this isn&apos;t a blocker and isn&apos;t ready for 4.3.0, why not push it to 4.4.0?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;As we know, the feature is already checked in to 4.3.0. New bk installations can make use of this. This tool is needed to update the cookie/ledgers and is required for the existing installations. IMHO if we can reach to an agreement will try push this in 4.3.0. Since it is not a new feature we can consider this to 4.3.1?&lt;/p&gt;

&lt;p&gt;I&apos;ve uploaded new patch addressing Sijie&apos;s comments. Please have a look. Thanks!&lt;/p&gt;</comment>
                            <comment id="14128296" author="hadoopqa" created="Wed, 10 Sep 2014 10:57:49 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12667631/005-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;005-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Wed Sep 10 09:21:47 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;WARNING&lt;/font&gt;: the current HEAD has 23 Javadoc warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 933&lt;br/&gt;
.    Tests failed: 0&lt;br/&gt;
.    Tests errors: 1&lt;/p&gt;

&lt;p&gt;.    The patch failed the following testcases:&lt;/p&gt;

&lt;p&gt;.      &lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;.   There is at least one warning, please check&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/713/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/713/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14128319" author="hadoopqa" created="Wed, 10 Sep 2014 11:33:57 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12667631/005-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;005-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Wed Sep 10 09:58:08 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;WARNING&lt;/font&gt;: the current HEAD has 23 Javadoc warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 933&lt;br/&gt;
.    Tests failed: 0&lt;br/&gt;
.    Tests errors: 1&lt;/p&gt;

&lt;p&gt;.    The patch failed the following testcases:&lt;/p&gt;

&lt;p&gt;.      &lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;.   There is at least one warning, please check&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/714/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/714/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14128456" author="hadoopqa" created="Wed, 10 Sep 2014 14:17:41 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12667631/005-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;005-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Wed Sep 10 12:41:46 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;WARNING&lt;/font&gt;: the current HEAD has 23 Javadoc warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 933&lt;br/&gt;
.    Tests failed: 0&lt;br/&gt;
.    Tests errors: 1&lt;/p&gt;

&lt;p&gt;.    The patch failed the following testcases:&lt;/p&gt;

&lt;p&gt;.      &lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;.   There is at least one warning, please check&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/715/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/715/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14129677" author="hustlmsp" created="Thu, 11 Sep 2014 06:55:32 +0100"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;it seems that the patch contains lots of unnecessary formats, it made hard to review actually.&lt;/li&gt;
	&lt;li&gt;still you didn&apos;t address my comments on renameBookieIdInLedger on &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-634&quot; title=&quot;Provide admin tool to rename bookie identifier in ledger metadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-634&quot;&gt;&lt;del&gt;BOOKKEEPER-634&lt;/del&gt;&lt;/a&gt;. This tool should focus on real production use case, not just print fancy information. The current implementation will definitely have huge side effects on real production traffic, if you don&apos;t control the number of requests issued to zookeeper. so -1 on renameBookieIdInLedger.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;another suggestion, even you use same command &apos;bkrename&apos;, you don&apos;t actually put all two tickets together. &lt;/p&gt;

&lt;p&gt;you could do:&lt;br/&gt;
1) first implement the options for renaming bookie identifier, since I think we are fine with your renaming bookie identifier part. (patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;)&lt;br/&gt;
2) secondly add options to &apos;bkrename&apos; to support renaming bookie in ledgers. (another patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-634&quot; title=&quot;Provide admin tool to rename bookie identifier in ledger metadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-634&quot;&gt;&lt;del&gt;BOOKKEEPER-634&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;it is much clear and easier for reviewing and get things checked in faster. &lt;/p&gt;</comment>
                            <comment id="14129688" author="hustlmsp" created="Thu, 11 Sep 2014 07:13:25 +0100"  >&lt;p&gt;I think the thread is kind of being too long. let me recap what I commented before (since I didn&apos;t see them in the new patch).&lt;/p&gt;

&lt;p&gt;(those comments are only one rename cookie part)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;in general, all class variables in Cookie should be final. please use a Builder pattern to generate a new Cookie object when modifying it. DONT modify the field in-place, which would usually introduce bugs.&lt;/li&gt;
	&lt;li&gt;getArgBooleanValue: I would suggest throw exceptions when encountered any bad arguments, rather then silent them.
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; getArgBooleanValue(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; arg, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; option, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; defaultVal) {
+        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.parseBoolean(arg);
+        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (NumberFormatException nfe) {
+            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR: invalid value &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; option &quot;&lt;/span&gt; + option + &lt;span class=&quot;code-quote&quot;&gt;&quot; : &quot;&lt;/span&gt; + arg);
+            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; defaultVal;
+        }
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14129694" author="rakeshr" created="Thu, 11 Sep 2014 07:25:06 +0100"  >&lt;blockquote&gt;&lt;p&gt;This tool should focus on real production use case, not just print fancy information. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The idea of printing progress details is to help users if there are many ledgers. Otw it would be hard to determine the completion time.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;This tool should focus on real production use case, not just print fancy information. The current implementation will definitely have huge side effects on real production traffic, if you don&apos;t control the number of requests issued to zookeeper. so -1 on renameBookieIdInLedger&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I agree with you. I&apos;d like to retain the progress information. How about adding a &apos;bandwidth&apos; parameter(by default 10 operations) - this will be maximum number of ledgers which can be renamed concurrently. If 11th operation comes it will wait.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;it is much clear and easier for reviewing and get things checked in faster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yeah I will split the patches and do cleanup.&lt;/p&gt;</comment>
                            <comment id="14129701" author="hustlmsp" created="Thu, 11 Sep 2014 07:33:59 +0100"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
I&apos;d like to retain the progress information.  How about adding a &apos;bandwidth&apos; parameter(by &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; 10 operations) - &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; will be maximum number of ledgers which can be renamed concurrently. If 11th operation comes it will wait.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;there are actually two concerns on your implementation: 1) you pulled all ledgers into a list, which doesn&apos;t work if your cluster have a lot of ledgers. you might not encounter this issue on hdfs namenode, but we have this issue on a real production cluster. so don&apos;t pull all ledgers together into a list, use ledger iterator. 2) you send all the requests immediately, which will overwhelm the system.&lt;/p&gt;

&lt;p&gt;&apos;bandwidth&apos; (it is actually &apos;concurrency&apos;) is good for 2). but it doesn&apos;t resolve 1). if you do want retain the progress information, please provide two different implementation, one is using your current solution, while the other one is using ledger iterator. so people could choose what to use. although I don&apos;t suggest to have two implementation on this, it would make code maintenance become hard.  &lt;/p&gt;</comment>
                            <comment id="14129711" author="rakeshr" created="Thu, 11 Sep 2014 07:57:01 +0100"  >&lt;blockquote&gt;&lt;p&gt;you pulled all ledgers into a list, which doesn&apos;t work if your cluster have a lot of ledgers. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Actually I pulled all the ledgers to find the total number of ledgers. Is there any single API to know the total number of ledgers, otw I&apos;ve to first iterate over all the ledgers and get the total count. Then secondly will get the iterator again and then iterate over all the ledgers asynchronously(as I mentioned earlier will have bandwidth in place to control the concurrency).&lt;br/&gt;
If I understood correctly you are suggesting to go with one-by-one ledger rename (sequential execution). FYI - Initially I done the same way, but &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ivank%40yahoo-inc.com&quot; class=&quot;user-hover&quot; rel=&quot;ivank@yahoo-inc.com&quot;&gt;Ivan Kelly&lt;/a&gt; has given a &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-634?focusedCommentId=14010999&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14010999&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;comment &lt;/a&gt; to make it concurrent and I also felt it would be useful one.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;one is using your current solution, while the other one is using ledger iterator. so people could choose what to use. although I don&apos;t suggest to have two implementation on this, it would make code maintenance become hard.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I also prefer to implement one good solution. Both are not required.&lt;/p&gt;
</comment>
                            <comment id="14129730" author="rakeshr" created="Thu, 11 Sep 2014 08:13:46 +0100"  >&lt;blockquote&gt;&lt;p&gt;otw I&apos;ve to first iterate over all the ledgers and get the total count. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Adding one more point - due to concurrent ledger creation/deletion by other clients, there are chances of mismatching the total count when iterating over the ledger renaming. Since this is not for validation purpose, it can just skip if the pending count goes to negative values.&lt;/p&gt;</comment>
                            <comment id="14129898" author="rakeshr" created="Thu, 11 Sep 2014 12:23:36 +0100"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hustlmsp&quot; class=&quot;user-hover&quot; rel=&quot;hustlmsp&quot;&gt;Sijie Guo&lt;/a&gt; for your time and quick replies.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;in general, all class variables in Cookie should be final. please use a Builder pattern to generate a new Cookie object when modifying it. DONT modify the field in-place, which would usually introduce bugs.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I&apos;ve raised separate JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-782&quot; title=&quot;Use builder pattern for Cookie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-782&quot;&gt;&lt;del&gt;BOOKKEEPER-782&lt;/del&gt;&lt;/a&gt; to modify Cookie.java. Kindly review it. Thanks!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;it is much clear and easier for reviewing and get things checked in faster.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Attached a patch which only talks about rename cookie. This patch has to be applied on top of &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-782&quot; title=&quot;Use builder pattern for Cookie&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-782&quot;&gt;&lt;del&gt;BOOKKEEPER-782&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14138502" author="hustlmsp" created="Thu, 18 Sep 2014 05:59:58 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;Rakesh R&lt;/a&gt; could you update your patch?&lt;/p&gt;</comment>
                            <comment id="14138620" author="hadoopqa" created="Thu, 18 Sep 2014 08:06:52 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12669648/007-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;007-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Thu Sep 18 06:30:48 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 1 new Findbugs warning(s) in module(s) &lt;span class=&quot;error&quot;&gt;&amp;#91;bookkeeper-server&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 929&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/749/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/749/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14138652" author="hadoopqa" created="Thu, 18 Sep 2014 08:43:32 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12669648/007-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;007-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Thu Sep 18 07:06:59 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 1 new Findbugs warning(s) in module(s) &lt;span class=&quot;error&quot;&gt;&amp;#91;bookkeeper-server&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 929&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/750/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/750/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14138683" author="hadoopqa" created="Thu, 18 Sep 2014 09:20:16 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12669648/007-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;007-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Thu Sep 18 07:43:41 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 1 new Findbugs warning(s) in module(s) &lt;span class=&quot;error&quot;&gt;&amp;#91;bookkeeper-server&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 929&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/751/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/751/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14138715" author="hadoopqa" created="Thu, 18 Sep 2014 10:16:59 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12669676/008-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;008-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Thu Sep 18 08:40:49 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 929&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/752/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/752/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14138768" author="hadoopqa" created="Thu, 18 Sep 2014 11:26:51 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12669676/008-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;008-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Thu Sep 18 09:50:48 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 929&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/753/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/753/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14138788" author="ikelly" created="Thu, 18 Sep 2014 11:59:41 +0100"  >
&lt;p&gt;the usage is a little wierd. useHostNameAdBookieID is a redundant token. something like &quot;bkrename -cookieBookieId &amp;lt;hostname|ip&amp;gt;&quot; would be clearer. Though really these should be separate tools for updating ledger and updating cookies, as they operate on different parts of the system. The grouping only exists because they both relate to the feature. It would better to have something like. &quot;updatecookie -bookieId &amp;lt;hostname|ip&amp;gt;&quot;. This &quot;updatecookie&quot; command could then be used in the future if we wanted to do something like adding or removing ledger/journal directories in the cookie.&lt;/p&gt;

&lt;p&gt;It&apos;s possible that someone would try to update the cookie without correct setting in their configuration, and then start up the bookie who thinks it should use ip when the hostname. The cookie check at boot should prevent anything really nasty from happening, but the error may be a bit confusing to the client. For this reason, we should check the server configuration, and if getUseHostNameAsBookieId() doesn&apos;t match what the tool has, then we should print a reminder for the user to update their configuration.&lt;/p&gt;

&lt;p&gt;The modification of this.znodeVersion makes me a little uncomfortable. Perhaps it would be better to either return the newVersion, or a new cookie with the new version. It&apos;s only a mild discomfort, I wouldn&apos;t block the patch because of it.&lt;/p&gt;

&lt;p&gt;On a side note, the patch has a lot of ^M(\r) characters at the end of the line. I guess this is because you are using windows. Could you disable windows line delimiters as they show up ugly on linux/mac. Windows is happy to accept \n also. &lt;a href=&quot;http://stackoverflow.com/questions/1886185/eclipse-and-windows-newlines&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://stackoverflow.com/questions/1886185/eclipse-and-windows-newlines&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Otherwise, the flow of the update looks good to me. Good work.&lt;/p&gt;</comment>
                            <comment id="14139730" author="hadoopqa" created="Fri, 19 Sep 2014 00:37:22 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12669676/008-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;008-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Thu Sep 18 23:01:06 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 929&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/754/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/754/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14141751" author="hustlmsp" created="Sat, 20 Sep 2014 06:09:37 +0100"  >&lt;p&gt;addition to Ivan&apos;s comment &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    @Test(timeout = 60000)
+    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCookieDoesntExists() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
+        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; bsConfs.size(); i++) {
+            ServerConfiguration conf = bsConfs.get(i);
+            BookieServer bks = bs.get(i);
+            bks.shutdown();
+
+            LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Perform renamebookieincookies command with &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;);
+            BookieShell bkShell = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BookieShell();
+            bkShell.setConf(conf);
+            &lt;span class=&quot;code-comment&quot;&gt;// passing invalid, so will take the &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; as &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/span&gt;+            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] argv = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] { &lt;span class=&quot;code-quote&quot;&gt;&quot;bkrename&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;-cookie&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;useHostNameAsBookieID&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;invalid&quot;&lt;/span&gt; };
+            Assert.assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed to &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the error code!&quot;&lt;/span&gt;, -1, bkShell.run(argv));
+        }
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;why this test case need to run multiple times?&lt;/p&gt;

&lt;p&gt;otherwise, the patch looks better.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;Rakesh R&lt;/a&gt;, could you provide a new patch addressed the comments?&lt;/p&gt;</comment>
                            <comment id="14142200" author="rakeshr" created="Sat, 20 Sep 2014 22:00:02 +0100"  >&lt;p&gt;Thanks Ivan, Sijie. Attached new patch with the command format&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
updatecookie -bookieId &amp;lt;hostname|ipaddress&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;&lt;p&gt;On a side note, the patch has a lot of ^M(\r) characters at the end of the line&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I modified eclipse configuration. Also done dos2unix for the new patch.&lt;/p&gt;</comment>
                            <comment id="14142207" author="hadoopqa" created="Sat, 20 Sep 2014 22:37:19 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12670249/009-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;009-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Sat Sep 20 21:00:47 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 925&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/757/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/757/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14142232" author="hadoopqa" created="Sun, 21 Sep 2014 00:16:57 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12670249/009-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;009-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Sat Sep 20 22:40:44 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 925&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/758/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/758/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14142377" author="rakeshr" created="Sun, 21 Sep 2014 09:06:02 +0100"  >&lt;p&gt;Attached new patch with the following changes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;introduced #copy() method in cookie to avoid modifying this.znodeVersion externally&lt;/li&gt;
	&lt;li&gt;done changes to incorporate two more scenarios 1) UpdateCookieWithExistingBookieId 2) WhenBothIPaddressAndHostNameCookiesExists&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14142385" author="hadoopqa" created="Sun, 21 Sep 2014 09:47:11 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12670278/010-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;010-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Sun Sep 21 08:10:44 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 927&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/759/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/759/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14142439" author="hadoopqa" created="Sun, 21 Sep 2014 13:57:05 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12670278/010-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;010-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Sun Sep 21 12:20:44 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 927&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/760/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/760/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14142902" author="hustlmsp" created="Mon, 22 Sep 2014 06:13:46 +0100"  >&lt;p&gt;minor comment:&lt;/p&gt;

&lt;p&gt;1.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+                LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Updating cookie file present in journalDirectory {}&quot;&lt;/span&gt;, journalDirectory);
+                LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Updating cookie file present in ledgerDirectories {}&quot;&lt;/span&gt;, ledgerDirectories);
+                newCookie.writeToDirectory(journalDirectory);
+                &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (File dir : ledgerDirectories) {
+                    newCookie.writeToDirectory(dir);
+                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;log on ledgerDirectories should after writeToDirectory before writing to ledger directories.&lt;/p&gt;

&lt;p&gt;2. I don&apos;t understand why you need a copy method. isn&apos;t the builder good enough? I don&apos;t like adding such method in an immutable object.&lt;/p&gt;

&lt;p&gt;otherwise, the patch looks good to me.&lt;/p&gt;</comment>
                            <comment id="14142923" author="rakeshr" created="Mon, 22 Sep 2014 06:51:29 +0100"  >&lt;blockquote&gt;&lt;p&gt;2. I don&apos;t understand why you need a copy method. isn&apos;t the builder good enough? I don&apos;t like adding such method in an immutable object.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Previously I tried an approach of #newBuilder(oldcookie) always return the cookie with existing zNodeVersion. And for the (2) case, I set explicitly the default zNodeVersion to the builder. Will this be OK to set the znodeVersion to the builder?&lt;br/&gt;
(1) Build an oldcookie object with &apos;newBookiHost&apos; value. Here it should retain the existing zNodeVersion for setting data to cookie znode.&lt;br/&gt;
(2) Build new cookie object with &apos;newBookieHost&apos; value. Here it should be with default zNodeVersion for creating a new cookie znode.&lt;/p&gt;</comment>
                            <comment id="14142936" author="hustlmsp" created="Mon, 22 Sep 2014 07:13:53 +0100"  >&lt;p&gt;ok. first of all, I don&apos;t know what is the difference between cookie.copy and newBuilder(cookie).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     /**
+     * Gets a copy of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; cookie object.
+     *
+     * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; cookie builder object
+     */
+    Builder copy() {
+        Builder builder = newBuilder(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
+        builder.setZnodeVersion(znodeVersion);
+        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; builder;
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;secondly, I thought I had a comment in cookie builder to say we shouldn&apos;t have znode version in builder. znode version should only exist in cookie instance, which shouldn&apos;t be passed around between builders. I missed checking your patch on addressing this comment. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-782?focusedCommentId=14131090&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14131090&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/BOOKKEEPER-782?focusedCommentId=14131090&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14131090&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14142946" author="rakeshr" created="Mon, 22 Sep 2014 07:37:26 +0100"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t know what is the difference between cookie.copy and newBuilder(cookie).&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;They differs in their znodeVersion.&lt;br/&gt;
#copy - have all the fields of this cookie . This cookie builder is used for setting the newBookieHost to the oldCookie.&lt;br/&gt;
#newBuilder - have all the fields of this cookie except zNodeVersion, which will be DEFAULT_COOKIE_ZNODE_VERSION. This will be used to create a new cookie in ZK.&lt;/p&gt;</comment>
                            <comment id="14143013" author="hadoopqa" created="Mon, 22 Sep 2014 09:22:40 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12670278/010-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;010-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Mon Sep 22 07:46:26 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 927&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/761/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/761/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14143263" author="ikelly" created="Mon, 22 Sep 2014 15:49:55 +0100"  >&lt;p&gt;Further to Sijie&apos;s comment about znodeVersion, Cookie should not have a znode version at all. znodeVersion is only used in the case of read-modify-write. This occurs in two places, FileSystemUpgrade.java:L317 and BookieShell.java:L1064. In both cases, the znodeVersion is only relevant in the scope of a single method.&lt;/p&gt;

&lt;p&gt;I suggest you remove znodeVersion completely from Cookie itself. Then modify readFromKeeper to return a Versioned&amp;lt;Cookie&amp;gt; and modify deleteFromZooKeeper and writeToZookeeper to take a Version. For the initial write, use Version.NEW. There&apos;s already an implementation of Version for zk in o.a.b.m.ZkVersion. You can reuse this.&lt;/p&gt;

&lt;p&gt;Finally, you don&apos;t seem to be doing any validation on curUseHostNameAsBookieID. You just read it and rewrite it.&lt;/p&gt;</comment>
                            <comment id="14143268" author="ikelly" created="Mon, 22 Sep 2014 15:53:37 +0100"  >&lt;p&gt;Also, for the command syntax, when I said &quot;updatecookie -bookieId &amp;lt;hostname|ip&amp;gt;&quot;, I meant that hostname and ip would be constants, so the user could only specify &quot;updatecookie -bookieId hostname&quot; or &quot;updatecookie -bookieId ip&quot; and then command would generate the bookieId based on the configuration. Also, it would check that only &quot;hostname&quot; or &quot;ip&quot; were set. Perhaps this would be clearer if they were in uppercase. I don&apos;t think it&apos;s a good idea to have admin setting arbitrary values for the bookie id.&lt;/p&gt;</comment>
                            <comment id="14144028" author="hustlmsp" created="Tue, 23 Sep 2014 00:31:21 +0100"  >&lt;p&gt;+1 on Ivan&apos;s suggestion.&lt;/p&gt;</comment>
                            <comment id="14144887" author="rakeshr" created="Tue, 23 Sep 2014 16:20:26 +0100"  >&lt;p&gt;Created &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-787&quot; title=&quot;Modify Cookie by removing &amp;#39;znodeVersion&amp;#39; state/field&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-787&quot;&gt;&lt;del&gt;BOOKKEEPER-787&lt;/del&gt;&lt;/a&gt; for making Cookie immutable. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ivank%40yahoo-inc.com&quot; class=&quot;user-hover&quot; rel=&quot;ivank@yahoo-inc.com&quot;&gt;Ivan Kelly&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hustlmsp&quot; class=&quot;user-hover&quot; rel=&quot;hustlmsp&quot;&gt;Sijie Guo&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Sometime back there was an offline discussion with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ivank%40yahoo-inc.com&quot; class=&quot;user-hover&quot; rel=&quot;ivank@yahoo-inc.com&quot;&gt;Ivan Kelly&lt;/a&gt; about cookieupdate algo. Since we are making the Cookie immutable, tried to avoid setting bookiehost to the oldcookie in zookeeper with few verification steps. Verification is to make sure that zookeeper and the filesystem is in sync. &lt;/p&gt;

&lt;p&gt;&lt;ins&gt;New algo:&lt;/ins&gt;&lt;br/&gt;
1. prerequisite : update conf useHostNameAsBookieID=true&lt;br/&gt;
2. Exec cmd : cookieupdate -bookieId hostname&lt;br/&gt;
2.1. check that conf has useHostNameAsBookieID == true. If no return.&lt;br/&gt;
2.2. read old cookie, generating a ip based cookie path. If fails all is fine(cookie is hostname based) just return.&lt;br/&gt;
2.3. Verification&lt;br/&gt;
2.3.1. check the old cookie matches all the directory cookies. If yes goto 2.4 else goto 2.3.2&lt;br/&gt;
2.3.2. check oldcookie == newcookie. If yes all is fine(since we able to read oldcookie in 2.2, delete oldcookie) else goto 2.5 &lt;br/&gt;
2.4. update the old cookie,&#160;write to all directories (this will prevent startup if there&apos;s a crash half way)&lt;br/&gt;
2.5. write the updated cookie to the new zookeeper path&lt;br/&gt;
2.6. delete old cookie&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ivank%40yahoo-inc.com&quot; class=&quot;user-hover&quot; rel=&quot;ivank@yahoo-inc.com&quot;&gt;Ivan Kelly&lt;/a&gt; Please feel free to correct if I miss anything.&lt;/p&gt;

&lt;p&gt;Appreciate any comments.&lt;/p&gt;</comment>
                            <comment id="14145755" author="hustlmsp" created="Wed, 24 Sep 2014 02:33:18 +0100"  >&lt;p&gt;what is the difference with previous algorithm? could you clarify the difference on the sequence?&lt;/p&gt;</comment>
                            <comment id="14145927" author="rakeshr" created="Wed, 24 Sep 2014 06:36:00 +0100"  >&lt;p&gt;&lt;b&gt;Diff&lt;/b&gt;&lt;br/&gt;
a) Added 2.3. Verification steps before performing any update operations.&lt;br/&gt;
b) Removed setting the newbookiehost to the oldcookie, here considering the verification steps will make sure that zookeeper and the filesystem is in sync. &lt;/p&gt;

&lt;p&gt;Partial failure cases like,&lt;br/&gt;
case-1) after 2.4 step assume cmd has crashed/failed(say zk is down)&lt;br/&gt;
Ans: Bookie startup will fail as it sees newbookie in the directories. This will be a hint to the users&lt;br/&gt;
case-2) after 2.5 step assume cmd has crashed/failed(say zk is down)&lt;br/&gt;
Ans: Bookie will be able to start with only new configuration. If anyone tries to use old conf, startup will fail as it sees newbookie in the directories.&lt;br/&gt;
Secondly, users can do cleanup by reexecuting the cmd by making zk up.&lt;/p&gt;</comment>
                            <comment id="14148671" author="hustlmsp" created="Fri, 26 Sep 2014 04:16:23 +0100"  >&lt;p&gt;make sense to me. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;Rakesh R&lt;/a&gt; do you have the latest patch?&lt;/p&gt;</comment>
                            <comment id="14149081" author="ikelly" created="Fri, 26 Sep 2014 13:12:11 +0100"  >&lt;p&gt;+1 for this algo also. Be sure to check that it works for IP -&amp;gt; HOSTNAME and HOSTNAME -&amp;gt; IP transitions.&lt;/p&gt;</comment>
                            <comment id="14150777" author="rakeshr" created="Sat, 27 Sep 2014 22:17:16 +0100"  >&lt;p&gt;Attached new patch. Here 2.3 steps has been modified like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2.3.1. check the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; cookie matches all the directory cookies. If yes &lt;span class=&quot;code-keyword&quot;&gt;goto&lt;/span&gt; 2.3.2 &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;goto&lt;/span&gt; 2.4
2.3.2. Read newcookie from zk. If yes all is fine(since we able to read oldcookie in 2.2, delete oldcookie) &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;goto&lt;/span&gt; 2.5 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14150790" author="hadoopqa" created="Sat, 27 Sep 2014 22:57:13 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12671662/011-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;011-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Sat Sep 27 21:20:47 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 929&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/765/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/765/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14150852" author="hadoopqa" created="Sun, 28 Sep 2014 02:27:01 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12671662/011-BOOKKEEPER-773-rename-bookieid.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;011-BOOKKEEPER-773-rename-bookieid.patch&lt;/a&gt; downloaded at Sun Sep 28 00:50:43 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 1 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 929&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/766/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/766/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14151699" author="ikelly" created="Mon, 29 Sep 2014 14:59:28 +0100"  >&lt;p&gt;New patch looks to me. +1 committing.&lt;/p&gt;

&lt;p&gt;One comment (though it&apos;s not worth holding up the patch for). In UpdateCookieCmd#updateBookieIdInCookie is would be clearer to pass two objects, oldConf and newConf, so that you don&apos;t have to keep changing the configuration each time, and so that&apos;s it&apos;s clear which configuration each operation is being performed with. This is easier said than done though. The ServerConfiguration constructor that takes another ServerConfiguration as an argument doesn&apos;t actually copy the keyvalues from the other configuration. So changes on the new conf will also change on the old conf. This is ugly, but seems very hard to fix. Using AbstractConfiguration#append() breaks some another tests. Using AbstractConfiguration#copy() breaks everything. It&apos;s really quite annoying. Not something we need to tackle now though.&lt;/p&gt;</comment>
                            <comment id="14151731" author="ikelly" created="Mon, 29 Sep 2014 15:29:49 +0100"  >&lt;p&gt;Committed r1628193 to trunk. Thanks Rakesh.&lt;/p&gt;</comment>
                            <comment id="14151765" author="hudson" created="Mon, 29 Sep 2014 16:00:49 +0100"  >&lt;p&gt;SUCCESS: Integrated in bookkeeper-trunk #799 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/799/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/799/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-773&quot; title=&quot;Provide admin tool to rename bookie identifier in Cookies&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-773&quot;&gt;&lt;del&gt;BOOKKEEPER-773&lt;/del&gt;&lt;/a&gt;: Provide admin tool to rename bookie identifier in Cookies (rakeshr via ivank) (ivank: rev 1628193)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/UpdateCookieCmdTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14151932" author="rakeshr" created="Mon, 29 Sep 2014 18:33:38 +0100"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ivank%40yahoo-inc.com&quot; class=&quot;user-hover&quot; rel=&quot;ivank@yahoo-inc.com&quot;&gt;Ivan Kelly&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hustlmsp&quot; class=&quot;user-hover&quot; rel=&quot;hustlmsp&quot;&gt;Sijie Guo&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;Flavio Junqueira&lt;/a&gt; for finalizing the solution and reviews.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12657825" name="001-BOOKKEEPER-773-rename-bookieid-in-cookies.patch" size="6141" author="rakeshr" created="Fri, 25 Jul 2014 14:27:17 +0100"/>
                            <attachment id="12658918" name="002-BOOKKEEPER-773-rename-bookieid-in-cookies.patch" size="11635" author="rakeshr" created="Thu, 31 Jul 2014 14:08:23 +0100"/>
                            <attachment id="12659132" name="003-BOOKKEEPER-773-rename-bookieid-in-cookies.patch" size="14606" author="rakeshr" created="Fri, 1 Aug 2014 10:12:02 +0100"/>
                            <attachment id="12667100" name="004-BOOKKEEPER-773-rename-bookieid.patch" size="18835" author="rakeshr" created="Sun, 7 Sep 2014 20:55:06 +0100"/>
                            <attachment id="12667631" name="005-BOOKKEEPER-773-rename-bookieid.patch" size="57390" author="rakeshr" created="Wed, 10 Sep 2014 09:33:35 +0100"/>
                            <attachment id="12668023" name="006-BOOKKEEPER-773-rename-bookieid.patch" size="16039" author="rakeshr" created="Thu, 11 Sep 2014 12:17:16 +0100"/>
                            <attachment id="12669648" name="007-BOOKKEEPER-773-rename-bookieid.patch" size="16672" author="rakeshr" created="Thu, 18 Sep 2014 07:22:00 +0100"/>
                            <attachment id="12669676" name="008-BOOKKEEPER-773-rename-bookieid.patch" size="16619" author="rakeshr" created="Thu, 18 Sep 2014 09:35:30 +0100"/>
                            <attachment id="12670249" name="009-BOOKKEEPER-773-rename-bookieid.patch" size="15304" author="rakeshr" created="Sat, 20 Sep 2014 21:54:13 +0100"/>
                            <attachment id="12670278" name="010-BOOKKEEPER-773-rename-bookieid.patch" size="19723" author="rakeshr" created="Sun, 21 Sep 2014 09:01:59 +0100"/>
                            <attachment id="12671662" name="011-BOOKKEEPER-773-rename-bookieid.patch" size="18573" author="rakeshr" created="Sat, 27 Sep 2014 22:12:40 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 31 Jul 2014 02:30:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407779</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzs0xb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>407788</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>