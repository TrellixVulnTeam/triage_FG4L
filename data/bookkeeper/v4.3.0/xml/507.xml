<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:31:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-507/BOOKKEEPER-507.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-507] Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client).</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-507</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;1) closesub first&lt;br/&gt;
2) sub late&lt;br/&gt;
3) closesub succeed, but response is delayed to client.&lt;br/&gt;
4) since closesub succeed in server side, so sub succeed and tried to deliver message.&lt;br/&gt;
5) sub response is back&lt;br/&gt;
6) client checked and found that there is already a subscriber there.&lt;br/&gt;
7) client failed the subscribe request&lt;br/&gt;
8) but the message would still be delivered to same channel. since the sub state is not be cleared. message is still be received.&lt;br/&gt;
9) closesub response is back.&lt;br/&gt;
10) it clear the subscribe state.&lt;br/&gt;
11) message continue delivering but found there is no subscriber state.&lt;br/&gt;
at step 11) the problem happened.&lt;/p&gt;

&lt;p&gt;this race condition is introduced in multiplexed client (&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-70&quot; title=&quot;reduce or multiplex subscription connections to a hub server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-70&quot;&gt;&lt;del&gt;BOOKKEEPER-70&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12623913">BOOKKEEPER-507</key>
            <summary>Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client).</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hustlmsp">Sijie Guo</assignee>
                                    <reporter username="hustlmsp">Sijie Guo</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Dec 2012 08:55:54 +0000</created>
                <updated>Wed, 13 Feb 2013 15:46:48 +0000</updated>
                            <resolved>Thu, 3 Jan 2013 11:09:07 +0000</resolved>
                                                    <fixVersion>4.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13532171" author="hustlmsp" created="Fri, 14 Dec 2012 09:04:51 +0000"  >&lt;p&gt;although we have queue in hub server to guarantee request for a topic is run in order using queue. &lt;/p&gt;

&lt;p&gt;so for a subscribe/unsubscribe/closesubscription request, it would goes topicmanager -&amp;gt; subscriptionmanager -&amp;gt; deliverymanager in order.&lt;/p&gt;

&lt;p&gt;but for subscribe request, we respond too early before startServingSubscription is executed. so two response are sent out-of-order.&lt;/p&gt;

&lt;p&gt;Attached a draft patch to resolve this issue by sending respond when #startServingSubscription is executed.&lt;/p&gt;

&lt;p&gt;the patch doesn&apos;t include a test case. I would try to add one later.&lt;/p&gt;</comment>
                            <comment id="13540722" author="hustlmsp" created="Sat, 29 Dec 2012 01:56:06 +0000"  >&lt;p&gt;update the patch with a test case.&lt;/p&gt;</comment>
                            <comment id="13540775" author="hadoopqa" created="Sat, 29 Dec 2012 05:25:37 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-507&quot; title=&quot;Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client).&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-507&quot;&gt;&lt;del&gt;BOOKKEEPER-507&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12562636/BOOKKEEPER-507.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-507.diff&lt;/a&gt; downloaded at Sat Dec 29 04:27:00 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 1 line(s) with trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 3 line(s) longer than 120 characters&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt; - patch does not compile, cannot run testcases&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/176/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/176/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13540792" author="hustlmsp" created="Sat, 29 Dec 2012 06:25:59 +0000"  >&lt;p&gt;attach a patch addressing long length lines and trailings.&lt;/p&gt;</comment>
                            <comment id="13540796" author="hadoopqa" created="Sat, 29 Dec 2012 07:00:39 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-507&quot; title=&quot;Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client).&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-507&quot;&gt;&lt;del&gt;BOOKKEEPER-507&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12562650/BOOKKEEPER-507.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-507.diff&lt;/a&gt; downloaded at Sat Dec 29 06:32:07 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 759&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/177/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/177/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13542218" author="ikelly" created="Wed, 2 Jan 2013 16:29:47 +0000"  >&lt;p&gt;Patch looks good. From what I see, the non-callback startServingSubscription method is never called. If this is the case, it should just be removed.&lt;/p&gt;</comment>
                            <comment id="13542225" author="fpj" created="Wed, 2 Jan 2013 16:43:23 +0000"  >&lt;p&gt;Good job, Sijie. This patch is mostly good for me and I just have a few minor comments and questions:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;The test looks very good, but I&apos;m not exactly sure how it guarantees that the first subscription is not cleared up with the asyncCloseSubscription call. Shouldn&apos;t the wakeupLatch.countDown() call come after the closeLatch.await call? If you could clarify, I would appreciate.&lt;/li&gt;
	&lt;li&gt;According to my eclipse configuration, the spacing of the added code in SubscribeHandler is not correct. Could you please check?&lt;/li&gt;
	&lt;li&gt;The await timeouts for the latches are kind of short and on busy machines that might cause some false positives. Should we raise them a bit, to say 5+ seconds?&lt;/li&gt;
	&lt;li&gt;It is unrelated to this patch, but this TODO &quot;// TODO make use of these variables&quot; does not seem to make sense. Should we remove it?&lt;/li&gt;
	&lt;li&gt;To what operation is this comment referring to exactly &quot;// Thread sleep for a while to ensure operation complete&quot;? Should it be &quot;operations&quot; plural instead?&lt;/li&gt;
	&lt;li&gt;I suggest we replace &quot;Should receive the message for a succeed subscriber.&quot; with something like &quot;Message should have been received through successful subscription.&quot;&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13542335" author="hustlmsp" created="Wed, 2 Jan 2013 19:36:50 +0000"  >&lt;p&gt;&amp;gt; the non-callback startServingSubscription method is never called. &lt;/p&gt;

&lt;p&gt;removed.&lt;/p&gt;

&lt;p&gt;&amp;gt; Shouldn&apos;t the wakeupLatch.countDown() call come after the closeLatch.await call?&lt;/p&gt;

&lt;p&gt;closeSub would never succeed until delivery manager thread is waken up to process stopServingSubscriber requests.&lt;/p&gt;

&lt;p&gt;for the original implementation, subscribe responded w/o waiting #startServingSubscription. so when the test case slept delivery thread manager for seconds, the subscribe request responded before close subscription requests. after the delivery manager thread wake up, the close subscription executed and responded, it would clear the state of succeed subscribe request.&lt;/p&gt;

&lt;p&gt;&amp;gt; the spacing of the added code in SubscribeHandler is not correct.&lt;/p&gt;

&lt;p&gt;It seems that it was all 4 spaces indent. Do you mean 8 spaces indent when folding parameters for #startServingSubscription?&lt;/p&gt;

&lt;p&gt;&amp;gt; Should we raise them a bit, to say 5+ seconds&lt;/p&gt;

&lt;p&gt;Increased the timeout of operations to 5 seconds.&lt;/p&gt;

&lt;p&gt;&amp;gt;  but this TODO &quot;// TODO make use of these variables&quot; does not seem to make sense&lt;/p&gt;

&lt;p&gt;I am not sure about this &quot;TODO&quot;, seems that it existed for a long time. And it doesn&apos;t make any sense now. just remove it.&lt;/p&gt;

&lt;p&gt;&amp;gt; To what operation is this comment referring to exactly&lt;/p&gt;

&lt;p&gt;refactor the comments.&lt;/p&gt;

&lt;p&gt;&amp;gt; &quot;Should receive the message for a succeed subscriber.&quot;&lt;/p&gt;

&lt;p&gt;made the change as the suggestion.&lt;/p&gt;</comment>
                            <comment id="13542338" author="hustlmsp" created="Wed, 2 Jan 2013 19:37:23 +0000"  >&lt;p&gt;resubmit it with a new patch.&lt;/p&gt;</comment>
                            <comment id="13542368" author="hadoopqa" created="Wed, 2 Jan 2013 20:09:47 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-507&quot; title=&quot;Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client).&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-507&quot;&gt;&lt;del&gt;BOOKKEEPER-507&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12562946/BOOKKEEPER-507.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-507.diff&lt;/a&gt; downloaded at Wed Jan  2 19:41:12 UTC 2013&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 759&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/188/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/188/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13542482" author="fpj" created="Wed, 2 Jan 2013 22:17:53 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do you mean 8 spaces indent when folding parameters for #startServingSubscription?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It is in the body of operationFinished. I haven&apos;t checked, but I think the extra spaces are still there.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Increased the timeout of operations to 5 seconds.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Should we also raise the timeout of &quot;subLatch.await(1, TimeUnit.SECONDS));&quot; to be consistent? &lt;/p&gt;

&lt;p&gt;If you agree with these small changes, they can be implemented upon committing, I don&apos;t think it is necessary to generate a new patch.&lt;/p&gt;

</comment>
                            <comment id="13542643" author="hustlmsp" created="Thu, 3 Jan 2013 01:39:16 +0000"  >&lt;p&gt;I am OK with these small changes to be fixed upon committing. thanks Flavio.&lt;/p&gt;</comment>
                            <comment id="13542855" author="ikelly" created="Thu, 3 Jan 2013 11:05:47 +0000"  >&lt;p&gt;New patch lgtm, committing. +1&lt;/p&gt;</comment>
                            <comment id="13542858" author="ikelly" created="Thu, 3 Jan 2013 11:09:07 +0000"  >&lt;p&gt;Committed as r1428277. Thanks Sijie.&lt;/p&gt;</comment>
                            <comment id="13542877" author="fpj" created="Thu, 3 Jan 2013 11:44:06 +0000"  >&lt;p&gt;Have you made the changes suggested above, Ivan?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-507?focusedCommentId=13542482&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13542482&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/BOOKKEEPER-507?focusedCommentId=13542482&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13542482&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Never mind, I checked the commit message and I can see you did it. Thanks a lot!&lt;/p&gt;</comment>
                            <comment id="13542883" author="hudson" created="Thu, 3 Jan 2013 12:12:56 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk2 #26 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk2/26/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk2/26/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-507&quot; title=&quot;Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client).&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-507&quot;&gt;&lt;del&gt;BOOKKEEPER-507&lt;/del&gt;&lt;/a&gt;: Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client). (sijie via ivank) (Revision 1428277)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/delivery/DeliveryManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/delivery/FIFODeliveryManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/handlers/SubscribeHandler.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/client/TestSubAfterCloseSub.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/server/delivery/StubDeliveryManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13543892" author="hudson" created="Fri, 4 Jan 2013 13:58:20 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk2 #31 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk2/31/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk2/31/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-507&quot; title=&quot;Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client).&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-507&quot;&gt;&lt;del&gt;BOOKKEEPER-507&lt;/del&gt;&lt;/a&gt;: Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client). (sijie via ivank) (Revision 1428277)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/delivery/DeliveryManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/delivery/FIFODeliveryManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/handlers/SubscribeHandler.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/client/TestSubAfterCloseSub.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/server/delivery/StubDeliveryManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13543935" author="hudson" created="Fri, 4 Jan 2013 15:08:44 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk2 #33 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk2/33/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk2/33/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-507&quot; title=&quot;Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client).&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-507&quot;&gt;&lt;del&gt;BOOKKEEPER-507&lt;/del&gt;&lt;/a&gt;: Race condition happens if closeSubscription and subscribe happened at the same time (in multiplexed client). (sijie via ivank) (Revision 1428277)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/delivery/DeliveryManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/delivery/FIFODeliveryManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/handlers/SubscribeHandler.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/client/TestSubAfterCloseSub.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/server/delivery/StubDeliveryManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12562946" name="BOOKKEEPER-507.diff" size="20425" author="hustlmsp" created="Wed, 2 Jan 2013 19:36:50 +0000"/>
                            <attachment id="12562650" name="BOOKKEEPER-507.diff" size="19184" author="hustlmsp" created="Sat, 29 Dec 2012 06:25:59 +0000"/>
                            <attachment id="12562636" name="BOOKKEEPER-507.diff" size="19107" author="hustlmsp" created="Sat, 29 Dec 2012 01:56:06 +0000"/>
                            <attachment id="12560932" name="subscribeshouldrespondafterstartserving.patch" size="10408" author="hustlmsp" created="Fri, 14 Dec 2012 09:04:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 29 Dec 2012 05:25:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>297811</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hyypyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236548</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>