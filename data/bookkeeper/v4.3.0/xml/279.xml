<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:26:12 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-279/BOOKKEEPER-279.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-279] LocalBookKeeper is failing intermittently due to zkclient connection establishment delay</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-279</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;LocalBookKeeper is initializing the zkclient and immediately trying to create &quot;/ledgers&quot; and &quot;/ledgers/available&quot; znodes without waiting for the ZooKeeper SyncConnected state. The client operation should be guarded with ZKConnectionWatcher.&lt;/p&gt;

&lt;p&gt;LocalBookKeeper.java&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;zkc = new ZooKeeper(&quot;127.0.0.1&quot;, ZooKeeperDefaultPort, new emptyWatcher());
/*	User for testing purposes, void */
static class emptyWatcher implements Watcher {
public void process(WatchedEvent event) {}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12558760">BOOKKEEPER-279</key>
            <summary>LocalBookKeeper is failing intermittently due to zkclient connection establishment delay</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rakeshr">Rakesh R</assignee>
                                    <reporter username="rakeshr">Rakesh R</reporter>
                        <labels>
                    </labels>
                <created>Thu, 31 May 2012 12:25:43 +0100</created>
                <updated>Mon, 14 Jan 2013 16:11:48 +0000</updated>
                            <resolved>Tue, 5 Jun 2012 07:57:08 +0100</resolved>
                                    <version>4.0.0</version>
                                    <fixVersion>4.1.0</fixVersion>
                                    <component>bookkeeper-client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13286515" author="rakeshr" created="Thu, 31 May 2012 13:04:23 +0100"  >&lt;p&gt;Attached the patch. Didnot include any test case as the zk instance is not visible. Appreciate any ideas&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Also, I have corrected the sessiontimeout parameter in the patch.&lt;/p&gt;</comment>
                            <comment id="13286658" author="hustlmsp" created="Thu, 31 May 2012 16:30:53 +0100"  >&lt;p&gt;the patch seems good to me. just one comment.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
-            zkc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ZooKeeper(&lt;span class=&quot;code-quote&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;, ZooKeeperDefaultPort, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; emptyWatcher());
+            CountdownWatcher zkConnectionWatcher = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CountdownWatcher();
+            zkc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ZooKeeper(&lt;span class=&quot;code-quote&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;, zkSessionTimeOut,
+                    zkConnectionWatcher);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;from my knowledge, if user doesn&apos;t specify zookeeper port in connect string, it would use default port to connect. so if I changed ZooKeeperDefaultPort, the ZooKeeper instance would not work probably. So why not append ZooKeeperDefaultPort after &apos;127.0.0.1&apos;?&lt;/p&gt;
</comment>
                            <comment id="13286669" author="rakeshr" created="Thu, 31 May 2012 16:43:16 +0100"  >&lt;p&gt;Thanks Sijie. Updated the patch by fixing the comment. Since ZooKeeperDefaultPort is always 2181, I have reused the HOSTPORT=&apos;127.0.0.1:2181&apos; as connectstring.&lt;/p&gt;</comment>
                            <comment id="13287120" author="hustlmsp" created="Fri, 1 Jun 2012 04:16:03 +0100"  >&lt;p&gt;oh, I just noticed that the jira is marked as 4.1.0. But I have cut a release 4.1.0 before this jira.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;Rakesh R&lt;/a&gt; I would suggest moving it into 4.2.0. Is it OK for me?&lt;/p&gt;</comment>
                            <comment id="13287204" author="rakeshr" created="Fri, 1 Jun 2012 07:03:04 +0100"  >&lt;p&gt;Since you already cut the branch and not a blocker issue, agree moving to 4.2.0 version. If you have chance to do one more RC, then will include this also. I&apos;ll manage internally this.&lt;/p&gt;</comment>
                            <comment id="13287214" author="fpj" created="Fri, 1 Jun 2012 08:03:17 +0100"  >&lt;p&gt;Assuming the vote on the current release candidate passes, one option is to have a bug fix release 4.1.1 that includes this issue rather than wait until 4.2.0.&lt;/p&gt;</comment>
                            <comment id="13287217" author="umamaheswararao" created="Fri, 1 Jun 2012 08:09:17 +0100"  >&lt;blockquote&gt;
&lt;p&gt;Assuming the vote on the current release candidate passes, one option is to have a bug fix release 4.1.1 that includes this issue rather than wait until 4.2.0.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;+1, we can include this in 4.1.1, Until we did not find any blockers in this RC.&lt;/p&gt;</comment>
                            <comment id="13287305" author="hustlmsp" created="Fri, 1 Jun 2012 10:57:22 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;Rakesh R&lt;/a&gt; the patch introduced junit package in LocalBookKeeper. but junit package scope is just for testing. It would be better to remove junit-related staffs from LocalBookKeeper.&lt;/p&gt;</comment>
                            <comment id="13287309" author="hustlmsp" created="Fri, 1 Jun 2012 10:58:52 +0100"  >&lt;p&gt;cancel the patch until fix junit issue.&lt;/p&gt;</comment>
                            <comment id="13287317" author="rakeshr" created="Fri, 1 Jun 2012 11:33:24 +0100"  >&lt;p&gt;Oh! thats correct. Thanks Sijie. Attached latest patch by addressing Sijie comment.&lt;br/&gt;
Please review.&lt;/p&gt;</comment>
                            <comment id="13288079" author="hustlmsp" created="Sun, 3 Jun 2012 06:44:58 +0100"  >&lt;p&gt;the patch looks good to me, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rakeshr&quot; class=&quot;user-hover&quot; rel=&quot;rakeshr&quot;&gt;Rakesh R&lt;/a&gt;. +1&lt;/p&gt;</comment>
                            <comment id="13289200" author="hustlmsp" created="Tue, 5 Jun 2012 07:57:08 +0100"  >&lt;p&gt;committed as r1346257 in trunk, r1346258 in branch 4.1.&lt;/p&gt;

&lt;p&gt;Thanks Rakesh.&lt;/p&gt;</comment>
                            <comment id="13289204" author="hudson" created="Tue, 5 Jun 2012 08:16:41 +0100"  >&lt;p&gt;Integrated in bookkeeper-trunk #544 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/544/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/544/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-279&quot; title=&quot;LocalBookKeeper is failing intermittently due to zkclient connection establishment delay&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-279&quot;&gt;&lt;del&gt;BOOKKEEPER-279&lt;/del&gt;&lt;/a&gt;: LocalBookKeeper is failing intermittently due to zkclient connection establishment delay (Rakesh R via sijie) (Revision 1346257)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
sijie : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12530402" name="BOOKKEEPER-279.1.patch" size="3627" author="rakeshr" created="Thu, 31 May 2012 16:43:16 +0100"/>
                            <attachment id="12530532" name="BOOKKEEPER-279.2.patch" size="4190" author="rakeshr" created="Fri, 1 Jun 2012 11:33:24 +0100"/>
                            <attachment id="12530380" name="BOOKKEEPER-279.patch" size="3630" author="rakeshr" created="Thu, 31 May 2012 13:04:23 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 31 May 2012 15:30:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>250356</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4sd3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61751</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>