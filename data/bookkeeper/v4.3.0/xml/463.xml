<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:31:20 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-463/BOOKKEEPER-463.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-463] Refactor garbage collection code for ease to plugin different GC algorithm.</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-463</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description></description>
                <environment></environment>
        <key id="12615714">BOOKKEEPER-463</key>
            <summary>Refactor garbage collection code for ease to plugin different GC algorithm.</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12554600">BOOKKEEPER-249</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="lvfangmin">Fangmin Lv</assignee>
                                    <reporter username="hustlmsp">Sijie Guo</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Nov 2012 12:39:29 +0000</created>
                <updated>Thu, 2 May 2013 03:29:58 +0100</updated>
                            <resolved>Mon, 24 Dec 2012 04:51:17 +0000</resolved>
                                                    <fixVersion>4.2.0</fixVersion>
                                    <component>bookkeeper-server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13501162" author="lvfangmin" created="Tue, 20 Nov 2012 13:03:26 +0000"  >&lt;p&gt;Attach a patch to implement this, main changes:&lt;/p&gt;

&lt;p&gt;1. Refactor Garbage Collector Interface&lt;br/&gt;
2. Change LedgerManager#deleteLedger to versioned delete&lt;br/&gt;
3. Remove ActiveLedgerManager interface&lt;br/&gt;
4. Move some common functions to StringUtils and ZkUtils &lt;/p&gt;</comment>
                            <comment id="13501295" author="yx3zhu@gmail.com" created="Tue, 20 Nov 2012 16:50:50 +0000"  >&lt;p&gt;The patch to &apos;bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollector.java&apos; didn&apos;t apply cleanly.&lt;/p&gt;</comment>
                            <comment id="13501665" author="lvfangmin" created="Wed, 21 Nov 2012 02:27:02 +0000"  >&lt;p&gt;@Yixue&lt;br/&gt;
Thanks for your command, I have reupload the diff file.&lt;/p&gt;</comment>
                            <comment id="13504368" author="hustlmsp" created="Tue, 27 Nov 2012 04:34:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lvfangmin&quot; class=&quot;user-hover&quot; rel=&quot;lvfangmin&quot;&gt;Fangmin Lv&lt;/a&gt; The patch looks good. I had some minor comments, mostly about naming and interface. I posted them on review board. please check.&lt;/p&gt;</comment>
                            <comment id="13504380" author="lvfangmin" created="Tue, 27 Nov 2012 05:23:54 +0000"  >&lt;p&gt;Thanks sijie, I will reply on the code review board and change the name according to your advice.&lt;/p&gt;</comment>
                            <comment id="13504534" author="hadoopqa" created="Tue, 27 Nov 2012 11:04:27 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WARNING: Running test-patch on a dirty local svn workspace&lt;/p&gt;

&lt;p&gt;Patch &amp;lt;a href=&quot;/jira/secure/attachment/12554448/&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;.patch&quot;&amp;gt;/jira/secure/attachment/12554448/&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;.patch&amp;lt;/a&amp;gt; downloaded at Tue Nov 27 10:43:23 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 1 line(s) longer than 120 characters&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;WARNING&lt;/font&gt;: the current HEAD has 8 Javadoc warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;WARNING&lt;/font&gt;: the current HEAD has 9 javac warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;WARNING: the current HEAD has  Findbugs warning(s), they should be addressed ASAP&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 389&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;.   There is at least one warning, please check&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/23/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/23/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13505156" author="hustlmsp" created="Wed, 28 Nov 2012 01:49:27 +0000"  >&lt;p&gt;I would suggest this jira should go for 4.2.0, since I think it introduced a cleaner interface for the implementation of LedgerManager. we need to provide documentation of LedgerManager for BookKeeper and MetadataManager for Hedwig in &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-341&quot; title=&quot;add documentation for bookkeeper ledger manager interface.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-341&quot;&gt;&lt;del&gt;BOOKKEEPER-341&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-342&quot; title=&quot;add documentation for hedwig metadata manager interface.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-342&quot;&gt;&lt;del&gt;BOOKKEEPER-342&lt;/del&gt;&lt;/a&gt; before rolling out 4.2.0 release, it would be a good idea to provide a cleaner interface for 4.2.0.&lt;/p&gt;</comment>
                            <comment id="13506274" author="lvfangmin" created="Thu, 29 Nov 2012 07:07:14 +0000"  >&lt;p&gt;Provide a new patch according to Sijie and Flavio&apos;s suggestion.&lt;/p&gt;</comment>
                            <comment id="13507069" author="lvfangmin" created="Fri, 30 Nov 2012 03:40:14 +0000"  >&lt;p&gt;Reattach a file, changes:&lt;br/&gt;
1. Correct comments about ScanAndCompareGarbageCollector&lt;br/&gt;
2. Throw  NoSuchElementException if have no more elements when call next.&lt;/p&gt;</comment>
                            <comment id="13507146" author="lvfangmin" created="Fri, 30 Nov 2012 07:02:06 +0000"  >&lt;p&gt;Fix empty global active ledgers scenario.&lt;/p&gt;</comment>
                            <comment id="13507176" author="hadoopqa" created="Fri, 30 Nov 2012 07:54:56 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WARNING: Running test-patch on a dirty local svn workspace&lt;/p&gt;

&lt;p&gt;Patch &amp;lt;a href=&quot;/jira/secure/attachment/12555476/&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;.patch&quot;&amp;gt;/jira/secure/attachment/12555476/&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;.patch&amp;lt;/a&amp;gt; downloaded at Fri Nov 30 07:30:35 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 1 line(s) with trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;WARNING: the current HEAD has  Findbugs warning(s), they should be addressed ASAP&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 383&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;.   There is at least one warning, please check&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/55/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/55/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13508461" author="hustlmsp" created="Mon, 3 Dec 2012 04:28:54 +0000"  >&lt;p&gt;I think this refactor could be done in 4.2.0 to provide a cleaner ledger manager interface. so I marked this jira to 4.2.0. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;Flavio Junqueira&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ikelly&quot; class=&quot;user-hover&quot; rel=&quot;ikelly&quot;&gt;Ivan Kelly&lt;/a&gt; could any of you take a look at Fangmin&apos;s patch on &lt;a href=&quot;https://reviews.apache.org/r/8141/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/8141/&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="13508462" author="hustlmsp" created="Mon, 3 Dec 2012 04:29:33 +0000"  >&lt;p&gt;After this jira, I would generate the documentation patches for both bookkeeper and hedwig&apos;s metadata manager.&lt;/p&gt;</comment>
                            <comment id="13508824" author="ikelly" created="Mon, 3 Dec 2012 16:08:29 +0000"  >&lt;p&gt;I really like this change. It simplifies things a lot. I&apos;ve a few comments on review board.&lt;/p&gt;</comment>
                            <comment id="13510409" author="lvfangmin" created="Wed, 5 Dec 2012 10:29:00 +0000"  >&lt;p&gt;Upload a new patch to remove:&lt;/p&gt;

&lt;p&gt;1.unused SnapshotMap in AbstractZKLedgerManager&lt;br/&gt;
2.trailing spaces &lt;/p&gt;
</comment>
                            <comment id="13510929" author="hadoopqa" created="Wed, 5 Dec 2012 23:42:26 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12556086/BOOKKEEPER-463.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-463.patch&lt;/a&gt; downloaded at Wed Dec  5 23:22:15 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 393&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/75/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/75/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13527854" author="ikelly" created="Mon, 10 Dec 2012 10:19:58 +0000"  >&lt;p&gt;Commented again in review board.&lt;/p&gt;</comment>
                            <comment id="13529390" author="lvfangmin" created="Tue, 11 Dec 2012 22:14:39 +0000"  >&lt;p&gt;Attach a new patch according to Ivan&apos;s comments, changes:&lt;/p&gt;

&lt;p&gt;1. Use tailMap instead of subMap when there is no end limit.&lt;br/&gt;
2. Wrap exception according to Ivan&apos;s comments.&lt;/p&gt;</comment>
                            <comment id="13529493" author="hadoopqa" created="Tue, 11 Dec 2012 23:54:33 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12560461/BOOKKEEPER-463.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-463.patch&lt;/a&gt; downloaded at Tue Dec 11 23:52:01 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; Patch failed to apply to head of branch&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;</comment>
                            <comment id="13529632" author="hustlmsp" created="Wed, 12 Dec 2012 05:38:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lvfangmin&quot; class=&quot;user-hover&quot; rel=&quot;lvfangmin&quot;&gt;Fangmin Lv&lt;/a&gt; seems that the latest patch doesn&apos;t apply to the latest trank branch. Could you take a look at it when you had time?&lt;/p&gt;</comment>
                            <comment id="13529651" author="lvfangmin" created="Wed, 12 Dec 2012 06:09:33 +0000"  >&lt;p&gt;Thanks sijie, I will rebase on the new trunk and upload the patch again.&lt;/p&gt;</comment>
                            <comment id="13529717" author="hustlmsp" created="Wed, 12 Dec 2012 07:44:53 +0000"  >&lt;p&gt;one minor comment about this patch. I found it when writing the document for bookkeeper metadata management.&lt;/p&gt;

&lt;blockquote&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {@link BKException.Code.ZKException}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; is returned when can&apos;t generate or extract new&lt;br/&gt;
+     *        ledger id issues happen&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I saw &apos;BKException.Code.ZKException&apos; added for each interface&apos;s comment in LedgerManager. for a zookeeper based implementation, it throws ZKException might be make sense. for other implementation, it doesn&apos;t make sense. I suppose we should throw a more generic like MetadataStoreException to indicate it was failures from metadata store.&lt;/p&gt;

&lt;p&gt;Could you help confirmed what kind of exception it thrown in zookeeper-based implementation and the callers of LedgerManager how they interpreted the exceptions?&lt;/p&gt;</comment>
                            <comment id="13529765" author="lvfangmin" created="Wed, 12 Dec 2012 08:59:19 +0000"  >&lt;p&gt;Ok, I will follow up what you&apos;re concerned and will remove the ZKException if we do not need some complicated changes.&lt;/p&gt;</comment>
                            <comment id="13529968" author="lvfangmin" created="Wed, 12 Dec 2012 14:16:50 +0000"  >&lt;p&gt;Hi sijie, actually the metastore based ledger manager in jira &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-205&quot; title=&quot;implement a MetaStore based ledger manager for bookkeeper client.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-205&quot;&gt;&lt;del&gt;BOOKKEEPER-205&lt;/del&gt;&lt;/a&gt; have not be in yet, the current trunk only have zk based ledger manager, so I&apos;m concern whether we need to consider it here or delay the comment change after &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-205&quot; title=&quot;implement a MetaStore based ledger manager for bookkeeper client.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-205&quot;&gt;&lt;del&gt;BOOKKEEPER-205&lt;/del&gt;&lt;/a&gt; in? &lt;/p&gt;</comment>
                            <comment id="13530014" author="fpj" created="Wed, 12 Dec 2012 15:09:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lvfangmin&quot; class=&quot;user-hover&quot; rel=&quot;lvfangmin&quot;&gt;Fangmin Lv&lt;/a&gt; You may have missed it, but &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-205&quot; title=&quot;implement a MetaStore based ledger manager for bookkeeper client.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-205&quot;&gt;&lt;del&gt;BOOKKEEPER-205&lt;/del&gt;&lt;/a&gt; got in earlier today.&lt;/p&gt;</comment>
                            <comment id="13531200" author="ikelly" created="Thu, 13 Dec 2012 17:17:01 +0000"  >&lt;p&gt;Cancelling patch until it gets rebased on &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-205&quot; title=&quot;implement a MetaStore based ledger manager for bookkeeper client.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-205&quot;&gt;&lt;del&gt;BOOKKEEPER-205&lt;/del&gt;&lt;/a&gt; changes.&lt;/p&gt;</comment>
                            <comment id="13532263" author="ikelly" created="Fri, 14 Dec 2012 12:16:42 +0000"  >&lt;p&gt;I&apos;ve rebased this onto trunk. It would good if both &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lvfangmin&quot; class=&quot;user-hover&quot; rel=&quot;lvfangmin&quot;&gt;Fangmin Lv&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jiannan&quot; class=&quot;user-hover&quot; rel=&quot;jiannan&quot;&gt;Jiannan Wang&lt;/a&gt; could take a look, as it modifies the MSLedgerManagerFactory.&lt;/p&gt;</comment>
                            <comment id="13532284" author="jiannan" created="Fri, 14 Dec 2012 12:58:42 +0000"  >&lt;p&gt;Okay, I&apos;ll have a look the patch.&lt;/p&gt;</comment>
                            <comment id="13532318" author="hadoopqa" created="Fri, 14 Dec 2012 14:12:37 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12560961/0001-BOOKKEEPER-463-Refactor-garbage-collection-code-for-.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;0001-BOOKKEEPER-463-Refactor-garbage-collection-code-for-.patch&lt;/a&gt; downloaded at Fri Dec 14 13:51:30 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 1 line(s) with trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;WARNING: the current HEAD has  Findbugs warning(s), they should be addressed ASAP&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 496&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;.   There is at least one warning, please check&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/118/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/118/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13534909" author="fpj" created="Tue, 18 Dec 2012 14:08:05 +0000"  >&lt;p&gt;Here are some comments and questions about this patch:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;ScanAndCompareGarbageCollector.java. &quot;to find those ledgers aren&apos;t existed&quot; -&amp;gt; &quot;to find the ledgers that aren&apos;t in&quot;&lt;/li&gt;
	&lt;li&gt;ScanAndCompareGarbageCollector.java. Is it possible that ledgerManager.getLedgerRanges(); returns an empty iterator in the case of an error? I&apos;m worried that this block &quot;if (!ledgerRangeIterator.hasNext())...&quot; could end up deleting all active ledgers by mistake&quot;.&lt;/li&gt;
	&lt;li&gt;removeLedgerMetadata. There are two cases in which we return BKException.Code.MetadataVersionException and we don&apos;t give any more information. It would be good to give a better hint on what the actual error was.&lt;/li&gt;
	&lt;li&gt;HierarchicalLedgerManager.java. &quot;failed to get children list of a too big znode during garbage collection.&quot; -&amp;gt; &quot;errors during garbage collection due to lists of children that are too long.&quot;&lt;/li&gt;
	&lt;li&gt;LedgerManager.java. This sentence is broken:
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;+ * {@link BKException.Code.ZKException} is returned when can&apos;t generate or extract new
+ * ledger id issues happen
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should we remove &quot;issues happen&quot;?&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;There are several instances of &quot;is returned&quot;. Should we just say instead &quot;returned&quot; or change the wording so that we can switch to active voice?&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;There is one general naive question I have and it is related to this patch. We have both a meta package and metastore package. ZooKeeper is used in the meta package, but not in the metastore package. Isn&apos;t ZK an option to store ledger metadata? I suppose that the rationale is that the metastore package is really for database-like stores, and excludes options like ZooKeeper.&lt;/p&gt;</comment>
                            <comment id="13535688" author="hustlmsp" created="Wed, 19 Dec 2012 06:01:33 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
We have both a meta &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; and metastore &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;. ZooKeeper is used in the meta &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;, but not in the metastore &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;meta package is used to manage all bookkeeper related metadata, while metastore package is supposed to provided a common metadata storage interface for both bookkeeper meta and hedwig meta management. A better structure is that version package and metastore package could be moved to a generic module, something like &apos;bookkeeper-common&apos;. bookkeeper-server and hedwig-server use &apos;bookkeeper-common&apos; module.&lt;/p&gt;

&lt;p&gt;for ZooKeeper, it is because we have ZooKeeper implementation before metastore interface. so we have ZooKeeper specific implementation in the meta package under bookkeeper and hedwig. I think we could implement ZooKeeper based metadata storage using metastore interface (but maybe not, need to try) in future to make code base clearly.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; for the comments&lt;/p&gt;

&lt;p&gt;I think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lvfangmin&quot; class=&quot;user-hover&quot; rel=&quot;lvfangmin&quot;&gt;Fangmin Lv&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jiannan&quot; class=&quot;user-hover&quot; rel=&quot;jiannan&quot;&gt;Jiannan Wang&lt;/a&gt; might not have time looking at this recently. so &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ikelly&quot; class=&quot;user-hover&quot; rel=&quot;ikelly&quot;&gt;Ivan Kelly&lt;/a&gt; Could you help addressing the comments, since the latest patch is rebased by you &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13535847" author="fpj" created="Wed, 19 Dec 2012 10:19:15 +0000"  >&lt;p&gt;Most of my comments were just fixing the wording of comments in the patch and I can actually take care of them if you&apos;d like. There are three other comments that are not about wording. Sijie has responded to one of them, the one about the packages and it sounds like we could consider it moving forward (should we create a jira for it?). The other two are the following:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;ScanAndCompareGarbageCollector.java. Is it possible that ledgerManager.getLedgerRanges(); returns an empty iterator in the case of an error? I&apos;m worried that this block &quot;if (!ledgerRangeIterator.hasNext())...&quot; could end up deleting all active ledgers by mistake&quot;.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I had a look at the code and it sounds like in the case that we have an error in the ledger manager, we can have an NPE, but not delete active ledgers accidentally. In particular, looking at FlatLedgerManager#getLedgerRanges, I observed the following.Say that getChildrenInSingleNode returns a null pointer for the children list. I believe ledgerListToSet will throw an exception (NPE) when trying to execute the for loop.&lt;/p&gt;

&lt;p&gt;Perhaps what we should do is check if ledgerNodes is null in ledgerListToSet and return null in this case. If zkActiveLedgers is null, then we throw an IOException. In general, the problem I see with this approach is that it is hard to guarantee that all implementations of LedgerManager#getLedgerRanges will do the right thing.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;removeLedgerMetadata. There are two cases in which we return BKException.Code.MetadataVersionException and we don&apos;t give any more information. It would be good to give a better hint on what the actual error was.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The two solutions I see here are to have different error codes or to log different messages. Logging different messages seems simpler.&lt;/p&gt;</comment>
                            <comment id="13536852" author="hustlmsp" created="Thu, 20 Dec 2012 07:58:13 +0000"  >&lt;p&gt;1. Created &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-521&quot; title=&quot;Move metastore and versioning package to bookkeeper-common module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-521&quot;&gt;BOOKKEEPER-521&lt;/a&gt; tracking the issue.&lt;/p&gt;

&lt;p&gt;2. getChildrenInSingleNode will not return null. an exception is thrown when it failed to fetch entries from ZooKeeper.&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; In general, the problem I see with this approach is that it is hard to guarantee that all implementations of LedgerManager#getLedgerRanges will do the right thing.&lt;/p&gt;

&lt;p&gt;for most of interfaces, you could not guarantee the right implementation. so the implementation of this interface should take care of it, right?&lt;/p&gt;

&lt;p&gt;3. removeLedgerMetadata. for two cases, they are same, using a wrong version. so different messages would be better.&lt;/p&gt;</comment>
                            <comment id="13538271" author="fpj" created="Fri, 21 Dec 2012 18:22:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;for most of interfaces, you could not guarantee the right implementation. so the implementation of this interface should take care of it, right?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sure, but this case is particularly critical because not throwing an exception could end up deleting all your ledgers accidentally.&lt;/p&gt;</comment>
                            <comment id="13538296" author="hustlmsp" created="Fri, 21 Dec 2012 18:51:34 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Say that getChildrenInSingleNode returns a null pointer for the children list. I believe ledgerListToSet will throw an exception (NPE) when trying to execute the for loop.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Clarify the concern here. getChildrenInSingleNode would thrown an IOException when failed to fetch list from ZooKeeper. so no null list would be passed to ledgerListToSet, no NPE.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; getChildrenInSingleNode(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ZooKeeper zk, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; node)
+            &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; InterruptedException, IOException {
+        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; GetChildrenCtx ctx = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GetChildrenCtx();
+        getChildrenInSingleNode(zk, node, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericCallback&amp;lt;List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt;() {
+            @Override
+            &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void operationComplete(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; rc, List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; ledgers) {
+                &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (ctx) {
+                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Code.OK.intValue() == rc) {
+                        ctx.children = ledgers;
+                    }
+                    ctx.rc = rc;
+                    ctx.done = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+                    ctx.notifyAll();
+                }
+            }
+        });
+
+        &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (ctx) {
+            &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (ctx.done == &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;) {
+                ctx.wait();
+            }
+        }
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Code.OK.intValue() != ctx.rc) {
+            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IOException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error on getting children from node &quot;&lt;/span&gt; + node);
+        }
+        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; ctx.children;
+
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="13538299" author="hustlmsp" created="Fri, 21 Dec 2012 18:56:41 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Sure, but this case is particularly critical because not throwing an exception could end up deleting all your ledgers accidentally.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;for the concern about a bad implementation end up deleting all ledgers. I think we need to make the documentation of this interface more clearly. I refactor the interface comments as below:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    /**
+     * Interface of the ledger meta range iterator from
+     * storage (e.g. in ZooKeeper or other key/value store)
+     */
+    &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; LedgerRangeIterator {
+
+        /**
+         * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; there are entries existed in ledger metadata store. &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; only when there
+         * are indeed no entries in ledger metadata store.
+         * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException when there is any problem accessing ledger metadata store. you should
+         * not just &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; and silence the problem fail to access ledger metadata store. otherwise
+         * it would end up deleting all ledgers by accident.
+         */
+        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; hasNext() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException;
+
+        /**
+         * Get the next element.
+         *
+         * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the next element.
+         * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException when there is any problem accessing ledger metadata store. you should
+         * not just &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; and silence the problem fail to access ledger metadata store. otherwise
+         * it would end up deleting all ledgers by accident.
+         */
+        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; LedgerRange next() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException;
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13538525" author="fpj" created="Fri, 21 Dec 2012 23:17:47 +0000"  >&lt;p&gt;I&apos;ve tried to implement all modifications I felt were needed. I also added the comments sijie suggested.&lt;/p&gt;</comment>
                            <comment id="13538546" author="hadoopqa" created="Fri, 21 Dec 2012 23:43:50 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12562174/BOOKKEEPER-463.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-463.patch&lt;/a&gt; downloaded at Fri Dec 21 23:22:10 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch contains 9 line(s) with trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 505&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/167/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/167/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13538617" author="fpj" created="Sat, 22 Dec 2012 01:18:00 +0000"  >&lt;p&gt;Removed trailing spaces.&lt;/p&gt;</comment>
                            <comment id="13538675" author="hadoopqa" created="Sat, 22 Dec 2012 05:18:03 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12562197/BOOKKEEPER-463.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-463.patch&lt;/a&gt; downloaded at Sat Dec 22 04:56:27 UTC 2012&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 505&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/168/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/168/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13538704" author="fpj" created="Sat, 22 Dec 2012 09:13:18 +0000"  >&lt;p&gt;great, all trailing spaces are really gone. if I can get a +1 perhaps we can commit this one.&lt;/p&gt;</comment>
                            <comment id="13539185" author="hustlmsp" created="Mon, 24 Dec 2012 04:48:49 +0000"  >&lt;p&gt;looks good to me. +1. will commit it.&lt;/p&gt;</comment>
                            <comment id="13539186" author="hustlmsp" created="Mon, 24 Dec 2012 04:51:17 +0000"  >&lt;p&gt;committed as r1425585. thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lvfangmin&quot; class=&quot;user-hover&quot; rel=&quot;lvfangmin&quot;&gt;Fangmin Lv&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ikelly&quot; class=&quot;user-hover&quot; rel=&quot;ikelly&quot;&gt;Ivan Kelly&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fpj&quot; class=&quot;user-hover&quot; rel=&quot;fpj&quot;&gt;Flavio Junqueira&lt;/a&gt; for working on this patch. after this patch, it might be easy to adapt different gc algorithm.&lt;/p&gt;</comment>
                            <comment id="13539221" author="hudson" created="Mon, 24 Dec 2012 09:15:20 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk2 #8 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk2/8/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk2/8/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-463&quot; title=&quot;Refactor garbage collection code for ease to plugin different GC algorithm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-463&quot;&gt;&lt;del&gt;BOOKKEEPER-463&lt;/del&gt;&lt;/a&gt;: Refactor garbage collection code for ease to plugin different GC algorithm. (Fangmin, ivank, fpj via sijie) (Revision 1425585)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
sijie : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Bookie.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollector.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerCacheImpl.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ScanAndCompareGarbageCollector.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerDeleteOp.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ActiveLedgerManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManagerFactory.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/HierarchicalLedgerManagerFactory.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerManagerFactory.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/SnapshotMap.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SnapshotMap.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/StringUtils.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/LedgerCacheTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/GcLedgersTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/meta/LedgerManagerTestCase.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13539257" author="lvfangmin" created="Mon, 24 Dec 2012 12:29:58 +0000"  >&lt;p&gt;@Flavio, @Ivan, @Sijie&lt;br/&gt;
Really appreciate for moving this on, sorry for late reply.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12615715">BOOKKEEPER-464</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12560961" name="0001-BOOKKEEPER-463-Refactor-garbage-collection-code-for-.patch" size="101953" author="ikelly" created="Fri, 14 Dec 2012 12:16:42 +0000"/>
                            <attachment id="12562197" name="BOOKKEEPER-463.patch" size="96429" author="fpj" created="Sat, 22 Dec 2012 01:18:00 +0000"/>
                            <attachment id="12562174" name="BOOKKEEPER-463.patch" size="96451" author="fpj" created="Fri, 21 Dec 2012 23:17:47 +0000"/>
                            <attachment id="12560461" name="BOOKKEEPER-463.patch" size="85895" author="lvfangmin" created="Tue, 11 Dec 2012 22:14:39 +0000"/>
                            <attachment id="12556086" name="BOOKKEEPER-463.patch" size="85639" author="lvfangmin" created="Wed, 5 Dec 2012 10:29:00 +0000"/>
                            <attachment id="12555476" name="BOOKKEEPER-463.patch" size="84722" author="lvfangmin" created="Fri, 30 Nov 2012 07:02:06 +0000"/>
                            <attachment id="12555464" name="BOOKKEEPER-463.patch" size="84310" author="lvfangmin" created="Fri, 30 Nov 2012 04:13:14 +0000"/>
                            <attachment id="12555463" name="BOOKKEEPER-463.patch" size="84334" author="lvfangmin" created="Fri, 30 Nov 2012 03:40:14 +0000"/>
                            <attachment id="12555326" name="BOOKKEEPER-463.patch" size="83925" author="lvfangmin" created="Thu, 29 Nov 2012 07:07:14 +0000"/>
                            <attachment id="12554448" name="BOOKKEEPER-463.patch" size="76921" author="lvfangmin" created="Wed, 21 Nov 2012 03:20:31 +0000"/>
                            <attachment id="12554446" name="BOOKKEEPER-463.patch" size="86246" author="lvfangmin" created="Wed, 21 Nov 2012 02:33:58 +0000"/>
                            <attachment id="12554336" name="BOOKKEEPER-463.patch" size="76970" author="lvfangmin" created="Tue, 20 Nov 2012 13:03:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 20 Nov 2012 13:03:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>257022</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hycw2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>109173</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>