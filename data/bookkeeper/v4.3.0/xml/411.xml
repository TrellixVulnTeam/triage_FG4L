<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:30:08 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-411/BOOKKEEPER-411.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-411] Add CloseSubscription Request for multiplexing support</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-411</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;for multiplexing, we could not close the underlying channel directly when closing subscription. so we need to close subscription from server side.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12608782">BOOKKEEPER-411</key>
            <summary>Add CloseSubscription Request for multiplexing support</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12525162">BOOKKEEPER-70</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hustlmsp">Sijie Guo</assignee>
                                    <reporter username="hustlmsp">Sijie Guo</reporter>
                        <labels>
                    </labels>
                <created>Sun, 23 Sep 2012 13:36:07 +0100</created>
                <updated>Wed, 13 Feb 2013 15:47:05 +0000</updated>
                            <resolved>Mon, 22 Oct 2012 12:05:56 +0100</resolved>
                                                    <fixVersion>4.2.0</fixVersion>
                                    <component>hedwig-client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13461424" author="hustlmsp" created="Sun, 23 Sep 2012 15:09:19 +0100"  >&lt;p&gt;Attach a patch to add closeSubscription request. The patch is generated based on &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-367&quot; title=&quot;Server-Side Message Delivery Flow Control&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-367&quot;&gt;&lt;del&gt;BOOKKEEPER-367&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13469464" author="ikelly" created="Thu, 4 Oct 2012 16:48:28 +0100"  >&lt;p&gt;You&apos;ve added a new subscription event called NOP, which has the effect of not closing the channel in setNotConnected. This functionally makes sense when multiplexing, but as others may be using the channel. However, isn&apos;t the same true for TOPIC_MOVED and SUBSCRIPTION_FORCED_CLOSED? Or at least for TOPIC_MOVED?&lt;/p&gt;

&lt;p&gt;Also, regardless of this, NOP is a bad name for the subscription event, as NOP isn&apos;t a description of the event, but rather a command to do nothing. SUBSCRIPTION_CLOSED would be better. &lt;/p&gt;

&lt;p&gt;Regarding the SubscriptionChannelManager, this is a good idea, but its moving code and modifying it in the move at the same time. This makes it hard to verify that the refactor itself it ok, regardless of the new functionallity. Could you split this bit out into a smaller patch first, and put the subscription closed stuff on top of that then.&lt;/p&gt;</comment>
                            <comment id="13474132" author="hustlmsp" created="Thu, 11 Oct 2012 14:20:44 +0100"  >&lt;p&gt;ah. I almost missed this comment.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;However, isn&apos;t the same true for TOPIC_MOVED and SUBSCRIPTION_FORCED_CLOSED? Or at least for TOPIC_MOVED?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;for TOPIC_MOVED and SUBSCRIPTION_FORCED_CLOSED, we close the channel now. but after multiplexing, we should not close it, instead we sending a SubscriptionEvent thru the channel to notify the client the event.&lt;/p&gt;

&lt;p&gt;NOP introduced here 1) for now, we don&apos;t need to close subscription channel. 2) for multiplexing, we don&apos;t need to send subscription event to client. so NOP is different is from TOPIC_MOVED and SUBSCRIPTION_FORCED_CLOSED.&lt;/p&gt;

&lt;p&gt;I agreed that NOP is a bad name. SUBSCRIPTION_CLOSED is better. How about making it more exactly, using SUBSCRIPTION_ALREADY_CLOSED, which means the subscription is already closed, so we don&apos;t need to close channel now, and don&apos;t need to send any subscription event in future for multiplexing.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Could you split this bit out into a smaller patch first, and put the subscription closed stuff on top of that then.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;OK. How about creating a new jira to abstract the SubscriptionChannelManager and this jira generate the closeSubscription part based on that jira? Does it make sense for you?&lt;/p&gt;</comment>
                            <comment id="13476158" author="hustlmsp" created="Mon, 15 Oct 2012 15:12:43 +0100"  >&lt;p&gt;attach a new patch addressing Ivan&apos;s comment. the patch is generated based on &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-435&quot; title=&quot;Create SubscriptionChannelManager to manage all subscription channel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-435&quot;&gt;&lt;del&gt;BOOKKEEPER-435&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13481300" author="ikelly" created="Mon, 22 Oct 2012 12:05:56 +0100"  >&lt;p&gt;Committed r1400836. Thanks Sijie.&lt;/p&gt;</comment>
                            <comment id="13481398" author="hudson" created="Mon, 22 Oct 2012 15:37:50 +0100"  >&lt;p&gt;Integrated in bookkeeper-trunk #766 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/766/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/766/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-411&quot; title=&quot;Add CloseSubscription Request for multiplexing support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-411&quot;&gt;&lt;del&gt;BOOKKEEPER-411&lt;/del&gt;&lt;/a&gt;: Add CloseSubscription Request for multiplexing support (sijie via ivank) (Revision 1400836)&lt;/p&gt;

&lt;p&gt;     Result = UNSTABLE&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-client/src/main/java/org/apache/hedwig/client/handlers/CloseSubscriptionResponseHandler.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-client/src/main/java/org/apache/hedwig/client/netty/NetUtils.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-client/src/main/java/org/apache/hedwig/client/netty/impl/simple/SimpleSubscriptionChannelPipelineFactory.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-protocol/src/main/java/org/apache/hedwig/protocol/PubSubProtocol.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-protocol/src/main/protobuf/PubSubProtocol.proto&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/delivery/DeliveryManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/delivery/FIFODeliveryManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/handlers/CloseSubscriptionHandler.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/handlers/UnsubscribeHandler.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/netty/PubSubServer.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/subscriptions/AbstractSubscriptionManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/main/java/org/apache/hedwig/server/subscriptions/SubscriptionManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/client/netty&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/client/netty/TestCloseSubscription.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/server/delivery/StubDeliveryManager.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/hedwig-server/src/test/java/org/apache/hedwig/server/handlers/TestSubUnsubHandler.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12611828">BOOKKEEPER-435</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12549148" name="BOOKKEEPER-411.diff" size="90633" author="hustlmsp" created="Mon, 15 Oct 2012 15:12:43 +0100"/>
                            <attachment id="12546200" name="BOOKKEEPER-411.diff" size="119743" author="hustlmsp" created="Sun, 23 Sep 2012 15:09:19 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 4 Oct 2012 15:48:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>240455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxuvnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3947</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>