<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:25:48 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-716/BOOKKEEPER-716.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-716] padding writes for bookie journal</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-716</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;it would be better to pad journal writes to align sector size, which to avoid second syncing corrupt an already synced sector/page.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12686825">BOOKKEEPER-716</key>
            <summary>padding writes for bookie journal</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12659256">BOOKKEEPER-656</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hustlmsp">Sijie Guo</assignee>
                                    <reporter username="hustlmsp">Sijie Guo</reporter>
                        <labels>
                    </labels>
                <created>Tue, 31 Dec 2013 08:01:04 +0000</created>
                <updated>Tue, 29 Apr 2014 21:44:44 +0100</updated>
                            <resolved>Tue, 29 Apr 2014 21:09:16 +0100</resolved>
                                                    <fixVersion>4.3.0</fixVersion>
                                    <component>bookkeeper-server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13888854" author="hustlmsp" created="Sun, 2 Feb 2014 07:20:34 +0000"  >&lt;p&gt;attach a patch to padding writes to align SECTION SIZE. the change bumps the journal version.&lt;/p&gt;

&lt;p&gt;attach a patch diff with &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-715&quot; title=&quot;bookie: delay dropping journal cached pages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-715&quot;&gt;&lt;del&gt;BOOKKEEPER-715&lt;/del&gt;&lt;/a&gt;. and a patch diff with trunk for pre-commit job.&lt;/p&gt;</comment>
                            <comment id="13888872" author="hadoopqa" created="Sun, 2 Feb 2014 09:02:46 +0000"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-716&quot; title=&quot;padding writes for bookie journal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-716&quot;&gt;&lt;del&gt;BOOKKEEPER-716&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12626517/BOOKKEEPER-716.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-716.diff&lt;/a&gt; downloaded at Sun Feb  2 08:34:27 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 2 testcase(s)&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; the patch seems to introduce 1 new RAT warning(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 895&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/574/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/574/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13923839" author="ikelly" created="Fri, 7 Mar 2014 12:30:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hustlmsp&quot; class=&quot;user-hover&quot; rel=&quot;hustlmsp&quot;&gt;Sijie Guo&lt;/a&gt;, could you expand on the rationale for this change? In the description you mention corruption, but this seems more like a perf thing. Do you have any perf numbers for this change? (also, I would be very interested if you could share perf numbers from 715 &amp;amp; 717).&lt;/p&gt;</comment>
                            <comment id="13924190" author="hustlmsp" created="Fri, 7 Mar 2014 18:45:44 +0000"  >&lt;p&gt;this is mostly for preventing corruption, not pref.&lt;/p&gt;

&lt;p&gt;for example, say sector size 512, first flush writes data from 0 to 415, which will cause syncing sector 0. second flush writes data from 415 to 600, which will cause syncing sector 0 &amp;amp; 1. if machines is crashed during second flush (if the filesystem is not COW filesystem or transactional), sector 0 might be corrupted, which we might lose data of first flush.&lt;/p&gt;

&lt;p&gt;this change will try to padding bytes for each flush to align with sector size. so in the above example, first flush will write 0 to 512, while second flush will write from 512. as we don&apos;t have exact ideas on device layout, this patch is trying the best to prevent corruption.&lt;/p&gt;

&lt;p&gt;715 &amp;amp; 717 changes are mostly for performance. in our case, we are more concerned about sustained low latency in a high throughput (e.g. a bookie could have p99 latency less than 10ms in 15K). before 715, we couldn&apos;t get a sustained throughput in low latency, since it kept reading pages in journal disk, which cause journal disk to be in high iowait. before 717, if any spikes on disk will introduce lots of single entry syncs, and hence cause journal disk to be in high iowait. after 715 &amp;amp; 717, we could have pretty stable sustained throughput with low latency. but I don&apos;t exact number how best that we could do. at least, we could handle 6ms group commit interval under 15k/s for a single bookie.&lt;/p&gt;</comment>
                            <comment id="13924198" author="ikelly" created="Fri, 7 Mar 2014 18:50:21 +0000"  >&lt;p&gt;what filesystem did you observe this on? Really this should be handled at the filesystem level, and barriers should prevent issues.&lt;/p&gt;</comment>
                            <comment id="13924564" author="hustlmsp" created="Sat, 8 Mar 2014 00:33:40 +0000"  >&lt;p&gt;we haven&apos;t encountered this issue yet. barries is used by filesystem to prevent this for its metadata block and data block. but I don&apos;t think you could rely on this from application perspective, since filesystem doesn&apos;t know what your data means, although modern COW or transactional filesystem would handle this. so from bookie perspective, it would be good to try the best to prevent this. And aligning with block size is also a good practice, &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-715&quot; title=&quot;bookie: delay dropping journal cached pages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-715&quot;&gt;&lt;del&gt;BOOKKEEPER-715&lt;/del&gt;&lt;/a&gt; somehow is due to flush entries isn&apos;t aligned to a block size.&lt;/p&gt;</comment>
                            <comment id="13925687" author="ikelly" created="Mon, 10 Mar 2014 11:58:09 +0000"  >&lt;p&gt;After a lot of searching, the case seems legit. There&apos;s really not much concrete info on partial sector write though. &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; links to some good info.&lt;/p&gt;

&lt;p&gt;So, I reviewed the patch. There&apos;s a couple of issues I have with it.&lt;/p&gt;

&lt;p&gt;1. it&apos;s a breaking change. If a user upgrades to 4.3.0 with this patch, they won&apos;t be able to roll back to to 4.2.2 if there&apos;s a problem with 4.3.0. For this reason, I&apos;d make this configurable and off by default for now, until 4.3 is stabilized (4.3.1 or 4.3.2 i would guess).&lt;br/&gt;
2. the padding should take place in journalchannel. writePaddingBytes reaches into it a lot anyhow. &lt;br/&gt;
3. There&apos;s no need for the length of the padding to be written. Instead, all writes in JournalChannel should pad to the 512 boundary, and all reads should start at the next 512 boundary after the position.&lt;br/&gt;
4. sector size should be configurable. some disks about 4K sectors now. Also, SSDs. have you folks tried journalling to SSDs?&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://jrtipton.tumblr.com/post/906649351/atomic-sector-writes&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://jrtipton.tumblr.com/post/906649351/atomic-sector-writes&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="13929969" author="hustlmsp" created="Tue, 11 Mar 2014 05:26:01 +0000"  >&lt;p&gt;for 1), i don&apos;t mind adding the flag. but I am not very sure if we really need the flag. since in the past release we also bump journal version, which were also breaking changes as you said. and more concerned that shall we need to do each time we bump version on either disk format? &lt;/p&gt;

&lt;p&gt;for 2), as the batching logic is in journal side, I would prefer adding the padding logic in journal side, rather than journalchannel.&lt;/p&gt;

&lt;p&gt;for 3), the padding there is just for easy to track if it is a padding or a normal record. it doesn&apos;t affect any correctness or performance issue. you could still let reads start from 512 boundary.&lt;/p&gt;

&lt;p&gt;for 4) I could make sector size to be configurable.&lt;/p&gt;</comment>
                            <comment id="13931833" author="ikelly" created="Wed, 12 Mar 2014 14:52:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;for 1), i don&apos;t mind adding the flag. but I am not very sure if we really need the flag. since in the past release we also bump journal version, which were also breaking changes as you said. and more concerned that shall we need to do each time we bump version on either disk format? &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The last change was between the 4.1.0 the 4.2.0 release. The changes in 4.3.0 are riskier and there is a lot more production usage of bookkeeper, so stability is even more important. I&apos;m not just talking about this change, but the other changes in the code related to checkpointing etc. I think it would be best to make this feature (and therefore the incompatibility) optional until the rest of the code has been proven for a few months.&lt;/p&gt;

&lt;p&gt;That said, I think this change can be made without breaking BC. Instead of having a &lt;span class=&quot;error&quot;&gt;&amp;#91;mask&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;len&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bytes...&amp;#93;&lt;/span&gt; which is 8bytes min, you could have &lt;span class=&quot;error&quot;&gt;&amp;#91;len&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ledgerid&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;entryid&amp;#93;&lt;/span&gt; where ledgerid = -1, which is 20bytes min, but which will be simply discarded when the scanner gets it on recovery, because the ledger doesn&apos;t exist anymore. This would be backwards compat.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;for 2), as the batching logic is in journal side, I would prefer adding the padding logic in journal side, rather than journalchannel.&lt;br/&gt;
for 3), the padding there is just for easy to track if it is a padding or a normal record. it doesn&apos;t affect any correctness or performance issue. you could still let reads start from 512 boundary.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;ok.&lt;/p&gt;
</comment>
                            <comment id="13932063" author="hustlmsp" created="Wed, 12 Mar 2014 17:42:47 +0000"  >&lt;blockquote&gt;
&lt;p&gt;That said, I think this change can be made without breaking BC. Instead of having a &lt;span class=&quot;error&quot;&gt;&amp;#91;mask&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;len&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bytes...&amp;#93;&lt;/span&gt; which is 8bytes min, you could have &lt;span class=&quot;error&quot;&gt;&amp;#91;len&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ledgerid&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;entryid&amp;#93;&lt;/span&gt; where ledgerid = -1, which is 20bytes min, but which will be simply discarded when the scanner gets it on recovery, because the ledger doesn&apos;t exist anymore. This would be backwards compat.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;your solution would introduce a bit problematic, if the ledger id generator generates a ledger id with -1. and if you read the patch, this change also extends the journal head size to align with sector size. that&apos;s the reason why bumping the version.&lt;/p&gt;

&lt;p&gt;and for the option, I don&apos;t mind adding the option if you feel strong on it. but I still don&apos;t understand how could an option help. if there is problem on this change, you might still hit it when you enable the option and you couldn&apos;t get back, no? I am kind of thinking the right thing is to do bucket testing: upgrade a few nodes, stabilize it. if anything bad happened, take those few nodes out and run bookie recover and rollback to 4.2.0.&lt;/p&gt;


</comment>
                            <comment id="13932218" author="ikelly" created="Wed, 12 Mar 2014 19:12:57 +0000"  >&lt;p&gt;Ok, make it optional, and off by default then. The problem isn&apos;t necessarily this patch, but the fact that when you take 4.3.0 you&apos;ll be taking it as a whole, and a lot has changed. I&apos;d like to keep rollback as easy as possible until 4.3.1 at least.&lt;/p&gt;</comment>
                            <comment id="13984084" author="hustlmsp" created="Tue, 29 Apr 2014 08:10:53 +0100"  >&lt;p&gt;attach a patch to address comments to make alignment size and write version configurable.&lt;/p&gt;</comment>
                            <comment id="13984200" author="hadoopqa" created="Tue, 29 Apr 2014 12:01:50 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-716&quot; title=&quot;padding writes for bookie journal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-716&quot;&gt;&lt;del&gt;BOOKKEEPER-716&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12642416/BOOKKEEPER-716.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-716.diff&lt;/a&gt; downloaded at Tue Apr 29 10:33:21 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 903&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/615/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/615/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13984409" author="hadoopqa" created="Tue, 29 Apr 2014 16:31:47 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-716&quot; title=&quot;padding writes for bookie journal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-716&quot;&gt;&lt;del&gt;BOOKKEEPER-716&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12642416/BOOKKEEPER-716.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-716.diff&lt;/a&gt; downloaded at Tue Apr 29 15:03:35 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 903&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;&lt;b&gt;+1 Overall result, good!, no -1s&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/616/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/616/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13984436" author="hadoopqa" created="Tue, 29 Apr 2014 17:05:49 +0100"  >&lt;p&gt;Testing JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-716&quot; title=&quot;padding writes for bookie journal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-716&quot;&gt;&lt;del&gt;BOOKKEEPER-716&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12642416/BOOKKEEPER-716.diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;BOOKKEEPER-716.diff&lt;/a&gt; downloaded at Tue Apr 29 15:37:34 UTC 2014&lt;/p&gt;

&lt;p&gt;----------------------------&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 PATCH_APPLIES&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 CLEAN&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAW_PATCH_ANALYSIS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any @author tags&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any tabs&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any trailing spaces&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not introduce any line longer than 120&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does adds/modifies 3 testcase(s)&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 RAT&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new RAT warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 JAVADOC&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Javadoc warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 COMPILE&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; HEAD compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; patch compiles&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new javac warnings&lt;br/&gt;
&lt;font color=&quot;green&quot;&gt;+1 FINDBUGS&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; the patch does not seem to introduce new Findbugs warnings&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;-1 TESTS&lt;/font&gt;&lt;br/&gt;
.    Tests run: 903&lt;br/&gt;
.    Tests failed: 0&lt;br/&gt;
.    Tests errors: 1&lt;/p&gt;

&lt;p&gt;.    The patch failed the following testcases:&lt;/p&gt;

&lt;p&gt;.      &lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;+1 DISTRO&lt;/font&gt;&lt;br/&gt;
.    &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; distro tarball builds with the patch &lt;/p&gt;

&lt;p&gt;----------------------------&lt;br/&gt;
&lt;font color=&quot;red&quot;&gt;&lt;b&gt;-1 Overall result, please check the reported -1(s)&lt;/b&gt;&lt;/font&gt;&lt;/p&gt;


&lt;p&gt;The full output of the test-patch run is available at&lt;/p&gt;

&lt;p&gt;.   &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/617/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk-precommit-build/617/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13984501" author="ikelly" created="Tue, 29 Apr 2014 18:08:24 +0100"  >&lt;p&gt;builds sems down, so i cant see what the failure is, but new patch looks good to me.&lt;/p&gt;

&lt;p&gt;+1.&lt;/p&gt;

&lt;p&gt;will test and commit once i see what jenkin&apos;s problem was. im going to guess it was unrelated, there&apos;s some flake in tests which we need to fix before 4.3.0. doesnt seem to exist in 4.2 branch.&lt;/p&gt;</comment>
                            <comment id="13984726" author="ikelly" created="Tue, 29 Apr 2014 21:09:16 +0100"  >&lt;p&gt;Committed r1591079. The failure was org.apache.bookkeeper.replication.BookieAutoRecoveryTest.testEmptyLedgerLosesQuorumEventually, which went in with &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-742&quot; title=&quot;Fix for empty ledgers losing quorum.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-742&quot;&gt;&lt;del&gt;BOOKKEEPER-742&lt;/del&gt;&lt;/a&gt;. ill look into it.&lt;/p&gt;</comment>
                            <comment id="13984762" author="hudson" created="Tue, 29 Apr 2014 21:44:44 +0100"  >&lt;p&gt;SUCCESS: Integrated in bookkeeper-trunk #632 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/632/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/632/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-716&quot; title=&quot;padding writes for bookie journal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-716&quot;&gt;&lt;del&gt;BOOKKEEPER-716&lt;/del&gt;&lt;/a&gt;: padding writes for bookie journal (sijie via ivank) (ivank: rev 1591079)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Bookie.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/JournalChannel.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IOUtils.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/bookie/BookieJournalTest.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/client/ClientUtil.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/conf/TestBKConfiguration.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12642416" name="BOOKKEEPER-716.diff" size="37830" author="hustlmsp" created="Tue, 29 Apr 2014 08:10:53 +0100"/>
                            <attachment id="12626517" name="BOOKKEEPER-716.diff" size="50421" author="hustlmsp" created="Sun, 2 Feb 2014 07:20:34 +0000"/>
                            <attachment id="12626516" name="BOOKKEEPER-716_715.diff" size="30675" author="hustlmsp" created="Sun, 2 Feb 2014 07:20:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 2 Feb 2014 09:02:46 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365818</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzkwnz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>366125</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>