<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat May 16 23:28:55 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/BOOKKEEPER-174/BOOKKEEPER-174.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[BOOKKEEPER-174] Bookie can&apos;t start when replaying entries whose ledger were deleted and garbage collected.</title>
                <link>https://issues.apache.org/jira/browse/BOOKKEEPER-174</link>
                <project id="12311293" key="BOOKKEEPER">Bookkeeper</project>
                    <description>&lt;p&gt;if a journal contains entries which the ledgers they belongs to has been deleted and garbage collected, replaying such journal would encounter NoSuchLedgerException. And the bookie can&apos;t start.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12542831">BOOKKEEPER-174</key>
            <summary>Bookie can&apos;t start when replaying entries whose ledger were deleted and garbage collected.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ikelly">Ivan Kelly</assignee>
                                    <reporter username="hustlmsp">Sijie Guo</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Feb 2012 07:10:43 +0000</created>
                <updated>Mon, 22 Oct 2012 15:50:17 +0100</updated>
                            <resolved>Fri, 17 Feb 2012 11:50:38 +0000</resolved>
                                    <version>4.0.0</version>
                                    <fixVersion>4.1.0</fixVersion>
                                    <component>bookkeeper-server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13209213" author="hustlmsp" created="Thu, 16 Feb 2012 08:12:29 +0000"  >&lt;p&gt;attach a patch to fix this issue. the idea is when encountering NoLedgerException on replaying journals, we need to check whether the ledger is still existed or not. if the ledger has been removed, we just skip replaying the entry.&lt;/p&gt;</comment>
                            <comment id="13209575" author="ikelly" created="Thu, 16 Feb 2012 18:21:21 +0000"  >&lt;p&gt;Fix looks good. I have a few cosmetic comments. &lt;br/&gt;
a) isDebugEnabled isn&apos;t actually required here, since we use slf4j. We can just use the {} formatting mechanism. For example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
  LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Skip replaying entries of ledger &quot;&lt;/span&gt; + ledgerId + &lt;span class=&quot;code-quote&quot;&gt;&quot; since it was deleted.&quot;&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Can be written as &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Skip replaying entries of ledger {} since it was deleted.&quot;&lt;/span&gt;, ledgerId);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Which is much neater.&lt;/p&gt;

&lt;p&gt;b) I think you should add the tests into BookieJournalTest rather than creating a new suite.&lt;/p&gt;</comment>
                            <comment id="13210037" author="hustlmsp" created="Fri, 17 Feb 2012 03:50:18 +0000"  >&lt;p&gt;the new test case is based on BaseTestCase while BookieJournalTest is not. since the test case is related to journal rolling so I prefer to add in BookieJournalRollingTest instead in BookieJournalTest.&lt;/p&gt;</comment>
                            <comment id="13210061" author="hustlmsp" created="Fri, 17 Feb 2012 05:16:25 +0000"  >&lt;p&gt;attach a new patch.&lt;/p&gt;</comment>
                            <comment id="13210180" author="hustlmsp" created="Fri, 17 Feb 2012 10:55:06 +0000"  >&lt;p&gt;after discussion with Ivan, the case that adding to the ledger throw NoLedgerException and ledgerManager.ledgerExists() returns true should not happen. so it is safe to skip entry when found NoLedgerException. So I remove the ledgerExists related staff in the new patch.&lt;/p&gt;</comment>
                            <comment id="13210200" author="ikelly" created="Fri, 17 Feb 2012 11:50:38 +0000"  >&lt;p&gt;Committed as r1245411, thanks Sijie&lt;/p&gt;</comment>
                            <comment id="13210210" author="hudson" created="Fri, 17 Feb 2012 12:36:18 +0000"  >&lt;p&gt;Integrated in bookkeeper-trunk #365 (See &lt;a href=&quot;https://builds.apache.org/job/bookkeeper-trunk/365/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/bookkeeper-trunk/365/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/BOOKKEEPER-174&quot; title=&quot;Bookie can&amp;#39;t start when replaying entries whose ledger were deleted and garbage collected.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BOOKKEEPER-174&quot;&gt;&lt;del&gt;BOOKKEEPER-174&lt;/del&gt;&lt;/a&gt;: Bookie can&apos;t start when replaying entries whose ledger were deleted and garbage collected. (sijie via ivank) (Revision 1245411)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
ivank : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/CHANGES.txt&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Bookie.java&lt;/li&gt;
	&lt;li&gt;/zookeeper/bookkeeper/trunk/bookkeeper-server/src/test/java/org/apache/bookkeeper/test/BookieJournalRollingTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12514772" name="BOOKKEEPER-174.diff" size="13020" author="hustlmsp" created="Thu, 16 Feb 2012 08:12:29 +0000"/>
                            <attachment id="12514951" name="BOOKKEEPER-174.diff_v2" size="9039" author="hustlmsp" created="Fri, 17 Feb 2012 05:16:25 +0000"/>
                            <attachment id="12514972" name="BOOKKEEPER-174.diff_v3" size="6392" author="hustlmsp" created="Fri, 17 Feb 2012 10:55:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 16 Feb 2012 18:21:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>228117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4s13:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61697</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>