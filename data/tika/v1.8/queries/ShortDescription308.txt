Improve supertype handling in type registry