The addMetadata method in AbstractMetadataHandler does not check its property for isMultiValuePermitted before calling metadata.add which will throw a PropertyTypeException if isMultiValuePermitted is false.