The incoming charset (if any) from metadata should be passed to CharsetDetector.setDeclaredEncoding().