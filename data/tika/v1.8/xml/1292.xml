<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:38:59 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1292/TIKA-1292.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1292] Inconsistent priorities in bundled tika-mimetypes.xml</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1292</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;It seems that mime-type priorities are a bit inconsistent in the tika-core bundled tika-mimetypes.xml&lt;/p&gt;

&lt;p&gt;Few examples:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/tika/blob/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml#L3497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;application/zip&lt;/a&gt; vs &lt;a href=&quot;https://github.com/apache/tika/blob/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml#L3510&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;application/x-7z-compressed&lt;/a&gt;: both are similar &quot;containers&quot; archive formats (structured, having entries), having distinct file extensions (&quot;zip&quot; vs &quot;7z&quot; globs), still priorities are 40 and 50 respectively.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/apache/tika/blob/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml#L3497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;application/zip&lt;/a&gt; vs &lt;a href=&quot;https://github.com/apache/tika/blob/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml#L4713&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;text/html&lt;/a&gt;: not quite related MIME types, having same priority of 40. But ZIP files can be &quot;uncompressed&quot; (meaning entries are mostly &quot;concatenated&quot;, and their content, if plaintext, is readable). Hence, having an &quot;uncompressed&quot; ZIP (or any subclass like JAR) file that contains HTML files zipped up might/will be detected as HTML, which is wrong.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;And this is what happens in Nexus that uses Tika under the hud for &quot;content&quot; validation, basically using MIME magic detection provided by Tika Detector: the Java JAR &lt;tt&gt;com.intellij:annotations:7.0.3&lt;/tt&gt; (&lt;a href=&quot;http://repo1.maven.org/maven2/com/intellij/annotations/7.0.3/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;link&lt;/a&gt;) is being detected as &lt;tt&gt;text/html&lt;/tt&gt; instead of (expected) &lt;tt&gt;application/java-archive&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Reason is following: the JAR file is zipped up in &quot;uncompressed&quot; zip format, and among few annotations it also contains one HTML file entry (the license I guess). Since both MIME types have same priority (40), I guess tika &quot;randomly&quot; chooses the &lt;tt&gt;text/html&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Original Nexus issue&lt;br/&gt;
&lt;a href=&quot;https://issues.sonatype.org/browse/NEXUS-6560&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.sonatype.org/browse/NEXUS-6560&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;At Nexus issue there is a GH Pull Request that solves the problem for us (by raising &lt;tt&gt;application/zip&lt;/tt&gt; priority to 41.&lt;/p&gt;

&lt;p&gt;But by inspecting the bundled tike-mimetypes.xml we spotted other &amp;#8211; probably &amp;#8211; priority inconsistencies, like that of zip vs 7z mentioned above.&lt;/p&gt;

&lt;p&gt;Note: this happens when using tika-core solely on classpath and using it for MIME magic detection. Interestingly, when the tika-parsers (with it&apos;s all dependencies) are added to classpath, Tika will properly figure out that the artifact is &lt;tt&gt;application/java-archive&lt;/tt&gt;. Still, our use case in Nexus requires the MIME magic detection only, so we do not use tika-parsers, nor we would like to do so.&lt;/p&gt;

&lt;p&gt;Sample project to reproduce&lt;br/&gt;
&lt;a href=&quot;https://github.com/cstamas/tika-1292&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/cstamas/tika-1292&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12712801">TIKA-1292</key>
            <summary>Inconsistent priorities in bundled tika-mimetypes.xml</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cstamas">Cservenak, Tamas</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 May 2014 11:06:38 +0100</created>
                <updated>Mon, 26 May 2014 09:01:21 +0100</updated>
                            <resolved>Thu, 22 May 2014 17:08:21 +0100</resolved>
                                    <version>1.5</version>
                                    <fixVersion>1.6</fixVersion>
                                    <component>mime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13991804" author="cstamas" created="Wed, 7 May 2014 14:30:03 +0100"  >&lt;p&gt;Traced down what actually happens in Tika 1.5 and found the following problem, that IMO is a bug.&lt;/p&gt;

&lt;p&gt;In class org.apache.tika.mime.MimeTypes:&lt;br/&gt;
Tika sorts the magics and uses algorithm &quot;first match found&quot; to find out MIME based on magic bytes. Since in this case (uncompressed ZIP with HTML file among it&apos;s entries) &lt;tt&gt;text/html&lt;/tt&gt; matches, it is returned. &lt;tt&gt;application/zip&lt;/tt&gt; would match too, but due to having same priority (40), their order after sorting the collection is undefined (or is based on location in XML file, irrelevant), and simply the &lt;tt&gt;text/html&lt;/tt&gt; magic was before in the sorted list of magics. Next, match by glob provided in metadata as RESOURCE_NAME_KEY is attempted (.jar in this case), and this time if finds the &lt;tt&gt;application/java-archive&lt;/tt&gt; as expected. But then, the &lt;tt&gt;application/java-archive&lt;/tt&gt; is getting discarded, as it is not a specialisation of &lt;tt&gt;text/html&lt;/tt&gt; (which is true) and Tika continues with &lt;tt&gt;text/html&lt;/tt&gt; which is returned.&lt;/p&gt;

&lt;p&gt;The bug in my point of view is how magics with same priority are handled.&lt;/p&gt;

&lt;p&gt;One solution might be to &quot;cluster&quot; the magics by their priorities, and consider the whole cluster where the first match was found (try all the remaining magics from same cluster). This would require a bit of a change in the class, as magic detection goes over multiple methods that are returning single type, while with this change it would be some sort of a collection. With a &lt;em&gt;collection&lt;/em&gt; of magic matches, the glob/RESOURCE_NAME_KEY match would test for specialisation of all of them, and return the specialisation, if any found.&lt;/p&gt;

&lt;p&gt;Ideas? Opinions?&lt;/p&gt;</comment>
                            <comment id="13991887" author="githubbot" created="Wed, 7 May 2014 16:03:25 +0100"  >&lt;p&gt;GitHub user cstamas opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tika/pull/6&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/tika/pull/6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt;: Upping application/zip priority in XML&lt;/p&gt;

&lt;p&gt;    To not clash with html and work for uncompressed&lt;br/&gt;
    ZIP files having HTML entries.&lt;/p&gt;

&lt;p&gt;    This is the simplest fix that removes the problem described in issue for the com.intellij:annotations:7.0.3 artifact.&lt;/p&gt;

&lt;p&gt;    Issue&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-1292&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/cstamas/tika&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/cstamas/tika&lt;/a&gt; tika-1292-zip-priority&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tika/pull/6.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/tika/pull/6.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #6&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 32e69f38264d7aeb7c67689bbc254228c1cf0b7d&lt;br/&gt;
Author: Tamas Cservenak &amp;lt;tamas@cservenak.net&amp;gt;&lt;br/&gt;
Date:   2014-05-07T15:01:40Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt;: Upping application/zip priority in XML&lt;/p&gt;

&lt;p&gt;    To not clash with html and work for uncompressed&lt;br/&gt;
    ZIP files having HTML entries.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="13991920" author="githubbot" created="Wed, 7 May 2014 16:37:35 +0100"  >&lt;p&gt;GitHub user cstamas opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tika/pull/7&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/tika/pull/7&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    WIP &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt;: Fixing the MimeTypes class to consider &quot;clusters&quot; of magics by priority&lt;/p&gt;

&lt;p&gt;    This changes MimeTypes class to consider &quot;clusters&quot; of magics instead of &quot;first found&quot; to resolve priority clashes like those described in issue.&lt;/p&gt;

&lt;p&gt;    This is WIP, as the tika-core module builds okay, but tika-parsers module has one test failure, that am somewhat uncertain why. I&apos;d like someone to take a peek and comment. Thanks.&lt;/p&gt;

&lt;p&gt;    Issue&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-1292&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/cstamas/tika&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/cstamas/tika&lt;/a&gt; tika-1292-cluster-magics&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tika/pull/7.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/tika/pull/7.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #7&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 0528266e760c041a7eca757caa822b120c917cc5&lt;br/&gt;
Author: Tamas Cservenak &amp;lt;tamas@cservenak.net&amp;gt;&lt;br/&gt;
Date:   2014-05-07T14:57:59Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt;: Fixing the MimeTypes class&lt;/p&gt;

&lt;p&gt;    To consider &quot;clusters&quot; of magics instead&lt;br/&gt;
    of just &quot;first found&quot;.&lt;/p&gt;

&lt;p&gt;commit 576f5988d4a70ac67aca03522acd7c576804ddc2&lt;br/&gt;
Author: Tamas Cservenak &amp;lt;tamas@cservenak.net&amp;gt;&lt;br/&gt;
Date:   2014-05-07T15:36:46Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt;: Simplified the patch&lt;/p&gt;

&lt;p&gt;    By re-prioritizing the hint, if exists, and&lt;br/&gt;
    matches.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="13991924" author="cstamas" created="Wed, 7 May 2014 16:38:55 +0100"  >&lt;p&gt;Pull requests:&lt;br/&gt;
A simple XML change for application/zip type that fixes the &quot;uncompressed ZIP files with HTML entries&quot; problem&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/tika/pull/6&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/tika/pull/6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;A more involved change for MimeTypes to consider magics from same clusters (by prio).&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/tika/pull/7&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/tika/pull/7&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14002414" author="jdillon" created="Mon, 19 May 2014 22:23:45 +0100"  >&lt;p&gt;This is a jar file available on maven-central which has this problem:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://repo1.maven.org/maven2/com/intellij/annotations/7.0.3/annotations-7.0.3.jar&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://repo1.maven.org/maven2/com/intellij/annotations/7.0.3/annotations-7.0.3.jar&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14002457" author="gagravarr" created="Mon, 19 May 2014 22:52:15 +0100"  >&lt;p&gt;Thanks for that, I&apos;ve used it to write a (currently disabled) failing unit test in r1596068.&lt;/p&gt;

&lt;p&gt;Will aim to review your patches in a day or two, unless someone else beats me to it!&lt;/p&gt;</comment>
                            <comment id="14003901" author="hudson" created="Tue, 20 May 2014 21:03:15 +0100"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #2 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/2/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/2/&lt;/a&gt;)&lt;br/&gt;
Allow the DefautlDetector unit test to also check how MimeTypes would detect this, and add a commented-out check that uses that for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; (currently failing) (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596068&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596068&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/detect/TestContainerAwareDetector.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; Sample (Apache v2 Licensed) Jar with HTML in it (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596064&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596064&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testJAR_with_HTML.jar&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14004730" author="githubbot" created="Wed, 21 May 2014 15:52:19 +0100"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tika/pull/6&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/tika/pull/6&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14004863" author="gagravarr" created="Wed, 21 May 2014 17:31:07 +0100"  >&lt;p&gt;I&apos;ve added something similar to your pull #7 logic in r1596612, which based on some new unit testing seems to do the right thing. Any chance you could test, and close this + pull request if you&apos;re happy with what I&apos;ve opted for?&lt;/p&gt;</comment>
                            <comment id="14005072" author="cstamas" created="Wed, 21 May 2014 19:40:39 +0100"  >&lt;p&gt;Thanks Nick, will take a peek and report back.&lt;/p&gt;</comment>
                            <comment id="14005930" author="cstamas" created="Thu, 22 May 2014 14:58:16 +0100"  >&lt;p&gt;My test project on &lt;a href=&quot;https://github.com/cstamas/tika-1292&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/cstamas/tika-1292&lt;/a&gt; , with locally built Tika 1.6-SNAPSHOT (built off r1596612) passes just fine.&lt;br/&gt;
Also, tried with the r1596590 change locally reverted (the tika-mimetypes.xml change that ups priority of ZIP), to prove that new code works as expected: all is fine.&lt;br/&gt;
This issue can be closed as &quot;fixed&quot;.&lt;/p&gt;</comment>
                            <comment id="14005933" author="githubbot" created="Thu, 22 May 2014 15:00:47 +0100"  >&lt;p&gt;Github user cstamas closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/tika/pull/7&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/tika/pull/7&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14008481" author="hudson" created="Mon, 26 May 2014 01:14:14 +0100"  >&lt;p&gt;FAILURE: Integrated in tika-trunk-jdk1.6 #2 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/2/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/2/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; If there is more than one mime magic which matches at the highest priority, keep track and then try to pick based on filename or type hint later (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596612&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596612&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/java/org/apache/tika/mime/MimeTypes.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/mime/MimeDetectionTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/mime/MimeTypesReaderTest.java&lt;br/&gt;
Set an explicit priority on the OLE2 match, remove two MS Word matches which were OLE2 ones in disguise, and add an intermediate staroffice parent on the staroffice types. Helps with &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; testing (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596611&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596611&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;br/&gt;
Add a disabled unit test for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt;, which when working will ensure that if we have two matching magics at the same priority, the name is used to specialise if possible, first defined if not (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596593&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596593&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/mime/MimeDetectionTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/resources/org/apache/tika/mime/custom-mimetypes.xml&lt;br/&gt;
Container formats with specific, low-false-positive magic matches need a slightly higher priority, so that they don&apos;t accidently end up being matched based on the contents of the container near the start of the file. Partly solves &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt;. This closes #6 github pull request (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596590&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596590&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/detect/TestContainerAwareDetector.java&lt;br/&gt;
Add some notes on entries, to help people maintaining the file know what to do, related to &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596586&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596586&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;br/&gt;
Allow the DefautlDetector unit test to also check how MimeTypes would detect this, and add a commented-out check that uses that for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; (currently failing) (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596068&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596068&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/detect/TestContainerAwareDetector.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; Sample (Apache v2 Licensed) Jar with HTML in it (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596064&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596064&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testJAR_with_HTML.jar&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14008652" author="hudson" created="Mon, 26 May 2014 09:01:21 +0100"  >&lt;p&gt;FAILURE: Integrated in tika-trunk-jdk1.7 #3 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/3/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/3/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; If there is more than one mime magic which matches at the highest priority, keep track and then try to pick based on filename or type hint later (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596612&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596612&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/java/org/apache/tika/mime/MimeTypes.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/mime/MimeDetectionTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/mime/MimeTypesReaderTest.java&lt;br/&gt;
Set an explicit priority on the OLE2 match, remove two MS Word matches which were OLE2 ones in disguise, and add an intermediate staroffice parent on the staroffice types. Helps with &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; testing (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596611&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596611&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;br/&gt;
Add a disabled unit test for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt;, which when working will ensure that if we have two matching magics at the same priority, the name is used to specialise if possible, first defined if not (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596593&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596593&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/java/org/apache/tika/mime/MimeDetectionTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/test/resources/org/apache/tika/mime/custom-mimetypes.xml&lt;br/&gt;
Container formats with specific, low-false-positive magic matches need a slightly higher priority, so that they don&apos;t accidently end up being matched based on the contents of the container near the start of the file. Partly solves &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt;. This closes #6 github pull request (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596590&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596590&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/detect/TestContainerAwareDetector.java&lt;br/&gt;
Add some notes on entries, to help people maintaining the file know what to do, related to &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1292&quot; title=&quot;Inconsistent priorities in bundled tika-mimetypes.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1292&quot;&gt;&lt;del&gt;TIKA-1292&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596586&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1596586&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 7 May 2014 15:03:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzp7vz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>391339</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>