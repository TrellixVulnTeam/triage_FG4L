<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:27:56 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1494/TIKA-1494.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1494] JAXRS server: allow passing PDF password in the request</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1494</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I have to extract content from encrypted PDFs. Setting the PDF password using the TIKA_PASSWORD environment variable works, however it only allows for one PDF password.&lt;/p&gt;

&lt;p&gt;It would be very useful to be able to pass the password in during the HTTP request - as a header or by some other means. This way I can run a central JAXRS server and extract content from all PDFs, rather than a separate server for each department/group that has its own password.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12761302">TIKA-1494</key>
            <summary>JAXRS server: allow passing PDF password in the request</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="PeterBowyer">Peter Bowyer</reporter>
                        <labels>
                            <label>encryption</label>
                            <label>pdf</label>
                            <label>server</label>
                    </labels>
                <created>Fri, 12 Dec 2014 09:13:20 +0000</created>
                <updated>Fri, 19 Dec 2014 14:00:33 +0000</updated>
                            <resolved>Mon, 15 Dec 2014 06:27:45 +0000</resolved>
                                                    <fixVersion>1.7</fixVersion>
                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14243921" author="gagravarr" created="Fri, 12 Dec 2014 09:47:07 +0000"  >&lt;p&gt;My hunch is that the place to add this support would be in TikaResource.fillMetadata&lt;/p&gt;

&lt;p&gt;Could any of our JAXRS gurus confirm if that&apos;s where we&apos;d need to be adding it?&lt;/p&gt;

&lt;p&gt;If so, I guess we just need to put a few lines there that check for a password header, and pop a new PasswordProvider onto the Metadata object if so. Oh, and unit tests for it! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14244076" author="sergey_beryozkin" created="Fri, 12 Dec 2014 12:51:39 +0000"  >&lt;p&gt;Hi Nick, All&lt;br/&gt;
It should work indeed.&lt;br/&gt;
By the way, should it depend on the resolution of &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-894&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-894&lt;/a&gt; ? May be at least related to...&lt;br/&gt;
We can definitely support passing passwords and reporting the decrypted content over plain HTTP as POC but &lt;br/&gt;
some users would likely prefer having at least a 1-way TLS activated which is where running a Tika in a servlet container would help.&lt;br/&gt;
Sergey&lt;/p&gt;</comment>
                            <comment id="14246366" author="gagravarr" created="Mon, 15 Dec 2014 06:27:45 +0000"  >&lt;p&gt;Support added, along with a unit test, in r1645575. The password can now be given on a per-request basis with the &quot;Password&quot; header, which gets passed through as a PasswordProvider to all parsers which support it&lt;/p&gt;

&lt;p&gt;Note that you probably only want to do this for localhost connections, and where you&apos;ve turned on SSL/TLS&lt;/p&gt;</comment>
                            <comment id="14246372" author="hudson" created="Mon, 15 Dec 2014 06:42:00 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #362 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/362/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/362/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1494&quot; title=&quot;JAXRS server: allow passing PDF password in the request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1494&quot;&gt;&lt;del&gt;TIKA-1494&lt;/del&gt;&lt;/a&gt; Allow supplying a password on a per-request basis via the Password header (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645575&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645575&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/TikaResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/test/java/org/apache/tika/server/MetadataResourceTest.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1494&quot; title=&quot;JAXRS server: allow passing PDF password in the request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1494&quot;&gt;&lt;del&gt;TIKA-1494&lt;/del&gt;&lt;/a&gt; Support fetching the password for Excel .xls files from the ParseContext where given (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645574&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645574&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/AbstractPOIFSExtractor.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParser.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;br/&gt;
Prepare for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1494&quot; title=&quot;JAXRS server: allow passing PDF password in the request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1494&quot;&gt;&lt;del&gt;TIKA-1494&lt;/del&gt;&lt;/a&gt; - also provide the ParseContext to TikaResource.fillMetadata (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645569&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645569&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/MetadataEP.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/MetadataResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/TikaResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/UnpackerResource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14246382" author="hudson" created="Mon, 15 Dec 2014 06:59:39 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.6 #344 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/344/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/344/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1494&quot; title=&quot;JAXRS server: allow passing PDF password in the request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1494&quot;&gt;&lt;del&gt;TIKA-1494&lt;/del&gt;&lt;/a&gt; Allow supplying a password on a per-request basis via the Password header (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645575&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645575&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/TikaResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/test/java/org/apache/tika/server/MetadataResourceTest.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1494&quot; title=&quot;JAXRS server: allow passing PDF password in the request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1494&quot;&gt;&lt;del&gt;TIKA-1494&lt;/del&gt;&lt;/a&gt; Support fetching the password for Excel .xls files from the ParseContext where given (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645574&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645574&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/AbstractPOIFSExtractor.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ExcelExtractor.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParser.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;br/&gt;
Prepare for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1494&quot; title=&quot;JAXRS server: allow passing PDF password in the request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1494&quot;&gt;&lt;del&gt;TIKA-1494&lt;/del&gt;&lt;/a&gt; - also provide the ParseContext to TikaResource.fillMetadata (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645569&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1645569&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/MetadataEP.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/MetadataResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/TikaResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/UnpackerResource.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14246400" author="peterbowyer" created="Mon, 15 Dec 2014 07:33:05 +0000"  >&lt;p&gt;Thanks Nick, much appreciated!&lt;/p&gt;

&lt;p&gt;As it&apos;s a non-standard HTTP header field&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;, would it be good practice to prefix it with X- or X-Tika- ?&lt;/p&gt;

&lt;p&gt;1. &lt;a href=&quot;http://stackoverflow.com/a/19640336&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://stackoverflow.com/a/19640336&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14246552" author="sergey_beryozkin" created="Mon, 15 Dec 2014 10:59:33 +0000"  >&lt;p&gt;Hi, looks like it is not recommended any longer:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://tools.ietf.org/html/rfc7231#section-8.3.1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://tools.ietf.org/html/rfc7231#section-8.3.1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="14253290" author="peterbowyer" created="Fri, 19 Dec 2014 11:21:38 +0000"  >&lt;p&gt;I have tested with the latest trunk and it works well.&lt;/p&gt;

&lt;p&gt;However, if I don&apos;t pass a password header, I am now able to extract meta data and content from my encrypted PDFs without supplying a password. This only happens via the JAXRS server and not via tika-app.jar. I haven&apos;t found my user error yet (TIKA_PASSWORD wasn&apos;t set, and I set it to a random value to make sure), so reporting.&lt;/p&gt;</comment>
                            <comment id="14253388" author="tpalsulich" created="Fri, 19 Dec 2014 13:36:09 +0000"  >&lt;p&gt;I expanded the testing in r1646707 to make sure extraction doesn&apos;t work when an XLS file is encrypted and you supply the wrong password. But, please see &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1489&quot; title=&quot;PDF Text extraction without permission&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1489&quot;&gt;&lt;del&gt;TIKA-1489&lt;/del&gt;&lt;/a&gt; for a recent discussion about how Tika handles the &quot;don&apos;t extract&quot; permission of encrypted PDFs.&lt;/p&gt;</comment>
                            <comment id="14253397" author="hudson" created="Fri, 19 Dec 2014 13:44:58 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #374 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/374/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/374/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1494&quot; title=&quot;JAXRS server: allow passing PDF password in the request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1494&quot;&gt;&lt;del&gt;TIKA-1494&lt;/del&gt;&lt;/a&gt;. Test that decrypting with the wrong password returns a 500 error in MetadataResourceTest. (tpalsulich: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646707&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646707&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/test/java/org/apache/tika/server/MetadataResourceTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14253413" author="hudson" created="Fri, 19 Dec 2014 14:00:33 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.6 #358 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/358/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/358/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1494&quot; title=&quot;JAXRS server: allow passing PDF password in the request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1494&quot;&gt;&lt;del&gt;TIKA-1494&lt;/del&gt;&lt;/a&gt;. Test that decrypting with the wrong password returns a 500 error in MetadataResourceTest. (tpalsulich: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646707&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646707&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/test/java/org/apache/tika/server/MetadataResourceTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Dec 2014 09:47:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzx8jb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>