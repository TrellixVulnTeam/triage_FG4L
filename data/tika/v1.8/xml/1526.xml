<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:37:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1526/TIKA-1526.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1526] ExternalParser should trap/ignore/workarround JDK-8047340 &amp; JDK-8055301 so Turkish Tika users can still use non-external parsers</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1526</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;the JDK has numerous pain points regarding the Turkish locale, &quot;posix_spawn&quot; lowercasing being one of them...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8047340&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://bugs.openjdk.java.net/browse/JDK-8047340&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8055301&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://bugs.openjdk.java.net/browse/JDK-8055301&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As of Tika 1.7, the TesseractOCRParser (which is an ExternalParser) is enabled &amp;amp; configured by default in Tika, and uses ExternalParser.check to see if tesseract is available &amp;#8211; but because of the JDK bug, this means that Tika fails fast for Turkish users on BSD/UNIX variants (including MacOSX) like so...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  [junit4]    &amp;gt; Throwable #1: java.lang.Error: posix_spawn is not a supported process launch mechanism on this platform.
  [junit4]    &amp;gt; 	at java.lang.UNIXProcess$1.run(UNIXProcess.java:105)
  [junit4]    &amp;gt; 	at java.lang.UNIXProcess$1.run(UNIXProcess.java:94)
  [junit4]    &amp;gt; 	at java.security.AccessController.doPrivileged(Native Method)
  [junit4]    &amp;gt; 	at java.lang.UNIXProcess.&amp;lt;clinit&amp;gt;(UNIXProcess.java:92)
  [junit4]    &amp;gt; 	at java.lang.ProcessImpl.start(ProcessImpl.java:130)
  [junit4]    &amp;gt; 	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)
  [junit4]    &amp;gt; 	at java.lang.Runtime.exec(Runtime.java:620)
  [junit4]    &amp;gt; 	at java.lang.Runtime.exec(Runtime.java:485)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.external.ExternalParser.check(ExternalParser.java:344)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.ocr.TesseractOCRParser.hasTesseract(TesseractOCRParser.java:117)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.ocr.TesseractOCRParser.getSupportedTypes(TesseractOCRParser.java:90)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.CompositeParser.getParsers(CompositeParser.java:81)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.DefaultParser.getParsers(DefaultParser.java:95)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.CompositeParser.getSupportedTypes(CompositeParser.java:229)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.CompositeParser.getParsers(CompositeParser.java:81)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.CompositeParser.getParser(CompositeParser.java:209)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:244)
  [junit4]    &amp;gt; 	at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...unless they go out of their way to white list only the parsers they need/want so TesseractOCRParser (and any other ExternalParsers) will never even be check()ed.&lt;/p&gt;

&lt;p&gt;It would be nice if Tika&apos;s ExternalParser class added a similar hack/workarround to what was done in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6387&quot; title=&quot;Solr specific work around for JDK bug #8047340: posix_spawn error with turkish locale&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6387&quot;&gt;&lt;del&gt;SOLR-6387&lt;/del&gt;&lt;/a&gt; to trap these types of errors.  In Solr we just propogate a better error explaining why Java hates the turkish langauge...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Error err) {
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (err.getMessage() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; (err.getMessage().contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;posix_spawn&quot;&lt;/span&gt;) || err.getMessage().contains(&lt;span class=&quot;code-quote&quot;&gt;&quot;UNIXProcess&quot;&lt;/span&gt;))) {
    log.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error forking command due to JVM locale bug (see https:&lt;span class=&quot;code-comment&quot;&gt;//issues.apache.org/jira/browse/SOLR-6387): &quot;&lt;/span&gt; + err.getMessage());
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;(error executing: &quot;&lt;/span&gt; + cmd + &lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;;
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...but with Tika, it might be better for all ExternalParsers to just &quot;opt out&quot; as if they don&apos;t recognize the filetype when they detect this type of error fro m the check method (or perhaps it would be better if AutoDetectParser handled this? ... i&apos;m not really sure how it would best fit into Tika&apos;s architecture)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12769145">TIKA-1526</key>
            <summary>ExternalParser should trap/ignore/workarround JDK-8047340 &amp; JDK-8055301 so Turkish Tika users can still use non-external parsers</summary>
                <type id="5" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Wish</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hossman">Hoss Man</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Jan 2015 23:03:43 +0000</created>
                <updated>Sat, 28 Mar 2015 14:15:50 +0000</updated>
                            <resolved>Sat, 28 Mar 2015 14:15:50 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14287687" author="tallison@mitre.org" created="Thu, 22 Jan 2015 16:34:31 +0000"  >&lt;p&gt;Thank you, Chris!  Good to see you over here.  Will fix soon.&lt;/p&gt;

&lt;p&gt;Tika&apos;ers, we&apos;re currently swallowing some exceptions when check doesn&apos;t work.  Should we do that with this or do we want to throw an exception from check?&lt;/p&gt;</comment>
                            <comment id="14287766" author="tpalsulich" created="Thu, 22 Jan 2015 17:13:37 +0000"  >&lt;p&gt;I think we should catch the posix_spawn exception in check and return false, so the parser will never be run. &lt;/p&gt;</comment>
                            <comment id="14287770" author="tallison@mitre.org" created="Thu, 22 Jan 2015 17:17:16 +0000"  >&lt;p&gt;K.  Will do.  I&apos;m trying to recreate the bug to make sure the fix works now.&lt;/p&gt;

&lt;p&gt;Trying equivalent of:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;public static void main(final String[] args) { 
 Locale.setDefault(new Locale(&quot;tr&quot;, &quot;&quot;)); 
 try { 
 Process exec = Runtime.getRuntime().exec(&quot;ls&quot;); 
 } 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;from &lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8047340&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;JDK-8047340&lt;/a&gt; now.&lt;/p&gt;</comment>
                            <comment id="14287791" author="hossman" created="Thu, 22 Jan 2015 17:22:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think we should catch the posix_spawn exception in check and return false, so the parser will never be run. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Please note the specific code Solr uses, cited in the issue description - checking the Error only for &quot;posix_spawn&quot; may not be enough depending on wether multiple code paths may encounter this error in the lifecycle of the process &amp;#8211; see this comment where we also started checking for &quot;UNIXProcess&quot; in the err msg...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6387?focusedCommentId=14102638&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14102638&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-6387?focusedCommentId=14102638&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14102638&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14287818" author="tallison@mitre.org" created="Thu, 22 Jan 2015 17:34:23 +0000"  >&lt;p&gt;Not having luck reproducing with openjdk-1.7.0.71 or 1.8.0_31 on RHEL.&lt;/p&gt;

&lt;p&gt;To confirm, this is a BSD/Mac issue only as suggested &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6387?focusedCommentId=14100067&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14100067&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;?&lt;/p&gt;

&lt;p&gt;If so, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tpalsulich&quot; class=&quot;user-hover&quot; rel=&quot;tpalsulich&quot;&gt;Tyler Palsulich&lt;/a&gt;, would you have time to try something like this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   public void testPDFOCR() throws Exception {
        Locale defaultLocale = Locale.getDefault();
        try {
             Locale.setDefault(new Locale(&quot;tr&quot;, &quot;&quot;));
             String resource = &quot;/test-documents/testOCR.pdf&quot;;
             String[] nonOCRContains = new String[0];
             testBasicOCR(resource, nonOCRContains, 2);
        } finally {
             Locale.setDefault(defaultLocale);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14287820" author="thetaphi" created="Thu, 22 Jan 2015 17:34:46 +0000"  >&lt;p&gt;FYI: The underlying bug in the JVM will never be fixed in Java 6. Java 9 previews are no longer affected, but Java 7 and Java 8 are still broken (inclduing the update from yesterday). Oracle possibly will fix in 7u80 (last Java 7 release before EOL) and 8u40.&lt;/p&gt;</comment>
                            <comment id="14287824" author="thetaphi" created="Thu, 22 Jan 2015 17:35:46 +0000"  >&lt;p&gt;Tim: Linux does not use posix spawn. You ned MacOSX or Solaris. Oracle has a completely different implementation for spawning processes in Linux.&lt;/p&gt;</comment>
                            <comment id="14287829" author="tallison@mitre.org" created="Thu, 22 Jan 2015 17:38:02 +0000"  >&lt;p&gt;Thank you, Uwe!&lt;/p&gt;</comment>
                            <comment id="14287850" author="thetaphi" created="Thu, 22 Jan 2015 17:48:20 +0000"  >&lt;p&gt;There is also a second problem: The bug is in the static {} initializer of the UNIXProcess class. So it happens only when the class is loaded first. If it was loaded correctly, the class is initialized with right settings and passes (in fact, also with turkish locale). But if it fails for the first time, UNIXProcess is broken for the whole lifetime of the JVM (also with good locales). Because UNIXProcess failed to initialize, the JVM marks it as broken and you get a NoClassDefFound error.&lt;/p&gt;

&lt;p&gt;The problem does not happen on Linux, because the default value of the problematic system property is there initialized with some other value, that does not contain &quot;i&quot; which is affected by the famous upper/lowercasing bug: &lt;a href=&quot;http://blog.thetaphi.de/2012/07/default-locales-default-charsets-and.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://blog.thetaphi.de/2012/07/default-locales-default-charsets-and.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So if some other test is executing some external process before and has non-Turkish locale, also calls with turkish succeed. Because of that we test Lucene with all possible Locales set before the JVM is starting. We don&apos;t switch the locale actively during tests.&lt;/p&gt;</comment>
                            <comment id="14287881" author="tallison@mitre.org" created="Thu, 22 Jan 2015 18:10:50 +0000"  >&lt;p&gt;Got it.  So, if someone on a Mac with Java 1.6 or 1.7 adds this to the pom for a one-off test, this should trigger the problem in our TesseractOCRParser tests:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    &amp;lt;plugin&amp;gt;
        &amp;lt;groupId&amp;gt;org.apache.maven.plugins&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;maven-surefire-plugin&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;2.9&amp;lt;/version&amp;gt;
        &amp;lt;configuration&amp;gt;
            &amp;lt;systemPropertyVariables&amp;gt;
                &amp;lt;user.language&amp;gt;tr&amp;lt;/user.language&amp;gt;
                &amp;lt;user.region&amp;gt;TR&amp;lt;/user.region&amp;gt;
            &amp;lt;/systemPropertyVariables&amp;gt;
        &amp;lt;/configuration&amp;gt; 
    &amp;lt;/plugin&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or a temporary:&lt;br/&gt;
set MAVEN_OPTS= -Duser.language=tr&lt;/p&gt;</comment>
                            <comment id="14287929" author="tpalsulich" created="Thu, 22 Jan 2015 18:29:45 +0000"  >&lt;p&gt;Yup! I can test this by EOD today, if no one beats me to it.&lt;/p&gt;</comment>
                            <comment id="14287933" author="tallison@mitre.org" created="Thu, 22 Jan 2015 18:32:33 +0000"  >&lt;p&gt;Thank you, Tyler.  I added a catch as recommended by Hoss Man in r1653994.  Tyler, if you&apos;re able to reproduce the problem before r1653994 and then confirm that it is fixed with that change, that&apos;d be great.&lt;/p&gt;
</comment>
                            <comment id="14287944" author="thetaphi" created="Thu, 22 Jan 2015 18:38:11 +0000"  >&lt;p&gt;Commit looks fine! I can try later with MacOSX.&lt;/p&gt;</comment>
                            <comment id="14287947" author="tallison@mitre.org" created="Thu, 22 Jan 2015 18:39:56 +0000"  >&lt;p&gt;And the race is on, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;Uwe Schindler&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tpalsulich&quot; class=&quot;user-hover&quot; rel=&quot;tpalsulich&quot;&gt;Tyler Palsulich&lt;/a&gt;! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14287981" author="hudson" created="Thu, 22 Jan 2015 18:57:29 +0000"  >&lt;p&gt;UNSTABLE: Integrated in tika-trunk-jdk1.7 #446 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/446/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/446/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1526&quot; title=&quot;ExternalParser should trap/ignore/workarround JDK-8047340 &amp;amp; JDK-8055301 so Turkish Tika users can still use non-external parsers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1526&quot;&gt;&lt;del&gt;TIKA-1526&lt;/del&gt;&lt;/a&gt;: initial fix for jvm bug that can affect users with a default Locale of tr running on MACOSX or BSD.  We still need to confirm that this fixes the problem and/or add a unit test. (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1653994&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1653994&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14288081" author="hudson" created="Thu, 22 Jan 2015 19:37:09 +0000"  >&lt;p&gt;UNSTABLE: Integrated in tika-trunk-jdk1.6 #431 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/431/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/431/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1526&quot; title=&quot;ExternalParser should trap/ignore/workarround JDK-8047340 &amp;amp; JDK-8055301 so Turkish Tika users can still use non-external parsers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1526&quot;&gt;&lt;del&gt;TIKA-1526&lt;/del&gt;&lt;/a&gt;: initial fix for jvm bug that can affect users with a default Locale of tr running on MACOSX or BSD.  We still need to confirm that this fixes the problem and/or add a unit test. (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1653994&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1653994&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14288365" author="tpalsulich" created="Thu, 22 Jan 2015 22:47:07 +0000"  >&lt;p&gt;I saw the error once, but haven&apos;t been able to replicate it since then (with revisions before and including your fix, Tim)... Could this be related to static initialization?&lt;/p&gt;</comment>
                            <comment id="14288444" author="thetaphi" created="Thu, 22 Jan 2015 23:27:30 +0000"  >&lt;p&gt;Hi Tylor: The problem is explained above. To reproduce the problem you have to be careful: The original error happens &lt;b&gt;exactly once&lt;/b&gt;. All later tries to use the same JVM will cause a NoClassDefFoundError on UnixProcess class. Unfortunately I am very tired at the moment, it is past midnight.&lt;/p&gt;

&lt;p&gt;The main problem is that all other ExternalParserTests will/may fail afterwards in the same JVM if the turkish locale is used.&lt;/p&gt;

&lt;p&gt;The commit will fix the issue we see in Solr, but the original issue may still survive if you really try to use ExternalParser for other tests. For which other parsers is it used currently? Only for tesseract or also other ones? In Solr we have the problem, because the TesseractParser fails to execute the initialization (which MIME types it is responsble for) - and thats the fatal problem. I have no idea about other parsers, if they just fail while parsing I don&apos;t care. The big problem is the Tesseract parser that fails in turkish locale and blocks other parsers to execute, because the call to getSupportedTypes() fails &lt;span class=&quot;error&quot;&gt;&amp;#91;and thats the horrible thing in this bug&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;So basically to reproduce: Choose exactly one test you know that fails and try with and without the patch. Don&apos;t run other tests that may spawn processes in the same JVM.&lt;/p&gt;</comment>
                            <comment id="14288963" author="thetaphi" created="Fri, 23 Jan 2015 08:21:57 +0000"  >&lt;p&gt;I tried it with maven, but this is all too funny. This bug also affects Maven...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[uschindler@lucene ~]$ export MAVEN_OPTS=-Duser.language=tr
[uschindler@lucene ~]$ mvn
---------------------------------------------------
constituent[0]: file:/usr/local/share/java/maven3/lib/aether-connector-wagon-1.13.1.jar
constituent[1]: file:/usr/local/share/java/maven3/lib/maven-repository-metadata-3.0.4.jar
constituent[2]: file:/usr/local/share/java/maven3/lib/plexus-sec-dispatcher-1.3.jar
constituent[3]: file:/usr/local/share/java/maven3/lib/aether-spi-1.13.1.jar
constituent[4]: file:/usr/local/share/java/maven3/lib/maven-compat-3.0.4.jar
constituent[5]: file:/usr/local/share/java/maven3/lib/plexus-component-annotations-1.5.5.jar
constituent[6]: file:/usr/local/share/java/maven3/lib/plexus-cipher-1.7.jar
constituent[7]: file:/usr/local/share/java/maven3/lib/sisu-guava-0.9.9.jar
constituent[8]: file:/usr/local/share/java/maven3/lib/maven-core-3.0.4.jar
constituent[9]: file:/usr/local/share/java/maven3/lib/plexus-utils-2.0.6.jar
constituent[10]: file:/usr/local/share/java/maven3/lib/wagon-provider-api-2.2.jar
constituent[11]: file:/usr/local/share/java/maven3/lib/maven-plugin-api-3.0.4.jar
constituent[12]: file:/usr/local/share/java/maven3/lib/maven-model-builder-3.0.4.jar
constituent[13]: file:/usr/local/share/java/maven3/lib/maven-settings-3.0.4.jar
constituent[14]: file:/usr/local/share/java/maven3/lib/sisu-inject-bean-2.3.0.jar
constituent[15]: file:/usr/local/share/java/maven3/lib/wagon-http-2.2-shaded.jar
constituent[16]: file:/usr/local/share/java/maven3/lib/maven-aether-provider-3.0.4.jar
constituent[17]: file:/usr/local/share/java/maven3/lib/sisu-inject-plexus-2.3.0.jar
constituent[18]: file:/usr/local/share/java/maven3/lib/maven-artifact-3.0.4.jar
constituent[19]: file:/usr/local/share/java/maven3/lib/maven-model-3.0.4.jar
constituent[20]: file:/usr/local/share/java/maven3/lib/wagon-file-2.2.jar
constituent[21]: file:/usr/local/share/java/maven3/lib/maven-embedder-3.0.4.jar
constituent[22]: file:/usr/local/share/java/maven3/lib/sisu-guice-3.1.0-no_aop.jar
constituent[23]: file:/usr/local/share/java/maven3/lib/maven-settings-builder-3.0.4.jar
constituent[24]: file:/usr/local/share/java/maven3/lib/plexus-interpolation-1.14.jar
constituent[25]: file:/usr/local/share/java/maven3/lib/aether-impl-1.13.1.jar
constituent[26]: file:/usr/local/share/java/maven3/lib/aether-api-1.13.1.jar
constituent[27]: file:/usr/local/share/java/maven3/lib/aether-util-1.13.1.jar
constituent[28]: file:/usr/local/share/java/maven3/lib/commons-cli-1.2.jar
---------------------------------------------------
Exception in thread &quot;main&quot; java.lang.Error: posix_spawn is not a supported process launch mechanism on this platform.
        at java.lang.UNIXProcess$1.run(UNIXProcess.java:111)
        at java.lang.UNIXProcess$1.run(UNIXProcess.java:93)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.lang.UNIXProcess.&amp;lt;clinit&amp;gt;(UNIXProcess.java:91)
        at java.lang.ProcessImpl.start(ProcessImpl.java:130)
        at java.lang.ProcessBuilder.start(ProcessBuilder.java:1028)
        at java.lang.Runtime.exec(Runtime.java:617)
        at java.lang.Runtime.exec(Runtime.java:450)
        at java.lang.Runtime.exec(Runtime.java:347)
        at org.codehaus.plexus.interpolation.os.OperatingSystemUtils.getSystemEnvVars(OperatingSystemUtils.java:86)
        at org.codehaus.plexus.interpolation.EnvarBasedValueSource.getEnvars(EnvarBasedValueSource.java:74)
        at org.codehaus.plexus.interpolation.EnvarBasedValueSource.&amp;lt;init&amp;gt;(EnvarBasedValueSource.java:64)
        at org.codehaus.plexus.interpolation.EnvarBasedValueSource.&amp;lt;init&amp;gt;(EnvarBasedValueSource.java:50)
        at org.apache.maven.settings.building.DefaultSettingsBuilder.interpolate(DefaultSettingsBuilder.java:222)
        at org.apache.maven.settings.building.DefaultSettingsBuilder.build(DefaultSettingsBuilder.java:101)
        at org.apache.maven.cli.MavenCli.settings(MavenCli.java:725)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:193)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:606)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
        at org.codehaus.classworlds.Launcher.main(Launcher.java:47)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So you are not able to run Maven for the same reasons on Turkish Locale &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; This bug is insane!&lt;/p&gt;</comment>
                            <comment id="14288977" author="grossws" created="Fri, 23 Jan 2015 08:42:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;Uwe Schindler&lt;/a&gt;, they fixed this in 2.0 RC some time ago.. &lt;a href=&quot;http://jira.codehaus.org/browse/MNG-597&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://jira.codehaus.org/browse/MNG-597&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As I can see, you have Maven 3. Can you create an issue there with your environment description?&lt;/p&gt;</comment>
                            <comment id="14289125" author="thetaphi" created="Fri, 23 Jan 2015 11:48:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=grossws&quot; class=&quot;user-hover&quot; rel=&quot;grossws&quot;&gt;Konstantin Gribov&lt;/a&gt;: This bug is not in Maven itsself, the problem here is unsolved bug in the JDK itsself. Maven is perfectly fine, but because of the JDK bug, Maven cannot spawn external processes.&lt;/p&gt;</comment>
                            <comment id="14289172" author="grossws" created="Fri, 23 Jan 2015 12:24:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;Uwe Schindler&lt;/a&gt;, I understand that this is jdk bug with &lt;tt&gt;tr&lt;/tt&gt; locale. Can they use some workaround with &lt;tt&gt;Locale.setDefault&lt;/tt&gt; if user&apos;s locale is &lt;tt&gt;tr&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="14289182" author="thetaphi" created="Fri, 23 Jan 2015 12:32:25 +0000"  >&lt;p&gt;To work around this bug you can in fact do this. It is just bad to change User&apos;s default locale, which may especially break multi-threaded applications.&lt;/p&gt;

&lt;p&gt;One solution could be:&lt;br/&gt;
During startup of the JVM (in the Plexus launcher&apos;s main method) you can do the following:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check for locale, we do this like that: &lt;tt&gt;new Locale(&quot;tr&quot;).getLanguage().equals(Locale.getDefault().getLanguage())&lt;/tt&gt; (it is important to do the check like this, because otherwise its not guaranteed that it really works, especially in newer java versions!!!)&lt;/li&gt;
	&lt;li&gt;if its such a locale, switch to Locale.ROOT (save original) in a single-threaded environment (this is why it should be in main launcher)&lt;/li&gt;
	&lt;li&gt;execute a fake UNIX command, like /bin/true. You can also execute some non-existing bullshit that just fails. The call is just there to statically initalize the broken UnixProcess class. Once it is initialized correctly it works&lt;/li&gt;
	&lt;li&gt;switch back to saved locale&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14289419" author="tpalsulich" created="Fri, 23 Jan 2015 15:43:04 +0000"  >&lt;p&gt;This is exactly how I saw the bug. I was confused that no tests were running, tried switching a config, and never saw the error again (as discussed).&lt;/p&gt;</comment>
                            <comment id="14294100" author="tpalsulich" created="Tue, 27 Jan 2015 20:06:59 +0000"  >&lt;p&gt;Do we know if the update fixed the issue? We can&apos;t run a test case if we can&apos;t start up Maven... So, can you try running Solr with Tika 1.8-SNAPSHOT?&lt;/p&gt;</comment>
                            <comment id="14329350" author="thetaphi" created="Fri, 20 Feb 2015 18:50:16 +0000"  >&lt;p&gt;I was not able to test this, because I have no MacOSX computer and FreeBSD is only a Jenkins server....&lt;/p&gt;

&lt;p&gt;Maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dadoonet&quot; class=&quot;user-hover&quot; rel=&quot;dadoonet&quot;&gt;David Pilato&lt;/a&gt; can try the same with elasticsearch-mapper-attachments module.&lt;/p&gt;</comment>
                            <comment id="14333470" author="dadoonet" created="Mon, 23 Feb 2015 16:34:11 +0000"  >&lt;p&gt;I just ran a test on my machine:&lt;/p&gt;

&lt;p&gt;With Tika 1.7 and Locale=tr, it fails.&lt;br/&gt;
With Tika 1.8-SNAPSHOT and Locale=tr, it passes.&lt;/p&gt;

&lt;p&gt;So I can confirm that the current patch in trunk fixes it. \o/&lt;/p&gt;

&lt;p&gt;Hope this helps.&lt;/p&gt;</comment>
                            <comment id="14333628" author="thetaphi" created="Mon, 23 Feb 2015 18:29:36 +0000"  >&lt;p&gt;Thanks David!&lt;/p&gt;</comment>
                            <comment id="14385325" author="tpalsulich" created="Sat, 28 Mar 2015 14:15:50 +0000"  >&lt;p&gt;Marking this as Fixed, per the above comments. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;Uwe Schindler&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;Hoss Man&lt;/a&gt; or anyone else, please reopen this if you find any other cases.&lt;/p&gt;

&lt;p&gt;Thank you everyone for the help!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12734656">SOLR-6387</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12382308">TIKA-93</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12755677">TIKA-1476</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12768065">SOLR-6991</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 22 Jan 2015 16:34:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzyiqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>