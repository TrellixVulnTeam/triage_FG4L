<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:38:54 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1113/TIKA-1113.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1113] Parsing for OGV file results in java.lang.ClassCastException</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1113</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;When parsing any OGV file (e.g., &lt;a href=&quot;http://www.808.dk/pics/video/gizmo.ogv&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;gizmo.ogv&lt;/a&gt;), log will output something like the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Warning - invalid checksum on page 2 of stream 3f1 (1009)
Warning - invalid checksum on page 3 of stream 3f1 (1009)
Warning - invalid checksum on page 4 of stream 3f1 (1009)
Warning - invalid checksum on page 5 of stream 3f1 (1009)
Warning - invalid checksum on page 6 of stream 3f1 (1009)
Warning - invalid checksum on page 7 of stream 3f1 (1009)
Warning - invalid checksum on page 22 of stream 3f1 (1009)
Warning - invalid checksum on page 33 of stream 3f1 (1009)
Warning - invalid checksum on page 34 of stream 3f1 (1009)
Warning - invalid checksum on page 35 of stream 3f1 (1009)
Warning - invalid checksum on page 36 of stream 3f1 (1009)
Warning - invalid checksum on page 37 of stream 3f1 (1009)
Warning - invalid checksum on page 38 of stream 3f1 (1009)
Warning - invalid checksum on page 52 of stream 3f1 (1009)
Warning - invalid checksum on page 65 of stream 3f1 (1009)
Warning - invalid checksum on page 69 of stream 3f1 (1009)
Warning - invalid checksum on page 75 of stream 3f1 (1009)
Warning - invalid checksum on page 76 of stream 3f1 (1009)
Warning - invalid checksum on page 77 of stream 3f1 (1009)
Warning - invalid checksum on page 78 of stream 3f1 (1009)
Warning - invalid checksum on page 79 of stream 3f1 (1009)
Warning - invalid checksum on page 80 of stream 3f1 (1009)
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; org.apache.tika.exception.TikaException: Unexpected RuntimeException from org.gagravarr.tika.VorbisParser@7c29e357
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:244)
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)
	at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)
	at com.test.OGVTest.main(OGVTest.java:31)
Caused by: java.lang.ClassCastException: org.gagravarr.vorbis.VorbisAudioData cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to org.gagravarr.vorbis.VorbisInfo
	at org.gagravarr.vorbis.VorbisFile.&amp;lt;init&amp;gt;(VorbisFile.java:78)
	at org.gagravarr.vorbis.VorbisFile.&amp;lt;init&amp;gt;(VorbisFile.java:55)
	at org.gagravarr.tika.VorbisParser.parse(VorbisParser.java:58)
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)
	... 3 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Testcode is the following:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;OGVTest.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

	void parse(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
		InputStream inputStream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileInputStream(fileName);
		
		Metadata metadata = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Metadata();
		
		Parser parser = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AutoDetectParser();
		
		ParseContext parserContext = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ParseContext();

		parserContext.set(Parser.class, parser);

		ContentHandler contentHandler = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; WriteOutContentHandler(
			&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DummyWriter());

		parser.parse(inputStream, contentHandler, metadata, parserContext);
		
		&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(metadata);
	}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;OS X 10.8.3&lt;br/&gt;
JDK 1.6.0_45 64-bit&lt;/p&gt;</environment>
        <key id="12644628">TIKA-1113</key>
            <summary>Parsing for OGV file results in java.lang.ClassCastException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="achow">Alexander Chow</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Apr 2013 17:43:50 +0100</created>
                <updated>Tue, 18 Mar 2014 13:09:06 +0000</updated>
                            <resolved>Tue, 18 Mar 2014 13:09:06 +0000</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.6</fixVersion>
                                    <component>metadata</component>
                    <component>parser</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13756325" author="arundaskd" created="Tue, 3 Sep 2013 04:02:33 +0100"  >&lt;p&gt;Any update on this issue??&lt;/p&gt;</comment>
                            <comment id="13931680" author="fabianlange" created="Wed, 12 Mar 2014 12:03:36 +0000"  >&lt;p&gt;This is still a bug in 1.5. We observed it by parsing the BigBuckBunny ogg video during tests. The TypeDetector detects it as audio/ogg instead of video/ogg followed by the above class cast exception during parsing.&lt;br/&gt;
Can we expedite the fix somehow? I can contribute testing. &lt;/p&gt;</comment>
                            <comment id="13931681" author="gagravarr" created="Wed, 12 Mar 2014 12:08:29 +0000"  >&lt;p&gt;This needs reporting upstream to the Vorbis Java project - &lt;a href=&quot;https://github.com/Gagravarr/VorbisJava&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/Gagravarr/VorbisJava&lt;/a&gt; - and will need a fix there. Ideally a very small video file that shows the problem is also needed, which can be used as part of unit tests for it. (Not sure we want to be committing the full BigBuckBunny video file to the source repo just for a unit test!)&lt;/p&gt;</comment>
                            <comment id="13931683" author="fabianlange" created="Wed, 12 Mar 2014 12:10:32 +0000"  >&lt;p&gt;Thanks Nick, will do. I thought it is caused by org.gagravarr.tika.VorbisParser.parse. But after checking the source its obvious its an upstream bug.&lt;/p&gt;</comment>
                            <comment id="13931708" author="fabianlange" created="Wed, 12 Mar 2014 12:34:09 +0000"  >&lt;p&gt;It seems VorbisJava has a newer version but i cannot find where the maven artefacts are. where does 0.1 come from for you? central?&lt;/p&gt;</comment>
                            <comment id="13931713" author="gagravarr" created="Wed, 12 Mar 2014 12:39:53 +0000"  >&lt;p&gt;Tika trunk has recently upgraded to 0.3. Both 0.1 and 0.3 are on maven central, via the sonatype OSS repo&lt;/p&gt;</comment>
                            <comment id="13931725" author="fabianlange" created="Wed, 12 Mar 2014 12:57:53 +0000"  >&lt;p&gt;Thanks Nick, i got it. Reproduced on 0.3 as well, ticket created upstream at &lt;a href=&quot;https://github.com/Gagravarr/VorbisJava/issues/3&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/Gagravarr/VorbisJava/issues/3&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13933086" author="fabianlange" created="Thu, 13 Mar 2014 10:48:31 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
this is partly Tikas fault as well.&lt;br/&gt;
the upstream detector has no support for video yet (todo) and such returns &quot;application/ogg&quot;&lt;br/&gt;
next up is the tika mime detector, which detects &quot;audio/ogg&quot;.&lt;br/&gt;
As this is more specialised it wins, and will cause the upstream audio detector to kick in. as the file is a video, it will fail.&lt;/p&gt;

&lt;p&gt;I tried to fix the magic file for audio/ogg but failed to do so (overriding default mimetypes via custom etc didnt work)&lt;/p&gt;

&lt;p&gt;I found that here &lt;a href=&quot;https://bugs.freedesktop.org/show_bug.cgi?id=1002&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://bugs.freedesktop.org/show_bug.cgi?id=1002&lt;/a&gt; is a mime magic list for the ogg types that should be used&lt;/p&gt;

&lt;p&gt;Could you fix the mime magic detector? a 400kb test file for video is here: &lt;a href=&quot;http://techslides.com/demos/sample-videos/small.ogv&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://techslides.com/demos/sample-videos/small.ogv&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13933096" author="gagravarr" created="Thu, 13 Mar 2014 10:58:51 +0000"  >&lt;p&gt;I noticed earlier today that we were missing a few of the ogg related mime types, so I&apos;ve raised &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1259&quot; title=&quot;More ogg based mime entries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1259&quot;&gt;&lt;del&gt;TIKA-1259&lt;/del&gt;&lt;/a&gt; to track adding them. Hopefully I&apos;ll get to that over the next few days&lt;/p&gt;</comment>
                            <comment id="13939160" author="gagravarr" created="Tue, 18 Mar 2014 13:09:06 +0000"  >&lt;p&gt;In r1578857 we have upgrade to v0.4 of the ogg parser, which solves this issue&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12644627">TIKA-1112</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 3 Sep 2013 03:02:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>324993</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzdx4n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>325338</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>