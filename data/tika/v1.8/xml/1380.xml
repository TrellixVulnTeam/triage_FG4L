<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:38:53 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1380/TIKA-1380.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1380] Upgrade to Apache POI 3.11 beta 1</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1380</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;All being well, in a week there&apos;ll be a new release of Apache POI available, 3.11 beta 1&lt;/p&gt;

&lt;p&gt;This issue is to track the upgrade, any required changes, and fixing any TODOs that this upgrade permits&lt;/p&gt;</description>
                <environment></environment>
        <key id="12730817">TIKA-1380</key>
            <summary>Upgrade to Apache POI 3.11 beta 1</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gagravarr">Nick Burch</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Jul 2014 16:52:22 +0100</created>
                <updated>Mon, 25 Aug 2014 10:49:38 +0100</updated>
                            <resolved>Tue, 5 Aug 2014 20:02:51 +0100</resolved>
                                    <version>1.6</version>
                                    <fixVersion>1.6</fixVersion>
                    <fixVersion>1.7</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14082309" author="gagravarr" created="Fri, 1 Aug 2014 15:58:05 +0100"  >&lt;p&gt;The attached patch fixes the handful of breaking api changes (which mostly make things easier), and explicitly requests that NPOIFS opens things re-only. With this applied, and the POI 3.11 beta 1 release candidate installed, all tests pass&lt;/p&gt;</comment>
                            <comment id="14082488" author="tallison@mitre.org" created="Fri, 1 Aug 2014 17:54:18 +0100"  >&lt;p&gt;A test in CLI needs a small change:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;testExtract(org.apache.tika.cli.TikaCLITest)  Time elapsed: 0.516 sec  &amp;lt;&amp;lt;&amp;lt; FAILURE!
java.lang.AssertionError: File MBD002B0FA6_file5 not found in MBD002B040A.cdx : file1.emf : MBD002B0FA6 : file2.emf : file0.emf : MBD00262FE3.txt : file3.emf : file4.png
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Strip out the &quot;_file5&quot; in the expected value and all works well.  Is this ok?&lt;/p&gt;

&lt;p&gt;I&apos;ll submit a patch that includes your original patch, this small modification, and the necessary changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1317&quot; title=&quot;Tika does not read text from Headers, Cover Pages, and SDT components of DOCX documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1317&quot;&gt;&lt;del&gt;TIKA-1317&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Thank you, Nick!&lt;/p&gt;</comment>
                            <comment id="14082565" author="tallison@mitre.org" created="Fri, 1 Aug 2014 18:24:17 +0100"  >&lt;p&gt;This includes Nick&apos;s patch, the small change in CLITest and a small change for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1317&quot; title=&quot;Tika does not read text from Headers, Cover Pages, and SDT components of DOCX documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1317&quot;&gt;&lt;del&gt;TIKA-1317&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I need to commit an updated version of testWORD_missing_text.docx to work with a test I added for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1317&quot; title=&quot;Tika does not read text from Headers, Cover Pages, and SDT components of DOCX documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1317&quot;&gt;&lt;del&gt;TIKA-1317&lt;/del&gt;&lt;/a&gt;.  Will commit that as a standalone commit shortly.&lt;/p&gt;</comment>
                            <comment id="14082792" author="hudson" created="Fri, 1 Aug 2014 20:21:13 +0100"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #135 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/135/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/135/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt;: staging an updated test file for the actual patch once POI 3.11-beta-1 is released (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615174&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615174&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testWORD_missing_text.docx&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14083747" author="kiwiwings" created="Sat, 2 Aug 2014 22:36:12 +0100"  >&lt;p&gt;Nicks patch missed the comments table on a few lines.&lt;br/&gt;
This patch also contains Nicks changes on XSSFExcelExtractorDecorator - I haven&apos;t checked, how to create an incremental patch ...&lt;/p&gt;</comment>
                            <comment id="14084532" author="gagravarr" created="Mon, 4 Aug 2014 11:45:57 +0100"  >&lt;p&gt;Updated patch, including fixes from Tim and Andreas&apos;s patches&lt;/p&gt;

&lt;p&gt;This should be ready to go, just as soon as Maven Central does a sync and notices that 3.11 beta 1 is out....&lt;/p&gt;</comment>
                            <comment id="14084537" author="tallison@mitre.org" created="Mon, 4 Aug 2014 12:06:28 +0100"  >&lt;p&gt;Thank you, Nick!  I just noticed that we should bump Tika&apos;s codec to 1.9 to sync with POI... I think?&lt;/p&gt;

&lt;p&gt;I&apos;ll plan to submit/commit a separate patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1317&quot; title=&quot;Tika does not read text from Headers, Cover Pages, and SDT components of DOCX documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1317&quot;&gt;&lt;del&gt;TIKA-1317&lt;/del&gt;&lt;/a&gt; after this is committed?&lt;/p&gt;

&lt;p&gt;Thank you, again!&lt;/p&gt;</comment>
                            <comment id="14084583" author="tallison@mitre.org" created="Mon, 4 Aug 2014 13:13:33 +0100"  >&lt;p&gt;Added simple tests for comments in xls and xlsx: r1615538&lt;/p&gt;</comment>
                            <comment id="14084606" author="hudson" created="Mon, 4 Aug 2014 13:44:01 +0100"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #139 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/139/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/139/&lt;/a&gt;)&lt;br/&gt;
added test and test docs for comments in xls and xlsx; lack of tests detected during work on &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615538&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615538&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testEXCEL_comments.xls&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testEXCEL_comments.xlsx&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14084813" author="gagravarr" created="Mon, 4 Aug 2014 16:56:00 +0100"  >&lt;p&gt;Patch committed in r1615624 to trunk, and in r1615636 to the 1.6 branch. (Related changes / enhancements should probably only be on trunk)&lt;/p&gt;

&lt;p&gt;We should now be ready for Chris to roll 1.6 RC2!&lt;/p&gt;</comment>
                            <comment id="14084817" author="tallison@mitre.org" created="Mon, 4 Aug 2014 16:59:28 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gagravarr&quot; class=&quot;user-hover&quot; rel=&quot;gagravarr&quot;&gt;Nick Burch&lt;/a&gt; and all, would you have an objection to me adding the few lines of code for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1317&quot; title=&quot;Tika does not read text from Headers, Cover Pages, and SDT components of DOCX documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1317&quot;&gt;&lt;del&gt;TIKA-1317&lt;/del&gt;&lt;/a&gt; to the 1.6 branch?&lt;/p&gt;</comment>
                            <comment id="14084820" author="tallison@mitre.org" created="Mon, 4 Aug 2014 17:00:48 +0100"  >&lt;p&gt;Also, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gagravarr&quot; class=&quot;user-hover&quot; rel=&quot;gagravarr&quot;&gt;Nick Burch&lt;/a&gt;, should we bump codec to 1.9 to sync with POI 3.11 beta 1 for both 1.6 and trunk?  I notice that it was bumped to 1.9 for trunk, but not for the Tika 1.6 branch yet.&lt;/p&gt;</comment>
                            <comment id="14084906" author="gagravarr" created="Mon, 4 Aug 2014 18:11:13 +0100"  >&lt;p&gt;As of r1615692, I&apos;ve addressed all the TODOs that I can do on trunk for the POI-based parsers. &lt;/p&gt;

&lt;p&gt;Excluding the ones relating to old-style metadata keys, there&apos;s about a dozen TODOs still remaining. Most will need small-ish fixes/enhancements on the POI side, then maybe the odd bit of Tika code post-upgrade. Volunteers welcome!&lt;/p&gt;</comment>
                            <comment id="14084932" author="hudson" created="Mon, 4 Aug 2014 18:28:46 +0100"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #140 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/140/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/140/&lt;/a&gt;)&lt;br/&gt;
Address the remainder of the test TODOs that we can following the POI upgrade in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615692&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615692&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/OutlookParserTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;br/&gt;
Enable more tests / TODOs now that we have upgraded POI with &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615683&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615683&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;br/&gt;
Switch from assertTrue(containts) to assertContains, to give better failure messages, and enable one now-passing test following &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615671&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615671&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;br/&gt;
Enable the POI fraction test, as it now passes with the latest POI release (&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt;) (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615660&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615660&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;br/&gt;
Convert from assertTrue(contains) to assertContains, to make addressing TODOs and failures much easier, for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615642&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615642&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/TikaTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;br/&gt;
Upgrade the Commons Codec version to match that in Apache POI, upgraded in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615631&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615631&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/pom.xml&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; Upgrade to Apache POI 3.11 beta 1 (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615624&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615624&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/pom.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParser.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/POIFSContainerDetector.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14086159" author="tallison@mitre.org" created="Tue, 5 Aug 2014 13:02:36 +0100"  >&lt;p&gt;The 1.6 branch and trunk are failing one test on Windows.&lt;/p&gt;

&lt;p&gt;testExtract(org.apache.tika.cli.TikaCLITest): File MBD002B0FA6 wasn&apos;t extracted with contents&lt;/p&gt;

&lt;p&gt;For this file, the extractor creates a directory named MDB002B0FA6 and places a file within it named &quot;null.bin&quot;.  So, when the test checks to make sure that  MBD002B0FA6 is greater than 0 bytes, if fails on the directory on Windows, but not on Linux.&lt;/p&gt;

&lt;p&gt;Do we want to change the test or the behavior of AbstractPOIFSExtractor?&lt;/p&gt;</comment>
                            <comment id="14086164" author="gagravarr" created="Tue, 5 Aug 2014 13:05:47 +0100"  >&lt;p&gt;&amp;lt;name&amp;gt;/null.bin doesn&apos;t sound right to me. I think a fix to AbstractPOIFSExtractor is probably required, along with adding an assert to the unit test to check that it&apos;s a file not a directory&lt;/p&gt;</comment>
                            <comment id="14086173" author="hudson" created="Tue, 5 Aug 2014 13:15:20 +0100"  >&lt;p&gt;ABORTED: Integrated in tika-trunk-jdk1.6 #126 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/126/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/126/&lt;/a&gt;)&lt;br/&gt;
Address the remainder of the test TODOs that we can following the POI upgrade in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615692&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615692&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/OutlookParserTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/PowerPointParserTest.java&lt;br/&gt;
Enable more tests / TODOs now that we have upgraded POI with &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615683&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615683&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;br/&gt;
Switch from assertTrue(containts) to assertContains, to give better failure messages, and enable one now-passing test following &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615671&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615671&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;br/&gt;
Enable the POI fraction test, as it now passes with the latest POI release (&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt;) (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615660&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615660&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;br/&gt;
Convert from assertTrue(contains) to assertContains, to make addressing TODOs and failures much easier, for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615642&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615642&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/TikaTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;br/&gt;
Upgrade the Commons Codec version to match that in Apache POI, upgraded in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615631&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615631&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/pom.xml&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; Upgrade to Apache POI 3.11 beta 1 (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615624&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615624&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/pom.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParser.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/POIFSContainerDetector.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XSSFExcelExtractorDecorator.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/XWPFWordExtractorDecorator.java&lt;br/&gt;
added test and test docs for comments in xls and xlsx; lack of tests detected during work on &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615538&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615538&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ExcelParserTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/parser/microsoft/ooxml/OOXMLParserTest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testEXCEL_comments.xls&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testEXCEL_comments.xlsx&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14086189" author="tallison@mitre.org" created="Tue, 5 Aug 2014 13:25:33 +0100"  >&lt;p&gt;Something along these lines:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (type == POIFSDocumentType.OLE10_NATIVE) {
                try {
                    // Try to un-wrap the OLE10Native record:
                    Ole10Native ole = Ole10Native.createFromEmbeddedOleObject((DirectoryNode)dir);
                    String label = ole.getLabel();

                    if (label == null){
                        label = &quot;unknown_&quot;+unknownFileNum++;
                    }
                    metadata.set(Metadata.RESOURCE_NAME_KEY, dir.getName() + &apos;/&apos; + label);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;yields a RESOURCE_NAME_KEY of:&lt;br/&gt;
MBD002B0FA6/unknown_0&lt;/p&gt;

&lt;p&gt;Or, if label is null, do we just want to use the directory name?  Perhaps with an unknownFileNum appended to prevent clashes?&lt;/p&gt;</comment>
                            <comment id="14086192" author="gagravarr" created="Tue, 5 Aug 2014 13:31:58 +0100"  >&lt;p&gt;The previous version seemed to use directory name + file name suffix, as it used to be MBD002B0FA6_file5, maybe it makes sense to do the same when there&apos;s no label?&lt;/p&gt;</comment>
                            <comment id="14086213" author="tallison@mitre.org" created="Tue, 5 Aug 2014 13:48:10 +0100"  >&lt;p&gt;In POI 3.10-final, this particular attachment threw an OLE10NativeException so a RESOURCE_NAME_KEY was never set, and the X_file5 was generated in TikaCLI based on the file number and the EMBEDDED_RELATIONSHIP_ID.&lt;/p&gt;

&lt;p&gt;With 3.11-beta1, this OLE10NativeException is not thrown.  I propose this simple modification:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;                    if (ole.getLabel() != null) {
                        metadata.set(Metadata.RESOURCE_NAME_KEY, dir.getName() + &apos;/&apos; + ole.getLabel());
                    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;this will go back to the old behavior of having clients responsible for naming files that have no RESOURCE_NAME_KEY.&lt;/p&gt;

&lt;p&gt;How does that sound?&lt;/p&gt;</comment>
                            <comment id="14086263" author="tallison@mitre.org" created="Tue, 5 Aug 2014 14:26:52 +0100"  >&lt;p&gt;Proposed modification.&lt;/p&gt;</comment>
                            <comment id="14086622" author="tallison@mitre.org" created="Tue, 5 Aug 2014 20:02:51 +0100"  >&lt;p&gt;patch applied in:&lt;br/&gt;
1.6 branch: r1615970&lt;br/&gt;
trunk: r1615980&lt;/p&gt;</comment>
                            <comment id="14086837" author="hudson" created="Tue, 5 Aug 2014 22:42:49 +0100"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #144 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/144/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/144/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt;; fix cases where ole.getLabel() == null for ole attachments (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615980&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615980&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/AbstractPOIFSExtractor.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/AbstractOOXMLExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14087403" author="hudson" created="Wed, 6 Aug 2014 09:14:13 +0100"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.6 #127 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/127/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/127/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt;; fix cases where ole.getLabel() == null for ole attachments (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615980&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615980&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-app/src/test/java/org/apache/tika/cli/TikaCLITest.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/AbstractPOIFSExtractor.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/AbstractOOXMLExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14104392" author="hudson" created="Wed, 20 Aug 2014 20:23:01 +0100"  >&lt;p&gt;FAILURE: Integrated in tika-trunk-jdk1.7 #169 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/169/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/169/&lt;/a&gt;)&lt;br/&gt;
Bump the POI dependency to 3.11-beta2, and remove the Geronimo stax one which is no longer required by anything now we are on Java 1.6 &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1619108&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1619108&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-bundle/pom.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14104399" author="hudson" created="Wed, 20 Aug 2014 20:25:43 +0100"  >&lt;p&gt;FAILURE: Integrated in tika-trunk-jdk1.6 #147 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/147/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/147/&lt;/a&gt;)&lt;br/&gt;
Bump the POI dependency to 3.11-beta2, and remove the Geronimo stax one which is no longer required by anything now we are on Java 1.6 &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1380&quot; title=&quot;Upgrade to Apache POI 3.11 beta 1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1380&quot;&gt;&lt;del&gt;TIKA-1380&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1619108&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1619108&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-bundle/pom.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14108960" author="magloven" created="Mon, 25 Aug 2014 10:49:38 +0100"  >&lt;p&gt;The security issues CVE-2014-3529 and CVE-2014-3574 was fixed in the POI 3.10.1 and POI 3.11-beta2 release. Upgrading POI from 3.10-FINAL to 3.11-beta1 will NOT fix these! Though, seems trunk and the 1.6 branch are actually using 3.11-beta2 (i.e. POI security issues are actually fixed in Tika 1.6).&lt;/p&gt;

&lt;p&gt;-&amp;gt; Rename this JIRA to avoid confusion&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12637566">TIKA-1093</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12718086">TIKA-1317</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12659160" name="TIKA-1380.patch" size="8503" author="gagravarr" created="Fri, 1 Aug 2014 15:58:05 +0100"/>
                            <attachment id="12659887" name="TIKA-1380_nullOLELabel.patch" size="3491" author="tallison@mitre.org" created="Tue, 5 Aug 2014 14:26:52 +0100"/>
                            <attachment id="12659205" name="TIKA-1380b.patch" size="11483" author="tallison@mitre.org" created="Fri, 1 Aug 2014 18:24:17 +0100"/>
                            <attachment id="12659643" name="TIKA-1380c.patch" size="10052" author="gagravarr" created="Mon, 4 Aug 2014 11:45:57 +0100"/>
                            <attachment id="12659502" name="tika-commentstable-missing.diff" size="4114" author="kiwiwings" created="Sat, 2 Aug 2014 22:36:12 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 1 Aug 2014 16:54:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>408890</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzs7of:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>408888</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>