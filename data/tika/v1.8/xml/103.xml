<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:28:52 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-103/TIKA-103.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-103] Excel parsing ignores cell formating</title>
                <link>https://issues.apache.org/jira/browse/TIKA-103</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Unfortunately Excel stores dates as the number of days since 1900 (or 1904, but ignore that atm)  with the time element being stored in the fractional part of the numeric value. So for example 19 Jan 2008 04:35:01 is stored as Double value 39466.190980358806.  The only way to make sense of the data is to look at the formatting on the cell. Although dates are the worst case, it also affects other numeric values - currencies, percentages, scientific, fractions and worst of all custom formats.&lt;/p&gt;

&lt;p&gt;POI recognises 49 &quot;built in&quot; formats of excel and for those it has the limited capability of determining whether a numeric cell is a date or not and if it is, a utility to convert to a java date, something like:&lt;/p&gt;

&lt;p&gt;    if (HSSFDateUtil.isCellDateFormatted(cell)) &lt;/p&gt;
{
        Date date = HSSFDateUtil.getJavaDate(cell.getNumericCellValue());
    }

&lt;p&gt;The current ExcelParser implementation takes no account of the data format and IMO is going to severly limit how useful that implementation is. I&apos;m also think that the above while improving the situation slightly is still not great. I asked about this on the POI dev list a couple of days ago&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; and the only light is someone posted a format parser a few months back. It sounds like POI will accept that contribution if it has unit tests. So I&apos;m going to try and find time to do that. If the data format can be properly parsed then it means being able to extract it in the format the users sees it within Excel - which IMO would be the ideal situation.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://www.mail-archive.com/dev@poi.apache.org/msg00582.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/dev@poi.apache.org/msg00582.html&lt;/a&gt;&lt;/p&gt;


</description>
                <environment></environment>
        <key id="12383096">TIKA-103</key>
            <summary>Excel parsing ignores cell formating</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davemeikle">Dave Meikle</assignee>
                                    <reporter username="niallp">Niall Pemberton</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Nov 2007 03:17:03 +0000</created>
                <updated>Fri, 8 Jan 2010 18:18:56 +0000</updated>
                            <resolved>Fri, 8 Jan 2010 16:50:11 +0000</resolved>
                                                    <fixVersion>0.6</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12544918" author="niallp" created="Fri, 23 Nov 2007 03:20:24 +0000"  >&lt;p&gt;Attaching an Excel file with examples of some of Excel&apos;s built-in formats and a couple of custom formats. Running this through the ExcelParser clearly demonstrates the issue. Also IMO perhaps useful for future testing with ExcelParser data format enhancements.&lt;/p&gt;</comment>
                            <comment id="12796471" author="davemeikle" created="Tue, 5 Jan 2010 01:19:40 +0000"  >&lt;p&gt;Initial patch to have TikaHSSFListener use the FormatTrackingHSSFListener proxy class to handle the POI supported formatting.&lt;/p&gt;</comment>
                            <comment id="12796474" author="davemeikle" created="Tue, 5 Jan 2010 01:26:20 +0000"  >&lt;p&gt;I am not sure how others feel about this issue but for me it is one I would like addressed as I have some applications that are parsing excel files containing various types of formatting and it would be good to have the &apos;as-is&apos; value within the parsed content.&lt;/p&gt;

&lt;p&gt;As can be seen above, I have attached an initial patch to have TikaHSSFListener use the FormatTrackingHSSFListener proxy class to handle the current POI supported formatting - this moves us on some what leaving the outstanding support something to progress within POI&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. The reason I have attached the patch instead of committing directly is that I would like to propose the following:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;This initial support is included in the up-coming 0.6 release&lt;/li&gt;
	&lt;li&gt;An issue is raised against POI, and any fixes to support the other formatting is progressed there.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Not sure what you all think?&lt;/p&gt;

&lt;p&gt;I am going to have a track through to see how Niall got on, if he managed to get the time.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Dave&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; I will continue to see if there are any user model features we can use to add further support from the current POI code base.&lt;/p&gt;</comment>
                            <comment id="12796475" author="chrismattmann" created="Tue, 5 Jan 2010 01:30:25 +0000"  >&lt;p&gt;Hi Dave,&lt;/p&gt;

&lt;p&gt;+1 to this patch making it into the release and +1 to raising the issue on the POI list. I&apos;ve been a bit backlogged with the holidays and all so I haven&apos;t got to cutting the first RC. &lt;/p&gt;

&lt;p&gt;I&apos;ll get to it this week though, that&apos;s for sure.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Chris&lt;/p&gt;

</comment>
                            <comment id="12798061" author="davemeikle" created="Fri, 8 Jan 2010 16:48:47 +0000"  >&lt;p&gt;Moved to Fix Version 0.6 as initial support has been applied for this release. Outstanding formatting issues have been moved to &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-360&quot; title=&quot;Outstanding Improvements to Number/Date Formatting in ExcelParser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-360&quot;&gt;&lt;del&gt;TIKA-360&lt;/del&gt;&lt;/a&gt; for progression, via POI, in a later version.&lt;/p&gt;</comment>
                            <comment id="12798062" author="davemeikle" created="Fri, 8 Jan 2010 16:50:11 +0000"  >&lt;p&gt;As stated above, initial support has been applied for this release therefore marking as &apos;resolved&apos;.&lt;/p&gt;

&lt;p&gt;Outstanding formatting issues have been moved to &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-360&quot; title=&quot;Outstanding Improvements to Number/Date Formatting in ExcelParser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-360&quot;&gt;&lt;del&gt;TIKA-360&lt;/del&gt;&lt;/a&gt; for progression, via POI, in a later version. &lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Dave&lt;/p&gt;</comment>
                            <comment id="12798114" author="davemeikle" created="Fri, 8 Jan 2010 18:18:56 +0000"  >&lt;p&gt;Sorry forgot the XLSX parser (i.e. XSSFExcelExtractorDecorator) - updated in revision 897282.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Dave&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12445050">TIKA-360</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12370102" name="testEXCEL-formats.xls" size="13824" author="niallp" created="Fri, 23 Nov 2007 03:20:24 +0000"/>
                            <attachment id="12429405" name="tika-103_initial_patch.diff" size="9881" author="davemeikle" created="Tue, 5 Jan 2010 01:19:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 5 Jan 2010 01:19:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4759</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx5un:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17267</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>