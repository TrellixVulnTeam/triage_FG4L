<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:31:10 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1487/TIKA-1487.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1487] Add mime for pre-OLE2 xls file</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1487</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;On the govdocs1 corpus, nearly 91% of xls exceptions have this stacktrace:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caused by: java.io.IOException: Invalid header signature; read 0x0010000000060409, expected 0xE11AB1A1E011CFD0 - Your file appears not to be a valid OLE2 document at org.apache.poi.poifs.storage.HeaderBlock.&amp;lt;init&amp;gt;(HeaderBlock.java:140) at org.apache.poi.poifs.storage.HeaderBlock.&amp;lt;init&amp;gt;(HeaderBlock.java:115) at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.&amp;lt;init&amp;gt;(NPOIFSFileSystem.java:198) at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.&amp;lt;init&amp;gt;(NPOIFSFileSystem.java:184) at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:162) at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242) ... 13 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Excel is able to open the few files that I tried, and it looks like Excel thinks these are version 4.&lt;/p&gt;

&lt;p&gt;On the POI user list, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gagravarr&quot; class=&quot;user-hover&quot; rel=&quot;gagravarr&quot;&gt;Nick Burch&lt;/a&gt; identified this header as pre-OLE2 and asked that we add the mime to Tika so that we can handle appropriately.  Test file soon to be attached.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12757742">TIKA-1487</key>
            <summary>Add mime for pre-OLE2 xls file</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tallison@mitre.org">Tim Allison</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Nov 2014 16:50:15 +0000</created>
                <updated>Thu, 27 Nov 2014 14:49:16 +0000</updated>
                            <resolved>Thu, 27 Nov 2014 13:44:36 +0000</resolved>
                                                    <fixVersion>1.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="14224809" author="tallison@mitre.org" created="Tue, 25 Nov 2014 16:52:01 +0000"  >&lt;p&gt;This file comes from the govdocs1 &lt;a href=&quot;http://digitalcorpora.org/corpora/govdocs/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;corpus&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14227664" author="gagravarr" created="Thu, 27 Nov 2014 13:44:24 +0000"  >&lt;p&gt;Mime magic added in r1642152. I think, based on the OpenOffice docs, we&apos;ll now be able to detect Excel 2, 3 and 4, but we only have unit tests for the Excel 4 case. &lt;/p&gt;

&lt;p&gt;These files are now reported as things like &lt;tt&gt;application/vnd.ms-excel.sheet.4&lt;/tt&gt;, mirroring the format used for the new formats like .xlsb, and share a common parent of &lt;tt&gt;application/x-tika-old-excel&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="14227666" author="hudson" created="Thu, 27 Nov 2014 13:45:04 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #335 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/335/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/335/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1487&quot; title=&quot;Add mime for pre-OLE2 xls file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1487&quot;&gt;&lt;del&gt;TIKA-1487&lt;/del&gt;&lt;/a&gt; Test Excel 4 file from govdocs, and an AOO generated Excel 5 file (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1642140&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1642140&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testEXCEL_4.xls&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testEXCEL_5.xls&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14227685" author="hudson" created="Thu, 27 Nov 2014 14:16:16 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.6 #316 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/316/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/316/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1487&quot; title=&quot;Add mime for pre-OLE2 xls file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1487&quot;&gt;&lt;del&gt;TIKA-1487&lt;/del&gt;&lt;/a&gt; Based on the file format docs from OpenOffice, add detection and mime types for the older Excel 2, 3 and 4 pre-ole2 formats (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1642152&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1642152&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/mime/TestMimeTypes.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1487&quot; title=&quot;Add mime for pre-OLE2 xls file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1487&quot;&gt;&lt;del&gt;TIKA-1487&lt;/del&gt;&lt;/a&gt; Test Excel 4 file from govdocs, and an AOO generated Excel 5 file (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1642140&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1642140&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testEXCEL_4.xls&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/resources/test-documents/testEXCEL_5.xls&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14227709" author="hudson" created="Thu, 27 Nov 2014 14:49:16 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #336 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/336/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/336/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1487&quot; title=&quot;Add mime for pre-OLE2 xls file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1487&quot;&gt;&lt;del&gt;TIKA-1487&lt;/del&gt;&lt;/a&gt; Based on the file format docs from OpenOffice, add detection and mime types for the older Excel 2, 3 and 4 pre-ole2 formats (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1642152&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1642152&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/test/java/org/apache/tika/mime/TestMimeTypes.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12683595" name="004444.xls" size="39942" author="tallison@mitre.org" created="Tue, 25 Nov 2014 16:52:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Nov 2014 13:44:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzwn4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>