<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:36:03 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-461/TIKA-461.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-461] RFC822 messages not parsed</title>
                <link>https://issues.apache.org/jira/browse/TIKA-461</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Presented with an RFC822 message exported from Thunderbird, AutodetectParser produces an empty body, and a Metadata containing only one key-value pair: &quot;Content-Type=message/rfc822&quot;. Directly calling MboxParser likewise gives an empty body, but with two metadata pairs: &quot;Content-Encoding=us-ascii Content-Type=application/mbox&quot;.&lt;/p&gt;

&lt;p&gt;A quick peek at the source of MboxParser shows that the implementation is pretty naive. If the wiring can be sorted out, something like Apache James&apos; mime4j might be a better bet.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12468824">TIKA-461</key>
            <summary>RFC822 messages not parsed</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jnioche">Julien Nioche</assignee>
                                    <reporter username="jturner">Joshua Turner</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Jul 2010 15:43:13 +0100</created>
                <updated>Thu, 20 Oct 2011 13:34:14 +0100</updated>
                            <resolved>Wed, 13 Apr 2011 18:43:21 +0100</resolved>
                                    <version>0.7</version>
                                    <fixVersion>0.10</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12906468" author="jnioche" created="Mon, 6 Sep 2010 10:25:33 +0100"  >&lt;p&gt;I&apos;ll have a look at mime4j and try to use it in Tika&lt;/p&gt;</comment>
                            <comment id="12906500" author="jnioche" created="Mon, 6 Sep 2010 13:50:21 +0100"  >&lt;p&gt;This patch contains an initial version of the RFC822Parser which uses apache-mime4j&lt;/p&gt;

&lt;p&gt;The metadata are currently created only for the main message and not for the parts. Note that the parts are put inside &amp;lt;p&amp;gt; elements and parsed with the right parser for their declared mime-type e.g. txt, html etc... The multiparts seem to be properly handled as well.&lt;/p&gt;

&lt;p&gt;There is definitely space for improvements, as usual comments are more than welcome&lt;/p&gt;</comment>
                            <comment id="12906501" author="jnioche" created="Mon, 6 Sep 2010 13:51:05 +0100"  >&lt;p&gt;changed from bug to new feature&lt;/p&gt;</comment>
                            <comment id="12915269" author="jnioche" created="Mon, 27 Sep 2010 11:49:51 +0100"  >&lt;p&gt;Hi guys, &lt;/p&gt;

&lt;p&gt;Could anyone have a look at the patch and review it please? I will assume no one has seen any major issues with it and commit at the end of this week otherwise&lt;br/&gt;
Thanks&lt;/p&gt;

&lt;p&gt;Julien  &lt;/p&gt;</comment>
                            <comment id="12915285" author="gagravarr" created="Mon, 27 Sep 2010 13:23:12 +0100"  >&lt;p&gt;It&apos;d probably be good to see some more tests with it. For now, just checking your basic message should be fine, but I&apos;d suggest we also try to get an email with plain text, html, images and similar in to check the more complex bits.&lt;/p&gt;

&lt;p&gt;In terms of the nested parser, I&apos;m tempted to say we do something so that plain text comes out without any extra work needed. Anything else gets handled via a Parser fetched from the ParseContext if required, much as we&apos;re doing for container formats like zip, .docx etc. That way, you can throw a simple email at it and get the text, but the rest of the parts are available if you want them&lt;/p&gt;

&lt;p&gt;Also, the james jars need to be listed in the tika bundle pom so they get properly included&lt;/p&gt;</comment>
                            <comment id="12915708" author="jnioche" created="Tue, 28 Sep 2010 12:12:04 +0100"  >&lt;p&gt;Nick, &lt;/p&gt;

&lt;p&gt;Thanks for taking the time to review my patch. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It&apos;d probably be good to see some more tests with it. For now, just checking your basic message should be fine, but I&apos;d suggest we also try to get an email with plain text, html, images and similar in to check the more complex bits.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Agreed&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;In terms of the nested parser, I&apos;m tempted to say we do something so that plain text comes out without any extra work needed. Anything else gets handled via a Parser fetched from the ParseContext if required, much as we&apos;re doing for container formats like zip, .docx etc. That way, you can throw a simple email at it and get the text, but the rest of the parts are available if you want them&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I hadn&apos;t noticed that you&apos;ve added org.apache.tika.extractor, seems an elegant way of doing. Will have a closer look and see how I can leverage it in  RFC822Parser&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Also, the james jars need to be listed in the tika bundle pom so they get properly included &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ok, did not know about that. Thanks&lt;/p&gt;</comment>
                            <comment id="12930175" author="gagravarr" created="Tue, 9 Nov 2010 16:02:40 +0000"  >&lt;p&gt;Julien - Did you have any luck knocking up some tests to go with the patch?&lt;/p&gt;</comment>
                            <comment id="12930180" author="jnioche" created="Tue, 9 Nov 2010 16:12:55 +0000"  >&lt;p&gt;Nope. I was planning to refactor the parser first along the lines of what you described (org.apache.tika.extractor) and haven&apos;t found the time to do it so far.&lt;/p&gt;</comment>
                            <comment id="12930182" author="gagravarr" created="Tue, 9 Nov 2010 16:27:36 +0000"  >&lt;p&gt;No worries, we&apos;ll look forward to the new patch and the tests when you get some time &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12965154" author="bbdouglas-basis" created="Tue, 30 Nov 2010 08:43:42 +0000"  >&lt;p&gt;Following a discussion with Julien, I am attaching an additional patch with some tests. I created the content mostly by hand, but took the various features (quoted-printable encoding, non-ASCII character sets) from the public domain email collection I have (Enron data set). The tests mostly fail at the moment, as it seems that the full feature-set of mime4j has not been wired up yet, though a cursory look through the docs leads me to believe everything should be possible using mime4j.&lt;/p&gt;

&lt;p&gt;As this set only includes plain text, single part documents, I will work on creating tests for html and multi-part messages next.&lt;/p&gt;</comment>
                            <comment id="12965265" author="jnioche" created="Tue, 30 Nov 2010 16:06:22 +0000"  >&lt;p&gt;Test document for mail parsing with multiparts, text + html representations of the text and picture attached. &lt;/p&gt;</comment>
                            <comment id="12965271" author="jnioche" created="Tue, 30 Nov 2010 16:13:31 +0000"  >&lt;p&gt;Benjamin, thanks for your patch. Could you generate it with &apos;svn diff&apos; ? I am not able to apply it successfully to my code.&lt;/p&gt;</comment>
                            <comment id="12965279" author="bbdouglas-basis" created="Tue, 30 Nov 2010 16:40:24 +0000"  >&lt;p&gt;Did you try patch -p1? The test patch was meant to be incremental on top of your original patch. I didn&apos;t use svn diff because it creates a diff from the trunk, not just the changes on top of the patch you attached here. If you want, I can either do an svn diff (which would include both your changes and mine) or I can simply zip up the test code and content as plain files.&lt;/p&gt;</comment>
                            <comment id="12965286" author="jnioche" created="Tue, 30 Nov 2010 16:50:00 +0000"  >&lt;p&gt;patch -p1 failed &lt;/p&gt;

&lt;p&gt;pebble@lucid-vostro:/data/tika$ patch -p1 &amp;lt; &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-461&quot; title=&quot;RFC822 messages not parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-461&quot;&gt;&lt;del&gt;TIKA-461&lt;/del&gt;&lt;/a&gt;-tests-1.patch &lt;br/&gt;
patching file tika-parsers/src/test/java/org/apache/tika/parser/mail/RFC822ParserTest.java&lt;br/&gt;
Hunk #1 FAILED at 16.&lt;br/&gt;
Hunk #2 FAILED at 26.&lt;br/&gt;
Hunk #3 FAILED at 40.&lt;br/&gt;
etc...&lt;/p&gt;

&lt;p&gt;can you please do an aggregate patch with svn diff? Thanks &lt;/p&gt;</comment>
                            <comment id="12965325" author="bbdouglas-basis" created="Tue, 30 Nov 2010 18:22:59 +0000"  >&lt;p&gt;Sorry about that. I am attaching a cumulative diff from svn that includes your two attached patches and my tests. Please let me know if you still have problems.&lt;/p&gt;</comment>
                            <comment id="12965679" author="jukkaz" created="Wed, 1 Dec 2010 13:38:25 +0000"  >&lt;p&gt;I committed the latest patch in revision 1040992 to make it easier to share and review updates to the code.&lt;/p&gt;

&lt;p&gt;In revision 1041000 I disabled the failing test cases.&lt;/p&gt;</comment>
                            <comment id="12965722" author="jukkaz" created="Wed, 1 Dec 2010 16:02:23 +0000"  >&lt;p&gt;In revision 1041053 I moved the MailContentHandler class to a separate file (it&apos;s good practice to put each non-nested class to it&apos;s own file) and replaced the StrictBodyContentHandler class with a combination of the existing EmbeddedContentHandler and BodyContentHandler classes.&lt;/p&gt;</comment>
                            <comment id="12966359" author="bbdouglas-basis" created="Fri, 3 Dec 2010 00:05:22 +0000"  >&lt;p&gt;Thank you for committing the changes up to now.&lt;/p&gt;

&lt;p&gt;I am attaching an attempt at wiring up the mime4j parsers into the MailContentHandler. All of the unit tests now pass, with mime4j parsing quoted printable, base64, and i18n encoded text. I needed to re-submit the test files and mark them as binary, since svn was clobbering the CRLF line breaks that are part of the RFC822 format. Please take a look.&lt;/p&gt;

&lt;p&gt;I have not touched anything in the area of the refactoring mentioned above.&lt;/p&gt;</comment>
                            <comment id="12966532" author="jukkaz" created="Fri, 3 Dec 2010 13:54:25 +0000"  >&lt;p&gt;Looks great, thanks! I committed the latest patch in revision 1041811 and used svn:eol-style = CRLF to enforce CRLF libe breaks in all checkouts.&lt;/p&gt;</comment>
                            <comment id="12968433" author="bbdouglas-basis" created="Mon, 6 Dec 2010 22:00:23 +0000"  >&lt;p&gt;Running the current trunk on the Enron email set revealed one weakness of the mime4j default configuration. The default is to allow any individual header to be at most 1000 characters. It is easy to exceed this when sending an email to a large group of people. This last patch ups the limit to 10,000 characters, which should be reasonable for most valid emails.&lt;/p&gt;</comment>
                            <comment id="13004161" author="ssmeets" created="Tue, 8 Mar 2011 19:49:27 +0000"  >&lt;p&gt;I&apos;ve added a patch that extracts some more metadata fields in the MailContentHandler. It extracts:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;MESSAGE_FROM&lt;/li&gt;
	&lt;li&gt;MESSAGE_TO&lt;/li&gt;
	&lt;li&gt;MESSAGE_CC&lt;/li&gt;
	&lt;li&gt;MESSAGE_BCC&lt;/li&gt;
	&lt;li&gt;CREATION_DATE&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The metadata AUTHOR is duplicated in the MESSAGE_FROM field, as it has the same meaning as MESSAGE_FROM. Perhaps AUTHOR is superfluous? Furhtermore, I figured out that some mails from the enron data set do not contain email addresses in the adress lists. mime4j determines that these fields are invalid, however, they contain useful information. Therefore I&apos;ve added an additional metadafield extractor in case mime4j decides a field is invalid. Some tests and the concerning Enron emails are added.&lt;/p&gt;</comment>
                            <comment id="13004163" author="ssmeets" created="Tue, 8 Mar 2011 19:52:10 +0000"  >&lt;p&gt;Added a CC and BCC metadata testdocument plus a testdocument for testing email with big addresslists for the &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-461&quot; title=&quot;RFC822 messages not parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-461&quot;&gt;&lt;del&gt;TIKA-461&lt;/del&gt;&lt;/a&gt;-config-patch&lt;/p&gt;</comment>
                            <comment id="13004166" author="ssmeets" created="Tue, 8 Mar 2011 19:56:23 +0000"  >&lt;p&gt;Added the proposed patch for extracting more metadata from rfc822 emails&lt;/p&gt;</comment>
                            <comment id="13004181" author="bbdouglas-basis" created="Tue, 8 Mar 2011 20:21:04 +0000"  >&lt;p&gt;These are some interesting comments. I would suggest, though, that a new JIRA is opened up for these as the previous patches were applied and are part of tika-0.9.&lt;/p&gt;

&lt;p&gt;Could someone close this story?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13004203" author="ssmeets" created="Tue, 8 Mar 2011 20:46:39 +0000"  >&lt;p&gt;No problems, I&apos;ll open up a new Jira Ticket. However, not all patches are applied in tika-0.9. For example &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-461&quot; title=&quot;RFC822 messages not parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-461&quot;&gt;&lt;del&gt;TIKA-461&lt;/del&gt;&lt;/a&gt;-config.patch, is not implemented yet.&lt;/p&gt;
</comment>
                            <comment id="13019455" author="jukkaz" created="Wed, 13 Apr 2011 18:43:21 +0100"  >&lt;p&gt;I committed the pending patches in revisions 1091859 and 1091860. Resolving as fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12465622" name="TIKA-461-config.patch" size="1253" author="bbdouglas-basis" created="Mon, 6 Dec 2010 22:00:23 +0000"/>
                            <attachment id="12465185" name="TIKA-461-parse.patch" size="30605" author="bbdouglas-basis" created="Fri, 3 Dec 2010 00:05:22 +0000"/>
                            <attachment id="12464972" name="TIKA-461-plus-tests-1.patch" size="25839" author="bbdouglas-basis" created="Tue, 30 Nov 2010 18:22:59 +0000"/>
                            <attachment id="12453941" name="TIKA-461.patch" size="13621" author="jnioche" created="Mon, 6 Sep 2010 13:50:21 +0100"/>
                            <attachment id="12473036" name="extra_metadata.patch" size="8854" author="ssmeets" created="Tue, 8 Mar 2011 19:56:23 +0000"/>
                            <attachment id="12473034" name="testRFC822-CC-BCC" size="3695" author="ssmeets" created="Tue, 8 Mar 2011 19:52:10 +0000"/>
                            <attachment id="12473035" name="testRFC822-big" size="6585" author="ssmeets" created="Tue, 8 Mar 2011 19:52:10 +0000"/>
                            <attachment id="12464964" name="testRFC822-multipart" size="6857" author="jnioche" created="Tue, 30 Nov 2010 16:06:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 6 Sep 2010 09:25:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4400</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx3nb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16910</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>