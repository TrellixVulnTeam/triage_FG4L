<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:36:22 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-956/TIKA-956.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-956] Embedded docs in Word doc are not inlined (text is always added to the end)</title>
                <link>https://issues.apache.org/jira/browse/TIKA-956</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;You can see this with the recently added testWORD_embedded_pdf.doc&lt;br/&gt;
(for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-948&quot; title=&quot;Embedded PDF extracted incorrectly as MS Works file from Word 97-2003 doc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-948&quot;&gt;&lt;del&gt;TIKA-948&lt;/del&gt;&lt;/a&gt;): the &quot;Bye Bye&quot; text comes before the &quot;Wer&lt;br/&gt;
wjelrwoierj...&quot; text from the embedded PDF, opposite of what you see&lt;br/&gt;
when you open the doc with Word.&lt;/p&gt;

&lt;p&gt;Yet, the thumbnail images do seem to be extracted at the right place&lt;br/&gt;
(inlined).&lt;/p&gt;

&lt;p&gt;This is because WordExtractor.java has a separate pass at the end to&lt;br/&gt;
visit the embedded docs.&lt;/p&gt;

&lt;p&gt;Would it be possible to recurse into an embedded doc at the point when&lt;br/&gt;
it&apos;s first encountered instead...?  Or maybe somehow correlate the&lt;br/&gt;
images with their corresponding attachment (right now they are just&lt;br/&gt;
named image1, image2, ...)?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12599123">TIKA-956</key>
            <summary>Embedded docs in Word doc are not inlined (text is always added to the end)</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikemccand">Michael McCandless</assignee>
                                    <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jul 2012 16:01:37 +0100</created>
                <updated>Tue, 7 Aug 2012 22:42:09 +0100</updated>
                            <resolved>Tue, 7 Aug 2012 22:42:08 +0100</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.3</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13419342" author="mikemccand" created="Fri, 20 Jul 2012 17:55:02 +0100"  >&lt;p&gt;Alas I don&apos;t see how to determine where an embedded document is actually inserted into the main document... but I know very little about the POI APIs.&lt;/p&gt;

&lt;p&gt;Does anyone have any hints/pointers here?&lt;/p&gt;</comment>
                            <comment id="13424833" author="mikemccand" created="Mon, 30 Jul 2012 14:05:46 +0100"  >&lt;p&gt;A wee bit of progress here, after much sleuthing around POI&apos;s sources,&lt;br/&gt;
with a patch to POI, not to Tika.&lt;/p&gt;

&lt;p&gt;With the attached patch, if you run&lt;br/&gt;
org.apache.poi.hwpf.converter.WordToTextConverter on the attached word&lt;br/&gt;
doc, you get this text output:&lt;/p&gt;

&lt;p&gt;Here is the pdf file:&lt;/p&gt;

&lt;p&gt;$$ embedded: _1402837031 $$&lt;/p&gt;


&lt;p&gt;Bye Bye&lt;/p&gt;

&lt;p&gt;The output shows where the embedded file appears in the text ... I did&lt;br/&gt;
this by adding a processEmbedded call to the &quot;Embedded Object&quot; case in&lt;br/&gt;
processField (currently it just passes the &quot;name&quot; =&lt;br/&gt;
separator.getPicOffset() as the argument).&lt;/p&gt;

&lt;p&gt;This is obviously not committable ... but it at least demonstrates&lt;br/&gt;
it&apos;s possible to show the location in the text where the embedded&lt;br/&gt;
object occurs.&lt;/p&gt;

&lt;p&gt;The challenge now is how to do something similar in Tika.&lt;/p&gt;</comment>
                            <comment id="13428607" author="mikemccand" created="Sat, 4 Aug 2012 14:00:09 +0100"  >&lt;p&gt;Patch w/ new test case, fixing Tika to leave a &amp;lt;div&lt;br/&gt;
embedded=&quot;_NNNNNNN&quot;&amp;gt; at the place where the embedded document actually&lt;br/&gt;
occurs.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure if that&apos;s the best tag to produce...&lt;/p&gt;</comment>
                            <comment id="13428851" author="jukkaz" created="Sun, 5 Aug 2012 14:49:04 +0100"  >&lt;p&gt;Instead of the non-standard &lt;tt&gt;embedded&lt;/tt&gt; attribute, it would be better to use a construct like &lt;tt&gt;&amp;lt;div class=&quot;embedded&quot; id=&quot;_NNNNNN&quot;&amp;gt;&lt;/tt&gt; for this.  A code snipped like the following should do the trick:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; id = &lt;span class=&quot;code-quote&quot;&gt;&quot;_&quot;&lt;/span&gt; + field.getMarkSeparatorCharacterRun(r).getPicOffset();
AttributesImpl attributes = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AttributesImpl();
attributes.addAttribute(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;class&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;class&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;CDATA&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;embedded&quot;);
attributes.addAttribute(&lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;id&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;id&lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;CDATA&quot;, id);
handler.startElement(XHTML, &lt;span class=&quot;code-quote&quot;&gt;&quot;div&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;div&quot;&lt;/span&gt;, attributes);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;An even better approach would be to use something like &lt;tt&gt;&amp;lt;img src=&quot;embedded:...&quot; alt=&quot;...&quot;&amp;gt;&lt;/tt&gt; or &lt;tt&gt;&amp;lt;object data=&quot;embedded:...&quot; type=&quot;...&quot;&amp;gt;...&amp;lt;/object&amp;gt;&lt;/tt&gt;. See the &lt;tt&gt;XWPFWordExtractorDecorator&lt;/tt&gt; class for an example of how embedded images are handled in OOXML Word documents.&lt;/p&gt;</comment>
                            <comment id="13428923" author="mikemccand" created="Sun, 5 Aug 2012 23:35:41 +0100"  >&lt;blockquote&gt;&lt;p&gt;Instead of the non-standard embedded attribute, it would be better to use a construct like &amp;lt;div class=&quot;embedded&quot; id=&quot;_NNNNNN&quot;&amp;gt; for this.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks Jukka, I&apos;ll change to that.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;An even better approach would be to use something like &amp;lt;img src=&quot;embedded:...&quot; alt=&quot;...&quot;&amp;gt; or &amp;lt;object data=&quot;embedded:...&quot; type=&quot;...&quot;&amp;gt;...&amp;lt;/object&amp;gt;. See the XWPFWordExtractorDecorator class for an example of how embedded images are handled in OOXML Word documents.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I would love to associate the embedded id with corresponding thumbnail&lt;br/&gt;
image, and/or to get the type of the embedded object, but I don&apos;t yet&lt;br/&gt;
see how to do that w/ the POI APIs.  It must be possible though since&lt;br/&gt;
Word obviously knows to associate each thumbnail with the right&lt;br/&gt;
embedded doc... but I think we can improve this later on.&lt;/p&gt;

&lt;p&gt;Separately, it would be nice to include the Picture.getDescription()&lt;br/&gt;
as the image alt text but... it looks like that was only recently&lt;br/&gt;
added to POI (ie we&apos;d have to upgrade first).&lt;/p&gt;</comment>
                            <comment id="13428925" author="mikemccand" created="Sun, 5 Aug 2012 23:39:06 +0100"  >&lt;p&gt;New patch w/ Jukka&apos;s suggestion... I think it&apos;s ready.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12539226" name="TIKA-956.patch" size="3905" author="mikemccand" created="Sun, 5 Aug 2012 23:39:06 +0100"/>
                            <attachment id="12539149" name="TIKA-956.patch" size="3629" author="mikemccand" created="Sat, 4 Aug 2012 14:00:09 +0100"/>
                            <attachment id="12538338" name="TIKA-956.patch" size="2077" author="mikemccand" created="Mon, 30 Jul 2012 14:05:46 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 5 Aug 2012 13:49:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>242316</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxwibj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>