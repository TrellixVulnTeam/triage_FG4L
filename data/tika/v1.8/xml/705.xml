<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:31:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-705/TIKA-705.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-705] Valid OOXML PPT file hits InvalidFormatException thrown in POI</title>
                <link>https://issues.apache.org/jira/browse/TIKA-705</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I took the &quot;testRTFVarious.rtf&quot; test case from &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-683&quot; title=&quot;RTF Parser issues with non european characters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-683&quot;&gt;&lt;del&gt;TIKA-683&lt;/del&gt;&lt;/a&gt;, and saved it as various other doc types, to generate more test cases.&lt;/p&gt;

&lt;p&gt;But when I did this for PPTX, the resulting file hits this exception:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
Exception in thread &quot;main&quot; org.apache.tika.exception.TikaException: Broken OOXML file
	at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleEmbeddedParts(AbstractOOXMLExtractor.java:141)
	at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.getXHTML(AbstractOOXMLExtractor.java:112)
	at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:95)
	at org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:70)
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)
	at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:129)
	at org.apache.tika.cli.TikaCLI$OutputType.process(TikaCLI.java:126)
	at org.apache.tika.cli.TikaCLI.process(TikaCLI.java:363)
	at org.apache.tika.cli.TikaCLI.main(TikaCLI.java:97)
Caused by: org.apache.poi.openxml4j.exceptions.InvalidFormatException: A segment shall not hold any characters other than pchar characters. [M1.6]
	at org.apache.poi.openxml4j.opc.PackagePartName.checkPCharCompliance(PackagePartName.java:370)
	at org.apache.poi.openxml4j.opc.PackagePartName.throwExceptionIfPartNameHaveInvalidSegments(PackagePartName.java:270)
	at org.apache.poi.openxml4j.opc.PackagePartName.throwExceptionIfInvalidPartUri(PackagePartName.java:185)
	at org.apache.poi.openxml4j.opc.PackagePartName.&amp;lt;init&amp;gt;(PackagePartName.java:83)
	at org.apache.poi.openxml4j.opc.PackagingURIHelper.createPartName(PackagingURIHelper.java:490)
	at org.apache.tika.parser.microsoft.ooxml.AbstractOOXMLExtractor.handleEmbeddedParts(AbstractOOXMLExtractor.java:124)
	... 9 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All I did was open Office 2007, copy/paste over the text from the Word doc, and save it.  Ie, it should be a valid OOXML file, unless Office 2007 is buggy?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12521354">TIKA-705</key>
            <summary>Valid OOXML PPT file hits InvalidFormatException thrown in POI</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Sep 2011 15:12:37 +0100</created>
                <updated>Tue, 20 Dec 2011 06:22:26 +0000</updated>
                            <resolved>Thu, 20 Oct 2011 13:43:19 +0100</resolved>
                                    <version>0.9</version>
                                    <fixVersion>1.0</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13097152" author="mikemccand" created="Mon, 5 Sep 2011 15:13:52 +0100"  >&lt;p&gt;PPTX file showing the exception.&lt;/p&gt;</comment>
                            <comment id="13097217" author="gagravarr" created="Mon, 5 Sep 2011 18:25:00 +0100"  >&lt;p&gt;Looks to be a problem with a reference to part of a slide, rather than a whole slide:&lt;br/&gt;
   /ppt/slides/slide1.xml#_ftn1&lt;/p&gt;</comment>
                            <comment id="13097261" author="mikemccand" created="Mon, 5 Sep 2011 20:09:21 +0100"  >&lt;p&gt;Thanks for looking at this Nick!&lt;/p&gt;

&lt;p&gt;So, is this something I somehow screwed up using Powerpoint 2007?  Or PowerPoint 2007 is simply producing an invalid OOXML file?&lt;/p&gt;

&lt;p&gt;Is there anything we (or POI) can do here?  It&apos;s bad if users can produce things &quot;normally&quot; (ie just using PowerPoint) which Tika then chokes on...&lt;/p&gt;</comment>
                            <comment id="13097319" author="gagravarr" created="Mon, 5 Sep 2011 22:07:14 +0100"  >&lt;p&gt;I&apos;ll need to read the spec to be sure, but I have a feeling it could be our issue with not removing anchors before fetching parts.&lt;/p&gt;

&lt;p&gt;Either way we probably want to make it easier for people to get related parts anyway, as the current method is a bit more fiddly that we really want.&lt;/p&gt;

&lt;p&gt;This will probably largely all be done on the POI side though, with the only Tika bit being moving to the new, simpler code once available&lt;/p&gt;</comment>
                            <comment id="13107074" author="jukkaz" created="Sat, 17 Sep 2011 11:03:49 +0100"  >&lt;p&gt;Removing from the 0.10 roadmap, let&apos;s set the fix version to the next release once the fix is in.&lt;/p&gt;</comment>
                            <comment id="13107959" author="gagravarr" created="Mon, 19 Sep 2011 17:41:43 +0100"  >&lt;p&gt;Initial workaround committed in r1172690.&lt;/p&gt;

&lt;p&gt;The proper fix is commented out in the code, and can be activated when we upgrade to POI 3.8 beta 5 (I&apos;ve added a new method there)&lt;/p&gt;</comment>
                            <comment id="13107974" author="mikemccand" created="Mon, 19 Sep 2011 17:50:13 +0100"  >&lt;p&gt;Thanks Nick!&lt;/p&gt;

&lt;p&gt;I verified that the testVarious test case (in OOXMLParserTest) now passes (I had left it commented out), so I&apos;ll go uncomment &amp;amp; commit.&lt;/p&gt;</comment>
                            <comment id="13131568" author="mikemccand" created="Thu, 20 Oct 2011 13:43:19 +0100"  >&lt;p&gt;I think we can resolve this now?  &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-757&quot; title=&quot;Address TODOs when we upgrade to next POI release (3.8 beta 5)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-757&quot;&gt;&lt;del&gt;TIKA-757&lt;/del&gt;&lt;/a&gt; is open to address TODOs on next POI upgrade.&lt;/p&gt;</comment>
                            <comment id="13172973" author="gagravarr" created="Tue, 20 Dec 2011 06:22:26 +0000"  >&lt;p&gt;Code simplified in r1221115 now that we&apos;ve upgraded POI&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12493031" name="testPPT_various.pptx" size="48011" author="mikemccand" created="Mon, 5 Sep 2011 15:13:52 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 5 Sep 2011 17:25:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3837</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx25b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16667</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>