<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:30:52 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1118/TIKA-1118.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1118] OOXML parser throws when relationship points to 0 byte embedded part</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1118</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I have a test document (pptx) where there is a 0 byte embedded part which is referenced in a relationship. I don&apos;t really know how the document got like this but Office can open it without any issues. The problem is in AbstractOOXMLExtractor::handleEmbeddedOle. It attempts to create a POIFSFileSystem:&lt;br/&gt;
     POIFSFileSystem fs = new POIFSFileSystem(part.getInputStream());&lt;br/&gt;
using the part stream in the constructor but fails because of insufficient data. Given that the whole function except for this one line is in a try -&amp;gt; catch -&amp;gt; ignore, it seems like the best option is to put this line inside the try / catch. There is no metadata to extract from the 0 byte part.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Tested on MAC and Ubuntu server&lt;/p&gt;</environment>
        <key id="12647601">TIKA-1118</key>
            <summary>OOXML parser throws when relationship points to 0 byte embedded part</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="leegraber">Lee Graber</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 May 2013 21:53:27 +0100</created>
                <updated>Tue, 5 Aug 2014 13:15:19 +0100</updated>
                            <resolved>Mon, 4 Aug 2014 17:05:16 +0100</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.7</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="13657510" author="gagravarr" created="Tue, 14 May 2013 22:07:12 +0100"  >&lt;p&gt;Could you please upload a file that shows the problem?&lt;/p&gt;</comment>
                            <comment id="13657689" author="leegraber" created="Wed, 15 May 2013 00:39:15 +0100"  >&lt;p&gt;Sorry ... it is unfortunately confidential customer information. I tried to&lt;br/&gt;
modify the file and remove all IP, but then the issue went away. I could&lt;br/&gt;
send you the contents of the relationship xml file and a screenshot showing&lt;br/&gt;
that the referenced part had 0 bytes, but that is not really a repro. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;


</comment>
                            <comment id="13657742" author="gagravarr" created="Wed, 15 May 2013 01:31:47 +0100"  >&lt;p&gt;In r1482647 I&apos;ve changed Apache POI to make it possible to fetch the size of a PacakgePart. &lt;/p&gt;

&lt;p&gt;To be a valid POIFS file, it must be at least 3 blocks big, so something at 0 bytes can&apos;t be valid and can safely be skipped. In r1482648 I&apos;ve added commented out logic to implement this, which can be enabled once there&apos;s a new POI version + we upgrade. (For now, you should be fine to take a nightly snapshot of POI for your build, and enable the block of code in Tika)&lt;/p&gt;

&lt;p&gt;No unit tests for this though, so if you are able to find a file you can share / manually hack one to remove the confidential information, that&apos;d be great!&lt;/p&gt;</comment>
                            <comment id="14084828" author="gagravarr" created="Mon, 4 Aug 2014 17:05:16 +0100"  >&lt;p&gt;Check enabled in r1615638.&lt;/p&gt;

&lt;p&gt;If you do come across a file that shows this problem that you can share, please re-open the bug and attach it, as a unit test for it would be great!&lt;/p&gt;</comment>
                            <comment id="14084930" author="hudson" created="Mon, 4 Aug 2014 18:28:44 +0100"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #140 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/140/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/140/&lt;/a&gt;)&lt;br/&gt;
Enable the check for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1118&quot; title=&quot;OOXML parser throws when relationship points to 0 byte embedded part&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1118&quot;&gt;&lt;del&gt;TIKA-1118&lt;/del&gt;&lt;/a&gt;, now that we have upgraded POI (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615638&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615638&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/AbstractOOXMLExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14086171" author="hudson" created="Tue, 5 Aug 2014 13:15:19 +0100"  >&lt;p&gt;ABORTED: Integrated in tika-trunk-jdk1.6 #126 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/126/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/126/&lt;/a&gt;)&lt;br/&gt;
Enable the check for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1118&quot; title=&quot;OOXML parser throws when relationship points to 0 byte embedded part&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1118&quot;&gt;&lt;del&gt;TIKA-1118&lt;/del&gt;&lt;/a&gt;, now that we have upgraded POI (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615638&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1615638&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/ooxml/AbstractOOXMLExtractor.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 14 May 2013 21:07:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327957</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzefev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328301</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>