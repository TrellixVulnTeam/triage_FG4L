<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:38:12 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-506/TIKA-506.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-506] Improve doc and docx parsing to include more things</title>
                <link>https://issues.apache.org/jira/browse/TIKA-506</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;There are several parts of the word documents (.doc and .docx) that we don&apos;t currently extract, but which would be nice to have.&lt;/p&gt;

&lt;p&gt;These include:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Hyperlinks&lt;/li&gt;
	&lt;li&gt;Images (img tag referencing the name of the embeded image)&lt;/li&gt;
	&lt;li&gt;Headings (when the default heading styles are used)&lt;/li&gt;
	&lt;li&gt;Style information (when a style other than Default or a body is used on a paragraph, markup the p tag with it)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;m proposing to add support for these in the near future&lt;/p&gt;</description>
                <environment></environment>
        <key id="12473470">TIKA-506</key>
            <summary>Improve doc and docx parsing to include more things</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gagravarr">Nick Burch</assignee>
                                    <reporter username="gagravarr">Nick Burch</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Sep 2010 16:55:44 +0100</created>
                <updated>Fri, 1 Oct 2010 12:37:50 +0100</updated>
                            <resolved>Sat, 25 Sep 2010 14:35:17 +0100</resolved>
                                    <version>0.7</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12908887" author="gagravarr" created="Mon, 13 Sep 2010 19:03:57 +0100"  >&lt;p&gt;I&apos;ve started work on this, and we&apos;re going to need a newer version of POI - I&apos;m having to add new features and bug fixes there! We&apos;re likely to do another POI beta release in a week or so, so I&apos;ll upload a patch when the work is done and we can apply it when 3.7-beta3 is out&lt;/p&gt;</comment>
                            <comment id="12909391" author="gagravarr" created="Tue, 14 Sep 2010 20:12:10 +0100"  >&lt;p&gt;The attached patch improves the parsing of .docx to include headings, hyperlinks, better text placement, bold/italic and images in the correct place&lt;/p&gt;

&lt;p&gt;It needs code that has only just gone into the poi svn, so will need to wait for poi 3.7 beta 3 before being applied&lt;/p&gt;

&lt;p&gt;To spot where images go, it also needs the full ooxml schemas file, owing to some odd behaviour of xmlbeans. Hopefully we&apos;ll get this one figured out too in time for 3.7 beta 3.&lt;/p&gt;</comment>
                            <comment id="12909790" author="gagravarr" created="Wed, 15 Sep 2010 17:30:30 +0100"  >&lt;p&gt;This updates yesterday&apos;s patch, and additionally includes hyperlinks and bold/italic for .doc&lt;/p&gt;</comment>
                            <comment id="12910151" author="gagravarr" created="Thu, 16 Sep 2010 14:34:08 +0100"  >&lt;p&gt;New patch (v11) adds support for .doc images, and non-nested .doc tables (nested tables is going to need some more POI work). Now the only thing that is supported for .docx but not .doc is nested tables - in .doc the nested tables come out as regular paragraphs.&lt;/p&gt;

&lt;p&gt;As part of this, I&apos;ve had to add a new boolean option to EmbeddedDocumentExtractor, so a parser can tell it if html for the embedded resource has already been output. In most cases, the current behaviour of &quot;no html has yet been output&quot; will apply, and EmbeddedDocumentExtractor should output html as before. In a few cases however, the parser will have done its own markup, so we don&apos;t want the extra bits.&lt;/p&gt;

&lt;p&gt;The patch needs poi 3.7 beta 3, so can&apos;t be applied until that has been released&lt;/p&gt;</comment>
                            <comment id="12912971" author="gagravarr" created="Tue, 21 Sep 2010 14:35:24 +0100"  >&lt;p&gt;Updated patch (v12) which tidies up a few bits when building against the POI 3.7 beta 3 release candidate jars.&lt;/p&gt;</comment>
                            <comment id="12914506" author="gagravarr" created="Fri, 24 Sep 2010 16:46:22 +0100"  >&lt;p&gt;The POI 3.7 beta 3 release vote has passed. I&apos;ll apply this patch over the weekend, once the poi jars have propagated to all the maven repos.&lt;/p&gt;</comment>
                            <comment id="12914816" author="gagravarr" created="Sat, 25 Sep 2010 14:35:17 +0100"  >&lt;p&gt;Latest patch applied in r1001209.&lt;/p&gt;</comment>
                            <comment id="12915114" author="geoff.jarrad" created="Mon, 27 Sep 2010 05:38:17 +0100"  >&lt;p&gt;Tables in Word documents (.doc via OfficeParser) appear to be given a &amp;lt;table&amp;gt; start element but no matching &amp;lt;/table&amp;gt; end element (nor &amp;lt;/tbody&amp;gt; I think).&lt;/p&gt;</comment>
                            <comment id="12915246" author="gagravarr" created="Mon, 27 Sep 2010 10:21:15 +0100"  >&lt;p&gt;Whoops, yes. Fixed in r1001640.&lt;/p&gt;</comment>
                            <comment id="12915557" author="geoff.jarrad" created="Tue, 28 Sep 2010 00:58:36 +0100"  >&lt;p&gt;Good work on extracting more of .doc and .docx documents! &lt;/p&gt;

&lt;p&gt;Interestingly, the OOXMLParser now implements almost all of the (independent) hacks I recently made in my own version of the parser.&lt;/p&gt;

&lt;p&gt;Some HTML normalisations for .docx documents that I used, and would be nice to have, were:&lt;/p&gt;

&lt;p&gt;&amp;lt;p class=&quot;heading_1&quot;&amp;gt;...&amp;lt;/p&amp;gt;                      --&amp;gt;      &amp;lt;h1&amp;gt;...&amp;lt;/h1&amp;gt;&lt;br/&gt;
&amp;lt;p class=&quot;heading_2&quot;&amp;gt;...&amp;lt;/p&amp;gt;                      --&amp;gt;      &amp;lt;h2&amp;gt;...&amp;lt;/h2&amp;gt;&lt;br/&gt;
&amp;lt;p class=&quot;hTML_Preformatted&quot;&amp;gt;...&amp;lt;/p&amp;gt;      --&amp;gt;      &amp;lt;pre&amp;gt;...&amp;lt;/pre&amp;gt;&lt;/p&gt;

&lt;p&gt;Also, in some documents I have encountered, sometimes a text snippet is obscured by Word adding entity w:smartTag elements. This text does not get extracted by the OOXMLParser, but I&apos;m not sure if the best fix lies in Tika, POI or Microsoft&apos;s ooxml schemas. My own hack was to reparse the DOM for paragraphs, looking for w:r elements at any depth (including within w:smartTag), but there must be a better way.&lt;/p&gt;

&lt;p&gt;Finally, for the uses to which I put Tika, it would be nice for .doc documents if color font styles could be extracted, but I&apos;m not sure if POI makes these available.&lt;/p&gt;
</comment>
                            <comment id="12915609" author="geoff.jarrad" created="Tue, 28 Sep 2010 05:24:38 +0100"  >&lt;p&gt;The attached sample.doc Word document breaks the OfficeParser:&lt;/p&gt;

&lt;p&gt;java.util.NoSuchElementException&lt;br/&gt;
	at java.util.AbstractList$Itr.next(AbstractList.java:350)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.WordExtractor$CountingIterator.next(WordExtractor.java:401)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.WordExtractor.handleParagraph(WordExtractor.java:168)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.java:80)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:187)&lt;/p&gt;</comment>
                            <comment id="12915707" author="gagravarr" created="Tue, 28 Sep 2010 12:05:55 +0100"  >&lt;p&gt;I&apos;ve added &quot;HTML Preformatted&quot; -&amp;gt; pre as suggested&lt;/p&gt;

&lt;p&gt;Your word document is a bit pesky, as it uses both floating and fixed pictures, and some of the floating pictures reference the same image data...&lt;/p&gt;

&lt;p&gt;I&apos;ll need to do some more investigating on that&lt;/p&gt;</comment>
                            <comment id="12915771" author="gagravarr" created="Tue, 28 Sep 2010 15:49:59 +0100"  >&lt;p&gt;Wow, that proved tricky and very painful...&lt;/p&gt;

&lt;p&gt;As of r1002190 we shouldn&apos;t give the error you&apos;ve seen. We may even stand a better chance of putting the right images in the right place, but word image stuff is even nastier than I&apos;d previously though it was &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12915971" author="geoff.jarrad" created="Wed, 29 Sep 2010 00:46:30 +0100"  >&lt;p&gt;Brilliant work, Nick! Thanks. The sample.doc runs through Tika like a dream.&lt;/p&gt;

&lt;p&gt;Now, do you think it might be feasible to extract font colours?  Or is there currently no support from the POI side of things?&lt;/p&gt;

&lt;p&gt;It has become crucial in my work on document analysis to be able to determine the background colour of a table cell, as well as the foreground colour of text (seems odd, I know, but that&apos;s how the document originators are encoding some information). Currently I am being forced to divert .doc documents to an OpenOffice.org service for translation to HTML, then using Tika&apos;s HtmlParser to decode that into ContentHandler events. Being so close to having a sufficient .doc parser native to Tika (courtesy of the great work of yourself and others) is both exciting and frustrating!&lt;/p&gt;

&lt;p&gt;What are your thoughts? Actually, it&apos;s actually quite instructive to see what HTML OpenOffice.org produces from a Word document, which is why I say the OfficeParser is currently so close. Wouldn&apos;t it be amazing if, in the future, .doc, .docx and .odt versions of the same document were all parsed to the same HTML?&lt;/p&gt;</comment>
                            <comment id="12916101" author="gagravarr" created="Wed, 29 Sep 2010 11:55:28 +0100"  >&lt;p&gt;I&apos;m not sure we want to end up with the same HTML as openoffice, as personally I think it contains too many tags that aren&apos;t appropriate for the html. (For example, my view is that in the html, the choice of the font is one for the people writing the css, not something that should be copied blindly from word). I quite like the clean, semantically meaningful html we&apos;ve now got!&lt;/p&gt;

&lt;p&gt;In terms of the colours, I suspect they&apos;re available somewhere in the bowls of the character and paragraph properties. However, there&apos;s no current high level way to get at them AFAIK. You&apos;d probably need to grab a copy of the word specs, figure out which fields hold them, find that in poi, further decode and finally write a nice user-facing access method for that&lt;/p&gt;</comment>
                            <comment id="12916738" author="geoff.jarrad" created="Fri, 1 Oct 2010 01:04:05 +0100"  >&lt;p&gt;I didn&apos;t quite mean that Tika should output the same level of HTML as OpenOffice.org, merely that it would be nice if Tika&apos;s OfficeParser, OpenDocumentParser and OOXMLParser could output consistent HTML for the same document content represented in different formats. Currently there are ideosyncratic differences that mean the various formats each get analysed (post HTML output) slightly differently by my code.&lt;/p&gt;

&lt;p&gt;As for the colour fonts, my boss is willing to let me have some time to work on it if it proves feasible for me to do. Do you have any explicit pointers to word and POI specs that might help me? I&apos;m not quite sure where to start looking.&lt;/p&gt;</comment>
                            <comment id="12916858" author="gagravarr" created="Fri, 1 Oct 2010 12:37:50 +0100"  >&lt;p&gt;In terms of the 3 different formats, I&apos;d suggest you open a new bug so we can track it there. It ought to be possible to get fairly close, but it&apos;ll certainly require someone to spend some time preparing documents and testing them...&lt;/p&gt;

&lt;p&gt;For the colours, we should probably take the discussion the poi dev list, as it&apos;ll almost certainly need some work on POI to expose the information before Tika could use it.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12457636">TIKA-385</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12446698">TIKA-373</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12455795" name="sample.doc" size="335360" author="geoff.jarrad" created="Tue, 28 Sep 2010 05:24:38 +0100"/>
                            <attachment id="12454763" name="tika-word11.patch" size="57256" author="gagravarr" created="Thu, 16 Sep 2010 14:34:07 +0100"/>
                            <attachment id="12455139" name="tika-word12.patch" size="60110" author="gagravarr" created="Tue, 21 Sep 2010 14:35:24 +0100"/>
                            <attachment id="12454571" name="tika-word6.patch" size="20057" author="gagravarr" created="Tue, 14 Sep 2010 20:12:10 +0100"/>
                            <attachment id="12454668" name="tika-word9.patch" size="38590" author="gagravarr" created="Wed, 15 Sep 2010 17:30:30 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 27 Sep 2010 04:38:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4355</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx3db:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16865</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>