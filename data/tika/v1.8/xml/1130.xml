<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:31:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1130/TIKA-1130.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1130] .docx text extract leaves out some portions of text</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1130</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;When parsing a Microsoft Word .docx (application/vnd.openxmlformats-officedocument.wordprocessingml.document), certain portions of text remain unextracted.&lt;/p&gt;

&lt;p&gt;I have attached a .docx file that can be tested against. The &apos;gray&apos; portions of text are what are not extracted, while the darker colored text extracts fine.&lt;/p&gt;

&lt;p&gt;Looking at the document.xml portion of the .docx zip file shows the text is all there.&lt;/p&gt;</description>
                <environment>&lt;p&gt;OpenJDK x86_64&lt;/p&gt;</environment>
        <key id="12651220">TIKA-1130</key>
            <summary>.docx text extract leaves out some portions of text</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dangby">Daniel Gibby</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Jun 2013 22:56:26 +0100</created>
                <updated>Tue, 25 Mar 2014 16:21:46 +0000</updated>
                            <resolved>Wed, 10 Jul 2013 18:11:15 +0100</resolved>
                                    <version>1.2</version>
                    <version>1.3</version>
                                    <fixVersion>1.5</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13676495" author="tallison@mitre.org" created="Thu, 6 Jun 2013 00:38:54 +0100"  >&lt;p&gt;I&apos;ve submitted a patch to POI for this (&lt;a href=&quot;https://issues.apache.org/bugzilla/show_bug.cgi?id=54849&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/bugzilla/show_bug.cgi?id=54849&lt;/a&gt;).  I haven&apos;t gotten any feedback after my initial trivial fix.  The issue is that sdt/content controls can stand alone as the equivalent of a paragraph or table.  POI isn&apos;t currently picking those up. &lt;/p&gt;</comment>
                            <comment id="13677202" author="dangby" created="Thu, 6 Jun 2013 17:28:34 +0100"  >&lt;p&gt;I read somewhere yesterday that either Tika or POI currently doesn&apos;t have a person in charge of POI commits. Hopefully this gets picked up by someone on both projects to get the bug fixed.&lt;/p&gt;</comment>
                            <comment id="13677957" author="tallison@mitre.org" created="Fri, 7 Jun 2013 12:08:10 +0100"  >&lt;p&gt;I&apos;ll try to submit the Tika portion of the POI-54849 patch by early next week in case anyone wants to apply both patches &quot;at home.&quot;&lt;/p&gt;</comment>
                            <comment id="13682593" author="gagravarr" created="Thu, 13 Jun 2013 20:24:51 +0100"  >&lt;p&gt;We&apos;ll hopefully get an updated version of Tim&apos;s patch in POI soon. Once there&apos;s then a POI release (expected shortly), Tika can upgrade, and fingers crossed the text will show up!&lt;/p&gt;

&lt;p&gt;In the mean time, it would be good if someone could produce a junit unit test for Tika, showing the current issue. That&apos;ll let us ensure it gets fixed in Tika with the upgrade, and that it stays fixed into the future...&lt;/p&gt;</comment>
                            <comment id="13682644" author="rgauss" created="Thu, 13 Jun 2013 21:06:26 +0100"  >&lt;p&gt;I&apos;ve created a unit test that reproduces the issue with a stripped down version of the original file.&lt;/p&gt;

&lt;p&gt;Shall I comment out the actual test and commit?&lt;/p&gt;</comment>
                            <comment id="13682761" author="gagravarr" created="Thu, 13 Jun 2013 22:19:36 +0100"  >&lt;p&gt;I think we&apos;ve tended to prefix the method name, rather than commenting out, so it&apos;s more obvious that they want re-enabling later. Pop a note of the tika bug number, and POI bug number in the javadoc for the method, so someone later can easily work out why it was disabled and when it might be ready&lt;/p&gt;

&lt;p&gt;That said, maybe this is our change to move at least one test to JUnit 4, so we can use @Ignore?&lt;/p&gt;</comment>
                            <comment id="13682924" author="rgauss" created="Fri, 14 Jun 2013 01:12:42 +0100"  >&lt;p&gt;Test file and method committed in r1492909.&lt;/p&gt;

&lt;p&gt;This was just added onto &lt;tt&gt;OOXMLParserTest&lt;/tt&gt; and named with a &lt;tt&gt;disabled&lt;/tt&gt; prefix rather than using &lt;tt&gt;@Ignore&lt;/tt&gt;.  I think we should start moving towards that for new test classes though.&lt;/p&gt;</comment>
                            <comment id="13692049" author="dangby" created="Mon, 24 Jun 2013 15:46:28 +0100"  >&lt;p&gt;Looks like the POI bug (&lt;a href=&quot;https://issues.apache.org/bugzilla/show_bug.cgi?id=54849&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/bugzilla/show_bug.cgi?id=54849&lt;/a&gt;) was updated to &quot;Resolved Fixed&quot;. I&apos;ve downloaded svn sources of POI and Tika, but I&apos;m not sure where the POI code gets located in Tika. What needs to be done to test the updated POI code?&lt;/p&gt;</comment>
                            <comment id="13692058" author="gagravarr" created="Mon, 24 Jun 2013 15:58:59 +0100"  >&lt;p&gt;Do a svn checkout of POI, run &quot;ant jar&quot; to build the jars, then replace the POI jars in your Tika classpath with the ones you&apos;ve just built&lt;/p&gt;

&lt;p&gt;Or, wait about a week, as we&apos;ll be starting the vote for 3.10 beta 1 just as soon as Yegor gets one last bugfix in / we decide to stop waiting for him...!&lt;/p&gt;</comment>
                            <comment id="13692077" author="dangby" created="Mon, 24 Jun 2013 16:28:37 +0100"  >&lt;p&gt;I&apos;d rather wait a week for a beta, but I need to test this on our code sooner than that. I&apos;m getting pressure to just get only the patch for this one bug and apply it to our production code. &lt;/p&gt;

&lt;p&gt;I did get the jars built, but I&apos;m not sure where in the Tika project structure the POI jars get imported from. Tika uses maven to build, which I&apos;m not familiar with how to configure. I&apos;m also not familiar with the Tika project structure, is there a place I can drop the POI jar file and maven will recognize it, or is there an environment variable or PATH I should set somewhere?&lt;/p&gt;

&lt;p&gt;I&apos;ve noticed in the tika-parsers/pom.xml that it mentions POI, but just as a comment and version numbers for a few properties. I also see the POI jars mentioned in target/classes/META-INF/DEPENDENCIES, but those are also just version numbers.&lt;/p&gt;

&lt;p&gt;I see the POIContainerExtractionTest and ooxml packages in org/apache/tika/parser/microsoft, but those are just the tests.&lt;/p&gt;

&lt;p&gt;Where does the POI jar go, and what needs to be configured before running mvn to build Tika?&lt;br/&gt;
My guess is that my ignorance on how maven works is why I&apos;m not sure what to do, but based on using ant, I&apos;m used to putting something in the right spot and possibly changing a build.xml property to make sure it is looking at the correct spot. What am I missing?&lt;/p&gt;</comment>
                            <comment id="13692110" author="tallison@mitre.org" created="Mon, 24 Jun 2013 17:23:37 +0100"  >&lt;p&gt;Nick,  &lt;br/&gt;
  I think I have to make modifications to Tika to execute the new SDT components.  Should my patch be to Tika trunk?&lt;/p&gt;</comment>
                            <comment id="13692203" author="gagravarr" created="Mon, 24 Jun 2013 19:14:33 +0100"  >&lt;p&gt;Tim - you&apos;ll want to checkout POI from SVN, do &quot;ant jar maven-poms&quot;, then manually install the jars and poms into your local maven repo. Next, bump up the poi version in the tika-parsers pom, and re-build Tika. Fix any issues that show up / open a new jira entry and ask for help on them. Once it builds cleanly, patch the parser to use the new functionality (if needed) and add a unit test. Finally, attach the patch to this bug! &lt;/p&gt;</comment>
                            <comment id="13692517" author="tallison@mitre.org" created="Tue, 25 Jun 2013 00:10:20 +0100"  >&lt;p&gt;Maven proxy setting in my settings.xml file is working for grabbing dependencies, but the proxy info isn&apos;t being transferred to testUrlOnly&apos;s url.openStream() in MimeDetectionTest.  The proxy props appear correctly in the surefire-report for MimeDetectionTest, but the proxy settings are null when I insert this into testUrlOnly:&lt;/p&gt;

&lt;p&gt;System.out.println(&quot;HOST: &quot; + System.getProperty(&quot;http.proxyHost&quot;));&lt;br/&gt;
System.out.println(&quot;PORT: &quot; + System.getProperty(&quot;http.proxyPort&quot;));&lt;/p&gt;

&lt;p&gt;Will likely find the answer as soon as I post this...&lt;/p&gt;</comment>
                            <comment id="13692690" author="tallison@mitre.org" created="Tue, 25 Jun 2013 03:17:33 +0100"  >&lt;p&gt;Many thanks to Ray for the unit test and to Nick for his guidance on the POI patch and this Tika patch.&lt;/p&gt;

&lt;p&gt;This is the first round patch for Tika to make use of the new SDT processing in POI.&lt;/p&gt;

&lt;p&gt;Ray&apos;s test case brought to light a formatting issue in POI 54849...we don&apos;t want to insert a &quot;\n&quot; between two runs within an SDT.  I&apos;ll submit a patch for this in POI.&lt;/p&gt;

&lt;p&gt;Let me know how this looks.&lt;/p&gt;</comment>
                            <comment id="13693507" author="tallison@mitre.org" created="Wed, 26 Jun 2013 00:49:14 +0100"  >&lt;p&gt;Ray&apos;s initial test restored after POI-55142 was committed.  Thank you, Nick!&lt;/p&gt;</comment>
                            <comment id="13693520" author="gagravarr" created="Wed, 26 Jun 2013 00:59:00 +0100"  >&lt;p&gt;The POI 3.10 beta 1 release vote has just started, which includes this fix. It&apos;d be great if people could review that, and vote as appropriate. Once we have a new POI release, we can bump the dependency version in Tika, then apply this patch (Tika only ever depends on released versions of software available on Maven Central)&lt;/p&gt;</comment>
                            <comment id="13697870" author="gagravarr" created="Tue, 2 Jul 2013 16:12:56 +0100"  >&lt;p&gt;Thanks for the patch Tim, applied in r1498968.&lt;/p&gt;</comment>
                            <comment id="13698009" author="tallison@mitre.org" created="Tue, 2 Jul 2013 18:26:05 +0100"  >&lt;p&gt;That was fast.  Thank you!&lt;/p&gt;</comment>
                            <comment id="13704682" author="dangby" created="Wed, 10 Jul 2013 16:57:20 +0100"  >&lt;p&gt;Is the attached file another example of this same problem, or is this a separate bug that needs to be addressed?&lt;/p&gt;

&lt;p&gt;Various parts of the resume do get extracted, while others don&apos;t.&lt;/p&gt;</comment>
                            <comment id="13704688" author="dangby" created="Wed, 10 Jul 2013 17:00:39 +0100"  >&lt;p&gt;Here&apos;s another file that isn&apos;t converting everything. Let me know if I should open another ticket. Also, I can update or open a ticket in POI.&lt;/p&gt;</comment>
                            <comment id="13704692" author="dangby" created="Wed, 10 Jul 2013 17:01:40 +0100"  >&lt;p&gt;I found some files that still exhibit the problem of not all text being extracted. If the problem is still the same underlying POI, perhaps these POI issues should all be handled in this ticket? Or should a new ticket be opened?&lt;/p&gt;</comment>
                            <comment id="13704693" author="gagravarr" created="Wed, 10 Jul 2013 17:01:47 +0100"  >&lt;p&gt;Daniel - the simplest way to check would be for you to do a svn checkout of Tika, build a snapshot of the Tika App, and try with that. If you problem goes away, you know it was this and is fixed. If it still remains, you&apos;ll probably want to open up a fresh bug and also try to identify what the kind of text is that Tika ignores.&lt;/p&gt;</comment>
                            <comment id="13704694" author="dangby" created="Wed, 10 Jul 2013 17:02:54 +0100"  >&lt;p&gt;I have tested the attached files with the newest Tika. The original file I attached is converted correctly. I have since found two others that don&apos;t extract all of the text.&lt;/p&gt;</comment>
                            <comment id="13704699" author="tallison@mitre.org" created="Wed, 10 Jul 2013 17:06:23 +0100"  >&lt;p&gt;Haven&apos;t had a chance to build from trunk today, but the latest attachment seems to work on my local build of Tika.  Which portions are missing?&lt;/p&gt;</comment>
                            <comment id="13704711" author="tallison@mitre.org" created="Wed, 10 Jul 2013 17:22:48 +0100"  >&lt;p&gt;Tested with freshly built trunk, and the text looks good to me.  Let me know if you don&apos;t find the same.  &lt;/p&gt;

&lt;p&gt;There is a case that this bug fix didn&apos;t cover: if a content control takes up an entire table cell/is the equivalent of a table cell, then that content is not currently being pulled by POI.&lt;/p&gt;

&lt;p&gt;That is on my todo list.&lt;/p&gt;</comment>
                            <comment id="13704760" author="dangby" created="Wed, 10 Jul 2013 18:11:15 +0100"  >&lt;p&gt;It does appear that the newest build I have is working on the newer attachments. Something in my code is somehow removing sections of text. Thanks again.&lt;/p&gt;</comment>
                            <comment id="13704763" author="dangby" created="Wed, 10 Jul 2013 18:12:18 +0100"  >&lt;p&gt;I discovered the problem. I have two apps running, one was using the newest version, the other wasn&apos;t. Now I know I&apos;m not crazy.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12591667" name="OwenResume.docx" size="45813" author="dangby" created="Wed, 10 Jul 2013 17:00:39 +0100"/>
                            <attachment id="12586399" name="Resume 6.4.13.docx" size="127973" author="dangby" created="Wed, 5 Jun 2013 22:58:14 +0100"/>
                            <attachment id="12589682" name="TIKA-1130.patch" size="11051" author="tallison@mitre.org" created="Wed, 26 Jun 2013 00:49:14 +0100"/>
                            <attachment id="12589534" name="TIKA-1130.patch" size="11221" author="tallison@mitre.org" created="Tue, 25 Jun 2013 03:17:33 +0100"/>
                            <attachment id="12591666" name="tee internal resme.docx" size="40002" author="dangby" created="Wed, 10 Jul 2013 16:57:20 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 5 Jun 2013 23:38:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331546</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzf1gn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>331878</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>