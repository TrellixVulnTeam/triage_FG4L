<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:34:16 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-367/TIKA-367.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-367] Mime type rootXML equality improvement</title>
                <link>https://issues.apache.org/jira/browse/TIKA-367</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;While working on &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-357&quot; title=&quot;Increase buffer size for meta tag sniffing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-357&quot;&gt;&lt;del&gt;TIKA-357&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-366&quot; title=&quot;Increase buffer size for mime type sniffing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-366&quot;&gt;&lt;del&gt;TIKA-366&lt;/del&gt;&lt;/a&gt;, I noticed (and Ken did too) that XHTML detection was no longer working in his regression test within o.a.tika.parser.html.HtmlParserTest#testXhtmlParsing. The cause of this has to do with the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-327&quot; title=&quot;Parsing &amp;quot;HTML&amp;quot; as DcXML&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-327&quot;&gt;&lt;del&gt;TIKA-327&lt;/del&gt;&lt;/a&gt;. Because I used namespaceless html and link tags as valid root XML for the text/html mime type, text/html was now matching for the application/html+xml example that Ken had previously included in o.a.tika.parser.html.HtmlParserTest#testXhtmlParsing. Phew. You still with me? OK, so if you are, it turns out that the reason it failed was due to the rootXML matches rules that were being employed. The code boiled down to:&lt;/p&gt;

&lt;p&gt;        boolean matches(String namespaceURI, String localName) {&lt;br/&gt;
            //Compare namespaces&lt;br/&gt;
            if (!isEmpty(this.namespaceURI)) {&lt;br/&gt;
                if (!this.namespaceURI.equals(namespaceURI)) &lt;/p&gt;
{
                    return false;
                }&lt;br/&gt;
            }&lt;br/&gt;
&lt;br/&gt;
            //Compare root element&apos;s local name&lt;br/&gt;
            if (!isEmpty(this.localName)) {&lt;br/&gt;
                if (!this.localName.equals(localName)) {
                    return false;
                }
&lt;p&gt;            }&lt;/p&gt;

&lt;p&gt;   return true&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;The issue with this block is that this version of the #matches function is too lenient. So lenient, to the point of declaring one root-XML match for a localName &quot;html&quot; with no namespace superseded another root-XML with a localName &quot;html&quot;, and that included a namespace. This isn&apos;t the behavior we want. To alleviate this we should check if this.namespaceURI and this.localName are empty (e.g., put in an else block above) and make sure that if they are, the provided namespaceURI and localName are empty as well in order to return true.&lt;/p&gt;</description>
                <environment>&lt;p&gt;My local MacBook pro&lt;/p&gt;</environment>
        <key id="12445996">TIKA-367</key>
            <summary>Mime type rootXML equality improvement</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chrismattmann">Chris A. Mattmann</assignee>
                                    <reporter username="chrismattmann">Chris A. Mattmann</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Jan 2010 05:33:15 +0000</created>
                <updated>Wed, 20 Jan 2010 05:44:46 +0000</updated>
                            <resolved>Wed, 20 Jan 2010 05:44:14 +0000</resolved>
                                    <version>0.5</version>
                                    <fixVersion>0.6</fixVersion>
                                    <component>mime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12802681" author="chrismattmann" created="Wed, 20 Jan 2010 05:44:14 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;fixed in r901066. Updated tika-mimetypes.xml too with improvements to XHTML and RDF detection leveraging the new comparison code present in this patch.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12440999">TIKA-327</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12445991">TIKA-366</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12443946">TIKA-357</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4493</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx47z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17003</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>