<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:27:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-812/TIKA-812.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-812] Improve the detection of Works Spreadsheet 7.0 files</title>
                <link>https://issues.apache.org/jira/browse/TIKA-812</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;This was originally part of ver3 of my patch submitted to &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-806&quot; title=&quot;MS Word Detection magics are a bit overzealous&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-806&quot;&gt;&lt;del&gt;TIKA-806&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Works Spreadsheet files are weird. Versions up to 3.0 used a Quattro Pro magic, version 4.0 used its own magic, while version 7.0 (probably later ones as well) use an OLE2 structure and an MS Office magic. The 7.0 files also contain an entry labelled &quot;Workbook&quot;. In Tika this makes both MimeTypes (due to the quirk recently discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-806&quot; title=&quot;MS Word Detection magics are a bit overzealous&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-806&quot;&gt;&lt;del&gt;TIKA-806&lt;/del&gt;&lt;/a&gt;) and the POIFSContainerDetector label them as Excel.&lt;/p&gt;

&lt;p&gt;&quot;Conceptually&quot; they should be vnd.ms-works, but &quot;technically&quot; they are vnd.ms-excel. A special media type seems like a good compromise, similar in vein to the compromise we reached with &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-798&quot; title=&quot;Distinguish between EMF and WMF&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-798&quot;&gt;&lt;del&gt;TIKA-798&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I would like to mark them with a new media type: &quot;application/x-tika-msworks-spreadsheet&quot;. It would be a subclass of vnd.ms-excel so that:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;With pure MimeTypes and no name, ms-excel could be returned.&lt;/li&gt;
	&lt;li&gt;With MimeTypes with name and data, the correct type could be returned&lt;/li&gt;
	&lt;li&gt;With POIFSContainerDetector the correct type could be returned&lt;/li&gt;
	&lt;li&gt;They can also be added to the list of types supported by ExcelParser as it seems to be able to get some content from them&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="12534975">TIKA-812</key>
            <summary>Improve the detection of Works Spreadsheet 7.0 files</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="antheque">Antoni Mylka</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Dec 2011 16:21:19 +0000</created>
                <updated>Mon, 19 Dec 2011 11:18:40 +0000</updated>
                            <resolved>Mon, 19 Dec 2011 11:18:40 +0000</resolved>
                                    <version>1.1</version>
                                    <fixVersion>1.1</fixVersion>
                                    <component>mime</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13168477" author="antheque" created="Tue, 13 Dec 2011 16:23:31 +0000"  >&lt;p&gt;Attached a test file and a patch, which modifies the detection-related code.&lt;/p&gt;</comment>
                            <comment id="13168902" author="gagravarr" created="Wed, 14 Dec 2011 00:03:53 +0000"  >&lt;p&gt;If we put in a slightly higher priority match for WksSSWorkBook than Workbook, that could solve the mimetypes issue&lt;/p&gt;

&lt;p&gt;In the absence of multi hierarchy in the mimetypes file (we&apos;d need &quot;this is what a user thinks this extends from&quot; and &quot;this is what it really extends from&quot;) then I think this is a sensible approach&lt;/p&gt;</comment>
                            <comment id="13169277" author="antheque" created="Wed, 14 Dec 2011 12:10:18 +0000"  >&lt;p&gt;A second version of the patch. Contains a magic pattern for WksSSWorkBook string with a priority higher than the Excel one. The unit tests pass (which, it turns out, wasn&apos;t the case in the previous one, sorry).&lt;/p&gt;</comment>
                            <comment id="13172196" author="antheque" created="Mon, 19 Dec 2011 11:18:40 +0000"  >&lt;p&gt;Committed tika-812-ver2.patch in r1220687.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12507199" name="testWORKSSpreadsheet7.0.xlr" size="10752" author="antheque" created="Tue, 13 Dec 2011 16:23:31 +0000"/>
                            <attachment id="12507336" name="tika-812-ver2.patch" size="8737" author="antheque" created="Wed, 14 Dec 2011 12:10:17 +0000"/>
                            <attachment id="12507200" name="tika-812.patch" size="7945" author="antheque" created="Tue, 13 Dec 2011 16:23:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 14 Dec 2011 00:03:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>220659</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx1hj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16560</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>