<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:30:54 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-379/TIKA-379.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-379] Html elements and attributes not available in XHTML representation </title>
                <link>https://issues.apache.org/jira/browse/TIKA-379</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;The following HTML document :&lt;/p&gt;

&lt;p&gt;&amp;lt;html lang=&quot;fi&quot;&amp;gt;&amp;lt;head&amp;gt;document 1 title&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;jotain suomeksi&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&lt;/p&gt;

&lt;p&gt;is rendered as the following xhtml by Tika :&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&amp;lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&amp;gt;&amp;lt;head&amp;gt;&amp;lt;title/&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;document 1 titlejotain suomeksi&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&lt;/p&gt;

&lt;p&gt;with the lang attribute getting lost. The lang is not stored in the metadata either.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12456401">TIKA-379</key>
            <summary>Html elements and attributes not available in XHTML representation </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chrismattmann">Chris A. Mattmann</assignee>
                                    <reporter username="jnioche">Julien Nioche</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Feb 2010 09:32:37 +0000</created>
                <updated>Thu, 12 Aug 2010 22:30:17 +0100</updated>
                            <resolved>Mon, 31 May 2010 00:49:37 +0100</resolved>
                                    <version>0.7</version>
                                    <fixVersion>0.8</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12834228" author="kkrugler" created="Tue, 16 Feb 2010 14:31:02 +0000"  >&lt;p&gt;I think this is part of a bigger issue re attributes getting stripped. E.g. &amp;lt;a rel=&quot;nofollow&amp;gt; is important for web crawlers.&lt;/p&gt;

&lt;p&gt;Since the language attribute can be applied to a variety of tags, I don&apos;t think it&apos;s an option to just store it in the metadata.&lt;/p&gt;</comment>
                            <comment id="12856794" author="jnioche" created="Wed, 14 Apr 2010 09:17:00 +0100"  >&lt;p&gt;This is indeed a more generic problem. It also affects HTML elements like &lt;b&gt;link&lt;/b&gt; which are commonly used in head sections to specify favicons or canonical representations. These values are not stored in the metadata  either and are vital for a crawler.&lt;/p&gt;

&lt;p&gt;I agree with Ken that it would be better not only to store information in the metadata but also to be able to retrieve them from the SAX events. &lt;/p&gt;

&lt;p&gt;Looks like this is due to the filtering done in DefaultHTMLMapper which can be overriden in the Context so we could simply pass a less restrictive filter.  The default mapper is based on &lt;a href=&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&lt;/a&gt; which allows &lt;b&gt;link&lt;/b&gt; elements within the &lt;b&gt;head&lt;/b&gt; so we could add it to &lt;em&gt;mapSafeElement()&lt;/em&gt;, however as there are no restrictions on the hierarchy this would mean that such elements would also be allowed within the &lt;b&gt;body&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;Any thoughts?&lt;/p&gt;


</comment>
                            <comment id="12856815" author="jnioche" created="Wed, 14 Apr 2010 10:31:10 +0100"  >&lt;p&gt;There is actually a special treatment for the elements in HEAD done in the class HtmlHandler so simply adding &lt;b&gt;link&lt;/b&gt; to the HTMLMapper does not solve the problem.&lt;/p&gt;</comment>
                            <comment id="12856839" author="jukkaz" created="Wed, 14 Apr 2010 12:10:09 +0100"  >&lt;p&gt;The reason for the default HTML mapping rules in Tika are to simplify and normalize the input documents so that client applications could easily process all sorts of input (HTML or not) without needing type- or source-specific heuristics. The basic idea has been that clients should directly use the underlying parser libraries when it needs custom processing of specific content types.&lt;/p&gt;

&lt;p&gt;That said, I see the value of being able to process even complex HTML input through the Tika API, and perhaps the above original intent is too strict for many use cases. The HtmlMapper interface we added for &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-347&quot; title=&quot;Make HtmlParser customizable through ParseContext&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-347&quot;&gt;&lt;del&gt;TIKA-347&lt;/del&gt;&lt;/a&gt; should make it possible to relax the mapping rules, and in revision 933909 I added a IdentityHtmlMapper implementation of this interface to make it even easier to use:&lt;/p&gt;

&lt;p&gt;    ParseContext context = new ParseContext();&lt;br/&gt;
    context.set(HtmlMapper.class, IdentityHtmlMapper.INSTANCE);&lt;/p&gt;

&lt;p&gt;Note that IdentityHtmlMapper breaks the guarantee that the Tika output is valid XHTML. Also, currently the HtmlMapper interface only covers elements, so all attributes are still lost and IdentityHtmlMapper overrides the custom &amp;lt;a/&amp;gt; tag handling in HtmlHandler so even the href attributes are gone. It would be good if we could extend the HtmlMapper mechanism to avoid these problems.&lt;/p&gt;</comment>
                            <comment id="12856848" author="jnioche" created="Wed, 14 Apr 2010 12:34:49 +0100"  >&lt;p&gt;thanks for your comments.&lt;br/&gt;
I had seen the HTMLMapper but as I pointed out &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There is actually a special treatment for the elements in HEAD done in the class HtmlHandler so simply adding &lt;b&gt;link&lt;/b&gt; to the HTMLMapper does not solve the problem.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I will send a patch later today which modifies the HTMLMapper to make it generate LINK elements in the XHTML output. This is a reasonable thing to do as this entity is allowed in the XHTML DTD.&lt;br/&gt;
I will look at the HTMLMapper later to see how we could get it to keep the href attributes&lt;/p&gt;

</comment>
                            <comment id="12856878" author="jnioche" created="Wed, 14 Apr 2010 14:10:37 +0100"  >&lt;p&gt;Adds the Base, Meta and Link elements found in the Head section to the XHTML output&lt;/p&gt;</comment>
                            <comment id="12856897" author="jnioche" created="Wed, 14 Apr 2010 14:49:45 +0100"  >&lt;p&gt;Attached a second patch with a suggested solution for normalising/filtering incoming attribute names. the code compiles but the tests fail. The purpose is mostly to illustrate the idea before implementing it properly. &lt;/p&gt;
</comment>
                            <comment id="12860170" author="jukkaz" created="Fri, 23 Apr 2010 09:19:53 +0100"  >&lt;p&gt;Re: second patch -  Seems like a good approach.&lt;/p&gt;</comment>
                            <comment id="12863731" author="jnioche" created="Tue, 4 May 2010 10:19:31 +0100"  >&lt;p&gt;Modified patch which fixes test errors. could anyone review it?&lt;br/&gt;
Thanks&lt;/p&gt;

&lt;p&gt;Julien &lt;/p&gt;</comment>
                            <comment id="12873511" author="chrismattmann" created="Mon, 31 May 2010 00:49:37 +0100"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;FYI I committed this in r949635. Thanks, Julien!&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12897803" author="kkrugler" created="Thu, 12 Aug 2010 16:41:34 +0100"  >&lt;p&gt;There&apos;s a problem with this change, where calling the XHTMLContentHandler with elements from inside of the &amp;lt;head&amp;gt; block trigger the premature emitting of &amp;lt;head&amp;gt;&amp;lt;title/&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt; elements. I&apos;ve filed &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-478&quot; title=&quot;HtmlParser can emit &amp;lt;head&amp;gt; elements inside of &amp;lt;body&amp;gt; block&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-478&quot;&gt;&lt;del&gt;TIKA-478&lt;/del&gt;&lt;/a&gt;, and will look at how best to fix this in HtmlHandler.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12463510">NUTCH-817</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12456400">NUTCH-794</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12471430">TIKA-478</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12441731" name="ASF.LICENSE.NOT.GRANTED--TIKA-379" size="1952" author="jnioche" created="Wed, 14 Apr 2010 14:10:37 +0100"/>
                            <attachment id="12441735" name="ASF.LICENSE.NOT.GRANTED--TIKA-379-2.patch" size="7377" author="jnioche" created="Wed, 14 Apr 2010 14:49:45 +0100"/>
                            <attachment id="12443561" name="TIKA-379-3.patch" size="8839" author="jnioche" created="Tue, 4 May 2010 10:19:31 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 Feb 2010 14:31:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4481</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx45b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16991</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>