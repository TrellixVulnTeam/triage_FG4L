<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:31:21 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-792/TIKA-792.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-792] NoSuchMethodException &quot;CTMarkupImpl.&lt;init&gt;(org.apache.xmlbeans.SchemaType, boolean)&quot; processing a OOXML document</title>
                <link>https://issues.apache.org/jira/browse/TIKA-792</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Parsing some OOXML documents, this stacktrace is logged many times:&lt;/p&gt;

&lt;p&gt;java.lang.NoSuchMethodException: org.openxmlformats.schemas.wordprocessingml.x2006.main.impl.CTMarkupImpl.&amp;lt;init&amp;gt;(org.apache.xmlbeans.SchemaType, boolean)&lt;br/&gt;
	at java.lang.Class.getConstructor0(Class.java:2723)&lt;br/&gt;
	at java.lang.Class.getDeclaredConstructor(Class.java:2002)&lt;br/&gt;
	at org.apache.xmlbeans.impl.schema.SchemaTypeImpl.getJavaImplConstructor2(SchemaTypeImpl.java:1749)&lt;br/&gt;
	at org.apache.xmlbeans.impl.schema.SchemaTypeImpl.createUnattachedSubclass(SchemaTypeImpl.java:1886)&lt;br/&gt;
	at org.apache.xmlbeans.impl.schema.SchemaTypeImpl.createUnattachedNode(SchemaTypeImpl.java:1875)&lt;br/&gt;
	at org.apache.xmlbeans.impl.schema.SchemaTypeImpl.createElementType(SchemaTypeImpl.java:1021)&lt;br/&gt;
	at org.apache.xmlbeans.impl.values.XmlObjectBase.create_element_user(XmlObjectBase.java:893)&lt;br/&gt;
	at org.apache.xmlbeans.impl.store.Xobj.getUser(Xobj.java:1657)&lt;br/&gt;
	at org.apache.xmlbeans.impl.store.Cur.getUser(Cur.java:2654)&lt;br/&gt;
	at org.apache.xmlbeans.impl.store.Cur.getObject(Cur.java:2647)&lt;br/&gt;
	at org.apache.xmlbeans.impl.store.Cursor._getObject(Cursor.java:995)&lt;br/&gt;
	at org.apache.xmlbeans.impl.store.Cursor.getObject(Cursor.java:2904)&lt;br/&gt;
	at org.apache.poi.xwpf.usermodel.XWPFParagraph.&amp;lt;init&amp;gt;(XWPFParagraph.java:83)&lt;br/&gt;
	at org.apache.poi.xwpf.usermodel.XWPFDocument.onDocumentRead(XWPFDocument.java:145)&lt;br/&gt;
	at org.apache.poi.POIXMLDocument.load(POIXMLDocument.java:159)&lt;br/&gt;
	at org.apache.poi.xwpf.usermodel.XWPFDocument.&amp;lt;init&amp;gt;(XWPFDocument.java:115)&lt;br/&gt;
	at org.apache.poi.xwpf.extractor.XWPFWordExtractor.&amp;lt;init&amp;gt;(XWPFWordExtractor.java:53)&lt;br/&gt;
	at org.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:180)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:63)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:69)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)&lt;br/&gt;
	at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)&lt;/p&gt;


&lt;p&gt;Looking at the poi code java is right here, there is no constructor with a SchemaType and a boolean, only with SchemaType.&lt;br/&gt;
My guess is this one was missed during upgrade to poi beta4, but only a guess, anyway needs a fix &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux, JDK 1.6, Jetty 8.x, Tomcat 6.x&lt;/p&gt;</environment>
        <key id="12532794">TIKA-792</key>
            <summary>NoSuchMethodException &quot;CTMarkupImpl.&lt;init&gt;(org.apache.xmlbeans.SchemaType, boolean)&quot; processing a OOXML document</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="tkrah">Torsten Krah</reporter>
                        <labels>
                    </labels>
                <created>Sat, 26 Nov 2011 16:08:49 +0000</created>
                <updated>Thu, 26 Sep 2013 16:27:26 +0100</updated>
                            <resolved>Thu, 26 Sep 2013 16:27:14 +0100</resolved>
                                    <version>1.0</version>
                                    <fixVersion>1.2</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13157558" author="gagravarr" created="Sat, 26 Nov 2011 17:38:33 +0000"  >&lt;p&gt;Your quick fix is to replace the poi-ooxml-schemas jar with the full ooxml-schemas-1.1 jar - the former is an excerpt of just the &quot;common&quot; parts&lt;/p&gt;

&lt;p&gt;For a full fix, we need to add a unit test to POI the uses the same method. To decide what&apos;s common, the POI build script looks at what is used in the unit tests, so adding a test that uses a method will cause the appropriate parts to be included in the next poi-ooxml-schemas file&lt;/p&gt;</comment>
                            <comment id="13189839" author="gagravarr" created="Fri, 20 Jan 2012 15:00:31 +0000"  >&lt;p&gt;Are you able to share one of the files that triggers this? The easiest way to add the unit test to POI that would have the classes included is with a file that triggers the problem&lt;/p&gt;</comment>
                            <comment id="13189855" author="tkrah" created="Fri, 20 Jan 2012 15:31:45 +0000"  >&lt;p&gt;I&apos;ll try to find some document(s), may take a few days.&lt;/p&gt;</comment>
                            <comment id="13202473" author="mslama" created="Tue, 7 Feb 2012 15:36:37 +0000"  >&lt;p&gt;We have the same problem. But this time it is Jackrabbit background indexing task so I cannot easily say which file causes this. We put our files into Jackrabbit repository. I will try to replace schemas files as suggested but I have to do it also in Jackabbit files.&lt;/p&gt;</comment>
                            <comment id="13245404" author="mslama" created="Tue, 3 Apr 2012 16:34:19 +0100"  >&lt;p&gt;I do not see this problem now as we upgraded to Jackrabbit 2.4.0 which uses POI 3.8-beta4.&lt;/p&gt;</comment>
                            <comment id="13245436" author="gagravarr" created="Tue, 3 Apr 2012 17:02:57 +0100"  >&lt;p&gt;Thanks for the feedback Marek. As of r1309005 we&apos;re now on POI 3.8 Final, so I&apos;ll mark this as fixed&lt;/p&gt;</comment>
                            <comment id="13433145" author="epascal" created="Mon, 13 Aug 2012 14:59:09 +0100"  >&lt;p&gt;Problem still there for me in version 3.8 final of POI&lt;/p&gt;</comment>
                            <comment id="13674084" author="zhuravskiy.vs" created="Tue, 4 Jun 2013 06:38:46 +0100"  >&lt;p&gt;Bug still present with poi-ooxml-schemas-3.9.jar and tika-parsers-1.3.jar.&lt;br/&gt;
Stack trace:&lt;br/&gt;
java.lang.NoSuchMethodException: org.openxmlformats.schemas.wordprocessingml.x2006.main.impl.CTMarkupRangeImpl.&amp;lt;init&amp;gt;(org.apache.xmlbeans.SchemaType, boolean)&lt;br/&gt;
        at java.lang.Class.getConstructor0(Class.java:2730)&lt;br/&gt;
        at java.lang.Class.getDeclaredConstructor(Class.java:2004)&lt;br/&gt;
        at org.apache.xmlbeans.impl.schema.SchemaTypeImpl.getJavaImplConstructor2(SchemaTypeImpl.java:1749)&lt;br/&gt;
        at org.apache.xmlbeans.impl.schema.SchemaTypeImpl.createUnattachedSubclass(SchemaTypeImpl.java:1886)&lt;br/&gt;
        at org.apache.xmlbeans.impl.schema.SchemaTypeImpl.createUnattachedNode(SchemaTypeImpl.java:1875)&lt;br/&gt;
        at org.apache.xmlbeans.impl.schema.SchemaTypeImpl.createElementType(SchemaTypeImpl.java:1021)&lt;br/&gt;
        at org.apache.xmlbeans.impl.values.XmlObjectBase.create_element_user(XmlObjectBase.java:893)&lt;br/&gt;
        at org.apache.xmlbeans.impl.store.Xobj.getUser(Xobj.java:1657)&lt;br/&gt;
        at org.apache.xmlbeans.impl.store.Cur.getUser(Cur.java:2654)&lt;br/&gt;
        at org.apache.xmlbeans.impl.store.Cur.getObject(Cur.java:2647)&lt;br/&gt;
        at org.apache.xmlbeans.impl.store.Cursor._getObject(Cursor.java:995)&lt;br/&gt;
        at org.apache.xmlbeans.impl.store.Cursor.getObject(Cursor.java:2904)&lt;br/&gt;
        at org.apache.poi.xwpf.usermodel.XWPFParagraph.buildRunsInOrderFromXml(XWPFParagraph.java:124)&lt;br/&gt;
        at org.apache.poi.xwpf.usermodel.XWPFParagraph.&amp;lt;init&amp;gt;(XWPFParagraph.java:79)&lt;br/&gt;
        at org.apache.poi.xwpf.usermodel.XWPFDocument.onDocumentRead(XWPFDocument.java:146)&lt;br/&gt;
        at org.apache.poi.POIXMLDocument.load(POIXMLDocument.java:159)&lt;br/&gt;
        at org.apache.poi.xwpf.usermodel.XWPFDocument.&amp;lt;init&amp;gt;(XWPFDocument.java:116)&lt;br/&gt;
        at org.apache.poi.xwpf.extractor.XWPFWordExtractor.&amp;lt;init&amp;gt;(XWPFWordExtractor.java:53)&lt;br/&gt;
        at org.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:180)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:87)&lt;br/&gt;
        at org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:82)&lt;br/&gt;
        at org.apache.tika.parser.ParserDecorator.parse(ParserDecorator.java:91)&lt;br/&gt;
        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)&lt;br/&gt;
        at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)&lt;br/&gt;
        at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)&lt;/p&gt;</comment>
                            <comment id="13724004" author="lomkitombapik" created="Tue, 30 Jul 2013 17:08:46 +0100"  >&lt;p&gt;Got same issue with tika 1.3 :&lt;/p&gt;

&lt;p&gt;java.lang.NoSuchMethodException: org.openxmlformats.schemas.wordprocessingml.x2006.main.impl.CTMarkupRangeImpl.&amp;lt;init&amp;gt;(org.apache.xmlbeans.SchemaType, boolean)&lt;br/&gt;
                at java.lang.Class.getConstructor0(Class.java:2730)&lt;br/&gt;
                at java.lang.Class.getDeclaredConstructor(Class.java:2004)&lt;br/&gt;
                at org.apache.xmlbeans.impl.schema.SchemaTypeImpl.getJavaImplConstructor2(SchemaTypeImpl.java:1749)&lt;/p&gt;

&lt;p&gt;etc...&lt;/p&gt;
</comment>
                            <comment id="13724010" author="gagravarr" created="Tue, 30 Jul 2013 17:17:12 +0100"  >&lt;p&gt;Do you have a small file that shows up this problem? Only all of our tests files in the current unit test suite pass without this issue...&lt;/p&gt;</comment>
                            <comment id="13729387" author="tallison@mitre.org" created="Mon, 5 Aug 2013 12:05:26 +0100"  >&lt;p&gt;Example document that triggers no such method exceptions for:&lt;br/&gt;
CTMarkupRangeImpl, CTMarkupImpl and CTBookmarkRangeImpl&lt;/p&gt;</comment>
                            <comment id="13729400" author="gagravarr" created="Mon, 5 Aug 2013 12:21:17 +0100"  >&lt;p&gt;Tim - I&apos;d suggest you add this test document to POI, then write a unit test that triggers the same code in POI from the test that Tika is doing. Unit test should pass in POI, but will then trigger the inclusion of these extra classes in the cut-down poi-ooxml-schemas class, which should then fix the issue in Tika&lt;/p&gt;</comment>
                            <comment id="13729746" author="tallison@mitre.org" created="Mon, 5 Aug 2013 19:18:28 +0100"  >&lt;p&gt;Opened &lt;a href=&quot;https://issues.apache.org/bugzilla/show_bug.cgi?id=55361&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/bugzilla/show_bug.cgi?id=55361&lt;/a&gt; and uploaded patch for feedback.  If there are no objections, I&apos;ll commit 55361 tomorrow.&lt;/p&gt;</comment>
                            <comment id="13733804" author="tallison@mitre.org" created="Thu, 8 Aug 2013 19:23:38 +0100"  >&lt;p&gt;Committed in POI.  Once POI3.9beta2 is released, I&apos;ll increment POI&apos;s version in Tika&apos;s build file and confirm that this is taken care of.  There may be other sources of this than the one that my test document triggered.&lt;/p&gt;</comment>
                            <comment id="13773212" author="tallison@mitre.org" created="Fri, 20 Sep 2013 18:28:26 +0100"  >&lt;p&gt;This is now fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1173&quot; title=&quot;Upgrade to POI-3.10-beta2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1173&quot;&gt;&lt;del&gt;TIKA-1173&lt;/del&gt;&lt;/a&gt;.  &lt;/p&gt;

&lt;p&gt;Can anyone recommend a more obvious test of the solution to this than kicking off a process to extract text from the document and capturing std.err?  It would be nice to have something that we can generalize to other documents that trigger this issue because of a different set of missing beans.&lt;/p&gt;</comment>
                            <comment id="13778896" author="tallison@mitre.org" created="Thu, 26 Sep 2013 16:27:06 +0100"  >&lt;p&gt;added test that catches stderr.&lt;br/&gt;
r1526570.&lt;br/&gt;
reopening just to record this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12596081" name="test10.docx" size="17913" author="tallison@mitre.org" created="Mon, 5 Aug 2013 12:05:26 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 26 Nov 2011 17:38:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>218527</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx1lz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16580</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>