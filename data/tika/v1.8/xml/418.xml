<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:31:44 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-418/TIKA-418.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-418] RuntimeException while getting content for ppsx, ppsm, pptm, thmx and xps file types</title>
                <link>https://issues.apache.org/jira/browse/TIKA-418</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I am getting the following error&lt;/p&gt;

&lt;p&gt;Unexpected RuntimeException from org.apache.tika.parser.microsoft.ooxml.OOXMLParser@269b15&lt;/p&gt;

&lt;p&gt;for the following file types&lt;/p&gt;

&lt;p&gt;.PPSM&lt;br/&gt;
.PPSX&lt;br/&gt;
.PPTM&lt;br/&gt;
.THMX&lt;br/&gt;
.XPS&lt;br/&gt;
.XLSB&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Windows&lt;/p&gt;</environment>
        <key id="12463651">TIKA-418</key>
            <summary>RuntimeException while getting content for ppsx, ppsm, pptm, thmx and xps file types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nrajivk">Rajiv Kumar</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 May 2010 11:16:36 +0100</created>
                <updated>Thu, 20 Oct 2011 13:34:17 +0100</updated>
                            <resolved>Sun, 22 May 2011 02:54:47 +0100</resolved>
                                    <version>0.7</version>
                                    <fixVersion>0.10</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12866599" author="jukkaz" created="Wed, 12 May 2010 16:46:30 +0100"  >&lt;p&gt;It would be helpful if you could attach either the exception stack trace you&apos;re getting or an example document that causes this problem.&lt;/p&gt;

&lt;p&gt;It looks like support for these file types is not yet included in the Apache POI library that we use for parsing Microsoft Office files.&lt;/p&gt;</comment>
                            <comment id="12868478" author="muradshahid" created="Tue, 18 May 2010 02:29:15 +0100"  >&lt;p&gt;I received the following runtime exception while parsing an mp3 file:&lt;br/&gt;
Exception in thread &quot;main&quot; org.apache.tika.exception.TikaException: Unexpected RuntimeException from org.apache.tika.parser.mp3.Mp3Parser@5983e7de&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:134)&lt;br/&gt;
	at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:99)&lt;br/&gt;
	at org.apache.tika.cli.TikaCLI.process(TikaCLI.java:169)&lt;br/&gt;
	at org.apache.tika.cli.TikaCLI.main(TikaCLI.java:62)&lt;br/&gt;
Caused by: java.lang.ArrayIndexOutOfBoundsException: -1&lt;br/&gt;
	at org.apache.tika.parser.mp3.ID3v2Frame.getTagString(ID3v2Frame.java:174)&lt;br/&gt;
	at org.apache.tika.parser.mp3.ID3v23Handler.getTagString(ID3v23Handler.java:74)&lt;br/&gt;
	at org.apache.tika.parser.mp3.ID3v23Handler.&amp;lt;init&amp;gt;(ID3v23Handler.java:53)&lt;br/&gt;
	at org.apache.tika.parser.mp3.Mp3Parser.getAllTagHandlers(Mp3Parser.java:134)&lt;br/&gt;
	at org.apache.tika.parser.mp3.Mp3Parser.parse(Mp3Parser.java:64)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:132)&lt;br/&gt;
	... 3 more.&lt;/p&gt;

&lt;p&gt;I&apos;ve attached the mp3 file for more information.&lt;/p&gt;</comment>
                            <comment id="12868480" author="muradshahid" created="Tue, 18 May 2010 02:32:33 +0100"  >&lt;p&gt;The attached file throws a runtime exception when parsing either in an application or using the CLI in Debian GNU/Linux Lenny 64.&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; org.apache.tika.exception.TikaException: Unexpected RuntimeException from org.apache.tika.parser.mp3.Mp3Parser@5983e7de&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:134)&lt;br/&gt;
	at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:99)&lt;br/&gt;
	at org.apache.tika.cli.TikaCLI.process(TikaCLI.java:169)&lt;br/&gt;
	at org.apache.tika.cli.TikaCLI.main(TikaCLI.java:62)&lt;br/&gt;
Caused by: java.lang.ArrayIndexOutOfBoundsException: -1&lt;br/&gt;
	at org.apache.tika.parser.mp3.ID3v2Frame.getTagString(ID3v2Frame.java:174)&lt;br/&gt;
	at org.apache.tika.parser.mp3.ID3v23Handler.getTagString(ID3v23Handler.java:74)&lt;br/&gt;
	at org.apache.tika.parser.mp3.ID3v23Handler.&amp;lt;init&amp;gt;(ID3v23Handler.java:53)&lt;br/&gt;
	at org.apache.tika.parser.mp3.Mp3Parser.getAllTagHandlers(Mp3Parser.java:134)&lt;br/&gt;
	at org.apache.tika.parser.mp3.Mp3Parser.parse(Mp3Parser.java:64)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:132)&lt;br/&gt;
	... 3 more&lt;/p&gt;</comment>
                            <comment id="12871594" author="jukkaz" created="Wed, 26 May 2010 10:44:51 +0100"  >&lt;p&gt;See the duplicate issue &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-428&quot; title=&quot;Unexpected RuntimeException when parsing PPTM (?) file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-428&quot;&gt;&lt;del&gt;TIKA-428&lt;/del&gt;&lt;/a&gt; for a stack trace of this problem.&lt;/p&gt;

&lt;p&gt;PS. The MP3 problem is not related to this POI issue. Can you please file a separate issue for that?&lt;/p&gt;</comment>
                            <comment id="12871606" author="jukkaz" created="Wed, 26 May 2010 11:02:48 +0100"  >&lt;p&gt;In revision 948378 I added a simple catch statement that captures this problem and throws a TikaException with a better error message.&lt;/p&gt;

&lt;p&gt;Meanwhile it seems like at least the missing PowerPoint types have been added to POI trunk in revision 898292 &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. Thus I&apos;m marking this issue as blocked by &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-373&quot; title=&quot;Upgrade to POI 3.7&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-373&quot;&gt;&lt;del&gt;TIKA-373&lt;/del&gt;&lt;/a&gt; while we wait for the next POI release.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=898292&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=898292&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12871614" author="jukkaz" created="Wed, 26 May 2010 11:26:27 +0100"  >&lt;p&gt;Re: mp3 problem, in fact it was already filed separately as &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-424&quot; title=&quot;Avoid ArrayIndexOutOfBoundsException on some mp3 files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-424&quot;&gt;&lt;del&gt;TIKA-424&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12883201" author="gagravarr" created="Mon, 28 Jun 2010 17:07:59 +0100"  >&lt;p&gt;Any chance someone could upload some sample files in these problem formats? Hopefully several of them will now work, following the POI dependency upgrade, but it would be good to have some example files to write unit tests against&lt;/p&gt;</comment>
                            <comment id="12883429" author="nrajivk" created="Tue, 29 Jun 2010 07:40:13 +0100"  >&lt;p&gt;MSPPT2007.pptx - Original file for creating other files&lt;br/&gt;
MSPPT2007.ppsx - Save As from the .pptx file using MS Office PowerPoint 2007&lt;br/&gt;
MSPPT2007.ppsm - Save As from the .pptx file using MS Office PowerPoint 2007&lt;/p&gt;</comment>
                            <comment id="12883430" author="nrajivk" created="Tue, 29 Jun 2010 07:41:29 +0100"  >&lt;p&gt;MSPPT2007.pptm - Save As from the .pptx file using MS Office PowerPoint 2007&lt;br/&gt;
MSPPT2007.thmx - Save As from the .pptx file using MS Office PowerPoint 2007&lt;br/&gt;
MSPPT2007.xps - Save As from the .pptx file using MS Office PowerPoint 2007&lt;/p&gt;</comment>
                            <comment id="12883431" author="nrajivk" created="Tue, 29 Jun 2010 07:42:58 +0100"  >&lt;p&gt;Added 6 new files for testing. Note that MSPPT2007.pptx works well and I have used &quot;Save As&quot; feature of MS Office PowerPoint 2007 to create the other files from this file. All of them have the same content.&lt;/p&gt;</comment>
                            <comment id="12883511" author="gagravarr" created="Tue, 29 Jun 2010 12:14:35 +0100"  >&lt;p&gt;ppsx, ppsm, pptm and pptx are all supported, and I&apos;ve added a unit test that confirms this&lt;/p&gt;

&lt;p&gt;.thmx isn&apos;t currently supported, but will be after the next POI upgrade. However, the .thmx file format doesn&apos;t seem to have any textual content in it! Certainly none of your sample words show up in the example file&lt;/p&gt;

&lt;p&gt;.xps isn&apos;t currently supported by POI. Quite a lot of work will be needed for it, as it&apos;s not really like any of the other currently supported ooxml file formats. Please join the POI dev list and start sending patches if you&apos;re interested in adding support!&lt;/p&gt;</comment>
                            <comment id="13037496" author="jukkaz" created="Sun, 22 May 2011 02:54:47 +0100"  >&lt;p&gt;Resolving as fixed based on Nick&apos;s comment above.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12446698">TIKA-373</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12444755" name="Guitarras de luna - tierra mestiza.mp3" size="4602937" author="muradshahid" created="Tue, 18 May 2010 02:32:32 +0100"/>
                            <attachment id="12448280" name="MSPPT2007.ppsm" size="36545" author="nrajivk" created="Tue, 29 Jun 2010 07:40:13 +0100"/>
                            <attachment id="12448279" name="MSPPT2007.ppsx" size="36521" author="nrajivk" created="Tue, 29 Jun 2010 07:40:13 +0100"/>
                            <attachment id="12448281" name="MSPPT2007.pptm" size="36541" author="nrajivk" created="Tue, 29 Jun 2010 07:41:29 +0100"/>
                            <attachment id="12448278" name="MSPPT2007.pptx" size="36518" author="nrajivk" created="Tue, 29 Jun 2010 07:40:13 +0100"/>
                            <attachment id="12448282" name="MSPPT2007.thmx" size="42485" author="nrajivk" created="Tue, 29 Jun 2010 07:41:29 +0100"/>
                            <attachment id="12448283" name="MSPPT2007.xps" size="75442" author="nrajivk" created="Tue, 29 Jun 2010 07:41:29 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 12 May 2010 15:46:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4443</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx3wn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16952</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>