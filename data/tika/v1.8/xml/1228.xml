<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:30:53 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1228/TIKA-1228.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1228] Embedded files not extracted properly from PDF</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1228</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;IAW pdfbox example here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/repos/asf/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/pdmodel/ExtractEmbeddedFiles.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/pdfbox/trunk/examples/src/main/java/org/apache/pdfbox/examples/pdmodel/ExtractEmbeddedFiles.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;the PDF parser does not check for additional entries under Kids node when Names node does not exist.&lt;/p&gt;</description>
                <environment>&lt;p&gt;CentOS 6.5 VM&lt;/p&gt;</environment>
        <key id="12692884">TIKA-1228</key>
            <summary>Embedded files not extracted properly from PDF</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="agi20dla">Jason Sherman</reporter>
                        <labels>
                            <label>easyfix</label>
                    </labels>
                <created>Mon, 3 Feb 2014 15:34:30 +0000</created>
                <updated>Tue, 25 Mar 2014 16:21:50 +0000</updated>
                            <resolved>Mon, 3 Feb 2014 20:14:34 +0000</resolved>
                                    <version>1.4</version>
                                    <fixVersion>1.5</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13889560" author="gagravarr" created="Mon, 3 Feb 2014 15:43:16 +0000"  >&lt;p&gt;Do you have a file which shows up the problem? And if so, any chance you could write a short junit unit test that highlights the issue using it?&lt;/p&gt;</comment>
                            <comment id="13889569" author="agi20dla" created="Mon, 3 Feb 2014 15:55:48 +0000"  >&lt;p&gt;Sorry about that.  I meant to attach the file in the first place.  This is a file I was given to use for development testing.  I&apos;ll get a test written as soon as I can, probably later today.  Thanks for the quick response.&lt;/p&gt;</comment>
                            <comment id="13889859" author="tallison@mitre.org" created="Mon, 3 Feb 2014 20:14:34 +0000"  >&lt;p&gt;Fixed in r1564042.&lt;/p&gt;

&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=agi20dla&quot; class=&quot;user-hover&quot; rel=&quot;agi20dla&quot;&gt;Jason Sherman&lt;/a&gt;, for reporting this and diagnosing the cause and solution for this bug!&lt;/p&gt;

&lt;p&gt;I&apos;m resolving this for now.  I&apos;m waiting to hear back from users@pdfbox to see if we should search recursively for non-null attachment data.  The example that you provided does show only checking the children.  I&apos;ll reopen this issue if we need to switch to full recursion.&lt;/p&gt;

&lt;p&gt;Thank you, again.&lt;/p&gt;</comment>
                            <comment id="13889889" author="agi20dla" created="Mon, 3 Feb 2014 20:35:43 +0000"  >&lt;p&gt;Thanks for the help.  Another possibly related issue is:&lt;br/&gt;
When I was stepping through the pdfbox code, line 286 in PDNameTreeNode throws an exception when running, but processes properly in my evaluation dialog (Intellij 13)&lt;/p&gt;

&lt;p&gt;namesArray = (COSArray)((COSDictionary)((COSArray)node.getDictionaryObject(COSName.KIDS)).get(0)).getDictionaryObject(COSName.NAMES);&lt;/p&gt;

&lt;p&gt;Throws:&lt;br/&gt;
org.apache.pdfbox.cos.COSObject cannot be cast to org.apache.pdfbox.cos.COSDictionary&lt;/p&gt;

&lt;p&gt;Do you want to pass that on to the pdfbox folks, or should I report it separately?&lt;/p&gt;</comment>
                            <comment id="13890605" author="tallison@mitre.org" created="Tue, 4 Feb 2014 12:13:35 +0000"  >&lt;p&gt;Not sure I understand.  Is this the snippet that you refer to in PDNameTreeNode:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    public Map&amp;lt;String, COSObjectable&amp;gt; getNames() throws IOException
    {
        COSArray namesArray = (COSArray)node.getDictionaryObject( COSName.NAMES );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above throws a class cast exception, but the code that you show doesn&apos;t?&lt;/p&gt;

&lt;p&gt;Are you getting a class cast exception on the document that you submitted with this issue or is it a different document?&lt;/p&gt;

&lt;p&gt;Thank you, again.&lt;/p&gt;</comment>
                            <comment id="13890607" author="agi20dla" created="Tue, 4 Feb 2014 12:15:31 +0000"  >&lt;p&gt;Tim,&lt;/p&gt;

&lt;p&gt;I saw you already added a test and fix to the codebase.  Thanks!  I&apos;m going to clone it and use it if you don&apos;t mind. &lt;/p&gt;

&lt;p&gt;Jason&lt;/p&gt;</comment>
                            <comment id="13890608" author="agi20dla" created="Tue, 4 Feb 2014 12:26:20 +0000"  >&lt;p&gt;Tim,&lt;/p&gt;

&lt;p&gt;Dang.  During my troubleshooting, I first updated pdfbox to 1.8.3 and was using that source to step through the code.  After the weirdness with the exception in code, but not in my expression evaluator, I reverted to the original tika code, but failed to revert the pdfbox code.  I apologize for the confusion.  Thanks again for your fast responses.&lt;/p&gt;

&lt;p&gt;Jason&lt;/p&gt;</comment>
                            <comment id="13890610" author="tallison@mitre.org" created="Tue, 4 Feb 2014 12:27:52 +0000"  >&lt;p&gt;Y.  That&apos;s the point of open source. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  Enjoy!&lt;/p&gt;

&lt;p&gt;Now that I&apos;m looking at this issue again, I dragged out some of my pre-Tika code for pdf attachments using a different pdf library.  It looks like the pdf files I was coding against could have the file name in a parent node and the actual bytes in a child or more distant descendant node.&lt;/p&gt;

&lt;p&gt;Will see if I can dig up the triggering files and see if Tika needs any more mods on PDF attachment extraction.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;private MyPDFAttachment lookForByteStream(COSDictionary dict, MyPDFAttachment attach, int recursiveDepth){
		
    COSName fCOSName = COSName.create(&quot;F&quot;);
    COSName efCOSName = COSName.create(&quot;EF&quot;);
    COSObject fObj = dict.get(fCOSName);
    COSObject efObj = dict.get(efCOSName);
    if (null != fObj){
        if (fObj.getClass() == COSString.class){
            attach.setName(fObj.stringValue());
        } else if (fObj.getClass() == COSStream.class){
            attach.setBytes(((COSStream)fObj).getDecodedBytes());
            return attach;
        }
    } 
    if (null != efObj &amp;amp;&amp;amp; efObj.getClass() == COSDictionary.class){ 
        int tmpI = recursiveDepth;
        tmpI++;
        return lookForByteStream((COSDictionary)efObj, attach, tmpI);	
    }
    return null;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13890613" author="tallison@mitre.org" created="Tue, 4 Feb 2014 12:29:32 +0000"  >&lt;p&gt;Ok, to confirm, the PDNameTreeNode class cast exception is a non-issue?&lt;/p&gt;

&lt;p&gt;Thanks again.&lt;/p&gt;</comment>
                            <comment id="13890639" author="agi20dla" created="Tue, 4 Feb 2014 13:11:45 +0000"  >&lt;p&gt;Correct.  PDNameTreeNode class cast exception is a non-issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12626670" name="pdf_with_doc_and_text_attached.pdf" size="2318262" author="agi20dla" created="Mon, 3 Feb 2014 15:55:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 3 Feb 2014 15:43:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>371470</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzlvdj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>371773</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>