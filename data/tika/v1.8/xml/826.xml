<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:30:59 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-826/TIKA-826.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-826] TikaException / OfficeXmlFileException with .xlsb files</title>
                <link>https://issues.apache.org/jira/browse/TIKA-826</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;The file testEXCEL.xlsb in the tika-parsers test-documents folder causes a POI OfficeXmlFileException when one tries to open it with TikaGUI or TikaCLI, using a latest build.  The reason: Tika has it configured to be opened with the OfficeParser class, rather than the OOXMLParser class; it is an Office 2007 file, and should be opened with the OOXMLParser class.  Neither the ExcelParserTest class nor the OOXMLParserTest class has anything related to .xlsb files.  Once changes are made to these two parsers so that the OOXMLParser is used (I&apos;ll submit a patch shortly for these), the OfficeXmlFileException goes away, and a new POI exception (IllegalArgumentException in the ExtractorFactory class) arises in its place, somewhat related to unsolved POI bug 51921; the creator of this bug mentions a .xlsb file among others.  This exception appears to occur because POI doesn&apos;t seem to be able to handle .xlsb files whatsoever.  A cursory search of the source for &quot;xlsb&quot; or its mime type yields nothing relevant, and its project has no .xlsb test files that I can see.   &lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7&lt;/p&gt;</environment>
        <key id="12536122">TIKA-826</key>
            <summary>TikaException / OfficeXmlFileException with .xlsb files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jfm.apache">John Mastarone</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Dec 2011 04:14:25 +0000</created>
                <updated>Tue, 3 Jan 2012 05:13:31 +0000</updated>
                            <resolved>Tue, 3 Jan 2012 05:13:31 +0000</resolved>
                                    <version>1.1</version>
                                    <fixVersion>1.1</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13174604" author="jfm.apache" created="Thu, 22 Dec 2011 04:16:34 +0000"  >&lt;p&gt;Patch for OfficeParser and OOXMLParser classes so that .xlsb files are handled by the latter.  Solves one problem and exposes another.&lt;/p&gt;</comment>
                            <comment id="13174803" author="jfm.apache" created="Thu, 22 Dec 2011 13:35:07 +0000"  >&lt;p&gt;After reading a little more on this, I see that POI doesn&apos;t plan on supporting xlsb files anytime soon (I think), so, should Tika really try to handle them at all?&lt;/p&gt;</comment>
                            <comment id="13175240" author="gagravarr" created="Fri, 23 Dec 2011 02:54:52 +0000"  >&lt;p&gt;POI doesn&apos;t support .xlsb files, and nor is it likely to any time soon (there&apos;s just no volunteer energy to work on it, nor interest)&lt;/p&gt;

&lt;p&gt;.xlsb files should be being detected as application/vnd.ms-excel.sheet.binary.macroenabled.12, and I don&apos;t believe any parser should be claiming them.&lt;/p&gt;

&lt;p&gt;Are you able to identify where along the way things go wrong?&lt;/p&gt;</comment>
                            <comment id="13175625" author="jfm.apache" created="Fri, 23 Dec 2011 23:51:32 +0000"  >&lt;p&gt;The way things are presently, there&apos;s an explicit line in the OfficeParser for the xlsb mime type, which results in the OfficeXmlFileException, with message &quot;The supplied data appears to be in the Office 2007+ XML. You are calling the part of POI that deals with OLE2 Office Documents. You need to call a different part of POI to process this data (eg XSSF instead of HSSF)&quot;.  If one removes this line from OfficeParser, then, whether one cuts and pastes this line into the OOXMLParser or does nothing and leaves it out of the parsers entirely, the OOXMLParser tries to handle the document, and the same exception ensues in either case: &quot;org.apache.tika.exception.TikaException: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-418&quot; title=&quot;RuntimeException while getting content for ppsx, ppsm, pptm, thmx and xps file types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-418&quot;&gt;&lt;del&gt;TIKA-418&lt;/del&gt;&lt;/a&gt;: RuntimeException while getting content for thmx and xps file types&lt;br/&gt;
	at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:106)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.ooxml.OOXMLParser.parse(OOXMLParser.java:70)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)....&lt;br/&gt;
Caused by: java.lang.IllegalArgumentException: No supported documents found in the OOXML package (found application/vnd.ms-excel.sheet.binary.macroEnabled.main)&lt;br/&gt;
	at org.apache.poi.extractor.ExtractorFactory.createExtractor(ExtractorFactory.java:191)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.ooxml.OOXMLExtractorFactory.parse(OOXMLExtractorFactory.java:63)&lt;br/&gt;
	... 43 more &quot;&lt;br/&gt;
I don&apos;t know enough about the code base to know how to get the parsers to leave .xlsb files alone entirely.&lt;/p&gt;</comment>
                            <comment id="13178632" author="gagravarr" created="Tue, 3 Jan 2012 05:13:20 +0000"  >&lt;p&gt;Should be fixed in r1226651 - Neither parser now claims the format, and if it gets to the OOXML one on the basis of the parent type, it&apos;s declined. Tests also added for these cases.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12508344" name="TIKA-826.patch" size="1898" author="jfm.apache" created="Thu, 22 Dec 2011 04:16:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 23 Dec 2011 02:54:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>221805</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx1ef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16546</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>