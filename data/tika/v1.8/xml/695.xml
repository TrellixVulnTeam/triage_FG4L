<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:33:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-695/TIKA-695.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-695] Custom properties on xlsx, docx, pptx</title>
                <link>https://issues.apache.org/jira/browse/TIKA-695</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Parser on office Xfiles do not get custom properties.&lt;/p&gt;

&lt;p&gt;In class MetadataExtractor, method extract, only core and extended properties are retrieve.&lt;br/&gt;
I added something like this:&lt;/p&gt;

&lt;p&gt;extractMetadata(extractor.getCustomProperties(), metadata);&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;	/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Add this method to read custom properties on document.&lt;/li&gt;
	&lt;li&gt;&lt;/li&gt;
	&lt;li&gt;@param properties All custom properties.&lt;/li&gt;
	&lt;li&gt;@param metadata Metadata to complete with read properties.&lt;br/&gt;
	 */&lt;br/&gt;
	private void extractMetadata(CustomProperties properties, Metadata metadata) {&lt;br/&gt;
		org.openxmlformats.schemas.officeDocument.x2006.customProperties.CTProperties propsHolder = properties.getUnderlyingProperties();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;		String value = null;&lt;br/&gt;
		DateUtils dateUtils = DateUtils.getInstance();&lt;br/&gt;
		BigDecimal bigDecimal;&lt;/p&gt;

&lt;p&gt;		for (CTProperty property : propsHolder.getPropertyList()) {&lt;br/&gt;
			/* Parse each property */&lt;br/&gt;
			if (property.isSetLpwstr()) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
				value = property.getLpwstr();
			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else if (property.isSetFiletime()) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
				value = dateUtils.convertDate(property.getFiletime(), null);
			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else if (property.isSetDate()) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
				value = dateUtils.convertDate(property.getDate(), null);
			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else if (property.isSetDecimal()) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
				bigDecimal = property.getDecimal();
				value = null == bigDecimal ? null }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else if (property.isSetBool()) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
				value = BooleanUtils.toStringTrueFalse(property.getBool());
			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else if (property.isSetInt()) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
				value = Integer.toString(property.getInt());
			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else if (property.isSetLpstr()) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
				value = property.getLpstr();
			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else if (property.isSetI4()) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
				/* Number in Excel for example.... Why i4 ? Ask microsoft. */
				value = Integer.toString(property.getI4());
			}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt; else &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {
				/* For other type, do nothing. */
				continue;
			}&lt;/span&gt; &lt;/div&gt;

&lt;p&gt;			/* Add the custom prefix, as done in old office format. */&lt;br/&gt;
			addProperty(metadata, &quot;custom:&quot; + property.getName(), value);&lt;br/&gt;
		}&lt;br/&gt;
	}&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment>&lt;p&gt;All OS&lt;/p&gt;</environment>
        <key id="12519797">TIKA-695</key>
            <summary>Custom properties on xlsx, docx, pptx</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ejouvin">Etienne Jouvin</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Aug 2011 08:27:36 +0100</created>
                <updated>Thu, 12 Jan 2012 15:00:51 +0000</updated>
                            <resolved>Thu, 12 Jan 2012 15:00:51 +0000</resolved>
                                    <version>0.10</version>
                    <version>1.0</version>
                                    <fixVersion>1.1</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13179780" author="ejouvin" created="Wed, 4 Jan 2012 19:24:41 +0000"  >&lt;p&gt;I have just post a solution for that. See the issue &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-694&quot; title=&quot;On extraction, get properties AND / OR content extraction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-694&quot;&gt;&lt;del&gt;TIKA-694&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-694&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-694&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13180140" author="gagravarr" created="Thu, 5 Jan 2012 02:39:36 +0000"  >&lt;p&gt;Would it be possible for you to create some sample files containing custom properties? We can then use that as part of a unit test when we add the functionality in&lt;/p&gt;</comment>
                            <comment id="13180263" author="ejouvin" created="Thu, 5 Jan 2012 10:24:49 +0000"  >&lt;p&gt;I posted a project for the issue 694 where I put some unit test on files with custom properties.&lt;br/&gt;
In this package, I made two things:&lt;br/&gt;
. Parse office and pdf metadata only, do not take care of content.&lt;br/&gt;
. Extract custom properties.&lt;/p&gt;</comment>
                            <comment id="13185001" author="gagravarr" created="Thu, 12 Jan 2012 15:00:43 +0000"  >&lt;p&gt;Thanks for the sample files. Based on them, I&apos;ve added support for all the common custom property types (to both Tika and POI), and added unit tests for custom properties on both OLE2 and OOXML files&lt;/p&gt;

&lt;p&gt;As of r1230576, custom properties from OOXML files are being correctly extracted&lt;/p&gt;

&lt;p&gt;The only parts left not supported are Vectors/Arrays (where a property can have multiple values), and the byte based blogs/streams. I don&apos;t think we&apos;re likely to be able to do much with the byte based ones, but possibly the vectors/arrays could be worth adding later. If you&apos;re able to create files with these custom properties, please open a new enhancement for it!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12519795">TIKA-694</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 5 Jan 2012 02:39:36 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3847</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx27j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16677</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>