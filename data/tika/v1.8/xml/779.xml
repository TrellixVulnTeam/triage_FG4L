<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:33:00 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-779/TIKA-779.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-779] Detection of Microsoft Works 2000 Word Processor files</title>
                <link>https://issues.apache.org/jira/browse/TIKA-779</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;In older versions of Tika, our Microsoft Works 2000 Word Processor example file would get recognized properly by the POIFSContainerDetector. Now it isn&apos;t. Some debugging revealed that the improvements from &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-704&quot; title=&quot;PDF and Outlook docs embedded in MS Word documents not parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-704&quot;&gt;&lt;del&gt;TIKA-704&lt;/del&gt;&lt;/a&gt; broke the detection of that particular file. The detection is based on top-level names obtained from the root DirectoryNode. In case of this file there are two strings in that set: &quot;CONTENTS&quot; and &quot;\u0001CompObj&quot;. In older versions &quot;CONTENTS&quot; was enough to recognize a file as &quot;application/vnd.ms-works&quot;. Now it looks like this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (names.contains(&quot;CONTENTS&quot;) &amp;amp;&amp;amp; names.contains(&quot;SPELLING&quot;)) {
   return WPS;
} else if (names.contains(&quot;CONTENTS&quot;)) {
   // CONTENTS without SPELLING normally means some sort of
   //  embedded non-office file inside an OLE2 document
   // This is most commonly triggered on nested directories
   return OLE;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now I have a file with CONTENTS, but without SPELLING, and it&apos;s a normal WPS file. I did a workaround like this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if ( names.contains(&quot;CONTENTS&quot;) &amp;amp;&amp;amp; 
    (names.contains(&quot;SPELLING&quot;) || names.contains(&quot;\u0001CompObj&quot;))) {
   return WPS;
} else if (names.contains(&quot;CONTENTS&quot;)) {
   // CONTENTS without SPELLING normally means some sort of
   //  embedded non-office file inside an OLE2 document
   // This is most commonly triggered on nested directories
   return OLE;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So &quot;CONTENTS&quot; has to be supplemented by &quot;SPELLING&quot; or &quot;\u0001CompObj&quot;. I don&apos;t know the meaning of this and I don&apos;t know if that second string also occurs in those &quot;embedded non-office files inside an OLE2 documents&quot;, referred to in that comment. The workaround solves the problem for me, the Tika build tests pass and regression tests of my apps pass as well.&lt;/p&gt;

&lt;p&gt;Jukka, do you have more than one WPS file, and all of them have both CONTENTS and SPELLING names in that collection? Is the &quot;\u0001CompObj&quot; string characteristic to this format, or is it a generic thing which also occurs on those &quot;non-office files&quot; or &quot;nested directories&quot;. If yes, just close this as wontfix. &lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7, 64 bit&lt;/p&gt;</environment>
        <key id="12530998">TIKA-779</key>
            <summary>Detection of Microsoft Works 2000 Word Processor files</summary>
                <type id="6" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/requirement.png">Test</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="antoni.mylka">Antoni Mylka</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Nov 2011 13:37:39 +0000</created>
                <updated>Tue, 15 Nov 2011 09:42:50 +0000</updated>
                            <resolved>Tue, 15 Nov 2011 09:42:50 +0000</resolved>
                                    <version>1.0</version>
                                    <fixVersion>1.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13147679" author="antoni.mylka" created="Thu, 10 Nov 2011 13:42:35 +0000"  >&lt;p&gt;a test WPS files with no SPELLING top level name&lt;/p&gt;</comment>
                            <comment id="13147681" author="antoni.mylka" created="Thu, 10 Nov 2011 13:44:07 +0000"  >&lt;p&gt;My workaround + test.&lt;/p&gt;</comment>
                            <comment id="13150331" author="gagravarr" created="Tue, 15 Nov 2011 09:42:39 +0000"  >&lt;p&gt;Thanks, patch applied (with some tweaks) in r1202109.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12503207" name="microsoft-works-word-processor-2000.wps" size="5120" author="antoni.mylka" created="Thu, 10 Nov 2011 13:42:35 +0000"/>
                            <attachment id="12503208" name="tika-779.patch" size="2304" author="antoni.mylka" created="Thu, 10 Nov 2011 13:44:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 Nov 2011 09:42:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>216736</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx1ov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16593</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>