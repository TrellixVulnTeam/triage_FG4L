<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:37:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1410/TIKA-1410.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1410] Temporary OLE File Leak</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1410</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;It did not happen with tika-1.5. I think it was introduced with POI-3.11-beta2 upgrade. I am not being able to rename a lot of files after the parsing, seems to be some file handle not being closed.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7 Enterprise x64, JRE 1.8.0_11 64-bit&lt;/p&gt;</environment>
        <key id="12739700">TIKA-1410</key>
            <summary>Temporary OLE File Leak</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="lfcnassif">Luis Filipe Nassif</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Sep 2014 16:49:55 +0100</created>
                <updated>Mon, 8 Sep 2014 21:04:57 +0100</updated>
                            <resolved>Mon, 8 Sep 2014 21:02:18 +0100</resolved>
                                    <version>1.6</version>
                                    <fixVersion>1.7</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="14124861" author="gagravarr" created="Sun, 7 Sep 2014 11:37:32 +0100"  >&lt;p&gt;How are you calling Tika? Tika App? Tika Server? Tika java facade class? DefaultParser directly?&lt;/p&gt;

&lt;p&gt;What steps are needed to reproduce this? What platform(s) are you seeing this on?&lt;/p&gt;</comment>
                            <comment id="14125505" author="lfcnassif" created="Mon, 8 Sep 2014 15:01:07 +0100"  >&lt;p&gt;I am calling CompositeParser directly. The problem is always reproduced in my app only with Tika-1.6. I am trying to do a simple Test case do reproduce the problem. Till now, I have attached a java agent to the application to track the open file handles and where they were opened. Output below:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
#6 E:\teste\Exportados\3.xls by thread:pool-4-thread-2 on Mon Sep 08 10:39:34 BRT 2014
	at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:234)
	at org.apache.poi.poifs.nio.FileBackedDataSource.newSrcFile(FileBackedDataSource.java:130)
	at org.apache.poi.poifs.nio.FileBackedDataSource.&amp;lt;init&amp;gt;(FileBackedDataSource.java:46)
	at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.&amp;lt;init&amp;gt;(NPOIFSFileSystem.java:192)
	at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.&amp;lt;init&amp;gt;(NPOIFSFileSystem.java:163)
	at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:162)
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:244)
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:244)
	at dpf.sp.gpinf.indexer.parsers.IndexerDefaultParser.parse(IndexerDefaultParser.java:109)
	at dpf.sp.gpinf.indexer.io.ParsingReader$ParsingTask.run(ParsingReader.java:222)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
	at java.util.concurrent.FutureTask.run(FutureTask.java:166)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
#7 E:\teste\Exportados\4.xls by thread:pool-4-thread-1 on Mon Sep 08 10:39:34 BRT 2014
	at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(RandomAccessFile.java:234)
	at org.apache.poi.poifs.nio.FileBackedDataSource.newSrcFile(FileBackedDataSource.java:130)
	at org.apache.poi.poifs.nio.FileBackedDataSource.&amp;lt;init&amp;gt;(FileBackedDataSource.java:46)
	at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.&amp;lt;init&amp;gt;(NPOIFSFileSystem.java:192)
	at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.&amp;lt;init&amp;gt;(NPOIFSFileSystem.java:163)
	at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:162)
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:244)
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:244)
	at dpf.sp.gpinf.indexer.parsers.IndexerDefaultParser.parse(IndexerDefaultParser.java:109)
	at dpf.sp.gpinf.indexer.io.ParsingReader$ParsingTask.run(ParsingReader.java:222)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
	at java.util.concurrent.FutureTask.run(FutureTask.java:166)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14125823" author="gagravarr" created="Mon, 8 Sep 2014 18:58:04 +0100"  >&lt;p&gt;I don&apos;t use Windows, so I can&apos;t be sure, but I think that the change in r1623448 should have fixed it - I&apos;ve updated the parser to attach the opened container to the TikaInputStream, so it gets closed when the overall stream is closed. Can you see if that solves it for you?&lt;/p&gt;</comment>
                            <comment id="14125839" author="hudson" created="Mon, 8 Sep 2014 19:08:57 +0100"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.6 #177 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/177/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/177/&lt;/a&gt;)&lt;br/&gt;
If we open a new NPOIFS object from a TikaInputStream, attach the opened container to the stream so it gets auto-closed when parsing is complete &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1410&quot; title=&quot;Temporary OLE File Leak&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1410&quot;&gt;&lt;del&gt;TIKA-1410&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1623448&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1623448&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14125911" author="hudson" created="Mon, 8 Sep 2014 19:49:22 +0100"  >&lt;p&gt;FAILURE: Integrated in tika-trunk-jdk1.7 #198 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/198/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/198/&lt;/a&gt;)&lt;br/&gt;
If we open a new NPOIFS object from a TikaInputStream, attach the opened container to the stream so it gets auto-closed when parsing is complete &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1410&quot; title=&quot;Temporary OLE File Leak&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1410&quot;&gt;&lt;del&gt;TIKA-1410&lt;/del&gt;&lt;/a&gt; (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1623448&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1623448&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/microsoft/OfficeParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14126013" author="lfcnassif" created="Mon, 8 Sep 2014 21:00:02 +0100"  >&lt;p&gt;Fix resolved issue on Windows too. Thank you, Nick.&lt;/p&gt;</comment>
                            <comment id="14126019" author="lfcnassif" created="Mon, 8 Sep 2014 21:02:18 +0100"  >&lt;p&gt;Fixed with r1623448.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 7 Sep 2014 10:37:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hztmhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>