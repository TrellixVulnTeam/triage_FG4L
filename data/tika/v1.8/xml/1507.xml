<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:32:18 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1507/TIKA-1507.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1507] Under OSGi, ForkParser failes to send core parser classes like ExternalParser</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1507</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;Under OSGi, if you try to use ForkParser with the Tesseract OCR parser, it will fail with:&lt;/p&gt;

&lt;p&gt;java.lang.NoClassDefFoundError: org/apache/tika/parser/external/ExternalParser&lt;br/&gt;
	at org.apache.tika.parser.ocr.TesseractOCRParser.hasTesseract(TesseractOCRParser.java:117)&lt;br/&gt;
	at org.apache.tika.parser.ocr.TesseractOCRParser.getSupportedTypes(TesseractOCRParser.java:91)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.getParsers(CompositeParser.java:81)&lt;br/&gt;
	at org.apache.tika.parser.DefaultParser.getParsers(DefaultParser.java:95)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.getParser(CompositeParser.java:209)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:244)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:622)&lt;br/&gt;
	at org.apache.tika.fork.ForkServer.call(ForkServer.java:144)&lt;br/&gt;
	at org.apache.tika.fork.ForkServer.processRequests(ForkServer.java:124)&lt;br/&gt;
	at org.apache.tika.fork.ForkServer.main(ForkServer.java:69)&lt;br/&gt;
Caused by: java.lang.ClassNotFoundException: Unable to find class org.apache.tika.parser.external.ExternalParser&lt;br/&gt;
	at org.apache.tika.fork.ClassLoaderProxy.findClass(ClassLoaderProxy.java:117)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:323)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(ClassLoader.java:268)&lt;br/&gt;
	... 13 more&lt;/p&gt;

&lt;p&gt;ExternalParser lives in the Tika Core jar, not the Tika Parsers one. This all works fine outside of OSGi, so it looks like something about the OSGi bundling is causing the fork parser to fail to send the parser-related classes from Tika Core over to the forked JVM&lt;/p&gt;</description>
                <environment></environment>
        <key id="12765391">TIKA-1507</key>
            <summary>Under OSGi, ForkParser failes to send core parser classes like ExternalParser</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gagravarr">Nick Burch</reporter>
                        <labels>
                    </labels>
                <created>Wed, 7 Jan 2015 15:26:07 +0000</created>
                <updated>Sat, 18 Apr 2015 15:43:49 +0100</updated>
                                            <version>1.6</version>
                    <version>1.7</version>
                                                    <component>packaging</component>
                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="14267754" author="gagravarr" created="Wed, 7 Jan 2015 15:32:20 +0000"  >&lt;p&gt;To reproduce this, remove the try/catch NoClassDefFoundError in TesseractOCRParser.hasTesseract&lt;/p&gt;</comment>
                            <comment id="14267774" author="hudson" created="Wed, 7 Jan 2015 15:43:25 +0000"  >&lt;p&gt;UNSTABLE: Integrated in tika-trunk-jdk1.7 #414 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/414/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/414/&lt;/a&gt;)&lt;br/&gt;
Temporary workaround for the &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1507&quot; title=&quot;Under OSGi, ForkParser failes to send core parser classes like ExternalParser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1507&quot;&gt;TIKA-1507&lt;/a&gt; ForkParser / OGI issue (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1650083&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1650083&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14267797" author="hudson" created="Wed, 7 Jan 2015 16:01:23 +0000"  >&lt;p&gt;UNSTABLE: Integrated in tika-trunk-jdk1.6 #398 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/398/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/398/&lt;/a&gt;)&lt;br/&gt;
Temporary workaround for the &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1507&quot; title=&quot;Under OSGi, ForkParser failes to send core parser classes like ExternalParser&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1507&quot;&gt;TIKA-1507&lt;/a&gt; ForkParser / OGI issue (nick: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1650083&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1650083&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/tika-parsers/src/main/java/org/apache/tika/parser/ocr/TesseractOCRParser.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14498923" author="bobpaulin" created="Thu, 16 Apr 2015 23:54:11 +0100"  >&lt;p&gt;Issue appear to be related to the pom.xml.  &lt;br/&gt;
The external parser&apos;s package is negated.  Which will prevent it from being exported out of the bundle.  The org.apache.tika.parser package is also negated but it appears to be added back due to the last line.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
             &amp;lt;Export-Package&amp;gt;
              !org.apache.tika.parser,
              !org.apache.tika.parser.external,
              org.apache.tika.parser.*
            &amp;lt;/Export-Package&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I would recommend removing the negations as below.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &amp;lt;Export-Package&amp;gt;
              org.apache.tika.parser.*
            &amp;lt;/Export-Package&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14499080" author="bobpaulin" created="Fri, 17 Apr 2015 02:05:22 +0100"  >&lt;p&gt;Attached a patch for this change.&lt;/p&gt;</comment>
                            <comment id="14501351" author="tallison@mitre.org" created="Sat, 18 Apr 2015 14:12:55 +0100"  >&lt;p&gt;Thank you, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bobpaulin&quot; class=&quot;user-hover&quot; rel=&quot;bobpaulin&quot;&gt;Bob Paulin&lt;/a&gt;! Those negations were added as a refactoring in r1196041 by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jukkaz&quot; class=&quot;user-hover&quot; rel=&quot;jukkaz&quot;&gt;Jukka Zitting&lt;/a&gt;. Does anyone remember the reason? Can we even expect external parsers to work within OSGi?&lt;/p&gt;</comment>
                            <comment id="14501394" author="bobpaulin" created="Sat, 18 Apr 2015 15:43:49 +0100"  >&lt;p&gt;For what it&apos;s worth it appears the ExternalParser is simply to run commands outside the JVM (ie as in a CLI).  I can&apos;t think of any OSGi restrictions on this type of activity.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12726034" name="TIKA-1507.patch" size="536" author="bobpaulin" created="Fri, 17 Apr 2015 02:05:22 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 7 Jan 2015 15:43:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzxwwn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>