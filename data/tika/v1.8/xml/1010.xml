<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:28:35 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1010/TIKA-1010.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1010] Embedded documents in RTF are not extracted</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1010</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;When an RTF doc embeds a doc it looks like this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{\object\objemb
\objw628\objh765{\*\objclass Package}{\*\objdata 0105000002000000080000005061636b61676500000000000000000066000000
020048772e74787400433a5c444f43554d457e315c6967616c73685c4465736b746f705c48572e747874000000030022000000433a5c444f43554d457e315c6967616c73685c4465736b746f705c48572e747874000b00000048656c6c6f20576f726c64000001050000050000000d0000004d45544146494c455049435400
54040000bbfaffffee0000000800540445050000
0100090000037300000002001c0000000000050000000b0200000000050000000c02320029001c000000fb02f5ff000000000000900100000001000000005461686f6d61000055170a7000fc070058b1f37761b1f3772040f57749366683040000002d01000005000000090200000000050000000102ffffff0005000000
020101000000050000002e0106000000090000002105060048772e747874210015001c000000fb021000070000000000bc02000000000102022253797374656d00004936668300000a0026008a0100000000ffffffff8cfc0700040000002d010100030000000000}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But, unfortunately, the format of those hex bytes is not spelled out&lt;br/&gt;
in the RTF spec ... the spec merely says the bytes are saved by the&lt;br/&gt;
OLESaveToStream function ... and I haven&apos;t been able to find a&lt;br/&gt;
description of what the bytes mean.&lt;/p&gt;

&lt;p&gt;In this case they are a &quot;Package object&quot; (\objclass Package), which I&lt;br/&gt;
think is an &lt;span class=&quot;error&quot;&gt;&amp;#91;old?&amp;#93;&lt;/span&gt; way to wrap any non-OLE file (this is just a .txt&lt;br/&gt;
file).&lt;/p&gt;

&lt;p&gt;Here&apos;s the hex dump:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;00000000  01 05 00 00 02 00 00 00  08 00 00 00 50 61 63 6b  |............Pack|
00000010  61 67 65 00 00 00 00 00  00 00 00 00 66 00 00 00  |age.........f...|
00000020  02 00 48 77 2e 74 78 74  00 43 3a 5c 44 4f 43 55  |..Hw.txt.C:\DOCU|
00000030  4d 45 7e 31 5c 69 67 61  6c 73 68 5c 44 65 73 6b  |ME~1\igalsh\Desk|
00000040  74 6f 70 5c 48 57 2e 74  78 74 00 00 00 03 00 22  |top\HW.txt.....&quot;|
00000050  00 00 00 43 3a 5c 44 4f  43 55 4d 45 7e 31 5c 69  |...C:\DOCUME~1\i|
00000060  67 61 6c 73 68 5c 44 65  73 6b 74 6f 70 5c 48 57  |galsh\Desktop\HW|
00000070  2e 74 78 74 00 0b 00 00  00 48 65 6c 6c 6f 20 57  |.txt.....Hello W|
00000080  6f 72 6c 64 00 00 01 05  00 00 05 00 00 00 0d 00  |orld............|
00000090  00 00 4d 45 54 41 46 49  4c 45 50 49 43 54 00 54  |..METAFILEPICT.T|
000000a0  04 00 00 bb fa ff ff ee  00 00 00 08 00 54 04 45  |.............T.E|
000000b0  05 00 00 01 00 09 00 00  03 73 00 00 00 02 00 1c  |.........s......|
000000c0  00 00 00 00 00 05 00 00  00 0b 02 00 00 00 00 05  |................|
000000d0  00 00 00 0c 02 32 00 29  00 1c 00 00 00 fb 02 f5  |.....2.)........|
000000e0  ff 00 00 00 00 00 00 90  01 00 00 00 01 00 00 00  |................|
000000f0  00 54 61 68 6f 6d 61 00  00 55 17 0a 70 00 fc 07  |.Tahoma..U..p...|
00000100  00 58 b1 f3 77 61 b1 f3  77 20 40 f5 77 49 36 66  |.X..wa..w @.wI6f|
00000110  83 04 00 00 00 2d 01 00  00 05 00 00 00 09 02 00  |.....-..........|
00000120  00 00 00 05 00 00 00 01  02 ff ff ff 00 05 00 00  |................|
00000130  00 02 01 01 00 00 00 05  00 00 00 2e 01 06 00 00  |................|
00000140  00 09 00 00 00 21 05 06  00 48 77 2e 74 78 74 21  |.....!...Hw.txt!|
00000150  00 15 00 1c 00 00 00 fb  02 10 00 07 00 00 00 00  |................|
00000160  00 bc 02 00 00 00 00 01  02 02 22 53 79 73 74 65  |..........&quot;Syste|
00000170  6d 00 00 49 36 66 83 00  00 0a 00 26 00 8a 01 00  |m..I6f.....&amp;amp;....|
00000180  00 00 00 ff ff ff ff 8c  fc 07 00 04 00 00 00 2d  |...............-|
00000190  01 01 00 03 00 00 00 00  00                       |.........|
00000199
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Anyway I have no idea how to decode the bytes at this point ... just&lt;br/&gt;
opening the issue in case anyone else does!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12612676">TIKA-1010</key>
            <summary>Embedded documents in RTF are not extracted</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tallison@mitre.org">Tim Allison</assignee>
                                    <reporter username="mikemccand">Michael McCandless</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Oct 2012 14:36:43 +0100</created>
                <updated>Fri, 30 May 2014 20:47:24 +0100</updated>
                            <resolved>Wed, 16 Apr 2014 19:24:12 +0100</resolved>
                                                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13943404" author="tallison@mitre.org" created="Fri, 21 Mar 2014 19:05:47 +0000"  >&lt;p&gt;This might be of use: &lt;a href=&quot;http://palashray.com/2006/10/25/embedding-an-image-in-rtf-with-java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://palashray.com/2006/10/25/embedding-an-image-in-rtf-with-java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Even better:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://stackoverflow.com/questions/14779647/extract-embedded-image-object-in-rtf&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://stackoverflow.com/questions/14779647/extract-embedded-image-object-in-rtf&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="13943408" author="tallison@mitre.org" created="Fri, 21 Mar 2014 19:09:00 +0000"  >&lt;p&gt;simple test file attached&lt;/p&gt;</comment>
                            <comment id="13943423" author="tallison@mitre.org" created="Fri, 21 Mar 2014 19:19:02 +0000"  >&lt;p&gt;There are quite a few magic 50 4B  (PK) in the hexdump.  There are two 5b436f6e74656e74 ([Content) in the embedded file, and there are two in the objdata and two in themedata.  Might be a start.&lt;/p&gt;</comment>
                            <comment id="13947772" author="cbamford" created="Wed, 26 Mar 2014 10:24:52 +0000"  >&lt;p&gt;Attached 3 sample RTF files, all containing pictures and objects.&lt;/p&gt;</comment>
                            <comment id="13950461" author="bammers" created="Fri, 28 Mar 2014 07:38:15 +0000"  >&lt;p&gt;Hi Tim&lt;/p&gt;

&lt;p&gt;I think at least one of my test files uses a Package to wrap the object, so should be useful.&lt;br/&gt;
I also am continuing to search for one containing a \pict with binary encoding.&lt;br/&gt;
Cheers&lt;/p&gt;

&lt;p&gt;Chris&lt;/p&gt;





</comment>
                            <comment id="13950628" author="tallison@mitre.org" created="Fri, 28 Mar 2014 12:25:13 +0000"  >&lt;p&gt;Chris,&lt;br/&gt;
  Thank you for digging into the spec and sharing test files.  For some reason, I can&apos;t find the gifs that JIRA reported you attaching earlier today.  Y, I&apos;m in search of a binary test file.  Please share one if you can find it.  I think I&apos;m good on package files.  I&apos;ll attach my two main test files shortly.  I&apos;ve tested on the files within the zip that you submitted earlier, and all is good.&lt;/p&gt;</comment>
                            <comment id="13950630" author="tallison@mitre.org" created="Fri, 28 Mar 2014 12:28:15 +0000"  >&lt;p&gt;This is an example of regular images &amp;#8211; pict &amp;#8211; not embedded data.&lt;/p&gt;</comment>
                            <comment id="13950636" author="tallison@mitre.org" created="Fri, 28 Mar 2014 12:35:07 +0000"  >&lt;p&gt;This is the test file I&apos;ll use to test poifs package and embedded object formatted data.&lt;/p&gt;</comment>
                            <comment id="13950714" author="bammers" created="Fri, 28 Mar 2014 13:45:48 +0000"  >&lt;p&gt;Hi Tim&lt;/p&gt;

&lt;p&gt;Sorry about the confusion with the GIFs - they were nothing to do with the case!  Thy were part of my email footer which Jira automatically attached to the ticket when I replied by email!&lt;br/&gt;
So I removed them.&lt;/p&gt;

&lt;p&gt;Sounds like you&apos;re making great progress.  I will provide a binary pict file as soon as I can locate one.&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Chris&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13950835" author="bammers" created="Fri, 28 Mar 2014 15:03:11 +0000"  >&lt;p&gt;Hi Tim&lt;/p&gt;

&lt;p&gt;I have found one - please see &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-782&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/TIKA-782&lt;/a&gt; (logo.rtf inside logo.zip).&lt;/p&gt;

&lt;p&gt;Best,&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Chris&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13951004" author="tallison@mitre.org" created="Fri, 28 Mar 2014 16:42:49 +0000"  >&lt;p&gt;Chris,&lt;br/&gt;
  Thanks for pointing that out.  The objdata in logo.rtf is of type pbrush (bitmap) but it is encoded in the regular hexpairs.  I just added handling for that. &lt;br/&gt;
  The thumbnail/result/metafile is binary, but I&apos;ve chosen not to extract thumbnails/emf or other meta-embeddings.&lt;br/&gt;
  This ok?&lt;/p&gt;
</comment>
                            <comment id="13951009" author="bammers" created="Fri, 28 Mar 2014 16:47:03 +0000"  >&lt;p&gt;Hi again Tim&lt;/p&gt;

&lt;p&gt;Dunno if this helps, but there is a generic RTF parser kit on GitHub (&lt;a href=&quot;https://github.com/joniles/rtfparserkit&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/joniles/rtfparserkit&lt;/a&gt;) which knows how to navigate RTFs.&lt;br/&gt;
I&apos;m playing with it now - it doesn&apos;t do much except parse but it might provide some insight?&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Chris&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13951092" author="bammers" created="Fri, 28 Mar 2014 17:28:52 +0000"  >&lt;p&gt;Ideally I&apos;d like to be able to extract any file, but let&apos;s get the main cases covered off first!&lt;/p&gt;</comment>
                            <comment id="13951097" author="bammers" created="Fri, 28 Mar 2014 17:32:29 +0000"  >&lt;p&gt;The binary actually looks like this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;{pict ....{objdata \bin270141 .....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The 270,141 after \bin is the number of bytes to read (size of blob).  Note that the blob can (and does in this case!) contain &apos;}&apos; which is not the group end marker but actual &apos;binary&apos; data.&lt;/p&gt;</comment>
                            <comment id="13951107" author="tallison@mitre.org" created="Fri, 28 Mar 2014 17:39:01 +0000"  >&lt;p&gt;Y, thanks, I got that.  I can add an &quot;extract all&quot; mode vs &quot;extract logical&quot;.  I&apos;ll set the default to &quot;extract logical&quot; unless there are objections from the community.&lt;/p&gt;

&lt;p&gt;I now have success against the two files I posted earlier today.&lt;/p&gt;

&lt;p&gt;When I add the &quot;extract all vs logical&quot; parameter, I can use Mike&apos;s testBinControlWord (from &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-782&quot; title=&quot;Add support for parsing binary data in RTF files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-782&quot;&gt;&lt;del&gt;TIKA-782&lt;/del&gt;&lt;/a&gt;) as a test.&lt;/p&gt;</comment>
                            <comment id="13951116" author="tallison@mitre.org" created="Fri, 28 Mar 2014 17:43:57 +0000"  >&lt;p&gt;As a side note, I can grab file names for:&lt;br/&gt;
 1) images that are regular images (not embedded objdata)&lt;br/&gt;
 2) non-POIFS embedded files (html, embedded objdata images, zip, msg)&lt;/p&gt;

&lt;p&gt;I can&apos;t find file names for:&lt;br/&gt;
xls, xlsx, doc, docx, ppt, pptx, pdf&lt;/p&gt;</comment>
                            <comment id="13954819" author="bammers" created="Sun, 30 Mar 2014 20:47:31 +0100"  >&lt;p&gt;Hi Tim&lt;/p&gt;

&lt;p&gt;Are you saying you would like to test against RTFs with embedded xls, xlsx, doc, docx, ppt, pptx, pdf files?&lt;br/&gt;
If so I would be happy to create them ...&lt;/p&gt;

&lt;p&gt;Let me know&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Chris&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13955048" author="bammers" created="Mon, 31 Mar 2014 10:24:18 +0100"  >&lt;p&gt;Hi Tim&lt;/p&gt;

&lt;p&gt;I have created an RTF with 5 embedded office docs in but it is too large to attach to the ticket (&amp;gt;10mb).&lt;br/&gt;
If you&apos;re interested we&apos;ll have to find some other way to get it to you ...&lt;/p&gt;

&lt;p&gt;Chris&lt;/p&gt;</comment>
                            <comment id="13955104" author="tallison@mitre.org" created="Mon, 31 Mar 2014 12:21:56 +0100"  >&lt;p&gt;Thank you, Chris.  The test doc that I posted late last week has examples of embedded (doc|ppt|xls)x? (testRTF_embbededFiles.zip).  The issue is that with those files (and pdfs), I don&apos;t think that the name of the file is stored in any metadata in the file (nor in the POIFS embobj itself).  I just wanted to send a heads up about this apparent limitation in RTF...there are two other places that I still need to check to confirm this...one is the {\result {\shppict}} that immediately follows the embobj (this is the thumbnail pict), and the other is in the \nonshppict that can also follow an embobj.  It is entirely possible that the info is stored in POIFS or elsewhere, and I&apos;m just not seeing it.&lt;/p&gt;

&lt;p&gt;I did add processing to pull the name of the file from: 1) the embobj header if it exists (which it seems to for files not including MS/PDF) and 2) from the pict&apos;s metadata {sp &lt;/p&gt;
{sn}
&lt;p&gt;{sv}}.&lt;/p&gt;

&lt;p&gt;I think I&apos;ve changed my mind on handling thumbnails separately.  My current plan is to extract all embedded data.  I&apos;ll add info to the Metadata obj about whether the file is an embobj, or a thumbnail {\result {\shppict }} or {\result {\nonshppict}}. The client code can then decide what to do with the embedded data.&lt;/p&gt;

&lt;p&gt;I&apos;ll add binary processing (thank you for your pointer to &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-782&quot; title=&quot;Add support for parsing binary data in RTF files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-782&quot;&gt;&lt;del&gt;TIKA-782&lt;/del&gt;&lt;/a&gt;!), and post a draft of the patch late this afternoon or tomorrow.&lt;/p&gt;</comment>
                            <comment id="13956274" author="bammers" created="Tue, 1 Apr 2014 10:04:16 +0100"  >&lt;p&gt;Tim&lt;br/&gt;
A quick question - where do the extracted files get written?  Can it be specified?&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Chris&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13956928" author="tallison@mitre.org" created="Tue, 1 Apr 2014 20:22:21 +0100"  >&lt;p&gt;Absolutely, this is more of a question for the tika-users list.  One option is to implement EmbeddedResourceHandler and then call it with something like this (take care to do better error handling!):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;        TrackingHandler tracker = new TrackingHandler();
        TikaInputStream tis = null;
        try {
            ContainerExtractor ex = new ParserContainerExtractor();
            tis = TikaInputStream.get(inputstream);
            ex.extract(tis, ex, tracker);
        } finally {
            tis.close();
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For a simple TrackingHandler, see AbstractPOIContainerExtractionTest in org.apache.tika.parser.microsoft (test/.../parsers).&lt;/p&gt;

&lt;p&gt;Been delayed on other projects.  Wrapping up today, and will post rough patch tomorrow.&lt;/p&gt;</comment>
                            <comment id="13959546" author="tallison@mitre.org" created="Fri, 4 Apr 2014 02:51:10 +0100"  >&lt;p&gt;First draft of a patch.  Still need to clean up some of the test infrastructure.  Any and all feedback welcome.  Thank you!&lt;/p&gt;</comment>
                            <comment id="13959978" author="bammers" created="Fri, 4 Apr 2014 14:58:20 +0100"  >&lt;p&gt;Hi Tim&lt;/p&gt;

&lt;p&gt;Am about to play with the patch - which version of Tika does it apply to?  Presumably I download that and then apply the patch?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Chris&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13959988" author="tallison@mitre.org" created="Fri, 4 Apr 2014 15:16:53 +0100"  >&lt;p&gt;trunk&lt;/p&gt;

&lt;p&gt;svn co &lt;a href=&quot;http://svn.apache.org/repos/asf/tika/trunk&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/tika/trunk&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13961765" author="tallison@mitre.org" created="Mon, 7 Apr 2014 11:17:28 +0100"  >&lt;p&gt;Doh!  With metadata class added...&lt;/p&gt;</comment>
                            <comment id="13961821" author="bammers" created="Mon, 7 Apr 2014 13:50:41 +0100"  >&lt;p&gt;Thanks Tim, all compiles now.  &lt;br/&gt;
I think at least one test file is missing though (for RTFParserTest):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/test-documents/testRTFEmbeddedFiles.rtf
/test-documents/testRTFEmbeddedLink.rtf
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I tried the &quot;testRTF_embbededFiles.rtf&quot; found in &quot;testRTF_embbededFiles.zip&quot; attached to this ticket as the former and that seems to work fine.  However, I cannot find anything suitable for the latter.&lt;br/&gt;
Please can you provide when you get a mo&apos;?&lt;/p&gt;

&lt;p&gt;I&apos;m digging into the code now to see how it works  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13962059" author="tallison@mitre.org" created="Mon, 7 Apr 2014 18:49:55 +0100"  >&lt;p&gt;Hmmm... Sorry, I should have been clearer... In the last patch update, I only included the code patch.  To get the test files go back to the zip file from April 3, and there should be three test files:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;testRTFEmbeddedFiles.rtf
testRTFEmbeddedLink.rtf
testRTFRegularImages.rtf
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As a triple check, I applied the patch from 4/7 to a fresh check out from trunk, and I put those three files in test-documents.  I had a build success (with embarrassing println left in RTFObjDataParser...the horror!...did I mention clean up and a few optimizations remain?).&lt;/p&gt;
</comment>
                            <comment id="13963179" author="tallison@mitre.org" created="Tue, 8 Apr 2014 18:05:30 +0100"  >&lt;p&gt;Many thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cbamford&quot; class=&quot;user-hover&quot; rel=&quot;cbamford&quot;&gt;Chris Bamford&lt;/a&gt; for pointing out this issue...When an xls file is attached to an RTF file and then extracted, the XLS workbook is made &quot;hidden&quot; and the size of the workbook can be much, much larger, especially if there is an embedded image.  The same thing happens when the RTF file is saved as a DOCX, and then the xls file is extracted via the zip interface.&lt;/p&gt;

&lt;p&gt;I&apos;m attaching a zip of an original xls file and the resulting xls file after it was embedded and then extracted from an RTF.&lt;/p&gt;

&lt;p&gt;For this issue, I propose ignoring this difference.  If we want to add extra processing for &quot;unhiding&quot; workbooks, let&apos;s do that later in a separate issue.  Any strong objections?&lt;/p&gt;</comment>
                            <comment id="13965283" author="lfcnassif" created="Thu, 10 Apr 2014 13:12:02 +0100"  >&lt;p&gt;If you extract the embedded xls file from the same rtf again, the extracted xls files will have the same md5 hash? From a forensic application perspective, it is desirable, at least. I have seen apps that extract a different file each time the embedded ole is extracted.&lt;/p&gt;</comment>
                            <comment id="13965289" author="tallison@mitre.org" created="Thu, 10 Apr 2014 13:26:26 +0100"  >&lt;p&gt;Interesting...  Y, my untested belief is that with the current code you will always extract the same (MD5 match) xls file from a given RTF.  However, the extracted file may be quite different from the file that was originally embedded into the RTF.  &lt;/p&gt;

&lt;p&gt;I think Chris found that there are also differences with other MSOffice formats between the file before being embedded and after being extracted from the RTF.&lt;/p&gt;</comment>
                            <comment id="13967649" author="echnaton42" created="Sat, 12 Apr 2014 22:16:07 +0100"  >&lt;p&gt;The RTF objdata destination contains the object data in OLE1 format.&lt;br/&gt;
The format is described in the document&lt;br/&gt;
&quot;MS-OLEDS: Object Linking and Embedding (OLE) Data Structures: Structure Specification&quot;&lt;br/&gt;
&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/dd942265.aspx&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://msdn.microsoft.com/en-us/library/dd942265.aspx&lt;/a&gt;.&lt;br/&gt;
The data starts with an ObjectHeader structure.&lt;br/&gt;
See Chapter 2.2.4 &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/dd942076.aspx&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://msdn.microsoft.com/en-us/library/dd942076.aspx&lt;/a&gt;&lt;br/&gt;
and the following, depending on the FormatID value.&lt;/p&gt;</comment>
                            <comment id="13970597" author="bammers" created="Wed, 16 Apr 2014 10:12:58 +0100"  >&lt;p&gt;Tim&lt;/p&gt;

&lt;p&gt;I have done a lot of testing now and am very happy with the new functionality.&lt;br/&gt;
Assuming others have no objections, when could it be made available in a Maven release?&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Chris&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13971622" author="tallison@mitre.org" created="Wed, 16 Apr 2014 17:33:53 +0100"  >&lt;p&gt;Great to hear.  Thank you for your help in submitting test documents and offering feedback!   I&apos;ll commit a slightly updated patch tonight or tomorrow.  I&apos;d recommend asking on the tika-users list about plans for 1.6 or if there is a nightly build option through Maven.  I know that the &quot;nightly&quot; jenkins build has not been working so well.&lt;/p&gt;</comment>
                            <comment id="13971774" author="tallison@mitre.org" created="Wed, 16 Apr 2014 19:24:12 +0100"  >&lt;p&gt;r1588005&lt;/p&gt;

&lt;p&gt;Many thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cbamford&quot; class=&quot;user-hover&quot; rel=&quot;cbamford&quot;&gt;Chris Bamford&lt;/a&gt; for testing and submitting test documents!&lt;/p&gt;

&lt;p&gt;Many thanks to Simon Mourier for: &lt;a href=&quot;http://stackoverflow.com/questions/14779647/extract-embedded-image-object-in-rtf&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://stackoverflow.com/questions/14779647/extract-embedded-image-object-in-rtf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Chris, let me know if there are any surprises in the few mods I made since I published the first draft of the patch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12545890">TIKA-872</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12636898" name="ExampleRTFs.zip" size="213512" author="cbamford" created="Wed, 26 Mar 2014 10:24:52 +0000"/>
                            <attachment id="12638958" name="TIKA-1010.patch" size="50147" author="tallison@mitre.org" created="Mon, 7 Apr 2014 11:17:28 +0100"/>
                            <attachment id="12638611" name="TIKA-1010_patch.zip" size="337040" author="tallison@mitre.org" created="Fri, 4 Apr 2014 02:51:10 +0100"/>
                            <attachment id="12636084" name="outer.rtf" size="99052" author="tallison@mitre.org" created="Fri, 21 Mar 2014 19:09:00 +0000"/>
                            <attachment id="12637383" name="testRTFRegularImages.rtf" size="97582" author="tallison@mitre.org" created="Fri, 28 Mar 2014 12:28:15 +0000"/>
                            <attachment id="12637386" name="testRTF_embbededFiles.zip" size="250863" author="tallison@mitre.org" created="Fri, 28 Mar 2014 12:35:07 +0000"/>
                            <attachment id="12639223" name="xls_attachment_example.zip" size="23941" author="tallison@mitre.org" created="Tue, 8 Apr 2014 18:05:30 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 21 Mar 2014 19:05:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249925</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy4hr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>60032</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>