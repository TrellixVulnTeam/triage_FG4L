<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:27:58 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1497/TIKA-1497.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1497] tika-server cannot output JSON</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1497</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I would like the response from &lt;br/&gt;
curl -X PUT -T /path/to/file.pdf &lt;a href=&quot;http://localhost:9998/meta&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:9998/meta&lt;/a&gt;&lt;br/&gt;
to be JSON and not CSV?.&lt;/p&gt;

&lt;p&gt;I&apos;ve discovered JSONMessageBodyWriter.java (&lt;a href=&quot;https://github.com/apache/tika/blob/af19f3ea04792cad81b428f1df9f5ebbb2501913/tika-server/src/main/java/org/apache/tika/server/JSONMessageBodyWriter.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/tika/blob/af19f3ea04792cad81b428f1df9f5ebbb2501913/tika-server/src/main/java/org/apache/tika/server/JSONMessageBodyWriter.java&lt;/a&gt;) so I think the functionality is present, tried adding --header &quot;Accept: application/json&quot; to the cURL call, in line with the documentation for outputting CSV, but no luck so far.&lt;/p&gt;

&lt;p&gt;According to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;Sergey Beryozkin&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&quot;I see MetadataResource returning StreamingOutput and it has @Produces(text/csv) only. As such this MBW has no effect at the moment.&lt;/p&gt;

&lt;p&gt;We can update MetadataResource to return Metadata directly if application/json is requested or update MetadataResource to directly convert Metadata to JSON in case of JSON being accepted.&quot;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12762592">TIKA-1497</key>
            <summary>tika-server cannot output JSON</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="PeterBowyer">Peter Bowyer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Dec 2014 14:49:37 +0000</created>
                <updated>Fri, 19 Dec 2014 14:16:47 +0000</updated>
                            <resolved>Fri, 19 Dec 2014 03:15:29 +0000</resolved>
                                                                    <component>server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14251903" author="tallison@mitre.org" created="Thu, 18 Dec 2014 17:09:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;Sergey Beryozkin&lt;/a&gt;, how does this look? &lt;/p&gt;

&lt;p&gt;Would we be able to factor out the custom CSV code (by relying on the CSVMessageBodyWriter)  if we changed the return type from StreamingOutput to Response?&lt;/p&gt;</comment>
                            <comment id="14251920" author="sergey_beryozkin" created="Thu, 18 Dec 2014 17:26:50 +0000"  >&lt;p&gt;Hi Tim&lt;/p&gt;

&lt;p&gt;We can probably have&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Produces({&lt;span class=&quot;code-quote&quot;&gt;&quot;text/csv&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;application/json&quot;&lt;/span&gt;})
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;for both PUT methods and have JSONMessageBodyWriter also have the same Produces and renamed to MetadataMessageBodyWriter and in its writeTo  check if the passed media type is text/csv or json and convert accordingly. Or a dedicated CSV provider can be added as you suggest. Indeed, returning Metadata directly (wrapped in Response is Ok too) works well with custom MBWs&lt;br/&gt;
thanks, Sergey  &lt;/p&gt;</comment>
                            <comment id="14251937" author="tallison@mitre.org" created="Thu, 18 Dec 2014 17:46:15 +0000"  >&lt;p&gt;Like so?&lt;/p&gt;

&lt;p&gt;Actually, better to go with returning Metadata directly, I think.  That way someone could substitute a different MBW.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;@PUT
  @Produces({&quot;text/csv&quot;, &quot;application/json&quot;})
  public Metadata getMetadata(InputStream is, @Context HttpHeaders httpHeaders, @Context UriInfo info) throws Exception {
    return parseMetadata(is, httpHeaders.getRequestHeaders(), info);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14251952" author="sergey_beryozkin" created="Thu, 18 Dec 2014 17:56:06 +0000"  >&lt;p&gt;Hi, yes, looks nice, though returning Response is marginally more flexible in cases where extra custom headers need to be set (as opposed to doing it from ContainerResponseFilter), it has no difference for the runtime whether Metadata is returned as Response entity or directly; the only minor issue and this a CXF specific only is that it does not play well with client proxy API, which is not used with Tika tests...&lt;/p&gt;

&lt;p&gt;Cheers, Sergey &lt;/p&gt;</comment>
                            <comment id="14251957" author="tallison@mitre.org" created="Thu, 18 Dec 2014 17:57:51 +0000"  >&lt;p&gt;Ah, ok, so better to wrap it as we do with MetadataEP?&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;return Response.ok(metadata).build();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14252239" author="sergey_beryozkin" created="Thu, 18 Dec 2014 20:59:14 +0000"  >&lt;p&gt;Hi Tim, sorry for a delay, if you are also fine with it then yes, it would be a bit more flexible (we won&apos;t need to update method signatures in the furture if the custom headers like etags, etc will need to be added).&lt;/p&gt;

&lt;p&gt;MetadataEP, should it be merged into MetadataResource as Chris suggested or you;d prefer to wait till 2.0 ?&lt;/p&gt;

&lt;p&gt;Cheers, Sergey&lt;/p&gt;</comment>
                            <comment id="14252443" author="tledouxfr@yahoo.fr" created="Thu, 18 Dec 2014 22:41:29 +0000"  >&lt;p&gt;Any chance we get XMP by asking for application/rdf+xml responses.&lt;br/&gt;
I know it is one more case to track but it would really be a nice feature. &lt;/p&gt;

&lt;p&gt;Thanks, Thomas.&lt;/p&gt;</comment>
                            <comment id="14252847" author="tallison@mitre.org" created="Fri, 19 Dec 2014 03:15:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;Sergey Beryozkin&lt;/a&gt;, no problem at all!  Thank you.  Changes made...I think.  If you have a chance, please double check to make sure I didn&apos;t botch anything.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tledoux&quot; class=&quot;user-hover&quot; rel=&quot;tledoux&quot;&gt;Thomas Ledoux&lt;/a&gt;, done.&lt;/p&gt;</comment>
                            <comment id="14252848" author="tallison@mitre.org" created="Fri, 19 Dec 2014 03:15:29 +0000"  >&lt;p&gt;r 1646617&lt;/p&gt;</comment>
                            <comment id="14252866" author="hudson" created="Fri, 19 Dec 2014 03:40:58 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.7 #370 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.7/370/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.7/370/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1497&quot; title=&quot;tika-server cannot output JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1497&quot;&gt;&lt;del&gt;TIKA-1497&lt;/del&gt;&lt;/a&gt;: update changes.txt (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646617&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646617&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/CHANGES.txt&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1497&quot; title=&quot;tika-server cannot output JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1497&quot;&gt;&lt;del&gt;TIKA-1497&lt;/del&gt;&lt;/a&gt;: add JSON and XMP output to tika-server&apos;s /meta (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646616&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646616&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/pom.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/MetadataResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/RecursiveMetadataResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/TikaServerCli.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/UnpackerResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/XMPMessageBodyWriter.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/test/java/org/apache/tika/server/MetadataResourceTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14252888" author="hudson" created="Fri, 19 Dec 2014 03:59:42 +0000"  >&lt;p&gt;SUCCESS: Integrated in tika-trunk-jdk1.6 #354 (See &lt;a href=&quot;https://builds.apache.org/job/tika-trunk-jdk1.6/354/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/tika-trunk-jdk1.6/354/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1497&quot; title=&quot;tika-server cannot output JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1497&quot;&gt;&lt;del&gt;TIKA-1497&lt;/del&gt;&lt;/a&gt;: update changes.txt (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646617&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646617&lt;/a&gt;)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/tika/trunk/CHANGES.txt&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1497&quot; title=&quot;tika-server cannot output JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1497&quot;&gt;&lt;del&gt;TIKA-1497&lt;/del&gt;&lt;/a&gt;: add JSON and XMP output to tika-server&apos;s /meta (tallison: &lt;a href=&quot;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646616&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/tika/trunk/?view=rev&amp;amp;rev=1646616&lt;/a&gt;)&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/pom.xml&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/MetadataResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/RecursiveMetadataResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/TikaServerCli.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/UnpackerResource.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/main/java/org/apache/tika/server/XMPMessageBodyWriter.java&lt;/li&gt;
	&lt;li&gt;/tika/trunk/tika-server/src/test/java/org/apache/tika/server/MetadataResourceTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14253109" author="tledouxfr@yahoo.fr" created="Fri, 19 Dec 2014 07:48:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tallison%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;tallison@apache.org&quot;&gt;Tim Allison&lt;/a&gt;, that was fast and efficient. Very much appreciated. Thanks&lt;/p&gt;</comment>
                            <comment id="14253204" author="peterbowyer" created="Fri, 19 Dec 2014 10:07:08 +0000"  >&lt;p&gt;Wow, you guys rock! Thank you, will test shortly and report if any issues.&lt;/p&gt;</comment>
                            <comment id="14253240" author="sergey_beryozkin" created="Fri, 19 Dec 2014 10:41:19 +0000"  >&lt;p&gt;Hi Tim, &lt;br/&gt;
Thanks for a fix, IMHO the latest metadata resource code authored by you is absolutely perfect &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

</comment>
                            <comment id="14253414" author="tallison@mitre.org" created="Fri, 19 Dec 2014 14:02:04 +0000"  >&lt;p&gt;That&apos;s only because I relied entirely on our JAX-RS Jedi, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;Sergey Beryozkin&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Speaking of MetadataEP...  Let me know if I&apos;m wrong, but given that we never actually integrated it into tika-server cli, I don&apos;t think that we&apos;ll be breaking any backcompat if we fold its capabilities into MetadataResource.  I propose doing that now via &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-1499&quot; title=&quot;Let&amp;#39;s fold MetadataEP&amp;#39;s capabilities into MetadataResource in tika-server&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-1499&quot;&gt;&lt;del&gt;TIKA-1499&lt;/del&gt;&lt;/a&gt; unless there are objections.&lt;/p&gt;

&lt;p&gt;Again, many thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sergey_beryozkin&quot; class=&quot;user-hover&quot; rel=&quot;sergey_beryozkin&quot;&gt;Sergey Beryozkin&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="14253426" author="sergey_beryozkin" created="Fri, 19 Dec 2014 14:16:47 +0000"  >&lt;p&gt;Hi Tim, we are all JAX-RS experts here, JAX-RS is the easiest part &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
+1  to merging MetadataEp into MetadataResource&lt;br/&gt;
Thanks, Sergey&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12688067" name="TIKA-1497.patch" size="5242" author="tallison@mitre.org" created="Thu, 18 Dec 2014 17:09:28 +0000"/>
                            <attachment id="12688071" name="TIKA-1497v2.patch" size="8927" author="tallison@mitre.org" created="Thu, 18 Dec 2014 17:46:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 18 Dec 2014 17:09:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzxgcf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>