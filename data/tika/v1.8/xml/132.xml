<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:30:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-132/TIKA-132.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-132] Refactor Excel extractor to parse per sheet and add hyperlink support</title>
                <link>https://issues.apache.org/jira/browse/TIKA-132</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;In the excel record stream, hyperlink records come at the end of the sheet, after the cell value records. This is a problem for the current streaming implementation of the excel parser since it means the hyperlink cannot be output when a cell is being processed.&lt;/p&gt;

&lt;p&gt;Jukka suggested the following on the mailing list:&lt;/p&gt;

&lt;p&gt;&quot;How about if the streaming Excel parser maintained a sparse in-memory table of the contents of the sheet that is currently being parsed and would only generate the respective SAX events once the sheet has been parsed? Since we can focus on only the information that&apos;s relevant to Tika clients, the memory requirements sould be moderate even for huge sheets (i.e. much less than the file size even for a single-sheet file). This should satisfy the low memory footprint requirements reasonably well while allowing us to generate more accurate output.&quot;&lt;/p&gt;

&lt;p&gt;See here: &lt;a href=&quot;http://tika.markmail.org/message/ac3kgujkcrgqyb4i&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://tika.markmail.org/message/ac3kgujkcrgqyb4i&lt;/a&gt;&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12392048">TIKA-132</key>
            <summary>Refactor Excel extractor to parse per sheet and add hyperlink support</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="niallp">Niall Pemberton</reporter>
                        <labels>
                    </labels>
                <created>Fri, 21 Mar 2008 14:11:11 +0000</created>
                <updated>Fri, 22 May 2009 23:05:28 +0100</updated>
                            <resolved>Sat, 12 Jul 2008 10:42:59 +0100</resolved>
                                    <version>0.1-incubating</version>
                                    <fixVersion>0.2</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12581085" author="niallp" created="Fri, 21 Mar 2008 14:18:45 +0000"  >&lt;p&gt;Attaching a patch to refactor ExcelExtractor as per Jukka&apos;s suggestion. A few points to note:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Maintains &quot;linked-lists&quot; of Rows and Cells (each Row/Cell has a reference to the next Row/Cell)&lt;/li&gt;
	&lt;li&gt;Hyperlink support is currently commented out as it includes un-released POI features - marked with FIXME&lt;/li&gt;
	&lt;li&gt;Empty sheets are ignored - is this OK&lt;/li&gt;
	&lt;li&gt;Still doesn&apos;t produce links in the output using the WriteOutContentHandler as the link is a &quot;href&quot; attribute of an &amp;lt;a&amp;gt; element - is this correct?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;To try out the hyperlink support - uncomment the relevant lines and use a POI version built from the latest subversion trunk.&lt;/p&gt;</comment>
                            <comment id="12581089" author="niallp" created="Fri, 21 Mar 2008 14:40:54 +0000"  >&lt;p&gt;Apologies - attaching a second patch, with minor changes&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;make visibility of methods in new private static inner classes consistent&lt;/li&gt;
	&lt;li&gt;use row/column parameter names rather than rowNo/columnNo as POI does&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12582353" author="jukkaz" created="Wed, 26 Mar 2008 17:16:10 +0000"  >&lt;p&gt;Thanks! Applied your patch as-is in revision 641394.&lt;/p&gt;

&lt;p&gt;Good point about empty sheets, I was wondering before how we could avoid exposing them. (A related thought: Perhaps we should avoid outputting the &amp;lt;h1&amp;gt; tags on default sheet names like &quot;Sheet 1&quot;. &lt;/p&gt;

&lt;p&gt;Re: WriteOutContentHandler; I think that&apos;s acceptable, as IMHO in default settings WriteOutContentHandler should output the actual text that&apos;s visible in the document. If a client wants to access extra information like the embedded links, it should use the SAX stream.&lt;/p&gt;

&lt;p&gt;There are a few improvements I&apos;d like to make:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I&apos;d replace the processCellValue flow on the &quot;text&quot; variable with a method call as the case-if-if control flow may be a bit hard to follow especially if we keep adding functionality to processCellValue.&lt;/li&gt;
	&lt;li&gt;We should leverage existing java.util collections instead of creating our own linked lists. For example a SortedMap of cell coordinates to cell values should fit our needs and reduce the amount of custom code in Tika&lt;/li&gt;
	&lt;li&gt;Cell formatting could be delegated to TikaExcelCell subclasses for better separation of concerns&lt;/li&gt;
	&lt;li&gt;The inner classes could be made package-private top level classes to avoid bloating ExcelExtractor&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;ll follow up with respective commits directly in svn, but feel free to debate my changes if you prefer other solutions. I&apos;ll update svn accordingly until there&apos;s consensus.&lt;/p&gt;</comment>
                            <comment id="12582432" author="jukkaz" created="Wed, 26 Mar 2008 21:13:14 +0000"  >&lt;p&gt;I&apos;m now done streamlining the class. Most notably I extracted and abstracted the TikaExcelCell class to the Cell interface and the related implementation classes TextCell and NumberCell and the LinkedCell decorator. These classes have no dependencies to Excel parsing, and could be used for similar page-by-page rendering purposes also by other parser implementations. I&apos;ll follow up with another issue to generalize the Cell classes.&lt;/p&gt;

&lt;p&gt;I&apos;ll leave this issue open until POI releases the next version with hyperlink support.&lt;/p&gt;</comment>
                            <comment id="12613064" author="jukkaz" created="Sat, 12 Jul 2008 10:42:59 +0100"  >&lt;p&gt;POI is now 3.1 and hyperlinks are enabled in Tika. Resolving as Fixed.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12378381" name="TIKA-132-ExcelExtractor-refactor-v2.patch" size="17069" author="niallp" created="Fri, 21 Mar 2008 14:40:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 26 Mar 2008 17:16:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4729</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx5o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17238</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>