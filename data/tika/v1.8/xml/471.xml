<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:39:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-471/TIKA-471.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-471] Avoid Charset name bottleneck when multiple threads are using HtmlParser</title>
                <link>https://issues.apache.org/jira/browse/TIKA-471</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;As reported by a user on the Nutch list, if there are lots of threads all parsing HTML documents, there&apos;s a lock contention issue caused by a JVM-wide lock used when resolving charset names:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Apparently this is a known issue with Java, and a couple articles are&lt;br/&gt;
written about it:&lt;br/&gt;
&lt;a href=&quot;http://paul.vox.com/library/post/the-mysteries-of-java-character-set-perform&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://paul.vox.com/library/post/the-mysteries-of-java-character-set-perform&lt;/a&gt;&lt;br/&gt;
ance.html &lt;br/&gt;
&lt;a href=&quot;http://halfbottle.blogspot.com/2009/07/charset-continued-i-wrote-about.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://halfbottle.blogspot.com/2009/07/charset-continued-i-wrote-about.html&lt;/a&gt; &lt;/p&gt;

&lt;p&gt;There is also a note in java bug database about scaling issues with the&lt;br/&gt;
class...&lt;br/&gt;
Please also note that the current implementation of&lt;br/&gt;
sun.nio.cs.FastCharsetProvider.charsetForName() uses a JVM-wide lock and is&lt;br/&gt;
called very often (e.g. by new String(byte[] data,String encoding)). This&lt;br/&gt;
JVM-wide lock means that Java applications do not scale beyond 4 CPU cores.&lt;/p&gt;

&lt;p&gt;I noted in the case of my stack at this particular point in time.  The&lt;br/&gt;
BLOCKED calls to charsetForName were generated by:&lt;/p&gt;

&lt;p&gt;at org.apache.tika.parser.html.HtmlParser.getEncoding(HtmlParser.java:84) 378&lt;br/&gt;
at org.apache.tika.parser.html.HtmlParser.getEncoding(HtmlParser.java:99) 61&lt;br/&gt;
at org.apache.tika.parser.html.HtmlParser.getEncoding(HtmlParser.java:133) 19 &lt;br/&gt;
at org.apache.nutch.parse.html.HtmlParser.sniffCharacterEncoding(HtmlParser.java:86)  238&lt;br/&gt;
...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We now have a CharsetUtils class in Tika, and we could add a cache for validated names in the isSupported() method.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12470066">TIKA-471</key>
            <summary>Avoid Charset name bottleneck when multiple threads are using HtmlParser</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jukkaz">Jukka Zitting</assignee>
                                    <reporter username="kkrugler">Ken Krugler</reporter>
                        <labels>
                    </labels>
                <created>Sat, 24 Jul 2010 02:36:25 +0100</created>
                <updated>Sun, 8 Jul 2012 13:05:56 +0100</updated>
                            <resolved>Sun, 8 Jul 2012 13:05:56 +0100</resolved>
                                                    <fixVersion>1.2</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12929419" author="chrismattmann" created="Mon, 8 Nov 2010 00:40:45 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;classify&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13408903" author="jukkaz" created="Sun, 8 Jul 2012 13:05:56 +0100"  >&lt;p&gt;As a followup to &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-322&quot; title=&quot;Improve encoding detection speed and accuracy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-322&quot;&gt;&lt;del&gt;TIKA-322&lt;/del&gt;&lt;/a&gt; I did some fairly significant refactoring of the charset handling code. The outcome massively reduces the number of Charset.forName() calls we make.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Nov 2010 00:40:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4390</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxx3l3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16900</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>