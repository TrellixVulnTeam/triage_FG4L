<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:36:39 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/TIKA-1092/TIKA-1092.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[TIKA-1092] Parsing of old Word file causes a TikaException</title>
                <link>https://issues.apache.org/jira/browse/TIKA-1092</link>
                <project id="12310631" key="TIKA">Tika</project>
                    <description>&lt;p&gt;I found an issue with the parse method of org.apache.tika.parser.microsoft.OfficeParser. This parser generates a Tika Exception when it try to parse very old file of Microsoft Word.&lt;/p&gt;

&lt;p&gt;I think this issue is not a priority because the files that cause the exception belong to an obsolete format/structure that even new Microsoft Office versions don&apos;t support them, but it&apos;s important to know that something wrong about these outdated types can happen.&lt;/p&gt;

&lt;p&gt;I report two links about old types (Microsoft support perspective):&lt;br/&gt;
&lt;a href=&quot;http://support.microsoft.com/?kbid=922850&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://support.microsoft.com/?kbid=922850&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://support.microsoft.com/kb/922849/it&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://support.microsoft.com/kb/922849/it&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For example, the message of TikaException is below:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; org.apache.tika.exception.TikaException: &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA-198&quot; title=&quot;Better distinction between IOException and TikaException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;TIKA-198&quot;&gt;&lt;del&gt;TIKA-198&lt;/del&gt;&lt;/a&gt;: Illegal IOException from org.apache.tika.parser.microsoft.OfficeParser@789ab21d&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:248)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)&lt;br/&gt;
	at org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:120)&lt;br/&gt;
	at org.apache.tika.cli.TikaCLI$OutputType.process(TikaCLI.java:139)&lt;br/&gt;
	at org.apache.tika.cli.TikaCLI.process(TikaCLI.java:415)&lt;br/&gt;
	at org.apache.tika.cli.TikaCLI.main(TikaCLI.java:109)&lt;br/&gt;
Caused by: java.io.IOException: Invalid header signature; read 0x0410401F002DA5DB, expected 0xE11AB1A1E011CFD0&lt;br/&gt;
	at org.apache.poi.poifs.storage.HeaderBlock.&amp;lt;init&amp;gt;(HeaderBlock.java:140)&lt;br/&gt;
	at org.apache.poi.poifs.storage.HeaderBlock.&amp;lt;init&amp;gt;(HeaderBlock.java:115)&lt;br/&gt;
	at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.&amp;lt;init&amp;gt;(NPOIFSFileSystem.java:198)&lt;br/&gt;
	at org.apache.poi.poifs.filesystem.NPOIFSFileSystem.&amp;lt;init&amp;gt;(NPOIFSFileSystem.java:184)&lt;br/&gt;
	at org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java:156)&lt;br/&gt;
	at org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242)&lt;br/&gt;
	... 5 more&lt;/p&gt;</description>
                <environment></environment>
        <key id="12636484">TIKA-1092</key>
            <summary>Parsing of old Word file causes a TikaException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="gostep">Giuseppe Totaro</reporter>
                        <labels>
                            <label>office</label>
                            <label>parse</label>
                            <label>word-exception</label>
                    </labels>
                <created>Tue, 12 Mar 2013 00:19:56 +0000</created>
                <updated>Tue, 25 Mar 2014 16:21:46 +0000</updated>
                            <resolved>Sun, 1 Sep 2013 19:43:18 +0100</resolved>
                                                    <fixVersion>1.5</fixVersion>
                                    <component>parser</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13600006" author="gagravarr" created="Tue, 12 Mar 2013 13:02:00 +0000"  >&lt;p&gt;I&apos;m not sure that your problem file is actually a word document. The exception you&apos;re seeing is triggered by POI trying to open the file, but discovering that it&apos;s not actually an OLE2 document. POI can&apos;t handle very old office documents (pre about 95, but it varies between formats), but it can at least open the outer OLE2 container&lt;/p&gt;

&lt;p&gt;Without the sample file I can&apos;t tell what your file actually is, but my best guess is that someone has renamed it to be .doc when it isn&apos;t anything like that&lt;/p&gt;</comment>
                            <comment id="13600065" author="gostep" created="Tue, 12 Mar 2013 14:23:38 +0000"  >&lt;p&gt;Hi Nick,&lt;/p&gt;

&lt;p&gt;I&apos;m agree with your first observation about old office documents.&lt;br/&gt;
I don&apos;t think that someone has renamed the files. These files were created with an older version of Word (I think Microsoft Word 6.0) and they were saved with .doc extension.&lt;br/&gt;
Unfortunately I can&apos;t supply my set of files because they are classified. I&apos;ll send you one or more files If I find documents without confidentiality limits that generate the same exception.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Giuseppe&lt;/p&gt;</comment>
                            <comment id="13600239" author="gagravarr" created="Tue, 12 Mar 2013 17:49:06 +0000"  >&lt;p&gt;It&apos;s not word 6 - Tika can handle Word 6, Word 95 and newer files for metadata and text extraction. We even have unit tests for it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;If you can get word to open it, if you do a save-as does that suggest from the type what it is?&lt;/p&gt;</comment>
                            <comment id="13601195" author="gostep" created="Wed, 13 Mar 2013 14:37:41 +0000"  >&lt;p&gt;Hi Nick,&lt;/p&gt;

&lt;p&gt;most files were created in 1992 (before the launch of Word 6).&lt;/p&gt;

&lt;p&gt;When I try to open these files with my Word version (Office 2007) I receive the message:&lt;br/&gt;
&quot;You are attempting to open a file that was created in an earlier version of Microsoft Office. This file type is blocked from opening in this version by your registry policy setting.&quot;&lt;/p&gt;

&lt;p&gt;To open the file I must apply the manual (or fix app) correction to Windows registry following the instructions reported in &lt;a href=&quot;http://support.microsoft.com/kb/922849/en-us#fixit4me&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://support.microsoft.com/kb/922849/en-us#fixit4me&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After the correction, I&apos;m able to open the file with Word and I see the document text correctly. If I try to save the file (on itself), the Word application ask me to select a type. Thus I can see the file with Word but I&apos;m not able to know the original type version of the document and the application used to create it.&lt;/p&gt;

&lt;p&gt;I attempted to know other information about these misterious files, but I didn&apos;t obtain relevant results. For example, I used the command-line tool &quot;file&quot; under Linux or other metadata analyzer (don&apos;t worry... Tika remains my favorite parser &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;).&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Giuseppe &lt;/p&gt;</comment>
                            <comment id="13601223" author="gagravarr" created="Wed, 13 Mar 2013 15:15:15 +0000"  >&lt;p&gt;That old, wow!&lt;/p&gt;

&lt;p&gt;Any chance you could take a look at the file in a hexdump tool, look for where the text starts, then share something like the first 1-2kb of the file (max 4kb, but before your confidential text begins!). Ideally from two files, so we can compare. If nothing else, that&apos;ll give us something to use to come up with a more graceful way of (not) handling these files&lt;/p&gt;</comment>
                            <comment id="13602168" author="gostep" created="Thu, 14 Mar 2013 10:08:17 +0000"  >&lt;p&gt;Hi Nick,&lt;/p&gt;

&lt;p&gt;thanks for your support.&lt;br/&gt;
I&apos;ll send you the first 384 bytes (saved by hex editor for mac) of three old file .DOC that cause TikaException. Unfortunately I can&apos;t supply the first 2 KB because at byte 385 begins the confidential text.&lt;br/&gt;
I&apos;ll try to send you other information.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Giuseppe&lt;/p&gt;</comment>
                            <comment id="13602936" author="gagravarr" created="Fri, 15 Mar 2013 00:30:04 +0000"  >&lt;p&gt;Any chance you could grab a copy of wvWare &amp;lt;&lt;a href=&quot;http://wvware.sourceforge.net/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wvware.sourceforge.net/&lt;/a&gt;&amp;gt; and run wvVersion against it? Then try converting to text, and see if that works too&lt;/p&gt;

&lt;p&gt;(I think they&apos;re word2, but wvWare isn&apos;t sure with only those first few bytes)&lt;/p&gt;</comment>
                            <comment id="13602966" author="gagravarr" created="Fri, 15 Mar 2013 00:52:33 +0000"  >&lt;p&gt;If that does check out, we&apos;ll likely want to add something like:&lt;/p&gt;

&lt;p&gt;  &amp;lt;mime-type type=&quot;application/msword2&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Pre-OLE2, not a subtype of application/x-tika-msoffice --&amp;gt;&lt;br/&gt;
    &amp;lt;_comment&amp;gt;Microsoft Word 2 Document&amp;lt;/_comment&amp;gt;&lt;br/&gt;
    &amp;lt;magic priority=&quot;50&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;match value=&quot;0x9ba5&quot; type=&quot;string&quot; /&amp;gt;&lt;br/&gt;
      &amp;lt;match value=&quot;0xdba5&quot; type=&quot;string&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/magic&amp;gt;&lt;br/&gt;
  &amp;lt;/mime-type&amp;gt;&lt;br/&gt;
  &amp;lt;mime-type type=&quot;application/msword5&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;!-- Pre-OLE2, not a subtype of application/x-tika-msoffice --&amp;gt;&lt;br/&gt;
    &amp;lt;_comment&amp;gt;Microsoft Word 5 Document&amp;lt;/_comment&amp;gt;&lt;br/&gt;
    &amp;lt;magic priority=&quot;50&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;match value=&quot;0xfe37&quot; type=&quot;string&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/magic&amp;gt;&lt;br/&gt;
  &amp;lt;/mime-type&amp;gt;&lt;/p&gt;

&lt;p&gt;(That&apos;s based on the magic numbers found from looking through the wv sourcecode for hints)&lt;/p&gt;</comment>
                            <comment id="13617531" author="gagravarr" created="Fri, 29 Mar 2013 17:15:44 +0000"  >&lt;p&gt;I&apos;ve gone ahead and added this mime info in r1462545, hopefully that&apos;ll help with detecting such files&lt;/p&gt;</comment>
                            <comment id="13619639" author="gostep" created="Tue, 2 Apr 2013 09:58:45 +0100"  >&lt;p&gt;Thanks Nick. I&apos;ll give you feedback as soon as possible.&lt;/p&gt;</comment>
                            <comment id="13755742" author="chrismattmann" created="Sun, 1 Sep 2013 16:49:31 +0100"  >&lt;p&gt;Hi Giuseppe, did Nick&apos;s fix in r1462545 address the issue? If so, I will resolve this. Thanks for the interaction!&lt;/p&gt;</comment>
                            <comment id="13755777" author="gostep" created="Sun, 1 Sep 2013 19:29:47 +0100"  >&lt;p&gt;Hi Chris, I just tested Tika with the old files and No exception is raised. I get the following output:&lt;/p&gt;

&lt;p&gt;Content-Length: 9624&lt;br/&gt;
Content-Type: application/msword2&lt;br/&gt;
resourceName: &amp;lt;filename&amp;gt;.DOC&lt;/p&gt;

&lt;p&gt;Thanks a lot,&lt;br/&gt;
Giuseppe&lt;/p&gt;</comment>
                            <comment id="13755780" author="chrismattmann" created="Sun, 1 Sep 2013 19:43:18 +0100"  >&lt;p&gt;Fixed, per Giuseppe&apos;s comments. Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 12 Mar 2013 13:02:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316976</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzcjnr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>317318</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>