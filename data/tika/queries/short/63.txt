Avoid multiple passes over the input stream in Microsoft parsers