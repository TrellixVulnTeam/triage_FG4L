<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:25:23 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-840/SOLR-840.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-840] BinaryResponseWriter does not handle nulls with shards as it does locally</title>
                <link>https://issues.apache.org/jira/browse/SOLR-840</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When you query a number field&lt;br/&gt;
locally, it can return null. However, when you go through a shard if&lt;br/&gt;
you have an empty number it throws an error. &lt;/p&gt;

&lt;p&gt;I found wrapping the BinaryResponseWrite with a try/catch solved the&lt;br/&gt;
problem and allows null values to be returned.&lt;/p&gt;

&lt;p&gt;BinaryResponseWriter.java:141&lt;br/&gt;
        try &lt;/p&gt;
{
          val = useFieldObjects ? ft.toObject(f) : ft.toExternal(f);
        }
&lt;p&gt; catch (NumberFormatException e) &lt;/p&gt;
{
        val = null;
        }

&lt;p&gt;It seems only the BinaryResponseWriter is actually that fussy about&lt;br/&gt;
null items. Once it comes back to the client for display, it is&lt;br/&gt;
handled without error. &lt;/p&gt;

&lt;p&gt;Hoss suggested this should be fixed for 1.3 but now that it has shipped I have marked it as 1.3.1 (&lt;br/&gt;
See: &lt;a href=&quot;http://www.nabble.com/best-way-to-debug-shard-format-errors-td19087854.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/best-way-to-debug-shard-format-errors-td19087854.html&lt;/a&gt;)&lt;/p&gt;</description>
                <environment>&lt;p&gt;All&lt;/p&gt;</environment>
        <key id="12408039">SOLR-840</key>
            <summary>BinaryResponseWriter does not handle nulls with shards as it does locally</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalinmangar">Shalin Shekhar Mangar</assignee>
                                    <reporter username="iconnor">ian connor</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Nov 2008 21:26:21 +0000</created>
                <updated>Tue, 10 Nov 2009 15:51:50 +0000</updated>
                            <resolved>Mon, 17 Nov 2008 06:34:26 +0000</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.4</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="12645965" author="noble.paul" created="Sat, 8 Nov 2008 07:30:50 +0000"  >&lt;p&gt;could you post the stacktrace as well?&lt;/p&gt;</comment>
                            <comment id="12646292" author="iconnor" created="Mon, 10 Nov 2008 16:39:09 +0000"  >&lt;p&gt;HTTP ERROR: 500&lt;/p&gt;

&lt;p&gt;parsing error&lt;/p&gt;

&lt;p&gt;org.apache.solr.common.SolrException: parsing error&lt;br/&gt;
	at org.apache.solr.client.solrj.impl.BinaryResponseParser.processResponse(BinaryResponseParser.java:41)&lt;br/&gt;
	at org.apache.solr.client.solrj.impl.CommonsHttpSolrServer.request(CommonsHttpSolrServer.java:385)&lt;br/&gt;
	at org.apache.solr.client.solrj.impl.CommonsHttpSolrServer.request(CommonsHttpSolrServer.java:183)&lt;br/&gt;
	at org.apache.solr.handler.component.HttpCommComponent$1.call(SearchHandler.java:396)&lt;br/&gt;
	at org.apache.solr.handler.component.HttpCommComponent$1.call(SearchHandler.java:369)&lt;br/&gt;
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)&lt;br/&gt;
	at java.util.concurrent.FutureTask.run(FutureTask.java:166)&lt;br/&gt;
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)&lt;br/&gt;
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)&lt;br/&gt;
	at java.util.concurrent.FutureTask.run(FutureTask.java:166)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:675)&lt;br/&gt;
Caused by: java.io.EOFException&lt;br/&gt;
	at org.apache.solr.common.util.FastInputStream.readByte(FastInputStream.java:160)&lt;br/&gt;
	at org.apache.solr.common.util.NamedListCodec.readVal(NamedListCodec.java:143)&lt;br/&gt;
	at org.apache.solr.common.util.NamedListCodec.readArray(NamedListCodec.java:367)&lt;br/&gt;
	at org.apache.solr.common.util.NamedListCodec.readVal(NamedListCodec.java:153)&lt;br/&gt;
	at org.apache.solr.common.util.NamedListCodec.readSolrDocumentList(NamedListCodec.java:301)&lt;br/&gt;
	at org.apache.solr.common.util.NamedListCodec.readVal(NamedListCodec.java:172)&lt;br/&gt;
	at org.apache.solr.common.util.NamedListCodec.readOrderedMap(NamedListCodec.java:98)&lt;br/&gt;
	at org.apache.solr.common.util.NamedListCodec.readVal(NamedListCodec.java:154)&lt;br/&gt;
	at org.apache.solr.common.util.NamedListCodec.unmarshal(NamedListCodec.java:89)&lt;br/&gt;
	at org.apache.solr.client.solrj.impl.BinaryResponseParser.processResponse(BinaryResponseParser.java:39)&lt;br/&gt;
	... 12 more&lt;/p&gt;

&lt;p&gt;RequestURI=/solr/select/&lt;/p&gt;</comment>
                            <comment id="12646301" author="noble.paul" created="Mon, 10 Nov 2008 17:16:56 +0000"  >&lt;p&gt;the problem apparently is with writing &lt;/p&gt;

&lt;p&gt;can you do&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; { val = useFieldObjects ? ft.toObject(f) : ft.toExternal(f); } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (NumberFormatException e) {e.printStacktrace(); val = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and paste the stacktrace&lt;/p&gt;</comment>
                            <comment id="12646317" author="iconnor" created="Mon, 10 Nov 2008 18:33:29 +0000"  >&lt;p&gt;java.lang.NumberFormatException: For input string: &quot;&quot;&lt;br/&gt;
        at java.lang.NumberFormatException.forInputString(NumberFormatException.java:66)&lt;br/&gt;
        at java.lang.Integer.parseInt(Integer.java:497)&lt;br/&gt;
        at java.lang.Integer.valueOf(Integer.java:576)&lt;br/&gt;
        at org.apache.solr.schema.IntField.toObject(IntField.java:71)&lt;br/&gt;
        at org.apache.solr.schema.IntField.toObject(IntField.java:32)&lt;br/&gt;
        at org.apache.solr.request.BinaryResponseWriter$Resolver.getDoc(BinaryResponseWriter.java:145)&lt;br/&gt;
        at org.apache.solr.request.BinaryResponseWriter$Resolver.writeDocList(BinaryResponseWriter.java:122)&lt;br/&gt;
        at org.apache.solr.request.BinaryResponseWriter$Resolver.resolve(BinaryResponseWriter.java:87)&lt;br/&gt;
        at org.apache.solr.common.util.NamedListCodec.writeVal(NamedListCodec.java:131)&lt;br/&gt;
        at org.apache.solr.common.util.NamedListCodec.writeNamedList(NamedListCodec.java:121)&lt;br/&gt;
        at org.apache.solr.common.util.NamedListCodec.marshal(NamedListCodec.java:80)&lt;br/&gt;
        at org.apache.solr.request.BinaryResponseWriter.write(BinaryResponseWriter.java:47)&lt;br/&gt;
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:254)&lt;br/&gt;
        at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1089)&lt;br/&gt;
        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:365)&lt;br/&gt;
        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)&lt;br/&gt;
        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:712)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:211)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:139)&lt;br/&gt;
        at org.mortbay.jetty.Server.handle(Server.java:285)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:502)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:835)&lt;br/&gt;
        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:641)&lt;br/&gt;
        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:208)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:378)&lt;br/&gt;
        at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:226)&lt;br/&gt;
        at org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:442)&lt;br/&gt;
java.lang.NumberFormatException: For input string: &quot;&quot;&lt;br/&gt;
        at java.lang.NumberFormatException.forInputString(NumberFormatException.java:66)&lt;br/&gt;
        at java.lang.Integer.parseInt(Integer.java:497)&lt;br/&gt;
        at java.lang.Integer.valueOf(Integer.java:576)&lt;br/&gt;
        at org.apache.solr.schema.IntField.toObject(IntField.java:71)&lt;br/&gt;
        at org.apache.solr.schema.IntField.toObject(IntField.java:32)&lt;br/&gt;
        at org.apache.solr.request.BinaryResponseWriter$Resolver.getDoc(BinaryResponseWriter.java:145)&lt;br/&gt;
        at org.apache.solr.request.BinaryResponseWriter$Resolver.writeDocList(BinaryResponseWriter.java:122)&lt;br/&gt;
        at org.apache.solr.request.BinaryResponseWriter$Resolver.resolve(BinaryResponseWriter.java:87)&lt;br/&gt;
        at org.apache.solr.common.util.NamedListCodec.writeVal(NamedListCodec.java:131)&lt;br/&gt;
        at org.apache.solr.common.util.NamedListCodec.writeNamedList(NamedListCodec.java:121)&lt;br/&gt;
        at org.apache.solr.common.util.NamedListCodec.marshal(NamedListCodec.java:80)&lt;br/&gt;
        at org.apache.solr.request.BinaryResponseWriter.write(BinaryResponseWriter.java:47)&lt;br/&gt;
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:254)&lt;br/&gt;
        at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1089)&lt;br/&gt;
        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:365)&lt;br/&gt;
        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)&lt;br/&gt;
        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:712)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:211)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:139)&lt;br/&gt;
        at org.mortbay.jetty.Server.handle(Server.java:285)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:502)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:835)&lt;br/&gt;
        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:641)&lt;br/&gt;
        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:208)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:378)&lt;br/&gt;
        at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:226)&lt;br/&gt;
        at org.mortbay.thread.BoundedThreadPool$PoolThread.run(BoundedThreadPool.java:442)&lt;/p&gt;</comment>
                            <comment id="12646460" author="noble.paul" created="Tue, 11 Nov 2008 03:56:18 +0000"  >&lt;p&gt;Thanks Ian&lt;br/&gt;
So the problem is with the int field storing an empty string and it tries to convert that into an int. All other response writers write it down as String and never attempts to convert it to an int.&lt;/p&gt;

&lt;p&gt;I am wondering whether the fix must go into BinaryResponseWriter or  IntField. For the time being the fix you have is good&lt;/p&gt;

&lt;p&gt;it can be bettered &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; { val = useFieldObjects ? ft.toObject(f) : ft.toExternal(f); } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {&lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let us wait for the masters of Lucene to say what is the ideal fix? &lt;/p&gt;</comment>
                            <comment id="12646584" author="noble.paul" created="Tue, 11 Nov 2008 16:25:14 +0000"  >&lt;p&gt;Yonik, Hoss can anybody explain how can an IntField contain an empty string as value? What should be the fix? in InfField or in BinaryResponseWriter?&lt;/p&gt;</comment>
                            <comment id="12648086" author="noble.paul" created="Mon, 17 Nov 2008 06:12:56 +0000"  >&lt;p&gt;catch and log the error&lt;/p&gt;</comment>
                            <comment id="12648089" author="shalinmangar" created="Mon, 17 Nov 2008 06:27:46 +0000"  >&lt;p&gt;Ian, is it possible that you changed the schema from a string to integer/sint and did not re-index? I&apos;m not sure why an empty string will be there in an integer field. Anyway, we should handle this kind of error.&lt;/p&gt;</comment>
                            <comment id="12648090" author="shalinmangar" created="Mon, 17 Nov 2008 06:34:26 +0000"  >&lt;p&gt;Committed revision 718179.&lt;/p&gt;

&lt;p&gt;Thanks Noble!&lt;/p&gt;</comment>
                            <comment id="12775569" author="gsingers" created="Tue, 10 Nov 2009 15:51:50 +0000"  >&lt;p&gt;Bulk close for Solr 1.4&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12394040" name="SOLR-840.patch" size="1712" author="noble.paul" created="Mon, 17 Nov 2008 06:12:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 8 Nov 2008 07:30:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6787</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxovz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20351</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>