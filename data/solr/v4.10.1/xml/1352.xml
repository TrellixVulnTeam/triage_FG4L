<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:22:39 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-1352/SOLR-1352.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-1352] DIH: MultiThreaded</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1352</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;It has been a long pending request to make DIH multithreaded. Now that we have implemented most of the features , the next best thing we can aim for is performance. DIH should be able to take advantage of multiple cores in a box .I expect the configuration to be as follows&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;entity name=&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt; threads=&lt;span class=&quot;code-quote&quot;&gt;&quot;4&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;&amp;lt;!--more stuff goes here--&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/entity&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;at the entity where the threads is specified it should fork into multiple threads. If the threads&amp;lt;2 it executes w/o forking. In debug mode it automatically becomes singlethreaded.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12432621">SOLR-1352</key>
            <summary>DIH: MultiThreaded</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="noble.paul">Noble Paul</assignee>
                                    <reporter username="noble.paul">Noble Paul</reporter>
                        <labels>
                    </labels>
                <created>Sun, 9 Aug 2009 08:51:03 +0100</created>
                <updated>Fri, 12 Nov 2010 16:46:46 +0000</updated>
                            <resolved>Tue, 12 Jan 2010 07:59:55 +0000</resolved>
                                                    <fixVersion>1.5</fixVersion>
                                    <component>contrib - DataImportHandler</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="12741047" author="avlesh" created="Sun, 9 Aug 2009 08:56:17 +0100"  >&lt;p&gt;Thanks, once again &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, for creating the ticket, Noble.&lt;br/&gt;
Here&apos;s the last discussion on the topic, &quot;Support for batch processing of commands using parallel threads in DIH&quot; - &lt;a href=&quot;http://www.lucidimagination.com/search/document/a9b26ade46466ee/queries_regarding_a_paralleldataimporthandler&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.lucidimagination.com/search/document/a9b26ade46466ee/queries_regarding_a_paralleldataimporthandler&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12777429" author="noble.paul" created="Fri, 13 Nov 2009 09:57:24 +0000"  >&lt;p&gt;first cut an ugly patch. a lot of work left before putting it in&lt;/p&gt;</comment>
                            <comment id="12777430" author="noble.paul" created="Fri, 13 Nov 2009 09:58:46 +0000"  >&lt;p&gt;&apos;numThreads&apos; becomes&apos; threads&apos;&lt;/p&gt;</comment>
                            <comment id="12786853" author="noble.paul" created="Mon, 7 Dec 2009 10:32:15 +0000"  >&lt;p&gt;updated to trunk&lt;/p&gt;</comment>
                            <comment id="12793988" author="noble.paul" created="Wed, 23 Dec 2009 09:42:35 +0000"  >&lt;p&gt;More or less final. I plan to commit this soon&lt;/p&gt;</comment>
                            <comment id="12799113" author="noble.paul" created="Tue, 12 Jan 2010 07:59:54 +0000"  >&lt;p&gt;committed Revision: 898209&lt;/p&gt;</comment>
                            <comment id="12862852" author="dsmiley" created="Fri, 30 Apr 2010 21:42:23 +0100"  >&lt;p&gt;Without having to read the patch, can someone describe in more detail the nature of DIH multi-threading?  I can figure what it would mean to have two threads, one to read from the data provider and one to write to Solr, with a queue in-between.  But it&apos;s not clear what&apos;s going on here since thread can be &amp;gt; 2.&lt;/p&gt;</comment>
                            <comment id="12864170" author="noble.paul" created="Wed, 5 May 2010 06:47:11 +0100"  >&lt;p&gt;the read and write are done by the same thread. but if you have 4 threads 4 documents will be processed in parallel&lt;/p&gt;</comment>
                            <comment id="12889224" author="alexey" created="Fri, 16 Jul 2010 17:49:28 +0100"  >&lt;p&gt;I&apos;ve tested this feature in trunk on a quite large data set ( freebase WEX wikipedia extract loaded into Oracle database ). It seems to be working ok. &lt;/p&gt;

&lt;p&gt;The only thing I noticed is that multithreaded implementation produce too verbose logging. Could you please change log level to DEBUG for the following events:&lt;/p&gt;

&lt;p&gt;2010-07-16 20:35:50,199 INFO  dataimport.ThreadedEntityProcessorWrapper  - arow : &lt;/p&gt;
{id=12345, body=blahblah, title=Title}
&lt;p&gt;2010-07-16 20:35:50,201 INFO  dataimport.DocBuilder  - a row on docrootSolrInputDocument[{id=id(1.0)=&lt;/p&gt;
{12345}
&lt;p&gt;, body=body(1.0)=&lt;/p&gt;
{blahblah}
&lt;p&gt;, title=title(1.0)={Title}}]&lt;/p&gt;</comment>
                            <comment id="12892919" author="rteabeault" created="Tue, 27 Jul 2010 21:38:57 +0100"  >&lt;p&gt;I was trying to apply the patch against 1.4 and was unsuccessful.  Has anyone created a patch for this against 1.4 or could give me some advice about creating one.  Thanks.&lt;/p&gt;</comment>
                            <comment id="12893093" author="noble.paul" created="Wed, 28 Jul 2010 08:27:27 +0100"  >&lt;p&gt;y do you need to apply  a patch? DIH is a separate .jar file. just take the jar from the latest and replace in your 1.4 release&lt;/p&gt;</comment>
                            <comment id="12893264" author="rteabeault" created="Wed, 28 Jul 2010 18:21:15 +0100"  >&lt;p&gt;I believe there have been some incompatible changes that have been made and so it is not as easy as just dropping in the DIH jar.  I took the 1.4 war and replaced the DIH jar with a current build of the 1.5 DIH jar.  When accessing the dataimport.jsp file I got the following error:&lt;/p&gt;


&lt;p&gt;org.apache.solr.handler.RequestHandlerBase.handleRequestBody(Lorg/apache/solr/request/SolrQueryRequest;Lorg/apache/solr/request/SolrQueryResponse;)V&lt;/p&gt;

&lt;p&gt;java.lang.AbstractMethodError: org.apache.solr.handler.RequestHandlerBase.handleRequestBody(Lorg/apache/solr/request/SolrQueryRequest;Lorg/apache/solr/request/SolrQueryResponse;)V&lt;br/&gt;
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:131)&lt;br/&gt;
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:1316)&lt;br/&gt;
....&lt;/p&gt;

&lt;p&gt;Any ideas?  Thanks.&lt;/p&gt;</comment>
                            <comment id="12893693" author="rteabeault" created="Thu, 29 Jul 2010 17:51:10 +0100"  >&lt;p&gt;Ok.  The package of SolrQueryResponse changed from org.apache.solr.request to org.apache.solr.response.  Because org.apache.solr.response.SolrQueryResponse does not exist in 1.4 I changed the necessary code in the trunk to use org.apache.solr.request.SolrQueryResponse so that I could get everything to compile.  I then replaced the dataimporthandler jar file in the 1.4 version of the solr war. &lt;/p&gt;

&lt;p&gt;So with one thread everything works fine.  I then set the root entity to use 4 threads.  I often get the following exception almost immediately after starting:&lt;/p&gt;

&lt;p&gt;org.apache.solr.handler.dataimport.DataImportHandlerException: java.sql.SQLRecoverableException: Closed Connection: next&lt;br/&gt;
        at org.apache.solr.handler.dataimport.DataImportHandlerException.wrapAndThrow(DataImportHandlerException.java:64)&lt;br/&gt;
        at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator.hasnext(JdbcDataSource.java:337)&lt;br/&gt;
        at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator.access$600(JdbcDataSource.java:226)&lt;br/&gt;
        at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator$1.hasNext(JdbcDataSource.java:260)&lt;br/&gt;
        at org.apache.solr.handler.dataimport.EntityProcessorBase.getNext(EntityProcessorBase.java:75)&lt;br/&gt;
        at org.apache.solr.handler.dataimport.SqlEntityProcessor.nextRow(SqlEntityProcessor.java:73)&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;However after 5 to 10 attempts it runs without problem.  This is being run against an Oracle 10g database using the 11g driver.  Also we have 4 sub-entities.  Not sure if I should open a new defect for this or if this has been seen by other people?  Thoughts?&lt;/p&gt;</comment>
                            <comment id="12896500" author="noble.paul" created="Mon, 9 Aug 2010 11:58:17 +0100"  >&lt;p&gt;you may open another issue, because this is already closed&lt;/p&gt;</comment>
                            <comment id="12931442" author="cmd.ares" created="Fri, 12 Nov 2010 16:46:46 +0000"  >&lt;p&gt;Hi Russell Teabeault and  my problem was serious:&lt;/p&gt;

&lt;p&gt;&amp;lt;dataConfig&amp;gt;&lt;br/&gt;
	&amp;lt;dataSource driver=&quot;oracle.jdbc.driver.OracleDriver&quot; url=&quot;jdbc:oracle:thin:@192.168.0.5:1521:orcl&quot; user=&quot;TESTSOLR&quot; password=&quot;TESTSOLR&quot; /&amp;gt;&lt;br/&gt;
	&amp;lt;document name=&quot;doc&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;entity name=&quot;A&quot; transformer=&quot;ClobTransformer&quot; threads=&quot;8&quot; query=&quot;select * from A &quot; pk=&quot;id&quot;&amp;gt;&lt;br/&gt;
                        &amp;lt;field column=&quot;COL1&quot; clob=&quot;true&quot; name=&quot;COL1&quot; /&amp;gt;&lt;br/&gt;
			&amp;lt;field column=&quot;COL1&quot; clob=&quot;true&quot; name=&quot;COL2&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;                        &amp;lt;entity name=&quot;B&quot;  query=&quot;select * from B WHERE AID=&apos;$&lt;/p&gt;
{A.ID}
&lt;p&gt;&apos; &quot; pk=&quot;id&quot; processor=&quot;CachedSqlEntityProcessor&quot;&amp;gt;&lt;br/&gt;
                        &amp;lt;field column=&quot;COL3&quot; clob=&quot;true&quot; name=&quot;COL2&quot; /&amp;gt;&lt;br/&gt;
			&amp;lt;field column=&quot;COL4&quot; clob=&quot;true&quot; name=&quot;COL4&quot; /&amp;gt;&lt;br/&gt;
			&amp;lt;/entity&amp;gt;&lt;br/&gt;
		&amp;lt;/entity&amp;gt;&lt;br/&gt;
	&amp;lt;/document&amp;gt;&lt;br/&gt;
&amp;lt;/dataConfig&amp;gt;&lt;/p&gt;

&lt;p&gt;TABLE A:10 million rows&lt;br/&gt;
TABLE B:20 million rows&lt;/p&gt;

&lt;p&gt;the dih processor is very unstable.always throws exception &lt;br/&gt;
&quot;Closed Connection: next&quot;&lt;br/&gt;
please provide some information to me .thanks.&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12419612">SOLR-1089</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12428800" name="SOLR-1352.patch" size="45340" author="noble.paul" created="Wed, 23 Dec 2009 09:42:35 +0000"/>
                            <attachment id="12427154" name="SOLR-1352.patch" size="26606" author="noble.paul" created="Mon, 7 Dec 2009 10:32:15 +0000"/>
                            <attachment id="12424828" name="SOLR-1352.patch" size="37679" author="noble.paul" created="Fri, 13 Nov 2009 09:57:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 9 Aug 2009 07:56:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6299</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxlrr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19846</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>