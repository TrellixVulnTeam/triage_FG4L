<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:19:50 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-14/SOLR-14.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-14] Add the ability to preserve the original term when using WordDelimiterFilter</title>
                <link>https://issues.apache.org/jira/browse/SOLR-14</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When doing prefix searching, you need to hang on to the original term othewise you&apos;ll miss many matches you should be making.&lt;/p&gt;

&lt;p&gt;Data: ABC-12345&lt;br/&gt;
WordDelimiterFitler may change this into&lt;br/&gt;
ABC 12345 ABC12345&lt;/p&gt;

&lt;p&gt;A user may enter a search such as &lt;br/&gt;
 ABC&amp;#45;123*&lt;br/&gt;
Which will fail to find a match given the above scenario.&lt;/p&gt;

&lt;p&gt;The attached patch will allow the use of the &quot;preserveOriginal&quot; option to WordDelimiterFilter and will analyse as&lt;br/&gt;
ABC 12345 ABC12345  ABC-12345 &lt;br/&gt;
in which case we will get a postive match.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12332977">SOLR-14</key>
            <summary>Add the ability to preserve the original term when using WordDelimiterFilter</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="rhyde">Richard &quot;Trey&quot; Hyde</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 May 2006 07:27:34 +0100</created>
                <updated>Fri, 10 May 2013 11:39:12 +0100</updated>
                            <resolved>Thu, 3 Jul 2008 16:46:18 +0100</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12377415" author="yseeley@gmail.com" created="Tue, 2 May 2006 23:35:28 +0100"  >&lt;p&gt;Thanks for the patch Trey!&lt;/p&gt;

&lt;p&gt;Can you give an example with the resulting token positions (or positionIncrements?)&lt;/p&gt;

&lt;p&gt;Also, is there an easy way to prevent duplicate tokens from being produced (the preserveOriginal version will often be identical to catenateWords or catenateNumbers, right?)&lt;/p&gt;</comment>
                            <comment id="12377426" author="rhyde" created="Wed, 3 May 2006 00:43:00 +0100"  >&lt;p&gt;IMO, it does the wrong thing with position.  I think it should have the position of the original term, I&apos;ll see if I can&apos;t figure out how to do that.  It also doesn&apos;t work properly in the &quot;single token&quot; optimized case, another easy fix.  As far as preventing duplicate tokens, an iteration though the token queue with equals should do the trick, no?&lt;/p&gt;</comment>
                            <comment id="12377440" author="hossman" created="Wed, 3 May 2006 01:54:56 +0100"  >&lt;p&gt;It would probably be good to make sure we have some UnitTests of the existing WDF behavior prior to applying this patch, and then some tests that use this new feature just so it&apos;s clera how it works in various situations.&lt;/p&gt;

&lt;p&gt;As for duplicates: my initial thought was that this could be handled by the proposed Filter in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11&quot; title=&quot;DeDupTokenFilter{Factory}&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11&quot;&gt;&lt;del&gt;SOLR-11&lt;/del&gt;&lt;/a&gt;... but then i realized yonik has a point: the common case is probably going to be no intra-word delimiters, so a short circut check that doesn&apos;t crete two of every token would probably be better&lt;/p&gt;</comment>
                            <comment id="12377851" author="rhyde" created="Fri, 5 May 2006 01:42:24 +0100"  >&lt;p&gt;Ok, this one actually works in a few more cases.    &lt;/p&gt;

&lt;p&gt;There is still term duping if numotk &amp;gt; 1 and there are no intraword delimiters in the original string.&lt;/p&gt;
</comment>
                            <comment id="12605063" author="geoff" created="Sat, 14 Jun 2008 12:55:50 +0100"  >&lt;p&gt;this is fairly important for our ongoing implementation - can someone with appropriate karma take steps to get this into 1.3?&lt;/p&gt;

&lt;p&gt;thanks&lt;/p&gt;</comment>
                            <comment id="12605080" author="yseeley@gmail.com" created="Sat, 14 Jun 2008 16:28:00 +0100"  >&lt;p&gt;Someone would need to make an up-to-date patch that works (pref w/ some tests).&lt;/p&gt;</comment>
                            <comment id="12605403" author="klaasm" created="Mon, 16 Jun 2008 21:29:51 +0100"  >&lt;p&gt;Note that it is very easy to use an external TokenFilter, so you could just c&amp;amp;p WDF into your own class and make the changes.&lt;/p&gt;

&lt;p&gt;(Though I&apos;m not saying that this &lt;em&gt;shouldn&apos;t&lt;/em&gt; make it in for 1.3)&lt;/p&gt;</comment>
                            <comment id="12605410" author="klaasm" created="Mon, 16 Jun 2008 22:03:42 +0100"  >&lt;p&gt;Also, voting for an issue is a good way to increase its visibility&lt;/p&gt;</comment>
                            <comment id="12605678" author="geoff" created="Tue, 17 Jun 2008 18:50:50 +0100"  >&lt;p&gt;ok, I&apos;ve given this a shot.  I&apos;m an an open-source guy, even an ASF guy, but not a java guy, so forgive my code &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;the patch should apply cleanly to current trunk.  the last patch before mine still had some issues that needed to be worked through wrt term duplication.  this patch should work a bit better.&lt;/p&gt;

&lt;p&gt;all current tests pass when adjusted to &apos;preserveOriginal=0&apos; (default behavior, same as 1.2).  I looked at augmenting the current tests for WDF and &apos;preserveOriginal=1&apos; but it&apos;s beyond my current java abilities.&lt;/p&gt;

&lt;p&gt;installing the patch and running the analyzer yields stuff like this:&lt;/p&gt;

&lt;p&gt;  foo =&amp;gt; foo&lt;br/&gt;
  foo-bar =&amp;gt; foo-bar foo bar foobar&lt;br/&gt;
  foo-bar baz =&amp;gt; foo-bar foo bar foobar baz&lt;br/&gt;
  foo! =&amp;gt; foo foo!&lt;/p&gt;

&lt;p&gt;which seems reasonable to me.&lt;/p&gt;

&lt;p&gt;a little shepherding would be awesome.&lt;/p&gt;

&lt;p&gt;thanks&lt;/p&gt;

&lt;p&gt;--Geoff&lt;/p&gt;</comment>
                            <comment id="12608159" author="ankurmadnani" created="Wed, 25 Jun 2008 20:19:26 +0100"  >&lt;p&gt;The junit test for preserveOriginal=1 is added to this patch. &lt;br/&gt;
This patch contains the new schema.xml for test and changed TestWordDelimiterFilter.&lt;/p&gt;

&lt;p&gt;The patch given earlier by Geoff. changes the signature of the public constructors in the WordDelimiterFilter by adding preserveOriginal as parameter.&lt;br/&gt;
May be we should create separate constructor which accepts preserveOriginal, to &lt;br/&gt;
preserve Backwards Compatibility.&lt;/p&gt;



</comment>
                            <comment id="12609241" author="geoff" created="Mon, 30 Jun 2008 15:36:17 +0100"  >&lt;p&gt;this new patch addresses three additional cases&lt;/p&gt;

&lt;p&gt;  o words prefixed with delimiters&lt;br/&gt;
  o words postfixed with delimiters&lt;br/&gt;
  o words that are all delimiters&lt;/p&gt;

&lt;p&gt;there&apos;s a special place for people who name themselves  !!! and expect to be found.&lt;/p&gt;

&lt;p&gt;the input string&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  test 404-123 $foo bar&amp;amp; beer !!! *foo baz&apos;s biff
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;produces&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;test 404-123 404 123 404123 foo $foo bar bar&amp;amp; beer !!! foo *foo baz baz&apos;s biff
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;using options&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.solr.analysis.WordDelimiterFilterFactory {preserveOriginal=1, generateNumberParts=1, catenateWords=1, generateWordParts=1, catenateAll=1, catenateNumbers=1}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="12610000" author="yseeley@gmail.com" created="Wed, 2 Jul 2008 19:31:47 +0100"  >&lt;p&gt;Attaching new version of patch.&lt;/p&gt;

&lt;p&gt;The previous version had position issues, and also had issues with certain flag combos.&lt;br/&gt;
I changed the strategy by handling &quot;preserveOriginal&quot; outside of the main loop (anywhere there is a &quot;break&quot; that falls through) and then just returning the original token first and adjusting the offset of the next token to overlap.&lt;/p&gt;

&lt;p&gt;This should also be faster as it avoids token copying in the common case.&lt;/p&gt;</comment>
                            <comment id="12610229" author="geoff" created="Thu, 3 Jul 2008 14:36:31 +0100"  >&lt;p&gt;looks good from a functional pov.  the ordering of the tokens looks funny (to me) in analysis.jsp, but all the right ones are there.&lt;/p&gt;

&lt;p&gt;it still takes my full load roughly twice as long to index (3.5 minutes versus 1.75 minutes for a 120MB file) but the functionality is important enough to incur the cost.&lt;/p&gt;

&lt;p&gt;thanks muchly.&lt;/p&gt;</comment>
                            <comment id="12610232" author="yseeley@gmail.com" created="Thu, 3 Jul 2008 15:04:23 +0100"  >&lt;blockquote&gt;&lt;p&gt;the ordering of the tokens looks funny (to me) in analysis.jsp&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Currently xxx-yyy is expanded to xxx yyy/xxxyyy  (xxx is in the first position,  yyy and xxxyyy are in the second position).&lt;br/&gt;
If we also want to index the original xxx-yyy, it&apos;s a bit arbitrary if it goes in the same position as the xxx or the yyy.&lt;br/&gt;
In this case I put it with xxx since the original token can then just be returned first (and retain everything about the original token such as it&apos;s payload, w/o having to clone it).&lt;/p&gt;
</comment>
                            <comment id="12610262" author="yseeley@gmail.com" created="Thu, 3 Jul 2008 16:46:18 +0100"  >&lt;p&gt;I committed after adding a performance test to verify that performance doesn&apos;t noticeably degrade for preserveOriginal=false.&lt;br/&gt;
Thanks everyone! &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12385134" name="SOLR-14.patch" size="12416" author="yseeley@gmail.com" created="Wed, 2 Jul 2008 19:31:47 +0100"/>
                            <attachment id="12384958" name="SOLR-14.patch" size="9955" author="geoff" created="Mon, 30 Jun 2008 15:36:17 +0100"/>
                            <attachment id="12384698" name="SOLR-14.patch" size="9069" author="ankurmadnani" created="Wed, 25 Jun 2008 20:19:25 +0100"/>
                            <attachment id="12384146" name="SOLR-14.patch" size="10265" author="geoff" created="Tue, 17 Jun 2008 18:50:50 +0100"/>
                            <attachment id="12326118" name="TokenizerFactory.java" size="903" author="rhyde" created="Tue, 2 May 2006 07:30:48 +0100"/>
                            <attachment id="12326256" name="WordDelimiterFilter.patch" size="5121" author="rhyde" created="Fri, 5 May 2006 01:42:24 +0100"/>
                            <attachment id="12326117" name="WordDelimiterFilter.patch" size="2266" author="rhyde" created="Tue, 2 May 2006 07:28:43 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 2 May 2006 22:35:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7563</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxtx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21166</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>