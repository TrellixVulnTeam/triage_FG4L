<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:21:18 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-793/SOLR-793.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-793] set a commit time bounds in the &lt;add&gt; command</title>
                <link>https://issues.apache.org/jira/browse/SOLR-793</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Currently there are two options for how to handle commiting documents:&lt;br/&gt;
1. the client explicitly starts the commit via &amp;lt;commit/&amp;gt;&lt;br/&gt;
2. set an auto commit value on the server &amp;#8211; clients can assume all documents will be commited within that time.&lt;/p&gt;

&lt;p&gt;However, this does not help in the case where the clients know what documents need updating quickly and others that could wait.  I suggest adding:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt; &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;add commitWithin=&lt;span class=&quot;code-quote&quot;&gt;&quot;100&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;to the update syntax so the client can schedule commits explicitly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12405297">SOLR-793</key>
            <summary>set a commit time bounds in the &lt;add&gt; command</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ryantxu">Ryan McKinley</reporter>
                        <labels>
                    </labels>
                <created>Sat, 27 Sep 2008 19:26:54 +0100</created>
                <updated>Tue, 10 Nov 2009 15:51:48 +0000</updated>
                            <resolved>Tue, 14 Oct 2008 01:29:55 +0100</resolved>
                                                    <fixVersion>1.4</fixVersion>
                                    <component>update</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12635176" author="ryantxu" created="Sat, 27 Sep 2008 19:34:55 +0100"  >&lt;p&gt;Here is a patch that adds the functionality to the AddUpdateCommand.  It is only supported in DirectUpdateHandler2.&lt;/p&gt;

&lt;p&gt;The only bits I&apos;m not sure about are the thread synchronization issues in CommitTracker&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void addedDocument( &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; commitWithin ) {
      docsSinceCommit++;
      lastAddedTime = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
      &lt;span class=&quot;code-comment&quot;&gt;// maxDocs-triggered autoCommit
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( docsUpperBound &amp;gt; 0 &amp;amp;&amp;amp; (docsSinceCommit &amp;gt; docsUpperBound) ) {
        scheduleCommitWithin( DOC_COMMIT_DELAY_MS );
      }
      
      &lt;span class=&quot;code-comment&quot;&gt;// maxTime-triggered autoCommit
&lt;/span&gt;      &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; ctime = timeUpperBound;
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( commitWithin &amp;gt; 0 &amp;amp;&amp;amp; (ctime &amp;lt; 0 || commitWithin &amp;lt; ctime) ) {
        ctime = commitWithin;
      }
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( ctime &amp;gt; 0 ) {
        scheduleCommitWithin( ctime );
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;previously, the code to schedule a commit was inline &amp;#8211; now this delegates to a synchronized method.  I don&apos;t think it is an issue (and tests pass), but I want to make sure that gets double checked &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;------&lt;/p&gt;

&lt;p&gt;Also, any better ideas on what the parameter/argument should be called?&lt;/p&gt;</comment>
                            <comment id="12636866" author="ryantxu" created="Sun, 5 Oct 2008 01:50:15 +0100"  >&lt;p&gt;no real change, updating for /trunk&lt;/p&gt;

&lt;p&gt;I&apos;d like to commit this soon, but would love for someone with better threading chops to look it over first &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12637018" author="noble.paul" created="Mon, 6 Oct 2008 07:59:53 +0100"  >&lt;p&gt;I somehow am confused with the usecase&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;add commitWithin=&lt;span class=&quot;code-quote&quot;&gt;&quot;100&quot;&lt;/span&gt;&amp;gt;...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I have 10 docs with with a commitWithin=&quot;100&quot; This may mean that there will be 10 commits because each &amp;lt;add&amp;gt; happened at different time. &lt;/p&gt;

&lt;p&gt;Wouldn&apos;t the user want to commit all the important documents at once . or wouldn&apos;t they want to commit tsay doc x,y,z first and then the rest of the docs?&lt;/p&gt;

</comment>
                            <comment id="12637114" author="ryantxu" created="Mon, 6 Oct 2008 16:11:27 +0100"  >&lt;p&gt;perhaps it is better to think of it as selectivly enabling the autoCommit feature.  &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If I have 10 docs with with a commitWithin=&quot;100&quot; This may mean that there will be 10 commits because each &amp;lt;add&amp;gt; happened at different time.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;assuming the last of the 10 docs were sent to solr within 100ms, then all of them would be committed at once.  The commtWithin time is a &lt;b&gt;maximum&lt;/b&gt; time, not a minimum.&lt;/p&gt;

&lt;p&gt;This is identical to how autoCommit works now &amp;#8211; the advantage is that various documents could require different time bounds.   &lt;/p&gt;</comment>
                            <comment id="12637173" author="klaasm" created="Mon, 6 Oct 2008 19:46:27 +0100"  >&lt;p&gt;Hey Ryan,&lt;/p&gt;

&lt;p&gt;I think this is good functionality and will take a look at the synchro stuff in the next day or so.   I feel somewhat reponsible, being the one who inflicted it on everyone &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12637175" author="ryantxu" created="Mon, 6 Oct 2008 19:55:17 +0100"  >&lt;blockquote&gt;&lt;p&gt;I feel somewhat reponsible, being the one who inflicted it on everyone&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hey, I claim equal responsibility &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12638825" author="klaasm" created="Sun, 12 Oct 2008 08:00:16 +0100"  >&lt;p&gt;I don&apos;t see any issue with the code: adddedDocument is always called within a synchronized context anyway, after all.&lt;/p&gt;

&lt;p&gt;One question: right now you have it set to use the minimum of autocommit/maxTime and commitWithin on the update command.  Might it be better to always use commitWithin, even if it greater than a specified maxTime?   This would allow the insertion of &quot;less important than normal&quot; docs (right now, it seems only useful for the &quot;more important&quot; case)&lt;/p&gt;</comment>
                            <comment id="12639259" author="ryantxu" created="Tue, 14 Oct 2008 01:29:54 +0100"  >&lt;p&gt;Thanks for checking this out Mike.&lt;/p&gt;

&lt;p&gt;I changed max time logic to use:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; ctime = (commitWithin&amp;gt;0) ? commitWithin : timeUpperBound;
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( ctime &amp;gt; 0 ) {
    scheduleCommitWithin( ctime );
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This way, if you have a timeUpperBound set, it will use the passed in argument rather then the minimum of the two times.&lt;/p&gt;</comment>
                            <comment id="12649455" author="ryantxu" created="Thu, 20 Nov 2008 19:50:58 +0000"  >&lt;p&gt;This is a fix to possible deadlock caused by the previous patch.&lt;/p&gt;</comment>
                            <comment id="12657757" author="noble.paul" created="Thu, 18 Dec 2008 13:03:52 +0000"  >&lt;p&gt;The XML API looks a bit ugly.&lt;br/&gt;
Why do we need to add this like this &amp;lt;add commitWithin=&quot;6&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;One update request will have only one &amp;lt;add&amp;gt; . So it could have very well been added to the request params like waitFlush and waitSearcher.&lt;/p&gt;

&lt;p&gt;If at all it has to be kept in the xml it should be on a per document .&lt;/p&gt;

&lt;p&gt;The SolrInputDocument can have a &apos;commitWithin&apos; attribute.&lt;/p&gt;


</comment>
                            <comment id="12657765" author="ryantxu" created="Thu, 18 Dec 2008 13:23:27 +0000"  >&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; One update request will have only one &amp;lt;add&amp;gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;That is the existing limitation, but i don&apos;t see any reason there could not be multiple &amp;lt;add&amp;gt; statements within one request.  similar to how we have multiple delete commands in one statement.&lt;/p&gt;

&lt;p&gt;Our existing parser supports this already, only we would need to add a new root element.  This would allow a streaming client to post all commands sequentially to the server.&lt;/p&gt;

&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The SolrInputDocument can have a &apos;commitWithin&apos; attribute.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;I don&apos;t like that because the &apos;commitWithin&apos; attribute is about the command, not the data.  Attaching it to the &apos;add&apos; command seems like the logical place for it.&lt;/p&gt;</comment>
                            <comment id="12657769" author="noble.paul" created="Thu, 18 Dec 2008 13:34:16 +0000"  >&lt;p&gt;we already have all the other parameters passed on as a request parameter , whether we like it or not&lt;/p&gt;

&lt;p&gt;Why don&apos;t we just stick to the convention. &lt;/p&gt;</comment>
                            <comment id="12657773" author="ryantxu" created="Thu, 18 Dec 2008 13:49:20 +0000"  >&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; we already have all the other parameters passed on as a request parameter&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;really?  what about:&lt;/p&gt;

&lt;p&gt;  public static final String OVERWRITE = &quot;overwrite&quot;;&lt;br/&gt;
  public static final String OVERWRITE_COMMITTED = &quot;overwriteCommitted&quot;;&lt;br/&gt;
  public static final String OVERWRITE_PENDING = &quot;overwritePending&quot;; &lt;br/&gt;
  public static final String ALLOW_DUPS = &quot;allowDups&quot;;&lt;/p&gt;

&lt;p&gt;they live with the &amp;lt;add&amp;gt; &lt;/p&gt;</comment>
                            <comment id="12657775" author="ryantxu" created="Thu, 18 Dec 2008 13:58:31 +0000"  >&lt;p&gt;Also, note that that XMLUpdate#processUpdate() does not have access to the request parameters while the add commands are being processed....&lt;/p&gt;</comment>
                            <comment id="12775543" author="gsingers" created="Tue, 10 Nov 2009 15:51:48 +0000"  >&lt;p&gt;Bulk close for Solr 1.4&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12372891">SOLR-287</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12391481" name="SOLR-793-commitWithin.patch" size="8589" author="ryantxu" created="Sun, 5 Oct 2008 01:50:15 +0100"/>
                            <attachment id="12391087" name="SOLR-793-commitWithin.patch" size="8586" author="ryantxu" created="Sat, 27 Sep 2008 19:34:55 +0100"/>
                            <attachment id="12394363" name="SOLR-793-deadlock.patch" size="1284" author="ryantxu" created="Thu, 20 Nov 2008 19:50:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 6 Oct 2008 06:59:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6830</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxp6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20398</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>