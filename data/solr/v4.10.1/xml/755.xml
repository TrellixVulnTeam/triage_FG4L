<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:25:41 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-755/SOLR-755.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-755] facet.limit=-1 does not work in distributed search</title>
                <link>https://issues.apache.org/jira/browse/SOLR-755</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If you specify facet.limit=-1 in distributed mode, no facet results are returned.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12403765">SOLR-755</key>
            <summary>facet.limit=-1 does not work in distributed search</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="yseeley@gmail.com">Yonik Seeley</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Sep 2008 17:23:57 +0100</created>
                <updated>Fri, 10 May 2013 11:40:34 +0100</updated>
                            <resolved>Fri, 5 Sep 2008 22:04:17 +0100</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12628670" author="wojtekpia" created="Fri, 5 Sep 2008 17:38:45 +0100"  >&lt;p&gt;Hi Yonik,&lt;/p&gt;

&lt;p&gt;I submitted a patch for SOLR 748 (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-748&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-748&lt;/a&gt;) a few days ago. I&apos;m guessing that whatever changes you make for this bug will break my patch. Could you review my patch while you&apos;re making these changes?&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;


&lt;p&gt;Wojtek&lt;/p&gt;


&lt;p&gt;Quoted from: &lt;br/&gt;
&lt;a href=&quot;http://www.nabble.com/-jira--Created%3A-%28SOLR-755%29-facet.limit%3D-1-does-not-work-in-distributed-search-tp19334831p19334879.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/-jira--Created%3A-%28SOLR-755%29-facet.limit%3D-1-does-not-work-in-distributed-search-tp19334831p19334879.html&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="12628704" author="yseeley@gmail.com" created="Fri, 5 Sep 2008 20:10:21 +0100"  >&lt;p&gt;I also just found and fixed a bug in TestDistributedSearch that failed to find some differences in responses... so now a test of facet.limit=-1&amp;amp;facet.sort=true now fails as it does in a manual test.&lt;/p&gt;

&lt;p&gt;Note that one must add facet.sorted=true in conjunction with facet.limit=-1 since it defaults to unsorted (or sorted-by-term), and this is currently unsupported by distributed search.&lt;/p&gt;</comment>
                            <comment id="12628712" author="larsko" created="Fri, 5 Sep 2008 20:55:27 +0100"  >&lt;p&gt;I could swear that this was working for me a while back before I abandoned it because it was too slow. Ah well.&lt;/p&gt;

&lt;p&gt;The culprit is the facet paginating code. The end is determined with&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; end = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.min(dff.offset + dff.limit, counts.length);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which is going to be -1 if the limit is set to -1, i.e. no facet counts will be returned.&lt;/p&gt;

&lt;p&gt;The attached patch adds a check for a negative value for end and sets it to Integer.MAX_VALUE. This fixes the behaviour when sorting is turned on.&lt;/p&gt;

&lt;p&gt;Is there any reason why sorting is only turned on for limits &amp;gt; 0? I think it would make sense to turn it on for -1 as well, or probably even for everything as it&apos;s not going to make a difference when no facet counts are requested.&lt;/p&gt;</comment>
                            <comment id="12628714" author="yseeley@gmail.com" created="Fri, 5 Sep 2008 20:59:46 +0100"  >&lt;p&gt;patch attached&lt;/p&gt;</comment>
                            <comment id="12628716" author="yseeley@gmail.com" created="Fri, 5 Sep 2008 21:04:52 +0100"  >&lt;p&gt;Whoops, you snuck in first... thanks Lars.&lt;br/&gt;
Although, I think your fix would cause an out-of-bounds exception?&lt;/p&gt;
</comment>
                            <comment id="12628719" author="larsko" created="Fri, 5 Sep 2008 21:12:49 +0100"  >&lt;p&gt;Ah, good point. I was testing with facet.mincount=1. Just disregard my patch.&lt;/p&gt;</comment>
                            <comment id="12628720" author="yseeley@gmail.com" created="Fri, 5 Sep 2008 21:13:10 +0100"  >&lt;blockquote&gt;&lt;p&gt;Is there any reason why sorting is only turned on for limits &amp;gt; 0?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Back compatibility.  At one point there was no facet.sort... before I added it, facet.limit read as follows:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt; == facet.limit ==&lt;br/&gt;
This param indicates the maximum number of constraint counts that should be returned for the facet fields.  If a non-negative value is specified, the constraints (ie: Terms) will be sorted by the facet count (descending) and only the top N terms will be returned with their counts.  A negative value will result in every constraint being returned, in no partiular order.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="12628722" author="yseeley@gmail.com" created="Fri, 5 Sep 2008 21:17:52 +0100"  >&lt;p&gt;So... the only question left is if this should go in 1.3 or not.&lt;br/&gt;
A client workaround is easy (specify a big number rather than -1), but it&apos;s probably not too much work to make another release candidate either.&lt;/p&gt;</comment>
                            <comment id="12628725" author="larsko" created="Fri, 5 Sep 2008 21:21:18 +0100"  >&lt;blockquote&gt;&lt;p&gt;Back compatibility.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right. What&apos;s going to break if this is changed? As far as I can see it&apos;s just code that relies on facet counts being returned in a particular order &amp;#8211; which, in this case, is no particular order &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12628728" author="larsko" created="Fri, 5 Sep 2008 21:26:47 +0100"  >&lt;blockquote&gt;&lt;p&gt;So... the only question left is if this should go in 1.3 or not.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Since it&apos;s clearly a bug, +1 for getting it into 1.3.&lt;/p&gt;</comment>
                            <comment id="12628748" author="yseeley@gmail.com" created="Fri, 5 Sep 2008 22:04:17 +0100"  >&lt;p&gt;ASL for this patch granted, and patch committed to trunk and 1.3 branch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12389584" name="SOLR-755.patch" size="3289" author="yseeley@gmail.com" created="Fri, 5 Sep 2008 20:59:46 +0100"/>
                            <attachment id="12389583" name="SOLR-755.patch" size="607" author="larsko" created="Fri, 5 Sep 2008 20:55:27 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Sep 2008 16:38:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6863</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxpef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20434</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>