<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:24:58 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-69/SOLR-69.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-69] PATCH:MoreLikeThis support</title>
                <link>https://issues.apache.org/jira/browse/SOLR-69</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Here&apos;s a patch that implements simple support of Lucene&apos;s MoreLikeThis class.&lt;/p&gt;

&lt;p&gt;The MoreLikeThisHelper code is heavily based on (hmm...&quot;lifted from&quot; might be more appropriate &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Erik Hatcher&apos;s example mentioned in &lt;a href=&quot;http://www.mail-archive.com/solr-user@lucene.apache.org/msg00878.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/solr-user@lucene.apache.org/msg00878.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To use it, add at least the following parameters to a standard or dismax query:&lt;/p&gt;

&lt;p&gt;  mlt=true&lt;br/&gt;
  mlt.fl=list,of,fields,which,define,similarity&lt;/p&gt;

&lt;p&gt;See the MoreLikeThisHelper source code for more parameters.&lt;/p&gt;

&lt;p&gt;Here are two URLs that work with the example config, after loading all documents found in exampledocs in the index (just to show that it seems to work - of course you need a larger corpus to make it interesting):&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mindf=1&amp;amp;fl=id,score&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mindf=1&amp;amp;fl=id,score&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=dismax&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mindf=1&amp;amp;fl=id,score&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=dismax&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mindf=1&amp;amp;fl=id,score&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Results are added to the output like this:&lt;br/&gt;
&amp;lt;response&amp;gt;&lt;br/&gt;
  ...&lt;br/&gt;
  &amp;lt;lst name=&quot;moreLikeThis&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;result name=&quot;UTF8TEST&quot; numFound=&quot;1&quot; start=&quot;0&quot; maxScore=&quot;1.5293242&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;doc&amp;gt;&lt;br/&gt;
        &amp;lt;float name=&quot;score&quot;&amp;gt;1.5293242&amp;lt;/float&amp;gt;&lt;br/&gt;
        &amp;lt;str name=&quot;id&quot;&amp;gt;SOLR1000&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;/doc&amp;gt;&lt;br/&gt;
    &amp;lt;/result&amp;gt;&lt;br/&gt;
    &amp;lt;result name=&quot;SOLR1000&quot; numFound=&quot;1&quot; start=&quot;0&quot; maxScore=&quot;1.5293242&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;doc&amp;gt;&lt;br/&gt;
        &amp;lt;float name=&quot;score&quot;&amp;gt;1.5293242&amp;lt;/float&amp;gt;&lt;br/&gt;
        &amp;lt;str name=&quot;id&quot;&amp;gt;UTF8TEST&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;/doc&amp;gt;&lt;br/&gt;
    &amp;lt;/result&amp;gt;&lt;br/&gt;
  &amp;lt;/lst&amp;gt;&lt;/p&gt;

&lt;p&gt;I haven&apos;t tested this extensively yet, will do in the next few days. But comments are welcome of course.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12355049">SOLR-69</key>
            <summary>PATCH:MoreLikeThis support</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ryantxu">Ryan McKinley</assignee>
                                    <reporter username="bdelacretaz">Bertrand Delacretaz</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Nov 2006 15:55:05 +0000</created>
                <updated>Fri, 10 May 2013 11:39:21 +0100</updated>
                            <resolved>Mon, 18 Jun 2007 08:41:07 +0100</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12448180" author="bdelacretaz" created="Wed, 8 Nov 2006 15:59:16 +0000"  >&lt;p&gt;The MoreLikeThis class comes from the lucene-queries jar, I enclose the version used for my tests&lt;/p&gt;</comment>
                            <comment id="12448207" author="ehatcher" created="Wed, 8 Nov 2006 17:39:47 +0000"  >&lt;p&gt;I love it when features get implemented by others!  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;   Thanks Bertrand!&lt;/p&gt;</comment>
                            <comment id="12452044" author="yseeley@gmail.com" created="Wed, 22 Nov 2006 20:51:31 +0000"  >&lt;p&gt;I finally got around to checking this out... looks cool!&lt;br/&gt;
In your example URL, it looks like mindf=1 is repeated... is that right, or should one of them have been mintf=1?&lt;/p&gt;</comment>
                            <comment id="12463125" author="ryantxu" created="Mon, 8 Jan 2007 20:50:51 +0000"  >&lt;p&gt;Thanks.  it works great.  The only problem i ran into is a null pointer if you do not specify the fields to return (by default all of them without the score).  &lt;/p&gt;

&lt;p&gt;just add a not null check to line 102 of MoreLikeThisHelper.java&lt;/p&gt;

&lt;p&gt;&amp;lt;code&amp;gt;&lt;/p&gt;

&lt;p&gt; protected boolean usesScoreField(SolrQueryRequest req) {&lt;br/&gt;
    String fl = req.getParams().get(SolrParams.FL);&lt;br/&gt;
    if( fl != null ) {&lt;br/&gt;
	    for(String field : splitList.split(fl)) &lt;/p&gt;
{
	      if(&quot;score&quot;.equals(field)) return true;
	    }
&lt;p&gt;    }&lt;br/&gt;
    return false;&lt;br/&gt;
  }&lt;/p&gt;

&lt;p&gt;&amp;lt;/code&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="12465087" author="bdelacretaz" created="Tue, 16 Jan 2007 09:32:31 +0000"  >&lt;p&gt;Yonik, you&apos;re right about the mindf parameter duplication, here&apos;s the correct example URL&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id,score&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id,score&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12465090" author="bdelacretaz" created="Tue, 16 Jan 2007 09:38:42 +0000"  >&lt;p&gt;Thanks Ryan for spotting the fl param problem, I&apos;ll attach a revised patch which fixes it.&lt;/p&gt;

&lt;p&gt;Before that, the following request caused an NPE, it works now:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12465092" author="bdelacretaz" created="Tue, 16 Jan 2007 09:39:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-69&quot; title=&quot;PATCH:MoreLikeThis support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-69&quot;&gt;&lt;del&gt;SOLR-69&lt;/del&gt;&lt;/a&gt;.patch updated&lt;/p&gt;</comment>
                            <comment id="12465114" author="bdelacretaz" created="Tue, 16 Jan 2007 10:37:19 +0000"  >&lt;p&gt;The method used to compute includeScore in MoreLikeThisHelper was inconsistent with what the XmlWriter does. &lt;/p&gt;

&lt;p&gt;I have changed it to take this info from SolrQueryResponse.getReturnFields().&lt;/p&gt;

&lt;p&gt;The md5 sum of the current &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-69&quot; title=&quot;PATCH:MoreLikeThis support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-69&quot;&gt;&lt;del&gt;SOLR-69&lt;/del&gt;&lt;/a&gt; patch is b6178d11d33f19b296b741a67df00d45&lt;/p&gt;

&lt;p&gt;With this change, all the following requests should work (standard and dismax handlers, with no fl param, id only and id + score as return fields):&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id,score&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id,score&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=dismax&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=dismax&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=dismax&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=dismax&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=dismax&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id,score&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select/?stylesheet=&amp;amp;q=apache&amp;amp;qt=dismax&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mintf=1&amp;amp;fl=id,score&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12467139" author="mrball" created="Wed, 24 Jan 2007 20:26:50 +0000"  >&lt;p&gt;Thanks for writing this!&lt;/p&gt;

&lt;p&gt;Just a shot in the dark: Would it be possible to use this on fields that are not stored? maybe the client has to supply the content of the field?&lt;/p&gt;

&lt;p&gt;Reason being I&apos;d rather not store the field as that basically duplicates the data already in my (normal non-lucene) database.&lt;/p&gt;
</comment>
                            <comment id="12467179" author="bdelacretaz" created="Wed, 24 Jan 2007 22:40:17 +0000"  >&lt;p&gt;Intuitively, without having checked exactly how it&apos;s implemented, I think MoreLikeThis queries should work irrelevant of whether fields are stored or not, as it&apos;s based on what&apos;s indexed. Maybe someone who knows Lucene&apos;s internals better than I do can comment.&lt;/p&gt;

&lt;p&gt;Did you find a case where non-stored fields cause problems?&lt;/p&gt;</comment>
                            <comment id="12467282" author="mrball" created="Thu, 25 Jan 2007 08:22:18 +0000"  >&lt;p&gt;Yep, doesn&apos;t seem to work with non-stored fields. (if you only use non stored fields in mlt.fl)&lt;/p&gt;

&lt;p&gt;I believe the stored field values are used to build the query&lt;/p&gt;</comment>
                            <comment id="12467399" author="yseeley@gmail.com" created="Thu, 25 Jan 2007 14:59:58 +0000"  >&lt;p&gt;&amp;gt; MoreLikeThis queries should work irrelevant of whether fields are stored or not, as it&apos;s based on what&apos;s indexed&lt;/p&gt;

&lt;p&gt;I haven&apos;t looked at the lucene-code for more-like-this, but it&apos;s just like highlighting... to get the tokens for a specific document, you need to either get it&apos;s stored field and re-analyze or store term vectors and use them.&lt;br/&gt;
Looking up those terms in other documents is then fast (that&apos;s where the inverted index comes in)&lt;/p&gt;</comment>
                            <comment id="12469229" author="bwhitman" created="Wed, 31 Jan 2007 22:30:46 +0000"  >&lt;p&gt;There&apos;s a typo in the latest uploaded patch &amp;#8211;&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;map.put(MIN_DOC_FREQ, String.valueOf(MoreLikeThis.DEFALT_MIN_DOC_FREQ));&lt;br/&gt;
+     map.put(MIN_DOC_FREQ, String.valueOf(MoreLikeThis.DEFAULT_MIN_DOC_FREQ));&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="12470652" author="yseeley@gmail.com" created="Tue, 6 Feb 2007 17:22:32 +0000"  >&lt;p&gt;Should this be an integrated part of the standard/dismax handlers, or should it be a separate request handler?&lt;br/&gt;
I guess the answer would depend on how it&apos;s used mos of the time:&lt;/p&gt;

&lt;p&gt;Case 1)  &lt;br/&gt;
  The GUI queries the standard request handler and displays a list of documents with a little &quot;more-like-this&quot; button next to each document.  When pressed, the GUI queries the more-like-this handler with the specific document id, and then displays the results to the user.&lt;/p&gt;

&lt;p&gt;Case 2)&lt;br/&gt;
  The GUI queries the standard request handler to display a list of documents, with a sub-list of similar &quot;mlt&quot; documents automatically displayed under each.  Or, those lists could be collapsed by default, but instantly displayed since the GUI already has the info.&lt;/p&gt;

&lt;p&gt;If case (2) were rare, then perhaps mlt should be a separate handler.  Case (2) can still be done, it would just require more requests from the GUI to do it.&lt;/p&gt;

&lt;p&gt;In either case, will highlighting be desired on any of the mlt docs?  Other thoughts?&lt;/p&gt;</comment>
                            <comment id="12470660" author="bdelacretaz" created="Tue, 6 Feb 2007 17:35:19 +0000"  >&lt;p&gt;Making this a separate handler would probably make the code easier to understand, but the current code makes case 2) easier, while making case 1) easy as well (just query on the document&apos;s unique ID, with MoreLikeThis enabled).&lt;/p&gt;

&lt;p&gt;I&apos;m for keeping it as is, integrated in the handlers as an option. If someone needs it as a separate handler, it wouldn&apos;t be hard to factor our the common parts.&lt;/p&gt;

&lt;p&gt;I have no strong feelings, however, as I built this patch to experiment with this feature but I&apos;m not using it yet.&lt;/p&gt;</comment>
                            <comment id="12470690" author="ehatcher" created="Tue, 6 Feb 2007 18:52:43 +0000"  >&lt;p&gt;In Collex, we do more-like-this on a single object not within search results.   A separate handler would be sufficient for our current needs and avoid the other handlers from becoming overloaded with options.&lt;/p&gt;

&lt;p&gt;Highlighting is not needed on MLT documents in our case.&lt;/p&gt;</comment>
                            <comment id="12476002" author="bdelacretaz" created="Mon, 26 Feb 2007 21:03:03 +0000"  >&lt;p&gt;See Ken Krugler&apos;s comments about term vectors at &lt;a href=&quot;http://www.nabble.com/MoreLikeThis-and-term-vectors---documentation-suggestion-tf3295459.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/MoreLikeThis-and-term-vectors---documentation-suggestion-tf3295459.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12479887" author="bwhitman" created="Sun, 11 Mar 2007 00:03:52 +0000"  >&lt;p&gt;Is there a way to get this patch to listen to start &amp;amp; rows on the moreLikeThis result section?&lt;/p&gt;</comment>
                            <comment id="12479991" author="bdelacretaz" created="Mon, 12 Mar 2007 06:50:24 +0000"  >&lt;p&gt;&amp;gt; Is there a way to get this patch to listen to start &amp;amp; rows on the moreLikeThis result section? &lt;/p&gt;

&lt;p&gt;IIUC you want to use the start &amp;amp; rows request parameters to limit the number of results in the moreLikeThis section?&lt;/p&gt;

&lt;p&gt;This is not implemented currently, and if we did it we&apos;d have to use different parameter names (mlt.start and mlt.rows maybe) so that they don&apos;t interfere with the &quot;main&quot; part of the result set.&lt;/p&gt;</comment>
                            <comment id="12480116" author="bwhitman" created="Mon, 12 Mar 2007 15:19:35 +0000"  >&lt;p&gt;Yes, paging and size would be helpful in the MLT section. mlt.start and mlt.rows would be great.&lt;/p&gt;

</comment>
                            <comment id="12481989" author="ryantxu" created="Mon, 19 Mar 2007 00:19:55 +0000"  >&lt;p&gt;trivial changes so it applies to trunk without conflicts...&lt;/p&gt;</comment>
                            <comment id="12493181" author="ryantxu" created="Wed, 2 May 2007 20:18:19 +0100"  >&lt;p&gt;Changed the MoreLikeThis implementation to be a standalone request handler rather then tacked on to standard/dismax request handlers&lt;/p&gt;

&lt;p&gt;How are other people using this patch?  I found that i am always looking for things that are similar to a single document.&lt;/p&gt;

&lt;p&gt;This is still in progress, but posting for feedback.&lt;/p&gt;

&lt;p&gt;An example command would be:&lt;br/&gt;
&lt;a href=&quot;http://localhost:8983/solr/mlt?q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mindf=1&amp;amp;fl=id,score&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/mlt?q=apache&amp;amp;qt=standard&amp;amp;mlt=true&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.mindf=1&amp;amp;mlt.mindf=1&amp;amp;fl=id,score&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="12493185" author="bwhitman" created="Wed, 2 May 2007 20:37:24 +0100"  >&lt;p&gt;I&apos;ve personally never understood the &quot;more documents that don&apos;t match this query but are like the documents in this query&quot; usage of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-69&quot; title=&quot;PATCH:MoreLikeThis support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-69&quot;&gt;&lt;del&gt;SOLR-69&lt;/del&gt;&lt;/a&gt;. MLT results (to me) should be like any other result, except by querying by text you are querying by document ID.  I&apos;m confused as to how querying by query would work &amp;#8211; if a query for &apos;apache&apos; returned 10 docs, would MLT work on each one and generate n more docs per doc? And would the original query results get returned? What&apos;s the ordering?&lt;/p&gt;

&lt;p&gt;But I do know that paging and faceting should definitely work on MLT results. (Ryan&apos;s patch seems to implement this but I haven&apos;t tested it.) MLT results should look and operate like any other results. &lt;/p&gt;



</comment>
                            <comment id="12493198" author="kkrugler" created="Wed, 2 May 2007 21:22:00 +0100"  >&lt;p&gt;Ryan &amp;amp; Brian&apos;s comments above are (I think) indicative of how most people want to use MLT - you&apos;ve got a single document, and you want to show other documents that are similar.&lt;/p&gt;

&lt;p&gt;The way we deal with this is to do a query on the &amp;lt;uniqueKey&amp;gt; field (as defined in the schema).&lt;/p&gt;

&lt;p&gt;If this was the only use case, then the syntax could be something like:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/mlt?uid=xxx&amp;amp;mlt.fl=manu,cat&amp;amp;mindf=1&amp;amp;rows=10&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/mlt?uid=xxx&amp;amp;mlt.fl=manu,cat&amp;amp;mindf=1&amp;amp;rows=10&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The uid parameter would implicitly be applied against the &amp;lt;uniqueKey&amp;gt; field as specified in the schema.&lt;/p&gt;

&lt;p&gt;But that&apos;s just for my use case - others may want the ability to have mlt results returned for the first hit result of an arbitrary query.&lt;/p&gt;</comment>
                            <comment id="12493770" author="hossman" created="Fri, 4 May 2007 19:36:16 +0100"  >&lt;p&gt;looking back at the two main use cases Yonik described in his comment from 06/Feb/07...&lt;/p&gt;

&lt;p&gt; At the most basic level, A request for MLT results for a single doc by uniqueKey (case#1) is just a simplistic example of asking for MLT results for an arbitrary query (case#2) ... that arbitrary query just happens to be on a uniqueKey field, and only returns one result.&lt;/p&gt;

&lt;p&gt;Where things get more complicated is when you start returning other &quot;tier 2&quot; type information about the request &amp;#8211; which begs the question &quot;what is tier 1 data&quot;?   If the MLT results are added as &quot;tier 2&quot; data to StandardRequestHandler response, then all of the other &quot;tier 2&quot; data blocks (highlighting, faceting, debugQuery score explanation, etc..) still refer to the main result from the original query ... this may be what you want in use case #2, but doesn&apos;t really make sense for use case #1, where the &quot;tier 1&quot; main result only contains the single document you asked for by id ... the score explanation and facet count numbers aren&apos;t very interesting in that case.&lt;/p&gt;

&lt;p&gt;for case #1, what you really want is for the MLT data to be treated as the primary (&quot;tier 1&quot;) result set, and all of hte &quot;tier 2&quot; data is about those results ... highlighting is done on the MLT docs, facet counts are for the MLT docs, debugQuery score explanation tells you &lt;b&gt;why&lt;/b&gt; the MLT docs are like your original docs, etc..&lt;/p&gt;

&lt;p&gt;Case #1 and case #2 are both useful, to address Brian&apos;s 02/May/07 comment..&lt;/p&gt;

&lt;p&gt; &amp;gt; I&apos;ve personally never understood the &quot;more documents &lt;br/&gt;
 &amp;gt; that don&apos;t match this query but are like the documents &lt;br/&gt;
 &amp;gt; in this query&quot; ... I&apos;m confused as to how querying by &lt;br/&gt;
 &amp;gt; query would work &amp;#8211; if a query for &apos;apache&apos; returned 10 &lt;br/&gt;
 &amp;gt; docs, would MLT work on each one and generate n more &lt;br/&gt;
 &amp;gt; docs per doc? And would the original query results get &lt;br/&gt;
 &amp;gt; returned? What&apos;s the ordering? &lt;/p&gt;

&lt;p&gt;in your example, yes ... the users main search on &quot;apache&quot; would return 10 results sorted by whatever sort they specified.  for each of those 10 results, N similar results might me listed to the side (in a smaller font, or as a pop up widget) sorted most likely by how similar they are.  even if you don&apos;t want to surface those similar docs right there on the main result page, you still need to execute the MLT logic as part of hte initial request to know if there there are &lt;b&gt;any&lt;/b&gt; similar docs (so you can surface the link/button for displaying them to the user.&lt;/p&gt;

&lt;p&gt;I would even argue there is actually a third use case ... &lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;br/&gt;
Case 3)&lt;br/&gt;
  The GUI queries the standard request handler to display a list of documents, with a single subsequent list of similar &quot;mlt&quot; documents that have things in common with all of the docs in the current page of results displayed elsewhere on the page.&lt;br/&gt;
&amp;#8211;&lt;/p&gt;

&lt;p&gt;...where case #2 is about having separate MLT lists for each of hte matching reuslts, this case is about having a single &quot;if you are interested in &lt;b&gt;all&lt;/b&gt; of these items, you might also be interested in these other items&quot; list.&lt;/p&gt;

&lt;p&gt;case#1 and case#3 can both easily be satisfied with a single &quot;MoreLikeThisHandler&quot; which takes as it&apos;s input a generic query (ie: &quot;q=id:12345&quot; for case#1, and &quot;q=apache&quot; for case#3) and then generates a single &quot;tier 1&quot; result block of MLT results that relate to all of the docs matching that query (simpel case of 1 doc for case#1) ... all other &quot;tier 2&quot; data would be in regards to this main MLT result set.&lt;/p&gt;

&lt;p&gt;case#2 would still easily be handled by having some new &quot;tier 2&quot; MLT data added to the StandardRequestHandler.&lt;/p&gt;
</comment>
                            <comment id="12493805" author="ryantxu" created="Fri, 4 May 2007 22:27:29 +0100"  >&lt;p&gt;Refactored the MoreLikeThisRequestHandler so that it can support case #1, #2, #3&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;added faceting to the MoreLikeThisHandler&lt;/li&gt;
	&lt;li&gt;made it possible to remove the original match from the response.  This makes the response look the same as ones that come from /select&lt;/li&gt;
	&lt;li&gt;Added documentation to: &lt;a href=&quot;http://wiki.apache.org/solr/MoreLikeThis&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/solr/MoreLikeThis&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12497022" author="bwhitman" created="Fri, 18 May 2007 21:27:35 +0100"  >&lt;p&gt;Ryan, it seems the handler doesn&apos;t listen to the fl parameter either in the result section or the morelikethis section. It always returns everything.&lt;/p&gt;</comment>
                            <comment id="12497069" author="bwhitman" created="Fri, 18 May 2007 23:38:43 +0100"  >&lt;p&gt;Oof ryan, my apologies, I was running an older version of this patch. fl is listened to. This is an excellent job, btw, I love that you can hide the original response. &lt;/p&gt;</comment>
                            <comment id="12497178" author="bwhitman" created="Sat, 19 May 2007 21:39:52 +0100"  >&lt;p&gt;R, one useful feature would be mlt.fq=query, where query is a filter query, like type:book. Or since we&apos;re moving to a solo handler for mlt, just supporting fq would be good.&lt;/p&gt;

&lt;p&gt;like&lt;/p&gt;

&lt;p&gt;/mlt?q=id:BOOK01&amp;amp;mlt.fl=contents&amp;amp;fq=type:BOOK&lt;/p&gt;

&lt;p&gt;(Because in a single solr instance you&apos;ve got information about books &amp;amp; authors, and you only want the mlt results to be books.)&lt;/p&gt;</comment>
                            <comment id="12497283" author="bwhitman" created="Sun, 20 May 2007 20:28:39 +0100"  >&lt;p&gt;The mlt.exclude is similar to what I&apos;m looking for but an mlt.fq is generally more useful.&lt;/p&gt;

&lt;p&gt;Also, mlt.exclude does not seem to support more than a single term query, e.g.&lt;/p&gt;

&lt;p&gt;mlt.exclude=+type:AUTHOR +type:PUBLISHER&lt;/p&gt;

&lt;p&gt;still lets type:PUBLISHER through.&lt;/p&gt;
</comment>
                            <comment id="12497312" author="bwhitman" created="Mon, 21 May 2007 00:53:31 +0100"  >&lt;p&gt;Also (sorry to keep commenting on this!) asking for fl=score doesn&apos;t work, I get this:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.apache.solr.search.DocSlice$1.score(DocSlice.java:117)&lt;br/&gt;
	at org.apache.solr.request.XMLWriter.writeDocList(XMLWriter.java:369)&lt;br/&gt;
	at org.apache.solr.request.XMLWriter.writeVal(XMLWriter.java:408)&lt;br/&gt;
	at org.apache.solr.request.XMLWriter.writeResponse(XMLWriter.java:126)&lt;br/&gt;
	at org.apache.solr.request.XMLResponseWriter.write(XMLResponseWriter.java:35)&lt;br/&gt;
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:169)&lt;br/&gt;
	at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:70)&lt;br/&gt;
	at com.caucho.server.webapp.WebAppFilterChain.doFilter(WebAppFilterChain.java:173)&lt;br/&gt;
	at com.caucho.server.dispatch.ServletInvocation.service(ServletInvocation.java:229)&lt;br/&gt;
	at com.caucho.server.http.HttpRequest.handleRequest(HttpRequest.java:274)&lt;br/&gt;
	at com.caucho.server.port.TcpConnection.run(TcpConnection.java:511)&lt;br/&gt;
	at com.caucho.util.ThreadPool.runTasks(ThreadPool.java:520)&lt;br/&gt;
	at com.caucho.util.ThreadPool.run(ThreadPool.java:442)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;

&lt;p&gt;if I do a query like&lt;/p&gt;

&lt;p&gt;/mlt?q=id:100&amp;amp;mlt.fl=content&amp;amp;fl=content,score&lt;/p&gt;

&lt;p&gt;If I take out the score from the fl it doesn&apos;t NPE.&lt;/p&gt;
</comment>
                            <comment id="12497737" author="ryantxu" created="Tue, 22 May 2007 08:13:44 +0100"  >&lt;p&gt;Updating with a bunch of minor changes...&lt;/p&gt;

&lt;p&gt;1. Got rid of the &quot;exclude&quot; parameter and it is now using standard fq filters &lt;/p&gt;

&lt;p&gt;2. If only one field is specified, it uses the fields analizyer as Ken suggested in:&lt;br/&gt;
&lt;a href=&quot;http://www.nabble.com/MoreLikeThis-and-term-vectors---documentation-suggestion-tf3295459.html#a9188723&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/MoreLikeThis-and-term-vectors---documentation-suggestion-tf3295459.html#a9188723&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;3. set termVectors=&quot;true&quot; for &apos;cat&apos; in the example solrconfig.xml and added a comment describing &apos;termVectors&apos;&lt;/p&gt;

&lt;p&gt;4. Added standard debug info&lt;/p&gt;

&lt;p&gt;5. Fixed &apos;score&apos; issue &amp;#8211; it was squaking because the original match did not have a score field...&lt;/p&gt;

</comment>
                            <comment id="12499198" author="asnagy" created="Fri, 25 May 2007 19:33:29 +0100"  >&lt;p&gt;A really nice feature would be to allow for boosting for fields, for example:&lt;/p&gt;

&lt;p&gt;?q=id:1&amp;amp;mlt=true&amp;amp;mlt.fl=title^5,author^3,topic&lt;/p&gt;

&lt;p&gt;This would find items that are more similar to the title over the author, etc.&lt;/p&gt;</comment>
                            <comment id="12500259" author="ryantxu" created="Thu, 31 May 2007 00:21:17 +0100"  >&lt;p&gt;Updated patch to:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;use searcher.getSchema().getAnalyzer()&lt;/li&gt;
	&lt;li&gt;be able to find similar documents from posted text&lt;/li&gt;
	&lt;li&gt;be able to return the &quot;interesting terms&quot; used for the MLT query&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Andrew: about field boosting...  This handler uses the lucene contrib MoreLikeThis implementation &amp;#8211; that does not have a way to boost one field above another, If it did, we could easily add it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12500915" author="ryantxu" created="Sat, 2 Jun 2007 05:57:14 +0100"  >&lt;p&gt;added param: mlt.boost that calls mlt.setBoost() to boost the interesting terms (or not) this field is required if you want a real number returned with mlt.interestingTerms=details&lt;/p&gt;</comment>
                            <comment id="12579139" author="hossman" created="Sun, 16 Mar 2008 03:23:52 +0000"  >&lt;p&gt;This bug was modified as part of a bulk update using the criteria...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Marked &quot;Resolved&quot; and &quot;Fixed&quot;&lt;/li&gt;
	&lt;li&gt;Had no &quot;Fix Version&quot; versions&lt;/li&gt;
	&lt;li&gt;Was listed in the CHANGES.txt for 1.3 as of today 2008-03-15&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The Fix Version for all 29 issues found was set to 1.3, email notification was suppressed to prevent excessive email.&lt;/p&gt;

&lt;p&gt;For a list of all the issues modified, search jira comments for this (hopefully) unique string: batch20070315hossman1&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12358748" name="SOLR-69-MoreLikeThisRequestHandler.patch" size="22644" author="ryantxu" created="Sat, 2 Jun 2007 05:57:14 +0100"/>
                            <attachment id="12358584" name="SOLR-69-MoreLikeThisRequestHandler.patch" size="22459" author="ryantxu" created="Thu, 31 May 2007 00:21:17 +0100"/>
                            <attachment id="12357838" name="SOLR-69-MoreLikeThisRequestHandler.patch" size="14906" author="ryantxu" created="Tue, 22 May 2007 08:13:44 +0100"/>
                            <attachment id="12356808" name="SOLR-69-MoreLikeThisRequestHandler.patch" size="12281" author="ryantxu" created="Fri, 4 May 2007 22:27:29 +0100"/>
                            <attachment id="12356660" name="SOLR-69-MoreLikeThisRequestHandler.patch" size="8146" author="ryantxu" created="Wed, 2 May 2007 20:18:19 +0100"/>
                            <attachment id="12353612" name="SOLR-69.patch" size="10115" author="ryantxu" created="Mon, 19 Mar 2007 00:19:55 +0000"/>
                            <attachment id="12349002" name="SOLR-69.patch" size="9264" author="bdelacretaz" created="Tue, 16 Jan 2007 10:33:39 +0000"/>
                            <attachment id="12348998" name="SOLR-69.patch" size="9003" author="bdelacretaz" created="Tue, 16 Jan 2007 09:38:57 +0000"/>
                            <attachment id="12344594" name="SOLR-69.patch" size="8970" author="bdelacretaz" created="Wed, 8 Nov 2006 15:57:08 +0000"/>
                            <attachment id="12344595" name="lucene-queries-2.0.0.jar" size="23398" author="bdelacretaz" created="Wed, 8 Nov 2006 15:59:16 +0000"/>
                            <attachment id="12356659" name="lucene-queries-2.1.1-dev.jar" size="23741" author="ryantxu" created="Wed, 2 May 2007 20:18:19 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Nov 2006 17:39:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7513</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxtlb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21113</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>