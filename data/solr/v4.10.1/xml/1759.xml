<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:17:05 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-1759/SOLR-1759.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-1759] DIH $skipDoc issue</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1759</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I&apos;m using the version 1.4.0 of Solr and I&apos;m having some trouble with the DIH when I use the special command $skipDoc.&lt;/p&gt;

&lt;p&gt;After skipping a document to insert, the next one is not inserted in the proper way.&lt;/p&gt;


&lt;p&gt;My DIH configuration is quite complex so I&apos;ll try to explain myself with a simpler example:&lt;/p&gt;

&lt;p&gt;item table:&lt;br/&gt;
id 	name&lt;br/&gt;
1	aaa&lt;br/&gt;
2	bbb&lt;/p&gt;

&lt;p&gt;feature table:&lt;br/&gt;
Item_id	hidden&lt;br/&gt;
1		true&lt;br/&gt;
2 		false&lt;/p&gt;


&lt;p&gt;DIH conf:&lt;/p&gt;

&lt;p&gt;&amp;lt;document name=&quot;products&quot;&amp;gt;&lt;br/&gt;
	&amp;lt;entity name=&quot;item&quot; query=&quot;select * from item&quot;&amp;gt;&lt;br/&gt;
		&amp;lt;field column=&quot;ID&quot; name=&quot;id&quot; /&amp;gt;&lt;br/&gt;
		&amp;lt;field column=&quot;NAME&quot; name=&quot;name&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;entity name=&quot;feature&quot; query=&quot;select hidden from feature where item_id=&apos;$&lt;/p&gt;
{item.ID}
&lt;p&gt;&apos;&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;field name=&quot;$skipDoc&quot; column=&quot;hidden&quot; /&amp;gt;&lt;br/&gt;
		&amp;lt;/entity&amp;gt;&lt;br/&gt;
	&amp;lt;/entity&amp;gt;&lt;br/&gt;
&amp;lt;/document&amp;gt;&lt;/p&gt;


&lt;p&gt;The result I expected is that the record named &quot;bbb&quot; would be imported, but the result of my import case is that the other record (the &quot;aaa&quot;) has been inserted.&lt;/p&gt;


&lt;p&gt;I took a look to the DIH code and I found a possible problem that could cause this result. &lt;br/&gt;
In the DocBuilder class when a $skipDoc is detected, an exception is raised. After handling the exception another loop starts, without cleaning up the doc variable.&lt;br/&gt;
When the next record is read, the addFieldToDoc method can&apos;t fill the doc fields because they are already filled.&lt;/p&gt;

&lt;p&gt;To solve this problem I just clean up the doc variable when handling the exception.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12455419">SOLR-1759</key>
            <summary>DIH $skipDoc issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="noble.paul">Noble Paul</assignee>
                                    <reporter username="gimmy">Gian Marco Tagliani</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Feb 2010 11:27:43 +0000</created>
                <updated>Fri, 5 Feb 2010 11:51:57 +0000</updated>
                            <resolved>Fri, 5 Feb 2010 11:51:57 +0000</resolved>
                                    <version>1.4</version>
                                    <fixVersion>1.5</fixVersion>
                                    <component>contrib - DataImportHandler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12830063" author="gimmy" created="Fri, 5 Feb 2010 11:30:03 +0000"  >&lt;p&gt;I attached the patch with this tiny change&lt;/p&gt;</comment>
                            <comment id="12830070" author="noble.paul" created="Fri, 5 Feb 2010 11:51:57 +0000"  >&lt;p&gt;committed Revision: 906906&lt;br/&gt;
Thanks: Gian Marco Tagliani&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12434952" name="patch.txt" size="743" author="gimmy" created="Fri, 5 Feb 2010 11:30:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Feb 2010 11:51:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5697</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxjd3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19456</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>