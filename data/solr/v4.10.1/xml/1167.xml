<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:25:52 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-1167/SOLR-1167.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-1167] Support module xml config files using XInclude</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1167</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Current configuration files (schema and solrconfig) are monolithic which can make maintenance and reuse more difficult that it needs to be.  The XML standards include a feature to include content from external files.  This is described at &lt;a href=&quot;http://www.w3.org/TR/xinclude/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.w3.org/TR/xinclude/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This feature is to add support for XInclude features for XML configuration files.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12425418">SOLR-1167</key>
            <summary>Support module xml config files using XInclude</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gsingers">Grant Ingersoll</assignee>
                                    <reporter username="batalbot">Bryan Talbot</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 May 2009 06:54:31 +0100</created>
                <updated>Thu, 4 Mar 2010 10:54:37 +0000</updated>
                            <resolved>Thu, 1 Oct 2009 14:33:14 +0100</resolved>
                                    <version>1.4</version>
                                    <fixVersion>1.4</fixVersion>
                                        <due></due>
                            <votes>2</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="12710200" author="pwolanin" created="Sun, 17 May 2009 15:40:23 +0100"  >&lt;p&gt;I think you posted a sample snippet for solrconfig to the list - can you report here and possibly include in the patch a change to the sample schema or solrconfig that would demonstrate this feature?&lt;/p&gt;</comment>
                            <comment id="12710537" author="batalbot" created="Tue, 19 May 2009 00:22:33 +0100"  >&lt;p&gt;Support for xinclude will allow a few options to include xml (or non-xml) content from an external file.  The external file can be loaded from the file system or from any HTTP resource.&lt;/p&gt;

&lt;p&gt;Here are some examples:&lt;/p&gt;

&lt;p&gt;  &amp;lt;!-- include solrconfig_master.xml from the file system and generate an error if the file can&apos;t be found --&amp;gt;&lt;br/&gt;
  &amp;lt;xi:include href=&quot;solr/conf/solrconfig_master.xml&quot; xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;/&amp;gt;&lt;/p&gt;


&lt;p&gt;  &amp;lt;!-- include solrconfig_master.xml from an HTTP URL and ignore it if it&apos;s missing --&amp;gt;&lt;br/&gt;
  &amp;lt;xi:include href=&quot;http://localhost:8983/solr/admin/file/?file=replication_master.xml&quot; &lt;br/&gt;
                    xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;/xi:fallback/&amp;gt;&lt;br/&gt;
  &amp;lt;/xi:include&amp;gt;&lt;/p&gt;


&lt;p&gt;  &amp;lt;!-- include solrconfig_master.xml from the filesystem.  If it cannot be found, attempt&lt;br/&gt;
        to include solrconfig_slave.xml from the filesystem.  If neither file can be found, don&apos;t&lt;br/&gt;
        generate an error.&lt;br/&gt;
     --&amp;gt;&lt;br/&gt;
  &amp;lt;xi:include href=&quot;solr/conf/solrconfig_master.xml&quot; xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;xi:fallback&amp;gt;&lt;br/&gt;
      &amp;lt;xi:include href=&quot;solr/conf/solrconfig_slave.xml&quot; xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;xi:fallback/&amp;gt;&lt;br/&gt;
      &amp;lt;/xi:include&amp;gt;&lt;br/&gt;
    &amp;lt;/xi:fallback&amp;gt;&lt;br/&gt;
  &amp;lt;/xi:include&amp;gt;&lt;/p&gt;


&lt;p&gt;  &amp;lt;!-- attempt to include an optional file containing index options.  If the file can&apos;t be found, fall back to some&lt;br/&gt;
        default values.&lt;br/&gt;
   --&amp;gt;&lt;br/&gt;
  &amp;lt;xi:include href=&quot;solr/conf/solrconfig_indexOptions.xml&quot; xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;xi:fallback&amp;gt;&lt;br/&gt;
      &amp;lt;useCompoundFile&amp;gt;false&amp;lt;/useCompoundFile&amp;gt;&lt;br/&gt;
      &amp;lt;ramBufferSizeMB&amp;gt;32&amp;lt;/ramBufferSizeMB&amp;gt;&lt;br/&gt;
      &amp;lt;mergeFactor&amp;gt;10&amp;lt;/mergeFactor&amp;gt;&lt;br/&gt;
      &amp;lt;maxMergeDocs&amp;gt;2147483647&amp;lt;/maxMergeDocs&amp;gt;&lt;br/&gt;
      &amp;lt;maxFieldLength&amp;gt;10000&amp;lt;/maxFieldLength&amp;gt;&lt;br/&gt;
    &amp;lt;/xi:fallback&amp;gt;&lt;br/&gt;
  &amp;lt;/xi:include&amp;gt;&lt;/p&gt;


&lt;p&gt;I&apos;ll update the patch to include solrconfig_master.xml and solrconfig_slave.xml files if they are present in the solr/conf directory.  The inclusions are currently commented out and the resulting configuration is equivalent to the existing sample config.&lt;/p&gt;
</comment>
                            <comment id="12710539" author="batalbot" created="Tue, 19 May 2009 00:24:56 +0100"  >&lt;p&gt;Include changes to example solrconfig.xml to include master and slave settings from an external xml file.  The master file includes replication and dataimport handler definitions.&lt;/p&gt;

&lt;p&gt;The inclusions are commented out currently.&lt;/p&gt;</comment>
                            <comment id="12710551" author="jianhan" created="Tue, 19 May 2009 01:11:40 +0100"  >&lt;p&gt;It is good that we can now put certain configuration to a separate file with this change, but this does not seem to completely solve the problem raised in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1154&quot; title=&quot;allow specifying solr configuration file through system property to simplify deployment procedure in certain cases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1154&quot;&gt;SOLR-1154&lt;/a&gt;, and we still have to use the hack to disable master/slave if we use the same package for master and slave. Is there a way to conditionally include one file or another (rather than include the other if one is not available)?&lt;/p&gt;</comment>
                            <comment id="12710582" author="batalbot" created="Tue, 19 May 2009 02:41:24 +0100"  >&lt;p&gt;It can&apos;t conditionally include content, no.  That can be achieved in startup scripts easy enough though: if the &quot;-master&quot; flag is given then copy the correct file into place and include it, if the &quot;-slave&quot; flag is given then copy the slave file into place, etc.&lt;/p&gt;

&lt;p&gt;I believe we&apos;d need to write code to handle conditional inclusion.  The XInclude stuff works at the XML parser level which knows nothing of system and environment variables of course.&lt;/p&gt;

&lt;p&gt;-Bryan&lt;/p&gt;</comment>
                            <comment id="12721879" author="hossman" created="Fri, 19 Jun 2009 18:04:34 +0100"  >&lt;p&gt;I like the simplicity of the patch, and the use of an existing standard.  If I&apos;d realized that xinclude was supported by DocumentBuilderFactory i would have tried this a long time ago ... my only concern is how well supported this feature is in the various DBF impls out there.&lt;/p&gt;

&lt;p&gt;BTW: the redundent snippets in DataImporter.java and COnfig.java make me think we need to refactor a helper function for this somewhere in utils, but that&apos;s not a huge issue.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is there a way to conditionally include one file or another (rather than include the other if one is not available)?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Keep in mind that the problem can be inverted: instead of having a common solrconfig.xml file that conditionally includes master-snippet.xml or slave-snippet.xml based on some property, you can have unique solrconfig.xml files for the master and slave (in separate solr home dirs) which only contain the unique options and include the common chunks from other files .. then you can use solr.solr.home to drive which set of configs to use.&lt;/p&gt;</comment>
                            <comment id="12753186" author="batalbot" created="Wed, 9 Sep 2009 18:48:12 +0100"  >&lt;p&gt;What needs to happen to get this into 1.4 before the code freeze?&lt;/p&gt;</comment>
                            <comment id="12753191" author="markrmiller@gmail.com" created="Wed, 9 Sep 2009 19:01:29 +0100"  >&lt;p&gt;Could we:&lt;/p&gt;

&lt;p&gt;if setxincludeaware throws unsupported, load the dbf without that setting, and if contains an include, throw an exception saying its unsupported with the current impl your using? I think its fairly well supported in anything even semi recent.&lt;/p&gt;</comment>
                            <comment id="12753275" author="batalbot" created="Wed, 9 Sep 2009 22:36:44 +0100"  >&lt;p&gt;Allowing the creation of the DBF when setXIncludeAware throws an exception is easy enough.  Detecting that there are xinclude elements present seems much harder since that is all handled by the XML parser.  How about if a warning log message is generated if setXIncludeAware can&apos;t be set?&lt;/p&gt;</comment>
                            <comment id="12753772" author="batalbot" created="Thu, 10 Sep 2009 20:00:58 +0100"  >&lt;p&gt;Patch updated to apply cleanly to more recent trunk (r813098).  It also catches an exception if the setXIncludeAware(true) method is unsupported and allows the DBF to still be created.  A warning log is generated in this case: &quot;XML parser doesn&apos;t support XInclude option&quot;&lt;/p&gt;</comment>
                            <comment id="12753840" author="henrib" created="Thu, 10 Sep 2009 22:53:54 +0100"  >&lt;p&gt;Just a thought; wouldn&apos;it be possible to use system entities (as in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-712&quot; title=&quot;Support for relative path XML Entity Includes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-712&quot;&gt;&lt;del&gt;SOLR-712&lt;/del&gt;&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-646&quot; title=&quot;Configuration properties enhancements in solr.xml&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-646&quot;&gt;SOLR-646&lt;/a&gt;) to have variables resolution in entities and use those in the xi:include href ? &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;!DOCTYPE schema [
&amp;lt;!ENTITY myevar SYSTEM &lt;span class=&quot;code-quote&quot;&gt;&quot;solr:${myvar}&quot;&lt;/span&gt;&amp;gt;
]&amp;gt;
...
&amp;lt;xi:include href=&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;myevar;&quot;&lt;/span&gt;.../&amp;gt;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This would allow include of files using variables using standards without reverting the inclusion logic.&lt;/p&gt;

&lt;p&gt;In any case, thanks Bryan for pushing this.&lt;/p&gt;</comment>
                            <comment id="12759688" author="batalbot" created="Fri, 25 Sep 2009 19:41:31 +0100"  >&lt;p&gt;The patch is for the trunk, currently 1.4 &lt;/p&gt;</comment>
                            <comment id="12760246" author="gsingers" created="Mon, 28 Sep 2009 14:51:21 +0100"  >&lt;p&gt;Patch looks fine, just not sure that we should add this into the example since it just adds more files to an already.  Perhaps just some comments and some writeup on the wiki in the SolrConfig page?&lt;/p&gt;</comment>
                            <comment id="12760433" author="batalbot" created="Tue, 29 Sep 2009 00:25:17 +0100"  >&lt;p&gt;I agree that the examples should be simple (yet functional) and this does complicate them.  I added changes to the configuration because a previous commented requested it.  I think changing the sample solrconfig to mention support for XInclude and document examples on the wiki is better for new users too.&lt;/p&gt;

&lt;p&gt;Should I change the patch to remove the changes to the sample solrconfig and only include a comment about XInclude support?&lt;/p&gt;</comment>
                            <comment id="12760573" author="gsingers" created="Tue, 29 Sep 2009 13:23:12 +0100"  >&lt;p&gt;That would be my vote.  If you can do that, I&apos;ll take a look today.&lt;/p&gt;</comment>
                            <comment id="12760654" author="batalbot" created="Tue, 29 Sep 2009 18:28:41 +0100"  >&lt;p&gt;Updated patch to only add a comment to solrconfig.xml which refers to the wiki SolrConfigXml page for configuration options.  The wiki can then be updated to include details about using XInclude once it&apos;s available.&lt;/p&gt;</comment>
                            <comment id="12760836" author="hossman" created="Wed, 30 Sep 2009 06:08:26 +0100"  >
&lt;blockquote&gt;&lt;p&gt;Detecting that there are xinclude elements present seems much harder since that is all handled by the XML parser. How about if a warning log message is generated if setXIncludeAware can&apos;t be set?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It occured to me that setNamespaceAware(true) has no documented failure case - every DBF implementation is suppose to support it.   So as long as the DocumentBuilder is namespace aware, then if setXIncludeAware(true) fails, we could (in theory) inspect the resulting DOM Document to see if there are any &quot;&lt;/p&gt;
{http://www.w3.org/2001/XInclude}
&lt;p&gt;include&quot; nodes in the document &amp;#8211; if there are then the config was expecting XInclude support and we can fail with a hard error, if not then they didn&apos;t care about XInclude support anyway, so no need to log a warning if it&apos;s not supported&lt;/p&gt;

&lt;p&gt;(I&apos;m just throwing this out there as an idea &amp;#8211; if someone wants to try implementing it then great, but  i don&apos;t think it should be a roadblock for the existing patch, because honestly: as long as we document that XInclude depends on XML parser support, then if people add XIncludes to their configs, but don&apos;t test to verify that it&apos;s working in environment they&apos;re on their own and i won&apos;t feel bad if something fails silently)&lt;/p&gt;</comment>
                            <comment id="12761157" author="gsingers" created="Thu, 1 Oct 2009 11:24:48 +0100"  >&lt;p&gt;Added a test for this.  I&apos;m not sure if it is the right way to go.  I don&apos;t want the test to fail if the person running it doesn&apos;t have a DocumentBuilder that supports it, b/c that wouldn&apos;t fail in the live case either.&lt;/p&gt;

&lt;p&gt;Thoughts?  I&apos;d like to close this one out.&lt;/p&gt;</comment>
                            <comment id="12761160" author="shalinmangar" created="Thu, 1 Oct 2009 11:43:47 +0100"  >&lt;p&gt;Bryan, I&apos;m not sure if you have followed recent developments. Now it is possible to add a enable attribute to any solr plugin and value of the enable attribute can be driven from an external properties file. With this you don&apos;t need separate solrconfig.xml files for master/slave. This is the approach we are using. Was that the original use-case behind this feature?&lt;/p&gt;</comment>
                            <comment id="12761162" author="gsingers" created="Thu, 1 Oct 2009 11:51:48 +0100"  >&lt;p&gt;I still think it is useful to be able to use XInclude. &lt;/p&gt;</comment>
                            <comment id="12761214" author="gsingers" created="Thu, 1 Oct 2009 14:32:51 +0100"  >&lt;p&gt;Committed revision 820652.&lt;/p&gt;

&lt;p&gt;Bryan, can you update the Wiki?&lt;/p&gt;</comment>
                            <comment id="12775743" author="gsingers" created="Tue, 10 Nov 2009 15:52:05 +0000"  >&lt;p&gt;Bulk close for Solr 1.4&lt;/p&gt;</comment>
                            <comment id="12841178" author="peathal" created="Thu, 4 Mar 2010 10:54:37 +0000"  >&lt;p&gt;@Shalin Shekhar Mangar: how can I use the proposed attribute feature to be used for master+slave configuration? Do you have a code snippet?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12443314">SOLR-1656</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12400757">SOLR-646</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12420998" name="SOLR-1167.patch" size="23405" author="gsingers" created="Thu, 1 Oct 2009 11:24:47 +0100"/>
                            <attachment id="12420810" name="SOLR-1167.patch" size="2665" author="batalbot" created="Tue, 29 Sep 2009 18:28:41 +0100"/>
                            <attachment id="12419209" name="SOLR-1167.patch" size="5479" author="batalbot" created="Thu, 10 Sep 2009 20:00:58 +0100"/>
                            <attachment id="12408420" name="SOLR-1167.patch" size="5116" author="batalbot" created="Tue, 19 May 2009 00:24:56 +0100"/>
                            <attachment id="12408106" name="SOLR-1167.patch" size="1709" author="batalbot" created="Thu, 14 May 2009 06:57:16 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 17 May 2009 14:40:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6477</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxmw7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20028</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>