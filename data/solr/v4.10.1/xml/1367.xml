<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:19:42 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-1367/SOLR-1367.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-1367] Provide Callback mechanism for SolrPluginUtils.docListToSolrDocumentList</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1367</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Sometimes SearchComponents need to modify the DocList.  Often times this requires two loops over the (Solr)DocList: once to convert the DocList to SolrDocList and then once to iterate the SolrDocList for the Search Component.  This can be seen in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-773&quot; title=&quot;Incorporate Local Lucene/Solr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-773&quot;&gt;&lt;del&gt;SOLR-773&lt;/del&gt;&lt;/a&gt;, for example.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12433327">SOLR-1367</key>
            <summary>Provide Callback mechanism for SolrPluginUtils.docListToSolrDocumentList</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="gsingers">Grant Ingersoll</assignee>
                                    <reporter username="gsingers">Grant Ingersoll</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Aug 2009 13:49:27 +0100</created>
                <updated>Tue, 10 Nov 2009 15:52:13 +0000</updated>
                            <resolved>Wed, 19 Aug 2009 17:23:56 +0100</resolved>
                                                    <fixVersion>1.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12744493" author="gsingers" created="Tue, 18 Aug 2009 14:16:01 +0100"  >&lt;p&gt;Simple fix for this.  Marked the interface as changeable pending some other fixes later.&lt;/p&gt;</comment>
                            <comment id="12744636" author="gsingers" created="Tue, 18 Aug 2009 19:29:30 +0100"  >&lt;p&gt;Committed revision 805528.&lt;/p&gt;</comment>
                            <comment id="12744748" author="yseeley@gmail.com" created="Tue, 18 Aug 2009 23:02:47 +0100"  >&lt;p&gt;I&apos;m puzzled wondering why this is an improvement.&lt;/p&gt;

&lt;p&gt;New:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SolrDocumentList sdocs = docListToSolrDocumentList(dlist,..., 
  &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SolrDocumentModifier() {
    void process(SolrDocument doc) {
      doc.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;,1);
    }
  }, 
...);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Old:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SolrDocumentList sdocs = docListToSolrDocumentList(dlist,...,...);
&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (SolrDocument doc : sdocs) {
  d.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;,1);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12744784" author="gsingers" created="Wed, 19 Aug 2009 00:48:43 +0100"  >&lt;p&gt;B/c docListToSolrDocList also requires looping over the DocList.  So, in the old case, you&apos;ve iterated the DocList twice.  In the new way, you only iterated it once.&lt;/p&gt;</comment>
                            <comment id="12744788" author="yseeley@gmail.com" created="Wed, 19 Aug 2009 00:59:55 +0100"  >&lt;p&gt;It seems in this case that iteration is more straight-forward and easier to understand, and offers the same performance.&lt;/p&gt;</comment>
                            <comment id="12744818" author="gsingers" created="Wed, 19 Aug 2009 01:59:40 +0100"  >&lt;p&gt;What&apos;s hard to understand about a callback mechanism?  It&apos;s akin to FileFilter for File.listFiles or similar things.&lt;/p&gt;

&lt;p&gt;Also, why would two loops over the same list be the same performance as one?  I suppose in the rows=10 or so case, it is in the noise, but, but if someone were getting deeper results than say 10,  the Modifier approach would be faster.  Now multiply the need to do this for every query and I think it would add up.&lt;/p&gt;

&lt;p&gt;The whole use case is very much a special case.  Most people in most situations don&apos;t need to do this.  But when you do need to do it, you do it all the time and you want it to be fast.  That being said, people can implement it themselves.  I just figured since the docListToSolrDocList method was already there, it would be a time saver.&lt;/p&gt;</comment>
                            <comment id="12744826" author="yseeley@gmail.com" created="Wed, 19 Aug 2009 02:17:40 +0100"  >&lt;blockquote&gt;&lt;p&gt;What&apos;s hard to understand about a callback mechanism?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Callbacks are useful when you need to execute your own snippet of code in a different context - that&apos;s not the case here.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Also, why would two loops over the same list be the same performance as one?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Because the iteration part is irrelevant compared to what else is done during the iteration.  Iteration can be as simple as a pointer dereference.  The callback approach has null pointer check whether to invoke the modifier or not... and that gets done even if no modifier will be used (but that will also be in the noise).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Now multiply the need to do this for every query and I think it would add up.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It won&apos;t - it won&apos;t even be measurable.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The whole use case is very much a special case. Most people in most situations don&apos;t need to do this. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Which would seem to argue against adding code to try and do it.&lt;/p&gt;

&lt;p&gt;That said, docListToSolrDocList isn&apos;t even used in Solr anywhere, so I don&apos;t care too much - it can be deprecated/removed later.  Solr itself shouldn&apos;t use this method since it&apos;s not streamable.  Allowing custom modifications while preserving streamability &lt;b&gt;does&lt;/b&gt; call for callbacks... but not in 1.4&lt;/p&gt;</comment>
                            <comment id="12745013" author="gsingers" created="Wed, 19 Aug 2009 12:51:56 +0100"  >&lt;blockquote&gt;&lt;p&gt;That said, docListToSolrDocList isn&apos;t even used in Solr anywhere, so I don&apos;t care too much - it can be deprecated/removed later. Solr itself shouldn&apos;t use this method since it&apos;s not streamable. Allowing custom modifications while preserving streamability does call for callbacks... but not in 1.4&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right, it is likely used by a very small subset of people who:  write their own SearchComp and modify the doclist.  LocalSolr is one such case.  If you look at PJ&apos;s patch on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-773&quot; title=&quot;Incorporate Local Lucene/Solr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-773&quot;&gt;&lt;del&gt;SOLR-773&lt;/del&gt;&lt;/a&gt;, you will see it in use.  I think Ryan put it in, so he may have use case for it too.  It is &lt;em&gt;definitely&lt;/em&gt; not needed by Solr itself.  The modifier thing is also likely a temp fix until pseudo-fields and pluggable doc stores are in place.&lt;/p&gt;</comment>
                            <comment id="12745019" author="ehatcher" created="Wed, 19 Aug 2009 13:01:48 +0100"  >&lt;p&gt;My opinion on this... this code should not be included in Solr yet.  It can easily be added as custom utility or just a couple of lines of code into custom components.  Until the components that need such utilities are added to Solr and until we agree on a cleaner way to add metadata to a document, I vote we revert this and not include it in Solr 1.4.&lt;/p&gt;</comment>
                            <comment id="12745020" author="ehatcher" created="Wed, 19 Aug 2009 13:02:32 +0100"  >&lt;p&gt;Reopened to consider reverting.&lt;/p&gt;</comment>
                            <comment id="12745024" author="gsingers" created="Wed, 19 Aug 2009 13:07:58 +0100"  >&lt;p&gt;Just because something isn&apos;t used internally by Solr, doesn&apos;t mean it isn&apos;t useful to Solr users.  Why have Solr users write the same thing over and over again?  It is perfectly reasonable for Solr to provide end user APIs.&lt;/p&gt;</comment>
                            <comment id="12745029" author="ehatcher" created="Wed, 19 Aug 2009 13:16:07 +0100"  >&lt;p&gt;Just because it is useful in one situation does not mean it should be something the Solr committers must maintain either.  I&apos;m not convinced that adding fields to a document (in this way) is the right way to add metadata to the response, personally.  I&apos;m only one opinion out there though, but I&apos;m -0.5 on this being in Solr 1.4. &lt;/p&gt;</comment>
                            <comment id="12745032" author="noble.paul" created="Wed, 19 Aug 2009 13:29:56 +0100"  >&lt;p&gt;IMHO  the performance improvement is almost none with this enhancement. And it is cleaner the old way.&lt;/p&gt;</comment>
                            <comment id="12745091" author="gsingers" created="Wed, 19 Aug 2009 16:54:05 +0100"  >&lt;p&gt;OK, I will revert.&lt;/p&gt;</comment>
                            <comment id="12745104" author="gsingers" created="Wed, 19 Aug 2009 17:23:56 +0100"  >&lt;p&gt;Reverted&lt;/p&gt;</comment>
                            <comment id="12775844" author="gsingers" created="Tue, 10 Nov 2009 15:52:13 +0000"  >&lt;p&gt;Bulk close for Solr 1.4&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12416871" name="SOLR-1367.patch" size="8383" author="gsingers" created="Tue, 18 Aug 2009 14:16:01 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Aug 2009 22:02:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6284</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxlov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19833</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>