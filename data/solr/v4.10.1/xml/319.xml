<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:21:34 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-319/SOLR-319.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-319] changes SynonymFilterFactory to &quot;Analyze&quot; synonyms file</title>
                <link>https://issues.apache.org/jira/browse/SOLR-319</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;WHAT:&lt;br/&gt;
Currently, SynonymFilterFactory works very well with N-gram tokenizer (CJKTokenizer, for example).&lt;br/&gt;
But we have to take care of the statement in synonyms.txt.&lt;br/&gt;
For example, if I use CJKTokenizer (work as bi-gram for CJK chars) and want C1C2C3 maps to C4C5C6,&lt;br/&gt;
I have to write the rule as follows:&lt;/p&gt;

&lt;p&gt;C1C2 C2C3 =&amp;gt; C4C5 C5C6&lt;/p&gt;

&lt;p&gt;But I want to write it &quot;C1C2C3=&amp;gt;C4C5C6&quot;. This patch allows it. It is also helpful for sharing synonyms.txt.&lt;/p&gt;

&lt;p&gt;HOW:&lt;br/&gt;
tokenFactory attribute is added to &amp;lt;filter class=&quot;solr.SynonymFilterFactory&quot;/&amp;gt;.&lt;br/&gt;
If the attribute is specified, SynonymFilterFactory uses the TokenizerFactory to create Tokenizer.&lt;br/&gt;
Then SynonymFilterFactory uses the Tokenizer to get tokens from the rules in synonyms.txt file.&lt;/p&gt;

&lt;p&gt;sample-1: CJKTokenizer&lt;/p&gt;

&lt;p&gt;    &amp;lt;fieldtype name=&quot;text_cjk&quot; class=&quot;solr.TextField&quot; positionIncrementGap=&quot;100&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;analyzer type=&quot;index&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;tokenizer class=&quot;solr.CJKTokenizerFactory&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;filter class=&quot;solr.SynonymFilterFactory&quot; synonyms=&quot;ngram_synonym_test_ja.txt&quot;&lt;br/&gt;
        		ignoreCase=&quot;true&quot; expand=&quot;true&quot; tokenFactory=&quot;solr.CJKTokenizerFactory&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;filter class=&quot;solr.LowerCaseFilterFactory&quot;/&amp;gt;&lt;br/&gt;
      &amp;lt;/analyzer&amp;gt;&lt;br/&gt;
      &amp;lt;analyzer type=&quot;query&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;tokenizer class=&quot;solr.CJKTokenizerFactory&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;filter class=&quot;solr.LowerCaseFilterFactory&quot;/&amp;gt;&lt;br/&gt;
      &amp;lt;/analyzer&amp;gt;&lt;br/&gt;
    &amp;lt;/fieldtype&amp;gt;&lt;/p&gt;

&lt;p&gt;sample-2: NGramTokenizer&lt;/p&gt;

&lt;p&gt;    &amp;lt;fieldtype name=&quot;text_ngram&quot; class=&quot;solr.TextField&quot; positionIncrementGap=&quot;100&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;analyzer type=&quot;index&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;tokenizer class=&quot;solr.NGramTokenizerFactory&quot; minGramSize=&quot;2&quot; maxGramSize=&quot;2&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;filter class=&quot;solr.LowerCaseFilterFactory&quot;/&amp;gt;&lt;br/&gt;
      &amp;lt;/analyzer&amp;gt;&lt;br/&gt;
      &amp;lt;analyzer type=&quot;query&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;tokenizer class=&quot;solr.NGramTokenizerFactory&quot; minGramSize=&quot;2&quot; maxGramSize=&quot;2&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;filter class=&quot;solr.SynonymFilterFactory&quot; synonyms=&quot;ngram_synonym_test_ngram.txt&quot;&lt;br/&gt;
        		ignoreCase=&quot;true&quot; expand=&quot;true&quot;&lt;br/&gt;
        		tokenFactory=&quot;solr.NGramTokenizerFactory&quot; minGramSize=&quot;2&quot; maxGramSize=&quot;2&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;filter class=&quot;solr.LowerCaseFilterFactory&quot;/&amp;gt;&lt;br/&gt;
      &amp;lt;/analyzer&amp;gt;&lt;br/&gt;
    &amp;lt;/fieldtype&amp;gt;&lt;/p&gt;

&lt;p&gt;backward compatibility:&lt;br/&gt;
Yes. If you omit tokenFactory attribute from &amp;lt;filter class=&quot;solr.SynonymFilterFactory&quot;/&amp;gt; tag, it works as usual.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12374601">SOLR-319</key>
            <summary>changes SynonymFilterFactory to &quot;Analyze&quot; synonyms file</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="koji">Koji Sekiguchi</assignee>
                                    <reporter username="koji">Koji Sekiguchi</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jul 2007 04:04:10 +0100</created>
                <updated>Fri, 10 May 2013 11:41:02 +0100</updated>
                            <resolved>Mon, 19 May 2008 14:40:18 +0100</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>2</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12515484" author="koji" created="Thu, 26 Jul 2007 04:06:40 +0100"  >&lt;p&gt;The patch includes TestSynonymMap. To test SynonymMap, I removed &quot;private&quot; declaration from parseRules() method.&lt;br/&gt;
This patch includes CJKTokenizerFactory, too.&lt;/p&gt;</comment>
                            <comment id="12519360" author="koji" created="Mon, 13 Aug 2007 03:01:09 +0100"  >&lt;p&gt;In addition, this is useful for non-N-gram tokenizers for CJK users. For example, we use SenTokenizer, which is a popular morphological analyzer in Japan. It uses a Japanese dictionary to determine morpheme boundaries.&lt;/p&gt;

&lt;p&gt;If I have the following definition in schema.xml:&lt;/p&gt;

&lt;p&gt;&amp;lt;tokenizer class=&quot;solr.SenTokenizerFactory&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;filter class=&quot;solr.SynonymFilterFactory&quot; synonyms=&quot;synonyms.txt&quot; ignoreCase=&quot;true&quot; expand=&quot;true&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;and I want a map rule &quot;C1C2C3=&amp;gt;C4C5&quot;. I&apos;m sure &quot;C1C2C3&quot; is a word, so I write the rule in synonyms.txt as follows:&lt;/p&gt;

&lt;p&gt;C1C2C3=&amp;gt;C4C5&lt;/p&gt;

&lt;p&gt;however, if there isn&apos;t &quot;C1C2C3&quot; in SenTokenizer&apos;s dictionary but &quot;C1C2&quot; and &quot;C3&quot; are there, SenTokenizer will output &quot;C1C2&quot; and &quot;C3&quot;. In this case, the above rule doesn&apos;t work.&lt;/p&gt;

&lt;p&gt;The patch solves this problem, in addition, it encourages sharing synonyms.txt file between N-gram and morphological tokenizer.&lt;/p&gt;</comment>
                            <comment id="12526975" author="koji" created="Thu, 13 Sep 2007 03:47:35 +0100"  >&lt;p&gt;1. updated for current trunk (r575145)&lt;br/&gt;
2. eliminate testCJKTokenizer() test method, which includes Japanese chars to test CJK bi-gram&lt;/p&gt;

&lt;p&gt;comments are welcome.&lt;/p&gt;</comment>
                            <comment id="12527668" author="hossman" created="Sat, 15 Sep 2007 01:59:33 +0100"  >&lt;p&gt;I&apos;ve revised the summary line of this bug because it was a little confusing to me ... the issue isn&apos;t really specific to n-gram based tokenizers, as you point out this is a general issue that currently when constructing the synonyms file you have to be very aware of the analysis chain of your fieldtype &amp;#8211; ie: if LowercaseFilterFactory comes before SynonymFilterFactory, then all synonyms must be lowercased in your file.&lt;/p&gt;

&lt;p&gt;The notion of specifying a TokenizerFactory as a property of the SynonymFilterFactory that tells it how to parse the synonymstxt file is pretyt clever, and would solve the  CJKTokenizer problem you describe, but i don&apos;t think it really goes far enough &amp;#8211; consider the lowercase example.  it would be good if you could have a synonyms file that contained proper names, and have it do the right thing when used in lower cased fields as well as exact case fields.&lt;/p&gt;

&lt;p&gt;to extend the tokenizer idea &amp;#8211; what if you could specify the name of a fieldtype, and the entire Analyzer for that fieldtype would be used to parse the individual synonym records?  this should simplify the patch a bit (since you don&apos;t have to worry about initializing any factories,  the schema will take care of it for you) and make it a lot more powerful.&lt;/p&gt;</comment>
                            <comment id="12527682" author="koji" created="Sat, 15 Sep 2007 03:27:50 +0100"  >&lt;p&gt;Absolutely. I&apos;ll try to change my patch to implement the fieldtype idea. Thank you.&lt;/p&gt;</comment>
                            <comment id="12527747" author="koji" created="Sat, 15 Sep 2007 16:09:33 +0100"  >&lt;p&gt;I think I cannot implement &quot;fieldtype version&quot; of this issue, because when Solr is initializing SynonymFilterFactory, Solr is in IndexSchema initialization step. Am I wrong?&lt;/p&gt;</comment>
                            <comment id="12527795" author="hossman" created="Sat, 15 Sep 2007 23:52:39 +0100"  >&lt;p&gt;I haven&apos;t thought it out all hte way, but it should be possible.  we only have to remember the name of the fieldtype in SynonymFilterFactory.init ... then in the create method we can call schema.getFieldTypes().get(fieldtypename).&lt;/p&gt;

&lt;p&gt;Hmmm... except we probably don&apos;t have any access to the schema at that point do we?&lt;/p&gt;

&lt;p&gt;Hmmm....  i&apos;m not sure what the best way to do this would be.  we could just go get the schema from the SolrCore &amp;#8211; except we&apos;re moving away from it being a singleton and we dn&apos;t have direct access to it either.&lt;/p&gt;

&lt;p&gt;anyone have any other suggestions?&lt;/p&gt;
</comment>
                            <comment id="12527867" author="yseeley@gmail.com" created="Sun, 16 Sep 2007 16:05:02 +0100"  >&lt;p&gt;&amp;gt; ie: if LowercaseFilterFactory comes before SynonymFilterFactory, then all synonyms must be lowercased in your file.&lt;/p&gt;

&lt;p&gt;You can specify ignoreCase=&quot;true&quot;&lt;/p&gt;</comment>
                            <comment id="12528149" author="hossman" created="Mon, 17 Sep 2007 21:37:39 +0100"  >&lt;p&gt;&amp;gt; You can specify ignoreCase=&quot;true&quot;&lt;/p&gt;

&lt;p&gt;doh! ... right, bad example ... but the spirit of my point is still true: there may be other things happening in your analysis chain (besides just tokenization) that you&apos;d like to have happen to your synonyms as well, so that you:&lt;br/&gt;
  1) can reuse the synonyms file in multiple field types&lt;br/&gt;
  2) don&apos;t need to change your synonyms file just because you changed your analysis configuration.&lt;/p&gt;</comment>
                            <comment id="12528150" author="yseeley@gmail.com" created="Mon, 17 Sep 2007 21:44:16 +0100"  >&lt;p&gt;&amp;gt; there may be other things happening in your analysis chain (besides just tokenization)&lt;/p&gt;

&lt;p&gt;I was trying to come up with realistic examples, but the only useful ones I could think of involve tokenization...&lt;br/&gt;
Example: if you have a.b =&amp;gt; c.d and switch from a whitespace tokenizer to a letter tokenizer.&lt;/p&gt;</comment>
                            <comment id="12528151" author="hossman" created="Mon, 17 Sep 2007 21:50:23 +0100"  >&lt;p&gt;&amp;gt; I was trying to come up with realistic examples, but the only useful ones I could think of involve tokenization...&lt;/p&gt;

&lt;p&gt;maybe, but with things like the PatternReplaceTokenFilter &quot;tokenization&quot; sometimes happens after the Tokenizer is done.&lt;/p&gt;</comment>
                            <comment id="12529317" author="koji" created="Fri, 21 Sep 2007 07:35:43 +0100"  >&lt;p&gt;Hoss, Yonik, thank you very much for your opinion.&lt;/p&gt;

&lt;p&gt;As for now, SynonymFilterFactory implicitly uses WhitespaceTokenizer when analyzing synonyms.txt file.&lt;br/&gt;
This works well for English and European languages, those use spaces to separate words.&lt;br/&gt;
But from standpoint of CJK users, we would like to replace the implicit tokenizer by an arbitrary tokenizer.&lt;br/&gt;
I thought that fieldtype could be specified to analyze synonyms.txt was a cool idea,&lt;br/&gt;
but it was difficult because IndexSchema hasn&apos;t been initialized at that time.&lt;/p&gt;

&lt;p&gt;For CJK users, replacing tokenizer is enough for their purpose and fieldtype is overmuch...&lt;/p&gt;</comment>
                            <comment id="12545366" author="koji" created="Mon, 26 Nov 2007 09:04:17 +0000"  >&lt;p&gt;updated for current trunk (r597847).&lt;/p&gt;</comment>
                            <comment id="12548502" author="hossman" created="Wed, 5 Dec 2007 01:52:41 +0000"  >&lt;p&gt;FWIW: after rereading my earlier comments, i think the best thing to do (for now at least) is to go with the simplest approach that achieves the goal: do what was done in the orriginal path, and just refer to the tokenizer factory class directly (which can be instantiated using the ResourceLoader) instead of refering to a fieldType name like i suggested.&lt;/p&gt;

&lt;p&gt;(see also &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-414&quot; title=&quot;Coherent plugin initialization strategy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-414&quot;&gt;&lt;del&gt;SOLR-414&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12549283" author="koji" created="Fri, 7 Dec 2007 02:24:35 +0000"  >&lt;p&gt;Thank you for your comment, Hoss. The latest attached patch uses tokenizer factory to get tokenizer.&lt;br/&gt;
There seems to be no objections. Any chance to get this into svn soon? A few users in Japan uses this feature (Solr 1.2, though) and works perfectly. We would like to share the feature with CJK users, hopefully out of the box.&lt;/p&gt;</comment>
                            <comment id="12562870" author="koji" created="Sat, 26 Jan 2008 15:16:31 +0000"  >&lt;p&gt;updated for current trunk (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-466&quot; title=&quot;Update SynonymFilter to new Token APIs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-466&quot;&gt;&lt;del&gt;SOLR-466&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="12562871" author="yseeley@gmail.com" created="Sat, 26 Jan 2008 15:25:42 +0000"  >&lt;p&gt;Perhaps it should be a full analyzer rather than just a tokenizer?&lt;br/&gt;
In the query elevation (query boosting) component, a field type can be specified, and the analyzer from that is used.&lt;/p&gt;

&lt;p&gt;Oh, I just saw that Hoss already brought up that idea long ago...&lt;/p&gt;</comment>
                            <comment id="12596938" author="otis" created="Wed, 14 May 2008 21:51:23 +0100"  >&lt;p&gt;I think this patch is ripe for a commit.  Koji, want to commit your own baby? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12596989" author="koji" created="Thu, 15 May 2008 02:26:54 +0100"  >&lt;p&gt;Thanks, Otis. I will commit this in a week if there is no objection.&lt;br/&gt;
BTW, I cannot assign myself on JIRA... looks like I have no permission?&lt;/p&gt;</comment>
                            <comment id="12597952" author="koji" created="Mon, 19 May 2008 14:40:18 +0100"  >&lt;p&gt;All test pass.&lt;br/&gt;
Committed revision 657829.&lt;/p&gt;</comment>
                            <comment id="13025361" author="otis" created="Tue, 26 Apr 2011 19:21:40 +0100"  >&lt;p&gt;Btw., I noticed this functionality is really pretty well hidden!  It may be good to at least add it to:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;one of the example schema.xml files (commented out)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.SynonymFilterFactory&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.SynonymFilterFactory&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12374121" name="SOLR-319.patch" size="15141" author="koji" created="Sat, 26 Jan 2008 15:16:31 +0000"/>
                            <attachment id="12370183" name="SOLR-319.patch" size="15448" author="koji" created="Mon, 26 Nov 2007 09:04:17 +0000"/>
                            <attachment id="12365685" name="SOLR-319.patch" size="17063" author="koji" created="Thu, 13 Sep 2007 03:47:35 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 15 Sep 2007 00:59:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7272</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxs27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20865</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>