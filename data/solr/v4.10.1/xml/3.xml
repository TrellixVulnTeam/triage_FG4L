<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:21:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-3/SOLR-3.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-3] create test harness and port TestApp to junit</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;To both encourage good internal development, and to make it easy for plugin developers to write unit tests of their own code I think we need a harness that makes it easy to unit test updates and queries against Solr (without needing a servlet container)&lt;/p&gt;

&lt;p&gt;Once we have this, i think we can/should also retire &quot;TestApp&quot; in favor of some JUnit tests (which would probably make more sense for other developers)&lt;/p&gt;


&lt;p&gt;Iv&apos;e already started on this, i thought i&apos;d have something to commit tonight, but i got distracted ... filing this bug as a tracker for now.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12329809">SOLR-3</key>
            <summary>create test harness and port TestApp to junit</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Hoss Man</assignee>
                                    <reporter username="hossman">Hoss Man</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Mar 2006 16:28:19 +0000</created>
                <updated>Fri, 10 May 2013 11:38:39 +0100</updated>
                            <resolved>Wed, 29 Nov 2006 19:00:29 +0000</resolved>
                                                    <fixVersion>1.1.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                            <comments>
                            <comment id="12370124" author="hossman" created="Mon, 13 Mar 2006 15:37:52 +0000"  >&lt;p&gt;Here&apos;s what i&apos;ve got so far, still a work in progress &amp;#8211; but you can see the basic idea.&lt;/p&gt;

&lt;p&gt;I was trying to avoid putting anything junit specific in the TestHarness, but it definitely looks like having an abstract subclass of TestCase that provides some assert methods that can take in adds or requests/xpaths and validate directly would make hte tests easier to read.&lt;/p&gt;

&lt;p&gt;Any comments would be appreacited.&lt;/p&gt;</comment>
                            <comment id="12370211" author="yseeley@gmail.com" created="Tue, 14 Mar 2006 01:22:11 +0000"  >&lt;p&gt;Looking good Hoss!&lt;/p&gt;

&lt;p&gt;There are probably some opportunities to use Java5 stuff like varargs...&lt;br/&gt;
  doc(&quot;id&quot;,42,&quot;subject&quot;,&quot;easy&quot;)&lt;/p&gt;

&lt;p&gt;Also what we really need is a way to dynamically add/create a schema, so one could add a new analysis filter,&lt;br/&gt;
then define a fieldtype &amp;amp; field that uses it and test it out, without modifying some global testing schema. &lt;/p&gt;</comment>
                            <comment id="12370218" author="hossman" created="Tue, 14 Mar 2006 02:34:27 +0000"  >&lt;p&gt;&amp;gt;There are probably some opportunities to use Java5 stuff like varargs...&lt;br/&gt;
&amp;gt;  doc(&quot;id&quot;,42,&quot;subject&quot;,&quot;easy&quot;)&lt;/p&gt;

&lt;p&gt;...i&apos;m doing that in validateAddDoc (which calls makeSimpleDoc) ... are there other methods you think it also makes sense for?&lt;/p&gt;

&lt;p&gt;&amp;gt; Also what we really need is a way to dynamically add/create a schema, so one could add&lt;br/&gt;
&amp;gt; a new analysis filter,&lt;br/&gt;
&amp;gt; then define a fieldtype &amp;amp; field that uses it and test it out, without modifying some global&lt;br/&gt;
&amp;gt; testing schema.&lt;/p&gt;

&lt;p&gt;i was operating under the assumption that for stuff like that, the best thing to do would be to have multiple sets of solrconfig/schema files ... for Solr itself there would probably be one big generic file that most tests could use, but any test that wanted to try something exotic would check in a new one (in a directory with the same name as the test class) and speciy it when constructing hte harness.&lt;/p&gt;

&lt;p&gt;the only flaw in that plan right now is that SolrCore only lets you specify a schema file path when you construct it, not a solrconfig, but i was going to tackle refactoring that once i had the basics up and running.&lt;/p&gt;</comment>
                            <comment id="12373760" author="hossman" created="Sun, 9 Apr 2006 15:47:00 +0100"  >&lt;p&gt;zip file contains a bunch of code and a patch file that modifies the build.xml and XML.java&lt;/p&gt;

&lt;p&gt;the new code consists of:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the TestHarness from before (with a few additions) which should be usefull for interacting with a SolrCore independent of any specific testing framework&lt;/li&gt;
	&lt;li&gt;a new AbstractSolrTestCase that is designed to make it easy to write JUnit tests in particular.&lt;/li&gt;
	&lt;li&gt;a Sample test, and a short test of the basic Solr functions that demonstrate &quot;best practices&quot; of the AbstractSolrTestCase&lt;/li&gt;
	&lt;li&gt;a ConvertedLegacyTest which is a progromatic translation of src/apps/SolrTest/newtest.txt (the converstion perl script is included in the zip for refrence, but i wasn&apos;t planning on commiting it.)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;this represents 95% of what i think we need as far as a good testing framework moving forward: the last 5% being modifications to SolrConfig so that individual tests can use different solrconfig.xml files. Even without that, this code can be commited as is &amp;#8211; tests will just have to share a solrconfig.xml for the time being, but they can use unique schema files.&lt;/p&gt;



&lt;p&gt;The only hitch with all of this, is that i seem to have a filehandle leak somewhere.  Or at least i think i do ... running &quot;ant legacyTest&quot; works fine with an openfiles limit of 1024, but &quot;ant junit&quot; runs out of filehandles using the same limit (at 2048 the test runs fine).  The index itself only contains about 100 files when this happens so i&apos;m not sure what&apos;s going on.&lt;/p&gt;

&lt;p&gt;If anyone can help me spot the problem, i&apos;d appreciate it.&lt;/p&gt;

&lt;p&gt;I&apos;m going to take a look at it with some fresh eyes (and lsof) in the morning.&lt;/p&gt;</comment>
                            <comment id="12373961" author="hossman" created="Tue, 11 Apr 2006 13:58:14 +0100"  >&lt;p&gt;filehandle leak was resolved by closing requests, code was commited.&lt;/p&gt;

&lt;p&gt;leaving issue open for now, pending sub-task to deal with solrconfig.xml loading, and a decission about wether we want to completely remove SolrTest or not.  (either way, we should copy/move the config/schema used by the tests somewhere under the test directory, and change the working directory of the JUnit tests)&lt;/p&gt;</comment>
                            <comment id="12375053" author="hossman" created="Wed, 19 Apr 2006 14:16:37 +0100"  >&lt;p&gt;Everything I set out to do is done. Should this issue be resolved, or should SolrTest be removed from the repository?&lt;/p&gt;

&lt;p&gt;Does it serve any useful purpose now that we have the JUnit tests?&lt;/p&gt;</comment>
                            <comment id="12375416" author="yseeley@gmail.com" created="Fri, 21 Apr 2006 02:51:48 +0100"  >&lt;p&gt;Yes, I suppose SolrTest can be removed &amp;lt;nostalgic sniff...&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12375493" author="hossman" created="Fri, 21 Apr 2006 14:38:16 +0100"  >&lt;p&gt;Well, the one thing SolrTest could do that we don&apos;t have a replacement for that SolrTest was usefull for is load testing SolrCore &amp;#8211; it might make sense to leave that part in, but rip out the guts and replace it with using the SolrTestHarness.&lt;/p&gt;</comment>
                            <comment id="12454254" author="hossman" created="Wed, 29 Nov 2006 08:33:11 +0000"  >&lt;p&gt;In the interest of reducing possible confusion (and since i haven&apos;t been motivated to refactor SolrTest to use SolrTestHarness in the last 6 months) i think maybe I should just svn remove solr/src/apps and the build.xml references to it before we have an official release.&lt;/p&gt;

&lt;p&gt;we can always restore it in the future if there is a desire.&lt;/p&gt;

&lt;p&gt;objections?&lt;/p&gt;</comment>
                            <comment id="12454257" author="bdelacretaz" created="Wed, 29 Nov 2006 08:55:08 +0000"  >&lt;p&gt;No objection here, keeping the code clean is a Good Thing&lt;/p&gt;</comment>
                            <comment id="12454331" author="yseeley@gmail.com" created="Wed, 29 Nov 2006 14:48:52 +0000"  >&lt;p&gt;&amp;gt; maybe I should just svn remove solr/src/apps&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12454409" author="hossman" created="Wed, 29 Nov 2006 19:00:28 +0000"  >&lt;p&gt;TestApp removed ... thus ends the longest &quot;In Progress&quot; Solr issue to date &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12589361" author="hossman" created="Wed, 16 Apr 2008 00:56:45 +0100"  >&lt;p&gt;This bug was modified as part of a bulk update using the criteria...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Marked (&quot;Resolved&quot; or &quot;Closed&quot;) and &quot;Fixed&quot;&lt;/li&gt;
	&lt;li&gt;Had no &quot;Fix Version&quot; versions&lt;/li&gt;
	&lt;li&gt;Was listed in the CHANGES.txt for 1.1&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The Fix Version for all 38 issues found was set to 1.1, email notification&lt;br/&gt;
was suppressed to prevent excessive email.&lt;/p&gt;

&lt;p&gt;For a list of all the issues modified, search jira comments for this&lt;br/&gt;
(hopefully) unique string: 20080415hossman3&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12325103" name="SOLR-3.zip" size="18531" author="hossman" created="Sun, 9 Apr 2006 15:46:57 +0100"/>
                            <attachment id="12324085" name="TestBasicFunctionality.java" size="5413" author="hossman" created="Mon, 13 Mar 2006 15:37:52 +0000"/>
                            <attachment id="12324084" name="TestHarness.java" size="9482" author="hossman" created="Mon, 13 Mar 2006 15:37:52 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12331900">SOLR-8</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 14 Mar 2006 01:22:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7574</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxtzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21177</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>