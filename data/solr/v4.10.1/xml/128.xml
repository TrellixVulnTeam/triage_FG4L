<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:21:16 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-128/SOLR-128.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-128] Include Newer version of Jetty</title>
                <link>https://issues.apache.org/jira/browse/SOLR-128</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;It would be good to include an up-to-date jetty version for the example.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12361555">SOLR-128</key>
            <summary>Include Newer version of Jetty</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ryantxu">Ryan McKinley</assignee>
                                    <reporter username="ryantxu">Ryan McKinley</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Jan 2007 11:56:54 +0000</created>
                <updated>Fri, 10 May 2013 11:40:11 +0100</updated>
                            <resolved>Tue, 29 May 2007 19:28:27 +0100</resolved>
                                                    <fixVersion>1.2</fixVersion>
                                    <component>update</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12468588" author="ryantxu" created="Tue, 30 Jan 2007 12:02:51 +0000"  >&lt;p&gt;I tried running the example with jetty 6.1.  In less then 5 mins, I had everything working smoothly.  The only issue I see is the JSP jar files are huge (~4MB)&lt;/p&gt;

&lt;p&gt;The current example folder includes settings and jars for JMX, is that necessary?&lt;/p&gt;
</comment>
                            <comment id="12468647" author="yseeley@gmail.com" created="Tue, 30 Jan 2007 15:39:52 +0000"  >&lt;p&gt;We could probably ditch the JMX stuff as we don&apos;t currently use it... or does Jetty export some cool stuff via JMX  that we might want to point people at for debugging?&lt;/p&gt;

&lt;p&gt;If we go with JSP 2.1, we should just remember not to use any 2.1 specific features yet... most containers aren&apos;t quite there yet.  The latest stable version of Tomcat 5.5.20 is only on Servlet 2.4/JSP 2.0&lt;/p&gt;</comment>
                            <comment id="12468660" author="yseeley@gmail.com" created="Tue, 30 Jan 2007 16:11:20 +0000"  >&lt;p&gt;BTW, there&apos;s a Jetty 6.1.1 out...&lt;/p&gt;</comment>
                            <comment id="12468746" author="ryantxu" created="Tue, 30 Jan 2007 19:09:02 +0000"  >&lt;p&gt;Ideally we could replace existing JSP with servlets or SolrRequestHandlers.  I don&apos;t see anything that could not be handled using a SolrRequestHandler and default wt=xslt.  For an embedded solr, it would be nice not to need the JSP dependencies.  This would have the added bennefit of returning XML/JSON/ruby/etc for the admin interface.  &lt;/p&gt;

&lt;p&gt;Jetty 6.1.1?  where is it?  Its not on: &lt;a href=&quot;http://docs.codehaus.org/display/JETTY/Downloading+and+Installing#download&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://docs.codehaus.org/display/JETTY/Downloading+and+Installing#download&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="12468749" author="yseeley@gmail.com" created="Tue, 30 Jan 2007 19:18:41 +0000"  >&lt;p&gt;When you go to the download link:&lt;br/&gt;
&lt;a href=&quot;http://dist.codehaus.org/jetty/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dist.codehaus.org/jetty/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12468750" author="yseeley@gmail.com" created="Tue, 30 Jan 2007 19:20:03 +0000"  >&lt;p&gt;The disad to getting rid of JSPs is it would make it much harder for someone to easily improve the look or functionality of the admin pages.&lt;/p&gt;</comment>
                            <comment id="12468758" author="ryantxu" created="Tue, 30 Jan 2007 19:47:27 +0000"  >&lt;p&gt;I&apos;m not suggesting we drop JSP &lt;b&gt;now&lt;/b&gt;... just that we definitely should not be using 2.1 specific stuff and where possible xml+xslt with a RequestHandler (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-58&quot; title=&quot;Change Admin components to return XML like the rest of the system&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-58&quot;&gt;&lt;del&gt;SOLR-58&lt;/del&gt;&lt;/a&gt;) in the future.&lt;/p&gt;

&lt;p&gt;I just tried this with 6.1.1 and it works fine (with the jsp-2.0 or jsp-2.1)&lt;/p&gt;

&lt;p&gt;What is the best way for me to post this patch?  Most of the work is adding and deleting jar files.  It has two xml config files etc/jetty.xml and etc/webdefault.xml&lt;/p&gt;
</comment>
                            <comment id="12470960" author="otis" created="Wed, 7 Feb 2007 13:33:19 +0000"  >&lt;p&gt;I think we want to wait with the newest Jetty.  I&apos;m on the jetty ML, and the beast is not yet fully ironed out., not yet stable enough.  I&apos;d let it simmer a little longer while Greg, Jan and other Jetty folks get the deamons out.&lt;/p&gt;</comment>
                            <comment id="12494915" author="ryantxu" created="Fri, 11 May 2007 00:43:44 +0100"  >&lt;p&gt;here is a zip with the example directory as we would (maybe) want it.&lt;/p&gt;

&lt;p&gt;This uses jetty-6.1.3&lt;/p&gt;
</comment>
                            <comment id="12498329" author="yseeley@gmail.com" created="Wed, 23 May 2007 19:52:12 +0100"  >&lt;p&gt;Any opinions on if we should put in Jetty 6.1.3 now, or wait until after Solr 1.2 is released?&lt;/p&gt;</comment>
                            <comment id="12498333" author="ryantxu" created="Wed, 23 May 2007 20:00:39 +0100"  >&lt;p&gt;It has been working fine for me, but I have not been using it in production or under heavy load.  Otis?&lt;/p&gt;

&lt;p&gt;If 1.2 is more then a week away, I think we should include it soon and take it out if  anything looks fishy...&lt;/p&gt;</comment>
                            <comment id="12498335" author="yseeley@gmail.com" created="Wed, 23 May 2007 20:16:28 +0100"  >&lt;p&gt;OK, let&apos;s quickly go ahead then.  There have been some JSP issues with our current Jetty version anyway.&lt;/p&gt;

&lt;p&gt;I&apos;d like to have all the core changes done in the next few days so we can get a release out by the end of this month (1 week away).&lt;/p&gt;</comment>
                            <comment id="12498345" author="ryantxu" created="Wed, 23 May 2007 20:58:39 +0100"  >&lt;p&gt;applied to rev541050&lt;/p&gt;

&lt;p&gt;If anything goes wrong, we need to revert /example/ to rev 541049 and check NOTICE.txt and CHANGES.txt&lt;/p&gt;</comment>
                            <comment id="12498534" author="otis" created="Thu, 24 May 2007 08:49:16 +0100"  >&lt;p&gt;I&apos;m using 6.1.3 in a pre-production project.&lt;br/&gt;
I do see Hadoop guys hit a problem - see JETTY-345, which mentions 6.1.4rc1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12498729" author="yseeley@gmail.com" created="Thu, 24 May 2007 18:23:44 +0100"  >&lt;p&gt;Yeah, I saw that hadoop issue too, which is why I was planning on some quick&lt;br/&gt;
indexing &amp;amp; querying benchmarks.&lt;/p&gt;</comment>
                            <comment id="12499364" author="yseeley@gmail.com" created="Sun, 27 May 2007 00:00:22 +0100"  >&lt;p&gt;Doing some quick connection handling tests with the python client:&lt;br/&gt;
from solr import *&lt;br/&gt;
c = SolrConnection(host=&apos;localhost:8080&apos;, persistent=False)&lt;br/&gt;
for i in xrange(10000):&lt;br/&gt;
  c.search(q=&apos;id:1234&apos;&lt;/p&gt;

&lt;p&gt;Java 1.5 -server on WindowsXP&lt;/p&gt;

&lt;p&gt;Jetty 5.1.??, persistent=20.9s, non-persistent=44s, sometimes &quot;address already in use&quot; exception&lt;br/&gt;
Jetty 6.1.3, persistent=20.1s, non-persistent=114s&lt;br/&gt;
Tomcat 6.0.13, persistent=20.2s, non-persistent=29s, sometimes &quot;address already in use&quot; exception&lt;/p&gt;

&lt;p&gt;Could be a python client issue, (SO_REUSE_ADDR for python http-lib?), but it does seem like Jetty 6.1.3 is slower at handling new connections?  Anyone have benchmarks from a different client?&lt;/p&gt;</comment>
                            <comment id="12499407" author="yseeley@gmail.com" created="Sun, 27 May 2007 16:28:14 +0100"  >&lt;p&gt;Switching to the non-NIO connector in Jetty 6.1.3, I get&lt;br/&gt;
18.2s for persistent connections, 35s for non-persistent (again WinXP, Java5 -server)&lt;/p&gt;</comment>
                            <comment id="12499409" author="yseeley@gmail.com" created="Sun, 27 May 2007 17:07:18 +0100"  >&lt;p&gt;The 10,000 single-client connection test on a dual Opteron, RHEL4 64 bit, Java5 64 bit -server&lt;br/&gt;
Jetty 6.1.3, NIO connector, persistent=414s,  non-persistent=11.3s&lt;br/&gt;
Jetty 6.1.3, non-NIO connector, persistent=408s,  non-persistent=10.2s&lt;/p&gt;

&lt;p&gt;Situation reversed from WinXP!  The persistent connections are  horribly slow.&lt;/p&gt;</comment>
                            <comment id="12499413" author="yseeley@gmail.com" created="Sun, 27 May 2007 17:27:24 +0100"  >&lt;p&gt;On that Opteron Linux box, almost identical numbers for Resin 3.0 pro, so it&apos;s not Jetty specific.&lt;/p&gt;</comment>
                            <comment id="12499417" author="yseeley@gmail.com" created="Sun, 27 May 2007 18:21:37 +0100"  >&lt;p&gt;Hmmm, some bad interaction with persistent connections and POST (which solr.py uses)?&lt;br/&gt;
I switched the method to use GET, and it finished 10k connections in 6.3sec&lt;/p&gt;

&lt;p&gt;Many browsers (incorrectly) send a CR+LF after the post body.   The python httplib does not do this... I wonder if that&apos;s the issue (the server waiting for the possible CR+LF so it can throw it away?)  The delay seems to be about 40ms&lt;/p&gt;</comment>
                            <comment id="12499439" author="yseeley@gmail.com" created="Sun, 27 May 2007 20:26:13 +0100"  >&lt;p&gt;I think the issue with persistent connections on linux is due to Nagle&apos;s algorithm.&lt;br/&gt;
The python client sends the HTTP headers and body separately, thus triggering it.&lt;br/&gt;
The following little program below writes it all at once and gets very good performance:&lt;/p&gt;

&lt;p&gt;---------&lt;del&gt;mysock.py&lt;/del&gt;------&lt;br/&gt;
import socket&lt;/p&gt;

&lt;p&gt;headers=&apos;&apos;&apos;POST /solr/select HTTP/1.1&lt;br/&gt;
Host: localhost:8983&lt;br/&gt;
Accept-Encoding: identity&lt;br/&gt;
Content-Length: 11&lt;br/&gt;
Content-Type: application/x-www-form-urlencoded; charset=utf-8&lt;/p&gt;

&lt;p&gt;&apos;&apos;&apos;&lt;/p&gt;

&lt;p&gt;body=&apos;q=id%3A1234&apos;&lt;br/&gt;
msg = headers + body&lt;/p&gt;

&lt;p&gt;s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)&lt;br/&gt;
s.connect((&quot;localhost&quot;, 8983))&lt;/p&gt;

&lt;p&gt;for i in xrange(10000):&lt;br/&gt;
  s.send(msg)&lt;br/&gt;
  rsp = s.recv(8192)  #pray we get the complete response in one go&lt;/p&gt;</comment>
                            <comment id="12499875" author="ryantxu" created="Tue, 29 May 2007 19:28:27 +0100"  >&lt;p&gt;will be included in solr1.2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12349907" name="Jetty6.config.patch" size="61261" author="ryantxu" created="Tue, 30 Jan 2007 12:06:30 +0000"/>
                            <attachment id="12357071" name="jetty-6.3-example.zip" size="7536006" author="ryantxu" created="Fri, 11 May 2007 00:43:43 +0100"/>
                            <attachment id="12349910" name="lib.zip" size="6036738" author="ryantxu" created="Tue, 30 Jan 2007 12:14:35 +0000"/>
                            <attachment id="12349908" name="start.jar" size="16391" author="ryantxu" created="Tue, 30 Jan 2007 12:07:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 30 Jan 2007 15:39:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxt87:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21054</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>