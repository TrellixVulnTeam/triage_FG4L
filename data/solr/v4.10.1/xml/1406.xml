<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:15:42 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-1406/SOLR-1406.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-1406] Refactor FileDataSource and FileListEntityProcessor to be more extensible</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1406</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;FileDataSource should make openStream method protected so we can extend FileDataSource for other File types such as GZip, by controlling the underlying InputStreamReader implementation being returned.&lt;/p&gt;

&lt;p&gt;FileListEntityProcessor needs to aggregate a list of files that were processed and expose that list in an accessible way so that further processing on that file list can be done in the close method.  For example, deletion or archiving.&lt;/p&gt;

&lt;p&gt;Another improvement would be that in the event of an indexing rollback event, processing of the close method either does not occur, or the close method is allowed access to that event, to prevent processing within the close method if necessary.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12434685">SOLR-1406</key>
            <summary>Refactor FileDataSource and FileListEntityProcessor to be more extensible</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalinmangar">Shalin Shekhar Mangar</assignee>
                                    <reporter username="lukeforehand">Luke Forehand</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Sep 2009 23:35:12 +0100</created>
                <updated>Tue, 10 Nov 2009 15:50:37 +0000</updated>
                            <resolved>Mon, 7 Sep 2009 14:13:41 +0100</resolved>
                                    <version>1.4</version>
                                    <fixVersion>1.4</fixVersion>
                                    <component>contrib - DataImportHandler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12750707" author="lukeforehand" created="Wed, 2 Sep 2009 23:37:11 +0100"  >&lt;p&gt;Patch that adds getDataConfig to Context interface, and ContextImpl implementation.&lt;/p&gt;

&lt;p&gt;i.e.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DataConfig getDataConfig() {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.dataImporter.getConfig();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12750826" author="noble.paul" created="Thu, 3 Sep 2009 06:26:54 +0100"  >&lt;p&gt;It is easy to expose DataConfig object. But the problem is I will have less flexibility in changing that once it is exposed. So, which information do you require exactly?&lt;/p&gt;</comment>
                            <comment id="12751023" author="lukeforehand" created="Thu, 3 Sep 2009 14:44:45 +0100"  >&lt;p&gt;I am implementing EventListeners for both onImportStart and onImportEnd that will work with a custom GZipFileDataSource for indexing.  Upon import start I will calculate a file list using the baseDir attribute of the FileListEntityProcessor, putting that list in a session attribute with Global scope.  Upon import end I will iterate over this file list and archive/remove these specific files.  The purpose is that if other files are added to the baseDir during indexing, they won&apos;t be archived/removed by my onImportEnd event implementation and will be available for the next full indexing operation (which happens on a schedule).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dataConfig&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dataSource name=&lt;span class=&quot;code-quote&quot;&gt;&quot;myfilereader&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;FileDataSource&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;document&amp;gt;&lt;/span&gt;
      &amp;lt;entity name=&lt;span class=&quot;code-quote&quot;&gt;&quot;jc&quot;&lt;/span&gt; rootEntity=&lt;span class=&quot;code-quote&quot;&gt;&quot;false&quot;&lt;/span&gt; dataSource=&lt;span class=&quot;code-quote&quot;&gt;&quot;null&quot;&lt;/span&gt;
        processor=&lt;span class=&quot;code-quote&quot;&gt;&quot;FileListEntityProcessor&quot;&lt;/span&gt;
        fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;^.*\.xml$&quot;&lt;/span&gt; recursive=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;
        baseDir=&lt;span class=&quot;code-quote&quot;&gt;&quot;/usr/local/apache2/htdocs/imagery&quot;&lt;/span&gt;&amp;gt;
        ....
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/entity&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/document&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dataConfig&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12751122" author="shalinmangar" created="Thu, 3 Sep 2009 19:30:11 +0100"  >&lt;p&gt;Instead of exposing DataConfig, perhaps you can extend the FileListEntityProcessor and override close() and do these tasks there? Note that EntityProcessor#close() is introduced in Solr 1.4&lt;/p&gt;</comment>
                            <comment id="12751587" author="lukeforehand" created="Fri, 4 Sep 2009 20:36:05 +0100"  >&lt;p&gt;I could extend FileListEntityProcessor if it was written in a more extensible way, for example, exposing it&apos;s baseUrl and fileName private members with accessor methods, and refactoring some of the private methods that do fileName filtering so that they are reusable and protected.&lt;/p&gt;</comment>
                            <comment id="12751638" author="shalinmangar" created="Fri, 4 Sep 2009 23:06:28 +0100"  >&lt;blockquote&gt;&lt;p&gt;I could extend FileListEntityProcessor if it was written in a more extensible way, for example, exposing it&apos;s baseUrl and fileName private members with accessor methods, and refactoring some of the private methods that do fileName filtering so that they are reusable and protected.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ah, I see. Well, that is easier than exposing DataConfig. DataConfig was never really meant to be exposed. We need to have another look at DataConfig before exposing making it a public API. How about you create an issue (or rename this one) to make FileListEntityProcessor more extensible rather than exposing DataConfig? We can get that in for 1.4.&lt;/p&gt;</comment>
                            <comment id="12751837" author="shalinmangar" created="Sun, 6 Sep 2009 08:24:35 +0100"  >&lt;ol&gt;
	&lt;li&gt;Made FileDataSource and FileListEntityProcessor more extensible.&lt;/li&gt;
	&lt;li&gt;I also found that biggerThan and smallerThan were two parameters in FileListEntityProcessor which were never being set. I&apos;ve fixed that.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I have not exposed FileListEntityProcessor&apos;s getFolderFiles method because I&apos;d prefer to keep the implementation private for now so that we can change it in future without worrying about back-compat (see &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1313&quot; title=&quot;DIH should be able to read gziped files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1313&quot;&gt;&lt;del&gt;SOLR-1313&lt;/del&gt;&lt;/a&gt;). However, if one wants to know the file names being processed, one can override EntityProcessorBase#getNext.&lt;/p&gt;

&lt;p&gt;Luke, does this help in your use-case?&lt;/p&gt;</comment>
                            <comment id="12752078" author="shalinmangar" created="Mon, 7 Sep 2009 11:22:05 +0100"  >&lt;ol&gt;
	&lt;li&gt;Fixed logic of resolving variables in newerThan, olderThan, biggerThan and smallerThan&lt;/li&gt;
	&lt;li&gt;Added tests for biggerThan and smallerThan&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="12752129" author="shalinmangar" created="Mon, 7 Sep 2009 14:13:41 +0100"  >&lt;p&gt;Committed revision 812122.&lt;/p&gt;

&lt;p&gt;Thanks Luke!&lt;/p&gt;</comment>
                            <comment id="12752148" author="lukeforehand" created="Mon, 7 Sep 2009 15:16:00 +0100"  >&lt;p&gt;I believe this does help me a lot, thanks for your time!&lt;/p&gt;

&lt;p&gt;Luke Forehand&lt;br/&gt;
Core Development&lt;br/&gt;
Networked Insights, Inc. &amp;lt;&lt;a href=&quot;http://www.networkedinsights.com/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.networkedinsights.com/&lt;/a&gt;&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12775488" author="gsingers" created="Tue, 10 Nov 2009 15:50:37 +0000"  >&lt;p&gt;Bulk close Solr 1.4 issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12418808" name="ASF.LICENSE.NOT.GRANTED--image.gif" size="2750" author="lukeforehand" created="Mon, 7 Sep 2009 15:16:01 +0100"/>
                            <attachment id="12418794" name="SOLR-1406.patch" size="13806" author="shalinmangar" created="Mon, 7 Sep 2009 11:22:05 +0100"/>
                            <attachment id="12418740" name="SOLR-1406.patch" size="6406" author="shalinmangar" created="Sun, 6 Sep 2009 08:24:35 +0100"/>
                            <attachment id="12418445" name="SOLR-1406.patch" size="1727" author="lukeforehand" created="Wed, 2 Sep 2009 23:37:11 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 3 Sep 2009 05:26:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6246</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxlgf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19795</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>