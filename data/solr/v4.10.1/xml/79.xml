<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:20:28 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-79/SOLR-79.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-79] [PATCH] Using system properties in Solr configuration</title>
                <link>https://issues.apache.org/jira/browse/SOLR-79</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Actually it is not possible to use system properties for configuring the Solr engine. There should be a way of referencing system properties from solrconfig.xml, like {$prop.name}.&lt;/p&gt;

&lt;p&gt;The attached patch will provide this feature.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12358134">SOLR-79</key>
            <summary>[PATCH] Using system properties in Solr configuration</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ehatcher">Erik Hatcher</assignee>
                                    <reporter username="alexxx">Alexander Saar</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Dec 2006 14:36:58 +0000</created>
                <updated>Fri, 10 May 2013 11:39:53 +0100</updated>
                            <resolved>Fri, 16 Feb 2007 16:49:00 +0000</resolved>
                                                    <fixVersion>1.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12456849" author="alexxx" created="Fri, 8 Dec 2006 14:37:46 +0000"  >&lt;p&gt;Patch that allows usage of references to system properties in the solrconfig.xml&lt;/p&gt;</comment>
                            <comment id="12456896" author="yseeley@gmail.com" created="Fri, 8 Dec 2006 16:07:52 +0000"  >&lt;p&gt;Interesting idea, thanks Alexander!&lt;br/&gt;
If no one has objections, I think it should go in.&lt;/p&gt;</comment>
                            <comment id="12457214" author="yseeley@gmail.com" created="Mon, 11 Dec 2006 00:19:55 +0000"  >&lt;p&gt;updated patch with test.&lt;/p&gt;

&lt;p&gt;Is there a particular reason that the pattern {$system.prop} was picked over $&lt;/p&gt;
{system.prop}
&lt;p&gt;?&lt;/p&gt;

</comment>
                            <comment id="12457493" author="klaasm" created="Mon, 11 Dec 2006 22:10:40 +0000"  >&lt;p&gt;FWIW, Jetty uses the following xml:&lt;/p&gt;

&lt;p&gt;&amp;lt;SystemProperty name=&quot;jetty.home&quot; default=&quot;.&quot;/&amp;gt;/logs/yyyy_mm_dd.jet&lt;br/&gt;
ty.log&lt;/p&gt;</comment>
                            <comment id="12457536" author="hossman" created="Tue, 12 Dec 2006 01:23:43 +0000"  >
&lt;p&gt;1) i&apos;m not really a fan of the Jetty syntax ... much too verbose for my taste, I would prefer $&lt;/p&gt;
{system.prop}
&lt;p&gt; over {$system.prop} to be consistent with ant and shell variables ... but it would be nice to still support defaults ... isn&apos;t $&lt;/p&gt;
{prop.name:default val}
&lt;p&gt; what bash uses?&lt;/p&gt;

&lt;p&gt;2) to be useful, wouldn&apos;t we want this to work even if the property wasn&apos;t the full value of the tag, ie...&lt;/p&gt;

&lt;p&gt;    &amp;lt;listener event=&quot;postCommit&quot; class=&quot;solr.RunExecutableListener&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;exe&quot;&amp;gt;snapshooter&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;dir&quot;&amp;gt;$&lt;/p&gt;
{some.dir.property}
&lt;p&gt;/bin&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;bool name=&quot;wait&quot;&amp;gt;true&amp;lt;/bool&amp;gt;&lt;br/&gt;
    &amp;lt;/listener&amp;gt;&lt;/p&gt;

&lt;p&gt;...if we do this, we should also have some sort of escaping mechanism for completleness, is &amp;lt;tag&amp;gt;$$&lt;/p&gt;
{some.prop}
&lt;p&gt;&amp;lt;/tag&amp;gt; would not get substitution.&lt;/p&gt;

&lt;p&gt;3) not everything uses Config.getVal ... we would also need similar substitution logic in Config.evaluate, Config.getNode, and the various DOMUtil methods so that it could be used &lt;b&gt;anywhere&lt;/b&gt; in the solrconfig.xml ... walking all of the NodeTrees to make the substitutions at every level, might get complicated ... maybe there is an easier way of adding a &quot;visiter&quot; to the DOM model?&lt;/p&gt;</comment>
                            <comment id="12457627" author="alexxx" created="Tue, 12 Dec 2006 08:38:27 +0000"  >&lt;p&gt;I took the {$system.prop} pattern from Avalon configuration style. After having a look at the ant way, I would also prefer $&lt;/p&gt;
{system.prop}.&lt;br/&gt;
&lt;br/&gt;
Furthermore I think it will be very helpful to have something like ${system.prop}
&lt;p&gt;/bin. Actually it was not my use case, but I&apos;m sure that it is helpful for somebody.&lt;/p&gt;</comment>
                            <comment id="12472172" author="ehatcher" created="Mon, 12 Feb 2007 02:36:45 +0000"  >&lt;p&gt;Borrowing some code from Ant for property substitution (ugly, but avoids reinventing the wheel), attached is a patch that implements property substituion on all attributes and text nodes in the loaded DOM.  The substituions are done in-place on the DOM thus avoiding having to change code in multiple places.&lt;/p&gt;</comment>
                            <comment id="12472173" author="ehatcher" created="Mon, 12 Feb 2007 02:51:50 +0000"  >&lt;p&gt;Update patch to include necessary build.xml changes and additional test for subtitution in Ant property.&lt;/p&gt;</comment>
                            <comment id="12472403" author="hossman" created="Mon, 12 Feb 2007 20:11:12 +0000"  >&lt;p&gt;i haven&apos;t tested Erik&apos;s patch, but it reads clean to me.&lt;/p&gt;

&lt;p&gt;a couple of minor nits...&lt;/p&gt;

&lt;p&gt;1) it would be good to have some javadocs on substituteSystemProperties(Node)&lt;/p&gt;

&lt;p&gt;2) if the system properties used were &quot;solr.test.sys.prop1&quot;, etc. the patch wouldn&apos;t need to modify build.xml ... if we are going to set them explicitly in build.xml, there shold be a comment explaining which test uses them.&lt;/p&gt;

&lt;p&gt;3) at first glance, i&apos;m not sure if this would work, it would be nice to have a test for it...&lt;/p&gt;

&lt;p&gt;    s = SolrConfig.config.get(&quot;propTest/&lt;span class=&quot;error&quot;&gt;&amp;#91;@attr=&amp;#39;prop two&amp;#39;&amp;#93;&lt;/span&gt;&quot;, &quot;default&quot;);&lt;br/&gt;
    assertEquals(&quot;prefix-prop one-prop two-suffix&quot;, s);&lt;/p&gt;

&lt;p&gt;4) it looks like it should work, but tests of Config.evaluate, Config.getNode, and the various DOMUtil methods would also be good&lt;/p&gt;</comment>
                            <comment id="12472406" author="ehatcher" created="Mon, 12 Feb 2007 20:31:02 +0000"  >&lt;p&gt;Here&apos;s the patch with default value implemented.  $&lt;/p&gt;
{system.property:default value}
&lt;p&gt; - default value is optional, if omitted, &quot;&quot; will be used.&lt;/p&gt;</comment>
                            <comment id="12472501" author="ehatcher" created="Tue, 13 Feb 2007 02:03:09 +0000"  >&lt;p&gt;Updated the patch per Hoss&apos; feedback.   Specifically:&lt;/p&gt;

&lt;p&gt;i haven&apos;t tested Erik&apos;s patch, but it reads clean to me.&lt;/p&gt;

&lt;p&gt;a couple of minor nits...&lt;/p&gt;

&lt;p&gt;1) Javadoc: done.&lt;/p&gt;

&lt;p&gt;2) Hoss: if the system properties used were &quot;solr.test.sys.prop1&quot;, etc. the patch wouldn&apos;t need to modify build.xml ... if we are going to set them explicitly in build.xml, there shold be a comment explaining which test uses them.  [Erik: I don&apos;t understand... are you saying there is a predefined solr.test.sys.prop1 somewhere?  I didn&apos;t spot anything like that, so I&apos;ve kept with defining a couple of test ones in build.xml&lt;/p&gt;

&lt;p&gt;3)  ye of little faith!   the doc that the Config object holds has been modified recursively, so all methods querying the doc will see the substituted values.   I&apos;ve added a test to show the case you mentioned.&lt;/p&gt;

&lt;p&gt;4) I added similar tests for .evaluate and .getNode.  All is well.&lt;/p&gt;

</comment>
                            <comment id="12472904" author="hossman" created="Tue, 13 Feb 2007 22:25:25 +0000"  >&lt;p&gt;I was going to chime in that unset properties should probably not default to an empty string:&lt;br/&gt;
  1) so that &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-109&quot; title=&quot;variable substitution in lucene query params&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-109&quot;&gt;&lt;del&gt;SOLR-109&lt;/del&gt;&lt;/a&gt; would be more feasible&lt;br/&gt;
  2) so that we don&apos;t silently fail on typos&lt;/p&gt;

&lt;p&gt;...looking at the latest patch, #1 isn&apos;t really an issue since $$&lt;/p&gt;
{literal}
&lt;p&gt; works ... but especially now that it&apos;s possible to specify a default value to use if they property isn&apos;t set: trying to use an unset property without a default specified should probably result in an exception ... correct?&lt;/p&gt;


&lt;p&gt;as for my comment about system properties for testing: i was smoking crack thinking that the &amp;lt;syspropertyset&amp;gt; already in the build.xml junit target would magically take care of this for us, forgetting that somewhere the properties actually need to be set.&lt;/p&gt;</comment>
                            <comment id="12472951" author="ehatcher" created="Wed, 14 Feb 2007 01:05:05 +0000"  >

&lt;p&gt;I dunno.... I suppose throwing an exception is fine though that might  &lt;br/&gt;
prevent an otherwise functional Solr instance to start up.  I can see  &lt;br/&gt;
it being ok either way on this issue, but I can&apos;t envision a case  &lt;br/&gt;
where I&apos;d define $&lt;/p&gt;
{...}
&lt;p&gt; bits in my config files and not setting the  &lt;br/&gt;
appropriate system properties.&lt;/p&gt;

&lt;p&gt;I&apos;ll modify to throw an exception.  And commit!  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;	Erik&lt;/p&gt;



</comment>
                            <comment id="12473018" author="hossman" created="Wed, 14 Feb 2007 08:18:45 +0000"  >&lt;p&gt;my view is:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;in most cases, a system property not being defined is going to prevent the value from being usable (ie: a blank dataDIr)&lt;/li&gt;
	&lt;li&gt;if you want to use a systemp prop in a place where it&apos;s acceptible to not have the prop defined at all, then just use $
{prop:}
&lt;p&gt; to denote that an empty string should be used as the default.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12473750" author="ehatcher" created="Fri, 16 Feb 2007 16:49:00 +0000"  >&lt;p&gt;This feature has been added, complete with the requested exception handling when a property is not defined and no default value provided.&lt;/p&gt;</comment>
                            <comment id="12473754" author="yseeley@gmail.com" created="Fri, 16 Feb 2007 17:05:39 +0000"  >&lt;p&gt;Very nice, this will make testing easier as well.&lt;/p&gt;</comment>
                            <comment id="12589323" author="hossman" created="Wed, 16 Apr 2008 00:44:45 +0100"  >&lt;p&gt;This bug was modified as part of a bulk update using the criteria...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Marked (&quot;Resolved&quot; or &quot;Closed&quot;) and &quot;Fixed&quot;&lt;/li&gt;
	&lt;li&gt;Had no &quot;Fix Version&quot; versions&lt;/li&gt;
	&lt;li&gt;Was listed in the CHANGES.txt for 1.2&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The Fix Version for all 39 issues found was set to 1.2, email notification&lt;br/&gt;
was suppressed to prevent excessive email.&lt;/p&gt;

&lt;p&gt;For a list of all the issues modified, search jira comments for this&lt;br/&gt;
(hopefully) unique string: 20080415hossman2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12350993" name="solr-config-system-property.patch" size="11354" author="ehatcher" created="Tue, 13 Feb 2007 02:03:09 +0000"/>
                            <attachment id="12350962" name="solr-config-system-property.patch" size="10379" author="ehatcher" created="Mon, 12 Feb 2007 20:31:02 +0000"/>
                            <attachment id="12350893" name="solr-config-system-property.patch" size="9914" author="ehatcher" created="Mon, 12 Feb 2007 02:51:49 +0000"/>
                            <attachment id="12350892" name="solr-config-system-property.patch" size="9316" author="ehatcher" created="Mon, 12 Feb 2007 02:36:45 +0000"/>
                            <attachment id="12346855" name="solr-config-system-property.patch" size="3228" author="yseeley@gmail.com" created="Mon, 11 Dec 2006 00:19:55 +0000"/>
                            <attachment id="12346780" name="solr-config-system-property.patch" size="975" author="alexxx" created="Fri, 8 Dec 2006 14:37:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 8 Dec 2006 16:07:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7503</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxtj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21103</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>