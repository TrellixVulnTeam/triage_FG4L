<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:17:43 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-133/SOLR-133.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-133] change XmlUpdateRequestHandler to use StAX instead of XPP</title>
                <link>https://issues.apache.org/jira/browse/SOLR-133</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;there has been discussion of using StAX for XML parsing of updates instead of XPP ... opening an issue to track it as a possible improvement  (orriginally mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-61&quot; title=&quot;move XML update parsing out of SolrCore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-61&quot;&gt;&lt;del&gt;SOLR-61&lt;/del&gt;&lt;/a&gt;, but that task was more specificly about refactoring the existing code)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12361794">SOLR-133</key>
            <summary>change XmlUpdateRequestHandler to use StAX instead of XPP</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ryantxu">Ryan McKinley</assignee>
                                    <reporter username="hossman">Hoss Man</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Feb 2007 20:03:48 +0000</created>
                <updated>Fri, 10 May 2013 11:41:07 +0100</updated>
                            <resolved>Sat, 30 Jun 2007 19:53:16 +0100</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12469603" author="skeptikos" created="Thu, 1 Feb 2007 22:43:05 +0000"  >&lt;p&gt;It would be useful if there first were some consensus as to what the goals are for making a change to the XML Update Handler; some possibilities I can think of include:&lt;/p&gt;

&lt;p&gt;1) To use standards-based rather than non-standards-based technologies as much as possible&lt;br/&gt;
2) To use as few different XML technologies (and coding styles related to the technology) as possible&lt;br/&gt;
3) To reduce as much as possible the complexity of code needed for interpreting XML command and/or configuration streams&lt;br/&gt;
4) To lower resource consumption and limitations for XML handling, e.g. stream-based rather than random-access&lt;/p&gt;

&lt;p&gt;By all means add to that list, prioritize, and remove goals which are not seen as important.&lt;/p&gt;

&lt;p&gt;Then it seems to me the question would be how many of those goals are addressed by changing XML Update Handler to stAX, vs. other technologies.  One might at the same time also want to look at other places where SOLR decodes XML such as config files, to see if there can be more commonality rather than continued isolation.&lt;/p&gt;</comment>
                            <comment id="12469968" author="thorsten" created="Sat, 3 Feb 2007 18:06:27 +0000"  >&lt;p&gt;Refactoring the XmlUpdateRequestHandler to use constant variables that can be reused by the Stax implementation. Adding a stax implementation for the XmlUpdateRequestHandler. Till now I get an error about missing content stream.&lt;/p&gt;

&lt;p&gt;NOTE:&lt;br/&gt;
To make the version compile you need to download the JSR 173 API from &lt;br/&gt;
&lt;a href=&quot;http://www.ibiblio.org/maven2/stax/stax-api/1.0/stax-api-1.0.jar&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.ibiblio.org/maven2/stax/stax-api/1.0/stax-api-1.0.jar&lt;/a&gt; &lt;br/&gt;
and copy it to $SOLR_HOME/lib/.&lt;/p&gt;</comment>
                            <comment id="12469971" author="thorsten" created="Sat, 3 Feb 2007 18:11:45 +0000"  >&lt;p&gt;It seems the diff does not show the other libs you need to compile. &lt;/p&gt;

&lt;p&gt;You can download them from:&lt;br/&gt;
&lt;a href=&quot;https://svn.apache.org/repos/asf/forrest/trunk/whiteboard/dispatcher/lib/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/forrest/trunk/whiteboard/dispatcher/lib/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12469999" author="thorsten" created="Sat, 3 Feb 2007 21:55:08 +0000"  >&lt;p&gt;Fixing bugs from first version.&lt;/p&gt;

&lt;p&gt;Adding workaround for problem with direct use of the handler (never gets a stream).&lt;br/&gt;
&lt;a href=&quot;http://www.mail-archive.com/solr-dev@lucene.apache.org/msg02759.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/solr-dev@lucene.apache.org/msg02759.html&lt;/a&gt;&lt;br/&gt;
by patching the SolrUpdateServlet&lt;/p&gt;

&lt;p&gt;Please test, it works fine for me.&lt;/p&gt;</comment>
                            <comment id="12470001" author="thorsten" created="Sat, 3 Feb 2007 22:05:48 +0000"  >&lt;p&gt;@Larrea&lt;br/&gt;
1) standards-based&lt;br/&gt;
2) agree&lt;br/&gt;
3) agree&lt;br/&gt;
4) agree&lt;/p&gt;

&lt;p&gt;StAX is become a standard. Not as fast as SAX but nearly. IMO the StAX implementation is as easy to follow as the xpp, personally I think even easier.&lt;/p&gt;</comment>
                            <comment id="12472161" author="ryantxu" created="Sun, 11 Feb 2007 23:55:53 +0000"  >&lt;p&gt;Thorsten - this looks good.  I cleaned it up a bit and modified it to use &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-139&quot; title=&quot;Support updateable/modifiable documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-139&quot;&gt;&lt;del&gt;SOLR-139&lt;/del&gt;&lt;/a&gt;.  The big changes I made are:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;It uses two spaces (not tabs or 4 spaces)&lt;/li&gt;
	&lt;li&gt;It overwrites the existing XmlUpdateRequestHandler rather then adding a parallel one.  (We should either use StAX or XPP, but not both)&lt;/li&gt;
	&lt;li&gt;It breaks out the xml parsing so that parsing a single document is an easily testable chunk:&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  SolrDocument readDoc(XMLStreamReader parser)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;It adds a test to make sure it reads documents correctly&lt;/li&gt;
	&lt;li&gt;Since it is &lt;b&gt;the&lt;/b&gt; XmlUpdateRequestHandler all the other tests that insert documents use it.&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="12474337" author="hossman" created="Tue, 20 Feb 2007 02:32:22 +0000"  >&lt;p&gt;haven&apos;t reviewed any patches, but to address some of J.J.s earlier points: i assume the goal would be to move to STaX because it is reportadly as fast as XPP but is also the new standard for &quot;fast&quot; stream based processing.&lt;/p&gt;

&lt;p&gt;As for replacing other XML parsing code in the solr code base &amp;#8211; XML parsing can probably be divided into two lumps:&lt;br/&gt;
 1) processing input streams for updates (or more generally: &quot;requests with ContentStreams&quot; based on some of Ryan&apos;s recent patches) &lt;br/&gt;
 2) config file parsing&lt;/p&gt;

&lt;p&gt;while STaX sounds like it makes a lot of sense for #1, sticking with DOM parsing for #2 seems like a good idea ... using XPath to access arbitrary sections of config information is extremely handy and the performance issues with initialization from the config DOM doens&apos;t seem like a big issue.&lt;/p&gt;</comment>
                            <comment id="12474892" author="ryantxu" created="Thu, 22 Feb 2007 00:34:31 +0000"  >&lt;p&gt;fixed the document parser to handle fields with CDATA.  &lt;/p&gt;

&lt;p&gt;switch (event) {&lt;br/&gt;
      // Add everything to the text&lt;br/&gt;
      case XMLStreamConstants.SPACE:&lt;br/&gt;
      case XMLStreamConstants.CDATA:&lt;br/&gt;
      case XMLStreamConstants.CHARACTERS:&lt;br/&gt;
        text.append( parser.getText() );&lt;br/&gt;
        break;&lt;br/&gt;
...&lt;/p&gt;</comment>
                            <comment id="12478325" author="ryantxu" created="Tue, 6 Mar 2007 09:25:50 +0000"  >&lt;p&gt;updated to work with most recent &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-139&quot; title=&quot;Support updateable/modifiable documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-139&quot;&gt;&lt;del&gt;SOLR-139&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12486195" author="ryantxu" created="Tue, 3 Apr 2007 02:19:32 +0100"  >&lt;p&gt;Applies cleaner with trunk - it still depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-193&quot; title=&quot;General SolrDocument interface to manage field values.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-193&quot;&gt;&lt;del&gt;SOLR-193&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-139&quot; title=&quot;Support updateable/modifiable documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-139&quot;&gt;&lt;del&gt;SOLR-139&lt;/del&gt;&lt;/a&gt;, so &quot;clean&quot; may  not be the best description.&lt;/p&gt;</comment>
                            <comment id="12492615" author="ryantxu" created="Mon, 30 Apr 2007 01:40:46 +0100"  >&lt;p&gt;applies (almost cleanly) with trunk + &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-193&quot; title=&quot;General SolrDocument interface to manage field values.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-193&quot;&gt;&lt;del&gt;SOLR-193&lt;/del&gt;&lt;/a&gt; + &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-139&quot; title=&quot;Support updateable/modifiable documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-139&quot;&gt;&lt;del&gt;SOLR-139&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12494005" author="thorsten" created="Mon, 7 May 2007 10:53:39 +0100"  >&lt;p&gt;What is missing with this issue, where can I give a helping had.&lt;/p&gt;</comment>
                            <comment id="12494059" author="ryantxu" created="Mon, 7 May 2007 16:23:41 +0100"  >&lt;p&gt;If you have &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-193&quot; title=&quot;General SolrDocument interface to manage field values.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-193&quot;&gt;&lt;del&gt;SOLR-193&lt;/del&gt;&lt;/a&gt; + &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-139&quot; title=&quot;Support updateable/modifiable documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-139&quot;&gt;&lt;del&gt;SOLR-139&lt;/del&gt;&lt;/a&gt;, i think most things are good...&lt;/p&gt;

&lt;p&gt;We could easily remove the &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-139&quot; title=&quot;Support updateable/modifiable documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-139&quot;&gt;&lt;del&gt;SOLR-139&lt;/del&gt;&lt;/a&gt; dependency.&lt;/p&gt;

&lt;p&gt;I think after solr1.2 (assuming it is sometime soon),  this and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-193&quot; title=&quot;General SolrDocument interface to manage field values.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-193&quot;&gt;&lt;del&gt;SOLR-193&lt;/del&gt;&lt;/a&gt; would be good to include.&lt;/p&gt;</comment>
                            <comment id="12494559" author="ryantxu" created="Wed, 9 May 2007 20:05:49 +0100"  >&lt;p&gt;From Yonik on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-231&quot; title=&quot;By default, use UTF-8 for posted content streams&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-231&quot;&gt;&lt;del&gt;SOLR-231&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&amp;gt;&amp;gt; Solr should assume UTF-8 encoding unless the contentType says otherwise.&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; In general yes (when Solr is asked for a Reader).&lt;br/&gt;
&amp;gt; For XML, we should probably give the parser an InputStream.&lt;br/&gt;
&amp;gt; &lt;a href=&quot;http://www.nabble.com/double-curl-calls-in-post.sh--tf2287469.html#a6369448&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/double-curl-calls-in-post.sh--tf2287469.html#a6369448&lt;/a&gt;&lt;br/&gt;
&amp;gt; &lt;/p&gt;

</comment>
                            <comment id="12501118" author="ryantxu" created="Mon, 4 Jun 2007 08:09:24 +0100"  >&lt;p&gt;Updated to apply against trunk and removed the &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-139&quot; title=&quot;Support updateable/modifiable documents&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-139&quot;&gt;&lt;del&gt;SOLR-139&lt;/del&gt;&lt;/a&gt; dependency.&lt;/p&gt;

&lt;p&gt;Not it just relies on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-193&quot; title=&quot;General SolrDocument interface to manage field values.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-193&quot;&gt;&lt;del&gt;SOLR-193&lt;/del&gt;&lt;/a&gt;.  &lt;/p&gt;</comment>
                            <comment id="12504508" author="ryantxu" created="Thu, 14 Jun 2007 03:31:29 +0100"  >&lt;p&gt;Extracts the request parsing and update handling into two parts.&lt;/p&gt;

&lt;p&gt;This adds an &quot;UpdateRequestProcessor&quot; that handles the actual updating.  This offers a good place for authentication / document transformation etc.  This can all be reuse if we have a JSONUpdate handler.  The UpdateRequestProcessor can be changed using an init param in solrconfig,xml:&lt;/p&gt;

&lt;p&gt;  &amp;lt;requestHandler name=&quot;/update&quot; class=&quot;solr.XmlUpdateRequestHandler&quot; &amp;gt;&lt;br/&gt;
    &amp;lt;str name=&quot;update.processor.class&quot;&amp;gt;org.apache.solr.handler.UpdateRequestProcessor&amp;lt;/str&amp;gt;&lt;br/&gt;
  &amp;lt;/requestHandler&amp;gt;&lt;/p&gt;

&lt;p&gt;Moved the XPP version to XppUpdateRequestHandler and mapped it to:&lt;br/&gt;
  &amp;lt;requestHandler name=&quot;/update/xpp&quot; class=&quot;solr.XppUpdateRequestHandler&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;My initial (not accurate) tests don&apos;t show any significant time difference between the two &amp;#8211; we should keep both in the code until we are confident the new one is stable.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;- - - -&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thorsten - can you check if the STAX includes are all in good shape?  Is it ok to use:&lt;br/&gt;
 import javanet.staxutils.BaseXMLInputFactory;&lt;/p&gt;
</comment>
                            <comment id="12504535" author="ryantxu" created="Thu, 14 Jun 2007 05:23:59 +0100"  >&lt;p&gt;dooh &amp;#8211; wrong issue&lt;/p&gt;</comment>
                            <comment id="12505003" author="ryantxu" created="Fri, 15 Jun 2007 03:09:14 +0100"  >&lt;p&gt;updated to apply with trunk + &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-262&quot; title=&quot;convert SolrInputDocument to Document and Document to SolrDocument&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-262&quot;&gt;&lt;del&gt;SOLR-262&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Changed it to sit next to XmlUpdateRequestHandler &amp;#8211; this way it can be evaluated next to XmlUpdateRequestHandler  rather then replace it.&lt;/p&gt;

&lt;p&gt;The UpdateRequestProcessor interface needs review, but I think it can be done CTR...&lt;/p&gt;</comment>
                            <comment id="12509322" author="ryantxu" created="Sat, 30 Jun 2007 19:53:16 +0100"  >&lt;p&gt;this is the default implementation since r552198&lt;/p&gt;</comment>
                            <comment id="12579140" author="hossman" created="Sun, 16 Mar 2008 03:23:52 +0000"  >&lt;p&gt;This bug was modified as part of a bulk update using the criteria...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Marked &quot;Resolved&quot; and &quot;Fixed&quot;&lt;/li&gt;
	&lt;li&gt;Had no &quot;Fix Version&quot; versions&lt;/li&gt;
	&lt;li&gt;Was listed in the CHANGES.txt for 1.3 as of today 2008-03-15&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The Fix Version for all 29 issues found was set to 1.3, email notification was suppressed to prevent excessive email.&lt;/p&gt;

&lt;p&gt;For a list of all the issues modified, search jira comments for this (hopefully) unique string: batch20070315hossman1&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12359916">SOLR-96</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12359795" name="SOLR-133-XmlUpdateRequestHandler-StAX-139.patch" size="23119" author="ryantxu" created="Fri, 15 Jun 2007 03:09:14 +0100"/>
                            <attachment id="12359653" name="SOLR-133-XmlUpdateRequestHandler-StAX-139.patch" size="50665" author="ryantxu" created="Thu, 14 Jun 2007 03:31:29 +0100"/>
                            <attachment id="12358823" name="SOLR-133-XmlUpdateRequestHandler-StAX-139.patch" size="26529" author="ryantxu" created="Mon, 4 Jun 2007 08:09:24 +0100"/>
                            <attachment id="12356496" name="SOLR-133-XmlUpdateRequestHandler-StAX-139.patch" size="25639" author="ryantxu" created="Mon, 30 Apr 2007 01:40:46 +0100"/>
                            <attachment id="12354803" name="SOLR-133-XmlUpdateRequestHandler-StAX-139.patch" size="27344" author="ryantxu" created="Tue, 3 Apr 2007 02:19:32 +0100"/>
                            <attachment id="12352725" name="SOLR-133-XmlUpdateRequestHandler-StAX-139.patch" size="27344" author="ryantxu" created="Tue, 6 Mar 2007 09:25:50 +0000"/>
                            <attachment id="12351749" name="SOLR-133-XmlUpdateRequestHandler-StAX-139.patch" size="28374" author="ryantxu" created="Thu, 22 Feb 2007 00:34:31 +0000"/>
                            <attachment id="12350888" name="SOLR-133-XmlUpdateRequestHandler-StAX-139.patch" size="28148" author="ryantxu" created="Sun, 11 Feb 2007 23:55:53 +0000"/>
                            <attachment id="12350286" name="SOLR-133.diff" size="24154" author="thorsten" created="Sat, 3 Feb 2007 21:55:08 +0000"/>
                            <attachment id="12350280" name="SOLR-133.diff" size="21133" author="thorsten" created="Sat, 3 Feb 2007 18:06:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 1 Feb 2007 22:43:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7451</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxt73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21049</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>