<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:17:03 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-1695/SOLR-1695.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-1695]  Missleading error message when adding docs with missing/multiple value(s) for uniqueKey field</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1695</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Sometimes users don&apos;t seem to notice/understand the &amp;lt;uniqueKey/&amp;gt; declaration in the example schema, and the error message they get if their documents don&apos;t include that field is confusing...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.solr.common.SolrException: Document [&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;] missing required field: id
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...because they get an almost identical error even if they remove &lt;tt&gt;required=true&lt;/tt&gt; from &lt;tt&gt;&amp;lt;field name=&quot;id&quot; /&amp;gt;&lt;/tt&gt; in their schema.xml file.&lt;/p&gt;

&lt;p&gt;We should improve the error message so it&apos;s clear when a Document is missing the &quot;uniqueKeyField&quot; (not just a &quot;required&quot; field) so they know the terminology to look for in diagnosing the problem.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://old.nabble.com/solr-1.4-csv-import-----Document-missing-required-field%3A-id-to26990048.html#a26990779&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://old.nabble.com/solr-1.4-csv-import-----Document-missing-required-field%3A-id-to26990048.html#a26990779&lt;/a&gt;&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12444561">SOLR-1695</key>
            <summary> Missleading error message when adding docs with missing/multiple value(s) for uniqueKey field</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Hoss Man</assignee>
                                    <reporter username="hossman">Hoss Man</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Jan 2010 06:14:32 +0000</created>
                <updated>Wed, 30 Mar 2011 16:45:59 +0100</updated>
                            <resolved>Thu, 18 Feb 2010 21:30:49 +0000</resolved>
                                                    <fixVersion>1.5</fixVersion>
                    <fixVersion>3.1</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12835059" author="hossman" created="Thu, 18 Feb 2010 00:04:47 +0000"  >&lt;p&gt;Committed revision 911228.&lt;br/&gt;
Committed revision 911232.&lt;/p&gt;

&lt;p&gt;I added an explicit checks for the number of uniqueKey values being != 1 early on in DocumentBuilder.toDocument.  Prior to this, multiple values weren&apos;t checked for until the doc made it all the way to the UpdateHandler.&lt;/p&gt;</comment>
                            <comment id="12835060" author="hossman" created="Thu, 18 Feb 2010 00:05:26 +0000"  >&lt;p&gt;revising summary&lt;/p&gt;</comment>
                            <comment id="12835279" author="yseeley@gmail.com" created="Thu, 18 Feb 2010 16:31:25 +0000"  >&lt;p&gt;reopening - this broke the build.&lt;/p&gt;</comment>
                            <comment id="12835334" author="hossman" created="Thu, 18 Feb 2010 19:02:41 +0000"  >&lt;p&gt;Doh!&lt;/p&gt;

&lt;p&gt;Note to self: don&apos;t just run the tests, remember to look at the results as well.&lt;/p&gt;

&lt;p&gt;The DocumentBuilderTest failures make sense: they use a schema with uniqueKey defined, but add docs w/o that field to test other behaviors of toDocument.  They passed prior to this change because the only tested to toDocument method in isolation, andthe test for a missing uniqueKey was missing from that method.  I think it&apos;s safe to consider these tests broken as written, since toDocument does do schema validation &amp;#8211; it just wasn&apos;t doing the uniqueKey validation before.  So i&apos;ll modify those tests to include a value for the uniqueKey field&lt;/p&gt;

&lt;p&gt;the ConvertedLegacyTest failure confuses me though ... it also adds docs w/o a uniqueKey field even though the schema requires one, but they do full adds so it&apos;s not obvious from the surface why it was ever passing before ... i want to think about that a little more before just &quot;fixing&apos; the test &amp;#8211; it may be masking another bug.&lt;/p&gt;</comment>
                            <comment id="12835343" author="yseeley@gmail.com" created="Thu, 18 Feb 2010 19:16:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;the ConvertedLegacyTest failure confuses me though&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;schema.xml does not require the &quot;id&quot; field, and the failing add explicitly says &quot;allowDups=false&quot; (legacy speak for overwrite=false)&lt;/p&gt;</comment>
                            <comment id="12835364" author="hossman" created="Thu, 18 Feb 2010 19:48:37 +0000"  >&lt;p&gt;Hmmm.... ok so the reason the legacy test passed prior to this change is that DirectUpdateHandler2 (and DirectUpdateHandler from what i can tell) don&apos;t bother checking for a uniqueKey (or for multiple uniqueKeys) if allowDups=&quot;true&quot; (which it is in the line of ConvertedLEgacyTest that&apos;s failing).&lt;/p&gt;

&lt;p&gt;So the question becomes: Is it a bug that DUH(2) allow docs w/o a uniqueKey field just because allowDups=true?&lt;/p&gt;

&lt;p&gt;If it&apos;s not a bug, then this entire patch should probably be rolled back &amp;#8211; but personally It feels like it really is a bug: if a schema declares a uniqueKey field, then just because a particular add command says allowDups=true doesn&apos;t mean that docs w/o an id (or with multiple ids) should be allowed in to the index &amp;#8211; those docs will need meaningful ids if/when a later commit does want to override them (consider the case of doing an initial build w/ allowDups=true for speed, and then incremental updates w/ allowDups=false ... the index needs to be internally consistent.&lt;/p&gt;

&lt;p&gt;Actually: I&apos;m just going to roll this entire patch back either way &amp;#8211; we can improve the error messages generated by DirectUpdateHandler2 and eliminate the redundant uniqueKey check in DocumentBuilder.toDocument.  As a separate issue we can consider whether DUH2 is buggy.&lt;/p&gt;</comment>
                            <comment id="12835373" author="hossman" created="Thu, 18 Feb 2010 19:58:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;schema.xml does not require the &quot;id&quot; field, and the failing add explicitly says &quot;allowDups=false&quot; (legacy speak for overwrite=false)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;...it doesn&apos;t require &quot;id&quot; but it does declare &quot;id&quot; as the uniqueKey field ... even if it&apos;s allowing dups shouldn&apos;t it ensure that the docs has 1 and only one value for the uniqueKey field?&lt;/p&gt;</comment>
                            <comment id="12835381" author="yseeley@gmail.com" created="Thu, 18 Feb 2010 20:17:32 +0000"  >&lt;blockquote&gt;&lt;p&gt;...it doesn&apos;t require &quot;id&quot; but it does declare &quot;id&quot; as the uniqueKey field ... even if it&apos;s allowing dups shouldn&apos;t it ensure that the docs has 1 and only one value for the uniqueKey field?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That depends... it makes sense for &quot;normal&quot; documents, but I&apos;ve seen people that add a few auxillary documents to their index that used different fields, including the id field.  But it&apos;s not like you gain greater power by allowing that - those usecases could be covered by forcing the user to come up with a uniqueKey value too... it would just be a little more work.&lt;/p&gt;
</comment>
                            <comment id="12835412" author="hossman" created="Thu, 18 Feb 2010 21:30:49 +0000"  >&lt;p&gt;Committed revision 911595.&lt;/p&gt;

&lt;p&gt;rolledback the changes to DocumentBuilder and improved the existing error messages in UpdateHandler instead.&lt;/p&gt;</comment>
                            <comment id="12872785" author="hossman" created="Fri, 28 May 2010 04:00:12 +0100"  >

&lt;p&gt;Correcting Fix Version based on CHANGES.txt, see this thread for more details...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/lucene-dev/201005.mbox/%3Calpine.DEB.1.10.1005251052040.24672@radix.cryptio.net%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/lucene-dev/201005.mbox/%3Calpine.DEB.1.10.1005251052040.24672@radix.cryptio.net%3E&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13013248" author="gsingers" created="Wed, 30 Mar 2011 16:45:59 +0100"  >&lt;p&gt;Bulk close for 3.1.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12456714">SOLR-1780</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 18 Feb 2010 16:31:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5965</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxjqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19517</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>