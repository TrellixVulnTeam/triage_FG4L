<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:18:18 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-700/SOLR-700.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-700] NumberFormatTransformer should have configurable locales</title>
                <link>https://issues.apache.org/jira/browse/SOLR-700</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;NumberFormatTransformer uses a NumberFormatter which relies on the system locale. This makes it impossible to use NumberFormatTransformer with data whose locale does not match the system locale.&lt;/p&gt;

&lt;p&gt;TestNumberFormatTransformer fails on some locales for similar reasons because the grouping symbol differs in different locales.&lt;/p&gt;

&lt;p&gt;This issue adds a locale attribute for NumberFormatTransformer which allows the user to specify the locale which should be used for formatting. The locale must be specified as land-country e.g. en-US&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;field column=&lt;span class=&quot;code-quote&quot;&gt;&quot;myNumber&quot;&lt;/span&gt; formatStyle=&lt;span class=&quot;code-quote&quot;&gt;&quot;number&quot;&lt;/span&gt; locale=&lt;span class=&quot;code-quote&quot;&gt;&quot;de-DE&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </description>
                <environment></environment>
        <key id="12402369">SOLR-700</key>
            <summary>NumberFormatTransformer should have configurable locales</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalinmangar">Shalin Shekhar Mangar</assignee>
                                    <reporter username="dlx">Stefan Oestreicher</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Aug 2008 12:36:59 +0100</created>
                <updated>Fri, 10 May 2013 11:40:13 +0100</updated>
                            <resolved>Fri, 15 Aug 2008 09:49:59 +0100</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.3</fixVersion>
                                    <component>contrib - DataImportHandler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12622529" author="dlx" created="Thu, 14 Aug 2008 13:17:08 +0100"  >&lt;p&gt;based on Shalins suggestion to add an attribute for the locale I prepared another patch implementing those changes.&lt;/p&gt;</comment>
                            <comment id="12622530" author="shalinmangar" created="Thu, 14 Aug 2008 13:31:04 +0100"  >&lt;p&gt;Thanks Stefan.&lt;/p&gt;

&lt;p&gt;I was thinking about having a locale attribute on each field element in data-config.xml. We should modify the NumberFormatTransformer#transformRow method to read each field&apos;s locale attribute. Every field&apos;s attributes are exposed as a map, so we should have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// Each locale must be of format lang:country e.g. en-US
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; locale = fld.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;locale&quot;&lt;/span&gt;);
&lt;span class=&quot;code-comment&quot;&gt;// Create a locale object based on  language and country and pass it to the process method&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That way locale will be configurable on a per-field basis and no EntityProcessor would need to be modified.&lt;/p&gt;</comment>
                            <comment id="12622531" author="dlx" created="Thu, 14 Aug 2008 13:50:09 +0100"  >&lt;p&gt;I see, that&apos;s certainly more flexible. I modified the patch.&lt;/p&gt;</comment>
                            <comment id="12622534" author="dlx" created="Thu, 14 Aug 2008 13:54:50 +0100"  >&lt;p&gt;minor update using the LOCALE constant instead of literal String.&lt;/p&gt;</comment>
                            <comment id="12622539" author="dlx" created="Thu, 14 Aug 2008 14:01:42 +0100"  >&lt;p&gt;setting the locale to the default locale just to have it changed afterwards if the parameter exists is not very nice I guess, so I changed that as well.&lt;/p&gt;

&lt;p&gt;Furthermore the user should probably be notified if he supplies an invalid locale, but I&apos;m unsure how to proceed in this case, so I leave this for now as it is.&lt;/p&gt;</comment>
                            <comment id="12622561" author="shalinmangar" created="Thu, 14 Aug 2008 15:18:13 +0100"  >&lt;p&gt;This is great, thanks Stefan!&lt;/p&gt;

&lt;p&gt;IMO, one JIRA issue should deal with one task. Do you mind opening another issue for the DateField and LegacyDateField bug and attach it&apos;s patch there? I shall commit your NumberFormatTransformer enhancement patch, edit this issue&apos;s description and update the wiki docs.&lt;/p&gt;</comment>
                            <comment id="12622564" author="dlx" created="Thu, 14 Aug 2008 15:27:17 +0100"  >&lt;p&gt;done: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-701&quot; title=&quot;DateField implicitly uses default locale to format milliseconds&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-701&quot;&gt;&lt;del&gt;SOLR-701&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12622596" author="shalinmangar" created="Thu, 14 Aug 2008 17:22:19 +0100"  >&lt;p&gt;A new patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-700&quot; title=&quot;NumberFormatTransformer should have configurable locales&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-700&quot;&gt;&lt;del&gt;SOLR-700&lt;/del&gt;&lt;/a&gt;.patch) based on Stefan&apos;s work with the following changes:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Changed the locale parsing code to use pre-compiled regex.&lt;/li&gt;
	&lt;li&gt;Throw an exception if an invalid value (which does not match the regex) is specified. Interestingly, the java.util.Locale class&apos;s docs do not say anything about invalid language or countries.&lt;/li&gt;
	&lt;li&gt;Modified TestNumberFormatTransformer to demonstrate the fix and enhancement.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I will commit this shortly.&lt;/p&gt;</comment>
                            <comment id="12622603" author="dlx" created="Thu, 14 Aug 2008 17:48:30 +0100"  >&lt;p&gt;Nice. I also stumbled upon the fact that the java docs don&apos;t say anything about invalid locales. I quickly tested that and interestingly the DateFormatSymbols instance returned &quot;.&quot; as decimal and &quot;,&quot; as grouping separator. I would&apos;ve expected the default locale (which is de-AT in my case) to be used but obviously it did not. In any case the getISO3Country method of the Locale class (among others) throws an exception if it&apos;s invoked on an invalid locale. Maybe it would be best to check all available locales explicitly instead of relying on the regex, possibly by constructing a static HashMap of them?!&lt;/p&gt;</comment>
                            <comment id="12622650" author="shalinmangar" created="Thu, 14 Aug 2008 20:16:46 +0100"  >&lt;blockquote&gt;&lt;p&gt;In any case the getISO3Country method of the Locale class (among others) throws an exception if it&apos;s invoked on an invalid locale. Maybe it would be best to check all available locales explicitly instead of relying on the regex, possibly by constructing a static HashMap of them?!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We don&apos;t need to be paranoid about this because if such a Locale is used for parsing, the NumberFormat#getInstance will throw a MissingResourceException for the lack of corresponding resource bundle.&lt;/p&gt;

&lt;p&gt;Reading through the docs, another area I&apos;m becoming concerned about is partial parsing of the string.  Pehaps we should use ParsePosition and verify that the whole string was actually used. See the section on validation at &lt;a href=&quot;http://www.ibm.com/developerworks/java/library/j-numberformat/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.ibm.com/developerworks/java/library/j-numberformat/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12622709" author="dlx" created="Thu, 14 Aug 2008 22:24:18 +0100"  >&lt;blockquote&gt;&lt;p&gt;We don&apos;t need to be paranoid about this &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ok.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Reading through the docs, another area I&apos;m becoming concerned about is partial parsing of the string&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I see. Interestingly this behaviour of accepting invalid strings seems to only apply to the generic formatter. I wrote some tests and one of them uses a percent formatter (I also tested currency) and that throws a ParseException.&lt;br/&gt;
Fixing that seems to be even easier than shown in the example &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I already have a patch ready but I guess I should open another issue for this (seems pretty seperate to me)?&lt;/p&gt;</comment>
                            <comment id="12622711" author="shalinmangar" created="Thu, 14 Aug 2008 22:29:17 +0100"  >&lt;blockquote&gt;&lt;p&gt;Fixing that seems to be even easier than shown in the example  I already have a patch ready but I guess I should open another issue for this (seems pretty seperate to me)?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;By all means, go ahead &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I will commit this one now.&lt;/p&gt;</comment>
                            <comment id="12622839" author="shalinmangar" created="Fri, 15 Aug 2008 09:49:59 +0100"  >&lt;p&gt;Committed revision 686176.&lt;/p&gt;

&lt;p&gt;Thanks Stefan!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12388254" name="SOLR-700.patch" size="6292" author="shalinmangar" created="Thu, 14 Aug 2008 17:22:19 +0100"/>
                            <attachment id="12388233" name="handler.dataimport.NumberFormatTransformer-locale.patch..txt" size="3023" author="dlx" created="Thu, 14 Aug 2008 14:01:42 +0100"/>
                            <attachment id="12388232" name="handler.dataimport.NumberFormatTransformer-locale.patch..txt" size="2976" author="dlx" created="Thu, 14 Aug 2008 13:54:50 +0100"/>
                            <attachment id="12388229" name="handler.dataimport.NumberFormatTransformer-locale.patch..txt" size="2978" author="dlx" created="Thu, 14 Aug 2008 13:50:09 +0100"/>
                            <attachment id="12388228" name="handler.dataimport.NumberFormatTransformer-locale.patch..txt" size="2056" author="dlx" created="Thu, 14 Aug 2008 13:17:08 +0100"/>
                            <attachment id="12388225" name="handler.dataimport.TestNumberFormatTransformer-locale.patch.txt" size="1846" author="dlx" created="Thu, 14 Aug 2008 12:37:17 +0100"/>
                            <attachment id="12388226" name="schema.DateField-locale.patch.txt" size="1293" author="dlx" created="Thu, 14 Aug 2008 12:37:36 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 14 Aug 2008 12:31:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6916</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxpqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20490</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>