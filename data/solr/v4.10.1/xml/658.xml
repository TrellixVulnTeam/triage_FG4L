<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:19:40 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-658/SOLR-658.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-658] Allow Solr to load index from arbitrary directory in dataDir</title>
                <link>https://issues.apache.org/jira/browse/SOLR-658</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;This is a requirement for java based Solr replication &lt;/p&gt;

&lt;p&gt;Usecase for arbitrary index directory:&lt;br/&gt;
if the slave has a corrupted index and the filesystem does not allow overwriting files in use (NTFS) replication will fail. The solution is to copy the index from master to an alternate directory on slave and load indexreader/indexwriter from this alternate directory.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12400990">SOLR-658</key>
            <summary>Allow Solr to load index from arbitrary directory in dataDir</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalinmangar">Shalin Shekhar Mangar</assignee>
                                    <reporter username="noble.paul">Noble Paul</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Jul 2008 09:30:14 +0100</created>
                <updated>Tue, 10 Nov 2009 15:51:43 +0000</updated>
                            <resolved>Sun, 29 Mar 2009 07:22:39 +0100</resolved>
                                    <version>1.4</version>
                                    <fixVersion>1.4</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12616801" author="noble.paul" created="Fri, 25 Jul 2008 09:35:25 +0100"  >&lt;p&gt;Implementation &lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;keep a file index.properties in the data dir&lt;/li&gt;
	&lt;li&gt;Have an entry index=&amp;lt;new.index&amp;gt; in that file&lt;/li&gt;
	&lt;li&gt;This file may also keep &lt;em&gt;version&lt;/em&gt;&lt;/li&gt;
	&lt;li&gt;When a new indexsearcher/writer is loaded, read this property and try to load the index from that folder&lt;/li&gt;
	&lt;li&gt;if it is absent , default to the hardcoded value for index and latest commitpoint&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="12625986" author="shalinmangar" created="Wed, 27 Aug 2008 07:50:34 +0100"  >&lt;p&gt;This is cut out of the &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-561&quot; title=&quot;Solr replication by Solr (for windows also)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-561&quot;&gt;&lt;del&gt;SOLR-561&lt;/del&gt;&lt;/a&gt; patch supports loading index from an arbitrary directory.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Changes&lt;/b&gt;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;A new method SolrCore#getNewIndexDir() is introduced which tries to read the latest indexDir from index.properties file. If that file is not present the default value (dataDir + &quot;index/&quot;)&lt;/li&gt;
	&lt;li&gt;SolrIndexSearcher now stores the path (indexDir) on which it is opened and has a getter for it.&lt;/li&gt;
	&lt;li&gt;When SolrCore#getIndexDir() is called, it gives the current searcher&apos;s index directory, failing which the default value is given&lt;/li&gt;
	&lt;li&gt;SolrIndexSearcher is always created with getNewIndexDir() and UpdateHandler also uses getNewIndexDir() to open IndexWriter instances.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;TODO:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Add a test&lt;/li&gt;
	&lt;li&gt;Add feature for loading arbitrary commit point.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12634083" author="akshay" created="Wed, 24 Sep 2008 10:50:48 +0100"  >&lt;p&gt;Patch in sync with trunk and with a test case (loading arbitrary commit point feature not supported in this patch).&lt;/p&gt;</comment>
                            <comment id="12637081" author="akshay" created="Mon, 6 Oct 2008 12:12:36 +0100"  >&lt;p&gt;Patch in sync with the trunk.&lt;/p&gt;</comment>
                            <comment id="12637830" author="shalinmangar" created="Wed, 8 Oct 2008 09:21:52 +0100"  >&lt;p&gt;Thanks Akshay.&lt;/p&gt;

&lt;p&gt;Updated patch which calls getNewIndexDir before calling IndexReader#reopen so that if the new index directory is different from the old index directory, we always create a new SolrIndexSearcher with the new index directory.&lt;/p&gt;

&lt;p&gt;I&apos;d like to commit this in the next two or three days if there are no objections.&lt;/p&gt;</comment>
                            <comment id="12638732" author="shalinmangar" created="Sat, 11 Oct 2008 10:06:36 +0100"  >&lt;p&gt;Updated with a bug fix:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (result != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; result.trim().length() &amp;gt; 0) {
        File tmp = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(dataDir + s);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tmp.exists() &amp;amp;&amp;amp; tmp.isDirectory())
          result = dataDir + s;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (s != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; s.trim().length() &amp;gt; 0) {
        File tmp = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(dataDir + s);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tmp.exists() &amp;amp;&amp;amp; tmp.isDirectory())
          result = dataDir + s;
      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll commit shortly.&lt;/p&gt;</comment>
                            <comment id="12638980" author="shalinmangar" created="Mon, 13 Oct 2008 10:05:15 +0100"  >&lt;p&gt;Instead of comparing path strings, we should compare the corresponding File objects to handle relative and absolute paths correctly.&lt;/p&gt;

&lt;p&gt;Patch to cover the above case.&lt;/p&gt;</comment>
                            <comment id="12638983" author="shalinmangar" created="Mon, 13 Oct 2008 10:07:12 +0100"  >&lt;p&gt;Removing reference to rollbacks and commit points which is being handled in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-670&quot; title=&quot;UpdateHandler must provide a rollback feature&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-670&quot;&gt;&lt;del&gt;SOLR-670&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12638984" author="shalinmangar" created="Mon, 13 Oct 2008 10:13:16 +0100"  >&lt;p&gt;Committed revision 703981.&lt;/p&gt;

&lt;p&gt;Thanks Noble and Akshay!&lt;/p&gt;</comment>
                            <comment id="12669010" author="yseeley@gmail.com" created="Fri, 30 Jan 2009 20:26:00 +0000"  >&lt;p&gt;This causes reopen() to never be used on Windows because the following condition comes up false:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(getIndexDir()).equals(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(newIndexDir)))  {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</comment>
                            <comment id="12670088" author="shalinmangar" created="Tue, 3 Feb 2009 20:02:41 +0000"  >&lt;p&gt;Copying over from the solr-dev thread on failing tests:&lt;/p&gt;

&lt;p&gt;The first problem is that File.equals compares only the path and not the absolute path. A work around is to compare absolute path ourselves. But a bigger problem is with the canonical paths where long directory names is uppercased and shortened into 8 character names (e.g. &quot;C:\Documents and Settings&quot; becomes &quot;C:\DOCUME~1&quot;).&lt;/p&gt;

&lt;p&gt;The test fails because we use java.io.tmpdir which defaults to user&apos;s home directory (shortened and canonicalized) on windows and comparison on this path fails. What I&apos;m not able to figure out yet is why does Slave Jetty, running on this canonical path, returns the full path of the index directory.&lt;/p&gt;

&lt;p&gt;Slave&apos;s SolrCore.getIndexDir gives:&lt;br/&gt;
C:\Documents and Settings\shalinsmangar\Local Settings\Temp\org.apache.solr.handler.TestReplicationHandler$SolrInstance-1233681533000master\data\index&lt;/p&gt;

&lt;p&gt;The value written by TestReplicationHandler is:&lt;br/&gt;
C:\DOCUME~1\SHALIN~1\LOCALS~1\Temp\org.apache.solr.handler.TestReplicationHandler$SolrInstance-1233681533000master\data\index&lt;/p&gt;</comment>
                            <comment id="12690122" author="shalinmangar" created="Fri, 27 Mar 2009 21:49:43 +0000"  >&lt;p&gt;I should read javadocs more. This patch compares the index directories using their canonical paths This fixes the problem on windows.&lt;/p&gt;</comment>
                            <comment id="12693525" author="shalinmangar" created="Sun, 29 Mar 2009 07:22:39 +0100"  >&lt;p&gt;Committed revision 759641.&lt;/p&gt;</comment>
                            <comment id="12775518" author="gsingers" created="Tue, 10 Nov 2009 15:51:43 +0000"  >&lt;p&gt;Bulk close for Solr 1.4&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12395304">SOLR-561</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12403847" name="SOLR-658-reopen-windows-fix.patch" size="734" author="shalinmangar" created="Fri, 27 Mar 2009 21:49:43 +0000"/>
                            <attachment id="12391990" name="SOLR-658.patch" size="10457" author="shalinmangar" created="Mon, 13 Oct 2008 10:05:15 +0100"/>
                            <attachment id="12391933" name="SOLR-658.patch" size="10437" author="shalinmangar" created="Sat, 11 Oct 2008 10:06:36 +0100"/>
                            <attachment id="12391717" name="SOLR-658.patch" size="10367" author="shalinmangar" created="Wed, 8 Oct 2008 09:21:52 +0100"/>
                            <attachment id="12391534" name="SOLR-658.patch" size="9526" author="akshay" created="Mon, 6 Oct 2008 12:12:36 +0100"/>
                            <attachment id="12390823" name="SOLR-658.patch" size="9574" author="akshay" created="Wed, 24 Sep 2008 10:50:48 +0100"/>
                            <attachment id="12388980" name="SOLR-658.patch" size="5280" author="shalinmangar" created="Wed, 27 Aug 2008 07:50:34 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 27 Aug 2008 06:50:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6956</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxpzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20531</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>