<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:17:43 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-132/SOLR-132.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-132] i18n solrb test patch</title>
                <link>https://issues.apache.org/jira/browse/SOLR-132</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Some unit test in regards to i18n. I didn&apos;t create a separate i18n.rb cos it is nothing but testing new &quot;characters&quot;. Please let me know if you would like to have it as a separate file.. I also added some functional test i.e. i18n_full_cycle_test. &lt;/p&gt;

&lt;p&gt;This is my first patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I am sure I have made mistake so please do come back with things that you would like me to change!&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12361728">SOLR-132</key>
            <summary>i18n solrb test patch</summary>
                <type id="6" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/requirement.png">Test</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ehatcher">Erik Hatcher</assignee>
                                    <reporter username="antonio_eggberg">Antonio Eggberg</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Feb 2007 11:26:57 +0000</created>
                <updated>Fri, 2 Feb 2007 03:35:26 +0000</updated>
                            <resolved>Fri, 2 Feb 2007 03:35:26 +0000</resolved>
                                                                    <component>clients - ruby - flare</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12469414" author="antonio_eggberg" created="Thu, 1 Feb 2007 11:29:36 +0000"  >&lt;p&gt;Attached i18n unit and functional test patch&lt;/p&gt;</comment>
                            <comment id="12469428" author="ehatcher" created="Thu, 1 Feb 2007 13:47:32 +0000"  >&lt;p&gt;Thanks for that patch!   Since this is your first patch, I&apos;ll comment on it:&lt;/p&gt;

&lt;p&gt;&amp;gt; Index: client/ruby/solrb/test/unit/delete_test.rb&lt;/p&gt;

&lt;p&gt;First, you can make the diffs from the solrb directory instead of the root of solr itself. &lt;/p&gt;

&lt;p&gt;&amp;#8212; client/ruby/solrb/test/unit/delete_test.rb	(revision 502165)&lt;br/&gt;
+++ client/ruby/solrb/test/unit/delete_test.rb	(working copy)&lt;br/&gt;
@@ -48,4 +48,9 @@&lt;br/&gt;
     assert_equal false, response.ok? &lt;br/&gt;
   end&lt;/p&gt;

&lt;p&gt;+  def test_delete_by_i18n_query_request&lt;br/&gt;
+    request = Solr::Request::Delete.new(:query =&amp;gt; &apos;&#235;&#228;&#239;&#246;&#252;&apos;)&lt;br/&gt;
+    assert_equal &quot;&amp;lt;delete&amp;gt;&amp;lt;query&amp;gt;&#235;&#228;&#239;&#246;&#252;&amp;lt;/query&amp;gt;&amp;lt;/delete&amp;gt;&quot;, request.to_s&lt;br/&gt;
+  end&lt;br/&gt;
+&lt;/p&gt;

&lt;p&gt;The above is a good test, ensures the XML gets generated as expected.&lt;/p&gt;

&lt;p&gt;+  def test_i18n_xml&lt;br/&gt;
+    field = Solr::Field.new :i18nstring =&amp;gt; &apos;&#196;&#234;&#226;&#238;&#244;&#251; &#214;&#235;&#228;&#239;&#246;&#252;&apos;&lt;br/&gt;
+    assert_kind_of REXML::Element, field.to_xml&lt;br/&gt;
+    assert_equal &quot;&amp;lt;field name=&apos;i18nstring&apos;&amp;gt;&#196;&#234;&#226;&#238;&#244;&#251; &#214;&#235;&#228;&#239;&#246;&#252;&amp;lt;/field&amp;gt;&quot;, field.to_xml.to_s&lt;br/&gt;
+  end&lt;br/&gt;
+  &lt;/p&gt;

&lt;p&gt;The above is also another good one.&lt;/p&gt;

&lt;p&gt;+  def test_add_i18n_document_response&lt;br/&gt;
+    conn = Solr::Connection.new(&apos;http://localhost:9999/solr&apos;)&lt;br/&gt;
+    set_post_return(&apos;&amp;lt;result status=&quot;0&quot;&amp;gt;&amp;lt;/result&amp;gt;&apos;)&lt;br/&gt;
+    doc = {:id =&amp;gt; &apos;123&apos;, :text =&amp;gt; &apos;&amp;amp; Clyde, &amp;lt;nicetag/&amp;gt;, &#235;&#228;&#239;&#246;&#252; &#234;&#226;&#238;&#244;&#251;&#229;&apos;}&lt;br/&gt;
+    response = conn.send(Solr::Request::AddDocument.new(doc))&lt;br/&gt;
+    assert_equal true, response.ok?&lt;br/&gt;
+  end&lt;/p&gt;

&lt;p&gt;This doesn&apos;t test anything really, since a mock connection is being used.  This is really only testing that the &amp;lt;result&amp;gt; is being parsed successfully, but nothing to do with the add document request.&lt;/p&gt;

&lt;p&gt;+  def test_bad_i18n_add_document_response&lt;br/&gt;
+    conn = Solr::Connection.new(&apos;http://localhost:9999/solr&apos;)&lt;br/&gt;
+    set_post_return(&apos;&amp;lt;result status=&quot;400&quot;&amp;gt;&amp;lt;/result&amp;gt;&apos;)&lt;br/&gt;
+    doc = {:id =&amp;gt; &apos;123&apos;, :text =&amp;gt; &apos;&amp;amp; Clyde, &amp;lt;nicetag/&amp;gt;, &#235;&#228;&#239;&#246;&#252; &#234;&#226;&#238;&#244;&#251;&#229;&apos;}&lt;br/&gt;
+    response = conn.send(Solr::Request::AddDocument.new(doc))&lt;br/&gt;
+    assert_equal false, response.ok?&lt;br/&gt;
+  end&lt;/p&gt;

&lt;p&gt;Again, the above is only testing &amp;lt;result&amp;gt; status parsing.&lt;/p&gt;

&lt;p&gt;+  def test_i18n_shorthand&lt;br/&gt;
+    conn = Solr::Connection.new(&apos;http://localhost:9999/solr&apos;)&lt;br/&gt;
+    set_post_return(&apos;&amp;lt;result status=&quot;0&quot;&amp;gt;&amp;lt;/result&amp;gt;&apos;)&lt;br/&gt;
+    doc = {:id =&amp;gt; &apos;123&apos;, :text =&amp;gt; &apos;&amp;amp; Clyde, &amp;lt;nicetag/&amp;gt;, &#235;&#228;&#239;&#246;&#252; &#234;&#226;&#238;&#244;&#251;&#229;&apos;}&lt;br/&gt;
+    assert_equal true, conn.add(:id =&amp;gt; &apos;123&apos;, :text =&amp;gt; &apos;&amp;amp; Clyde, &amp;lt;nicetag/&amp;gt;, &#235;&#228;&#239;&#246;&#252; &#234;&#226;&#238;&#244;&#251;&#229;&apos;)&lt;br/&gt;
+  end&lt;/p&gt;

&lt;p&gt;And likewise above.&lt;/p&gt;

&lt;p&gt;+  def test_add_i18n_doc_request&lt;br/&gt;
+    request = Solr::Request::AddDocument.new(:title =&amp;gt; &quot;&#197;&#235;&#228;&#239;&#246;&#252;&quot;)&lt;br/&gt;
+    assert_equal &quot;&amp;lt;add&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;field name=&apos;title&apos;&amp;gt;&#197;&#235;&#228;&#239;&#246;&#252;&amp;lt;/field&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;/add&amp;gt;&quot;, request.to_s&lt;br/&gt;
+    assert_equal :xml, request.response_format&lt;br/&gt;
+    assert_equal &apos;update&apos;, request.handler&lt;br/&gt;
+    &lt;br/&gt;
+    assert_raise(RuntimeError) do&lt;br/&gt;
+      Solr::Request::AddDocument.new(&quot;invalid&quot;)&lt;br/&gt;
+    end&lt;br/&gt;
+  end&lt;br/&gt;
+  &lt;br/&gt;
+  def test_add_i18n_multidoc_request&lt;br/&gt;
+    request = Solr::Request::AddDocument.new(&lt;span class=&quot;error&quot;&gt;&amp;#91;{:title =&amp;gt; &amp;quot;&#197;&#235;&#228;&#239;&#246;&#252;&#229;&amp;quot;}, {:title =&amp;gt; &amp;quot;&#196;&#235;&#228;&#239;&#246;&#252;&#246;&#229;&amp;quot;}&amp;#93;&lt;/span&gt;)&lt;br/&gt;
+    assert_equal &quot;&amp;lt;add&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;field name=&apos;title&apos;&amp;gt;&#197;&#235;&#228;&#239;&#246;&#252;&#229;&amp;lt;/field&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;field name=&apos;title&apos;&amp;gt;&#196;&#235;&#228;&#239;&#246;&#252;&#246;&#229;&amp;lt;/field&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;/add&amp;gt;&quot;, request.to_s&lt;br/&gt;
+    assert_equal :xml, request.response_format&lt;br/&gt;
+    assert_equal &apos;update&apos;, request.handler&lt;br/&gt;
+  end&lt;/p&gt;

&lt;p&gt;The above three tests also don&apos;t erally test any functionality that wasn&apos;t already being tested.&lt;/p&gt;


&lt;p&gt;&amp;#8212; client/ruby/solrb/test/functional/server_test.rb	(revision 502165)&lt;br/&gt;
+++ client/ruby/solrb/test/functional/server_test.rb	(working copy)&lt;br/&gt;
@@ -23,7 +23,7 @@&lt;br/&gt;
   include Solr&lt;/p&gt;

&lt;p&gt;   def setup&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;@connection = Connection.new(&quot;http://localhost:8888/solr&quot;, :autocommit =&amp;gt; :on)&lt;br/&gt;
+    @connection = Connection.new(&quot;http://localhost:8983/solr&quot;, :autocommit =&amp;gt; :ok)&lt;br/&gt;
     clean&lt;br/&gt;
   end&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Oops... you shouldn&apos;t change the Solr port.  Maybe you&apos;re running the functional tests outside of Rake?   If you run &quot;rake test&quot; it&apos;ll fire up Solr on port 8888 and run the functional tests against it.   We should, however, extract the URL out to configurable setting though.&lt;/p&gt;

&lt;p&gt;+  def test_i18n_full_lifecycle&lt;br/&gt;
+    # make sure autocommit is on&lt;br/&gt;
+    assert @connection.autocommit&lt;br/&gt;
+&lt;br/&gt;
+    # make sure this doc isn&apos;t there to begin with&lt;br/&gt;
+    @connection.delete(123456)&lt;br/&gt;
+&lt;br/&gt;
+    # add it&lt;br/&gt;
+    @connection.add(:id =&amp;gt; 123456, :text =&amp;gt; &apos;&#197;&#228;&#246;&#234;&#226;&#238;&#244;&#251;&apos;)&lt;br/&gt;
+&lt;br/&gt;
+    # look for it&lt;br/&gt;
+    response = @connection.query(&apos;&#197;&#228;&#246;&#234;&#226;&#238;&#244;&#251;&apos;)&lt;br/&gt;
+    assert_equal 1, response.total_hits&lt;br/&gt;
+    assert_equal &apos;123456&apos;, response.hits&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;id&amp;#39;&amp;#93;&lt;/span&gt;&lt;br/&gt;
+&lt;br/&gt;
+    # delete it&lt;br/&gt;
+    @connection.delete(123456)&lt;br/&gt;
+&lt;br/&gt;
+    # make sure it&apos;s gone&lt;br/&gt;
+    response = @connection.query(&apos;&#197;&#228;&#246;&#234;&#226;&#238;&#244;&#251; &#214;&#235;&#228;&#239;&#246;&#252;&apos;)&lt;br/&gt;
+    assert_equal 0, response.total_hits&lt;br/&gt;
+  end&lt;br/&gt;
+  &lt;/p&gt;

&lt;p&gt;The above is a NICE test and shows the roundtripping of accented characters into Solr and back through the solrb API.  Good one.&lt;/p&gt;

&lt;p&gt;   def test_bad_url&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;conn = Solr::Connection.new &apos;http://localhost:8888/invalid&apos;&lt;br/&gt;
+    conn = Solr::Connection.new &apos;http://localhost:8983/invalid&apos;&lt;br/&gt;
     assert_raise(Net::HTTPServerException) do&lt;br/&gt;
       conn.send(Solr::Request::Ping.new)&lt;br/&gt;
     end&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Again, don&apos;t change this port, but rather run &quot;rake test&quot; instead of using another instance of Solr.&lt;/p&gt;

&lt;p&gt;Thanks for this effort.  I&apos;ll commit your tests after you make these adjustments, and we&apos;ll be on our way to a solid i18n solrb.&lt;/p&gt;</comment>
                            <comment id="12469468" author="antonio_eggberg" created="Thu, 1 Feb 2007 15:46:17 +0000"  >&lt;p&gt;Thanks for your comments and fixes &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. New patch attached.&lt;/p&gt;

&lt;p&gt;I didn&apos;t get &apos;rake test&apos; working in the first pass. cos the delay timeout was 5 sec.. this is why all my test failed. I increased to 20 and all test passed.. &lt;/p&gt;

&lt;p&gt;test_solr_server.rb ..&lt;/p&gt;

&lt;p&gt;      puts &quot;starting solr server&quot;&lt;br/&gt;
      solr_server.start&lt;br/&gt;
      sleep params&lt;span class=&quot;error&quot;&gt;&amp;#91;:startup_wait&amp;#93;&lt;/span&gt; || 5&lt;br/&gt;
      yield&lt;/p&gt;



&lt;p&gt;cheers!&lt;/p&gt;</comment>
                            <comment id="12469647" author="ehatcher" created="Fri, 2 Feb 2007 03:35:26 +0000"  >&lt;p&gt;Thanks Antonio.. applied!   &lt;/p&gt;

&lt;p&gt;Just a minor JIRA thing... if you name a replacement patch filename the same as your original, it&apos;ll handle it nicely and keep the latest handy.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12350148" name="i18n.patch2" size="2106" author="antonio_eggberg" created="Thu, 1 Feb 2007 15:46:16 +0000"/>
                            <attachment id="12350127" name="i18n_test.patch" size="5379" author="antonio_eggberg" created="Thu, 1 Feb 2007 11:29:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 1 Feb 2007 13:47:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7452</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxt7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21050</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>