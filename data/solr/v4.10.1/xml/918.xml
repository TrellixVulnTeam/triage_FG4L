<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:14:53 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-918/SOLR-918.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-918] Thread safety issue in SolrCore.infoRegistry</title>
                <link>https://issues.apache.org/jira/browse/SOLR-918</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;SolrCore.infoRegistry is used for keeping a reference to the SolrInfoMBean objects. When JMX is disabled, it is initialized to a LinkedHashMap which is not synchronized.&lt;/p&gt;

&lt;p&gt;We can change this to a ConcurrentHashMap instead of a LinkedHashMap.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12410766">SOLR-918</key>
            <summary>Thread safety issue in SolrCore.infoRegistry</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalinmangar">Shalin Shekhar Mangar</assignee>
                                    <reporter username="shalinmangar">Shalin Shekhar Mangar</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Dec 2008 06:41:31 +0000</created>
                <updated>Tue, 10 Nov 2009 15:51:53 +0000</updated>
                            <resolved>Wed, 17 Dec 2008 13:11:05 +0000</resolved>
                                                    <fixVersion>1.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12657374" author="shalinmangar" created="Wed, 17 Dec 2008 13:08:57 +0000"  >&lt;p&gt;Patch to change LinkedHashMap to ConcurrentHashMap. I plan to commit shortly.&lt;/p&gt;</comment>
                            <comment id="12657375" author="shalinmangar" created="Wed, 17 Dec 2008 13:11:05 +0000"  >&lt;p&gt;Committed revision 727370.&lt;/p&gt;</comment>
                            <comment id="12657606" author="yseeley@gmail.com" created="Wed, 17 Dec 2008 23:13:04 +0000"  >&lt;p&gt;Hmmm, it used to be a synchronized map.&lt;br/&gt;
Looks like this bug was introduced back in one of those mega-changes, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-215&quot; title=&quot;Multiple Solr Cores - remove static singleton&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-215&quot;&gt;&lt;del&gt;SOLR-215&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12657661" author="shalinmangar" created="Thu, 18 Dec 2008 03:21:39 +0000"  >&lt;p&gt;It was a HashMap in the &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-256&quot; title=&quot;Stats via JMX&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-256&quot;&gt;&lt;del&gt;SOLR-256&lt;/del&gt;&lt;/a&gt; commit but I think it was changed (by me?) to a LinkedHashMap because some users complained that the order of things in stats pages is not the same anymore. Is it ok to let it be a ConcurrentHashMap or should we make it a synchronized LinkedHashMap?&lt;/p&gt;</comment>
                            <comment id="12657885" author="yseeley@gmail.com" created="Thu, 18 Dec 2008 20:24:19 +0000"  >&lt;blockquote&gt;&lt;p&gt;Is it ok to let it be a ConcurrentHashMap or should we make it a synchronized LinkedHashMap&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Either should be fine... new components are added so infrequently and checked so infrequently that there won&apos;t be a performance difference.&lt;/p&gt;

&lt;p&gt;If it&apos;s changed to synchronized LinkedHashMap, it should be noted in the javadoc for SolrCore.getInfoRegistry() (which is new in 1.3) that it&apos;s a synchronized Map and thus users need to synchronize during iteration.  This synchronization is currently being done by all users of this API since it previously was a synchronized map (before the synchronization was mistakenly removed).&lt;/p&gt;

&lt;p&gt;If we stay with ConcurrentHashMap (and hence don&apos;t care about order), then the current synchronization while iterating should probably be removed too.&lt;/p&gt;</comment>
                            <comment id="12658016" author="shalinmangar" created="Fri, 19 Dec 2008 06:04:49 +0000"  >&lt;p&gt;Alright. When JMX is enabled, it uses the JmxMonitoredMap which extends ConcurrentHashMap so order is not maintained anyway. Let&apos;s stick with ConcurrentHashMap, I&apos;ll scan through the code and remove all synchronization during iteration and update the javadocs.&lt;/p&gt;</comment>
                            <comment id="12658021" author="shalinmangar" created="Fri, 19 Dec 2008 06:35:24 +0000"  >&lt;ol&gt;
	&lt;li&gt;Removed synchronization for iterating infoRegistry from stats.jsp and PluginInfoHandler&lt;/li&gt;
	&lt;li&gt;Updated Javadocs for SolrCore#getInfoRegistry to:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * Returns a Map of name vs SolrInfoMBean objects. The returned map is an instance of
+   * a ConcurrentHashMap and therefore no synchronization is needed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; putting, removing
+   * or iterating over it.
+   *
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I plan to commit shortly.&lt;/p&gt;</comment>
                            <comment id="12658022" author="shalinmangar" created="Fri, 19 Dec 2008 06:37:43 +0000"  >&lt;p&gt;Committed revision 727944.&lt;/p&gt;</comment>
                            <comment id="12775610" author="gsingers" created="Tue, 10 Nov 2009 15:51:53 +0000"  >&lt;p&gt;Bulk close for Solr 1.4&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12396467" name="SOLR-918.patch" size="4220" author="shalinmangar" created="Fri, 19 Dec 2008 06:35:24 +0000"/>
                            <attachment id="12396301" name="SOLR-918.patch" size="639" author="shalinmangar" created="Wed, 17 Dec 2008 13:08:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 17 Dec 2008 23:13:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6715</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxoen:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20273</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>