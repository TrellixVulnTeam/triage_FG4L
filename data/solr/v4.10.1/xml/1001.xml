<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:17:32 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-1001/SOLR-1001.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-1001] using invariant request values from solrconfig.xml inside a data-config.xml regexp</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1001</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;As per several postings I noted that I can define variables inside an invariants list section of the DIH handler of solrconfig.xml. I can also reference these variables within data-config.xml. This works properly, the solr field &quot;test&quot; is nicely populated. However it is not substituted into my regex transformer? Here is my  data-config.xml which gives a hint of the use case.&lt;/p&gt;

&lt;p&gt;   &amp;lt;dataConfig&amp;gt;&lt;br/&gt;
   &amp;lt;dataSource name=&quot;myfilereader&quot; type=&quot;FileDataSource&quot;/&amp;gt;    &lt;br/&gt;
    &amp;lt;document&amp;gt;&lt;br/&gt;
       &amp;lt;entity name=&quot;jc&quot;&lt;br/&gt;
	       processor=&quot;FileListEntityProcessor&quot;&lt;br/&gt;
	       fileName=&quot;^.*\.xml$&quot;&lt;br/&gt;
	       newerThan=&quot;&apos;NOW-1000DAYS&apos;&quot;&lt;br/&gt;
	       recursive=&quot;true&quot;&lt;br/&gt;
	       rootEntity=&quot;false&quot;&lt;br/&gt;
	       dataSource=&quot;null&quot;&lt;br/&gt;
	       baseDir=&quot;/Volumes/spare/ts/fords/dtd/fordsxml/data&quot;&amp;gt;&lt;br/&gt;
	  &amp;lt;entity name=&quot;x&quot;&lt;br/&gt;
	          dataSource=&quot;myfilereader&quot;&lt;br/&gt;
		  processor=&quot;XPathEntityProcessor&quot;&lt;br/&gt;
		  url=&quot;$&lt;/p&gt;
{jc.fileAbsolutePath}&quot;&lt;br/&gt;
		  stream=&quot;false&quot;&lt;br/&gt;
		  forEach=&quot;/record&quot;&lt;br/&gt;
		  transformer=&quot;DateFormatTransformer,TemplateTransformer,RegexTransformer,HTMLStripTransformer&quot;&amp;gt;&lt;br/&gt;
&lt;br/&gt;
   &amp;lt;field column=&quot;fileAbsolutePath&quot; template=&quot;${jc.fileAbsolutePath}
&lt;p&gt;&quot; /&amp;gt;&lt;br/&gt;
   &amp;lt;field column=&quot;fileWebPath&quot;      regex=&quot;$&lt;/p&gt;
{dataimporter.request.finstalldir}(.*)&quot; replaceWith=&quot;$1&quot; sourceColName=&quot;fileAbsolutePath&quot;/&amp;gt;&lt;br/&gt;
   &amp;lt;field column=&quot;test&quot;             template=&quot;${dataimporter.request.finstalldir}
&lt;p&gt;&quot; /&amp;gt;&lt;br/&gt;
   &amp;lt;field column=&quot;title&quot;            xpath=&quot;/record/title&quot; /&amp;gt;&lt;br/&gt;
   &amp;lt;field column=&quot;para&quot;             xpath=&quot;/record/sect1/para&quot; stripHTML=&quot;true&quot; /&amp;gt;&lt;br/&gt;
   &amp;lt;field column=&quot;date&quot;             xpath=&quot;/record/metadata/date&lt;span class=&quot;error&quot;&gt;&amp;#91;@qualifier=&amp;#39;Date&amp;#39;&amp;#93;&lt;/span&gt;&quot; dateTimeFormat=&quot;yyyyMMdd&quot;   /&amp;gt;&lt;br/&gt;
   	     &amp;lt;/entity&amp;gt;&lt;br/&gt;
       &amp;lt;/entity&amp;gt;&lt;br/&gt;
       &amp;lt;/document&amp;gt;&lt;br/&gt;
    &amp;lt;/dataConfig&amp;gt;&lt;/p&gt;

&lt;p&gt;Shalin has pointed out that we are creating the regex Pattern without first resolving the variable. So we need to call VariableResolver.resolve on the &apos;regex&apos; attribute&apos;s value before creating the Pattern object.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12413812">SOLR-1001</key>
            <summary>using invariant request values from solrconfig.xml inside a data-config.xml regexp</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalinmangar">Shalin Shekhar Mangar</assignee>
                                    <reporter username="fergus">Fergus McMenemie</reporter>
                        <labels>
                    </labels>
                <created>Mon, 2 Feb 2009 19:20:51 +0000</created>
                <updated>Tue, 10 Nov 2009 15:50:35 +0000</updated>
                            <resolved>Fri, 6 Feb 2009 06:52:30 +0000</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.4</fixVersion>
                                    <component>contrib - DataImportHandler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <timeoriginalestimate seconds="172800">48h</timeoriginalestimate>
                            <timeestimate seconds="172800">48h</timeestimate>
                                        <comments>
                            <comment id="12669705" author="fergus" created="Mon, 2 Feb 2009 19:24:23 +0000"  >&lt;p&gt;I could probably hack around this myself given Shalin&apos;s clue as to the cause. However two possible issues come to mind.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Is it possible that an equivalent change needs made to other transformers?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Is the construct $
{XXX}
&lt;p&gt; a valid part of a regular expression, I dont think so, but.... ?&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12669714" author="shalinmangar" created="Mon, 2 Feb 2009 19:38:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;Is it possible that an equivalent change needs made to other transformers?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, I think so. We need to review other transformer and entity processors to make sure we attempt to resolve all attributes.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is the construct ${XXX} a valid part of a regular expression, I dont think so, but.... ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Curly braces are used in regex to specify repetitions but they are not preceded by &apos;$&apos;. I think VariableResolver ignores any variables it is not able to resolve, so we should be fine; we will need to check this though.&lt;/p&gt;</comment>
                            <comment id="12669874" author="noble.paul" created="Tue, 3 Feb 2009 05:02:19 +0000"  >&lt;p&gt;this just fixes the RegexTransformer. We may take a look at the other Transformers and fix them too&lt;/p&gt;</comment>
                            <comment id="12669926" author="fergus" created="Tue, 3 Feb 2009 11:30:49 +0000"  >&lt;p&gt;Download and installed the patch. Works fine for me. Thanks very much.&lt;/p&gt;</comment>
                            <comment id="12670896" author="shalinmangar" created="Thu, 5 Feb 2009 20:41:03 +0000"  >&lt;p&gt;Would it be alright if we resolve all entity attributes in ContextImpl.getEntityAttribute? Similarily, we can change ContextImpl.getAllEntityFields to resolve field values just-in-time. This would keep this logic in one place and avoid this problem popping up in different places.&lt;/p&gt;</comment>
                            <comment id="12671000" author="noble.paul" created="Fri, 6 Feb 2009 04:09:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;Would it be alright if we resolve all entity attributes in ContextImpl.getEntityAttribute?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;So the components will never be able to get the actual string if they wish to. Moreover it is not backcompat. We can add extra method&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;ContextImpl.getResolvedEntityAttribute&lt;/li&gt;
	&lt;li&gt;ContextImpl.getAllResolvedEntityFields .It is expensive to do that in here because the component may be interested in only one variable and we end up resolving all variables . If we can cache it it may be ok.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="12671019" author="shalinmangar" created="Fri, 6 Feb 2009 06:45:28 +0000"  >&lt;p&gt;I see your point Noble. I don&apos;t really want to have a helper method in Context right now. Lets fix the issue at hand.&lt;/p&gt;

&lt;p&gt;I have made the following changes:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;HTMLStripTransformer allows variable in stripHTML attribute&lt;/li&gt;
	&lt;li&gt;NumberFormatTransformer allows variable in formatStyle and locale attributes&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I&apos;ll commit this shortly.&lt;/p&gt;</comment>
                            <comment id="12671021" author="shalinmangar" created="Fri, 6 Feb 2009 06:52:30 +0000"  >&lt;p&gt;Committed revision 741435.&lt;/p&gt;

&lt;p&gt;Thanks Fergus and Noble!&lt;/p&gt;</comment>
                            <comment id="12775468" author="gsingers" created="Tue, 10 Nov 2009 15:50:35 +0000"  >&lt;p&gt;Bulk close Solr 1.4 issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12399621" name="SOLR-1001.patch" size="4500" author="shalinmangar" created="Fri, 6 Feb 2009 06:45:28 +0000"/>
                            <attachment id="12399336" name="SOLR-1001.patch" size="1235" author="noble.paul" created="Tue, 3 Feb 2009 05:02:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 2 Feb 2009 19:38:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6633</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxnvz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20189</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>