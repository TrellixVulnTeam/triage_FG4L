<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:25:54 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-220/SOLR-220.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-220] Solr returns &quot;HTTP status code=1&quot; in some case</title>
                <link>https://issues.apache.org/jira/browse/SOLR-220</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If I request the following on solr example:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8080/solr/select?q=ipod%3Bzzz+asc&amp;amp;version=2.2&amp;amp;start=0&amp;amp;rows=10&amp;amp;indent=on&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8080/solr/select?q=ipod%3Bzzz+asc&amp;amp;version=2.2&amp;amp;start=0&amp;amp;rows=10&amp;amp;indent=on&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I got an exception as I expected because zzz isn&apos;t undefined, but HTTP status code is 1. I expected 400 in this case.&lt;br/&gt;
The reason of this is because IndexSchema.getField() method throws SolrException(1,&quot;&quot;) and QueryParsing.parseSort() doesn&apos;t catch it:&lt;/p&gt;

&lt;p&gt;        // getField could throw an exception if the name isn&apos;t found&lt;br/&gt;
    	SchemaField f = schema.getField(part);	// &amp;lt;=== makes HTTP status code=1&lt;br/&gt;
        if (f == null || !f.indexed())&lt;/p&gt;
{
          throw new SolrException( 400, &quot;can not sort on unindexed field: &quot;+part );
        }

&lt;p&gt;There seems to be a couple of ways to solve this problem:&lt;/p&gt;

&lt;p&gt;1. IndexSchema.getField() method throws SolrException(400,&quot;&quot;)&lt;br/&gt;
2. IndexSchema.getField() method doesn&apos;t throw the exception but returns null&lt;br/&gt;
3. The caller catches the exception and re-throws SolrException(400,&quot;&quot;)&lt;br/&gt;
4. The caller catches the exception and re-throws SolrException(400,&quot;&quot;,cause) that wraps the cause exception&lt;/p&gt;

&lt;p&gt;I think either #3 or #4 will be acceptable. The attached patch is #3 for sort on undefined field.&lt;/p&gt;

&lt;p&gt;Other than QueryParsing.parseSort(), IndexSchema.getField() is called by the following class/methos:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CSVLoader.prepareFields()&lt;/li&gt;
	&lt;li&gt;JSONWriter.writeDoc()&lt;/li&gt;
	&lt;li&gt;SimpleFacets.getTermCounts()&lt;/li&gt;
	&lt;li&gt;QueryParsing.parseValSource()&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;m not sure these methods require same patch. Any thoughts?&lt;/p&gt;

&lt;p&gt;regards,&lt;/p&gt;</description>
                <environment></environment>
        <key id="12368270">SOLR-220</key>
            <summary>Solr returns &quot;HTTP status code=1&quot; in some case</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ryantxu">Ryan McKinley</assignee>
                                    <reporter username="koji">Koji Sekiguchi</reporter>
                        <labels>
                    </labels>
                <created>Sun, 29 Apr 2007 01:07:35 +0100</created>
                <updated>Sun, 29 Apr 2007 22:02:46 +0100</updated>
                            <resolved>Sun, 29 Apr 2007 22:02:46 +0100</resolved>
                                                                    <component>search</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12492527" author="koji" created="Sun, 29 Apr 2007 01:11:26 +0100"  >&lt;p&gt;the patch for &quot;sort on undefined field&quot;&lt;/p&gt;</comment>
                            <comment id="12492531" author="ryantxu" created="Sun, 29 Apr 2007 01:29:41 +0100"  >&lt;p&gt;I just checked in a much smaller patch that at least won&apos;t throw a status code=&quot;1&quot;&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/lucene/solr/trunk/src/java/org/apache/solr/schema/IndexSchema.java?r1=533449&amp;amp;r2=533448&amp;amp;pathrev=533449&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/lucene/solr/trunk/src/java/org/apache/solr/schema/IndexSchema.java?r1=533449&amp;amp;r2=533448&amp;amp;pathrev=533449&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We should probably use your patch so that it has a nice context specific error, rather then the general &quot;undefined field&quot;&lt;/p&gt;

&lt;p&gt;As an aside, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-204&quot; title=&quot;Let solrconfig.xml configure the SolrDispatchFilter to handle /select&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-204&quot;&gt;&lt;del&gt;SOLR-204&lt;/del&gt;&lt;/a&gt; will make the request dispatcher the default /select handler.  This catches invalid error codes and returns a 500.&lt;/p&gt;

&lt;p&gt;thanks&lt;/p&gt;
</comment>
                            <comment id="12492601" author="ryantxu" created="Sun, 29 Apr 2007 22:02:46 +0100"  >&lt;p&gt;fixed in rev 533560&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12356469" name="QueryParsing.patch" size="775" author="koji" created="Sun, 29 Apr 2007 01:11:26 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 29 Apr 2007 00:29:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7368</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxsnz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20963</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>