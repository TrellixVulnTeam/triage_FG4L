<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:25:01 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-536/SOLR-536.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-536] Automatic binding of results to Beans (for solrj)</title>
                <link>https://issues.apache.org/jira/browse/SOLR-536</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;as we are using java5 .we can use annotations to bind SolrDocument to java beans directly.&lt;/p&gt;

&lt;p&gt;This can make the usage of solrj a  bit simpler&lt;/p&gt;

&lt;p&gt;The QueryResponse class in solrj can have an extra method as follows&lt;/p&gt;

&lt;p&gt;public &amp;lt;T&amp;gt; List&amp;lt;T&amp;gt; getResultBeans(Class&amp;lt;T&amp;gt; klass)&lt;/p&gt;

&lt;p&gt;and the bean can have annotations as&lt;/p&gt;

&lt;p&gt;class MyBean{&lt;br/&gt;
@Field(&quot;id&quot;) //name is optional&lt;br/&gt;
String id;&lt;/p&gt;

&lt;p&gt;@Field(&quot;category&quot;)&lt;br/&gt;
List&amp;lt;String&amp;gt; categories&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment></environment>
        <key id="12393719">SOLR-536</key>
            <summary>Automatic binding of results to Beans (for solrj)</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ryantxu">Ryan McKinley</assignee>
                                    <reporter username="noble.paul">Noble Paul</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Apr 2008 06:20:49 +0100</created>
                <updated>Fri, 10 May 2013 11:40:35 +0100</updated>
                            <resolved>Thu, 5 Jun 2008 16:50:50 +0100</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.3</fixVersion>
                                    <component>clients - java</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12589495" author="noble.paul" created="Wed, 16 Apr 2008 11:56:56 +0100"  >&lt;p&gt;First cut . &lt;br/&gt;
There is a Class DocumentObjectBinder used by QueryResponse.&lt;/p&gt;

&lt;p&gt;The testcase demonstrates the usage.&lt;br/&gt;
The annotation can be applied on a setter method also.&lt;/p&gt;

&lt;p&gt;Questions:&lt;br/&gt;
Do we need binding for dynamic fields like&lt;/p&gt;

&lt;p&gt;@Field(&quot;*_t&quot;)&lt;br/&gt;
String a_t: &lt;/p&gt;

&lt;p&gt;Should it do automatic type conversion.?&lt;br/&gt;
 i.e solr gives the field as say int and the bean has the field as String&lt;/p&gt;



</comment>
                            <comment id="12599836" author="ryantxu" created="Mon, 26 May 2008 14:04:45 +0100"  >&lt;p&gt;looks good &amp;#8211; i would leave out the function in QueryResponse.java &amp;#8211; it seems just as easy for whoever is calling this to keep the static DocumentObjectBinder (and keeps the static out of our maintenance)&lt;/p&gt;



&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;Should it do automatic type conversion.?&lt;br/&gt;
i.e solr gives the field as say int and the bean has the field as String&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sounds good.&lt;/p&gt;</comment>
                            <comment id="12599846" author="noble.paul" created="Mon, 26 May 2008 15:27:18 +0100"  >&lt;p&gt;Leaving out the function is fine.  Let the users manage that static instance&lt;br/&gt;
Let us not have automatic conversion as of now. If people ask for it we can add it later.&lt;/p&gt;</comment>
                            <comment id="12602189" author="noble.paul" created="Wed, 4 Jun 2008 07:29:01 +0100"  >&lt;p&gt;Incorporated the changes suggested by Ryan&lt;/p&gt;</comment>
                            <comment id="12602451" author="ryantxu" created="Wed, 4 Jun 2008 21:48:06 +0100"  >&lt;p&gt;Here is an updated version of the patch that also lets you use the same annotation to convert from an object to a SolrInputDocument.&lt;/p&gt;

&lt;p&gt;I still wonder if we should have the utility function in QueryResponse.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &amp;lt;T&amp;gt; List&amp;lt;T&amp;gt; getBeans(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;T&amp;gt; klass){
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DocumentObjectBinder().getBeans(klass, getResults());
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it seems like hanging on to a DocumentObjectBinder outside of the response will be more efficient.  (Though perhaps not a big deal)&lt;/p&gt;</comment>
                            <comment id="12602539" author="noble.paul" created="Thu, 5 Jun 2008 05:46:04 +0100"  >&lt;p&gt;The objective was to mask people from &lt;em&gt;DocumentObjectBinder&lt;/em&gt; altogether .&lt;/p&gt;

&lt;p&gt;The process of reading the annotations and caching the information is expensive.&lt;br/&gt;
 If we make the cache field  &lt;b&gt;static&lt;/b&gt; in DocumentIObjectBinder this should be fine. Otherwise we must remove this method.&lt;/p&gt;</comment>
                            <comment id="12602647" author="ryantxu" created="Thu, 5 Jun 2008 14:43:51 +0100"  >&lt;p&gt;I think we should remove it from QueryResponce.  After &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-215&quot; title=&quot;Multiple Solr Cores - remove static singleton&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-215&quot;&gt;&lt;del&gt;SOLR-215&lt;/del&gt;&lt;/a&gt;, I&apos;m reluctant to bake in static variables unless absolutely necessary.  In this case, I don&apos;t think using DocumentObjectBinder directly is a big deal &amp;#8211; it also lets the user decide if access needs to be synchronized or not.&lt;/p&gt;

&lt;p&gt;We can always add the function (and static cache) later if it is necessary.&lt;/p&gt;</comment>
                            <comment id="12602658" author="noble.paul" created="Thu, 5 Jun 2008 15:23:53 +0100"  >&lt;p&gt;Let us remove that method . without static cache it might lead to incorrect usage&lt;/p&gt;

&lt;p&gt;The cache cant &lt;b&gt;grow&lt;/b&gt; much.  One instance of &lt;em&gt;DocField&lt;/em&gt; per class. Unless creates classes during runtime it may not cause a problem. &lt;/p&gt;</comment>
                            <comment id="12602688" author="ryantxu" created="Thu, 5 Jun 2008 16:50:50 +0100"  >&lt;p&gt;This was commited with some minor changes &amp;#8211; it was moved out of the &apos;response&apos; package (since it also handles object construction) and put into a &quot;beans&quot; package.&lt;/p&gt;

&lt;p&gt;thanks Noble&lt;/p&gt;</comment>
                            <comment id="12602723" author="noble.paul" created="Thu, 5 Jun 2008 18:42:28 +0100"  >&lt;p&gt;Ryan: &lt;br/&gt;
This is expensive&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;, List&amp;lt;DocField&amp;gt;&amp;gt; infocache = 
    Collections.synchronizedMap( &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;, List&amp;lt;DocField&amp;gt;&amp;gt;() );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let us make it&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;, List&amp;lt;DocField&amp;gt;&amp;gt; infocache = 
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConcurrentHashMap&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;, List&amp;lt;DocField&amp;gt;&amp;gt;() ;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12602733" author="ryantxu" created="Thu, 5 Jun 2008 19:03:50 +0100"  >&lt;p&gt;done.  thanks&lt;/p&gt;</comment>
                            <comment id="12602744" author="klaasm" created="Thu, 5 Jun 2008 19:43:26 +0100"  >&lt;p&gt;&amp;gt; This is expensive&lt;br/&gt;
&amp;gt; private final Map&amp;lt;Class, List&amp;lt;DocField&amp;gt;&amp;gt; infocache = &lt;br/&gt;
&amp;gt;    Collections.synchronizedMap( new HashMap&amp;lt;Class, List&amp;lt;DocField&amp;gt;&amp;gt;() );&lt;/p&gt;

&lt;p&gt;&amp;gt; Let us make it&lt;br/&gt;
&amp;gt; private final Map&amp;lt;Class, List&amp;lt;DocField&amp;gt;&amp;gt; infocache = &lt;br/&gt;
&amp;gt;    new ConcurrentHashMap&amp;lt;Class, List&amp;lt;DocField&amp;gt;&amp;gt;() ;&lt;/p&gt;

&lt;p&gt;Expensive?  I&apos;d expect the synchronizedMap to be faster and more memory compact.  The ConcurrentHashMap is definitely more concurrent, though.&lt;/p&gt;
</comment>
                            <comment id="12602919" author="noble.paul" created="Fri, 6 Jun 2008 06:23:45 +0100"  >&lt;p&gt;yes concurrency is impotant. The &lt;em&gt;cache.get()&lt;/em&gt; is called by too many threads in a webapp . &lt;em&gt;Collections.synchronizedMap()&lt;/em&gt; has the get() synchronized so more contention. cost per operation is less but waiting time can be longer for &lt;em&gt;Collections..synchronizedMap()&lt;/em&gt;&lt;/p&gt;</comment>
                            <comment id="12604130" author="noble.paul" created="Wed, 11 Jun 2008 07:12:03 +0100"  >&lt;p&gt;Adds methods to SolrServer to directly add beans to Solr&lt;br/&gt;
all &lt;em&gt;add()&lt;/em&gt; has a corresponding &lt;em&gt;addBean&lt;/em&gt; method&lt;/p&gt;

&lt;p&gt;This can help mask people from SolrinputDocument, DocumentObjectBinder etc .a &lt;b&gt;non-static&lt;/b&gt; field is added to &lt;em&gt;SolrServer&lt;/em&gt; &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; DocumentObjectBinder binder;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12607475" author="ryantxu" created="Tue, 24 Jun 2008 06:47:08 +0100"  >&lt;p&gt;hymmm, after using this for a bit, i&apos;m not sure we should have the utility funcion:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &amp;lt;T&amp;gt; List&amp;lt;T&amp;gt; getBeans(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&amp;lt;T&amp;gt; type)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;in QueryResponse.  My problem with it now is that if I use the response in a context where it needs to be serialized (wicket), then the SolrServer also needs to get serialized... that is a problem.  I think its better to keep that functionality outside of the QueryResponse class.&lt;/p&gt;</comment>
                            <comment id="12607477" author="ryantxu" created="Tue, 24 Jun 2008 06:55:30 +0100"  >&lt;p&gt;i removed it in rev671034 &amp;#8211; with SolrServer in the response, the response is not serializable...&lt;/p&gt;</comment>
                            <comment id="12607478" author="noble.paul" created="Tue, 24 Jun 2008 06:55:34 +0100"  >&lt;p&gt;let us make the field transient. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;transient&lt;/span&gt; SolrServer solrServer;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Even if the field is absent it still works&lt;/p&gt;

&lt;p&gt;This method is very useful because this is a client API and the user should be exposed to minimal classes/interfaces&lt;/p&gt;</comment>
                            <comment id="12607484" author="ryantxu" created="Tue, 24 Jun 2008 07:13:43 +0100"  >&lt;p&gt;ok, I put it back in rev 671037&lt;/p&gt;</comment>
                            <comment id="12615033" author="noble.paul" created="Sat, 19 Jul 2008 19:25:46 +0100"  >&lt;p&gt;user reported bug&lt;br/&gt;
I have a multivalued Solr text field, called &apos;categories&apos;, which is mapped&lt;br/&gt;
to a String[] in my java bean. I am directly converting the search results&lt;br/&gt;
to this bean.&lt;br/&gt;
This works absolutely fine if the field has two or more values, but If the&lt;br/&gt;
field has exactly one value, I get the following exception -&lt;/p&gt;

&lt;p&gt;*Caused by: java.lang.RuntimeException: Exception while setting value&lt;br/&gt;
: [Ljava.lang.Object;@15b48b2 on private java.lang.String[]&lt;br/&gt;
com.app.model.Unit.categories&lt;br/&gt;
       at org.apache.solr.client.solrj.beans.DocumentObjectBinder$DocField.set(DocumentObjectBinder.java:230)&lt;br/&gt;
       at org.apache.solr.client.solrj.beans.DocumentObjectBinder$DocField.inject(DocumentObjectBinder.java:199)&lt;br/&gt;
       at org.apache.solr.client.solrj.beans.DocumentObjectBinder.getBeans(DocumentObjectBinder.java:57)&lt;br/&gt;
       at org.apache.solr.client.solrj.response.QueryResponse.getBeans(QueryResponse.java:256)&lt;/p&gt;

&lt;p&gt;Fixed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12383803" name="SOLR-536.patch" size="5641" author="noble.paul" created="Wed, 11 Jun 2008 07:12:03 +0100"/>
                            <attachment id="12383411" name="SOLR-536.patch" size="19489" author="ryantxu" created="Wed, 4 Jun 2008 21:48:06 +0100"/>
                            <attachment id="12383354" name="SOLR-536.patch" size="13513" author="noble.paul" created="Wed, 4 Jun 2008 07:29:00 +0100"/>
                            <attachment id="12380267" name="SOLR-536.patch" size="12173" author="noble.paul" created="Wed, 16 Apr 2008 11:56:56 +0100"/>
                            <attachment id="12386478" name="SOLR-DocObjBinder.patch" size="2300" author="noble.paul" created="Sat, 19 Jul 2008 19:25:46 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 26 May 2008 13:04:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7070</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxqqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20651</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>