<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:22:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-938/SOLR-938.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-938] DataImportHandler: Add close hooks to the completion of a full-import process </title>
                <link>https://issues.apache.org/jira/browse/SOLR-938</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Adding a new feature that we need for continuation of a workflow based on a full-import procedure. When   a full-import completes , the pre-defined hook method is called at the end of the same. &lt;/p&gt;

&lt;p&gt;Implementations that need to notified , need to implement the new interface - DataImportCloseHook and register themselves in the data config file as follows. &lt;/p&gt;

&lt;p&gt;&amp;lt;dataConfig&amp;gt;&lt;/p&gt;

&lt;p&gt;.&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
   &amp;lt;closeHook type=&quot;com.myorg.fullimporter.closeHookImpl1&quot; /&amp;gt;&lt;br/&gt;
   &amp;lt;closeHook type=&quot;com.myorg.fullimporter.closeHookImpl2&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;/dataConfig&amp;gt;&lt;/p&gt;

&lt;p&gt;A single instance of them is created (as part of DataImporter) during instantiation and the same insance is reused across multiple invocations. &lt;/p&gt;

&lt;p&gt;Since the dataImporter is protected by a thread-lock - there is no thred-safe guarantee for the implementations of the full-import close hook. &lt;/p&gt;
</description>
                <environment>&lt;p&gt;JRE 6, Tomcat 6&lt;/p&gt;</environment>
        <key id="12411304">SOLR-938</key>
            <summary>DataImportHandler: Add close hooks to the completion of a full-import process </summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalinmangar">Shalin Shekhar Mangar</assignee>
                                    <reporter username="kaykay.unique">Karthik K</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Dec 2008 17:15:35 +0000</created>
                <updated>Mon, 19 Jan 2009 22:19:05 +0000</updated>
                            <resolved>Thu, 8 Jan 2009 12:52:48 +0000</resolved>
                                    <version>1.4</version>
                                    <fixVersion>1.4</fixVersion>
                                    <component>contrib - DataImportHandler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <timeoriginalestimate seconds="172800">48h</timeoriginalestimate>
                            <timeestimate seconds="172800">48h</timeestimate>
                                        <comments>
                            <comment id="12659122" author="kaykay.unique" created="Wed, 24 Dec 2008 17:39:50 +0000"  >&lt;p&gt;DataImportCloseHook.java : New interface to be implemented for handling closing hooks&lt;/p&gt;

&lt;p&gt;DataImporter.java / DataConfig.java :  add new close hook interfaces. &lt;/p&gt;

&lt;p&gt;TestDocBuilder.java : have a sample  schema (optional closehook type=&quot; &quot; ) and let TestDocBuilder parse the same. &lt;/p&gt;</comment>
                            <comment id="12659124" author="shalinmangar" created="Wed, 24 Dec 2008 17:47:19 +0000"  >&lt;p&gt;Kay, you can also extend JdbcDataSource, override the close method and use this data source for your root entity.&lt;/p&gt;</comment>
                            <comment id="12659145" author="kaykay.unique" created="Wed, 24 Dec 2008 18:59:50 +0000"  >&lt;p&gt;I am a little bit apprehensive about inheriting from JdbcDataSource since inheritance brings in tighter coupling. (The most important assumption about JdbcDataSource overriding is that the sub class&apos; close() method calls super.close() - to avoid resource leaks). &lt;/p&gt;

&lt;p&gt;And also - doing a full-import a given query is different from closing the jdbc connection altogether ( even though the impl. might converge in their meaning ). &lt;/p&gt;

&lt;p&gt;Instead - from a workflow perspective - all I need is a pluggable independent hook without disrupting DIH but a notification from the same after its completion to move onto the next. &lt;/p&gt;</comment>
                            <comment id="12659190" author="noble.paul" created="Thu, 25 Dec 2008 08:36:56 +0000"  >&lt;p&gt;I wish to recommend the following. It is better not to limit this to close event. I try to minimize the no:of public interfaces. DIH is designed keeping non-java users also in mind. As far as possible users should not be forced to use java. &lt;/p&gt;

&lt;p&gt;It can better be called an EventListener&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; EventListener {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void onEvent(Context ctx );    
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It could be registered as something like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;document onImportEnd=&lt;span class=&quot;code-quote&quot;&gt;&quot;script:endImport&quot;&lt;/span&gt; onImportStart=&lt;span class=&quot;code-quote&quot;&gt;&quot;com.foo.Foo&quot;&lt;/span&gt; &amp;gt;
 &amp;lt;!-- entitiies go here--&amp;gt;.
&amp;lt;/document&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Single method interface is preferred because it should be possible to write the implementation in scripting languages&lt;/p&gt;
</comment>
                            <comment id="12659449" author="noble.paul" created="Sun, 28 Dec 2008 17:11:30 +0000"  >&lt;p&gt;script is not supported&lt;/p&gt;</comment>
                            <comment id="12659566" author="kaykay.unique" created="Mon, 29 Dec 2008 15:58:52 +0000"  >&lt;p&gt;Noble - In the revised patch - did you mean to add EventListener to the source control as well since it would not compile at this point. &lt;/p&gt;

&lt;p&gt;Also - with invokeEvent - I believe it might be better to reuse the EventListener instance instead of recreating them again, for every notification, since the ClassLoading and the instance creation might be expensive (especially Class Loading). Storing the information during the runtime might be useful for various event notification purposes. &lt;/p&gt;</comment>
                            <comment id="12659577" author="noble.paul" created="Mon, 29 Dec 2008 16:17:04 +0000"  >&lt;p&gt;I missed the file. this patch has it&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Also - with invokeEvent - I believe it might be better to reuse the EventListener instance instead of recreating them again, for every notification, since the ClassLoading ...&lt;/p&gt;&lt;/blockquote&gt;


&lt;p&gt;I guess caching is pointless for a class which is used only twice for a full import&lt;/p&gt;</comment>
                            <comment id="12659588" author="kaykay.unique" created="Mon, 29 Dec 2008 17:21:30 +0000"  >&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; I guess caching is pointless for a class which is used only twice for a full import&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;We have a much larger query , for which we do a full-import . We split the data by the primary key range and perform multiple smaller &apos;full-import&apos;s consolidated together to form a  full-import . Hence the necessity for retaining the instance for the event handlers. &lt;/p&gt;

&lt;p&gt;But I am ok with tracking that with a separate jira - if needed. When can we get this committed the current patch onto the trunk for now. &lt;/p&gt;</comment>
                            <comment id="12661959" author="shalinmangar" created="Thu, 8 Jan 2009 12:48:12 +0000"  >&lt;ol&gt;
	&lt;li&gt;Bringing patch in sync with trunk.&lt;/li&gt;
	&lt;li&gt;Added a test case&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I plan to commit shortly.&lt;/p&gt;</comment>
                            <comment id="12661960" author="shalinmangar" created="Thu, 8 Jan 2009 12:52:48 +0000"  >&lt;p&gt;Committed revision 732695.&lt;/p&gt;

&lt;p&gt;Thanks Kay and Noble!&lt;/p&gt;</comment>
                            <comment id="12662180" author="kaykay.unique" created="Thu, 8 Jan 2009 23:54:52 +0000"  >&lt;p&gt;Thanks Shalin / Noble. &lt;/p&gt;

&lt;p&gt;Full Import and Delta Import are functionally 2 different things. We probably need a way to distinguish the event handlers as  onFullImportStart/End and onDeltaImportStart/End since they represent different events. May be there could be a separate jira to track this. &lt;/p&gt;</comment>
                            <comment id="12662224" author="noble.paul" created="Fri, 9 Jan 2009 02:10:19 +0000"  >&lt;p&gt;=Context#currentProcess() can tell you what is going on now. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12412779">SOLR-972</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12397418" name="SOLR-938.patch" size="6612" author="shalinmangar" created="Thu, 8 Jan 2009 12:48:12 +0000"/>
                            <attachment id="12396851" name="SOLR-938.patch" size="9176" author="noble.paul" created="Mon, 29 Dec 2008 16:17:04 +0000"/>
                            <attachment id="12396818" name="SOLR-938.patch" size="6691" author="noble.paul" created="Sun, 28 Dec 2008 17:11:30 +0000"/>
                            <attachment id="12396743" name="SOLR-938.patch" size="10210" author="kaykay.unique" created="Wed, 24 Dec 2008 17:39:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 24 Dec 2008 17:47:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6695</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxoa7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20253</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>