<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:17:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-1170/SOLR-1170.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-1170] Java replication replicates lucene lock file</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1170</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When using solr 1.4 replication, I see that the lucene-write.lock file is being replicated to slaves.  I&apos;m importing data from a db every 5 minutes using cron to trigger a DIH delta-import.  Replication polls every 60 seconds and the master is configured to take a snapshot (replicateAfter) commit.&lt;/p&gt;

&lt;p&gt;Why should the lock file be replicated to slaves?&lt;/p&gt;

&lt;p&gt;The lock file isn&apos;t stale on the master and is absent unless the delta-import is in process.  I&apos;ve not tried it yet, but with the lock file replicated, it seems like promotion of a slave to a master in a failure recovery scenario requires the manual removal of the lock file.&lt;/p&gt;</description>
                <environment>&lt;p&gt;linux&lt;/p&gt;</environment>
        <key id="12425602">SOLR-1170</key>
            <summary>Java replication replicates lucene lock file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="noble.paul">Noble Paul</assignee>
                                    <reporter username="batalbot">Bryan Talbot</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 May 2009 17:18:15 +0100</created>
                <updated>Tue, 10 Nov 2009 15:52:05 +0000</updated>
                            <resolved>Wed, 16 Sep 2009 04:40:05 +0100</resolved>
                                    <version>1.4</version>
                                    <fixVersion>1.4</fixVersion>
                                    <component>replication (java)</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12710716" author="noble.paul" created="Tue, 19 May 2009 13:08:58 +0100"  >&lt;p&gt;are you sure that the lucene-write.lock is actually replicated . It may be created in the slave itself. to confirm it can your check the master with the command=filelist&amp;amp;indexversion=&amp;lt;the version&amp;gt;&lt;/p&gt;

&lt;p&gt;the version can be obtained from the command=indexversion&lt;/p&gt;
</comment>
                            <comment id="12710717" author="noble.paul" created="Tue, 19 May 2009 13:09:34 +0100"  >&lt;p&gt;if it is indeed a problem. Then this patch can solve it&lt;/p&gt;</comment>
                            <comment id="12710767" author="batalbot" created="Tue, 19 May 2009 16:50:02 +0100"  >&lt;p&gt;The lock file doesn&apos;t show up in the filelist.  It always has the same timestamp as other files which were replicated and sticks around until the next replication begins so I had assumed it was replicated.&lt;/p&gt;

&lt;p&gt;If it is created on the slave instead of being replicated, isn&apos;t that still an issue?  I&apos;m certain that there are no writes being performed on the slave.&lt;/p&gt;</comment>
                            <comment id="12710775" author="markrmiller@gmail.com" created="Tue, 19 May 2009 17:12:31 +0100"  >&lt;p&gt;The replication handler calls forceOpenWriter to ensure old index files are deleted after a pull.&lt;/p&gt;</comment>
                            <comment id="12711012" author="noble.paul" created="Wed, 20 May 2009 06:27:02 +0100"  >

&lt;p&gt;in that case, if you promote your slave to become a master it should have no problem. the lock is created by the same server ,so it will be removed when you close the writer or restart the server&lt;/p&gt;


</comment>
                            <comment id="12711015" author="batalbot" created="Wed, 20 May 2009 06:52:11 +0100"  >&lt;p&gt;When the slave is cleanly shutdown, the lock file remains.  Doesn&apos;t that indicate an index writer got left open and not properly shutdown?&lt;/p&gt;</comment>
                            <comment id="12711034" author="noble.paul" created="Wed, 20 May 2009 07:35:22 +0100"  >&lt;p&gt;even if the lock is present it can be removed if the attribute mainIndex/unlockOnStartup is present in the solrconfig.xml. &lt;/p&gt;


&lt;p&gt;But if it does not get removed automatically there could be a problem&lt;/p&gt;</comment>
                            <comment id="12753183" author="hossman" created="Wed, 9 Sep 2009 18:41:20 +0100"  >&lt;p&gt;issue is marked &quot;affects 1.4&quot; and has a patch which comments indicate solves the problem ... marking &quot;fix for 1.4&quot; so it&apos;s not overlooked prior to code freeze&lt;/p&gt;</comment>
                            <comment id="12754498" author="noble.paul" created="Sat, 12 Sep 2009 10:16:17 +0100"  >&lt;p&gt;I guess it safe enough to commit this patch. The .lock file does not need to be replicated in any case&lt;/p&gt;</comment>
                            <comment id="12755864" author="noble.paul" created="Wed, 16 Sep 2009 04:40:05 +0100"  >&lt;p&gt;committed r815597&lt;/p&gt;</comment>
                            <comment id="12775745" author="gsingers" created="Tue, 10 Nov 2009 15:52:05 +0000"  >&lt;p&gt;Bulk close for Solr 1.4&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12408476" name="SOLR-1170.patch" size="736" author="noble.paul" created="Tue, 19 May 2009 13:09:34 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 19 May 2009 12:08:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6474</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxmvj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20025</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>