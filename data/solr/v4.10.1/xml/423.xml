<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:25:07 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-423/SOLR-423.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-423] SolrRequestHandler close notification</title>
                <link>https://issues.apache.org/jira/browse/SOLR-423</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;It may be beneficial for implementations of SolrRequestHandler to be notified that the SolrCore is closing so that they can release any resources that they may have open.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12383429">SOLR-423</key>
            <summary>SolrRequestHandler close notification</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gsingers">Grant Ingersoll</assignee>
                                    <reporter username="gsingers">Grant Ingersoll</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 Nov 2007 19:24:20 +0000</created>
                <updated>Fri, 10 May 2013 11:40:23 +0100</updated>
                            <resolved>Thu, 26 Jun 2008 18:44:49 +0100</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12546359" author="gsingers" created="Wed, 28 Nov 2007 19:27:58 +0000"  >&lt;p&gt;Draft patch that implements close() callback on the SolrRequestHandler and provides empty implementation for RequestHandlerBase.&lt;/p&gt;

&lt;p&gt;Obviously, this is not backward compatible since it adds a new method to an interface, but I am not sure where else to put it for now.  My guess is most people extend RequestHandlerBase anyway, so it may not be that big of an issue.&lt;/p&gt;

&lt;p&gt;Patch hooks into the SolrCore.close() call by calling RequestHandlers.closeHandlers() similar to how it inits the handlers.&lt;/p&gt;

&lt;p&gt;All tests should pass.  Also added a test to SolrCoreTest to explicitly check that close is being called.&lt;/p&gt;</comment>
                            <comment id="12546427" author="ryantxu" created="Wed, 28 Nov 2007 22:01:03 +0000"  >&lt;p&gt;Aaaah that freaking interface!  So far, we have not broken API compatibility in 1.3 (though I have tried!) so I think we ought to find another way.&lt;/p&gt;

&lt;p&gt;Off hand I see two options:&lt;/p&gt;

&lt;p&gt;1.  Add close( SolrCore core ) to the SolrCoreAware interface&lt;br/&gt;
2.  Put the close method in RequestHandlerBase and have RequestHandlers.closeHandlers() check instanceof&lt;/p&gt;

&lt;p&gt;#1 seems interesting because it would also give access to close() for QueryResponseWriters and SearchComponents&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;side note, where you have:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Iterator&amp;lt;SolrRequestHandler&amp;gt; objectIterator = handlers.values().iterator(); objectIterator.hasNext();) {
      SolrRequestHandler handler = objectIterator.next();
      handler.close();
   }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;with java 1.5 this could be:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;( SolrRequestHandler handler : handlers ) {
  handler.close();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12546434" author="hossman" created="Wed, 28 Nov 2007 22:14:04 +0000"  >&lt;p&gt;i was thinking the same thing about #1 but that got me thinking that instead of SolrCoreAware having a close method, SolrCore could have an &quot;addCloseHook(CloseHook) method which SolrCoreAware request handlers could call as part their inform() method.&lt;/p&gt;

&lt;p&gt;That then got me thinking that instead of a CloseHook we should probably have a generic &quot;closeCore&quot; event type ... users could configure explicit SolrEventListeners in the solrconfig.xml, and plugins could use the internal methods to add implicit event listeners that they need.&lt;/p&gt;</comment>
                            <comment id="12546849" author="ryantxu" created="Thu, 29 Nov 2007 19:30:40 +0000"  >&lt;p&gt;This version adds a CloseHook to SolrCore.  The test now looks like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
class ClosingRequestHandler &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; EmptyRequestHandler &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; SolrCoreAware {
  &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; closed = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;

  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void inform(SolrCore core) {
    core.addCloseHook( &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SolrCore.CloseHook() {
      &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void close(SolrCore core) {
        closed = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
      }
    });
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12546851" author="ryantxu" created="Thu, 29 Nov 2007 19:33:40 +0000"  >&lt;p&gt;&amp;gt; That then got me thinking that instead of a CloseHook we should probably have a generic &quot;closeCore&quot; event type ... users could configure explicit SolrEventListeners in the solrconfig.xml, and plugins could use the internal methods to add implicit event listeners that they need.&lt;/p&gt;

&lt;p&gt;How would this work?  I don&apos;t quite follow.  If we add close() to SolrEventListener that would break the API.&lt;/p&gt;</comment>
                            <comment id="12548513" author="hossman" created="Wed, 5 Dec 2007 02:17:31 +0000"  >&lt;p&gt;&amp;gt; How would this work? I don&apos;t quite follow. If we add close() to &lt;br/&gt;
&amp;gt; SolrEventListener that would break the API.&lt;/p&gt;

&lt;p&gt;...sigh....   you&apos;re 100% right.  It&apos;s been a while since i looked at that API, i forgot it was an interface (heck: i forgot the event types were different methods)  oh well.&lt;/p&gt;</comment>
                            <comment id="12548514" author="yseeley@gmail.com" created="Wed, 5 Dec 2007 02:20:56 +0000"  >&lt;p&gt;SolrEventListener is a place where we might be able to make changes because no one uses their own listeners (they probably just use Solr&apos;s builtin listeners).&lt;/p&gt;</comment>
                            <comment id="12560388" author="gsingers" created="Fri, 18 Jan 2008 14:04:21 +0000"  >&lt;p&gt;Meant to follow up on this.  I think the close hook is fine.&lt;/p&gt;</comment>
                            <comment id="12607623" author="gsingers" created="Tue, 24 Jun 2008 15:34:19 +0100"  >&lt;p&gt;Minor updates, added some javadocs, plan to commit soon.&lt;/p&gt;</comment>
                            <comment id="12608522" author="gsingers" created="Thu, 26 Jun 2008 18:44:49 +0100"  >&lt;p&gt;Committed revision 671960.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12370577" name="SOLR-423-CloseHook.patch" size="2940" author="ryantxu" created="Thu, 29 Nov 2007 19:30:40 +0000"/>
                            <attachment id="12384586" name="SOLR-423.patch" size="5777" author="gsingers" created="Tue, 24 Jun 2008 15:34:19 +0100"/>
                            <attachment id="12370432" name="SOLR-423.patch" size="5316" author="gsingers" created="Wed, 28 Nov 2007 19:27:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 28 Nov 2007 22:01:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7176</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxrfb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20762</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>