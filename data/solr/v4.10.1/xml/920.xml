<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:21:29 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-920/SOLR-920.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-920] Cache and reuse IndexSchema</title>
                <link>https://issues.apache.org/jira/browse/SOLR-920</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;if there are 1000&apos;s of cores then the cost of loading unloading schema.xml can be prohibitive&lt;br/&gt;
similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-919&quot; title=&quot;Cache and reuse the SolrConfig&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-919&quot;&gt;&lt;del&gt;SOLR-919&lt;/del&gt;&lt;/a&gt; we can also cache the DOM object of schema.xml if the location on disk is same.  All the dynamic properties can be replaced lazily when they are read.&lt;/p&gt;

&lt;p&gt;We can go one step ahead in this case. Th IndexSchema object is immutable . So if there are no core properties then the same IndexSchema object can be used across all the cores&lt;/p&gt;</description>
                <environment></environment>
        <key id="12410772">SOLR-920</key>
            <summary>Cache and reuse IndexSchema</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="noble.paul">Noble Paul</assignee>
                                    <reporter username="noble.paul">Noble Paul</reporter>
                        <labels>
                    </labels>
                <created>Tue, 16 Dec 2008 09:08:22 +0000</created>
                <updated>Thu, 2 May 2013 03:29:18 +0100</updated>
                            <resolved>Tue, 26 May 2009 12:18:20 +0100</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12710625" author="noble.paul" created="Tue, 19 May 2009 06:58:54 +0100"  >&lt;p&gt;how about an extra attribute in the cores tag to enable sharing as follows.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;solr&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;cores adminPath=&lt;span class=&quot;code-quote&quot;&gt;&quot;/admin/cores&quot;&lt;/span&gt; shareSchema=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/cores&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/solr&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;if shareSchema is set to true then for a given path only one instance of IndexSchema is created and it will be shared . It is the responsibilty of the user to ensure that he does not use any core specific properties in the schema.xml when this attribute is set to true&lt;/p&gt;</comment>
                            <comment id="12711856" author="otis" created="Fri, 22 May 2009 00:21:27 +0100"  >&lt;p&gt;Looks good to me.  What happens when a core has a copy of schema.xml in its conf/ dir and that schema.xml is potentially different from the shared one?&lt;/p&gt;</comment>
                            <comment id="12711941" author="noble.paul" created="Fri, 22 May 2009 05:36:35 +0100"  >&lt;blockquote&gt;&lt;p&gt;What happens when a core has a copy of schema.xml in its conf/ dir and that schema.xml is potentially different from the shared one?&lt;/p&gt;&lt;/blockquote&gt;


&lt;p&gt;for a given path on disk one instance of IndexSchema is maintained in memory. The cache looks as follows .&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// in CoreContainer.java. 
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//The key is the absolute path to the schema.xml. The value is the IndexSchema instance.
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,IndexSchema&amp;gt; schemaCache;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It is also possible to maintain a timestamp of the file also in the key (say /data/solr/confschema.xml:yyyyMMddhhmmss)so that if the file is modified a new instance of IndexScema can be created&lt;/p&gt;</comment>
                            <comment id="12712113" author="otis" created="Fri, 22 May 2009 15:40:12 +0100"  >&lt;p&gt;So if my core has its own schema.xml in the right place (in conf/schema.xml), that schema will be used, not the shard one?&lt;/p&gt;</comment>
                            <comment id="12712349" author="noble.paul" created="Sat, 23 May 2009 05:00:27 +0100"  >&lt;blockquote&gt;&lt;p&gt;So if my core has its own schema.xml in the right place (in conf/schema.xml), that schema will be used, not the shard one? &lt;/p&gt;&lt;/blockquote&gt;


&lt;p&gt;right. one instance per (file+version).&lt;/p&gt;</comment>
                            <comment id="12712652" author="noble.paul" created="Mon, 25 May 2009 08:32:29 +0100"  >&lt;p&gt;I plan to commit this in a day or two&lt;/p&gt;</comment>
                            <comment id="12712962" author="noble.paul" created="Tue, 26 May 2009 12:18:20 +0100"  >&lt;p&gt;committed revision:778652&lt;/p&gt;</comment>
                            <comment id="12713883" author="noble.paul" created="Thu, 28 May 2009 06:26:39 +0100"  >&lt;p&gt;the attribute is not persisted back to solr.xml&lt;/p&gt;</comment>
                            <comment id="12718298" author="noble.paul" created="Thu, 11 Jun 2009 06:14:46 +0100"  >&lt;p&gt;logging that re-use is done and the path is made right&lt;/p&gt;</comment>
                            <comment id="12718299" author="noble.paul" created="Thu, 11 Jun 2009 06:15:55 +0100"  >&lt;p&gt;committed :r783631&lt;/p&gt;</comment>
                            <comment id="12729955" author="shalinmangar" created="Sat, 11 Jul 2009 08:04:00 +0100"  >&lt;p&gt;I think this change is not mentioned in the CHANGES.txt? Also, the fix version should be marked as 1.4.&lt;/p&gt;</comment>
                            <comment id="12764350" author="yseeley@gmail.com" created="Sat, 10 Oct 2009 14:48:11 +0100"  >&lt;p&gt;Just got around to reviewing this.... seems like it&apos;s an unbounded cache?&lt;br/&gt;
If someone kept modifying the schema and reloading the core (as can happen with replication too), then all the older versions hang around in the cache forever, right?&lt;/p&gt;</comment>
                            <comment id="12764556" author="noble.paul" created="Mon, 12 Oct 2009 06:27:17 +0100"  >&lt;blockquote&gt;&lt;p&gt;seems like it&apos;s an unbounded cache?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;yes. It is unbounded. Let us make it bounded&lt;/p&gt;</comment>
                            <comment id="12833814" author="drewmorris" created="Mon, 15 Feb 2010 14:42:35 +0000"  >&lt;p&gt;Just reviewing the syntax of the XML...  if you have 2 different schemas that should be shared with multiple cores... will this still work? So if I had 1000 cores sharing 1 schema and 1000 cores sharing a different schema will that be possible with this implementation?&lt;/p&gt;</comment>
                            <comment id="12833857" author="noble.paul" created="Mon, 15 Feb 2010 15:48:00 +0000"  >&lt;p&gt;yes . it is possible&lt;/p&gt;</comment>
                            <comment id="12833858" author="noble.paul" created="Mon, 15 Feb 2010 15:50:10 +0000"  >&lt;blockquote&gt;&lt;p&gt;, then all the older versions hang around in the cache forever, right?&lt;/p&gt;&lt;/blockquote&gt;


&lt;p&gt;nope. The cache key is the FQN of the  file . in replication , the same file is overwritten. So the cache entry is overwritten&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12430758">SOLR-1293</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12410771">SOLR-919</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12410360" name="SOLR-920.patch" size="1201" author="noble.paul" created="Thu, 11 Jun 2009 06:14:46 +0100"/>
                            <attachment id="12409238" name="SOLR-920.patch" size="1418" author="noble.paul" created="Thu, 28 May 2009 06:28:04 +0100"/>
                            <attachment id="12408789" name="SOLR-920.patch" size="2505" author="noble.paul" created="Fri, 22 May 2009 12:14:00 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 21 May 2009 23:21:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6713</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxoe7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20271</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>