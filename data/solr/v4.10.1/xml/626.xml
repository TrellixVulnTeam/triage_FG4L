<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:19:12 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-626/SOLR-626.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-626] docs.getMaxScore is null inside writeSolrDocumentList when sorting using shards and returning output as JSON</title>
                <link>https://issues.apache.org/jira/browse/SOLR-626</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When issuing a query to many shards or even just one:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select?sort=some_date+desc&amp;amp;indent=on&amp;amp;hl.fl=&amp;amp;q=solr&amp;amp;rows=10&amp;amp;fl=*%2Cscore&amp;amp;qt=standard&amp;amp;wt=ruby&amp;amp;explainOther=&amp;amp;hl.fl=&amp;amp;shards=localhost:8983/solr&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select?sort=some_date+desc&amp;amp;indent=on&amp;amp;hl.fl=&amp;amp;q=solr&amp;amp;rows=10&amp;amp;fl=*%2Cscore&amp;amp;qt=standard&amp;amp;wt=ruby&amp;amp;explainOther=&amp;amp;hl.fl=&amp;amp;shards=localhost:8983/solr&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It returns:&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.solr.request.JSONWriter.writeSolrDocumentList(JSONResponseWriter.java:528)&lt;br/&gt;
	at org.apache.solr.request.TextResponseWriter.writeVal(TextResponseWriter.java:147)&lt;br/&gt;
	at org.apache.solr.request.JSONWriter.writeNamedListAsMapWithDups(JSONResponseWriter.java:175)&lt;br/&gt;
	at org.apache.solr.request.JSONWriter.writeNamedList(JSONResponseWriter.java:288)&lt;br/&gt;
	at org.apache.solr.request.JSONWriter.writeResponse(JSONResponseWriter.java:88)&lt;br/&gt;
	at org.apache.solr.request.RubyResponseWriter.write(RubyResponseWriter.java:34)&lt;br/&gt;
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:297)&lt;br/&gt;
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1089)&lt;/p&gt;

&lt;p&gt;I tried to swap out the call to writeLong from:&lt;br/&gt;
	   writeFloat(null,docs.getMaxScore());&lt;br/&gt;
to:&lt;br/&gt;
	   writeFloat(null,0);&lt;br/&gt;
and it then works without bringing back the max_score. However, I am not sure why the score is coming back null here. If you return the results in XML it also works so the problem seems limited to JSON and Ruby.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Tested on both Linux and OSX running latest 1.3 build&lt;/p&gt;</environment>
        <key id="12400162">SOLR-626</key>
            <summary>docs.getMaxScore is null inside writeSolrDocumentList when sorting using shards and returning output as JSON</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="iconnor">ian connor</reporter>
                        <labels>
                    </labels>
                <created>Sat, 12 Jul 2008 18:28:44 +0100</created>
                <updated>Fri, 10 May 2013 11:40:16 +0100</updated>
                            <resolved>Tue, 15 Jul 2008 03:25:33 +0100</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.3</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12613114" author="yseeley@gmail.com" created="Sat, 12 Jul 2008 19:57:18 +0100"  >&lt;p&gt;I&apos;ve fixed + committed the immediately apparent null pointer exception.&lt;br/&gt;
I was able to reproduce it with&lt;br/&gt;
&lt;a href=&quot;http://localhost:8983/solr/select?indent=on&amp;amp;sort=id%20desc&amp;amp;q=solr&amp;amp;wt=json&amp;amp;fl=*,score&amp;amp;shards=localhost:8983/solr&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select?indent=on&amp;amp;sort=id%20desc&amp;amp;q=solr&amp;amp;wt=json&amp;amp;fl=*,score&amp;amp;shards=localhost:8983/solr&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But, this was just a symptom of a larger bug... if &quot;score&quot; isn&apos;t in the sort, but is in the field list, scores are still not returned.&lt;br/&gt;
I&apos;m looking into this.&lt;/p&gt;</comment>
                            <comment id="12613116" author="iconnor" created="Sat, 12 Jul 2008 20:10:42 +0100"  >&lt;p&gt;I am new to JIRA - how can I see/test this code change and let you know if it worked? I tried to &quot;svn update&quot; ... but I am not sure which file you changed:&lt;/p&gt;

&lt;p&gt;U    CHANGES.txt&lt;br/&gt;
U    src/java/org/apache/solr/update/SolrIndexWriter.java&lt;br/&gt;
U    src/java/org/apache/solr/common/SolrDocument.java&lt;br/&gt;
U    src/java/org/apache/solr/core/SolrCore.java&lt;br/&gt;
U    src/java/org/apache/solr/util/SolrPluginUtils.java&lt;br/&gt;
U    src/webapp/web/admin/header.jsp&lt;br/&gt;
U    src/webapp/web/admin/form.jsp&lt;br/&gt;
U    src/webapp/web/admin/index.jsp&lt;br/&gt;
U    src/webapp/web/admin/analysis.jsp&lt;br/&gt;
U    client/java/solrj/src/org/apache/solr/client/solrj/SolrQuery.java&lt;/p&gt;

&lt;p&gt;It is just after this update the problem still happens for me.&lt;/p&gt;</comment>
                            <comment id="12613118" author="iconnor" created="Sat, 12 Jul 2008 20:23:49 +0100"  >&lt;p&gt;A possible work around when you sort on a given field, is to add a secondary sort of &quot;score&quot; and then it works fine. It will return the score as well as sorting in the order you want.&lt;/p&gt;</comment>
                            <comment id="12613142" author="yseeley@gmail.com" created="Sun, 13 Jul 2008 01:47:23 +0100"  >&lt;p&gt;Sorry Ian, I was in the wrong directory when I hit &quot;svn commit&quot; and thus it didn&apos;t get committed.&lt;br/&gt;
It should be OK now (the null pointer exception, not the missing scores).&lt;/p&gt;</comment>
                            <comment id="12613513" author="yseeley@gmail.com" created="Tue, 15 Jul 2008 03:25:33 +0100"  >&lt;p&gt;I&apos;ve committed an additional fix so that scores are returned if requested in the field list.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 12 Jul 2008 18:57:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6985</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxq6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20562</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>