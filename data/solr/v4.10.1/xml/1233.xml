<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:15:48 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-1233/SOLR-1233.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-1233] Remove restriction that /select cannot be used for /-prefixed request handlers via qt</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1233</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Currently /select?qt=/whatever is blocked by SolrDispatchFilter.  It makes life a lot easier to make general requests to any request handler (for example in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1230&quot; title=&quot;dataimport.jsp hardcoded to /dataimport handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1230&quot;&gt;&lt;del&gt;SOLR-1230&lt;/del&gt;&lt;/a&gt; where dataimport.jsp needs to request to arbitrary handler names).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12428358">SOLR-1233</key>
            <summary>Remove restriction that /select cannot be used for /-prefixed request handlers via qt</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ehatcher">Erik Hatcher</assignee>
                                    <reporter username="ehatcher">Erik Hatcher</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Jun 2009 14:19:12 +0100</created>
                <updated>Tue, 10 Apr 2012 16:35:22 +0100</updated>
                            <resolved>Fri, 19 Jun 2009 15:00:11 +0100</resolved>
                                    <version>1.3</version>
                                    <fixVersion>1.4</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12721780" author="ehatcher" created="Fri, 19 Jun 2009 14:23:42 +0100"  >&lt;p&gt;This patch removes the restriction on /select on hitting /-prefixed request handlers.&lt;/p&gt;</comment>
                            <comment id="12721788" author="ehatcher" created="Fri, 19 Jun 2009 15:00:11 +0100"  >&lt;p&gt;Committed.  &lt;/p&gt;

&lt;p&gt;The Solr wiki is broken for saving at the time of writing, but this blurb belongs on the SolrSecurity page:&lt;/p&gt;

&lt;p&gt;== Request Handler Paths ==&lt;/p&gt;

&lt;p&gt;Solr provides access to request handlers through a general purpose /select?qt=request_handler_name URL.  Prior to &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;Solr1.4&amp;quot;&amp;#93;&lt;/span&gt; (via &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1233&quot; title=&quot;Remove restriction that /select cannot be used for /-prefixed request handlers via qt&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1233&quot;&gt;&lt;del&gt;SOLR-1233&lt;/del&gt;&lt;/a&gt;), request handlers named with a leading forward-slash like /select?qt=/request_handler_name could not be used, but had to be requested using /request_handler_name.  &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;Solr1.4&amp;quot;&amp;#93;&lt;/span&gt; removes the forward-slash restriction and allows /select to work with any request handler name.  Externally blocking access to /select is recommended in environments where only path-based access to request handlers is warranted.&lt;/p&gt;</comment>
                            <comment id="12775781" author="gsingers" created="Tue, 10 Nov 2009 15:52:08 +0000"  >&lt;p&gt;Bulk close for Solr 1.4&lt;/p&gt;</comment>
                            <comment id="13169425" author="dsmiley" created="Wed, 14 Dec 2011 15:18:27 +0000"  >&lt;p&gt;Seriously?! I was just about to report a security oriented bug that the likes of this is supported:&lt;br/&gt;
  &lt;a href=&quot;http://localhost:8983/solr/select?qt=/dataimport&amp;amp;command=full-import&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select?qt=/dataimport&amp;amp;command=full-import&lt;/a&gt;&lt;br/&gt;
And get this... (as I say with a fiendish chuckle):&lt;br/&gt;
  &lt;a href=&quot;http://localhost:8983/solr/select?qt=/update&amp;amp;stream.body=%3Cd%3E%3Cdelete%3E%3Cquery%3E*%3A*%3C%2Fquery%3E%3C%2Fdelete%3E%3Ccommit%2F%3E%3C%2Fd%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8983/solr/select?qt=/update&amp;amp;stream.body=%3Cd%3E%3Cdelete%3E%3Cquery%3E*%3A*%3C%2Fquery%3E%3C%2Fdelete%3E%3Ccommit%2F%3E%3C%2Fd%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Booyaaa!  All your data is gone.&lt;/p&gt;

&lt;p&gt;And no, disabling remote streaming in the schema won&apos;t save you this time.&lt;/p&gt;

&lt;p&gt;Users expect /select to do a search and I don&apos;t think there should be any if&apos;s and&apos;s or but&apos;s about that expectation.  I don&apos;t really like the qt parameter and think people should prefix their request handlers with a slash and access them directly, but I don&apos;t expect to change anyone&apos;s mind here.  But if qt starts with a slash, then I think it should ideally not work, or for backwards compatibility sake, only support it if the target request handler has the same class as the current request handler.&lt;/p&gt;</comment>
                            <comment id="13169431" author="dsmiley" created="Wed, 14 Dec 2011 15:36:52 +0000"  >&lt;p&gt;And I was &lt;b&gt;hoping&lt;/b&gt; to find a way to disable this vulnerability in the solrconfig.xml... thinking that perhaps I could lock down qt with invariants, but that doesn&apos;t work.  Presumably qt is special.  I hate qt.&lt;/p&gt;</comment>
                            <comment id="13169477" author="dsmiley" created="Wed, 14 Dec 2011 15:57:15 +0000"  >&lt;p&gt;I found a solution, which is to disable qt by changing the default search handler named=&quot;search&quot; to be name=&quot;/select&quot;:&lt;br/&gt;
&amp;lt;requestHandler name=&quot;/select&quot; class=&quot;solr.SearchHandler&quot;&amp;gt;&lt;br/&gt;
instead of:&lt;br/&gt;
&amp;lt;requestHandler name=&quot;search&quot; class=&quot;solr.SearchHandler&quot; default=&quot;true&quot;&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13187504" author="dsmiley" created="Tue, 17 Jan 2012 07:12:26 +0000"  >&lt;p&gt;I created issue &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3040&quot; title=&quot;Avoid use of qt param for the DIH in the admin UI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3040&quot;&gt;&lt;del&gt;SOLR-3040&lt;/del&gt;&lt;/a&gt; which updates the admin UI to NOT use the qt parameter for working with the DIH.&lt;/p&gt;</comment>
                            <comment id="13215810" author="dsmiley" created="Fri, 24 Feb 2012 18:51:03 +0000"  >&lt;p&gt;I&apos;m very surprised that I am the only one commenting on this issue. FWIW, in other private communication channels, I know there is support for what I want here among at least some committers.&lt;/p&gt;

&lt;p&gt;I haven&apos;t yet looked at the code involved for suggestions here; I&apos;m speaking based on how I think things should work and not work, based on intuitiveness and security.  In general I feel it is best practice to use &apos;/&apos; leading request handler names and not use &quot;qt&quot;, but I don&apos;t hate it enough when used in limited (search-only) circumstances to propose its demise.  But if someone proposes its deprecation that then I am +1 for that.&lt;/p&gt;

&lt;p&gt;Here is my proposal:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Solr should error if the parameter &quot;qt&quot; is supplied with a leading &apos;/&apos;.  (trunk only)&lt;/li&gt;
	&lt;li&gt;Solr should only honor &quot;qt&quot; if the target request handler extends solr.SearchHandler.&lt;/li&gt;
	&lt;li&gt;The new admin UI should only use &apos;qt&apos; when it has to. For the query screen, it could present a little pop-up menu of handlers to choose from, including &quot;/select?qt=mycustom&quot; for handlers that aren&apos;t named with a leading &apos;/&apos;.  This choice should be positioned at the top.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;And before I forget, me or someone should investigate if there are any similar security problems with the shards.qt parameter.  Perhaps shards.qt can abide by the same rules outlined above.&lt;/p&gt;

&lt;p&gt;Does anyone foresee any problems with this proposal?&lt;/p&gt;

&lt;p&gt;On a related subject, I think the notion of a default request handler is bad &amp;#8211; the default=&quot;true&quot; thing.  Honestly I&apos;m not sure what it does, since I noticed Solr trunk redirects &apos;/solr/&apos; to the new admin UI at &apos;/solr/#/&apos;.  Assuming it doesn&apos;t do anything useful anymore, I think it would be clearer to use &amp;lt;requestHandler name=&quot;/select&quot; class=&quot;solr.SearchHandler&quot;&amp;gt; instead of what&apos;s there now.  The delta is to put the leading &apos;/&apos; on this request handler name, and remove the &quot;default&quot; attribute.&lt;/p&gt;</comment>
                            <comment id="13215820" author="dsmiley" created="Fri, 24 Feb 2012 19:01:06 +0000"  >&lt;p&gt;I decided to move this discussion to a new issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3161&quot; title=&quot;Use of &amp;#39;qt&amp;#39; should be restricted to searching and should not start with a &amp;#39;/&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3161&quot;&gt;&lt;del&gt;SOLR-3161&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Please comment there, not here.&lt;/p&gt;</comment>
                            <comment id="13215821" author="ryantxu" created="Fri, 24 Feb 2012 19:01:44 +0000"  >&lt;p&gt;For background, in the original RequestHandler design, we disallowed qt with leading &apos;/&apos; for security reasons.&lt;/p&gt;

&lt;p&gt;While solr does not internally support security, we need to make sure that it does not prevent standard path based security.&lt;/p&gt;

&lt;p&gt;+1 to put the restriction back&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12538603">SOLR-3040</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12544033">SOLR-3161</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12411224" name="SOLR-1233.patch" size="1468" author="ehatcher" created="Fri, 19 Jun 2009 14:23:42 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 10 Nov 2009 15:52:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6415</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxmi7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19965</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>