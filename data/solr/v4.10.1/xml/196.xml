<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 05:15:29 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/SOLR-196/SOLR-196.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[SOLR-196] A PHP response writer for Solr</title>
                <link>https://issues.apache.org/jira/browse/SOLR-196</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;It would be useful to have a PHP response writer that returns an array to be eval-ed directly. This is especially true for PHP4.x installs, where there is no built in support for JSON.&lt;/p&gt;

&lt;p&gt;This issue attempts to address this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12365725">SOLR-196</key>
            <summary>A PHP response writer for Solr</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="pborgerm">Paul Borgermans</reporter>
                        <labels>
                    </labels>
                <created>Sat, 24 Mar 2007 11:58:00 +0000</created>
                <updated>Fri, 10 May 2013 11:40:26 +0100</updated>
                            <resolved>Sat, 11 Aug 2007 04:32:11 +0100</resolved>
                                                    <fixVersion>1.3</fixVersion>
                                    <component>clients - php</component>
                    <component>search</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>4</watches>
                                                                            <aggregatetimeoriginalestimate seconds="10800">3h</aggregatetimeoriginalestimate>
                                        <aggregatetimeremainingestimate seconds="10800">3h</aggregatetimeremainingestimate>
                                                <comments>
                            <comment id="12483837" author="pborgerm" created="Sat, 24 Mar 2007 12:05:19 +0000"  >&lt;p&gt;Attached first version of my patch to provide a PHP response writer (patch made against trunk rev 516287)&lt;/p&gt;

&lt;p&gt;This relies on a correct schema.xml config file with respect to multi valued fields!! Otherwise, duplicate keys are generated.&lt;/p&gt;</comment>
                            <comment id="12483849" author="yseeley@gmail.com" created="Sat, 24 Mar 2007 15:41:12 +0000"  >&lt;p&gt;Thanks Paul,&lt;br/&gt;
Perhaps introducing some protected variables in the base class like&lt;br/&gt;
ARRAY_START, ARRAY_SEP, ARRAY_END, etc, would allow us to eliminate some code duplication?&lt;/p&gt;</comment>
                            <comment id="12483891" author="pborgerm" created="Sat, 24 Mar 2007 22:23:36 +0000"  >&lt;p&gt;Hi Yonik&lt;/p&gt;

&lt;p&gt;Yes, I was looking in this direction as well, but I did not want to touch the Python and Ruby response writers (yet). &lt;/p&gt;

&lt;p&gt;My next priority however is to release a set of PHP classes to interact with Solr. If these protected variables appear, the PHP response writer will be immediately adapted.&lt;/p&gt;

&lt;p&gt;Regards&lt;br/&gt;
Paul&lt;/p&gt;
</comment>
                            <comment id="12507078" author="tristanv" created="Fri, 22 Jun 2007 01:40:28 +0100"  >&lt;p&gt;Hi Paul,&lt;/p&gt;

&lt;p&gt;Thanks for your work on the PHP response writer, I&apos;ve applied your patch to the current svn trunk (revsion 549649) and manage to get it working only one minor change to PHPResponseWriter.java on line 23:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;import org.apache.solr.util.NamedList;&lt;br/&gt;
+ import org.apache.solr.common.util.NamedList;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Have you managed to get any further in developing this response writer or the Solr client classes you mention in your previous comment?  I have been looking for a response writer that created serialized php data rather than eval-able code, perhaps it would be easy to adapt the code in this patch to support this?  (I will take a look however my Java skill are not too strong yet).&lt;/p&gt;

&lt;p&gt;cheers,&lt;br/&gt;
Tristan&lt;/p&gt;</comment>
                            <comment id="12517429" author="pberkel" created="Fri, 3 Aug 2007 05:02:10 +0100"  >&lt;p&gt;This patch updates the PHPResponseWriter original written by Paul Borgermans and integrates the serialized PHP response writer (renamed to PHPSerializedResponseWriter to avoid name clashes) originally authored by Nick Jenkin in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-275&quot; title=&quot;PHP Serialized Response Writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-275&quot;&gt;&lt;del&gt;SOLR-275&lt;/del&gt;&lt;/a&gt;.  See &lt;a href=&quot;http://www.nabble.com/PHP-Response-Writer-for-Solr-tf4140580.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/PHP-Response-Writer-for-Solr-tf4140580.html&lt;/a&gt; for some discussion on this implementation.&lt;/p&gt;

&lt;p&gt;I&apos;ve made minimal code changes to JSONwriter in order to reducing the amount of code-duplication, specifically replacing all static writes of array and map structure tokens with methods:&lt;/p&gt;

&lt;p&gt;  public void writeMapOpener(int size) throws IOException, IllegalArgumentException { writer.write(&apos;&lt;/p&gt;
{&apos;); }
&lt;p&gt;  public void writeMapSeparator() throws IOException &lt;/p&gt;
{ writer.write(&apos;,&apos;); }&lt;br/&gt;
  public void writeMapCloser() throws IOException { writer.write(&apos;}&apos;); }&lt;br/&gt;
  &lt;br/&gt;
  public void writeArrayOpener(int size) throws IOException, IllegalArgumentException { writer.write(&apos;[&apos;); }&lt;br/&gt;
  public void writeArraySeparator() throws IOException { writer.write(&apos;,&apos;); }
&lt;p&gt;  public void writeArrayCloser() throws IOException &lt;/p&gt;
{ writer.write(&apos;]&apos;); }

&lt;p&gt;The size parameter has been introduced specifically for PHPSerializedWriter (where the output format explicitly requires the size of the array / map to be set) and is currently ignored by all other response writers.  In cases where the size is not trivial to calculate (e.g. an Iterable object), it is set to -1.  Classes extending JSONwriter that require a valid (non-negative) size value must overload certain methods (i.e. writeArray() and writeDoc()) to calculate size correctly.  It would also be a good idea to check for invalid size values in writeMapOpener() and writeArrayOpener() and throw a IllegalArgumentException if so.&lt;/p&gt;

&lt;p&gt;Some other changes I&apos;ve made to the PHPWriter code from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-196&quot; title=&quot;A PHP response writer for Solr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-196&quot;&gt;&lt;del&gt;SOLR-196&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;1) Removed a lot of code duplicated from JSONwriter.&lt;br/&gt;
2) Updated writeStr() to use StringBuilder.&lt;/p&gt;

&lt;p&gt;Some other changes I&apos;ve made to the PHPSerializedWriter code from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-275&quot; title=&quot;PHP Serialized Response Writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-275&quot;&gt;&lt;del&gt;SOLR-275&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;1) Removed some uneccessary duplicate code.&lt;br/&gt;
2) Changed key type written by writeArray() from String to int (since they are suppose to be numeric indicies).&lt;br/&gt;
3) Updated writeStr() - serialized php strings don&apos;t need to be escaped (it seems to rely only on the specified string size value) and size needs be specified in bytes not characters (some Unicode characters were causing problems when using String.length() to calculate size, can someone please sanity check this code?).&lt;/p&gt;

&lt;p&gt;I&apos;ve tested both PHPWriter &amp;amp; PHPSerializedWriter and they both seem to output valid PHP data, it would be great if people could also test them to ensure they work in their environments.  JSONWriter also seems to be fine and although I didn&apos;t test the Python or Ruby writers, I assume they are unaffected (can anyone confirm?).  &lt;/p&gt;

&lt;p&gt;Additionally, I&apos;ve moved PythonWriter and RubyWriter from JSONResponseWriter.java to PythonResponseWriter.java and RubyResponseWriter.java respectively.&lt;/p&gt;

&lt;p&gt;I noticed that while each Writer specifies a content type value (e.g. CONTENT_TYPE_JSON_UTF8, CONTENT_TYPE_PYTHON_ASCII) the value returned by getContentType() is generally CONTENT_TYPE_TEXT_UTF8 or CONTENT_TYPE_TEXT_ASCII.  This is not a big deal and I guessed this allows the output to be easily displayed in a browser, however it would be quite useful to have the actual content type value set so that client applications can determine the response format encoding and process it accordingly without relying on access to the original &quot;wt&quot; query paramater.&lt;/p&gt;</comment>
                            <comment id="12517432" author="pberkel" created="Fri, 3 Aug 2007 05:11:00 +0100"  >&lt;p&gt;This latest patch incorporates and deprecates code supplied in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-275&quot; title=&quot;PHP Serialized Response Writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-275&quot;&gt;&lt;del&gt;SOLR-275&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12517552" author="yseeley@gmail.com" created="Fri, 3 Aug 2007 15:43:58 +0100"  >&lt;p&gt;Thanks Pieter,&lt;br/&gt;
Regarding the content-type, I found it more useful to be able to actually see the result in a browser.&lt;br/&gt;
Is there a content-type we can use for JSON that can achieve both goals for firefox and IE at least?&lt;/p&gt;</comment>
                            <comment id="12518054" author="nickjenkin" created="Tue, 7 Aug 2007 03:29:29 +0100"  >&lt;p&gt;Excellent stuff, thanks Pieter!&lt;/p&gt;</comment>
                            <comment id="12519192" author="yseeley@gmail.com" created="Sat, 11 Aug 2007 04:32:11 +0100"  >&lt;p&gt;Thanks guys!&lt;br/&gt;
I just committed this.&lt;/p&gt;</comment>
                            <comment id="12519195" author="pberkel" created="Sat, 11 Aug 2007 05:25:18 +0100"  >&lt;p&gt;Great! I&apos;ll try to add some documentation to the wiki in the next few days.&lt;/p&gt;

&lt;p&gt;&amp;gt;Regarding the content-type, I found it more useful to be able to actually see the result in a browser.&lt;br/&gt;
&amp;gt;Is there a content-type we can use for JSON that can achieve both goals for firefox and IE at least?&lt;/p&gt;

&lt;p&gt;I couldn&apos;t find any suitable mime types that would achieve this goal so it&apos;s probably better to leave the content-types unchanged for the moment.&lt;/p&gt;</comment>
                            <comment id="12519196" author="pberkel" created="Sat, 11 Aug 2007 05:38:46 +0100"  >&lt;p&gt;Hmm, it doesn&apos;t look like the two new files from the patch were added properly during the latest commit:&lt;br/&gt;
/src/java/org/apache/solr/request/PHPResponseWriter.java&lt;br/&gt;
/src/java/org/apache/solr/request/PHPSerializedResponseWriter.java &lt;br/&gt;
We won&apos;t get very far without those!&lt;/p&gt;</comment>
                            <comment id="12519226" author="yseeley@gmail.com" created="Sat, 11 Aug 2007 14:03:44 +0100"  >&lt;p&gt;Got it... thanks.&lt;br/&gt;
How I wish there were an svn patch that would add files for me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;-Yonik&lt;/p&gt;
</comment>
                            <comment id="12579146" author="hossman" created="Sun, 16 Mar 2008 03:23:52 +0000"  >&lt;p&gt;This bug was modified as part of a bulk update using the criteria...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Marked &quot;Resolved&quot; and &quot;Fixed&quot;&lt;/li&gt;
	&lt;li&gt;Had no &quot;Fix Version&quot; versions&lt;/li&gt;
	&lt;li&gt;Was listed in the CHANGES.txt for 1.3 as of today 2008-03-15&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The Fix Version for all 29 issues found was set to 1.3, email notification was suppressed to prevent excessive email.&lt;/p&gt;

&lt;p&gt;For a list of all the issues modified, search jira comments for this (hopefully) unique string: batch20070315hossman1&lt;/p&gt;
</comment>
                            <comment id="12680288" author="pwolanin" created="Mon, 9 Mar 2009 21:32:42 +0000"  >&lt;p&gt;This PHP writer is inconsistent with the JSON if you use php 5&apos;s decode_json, maps come back as objects.&lt;/p&gt;</comment>
                            <comment id="12708172" author="euperia" created="Mon, 11 May 2009 20:48:46 +0100"  >&lt;p&gt;I&apos;m finding occasionally that the return from the php response writer fails to unserialize in PHP5. &lt;/p&gt;

&lt;p&gt;I have a number of fields in the &apos;fl=&apos; parameter of my query and it works fine until I add the field name &apos;recommended&apos;.  It then fails.  If I remove all other field names and leave fl=recommended it still fails.&lt;/p&gt;

&lt;p&gt;I can see the output and it contains the results, but fails on unserializing in PHP.&lt;/p&gt;

&lt;p&gt;Is &apos;recommended&apos; some sort of reserved word?&lt;/p&gt;</comment>
                            <comment id="12708190" author="yseeley@gmail.com" created="Mon, 11 May 2009 21:16:49 +0100"  >&lt;p&gt;Perhaps escaping isn&apos;t correct for this particular field?&lt;br/&gt;
Can you post the output from fl=recommended?&lt;br/&gt;
Is it particular values of that field that cause the problem, or &lt;b&gt;any&lt;/b&gt; document retrieved with that field?  If particular values, perhaps you could narrow it down and just post the problematic value?&lt;/p&gt;</comment>
                            <comment id="12709798" author="euperia" created="Fri, 15 May 2009 11:27:42 +0100"  >&lt;p&gt;I think the issue I have is with Solr and not the PHP output.  My &apos;recommended&apos; field is an integer in the solr schema.xml but when documents are added it is converting  0 and 1 to boolean values, even though I have some values at 0,1,2, 10 and 11.&lt;/p&gt;

&lt;p&gt;Hence the output is showing as:&lt;/p&gt;

{s:2:&quot;id&quot;;s:6:&quot;538366&quot;;s:11:&quot;recommended&quot;;i:false;}

&lt;p&gt;I think that PHP&apos;s unserialize function may be failing due to the wrong value for the datatype.&lt;/p&gt;

</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12372408">SOLR-275</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12354145" name="SOLR-192-php-responsewriter.patch" size="9857" author="pborgerm" created="Sat, 24 Mar 2007 12:05:19 +0000"/>
                            <attachment id="12363097" name="SOLR-196-PHPResponseWriter.patch" size="31359" author="pberkel" created="Fri, 3 Aug 2007 05:02:10 +0100"/>
                    </attachments>
                <subtasks>
                            <subtask id="12400248">SOLR-631</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 24 Mar 2007 15:41:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7391</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hxxst3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20986</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>