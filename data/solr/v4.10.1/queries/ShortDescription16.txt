patch to allow the use of a custom query output writer