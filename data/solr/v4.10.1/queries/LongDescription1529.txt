The problem occurs when a RequestUpdate has deletions that are all *byQuery (as opposed to *byId). The variable 'deletes' is in this case never initialized and will cause a NullPointerException in some cases (where the number of deletions are high enough).