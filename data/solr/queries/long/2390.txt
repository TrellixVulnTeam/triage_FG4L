There is a large performance bug here.