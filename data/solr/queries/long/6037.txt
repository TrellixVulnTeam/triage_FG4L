When computing statistics using the statistics component, the value for max may be reported incorrectly if the maximum value does not lie in the first shard. 

This is where the problem is:
StatsValuesFactory.java

  @Override
  protected void updateMinMax(Date min, Date max) {
    if(this.min==null || this.min.after(min)) {
      this.min = min;
    }
    if(this.max==null || this.max.before(min)) {
      this.max = max;
    }
  }


Attached is a one-line patch which fixes this issue.