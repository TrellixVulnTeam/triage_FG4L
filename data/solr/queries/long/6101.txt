When we invoke splitshard Collection API against a cluster with legacyCloud=false, we get the following errors:



2014-05-15 21:07:58,986 [Overseer-163819091268403216-ec2-xxxxx.compute-1.amazonaws.com:8986_solr-n_0000000051] ERROR solr.cloud.OverseerCollectionProcessor  - Collection splitshard of splitshard failed:org.apache.solr.common.SolrException: Could not find coreNodeName
        at org.apache.solr.cloud.OverseerCollectionProcessor.waitForCoreNodeName(OverseerCollectionProcessor.java:1504)
        at org.apache.solr.cloud.OverseerCollectionProcessor.splitShard(OverseerCollectionProcessor.java:1255)
        at org.apache.solr.cloud.OverseerCollectionProcessor.processMessage(OverseerCollectionProcessor.java:472)
        at org.apache.solr.cloud.OverseerCollectionProcessor.run(OverseerCollectionProcessor.java:248)
        at java.lang.Thread.run(Thread.java:745)

2014-05-15 21:07:59,003 [Overseer-163819091268403216-ec2-xxxxxxx.compute-1.amazonaws.com:8986_solr-n_0000000051] INFO  solr.cloud.OverseerCollectionProcessor  - Overseer Collection Processor: Message id:/overseer/collection-queue-work/qn-0000000018 complete, response:{success={null={responseHeader={status=0,QTime=1}},null={responseHeader={status=0,QTime=1}}},split117278106116750={responseHeader={status=0,QTime=0},STATUS=failed,Response=Error CREATEing SolrCore '3M_shard1_1_replica1': non legacy mode coreNodeName missing shard=shard1_1&name=3M_shard1_1_replica1&action=CREATE&collection=3M&wt=javabin&qt=/admin/cores&async=split117278106116750&version=2},Operation splitshard caused exception:=org.apache.solr.common.SolrException: Could not find coreNodeName,exception={msg=Could not find coreNodeName,rspCode=500}}



The sub-shard replica (leader) creation fails due to:


{
responseHeader: {
status: 0,
QTime: 0
},
STATUS: "failed",
Response: "Error CREATEing SolrCore '3M_shard1_0_replica1': non legacy mode coreNodeName missing shard=shard1_0&name=3M_shard1_0_replica1&action=CREATE&collection=3M&wt=javabin&qt=/admin/cores&async=split117278099904930&version=2"
}

