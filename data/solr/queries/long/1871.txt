Currently, as documented at http://wiki.apache.org/solr/FunctionQuery#map, the "target" of a map must be a floating point constant. I propose that you should have at least the option of doing a map where the target is an arbitrary ValueSource.

The particular use case that inspired this is that I want to be able to control how missing date fields affected boosting. In particular, I want to be able to use something like this in my function queries:



map(mydatefield,0,0,ms(NOW))



But this might have other uses.

I'll attach an initial implementation.