Like NFS, HDFS has different file delete semantics than Windows and Unix. For non NRT cases, you can work around this by reserving commit points, but NRT counts on delete on last close semantics (unix), or delete fails, try again later (windows). This is because files can be merged away before they even become part of a commit point. Meanwhile, real time readers can reference those files.