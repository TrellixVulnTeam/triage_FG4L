method andNot(DocSet other) checks for instance of OpenBitSet - should be BitDocSet. Looks like you lose an optimization.