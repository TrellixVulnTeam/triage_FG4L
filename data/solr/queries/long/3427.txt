Under some circumstances faceting in Solr throws the following NPE

May 1, 2012 8:48:52 PM org.apache.solr.common.SolrException log
SEVERE: java.lang.NullPointerException
       at org.apache.lucene.index.DocTermOrds.lookupTerm(DocTermOrds.java:807)
       at org.apache.solr.request.UnInvertedField.getTermValue(UnInvertedField.java:636)
       at org.apache.solr.request.UnInvertedField.getCounts(UnInvertedField.java:411)
       at org.apache.solr.request.SimpleFacets.getTermCounts(SimpleFacets.java:300)
       at org.apache.solr.request.SimpleFacets.getFacetFieldCounts(SimpleFacets.java:396)
       at org.apache.solr.request.SimpleFacets.getFacetCounts(SimpleFacets.java:205)
       at org.apache.solr.handler.component.FacetComponent.process(FacetComponent.java:81)
       at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:204)
       at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)
       at org.apache.solr.core.SolrCore.execute(SolrCore.java:1550)
       at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:442)
       at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:263)
       at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337)
       at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:484)
       at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
       at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:524)
       at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
       at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1065)
       at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:413)
       at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
       at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:999)
       at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
       at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
       at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
       at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111)
       at org.eclipse.jetty.server.Server.handle(Server.java:351)
       at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:454)
       at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:47)
       at org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:900)
       at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:954)
       at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:857)
       at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)
       at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:66)
       at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:254)
       at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:599)
       at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:534)
       at java.lang.Thread.run(Thread.java:662)

I've noticed this happening after doing deletes.  When I've seen this issue before an optimize has made the issue go away.  I believe this may also be related to the describe here:
http://stackoverflow.com/questions/10124055/solr-faceted-search-throws-nullpointerexception-with-http-500-status

I have been unable to reproduce this in a test but this has come up at least 3 times in our environments.