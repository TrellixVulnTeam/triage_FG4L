Consider the code in FieldResource.java:


SchemaField newField = oldSchema.newField(fieldName, fieldType, map);
IndexSchema newSchema = oldSchema.addField(newField, copyFieldNames);
if (null != newSchema) {
  getSolrCore().setLatestSchema(newSchema);
  success = true;
} else {
  throw new SolrException(ErrorCode.SERVER_ERROR, "Failed to add field.");
}



The schema update lock is only held during the call to addField, so there is no guarantee that the schema we are setting later is actually the latest schema.  This would rarely happen, but it's possible that between the time we gave up the lock and the time we set the schema that we got a new schema from ZK.  We'd end up overwriting the new schema, possibly missing newly added fields.