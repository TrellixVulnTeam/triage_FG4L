Incorrect evaluation of logical expressions in CASE