NPE or assert failure in recursive trigger