ERROR 22011: The second or third argument of the SUBSTR function is out of range   with data concatenation in group by query.