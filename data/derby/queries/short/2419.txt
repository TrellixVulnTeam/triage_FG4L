Tighten encapsulation of state in TestConfiguration