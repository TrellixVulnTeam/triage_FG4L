code checks to see if an array is not null, and if so allocates the array. This is backwards. Should check to see if the array is null.