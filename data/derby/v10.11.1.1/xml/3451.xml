<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:16:12 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3451/DERBY-3451.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3451] Remove dependency between StandardException class and org.apache.derby.impl.jdbc classes.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3451</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;In the package org.apache.derby.iapi.error, the class StandardException contains references to following classes:&lt;br/&gt;
org.apache.derby.impl.jdbc.Util&lt;br/&gt;
org.apache.derby.impl.jdbc.EmbedSQLException&lt;/p&gt;

&lt;p&gt;This is undesirable as it introduces a dependency between StandardException and the implementation of EmbedSQLException.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12389359">DERBY-3451</key>
            <summary>Remove dependency between StandardException class and org.apache.derby.impl.jdbc classes.</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12389357">DERBY-3450</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dibyendumajumdar">Dibyendu Majumdar</assignee>
                                    <reporter username="dibyendumajumdar">Dibyendu Majumdar</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Feb 2008 23:17:53 +0000</created>
                <updated>Thu, 2 May 2013 03:29:12 +0100</updated>
                            <resolved>Thu, 12 Jun 2008 21:43:36 +0100</resolved>
                                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12571642" author="dibyendumajumdar" created="Fri, 22 Feb 2008 23:43:21 +0000"  >&lt;p&gt;To remove this dependency, following changes have been made. &lt;/p&gt;

&lt;p&gt;A new interface called DerbySQLException has been added to org.apache.derby.iapi.error. &lt;br/&gt;
The EmbedSQLException class has been modified to implement this interface. &lt;br/&gt;
The StandardException calls the isSimpleWrapper method on the DerbySQLException interface, thereby avoiding a need to reference EmbedSQLException. &lt;/p&gt;

&lt;p&gt;A new static method getArgumentFerry() has been added to StandardExcepion. This performs the same task as the current getArgumentFerry() method in SQLExceptionFactory and SQLExceptionFactory40. &lt;br/&gt;
SQLExceptionFactory.getArgumentFerry() has been amended to call StandardException.getArgumentFerry(). &lt;br/&gt;
SQLExceptionFactory40.getArgumentFerry() has been removed. &lt;br/&gt;
StandardException.getArgumentFerry() now handles the pre-JDBC3 and post-JDBC4 scenarios (in the pre-JDBC4 scenario, the passed argument is a DerbySQLException, which is returned immediately), so there is no need to override this functionality. &lt;/p&gt;

&lt;p&gt;This change allows us to avoid having a dependency between StandardException and Util. &lt;br/&gt;
As the getArgumentFerry() method now checks for DerbySQLException rather than EmbedSQLException, it is able to avoid dependency on EmbedSQLException.&lt;/p&gt;</comment>
                            <comment id="12571644" author="dibyendumajumdar" created="Fri, 22 Feb 2008 23:49:23 +0000"  >&lt;p&gt;The submitted patch was generated using Mercurial. If the patch is not in the correct format, please let me know.&lt;br/&gt;
I ran derbyall test suite (using Java 6 on CentOS 5.1). 482 out of 495 tests passed (10 suites were skipped).&lt;br/&gt;
The failures don&apos;t seem to be related to the changes, but to verify I am running the tests again after having the removed my patches.&lt;/p&gt;</comment>
                            <comment id="12571646" author="kmarsden" created="Fri, 22 Feb 2008 23:58:48 +0000"  >&lt;p&gt;There are also the JUnit tests run by the suite suites.All. See java/testing/README.htm for details.&lt;/p&gt;</comment>
                            <comment id="12571655" author="dibyendumajumdar" created="Sat, 23 Feb 2008 00:18:51 +0000"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;I tried running the junit-all tests on CentOS 5.1, but they fail immediately with security exceptions (same errors as reported by you in  &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2667&quot; title=&quot;Improve diagnostic information for failed  derby JUnit tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2667&quot;&gt;&lt;del&gt;DERBY-2667&lt;/del&gt;&lt;/a&gt;). I am running the junit-all tests on Mac O X using Java 1.5, and will record the test results once they complete.&lt;/p&gt;</comment>
                            <comment id="12571683" author="dibyendumajumdar" created="Sat, 23 Feb 2008 01:52:27 +0000"  >&lt;p&gt;Ran junit-all on MAC OS X, using Java 1.5. All junit-core tests passed. junit-jdbc4 tests were not run.&lt;/p&gt;</comment>
                            <comment id="12571698" author="djd" created="Sat, 23 Feb 2008 04:06:16 +0000"  >&lt;p&gt;FYI on the patch format, I can get it to apply  almost (I use Eclipse) but require an extra step. Doing nothing the patch appears to be against files&lt;/p&gt;

&lt;p&gt;   a/java/...&lt;/p&gt;

&lt;p&gt;so I can ignore 1 segment in the file and then it seems ok, though this patch did not apply cleanly, not sure if it depends on another patch or not.&lt;/p&gt;

&lt;p&gt;svn diff produces the expected format for patches. That format also includes the revision the patch is against, which allows anyone applying the patch to set their codeline to the same revision if they have problems applying it.&lt;/p&gt;

&lt;p&gt;I would recommend using svn diff to make it easier for committers (and others) to try out &amp;amp; commit patches.&lt;/p&gt;</comment>
                            <comment id="12571763" author="dibyendumajumdar" created="Sat, 23 Feb 2008 16:53:11 +0000"  >&lt;p&gt;The patch applies successfully if you use the patch command as follows:&lt;/p&gt;

&lt;p&gt;patch -p1 &amp;lt; &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3451&quot; title=&quot;Remove dependency between StandardException class and org.apache.derby.impl.jdbc classes.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3451&quot;&gt;&lt;del&gt;DERBY-3451&lt;/del&gt;&lt;/a&gt;_patch_1.txt&lt;/p&gt;

&lt;p&gt;To use Eclipse apply patch, ignore leading path name segments should be set to 1.&lt;br/&gt;
However, the Eclipse apply patch fails because it seems to require exact match of base revisions. The patch was created on a snapshot of trunk that is a few days old, and in the meantime, StandardException appears to have changed.&lt;/p&gt;

&lt;p&gt;I can use svn diff, but am unsure how to manage multiple patches against trunk using svn. &lt;br/&gt;
Mercurial allows me to maintain my changes as a series of patches, that I can keep separate from the trunk. &lt;/p&gt;

&lt;p&gt;In the meantime if I update my local repository and recreate the patch, it should apply against the latest revision in trunk.&lt;/p&gt;</comment>
                            <comment id="12571830" author="dibyendumajumdar" created="Sun, 24 Feb 2008 02:06:46 +0000"  >&lt;p&gt;Revised patch - created at revision 630512.&lt;/p&gt;

&lt;p&gt;Patch was created using Mercurial. See comments above for details on how to apply either using patch command or using Eclipse.&lt;/p&gt;

&lt;p&gt;Test results:&lt;/p&gt;

&lt;p&gt;derbyall ran on CentOS 5.1 using Java 6. Out of 250 tests, 2 failed. Looks like failures were caused by SQLException being output with stack trace.&lt;/p&gt;

&lt;p&gt;I also ran junit-all on Mac OS X, suing Java 1.5.&lt;br/&gt;
There were following failures:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Tests run: 0, Failures: 2, Errors: 0, Time elapsed: 1.131 sec&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Test org.apache.derbyTesting.functionTests.tests.demo._Suite FAILED&lt;/p&gt;

&lt;p&gt;Looks like failure was due to:&lt;br/&gt;
  &amp;lt;testcase classname=&quot;org.apache.derbyTesting.junit.SupportFilesSetup&quot; name=&quot;unknown&quot; time=&quot;0.0010&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;failure message=&quot;org/apache/derbyTesting/functionTests/tests/demo/cupisle.gif&quot; type=&quot;junit.framework.AssertionFailedError&quot;&amp;gt;junit.framework.AssertionFailedError: org/apache/derbyTesting/functionTests/tests/demo/cupisle.gif&lt;br/&gt;
        at org.apache.derbyTesting.junit.SupportFilesSetup.copyFiles(SupportFilesSetup.java:174)&lt;br/&gt;
        at org.apache.derbyTesting.junit.SupportFilesSetup.access$000(SupportFilesSetup.java:64)&lt;br/&gt;
        at org.apache.derbyTesting.junit.SupportFilesSetup$1.run(SupportFilesSetup.java:139)&lt;br/&gt;
        at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
        at org.apache.derbyTesting.junit.SupportFilesSetup.privCopyFiles(SupportFilesSetup.java:135)&lt;br/&gt;
        at org.apache.derbyTesting.junit.SupportFilesSetup.setUp(SupportFilesSetup.java:120)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:18)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
&amp;lt;/failure&amp;gt;&lt;br/&gt;
  &amp;lt;/testcase&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12572013" author="djd" created="Mon, 25 Feb 2008 04:58:44 +0000"  >&lt;p&gt;I&apos;m looking at committing this patch, I&apos;ll fix up the class name in the header in DerbySQLException.java (it has a different class name there).&lt;/p&gt;

&lt;p&gt;Just FYI - I think a longer term goal would be to remove EmbedSQLException and now DerbySQLException and instead just use java.sql.SQLException.&lt;br/&gt;
JDBC 4 tends to lead in that direction because it has a number of sub-classes for SQLException and I think it would be the wrong approach for Derby&lt;br/&gt;
to have an Embed version for every SQLException sub-class. The main reason originally for EmbedSQLException originally was to be able to&lt;br/&gt;
keep the original non-SQLException (e.g. StandardException, IOException), which is (should be?) now handled by Throwable.initClause().&lt;/p&gt;

&lt;p&gt;Throwing a non-java library exception causes some issues for JMX as the exception can not be transfered to the client.&lt;/p&gt;</comment>
                            <comment id="12572025" author="kristwaa" created="Mon, 25 Feb 2008 08:36:56 +0000"  >&lt;p&gt;BTW, I ran the regression tests with the patch applied. No failures in my runs for Sun JDK 1.4.2 and 1.6.0.&lt;/p&gt;</comment>
                            <comment id="12572132" author="djd" created="Mon, 25 Feb 2008 17:16:43 +0000"  >&lt;p&gt;Patch applied - Revision: 630903&lt;/p&gt;</comment>
                            <comment id="12572279" author="dibyendumajumdar" created="Mon, 25 Feb 2008 22:30:58 +0000"  >&lt;p&gt;Kristian and Dan,&lt;br/&gt;
Thanks - much impressed by the support you have given me.&lt;/p&gt;
</comment>
                            <comment id="12573268" author="knutanders" created="Thu, 28 Feb 2008 13:21:40 +0000"  >&lt;p&gt;&amp;gt; The main reason originally for EmbedSQLException originally was to be able to&lt;br/&gt;
&amp;gt; keep the original non-SQLException (e.g. StandardException, IOException), which is (should be?) now handled by Throwable.initClause().&lt;/p&gt;

&lt;p&gt;Another reason for EmbedSQLException is to be able to keep the message id so that we can localize the messages correctly on the network client. I haven&apos;t seen any proposals for how to solve that issue yet. (That&apos;s why we create the argument ferry (an EmbedSQLException) in the JDBC 4.0 exception factory.)&lt;/p&gt;

&lt;p&gt;&amp;gt; Throwing a non-java library exception causes some issues for JMX as the exception can not be transfered to the client.&lt;/p&gt;

&lt;p&gt;Solving this problem involves getting rid of StandardException too, doesn&apos;t it? At least when the SQLException is linked to a StandardException.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12389364">DERBY-3453</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12376324" name="DERBY-3451_patch_rev630512.txt" size="7835" author="dibyendumajumdar" created="Sun, 24 Feb 2008 02:06:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 22 Feb 2008 23:58:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30861</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0lo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37329</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>