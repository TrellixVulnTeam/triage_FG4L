<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:47 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-214/DERBY-214.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-214] Remove System.exit() calls from the DB2jServerImpl.java</title>
                <link>https://issues.apache.org/jira/browse/DERBY-214</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The System.exit() calls needs to be removed from the &lt;br/&gt;
DB2jServerImpl.java as this results in the entire application &lt;br/&gt;
(example - Eclipse which is running the Network Server inside &lt;br/&gt;
it) getting shut down.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="31589">DERBY-214</key>
            <summary>Remove System.exit() calls from the DB2jServerImpl.java</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davidvc">David Van Couvering</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Apr 2005 11:47:02 +0100</created>
                <updated>Thu, 26 Jan 2006 02:02:21 +0000</updated>
                            <resolved>Sat, 21 May 2005 08:14:24 +0100</resolved>
                                    <version>10.1.1.0</version>
                                    <fixVersion>10.1.1.0</fixVersion>
                                    <component>Network Server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="63912" author="davidvc" created="Thu, 28 Apr 2005 03:48:02 +0100"  >&lt;p&gt;Hi, Kathey.  I think I can work on this.  Is it OK for NetworkServerControl to call System.exit, or does that need to throw an exception as well?&lt;/p&gt;

&lt;p&gt;The technique I usually do for a utility that I want callable by another class as well as executable from the command line is for the main() routine to delegate to another public method which throws exceptions and doesn&apos;t call System.exit().  Then the main() routine catches any exceptions and calls System.exit(1) if there is an exception or System.exit(0) if there isn&apos;t one.  Then classes call the other public method and main() is only used from the command-line.&lt;/p&gt;

&lt;p&gt;Does that work here?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;David&lt;/p&gt;</comment>
                            <comment id="64106" author="clr" created="Sat, 30 Apr 2005 10:17:49 +0100"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I agree that main() should only be used from the command line, and is the only place in the code where System.exit() should be called. The main() method could simply delegate to another method that takes the String args[] parameter. For the purposes of this message, I&apos;ll just call it &quot;execute&quot;. &lt;/p&gt;

&lt;p&gt;All of the utility programs should use the same method name for the &quot;execute&quot; method so it&apos;s easy to remember how to invoke it. The &quot;execute&quot; then does the parsing of the args. There are lots of Apache commons arg parsers that could be used in the &quot;execute&quot;, but that&apos;s just a bit off topic.&lt;/p&gt;

&lt;p&gt;Execute should throw exceptions, not ever call System.exit. Since the execute method has the same parameters as main, it&apos;s easy to remember how to invoke it. &lt;/p&gt;

&lt;p&gt;The second issue is whether the execute method should be static or not. For consistency, I think that non-static would be the way to go. If we offer different methods of executing, then it would be nice to have all of them behave the same in terms of static vs. non-static. &lt;/p&gt;

&lt;p&gt;The third issue is where the processing of environment variables should be done. It might be best if the constructor of an instance of the utility class processed the environment variables. That way, regardless of whether main() or a program  called the constructor the behavior would be the same.&lt;/p&gt;

&lt;p&gt;The fourth issue is whether for ease of use, aother convenience methods could be used. One that takes a single String is desirable. This method, also called execute, could simply parse the input String into a String[] and call the other execute method. An alternative method would take a Map of parameter names and values with the obvious semantics.&lt;/p&gt;

&lt;p&gt;I see a few alternatives&lt;/p&gt;

&lt;p&gt;1. ij.execute(new String[] {&quot;&lt;/p&gt;
{&quot;-p&quot;, &quot;1567&quot;, &quot;-h&quot;, &quot;localhost&quot; }
&lt;p&gt;); &lt;br/&gt;
2. ij.setPort(1567); ij.setHost(&quot;localhost&quot;);ij.execute();&lt;br/&gt;
3. ij.execute(&quot;-p 1567 -h localhost&quot;);&lt;br/&gt;
4. Map map = new HashMap(); map.put(&quot;-p&quot;, &quot;1567&quot;); map.put(&quot;-h&quot;, &quot;localhost&quot;);  ij.execute(Map map);&lt;/p&gt;

&lt;p&gt;I can see value in all of these techniques depending on what you have on the caller side of the interface. &lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;

&lt;p&gt;Craig&lt;/p&gt;</comment>
                            <comment id="65363" author="davidvc" created="Sat, 14 May 2005 08:01:33 +0100"  >&lt;p&gt;There are a lot of interesting discussions about how to call classes with main().  However, NetworkServerControl already has a well-defined set of routines that are already a documented public interface.  I think that in the case of this particular situation we shouldn&apos;t change NetworkServerControl to have a new interface based on any of the proposed models.&lt;/p&gt;

&lt;p&gt;There has also been a discussion about moving argument processing out of DB2jServerImpl (now renamed NetworkServerImpl) and into NetworkServerControl.  But I think that is beyond the scope of this particular JIRA item.&lt;/p&gt;

&lt;p&gt;What I am going to do for this is simply move the System.exit() from NetworkServerImpl to NetworkServerControl, and then I will open two separate items: one to relocate argument processing to NetworkServerControl, and another to adjust the other tools that don&apos;t already have a documented public interface to follow a calling model we all agree on.&lt;/p&gt;

&lt;p&gt;David&lt;/p&gt;</comment>
                            <comment id="65567" author="davidvc" created="Tue, 17 May 2005 08:02:00 +0100"  >&lt;p&gt;Attached is the patch that should resolve this item.  I relocated the execute method&lt;br/&gt;
from NetworkServerImpl (previously called DB2jServerImpl) to NetworkServerControl.&lt;/p&gt;

&lt;p&gt;I modified derbynet/testconnection.java so that it checks and makes sure the exit&lt;br/&gt;
status matches what is expected (1 for error, 0 for no error).  &lt;/p&gt;

&lt;p&gt;Ran derbyall, all tests pass except for tools/dblook_test.java, which was also failing&lt;br/&gt;
in my &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-243&quot; title=&quot;connection toString should uniquely identify the connection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-243&quot;&gt;&lt;del&gt;DERBY-243&lt;/del&gt;&lt;/a&gt; tree.  This is an unrelated diff, I&apos;ll be logging a bug for this.&lt;/p&gt;

&lt;p&gt;Output of svn status:&lt;/p&gt;

&lt;p&gt;M      java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java&lt;br/&gt;
M      java/drda/org/apache/derby/drda/NetworkServerControl.java&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testcon&lt;br/&gt;
nection.java&lt;/p&gt;</comment>
                            <comment id="65734" author="kmarsden" created="Thu, 19 May 2005 14:08:42 +0100"  >
&lt;p&gt;I committed this patch.&lt;br/&gt;
Sending        java\drda\org\apache\derby\drda\NetworkServerControl.java&lt;br/&gt;
Sending        java\drda\org\apache\derby\impl\drda\NetworkServerControlImpl.java&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\derbynet\testconnection.java&lt;br/&gt;
Transmitting file data ...&lt;br/&gt;
Committed revision 170862.&lt;/p&gt;</comment>
                            <comment id="65891" author="davidvc" created="Sat, 21 May 2005 08:14:24 +0100"  >&lt;p&gt;This appears to be fixed,although there was a resulting test failure on Solaris 10 x86 that I am working on (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-303&quot; title=&quot;derbynet/testconnection.java fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-303&quot;&gt;&lt;del&gt;DERBY-303&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="20105" name="DERBY-214.diff" size="5829" author="davidvc" created="Tue, 17 May 2005 08:02:00 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 28 Apr 2005 02:48:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21839</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy179j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40827</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>