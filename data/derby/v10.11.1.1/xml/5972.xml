<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:37:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5972/DERBY-5972.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5972] Grammar doesn&apos;t accept OR operator without parentheses</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5972</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The grammar doesn&apos;t accept the OR operator without parentheses in some constructs.&lt;/p&gt;

&lt;p&gt;For example, in a select list:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; create table t(b1 boolean, b2 boolean);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; select b1 or b2 from t;&lt;br/&gt;
ERROR 42X01: Syntax error: Encountered &quot;or&quot; at line 1, column 11. (errorCode = 30000)&lt;br/&gt;
Issue the &apos;help&apos; command for general information on IJ command syntax.&lt;br/&gt;
Any unrecognized commands are treated as potential SQL commands and executed directly.&lt;br/&gt;
Consult your DBMS server reference documentation for details of the SQL syntax supported by your server.&lt;/p&gt;

&lt;p&gt;However, it does not fail if OR is replaced by AND, or if parentheses are used around the OR expression:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; select (b1 or b2) from t;&lt;br/&gt;
1    &lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;0 rows selected&lt;br/&gt;
ij&amp;gt; select b1 and b2 from t;&lt;br/&gt;
1    &lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;0 rows selected&lt;/p&gt;

&lt;p&gt;Similar behaviour is seen in VALUES statements:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; values true or false;&lt;br/&gt;
ERROR 42X01: Syntax error: Encountered &quot;or&quot; at line 1, column 13. (errorCode = 30000)&lt;br/&gt;
Issue the &apos;help&apos; command for general information on IJ command syntax.&lt;br/&gt;
Any unrecognized commands are treated as potential SQL commands and executed directly.&lt;br/&gt;
Consult your DBMS server reference documentation for details of the SQL syntax supported by your server.&lt;br/&gt;
ij&amp;gt; values (true or false);&lt;br/&gt;
1    &lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;true &lt;/p&gt;

&lt;p&gt;1 row selected&lt;br/&gt;
ij&amp;gt; values true and false;&lt;br/&gt;
1    &lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;false&lt;/p&gt;

&lt;p&gt;1 row selected&lt;/p&gt;</description>
                <environment></environment>
        <key id="12614163">DERBY-5972</key>
            <summary>Grammar doesn&apos;t accept OR operator without parentheses</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 31 Oct 2012 12:25:49 +0000</created>
                <updated>Sat, 30 Nov 2013 16:27:29 +0000</updated>
                            <resolved>Sun, 11 Nov 2012 22:55:23 +0000</resolved>
                                    <version>10.10.1.1</version>
                                    <fixVersion>10.8.3.3</fixVersion>
                    <fixVersion>10.9.2.2</fixVersion>
                    <fixVersion>10.10.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13487713" author="knutanders" created="Wed, 31 Oct 2012 12:37:13 +0000"  >&lt;p&gt;I think &quot;select b1 or b2 from t&quot; is valid syntax.&lt;/p&gt;

&lt;p&gt;Starting with this rule in the SQL:2003 standard, part 2, section 7.12 &amp;lt;query specification&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;select list&amp;gt; ::=&lt;br/&gt;
&amp;lt;asterisk&amp;gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &amp;lt;select sublist&amp;gt; [ 
{ &amp;lt;comma&amp;gt; &amp;lt;select sublist&amp;gt; }
&lt;p&gt;... ]&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;and following the rules via &amp;lt;select sublist&amp;gt;, &amp;lt;derived column&amp;gt; and &amp;lt;value expression&amp;gt; brings you to&lt;/p&gt;

&lt;p&gt;6.34 &amp;lt;boolean value expression&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;boolean value expression&amp;gt; ::=&lt;br/&gt;
&amp;lt;boolean term&amp;gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &amp;lt;boolean value expression&amp;gt; OR &amp;lt;boolean term&amp;gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;So it looks to me as if parentheses are not required by the standard for OR expressions in the select list.&lt;/p&gt;</comment>
                            <comment id="13490690" author="knutanders" created="Mon, 5 Nov 2012 15:40:36 +0000"  >&lt;p&gt;It looks to me as if sqlgrammar.jj uses orExpression() in some production rules where it should have used valueExpression(), for example in the derivedColumn() rule used by selectSublist(). Since orExpression() is not actually an expression involving OR, as one might expect from its name. It&apos;s the expression that represents one of the operands in an OR expression.&lt;/p&gt;</comment>
                            <comment id="13490753" author="knutanders" created="Mon, 5 Nov 2012 17:23:15 +0000"  >&lt;p&gt;The attached patch changes occurrences of orExpression(null) with valueExpression() in sqlgrammar.jj. Since the orExpression() rule only matches conjunctions of boolean primaries and valueExpression() matches disjunctions of orExpression(), this change makes it possible to both OR and AND expressions where only AND expressions could be used previously.&lt;/p&gt;

&lt;p&gt;The patch changes the following production rules:&lt;/p&gt;

&lt;p&gt;derivedColumn(): This rule is used in select lists. The change allows statements like &quot;SELECT b1 OR b2 FROM t&quot;.&lt;/p&gt;

&lt;p&gt;methodParameter(): Used for parameters in function/procedure calls. Makes statements like &quot;VALUES booleanFunction(TRUE OR FALSE)&quot; work.&lt;/p&gt;

&lt;p&gt;updateSource(): Used in UPDATE statements and allows statements like: &quot;UPDATE t SET b = TRUE OR FALSE&quot;&lt;/p&gt;

&lt;p&gt;rowValueConstructorElement(): Used in VALUES statements and allows statements like: VALUES TRUE OR FALSE&lt;/p&gt;

&lt;p&gt;whenThenExpression(): This production rule actually worked before, because it had inlined valueExpression(). The patch changes it to call valueExpression() instead of duplicating the code. Added a test case for CASE WHEN ... THEN ... ELSE to verify that it still works.&lt;/p&gt;

&lt;p&gt;With these changes, only the valueExpression() rule uses the orExpression() rule directly. The patch also adds test cases for all the expressions mentioned above.&lt;/p&gt;

&lt;p&gt;I have only run BooleanValuesTest so far. Will run the full regression test suite.&lt;/p&gt;</comment>
                            <comment id="13490807" author="knutanders" created="Mon, 5 Nov 2012 18:37:39 +0000"  >&lt;p&gt;All the regression tests passed with the patch.&lt;/p&gt;</comment>
                            <comment id="13495029" author="knutanders" created="Sun, 11 Nov 2012 22:55:23 +0000"  >&lt;p&gt;Committed revision 1408136.&lt;/p&gt;

&lt;p&gt;I&apos;m not planning to back-port the fix. It changes grammar rules used by most queries, so I&apos;d prefer to keep it on trunk only for a while until we&apos;re confident that it doesn&apos;t inadvertently break anything. Resolving the issue for now.&lt;/p&gt;</comment>
                            <comment id="13725711" author="kmarsden" created="Wed, 31 Jul 2013 21:56:05 +0100"  >&lt;p&gt;Assign to myself temporarily for backport&lt;/p&gt;</comment>
                            <comment id="13726389" author="jira-bot" created="Thu, 1 Aug 2013 13:35:01 +0100"  >&lt;p&gt;Commit 1509207 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kmarsden&quot; class=&quot;user-hover&quot; rel=&quot;kmarsden&quot;&gt;Kathey Marsden&lt;/a&gt; in branch &apos;code/branches/10.9&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1509207&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1509207&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5972&quot; title=&quot;Grammar doesn&amp;#39;t accept OR operator without parentheses&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5972&quot;&gt;&lt;del&gt;DERBY-5972&lt;/del&gt;&lt;/a&gt;) Grammar doesn&apos;t accept OR operator without parentheses&lt;/p&gt;

&lt;p&gt;backport 1408136 from trunk to 10.9&lt;br/&gt;
Contributed by Knut Anders Hatlen&lt;/p&gt;</comment>
                            <comment id="13726715" author="jira-bot" created="Thu, 1 Aug 2013 19:32:42 +0100"  >&lt;p&gt;Commit 1509375 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kmarsden&quot; class=&quot;user-hover&quot; rel=&quot;kmarsden&quot;&gt;Kathey Marsden&lt;/a&gt; in branch &apos;code/branches/10.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1509375&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1509375&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5972&quot; title=&quot;Grammar doesn&amp;#39;t accept OR operator without parentheses&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5972&quot;&gt;&lt;del&gt;DERBY-5972&lt;/del&gt;&lt;/a&gt; -  Grammar doesn&apos;t accept OR operator without parentheses&lt;/p&gt;

&lt;p&gt;backport 1408136 from trunk to 10.8&lt;br/&gt;
Contributed by Knut Anders Hatlen&lt;/p&gt;</comment>
                            <comment id="13726717" author="kmarsden" created="Thu, 1 Aug 2013 19:34:23 +0100"  >&lt;p&gt;backport to 10.8 complete reassigning to Knut Anders&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12656863">DERBY-6289</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12681591">DERBY-6423</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12552128" name="d5972-1a.diff" size="5979" author="knutanders" created="Mon, 5 Nov 2012 17:23:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 31 Jul 2013 20:56:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>253294</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy79c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76323</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>