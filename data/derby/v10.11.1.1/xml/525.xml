<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:18:41 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-525/DERBY-525.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-525] getAsciiStreamshould replace non-ASCII characters with 0x3f, &apos;?&apos;  to match embedded</title>
                <link>https://issues.apache.org/jira/browse/DERBY-525</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When calling Clob.getAsciiStream or ResultSet.getAsciiStream if &lt;br/&gt;
the column type is a character type or a CLOB, then any out of &lt;br/&gt;
range character (to the ASCII set) needs to be replaced by 0x3f &lt;br/&gt;
(&apos;?&apos;, question mark). ASCII is defined as 8 bit characters, &lt;br/&gt;
thus Unicode Characters in the range 0x0000 to 0x00ff are &lt;br/&gt;
mapped to ASCII characters 0x00 to 0xff, and Unicode characters &lt;br/&gt;
in the range 0x0100 to 0xffff are mapped to 0x3f&lt;/p&gt;

&lt;p&gt;By code inspection:&lt;/p&gt;

&lt;p&gt;client code in &lt;br/&gt;
org.apache.derby.client.am.ResultSet&lt;/p&gt;

&lt;p&gt;embedded in &lt;br/&gt;
org.apache.derby.impl.jdbc.ReaderToAscii&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12313588">DERBY-525</key>
            <summary>getAsciiStreamshould replace non-ASCII characters with 0x3f, &apos;?&apos;  to match embedded</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="naka">Tomohito Nakayama</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Sat, 20 Aug 2005 08:48:55 +0100</created>
                <updated>Wed, 24 May 2006 05:58:14 +0100</updated>
                            <resolved>Sat, 29 Oct 2005 14:58:47 +0100</resolved>
                                    <version>10.1.1.0</version>
                    <version>10.1.2.1</version>
                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12330100" author="naka" created="Thu, 22 Sep 2005 01:08:52 +0100"  >&lt;p&gt;I think that character other than ASCII need to be handled in Clob ....&lt;/p&gt;
</comment>
                            <comment id="12330102" author="naka" created="Thu, 22 Sep 2005 01:43:31 +0100"  >&lt;p&gt;Sorry.&lt;br/&gt;
I misread  this issue.&lt;/p&gt;

&lt;p&gt;This was issue about getAsciiStream .&lt;/p&gt;

&lt;p&gt;Character other than ASCII should be handled in ResultSet#getCharacterStream .&lt;br/&gt;
&lt;a href=&quot;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/ResultSet.html#getCharacterStream(int&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/ResultSet.html#getCharacterStream(int&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/ResultSet.html#getCharacterStream(java.lang.String&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/j2se/1.4.2/docs/api/java/sql/ResultSet.html#getCharacterStream(java.lang.String&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12330183" author="naka" created="Thu, 22 Sep 2005 19:40:30 +0100"  >&lt;p&gt;I&apos;m interested in this issue &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Surveying about ASCII, I found that ASCII is 7bit information and not 8bit information , in some context .&lt;br/&gt;
  &lt;a href=&quot;http://www.ietf.org/rfc/rfc20.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.ietf.org/rfc/rfc20.txt&lt;/a&gt;&lt;br/&gt;
  &lt;a href=&quot;http://en.wikipedia.org/wiki/ASCII&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://en.wikipedia.org/wiki/ASCII&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Should we think range 0x80 to 0xff as ASCII in this issue ?&lt;/p&gt;</comment>
                            <comment id="12330185" author="bernt" created="Thu, 22 Sep 2005 20:37:03 +0100"  >&lt;p&gt;In my opinion ASCII (and ISO-646) is a 7-bit standard which is compatible with Unicode values 0x0000-0x007f. Unicode values 0x0000-0x00ff are compatible with ISO-8859-1 which to my knowledge is not compatible with any of the (non-standard) &quot;extended&quot; ASCII charactersets which have been in use. &lt;/p&gt;</comment>
                            <comment id="12330193" author="djd" created="Thu, 22 Sep 2005 23:08:44 +0100"  >&lt;p&gt;See this link for the justifications on why getAsciiStream() uses 8 bits and not 7.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://db.apache.org/derby/papers/JDBCImplementation.html#GetAsciiStream%28%29&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.apache.org/derby/papers/JDBCImplementation.html#GetAsciiStream%28%29&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Basically, it&apos;s based upon definitions from the JDBC spec.&lt;/p&gt;</comment>
                            <comment id="12330429" author="naka" created="Mon, 26 Sep 2005 01:06:16 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-525&quot; title=&quot;getAsciiStreamshould replace non-ASCII characters with 0x3f, &amp;#39;?&amp;#39;  to match embedded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-525&quot;&gt;&lt;del&gt;DERBY-525&lt;/del&gt;&lt;/a&gt;.patch :&lt;br/&gt;
Description of patches :&lt;br/&gt;
1: modify processing of converting String to byte[] in org.apache.derby.client.am.ResultSet#getAsciiStream(int) &lt;/p&gt;

&lt;p&gt;Test :&lt;br/&gt;
Executed derby all and found an error in runtimeinfo . &lt;br/&gt;
I read that this error happens because processing of each thread in runtimeinfo finshed not in the same sequence of  starting the thread .&lt;br/&gt;
I attach derbyall_report.txt to this issue also.&lt;/p&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-525&quot; title=&quot;getAsciiStreamshould replace non-ASCII characters with 0x3f, &amp;#39;?&amp;#39;  to match embedded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-525&quot;&gt;&lt;del&gt;DERBY-525&lt;/del&gt;&lt;/a&gt;.site.patch :&lt;br/&gt;
Description of patch :&lt;br/&gt;
Modify paper on the derby site , according to &lt;a href=&quot;http://article.gmane.org/gmane.comp.apache.db.derby.devel/8378&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://article.gmane.org/gmane.comp.apache.db.derby.devel/8378&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Test :&lt;br/&gt;
I executed &quot;forrest run&quot; and browse the page at &lt;a href=&quot;http://localhost:8888/papers/JDBCImplementation.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://localhost:8888/papers/JDBCImplementation.html&lt;/a&gt; .&lt;/p&gt;</comment>
                            <comment id="12330794" author="naka" created="Thu, 29 Sep 2005 21:12:50 +0100"  >&lt;p&gt;I have committed patches.&lt;/p&gt;

&lt;p&gt;Sending        java/client/org/apache/derby/client/am/ResultSet.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 292414.&lt;/p&gt;

&lt;p&gt;Sending        src/documentation/content/xdocs/papers/JDBCImplementation.html&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 292415.&lt;/p&gt;</comment>
                            <comment id="12330828" author="skambha" created="Fri, 30 Sep 2005 03:13:01 +0100"  >&lt;p&gt;It would be great if you could add a testcase for this.&lt;/p&gt;

&lt;p&gt;I looked at the patch briefly, and had one minor comment.  In convertToAsciiByteArray, it might be better performance wise, if we calculate the original.length only once and use it in the for loop.&lt;/p&gt;</comment>
                            <comment id="12331017" author="naka" created="Sat, 1 Oct 2005 17:00:08 +0100"  >&lt;p&gt;I surveyed where to add test and found next test program .&lt;br/&gt;
I think this  program is good place to add test for this issue .&lt;/p&gt;

&lt;p&gt;./functionTests/tests/jdbcapi/resultsetStream.java&lt;/p&gt;</comment>
                            <comment id="12331374" author="naka" created="Wed, 5 Oct 2005 21:33:22 +0100"  >&lt;p&gt;Modification:&lt;br/&gt;
 Tuning on convertToAsciiByteArray(final) was done according to next mails.&lt;br/&gt;
 &lt;a href=&quot;http://permalink.gmane.org/gmane.comp.apache.db.derby.devel/8548&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://permalink.gmane.org/gmane.comp.apache.db.derby.devel/8548&lt;/a&gt;&lt;br/&gt;
 &lt;a href=&quot;http://permalink.gmane.org/gmane.comp.apache.db.derby.devel/8528&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://permalink.gmane.org/gmane.comp.apache.db.derby.devel/8528&lt;/a&gt;&lt;/p&gt;

&lt;p&gt; //However new test is not added yet.&lt;br/&gt;
 //&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-596&quot; title=&quot; jdbcapi/resultsetStream.java fails in DerbyNetClient Framework&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-596&quot;&gt;&lt;del&gt;DERBY-596&lt;/del&gt;&lt;/a&gt; is dedicated for new test .&lt;/p&gt;


&lt;p&gt;Tested:&lt;br/&gt;
 Execute derbyall and new error was not found .&lt;/p&gt;
</comment>
                            <comment id="12331648" author="naka" created="Sun, 9 Oct 2005 00:46:16 +0100"  >&lt;p&gt;I realized &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-525&quot; title=&quot;getAsciiStreamshould replace non-ASCII characters with 0x3f, &amp;#39;?&amp;#39;  to match embedded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-525&quot;&gt;&lt;del&gt;DERBY-525&lt;/del&gt;&lt;/a&gt;_2.patch ,which was not commited yet , &lt;br/&gt;
has a bug that calling String#getByte() use in this patch is mistake.&lt;/p&gt;

&lt;p&gt;I removed the patch from this issue.&lt;/p&gt;</comment>
                            <comment id="12332754" author="naka" created="Sat, 22 Oct 2005 17:35:42 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-525&quot; title=&quot;getAsciiStreamshould replace non-ASCII characters with 0x3f, &amp;#39;?&amp;#39;  to match embedded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-525&quot;&gt;&lt;del&gt;DERBY-525&lt;/del&gt;&lt;/a&gt; needs to modify &apos;java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetStream.java&apos;&lt;/p&gt;</comment>
                            <comment id="12355604" author="naka" created="Mon, 24 Oct 2005 20:20:15 +0100"  >&lt;p&gt;I have executed &apos;jdbcapi/resultsetStream.java&apos; ,which was modified for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-525&quot; title=&quot;getAsciiStreamshould replace non-ASCII characters with 0x3f, &amp;#39;?&amp;#39;  to match embedded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-525&quot;&gt;&lt;del&gt;DERBY-525&lt;/del&gt;&lt;/a&gt; , &lt;br/&gt;
and found the problem was deeper than I thought , and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-525&quot; title=&quot;getAsciiStreamshould replace non-ASCII characters with 0x3f, &amp;#39;?&amp;#39;  to match embedded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-525&quot;&gt;&lt;del&gt;DERBY-525&lt;/del&gt;&lt;/a&gt;.patch did not solve the problem yet .&lt;/p&gt;

&lt;p&gt;Because high byte of none ASCII character was cleared as 0x00 for some reason , &lt;br/&gt;
it was impossible to replace none ASCII character as &apos;?&apos; just comparing with 0x00ff .&lt;/p&gt;

&lt;p&gt;I survey why high byte of character was cleared .&lt;/p&gt;</comment>
                            <comment id="12356068" author="naka" created="Thu, 27 Oct 2005 20:56:52 +0100"  >&lt;p&gt;Description of patch :&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;modified java/client/org/apache/derby/client/am/AsciiStream.java ,which was used in Clob when getAsciiStream was called , to convert character that is not ASCII to &apos;?&apos; .&lt;/li&gt;
	&lt;li&gt;removed modification of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-525&quot; title=&quot;getAsciiStreamshould replace non-ASCII characters with 0x3f, &amp;#39;?&amp;#39;  to match embedded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-525&quot;&gt;&lt;del&gt;DERBY-525&lt;/del&gt;&lt;/a&gt;.patch, and use AsciiStream here too, instead .&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Test:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;run derbyall and found no new error .&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12356255" author="naka" created="Sat, 29 Oct 2005 14:58:47 +0100"  >&lt;p&gt;I have committed .&lt;/p&gt;

&lt;p&gt;Sending        java/client/org/apache/derby/client/am/AsciiStream.java&lt;br/&gt;
Sending        java/client/org/apache/derby/client/am/ResultSet.java&lt;br/&gt;
Sending        java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/resultsetStream.out&lt;br/&gt;
Sending        java/testing/org/apache/derbyTesting/functionTests/master/resultsetStream.out&lt;br/&gt;
Sending        java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/resultsetStream.java&lt;br/&gt;
Transmitting file data .....&lt;br/&gt;
Committed revision 329372.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12318252">DERBY-640</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="32841">DERBY-310</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12314551" name="DERBY-525.patch" size="1542" author="naka" created="Mon, 26 Sep 2005 01:06:16 +0100"/>
                            <attachment id="12314552" name="DERBY-525.site.patch" size="711" author="naka" created="Mon, 26 Sep 2005 01:06:16 +0100"/>
                            <attachment id="12320353" name="DERBY-525_3.patch" size="8418" author="naka" created="Thu, 27 Oct 2005 20:56:52 +0100"/>
                            <attachment id="12314553" name="derbyall_report.txt" size="9805" author="naka" created="Mon, 26 Sep 2005 01:06:16 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 22 Sep 2005 00:08:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21998</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy16av:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40671</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>