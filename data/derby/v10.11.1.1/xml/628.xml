<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:43:56 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-628/DERBY-628.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-628] setNull() using Types.VARCHAR for a CLOB parameter fails in embedded mode.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-628</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If I attempt to call PreparedStatement.setNull() and specify Types.VARCHAR when the actual parameter type (as determined at bind time) is CLOB, Derby in embedded mode will throw an error, while Derby in client/server mode will succeed.&lt;/p&gt;

&lt;p&gt;Ex. running the following code:&lt;/p&gt;

&lt;p&gt;    st.execute(&quot;create table t1 (c clob)&quot;);&lt;br/&gt;
    PreparedStatement pSt = conn.prepareStatement(&lt;br/&gt;
        &quot;insert into t1 values &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&quot;);&lt;br/&gt;
    try &lt;/p&gt;
{
        pSt.setNull(1, Types.VARCHAR);
        pSt.execute();
        System.out.println(&quot;Error did NOT reproduce.&quot;);
    }
&lt;p&gt; catch (SQLException se) &lt;/p&gt;
{
        System.out.println(&quot;Error reproduced:&quot;);
        se.printStackTrace();
    }

&lt;p&gt;Against Derby embedded, the result will be:&lt;/p&gt;

&lt;p&gt;  Error reproduced:&lt;br/&gt;
  SQL Exception: An attempt was made to get a data value of type &apos;CLOB&apos; from a data value of type &apos;VARCHAR&apos;.&lt;/p&gt;

&lt;p&gt;But against the Network Server, everything works fine.  Derby embedded will work in other cases where compatible types are used (ex. using setNull() with Types.INTEGER for a BIGINT parameter), but fails for this particular situation. Thus I&apos;m assuming this is &lt;em&gt;not&lt;/em&gt; intentional (i.e. that the above code should work). &lt;/p&gt;

&lt;p&gt;Looks like the problem is in iapi.types.DataTypeDescriptor:&lt;/p&gt;

&lt;p&gt;    private static boolean isCharacterType(int jdbcType) {&lt;/p&gt;

&lt;p&gt;        switch (jdbcType) &lt;/p&gt;
{
        case Types.CHAR:
        case Types.VARCHAR:
        case Types.LONGVARCHAR:
            return true;
        default:
            return false;
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;I think CLOB should be included in this list, too, shouldn&apos;t it?  In iapi.types.TypeId, &quot;isStringTypeId&quot; is true for CLOBs as well as for the other character types, so it seems like the above method should have similar logic.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12317977">DERBY-628</key>
            <summary>setNull() using Types.VARCHAR for a CLOB parameter fails in embedded mode.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bandaram">Satheesh Bandaram</assignee>
                                    <reporter username="army">A B</reporter>
                        <labels>
                    </labels>
                <created>Sat, 15 Oct 2005 09:52:11 +0100</created>
                <updated>Mon, 20 Nov 2006 02:52:11 +0000</updated>
                            <resolved>Tue, 25 Apr 2006 09:13:03 +0100</resolved>
                                                    <fixVersion>10.1.3.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12332121" author="army" created="Sat, 15 Oct 2005 09:53:36 +0100"  >&lt;p&gt;Attaching a simple program to reproduce the problem.  To run against Derby embedded, use&lt;/p&gt;

&lt;p&gt;  java setNull&lt;/p&gt;

&lt;p&gt;To run against Derby Client, use&lt;/p&gt;

&lt;p&gt;  java setNull client&lt;/p&gt;

&lt;p&gt;To run against JCC, use&lt;/p&gt;

&lt;p&gt;  java setNull jcc&lt;/p&gt;</comment>
                            <comment id="12365164" author="bandaram" created="Sat, 4 Feb 2006 11:45:26 +0000"  >&lt;p&gt;I have a patch for this issue. I wondered if Derby should also allow setNull on blob column from binary types.&lt;/p&gt;

&lt;p&gt;But Derby behaves differently for blob and clobs in SQL:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; create table clobBlob(c clob, b blob, v varchar(10), vb varchar(10) for bit data);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; insert into clobBlob(c) select v from clobBlob;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; insert into clobBlob(b) select vb from clobBlob;&lt;br/&gt;
ERROR 42821: Columns of type &apos;BLOB&apos; cannot hold values of type &apos;VARCHAR () FOR BIT DATA&apos;.&lt;br/&gt;
ij&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12365481" author="bandaram" created="Wed, 8 Feb 2006 05:47:40 +0000"  >&lt;p&gt;Updated patch. Would like to commit today.&lt;/p&gt;</comment>
                            <comment id="12365667" author="bandaram" created="Thu, 9 Feb 2006 10:01:05 +0000"  >&lt;p&gt;Fixed with 375877.&lt;/p&gt;</comment>
                            <comment id="12365668" author="bandaram" created="Thu, 9 Feb 2006 10:02:14 +0000"  >&lt;p&gt;Fix checked in. Verified with the new build.&lt;/p&gt;</comment>
                            <comment id="12376142" author="bandaram" created="Tue, 25 Apr 2006 09:08:35 +0100"  >&lt;p&gt;Reopening to mark fix in.&lt;/p&gt;</comment>
                            <comment id="12376143" author="bandaram" created="Tue, 25 Apr 2006 09:13:35 +0100"  >&lt;p&gt;Closing after porting fix to 10.1. SVN number: 396753.&lt;/p&gt;</comment>
                            <comment id="12451210" author="myrna" created="Mon, 20 Nov 2006 02:52:11 +0000"  >&lt;p&gt;Also updated the 10.1 j9_13/parameterMapping.out with &lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=477009&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=477009&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12322714" name="patch" size="4645" author="bandaram" created="Wed, 8 Feb 2006 05:47:40 +0000"/>
                            <attachment id="12314894" name="setNull.java" size="1416" author="army" created="Sat, 15 Oct 2005 09:53:36 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 4 Feb 2006 11:45:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22058</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy13x3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40285</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>