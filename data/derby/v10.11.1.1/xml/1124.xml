<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:18:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1124/DERBY-1124.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1124] DatabaseMetaData.getTablePrivileges fails in soft upgrade mode</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1124</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The stack trace for failure is:&lt;/p&gt;

&lt;p&gt;SQLSTATE(42X05):ERROR 42X05: Table &apos;SYS.SYSTABLEPERMS&apos; does not exist.&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:311)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(FromBaseTable.java:2382)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(FromBaseTable.java:2120)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.FromList.bindTables(FromList.java:303)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(SelectNode.java:472)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(DMLStatementNode.java:220)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(DMLStatementNode.java:158)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.CursorNode.bind(CursorNode.java:252)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:344)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:118)&lt;br/&gt;
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:725)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.&amp;lt;init&amp;gt;(EmbedPreparedStatement.java:118)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement20.&amp;lt;init&amp;gt;(EmbedPreparedStatement20.java:82)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement30.&amp;lt;init&amp;gt;(EmbedPreparedStatement30.java:62)&lt;br/&gt;
	at org.apache.derby.jdbc.Driver30.newEmbedPreparedStatement(Driver30.java:92)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareMetaDataStatement(EmbedConnection.java:1645)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedDatabaseMetaData.getPreparedQuery(EmbedDatabaseMetaData.java:3172)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedDatabaseMetaData.getTablePrivileges(EmbedDatabaseMetaData.java:1841)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.metadata.getMetaDataRS(metadata.java:116)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.metadata_test.runTest(metadata_test.java:764)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:324)&lt;br/&gt;
	at org.apache.derbyTesting.upgradeTests.UpgradeTester.runMetadataTest(UpgradeTester.java:388)&lt;br/&gt;
	at org.apache.derbyTesting.upgradeTests.UpgradeTester.runPhase(UpgradeTester.java:218)&lt;br/&gt;
	at org.apache.derbyTesting.upgradeTests.UpgradeTester.runUpgradeTests(UpgradeTester.java:192)&lt;br/&gt;
	at org.apache.derbyTesting.upgradeTests.UpgradeTester.main(UpgradeTester.java:521)&lt;/p&gt;

&lt;p&gt;I got this exception when I ran the metadata test after soft upgrade from 10.1 to 10.2 codeline. I ran the metadata test by commenting out the call to getColumnPrivileges which has a similar problem reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1120&quot; title=&quot;DatabaseMetaData.getColumnPrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1120&quot;&gt;&lt;del&gt;DERBY-1120&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;</description>
                <environment>Soft upgrade from 10.1 to 10.2</environment>
        <key id="12330393">DERBY-1124</key>
            <summary>DatabaseMetaData.getTablePrivileges fails in soft upgrade mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bandaram">Satheesh Bandaram</assignee>
                                    <reporter username="deepa">Deepa Remesh</reporter>
                        <labels>
                    </labels>
                <created>Sat, 18 Mar 2006 01:45:39 +0000</created>
                <updated>Sat, 25 Mar 2006 06:47:13 +0000</updated>
                            <resolved>Sat, 25 Mar 2006 06:46:24 +0000</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12370857" author="deepa" created="Sat, 18 Mar 2006 01:51:08 +0000"  >&lt;p&gt;I have opened &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1124&quot; title=&quot;DatabaseMetaData.getTablePrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1124&quot;&gt;&lt;del&gt;DERBY-1124&lt;/del&gt;&lt;/a&gt; for the soft upgrade problem I found in getTablePrivileges query. &lt;/p&gt;

&lt;p&gt;To check whether there are any other problems after soft upgrade, I ran metadata test by commenting out the problem queries (getColumnPrivileges and getTablePrivileges). I did not see any other issues.&lt;/p&gt;</comment>
                            <comment id="12370859" author="bandaram" created="Sat, 18 Mar 2006 02:06:20 +0000"  >&lt;p&gt;Both &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1120&quot; title=&quot;DatabaseMetaData.getColumnPrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1120&quot;&gt;&lt;del&gt;DERBY-1120&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1124&quot; title=&quot;DatabaseMetaData.getTablePrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1124&quot;&gt;&lt;del&gt;DERBY-1124&lt;/del&gt;&lt;/a&gt; are reporting essentially same problem... How to make metadata queries that reference new catalogs or new columns in catalog work in soft-upgrade mode. Not sure if this problem was seen in previous releases (as no major catalog changes were made, as far as I know), but Derby needs to solve this problem now as Grant &amp;amp; Revoke has added 4 new system catalogs.&lt;/p&gt;</comment>
                            <comment id="12371795" author="bandaram" created="Sat, 25 Mar 2006 04:17:20 +0000"  >&lt;p&gt;Tested the fix by attempting soft upgrade from 10.1 database to 10.2 and attempting to get columnPrivileges and tablePrivileges. This fix should address both &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1120&quot; title=&quot;DatabaseMetaData.getColumnPrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1120&quot;&gt;&lt;del&gt;DERBY-1120&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1124&quot; title=&quot;DatabaseMetaData.getTablePrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1124&quot;&gt;&lt;del&gt;DERBY-1124&lt;/del&gt;&lt;/a&gt;. I will close &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1120&quot; title=&quot;DatabaseMetaData.getColumnPrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1120&quot;&gt;&lt;del&gt;DERBY-1120&lt;/del&gt;&lt;/a&gt; as duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1124&quot; title=&quot;DatabaseMetaData.getTablePrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1124&quot;&gt;&lt;del&gt;DERBY-1124&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Let me know if anyone have any comments. I will submit it later today.&lt;/p&gt;</comment>
                            <comment id="12371804" author="djd" created="Sat, 25 Mar 2006 05:35:00 +0000"  >&lt;p&gt;Might be better to have a single version check:&lt;/p&gt;

&lt;p&gt;+		if (!dd.checkVersion(DataDictionary.DD_VERSION_DERBY_10_2, null))&lt;/p&gt;
                  {
                       // If we are before 10.2 then use specific queries blah blah
                  }

</comment>
                            <comment id="12371811" author="bandaram" created="Sat, 25 Mar 2006 06:02:31 +0000"  >&lt;p&gt;I can change it... but my only concern was what will happen when we move to 10.3? Someone has to go change the condition? The way it is would work even after DD version is bumped to 10.3... which should be pretty soon, after we branch 10.2?&lt;/p&gt;</comment>
                            <comment id="12371813" author="djd" created="Sat, 25 Mar 2006 06:08:26 +0000"  >&lt;p&gt;Why would the condition change?&lt;/p&gt;</comment>
                            <comment id="12371814" author="bandaram" created="Sat, 25 Mar 2006 06:14:46 +0000"  >&lt;p&gt;You are right... It doesn&apos;t... checkVersion is looking for minimum version of 10_2... not actual match. I will rewrite the check.&lt;/p&gt;</comment>
                            <comment id="12371816" author="bandaram" created="Sat, 25 Mar 2006 06:46:22 +0000"  >&lt;p&gt;Fix merged into trunk.&lt;/p&gt;</comment>
                            <comment id="12371817" author="bandaram" created="Sat, 25 Mar 2006 06:47:13 +0000"  >&lt;p&gt;Verified the fix by trying getTablePrivileges and getColumnPrivileges API calls in soft upgrade mode.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12329756">DERBY-1076</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12324568" name="Derby1120_1124" size="5591" author="bandaram" created="Sat, 25 Mar 2006 04:17:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 18 Mar 2006 02:06:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22322</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy16yf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40777</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>