<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:29:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3705/DERBY-3705.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3705] In Net Client mode, negative values for stream length are accepted without an exception for PreparedStatement.setAsciiStream()</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3705</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;This is related to Cloudscape bug 4250.&lt;/p&gt;

&lt;p&gt;Pass negative length as the stream length for various setXXXStream methods should throw an exception. But in Net Client mode, passing a negative value as stream length to PreparedStatement.setAsciiStream() doesn&apos;t throw an exception.&lt;/p&gt;

&lt;p&gt;e.g. //from store/StreamingColumn&lt;br/&gt;
PreparedStatement ps = prepareStatement(&quot;insert into &quot;&lt;br/&gt;
				+ &quot;testLongVarCharInvalidStreamLength11 values(?, ?, ?)&quot;);&lt;br/&gt;
		ps.setInt(1, 100);&lt;br/&gt;
		try &lt;/p&gt;
{
			println(&quot;===&amp;gt; testing using setAsciiStream with -2 as length&quot;);
			ps.setAsciiStream(2, fileIn, -2); // should throw exception here but doesn&apos;t.
                 }


&lt;p&gt;This issue has been fixed for embedded mode, but not for client mode.&lt;/p&gt;</description>
                <environment>Windows XP SP2, Derby trunk SVN checkout</environment>
        <key id="12397404">DERBY-3705</key>
            <summary>In Net Client mode, negative values for stream length are accepted without an exception for PreparedStatement.setAsciiStream()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="suranjay">Suran Jayathilaka</assignee>
                                    <reporter username="suranjay">Suran Jayathilaka</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 Jun 2008 19:58:24 +0100</created>
                <updated>Thu, 2 May 2013 03:29:15 +0100</updated>
                            <resolved>Thu, 12 Jun 2008 18:06:19 +0100</resolved>
                                    <version>10.4.1.3</version>
                    <version>10.5.1.1</version>
                                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12602036" author="suranjay" created="Tue, 3 Jun 2008 20:21:49 +0100"  >&lt;p&gt;The same bug applies to client&apos;s PreparedStatement.setBinaryStream() and PreparedStatement.setCharacterStream() methods.&lt;/p&gt;</comment>
                            <comment id="12602039" author="suranjay" created="Tue, 3 Jun 2008 20:27:10 +0100"  >&lt;p&gt;Adds a less than zero check to setXXXStream methods in PreparedStatement, which throws an exception with NEGATIVE_STREAM_LENGTH state code if true.&lt;/p&gt;</comment>
                            <comment id="12602046" author="kristwaa" created="Tue, 3 Jun 2008 20:52:59 +0100"  >&lt;p&gt;Good catch Suran &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Nice work on converting the big test.&lt;/p&gt;

&lt;p&gt;I&apos;&apos;m changing the priority from critical to minor (press the yellow question mark next to the priority field to see descriptions of the various levels). There is a simple workaround available; don&apos;t specify negative stream lengths.&lt;br/&gt;
It would be interesting to know what happens if you do specify a negative length though, and if that causes data corruption the priority would have to be raised again.&lt;/p&gt;

&lt;p&gt;I&apos;ll happily review your patch tomorrow.&lt;/p&gt;</comment>
                            <comment id="12602564" author="kristwaa" created="Thu, 5 Jun 2008 08:18:54 +0100"  >&lt;p&gt;The patch looks good to me, and is basically ready for commit.&lt;br/&gt;
We do try to keep lines under 80 characters long, so you might want to reformat the lines that are longer than that.&lt;/p&gt;

&lt;p&gt;I also assume the regression test for this issue will be found in the test you are working on converting?&lt;/p&gt;

&lt;p&gt;As an extra step later on, one could also refactor the client code and create a method that checks the maximum and minimum length. Currently the code is duplicated in a number of methods.&lt;br/&gt;
I also notice that there is a try-catch for SqlException, but that &apos;throw new SqlException(...).getSQLException()&apos; is used within. It would be good to either get rid of the try-catch blocks or not use the getSQLException method.&lt;/p&gt;

&lt;p&gt;I have started the regression tests and will report back when they are done.&lt;/p&gt;</comment>
                            <comment id="12602586" author="kristwaa" created="Thu, 5 Jun 2008 09:59:30 +0100"  >&lt;p&gt;suites.All and derbyall passed.&lt;/p&gt;</comment>
                            <comment id="12603093" author="suranjay" created="Fri, 6 Jun 2008 17:31:21 +0100"  >&lt;p&gt;This patch refactors length checking (for max value and negativity) code to a new method.&lt;/p&gt;</comment>
                            <comment id="12603868" author="kristwaa" created="Tue, 10 Jun 2008 14:29:29 +0100"  >&lt;p&gt;Thank you Suran.&lt;br/&gt;
I&apos;m running the tests again and intend to commit the patch as soon as they have completed.&lt;/p&gt;

&lt;p&gt;I took the liberty to replace a few tabs in the patch, and changed some formatting in the new method to stay below 80 characters per line. Attached modified patch as &apos;derby-3705-2b.diff&apos;.&lt;/p&gt;</comment>
                            <comment id="12603915" author="kristwaa" created="Tue, 10 Jun 2008 17:00:15 +0100"  >&lt;p&gt;Regression tests passed.&lt;br/&gt;
Committed &apos;derby-3705-2b.diff&apos; to trunk with revision 666174.&lt;/p&gt;

&lt;p&gt;Thanks for the contribution &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12604578" author="suranjay" created="Thu, 12 Jun 2008 18:06:19 +0100"  >&lt;p&gt;Patch committed.&lt;/p&gt;</comment>
                            <comment id="12871102" author="kristwaa" created="Tue, 25 May 2010 12:40:10 +0100"  >&lt;p&gt;Closing issue.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12395334">DERBY-3663</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12383570" name="derby-3705-2.diff" size="3784" author="suranjay" created="Fri, 6 Jun 2008 17:31:21 +0100"/>
                            <attachment id="12383749" name="derby-3705-2b.diff" size="3954" author="kristwaa" created="Tue, 10 Jun 2008 14:29:29 +0100"/>
                            <attachment id="12383312" name="derby-3705.diff" size="2275" author="suranjay" created="Tue, 3 Jun 2008 20:27:10 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 3 Jun 2008 19:52:59 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23799</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0q8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38069</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>