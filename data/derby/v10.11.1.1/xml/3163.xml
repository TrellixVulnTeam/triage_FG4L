<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:08:07 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3163/DERBY-3163.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3163] Derby JUnit test framework adaptions to run existing tests against replicated databases</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3163</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Extensions to run existing Apache Derby tests (old test harness tests (&quot;derbyall&quot; kind)&lt;br/&gt;
  and junit tests)&lt;br/&gt;
  This requires&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Running existing tests against already started servers on &quot;non-localhost&quot; machines.&lt;/li&gt;
	&lt;li&gt;verificationclients checking slave vs. master.&lt;/li&gt;
	&lt;li&gt;...&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12381455">DERBY-3163</key>
            <summary>Derby JUnit test framework adaptions to run existing tests against replicated databases</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12381451">DERBY-3161</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="olesolberg">Ole Solberg</assignee>
                                    <reporter username="olesolberg">Ole Solberg</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Oct 2007 14:46:47 +0000</created>
                <updated>Fri, 21 Jan 2011 18:17:19 +0000</updated>
                            <resolved>Fri, 4 Apr 2008 15:42:13 +0100</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12540689" author="olesolberg" created="Wed, 7 Nov 2007 07:32:06 +0000"  >&lt;p&gt;First version of Derby JUnit test framework adaptions to run existing tests against replicated databases.&lt;br/&gt;
Actually mods. to be able to run tests against &lt;b&gt;already started servers&lt;/b&gt;.&lt;/p&gt;



&lt;p&gt;java/testing/org/apache/derbyTesting/junit/TestConfiguration.java:&lt;br/&gt;
------------------------------------------------------------------&lt;br/&gt;
NB. also includes the modifications to  TestConfiguration.java &lt;br/&gt;
submitted in derby-2807-v1.diff.txt. &lt;br/&gt;
derby-2807-v1.diff.txt is not yet committed.&lt;/p&gt;

&lt;p&gt;+    getDEFAULT_CONFIG()&lt;/p&gt;

&lt;p&gt;+    existingServerSuite(Class testClass, &lt;br/&gt;
             boolean cleanDB,&lt;br/&gt;
             String hostName,&lt;br/&gt;
             int portNumber)&lt;/p&gt;

&lt;p&gt;+    existingServerDecorator(Test test, String hostName, int PortNumber)&lt;/p&gt;


&lt;p&gt;java/testing/org/apache/derbyTesting/junit/CleanDatabaseTestSetup.java:&lt;br/&gt;
-----------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;+    CleanDatabaseTestSetup(Test test, &lt;br/&gt;
             boolean useNetworkClient,&lt;br/&gt;
             String hostName,&lt;br/&gt;
             int portNo)&lt;/p&gt;

&lt;p&gt;+    jdbcClient&lt;/p&gt;

&lt;p&gt;+    hostName&lt;/p&gt;

&lt;p&gt;+    portNo&lt;/p&gt;

&lt;p&gt;M    setUp() - set jdbcClient, hostName, portNo in current TestConfiguration.&lt;/p&gt;</comment>
                            <comment id="12540691" author="olesolberg" created="Wed, 7 Nov 2007 07:43:25 +0000"  >&lt;p&gt;Example modifications to existing tests to exploit test decorators in cases when running tests &lt;br/&gt;
against already running servers.&lt;/p&gt;



&lt;p&gt;java/testing/org/apache/derbyTesting/functionTests/tests/lang/AnsiTrimTest.java:&lt;br/&gt;
java/testing/org/apache/derbyTesting/functionTests/tests/lang/CreateTableFromQueryTest.java:&lt;/p&gt;

&lt;p&gt;Separate out &apos;public static void decorate(Statement s)&apos; to be used in &apos;decorateSQL(Statement s)&apos;&lt;br/&gt;
also in the replication tests where decorators are run against already running servers.&lt;/p&gt;
</comment>
                            <comment id="12541766" author="kristwaa" created="Mon, 12 Nov 2007 13:02:52 +0000"  >&lt;p&gt;I had a look at &apos;derby-3163.1-v1.diff.txt&apos;, and saw that there are quite some lines commented out and comments indicating more changes have to be done before the test framework is ready for the task. Also, are the System.out.printlns supposed to be in there?&lt;/p&gt;

&lt;p&gt;Is the patch intended for commit?&lt;br/&gt;
Can you say something about what has to be done to push this issue to completion?&lt;/p&gt;


&lt;p&gt;thanks,&lt;/p&gt;</comment>
                            <comment id="12541778" author="olesolberg" created="Mon, 12 Nov 2007 13:56:42 +0000"  >&lt;p&gt;Thank you for looking into this Kristian!&lt;/p&gt;

&lt;p&gt;The patch is not ready for commit as you suspected.&lt;/p&gt;

&lt;p&gt;I think the best approach would be to get derby-2807-v1.diff.txt (in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2807&quot; title=&quot;Create a test for BlobClob compatibility on Derby server versions vs. Derby client versions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2807&quot;&gt;&lt;del&gt;DERBY-2807&lt;/del&gt;&lt;/a&gt;) committed first, which would give a smaller and cleaner patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3163&quot; title=&quot;Derby JUnit test framework adaptions to run existing tests against replicated databases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3163&quot;&gt;&lt;del&gt;DERBY-3163&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;The System.out.printlns are not supposed to be there, they are leftovers from my initial testing against the replication &quot;Proof of concept&quot; code.&lt;/p&gt;</comment>
                            <comment id="12565680" author="olesolberg" created="Tue, 5 Feb 2008 10:05:59 +0000"  >&lt;p&gt;New version of the derby-3163.1 and derby-3163.2 patches.&lt;br/&gt;
These patches are needed for the replication test framework and replication tests:&lt;br/&gt;
I plan to submit new patches for 3162 - replication test framework, and 3164 - replication tests in a couple of days.&lt;/p&gt;</comment>
                            <comment id="12567687" author="oysteing" created="Mon, 11 Feb 2008 16:29:33 +0000"  >&lt;p&gt;Thanks for the patch, Ole.&lt;/p&gt;

&lt;p&gt;1. TestConfiguration: I see several questions and remarks like &quot;This&lt;br/&gt;
   looks bogus&quot; in comments that makes me a bit unsure about how ready&lt;br/&gt;
   this patch is.  I think some of the comments should be cleaned up.&lt;/p&gt;

&lt;p&gt;2. CleanDatabaseTestSetup: &lt;br/&gt;
   a. The added constructor is as far as I can see, not used.  Is&lt;br/&gt;
      future use planned?  It is not clear to me when you would use&lt;br/&gt;
      this as opposed to the new methods in TestConfiguration.&lt;/p&gt;

&lt;p&gt;   b. Why are the added fields static?  &lt;/p&gt;

&lt;p&gt;   c. setUp() contains two assignments to current.  The first does not&lt;br/&gt;
      seem to serve any purpose since, if the variable is used, it&lt;br/&gt;
      will always be set a second time before it is used.&lt;/p&gt;

&lt;p&gt;3. AnsiTrimTest/CreateTableFromQueryTest: It is not clear to me what&lt;br/&gt;
   the purpose of the refactoring of the statement executions is.  Is&lt;br/&gt;
   this just preparing for future changes?&lt;/p&gt;

&lt;p&gt;4. Minor nits: &lt;br/&gt;
   a. Several lines are longer that 80 chars.  &lt;/p&gt;

&lt;p&gt;   b. Code that is commented out.&lt;/p&gt;</comment>
                            <comment id="12568170" author="olesolberg" created="Tue, 12 Feb 2008 15:34:57 +0000"  >&lt;p&gt;Thanks for looking at this patch, &#216;ystein!&lt;/p&gt;

&lt;p&gt;&amp;gt; &#216;ystein Gr&#248;vlen commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3163&quot; title=&quot;Derby JUnit test framework adaptions to run existing tests against replicated databases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3163&quot;&gt;&lt;del&gt;DERBY-3163&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
&amp;gt; ----------------------------------------&lt;br/&gt;
.&lt;br/&gt;
&amp;gt; 1. TestConfiguration: I see several questions and remarks like &quot;This&lt;br/&gt;
&amp;gt;    looks bogus&quot; in comments that makes me a bit unsure about how ready&lt;br/&gt;
&amp;gt;    this patch is.  I think some of the comments should be cleaned up.&lt;/p&gt;

&lt;p&gt;This was partly comments copy/pasted from &quot;original&quot; methods used as base &lt;br/&gt;
for the variants needed when specifying host and port in a client/server&lt;br/&gt;
context.&lt;br/&gt;
Cleaned up now.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt; 2. CleanDatabaseTestSetup: &lt;br/&gt;
&amp;gt;    a. The added constructor is as far as I can see, not used.  Is&lt;br/&gt;
&amp;gt;       future use planned?  It is not clear to me when you would use&lt;br/&gt;
&amp;gt;       this as opposed to the new methods in TestConfiguration.&lt;/p&gt;

&lt;p&gt;It is for future use as in derby-3164.1-v1.diff.txt.&lt;/p&gt;

&lt;p&gt;&amp;gt;    &lt;br/&gt;
&amp;gt;    b. Why are the added fields static?  &lt;/p&gt;

&lt;p&gt;Removed static.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;    c. setUp() contains two assignments to current.  The first does not&lt;br/&gt;
&amp;gt;       seem to serve any purpose since, if the variable is used, it&lt;br/&gt;
&amp;gt;       will always be set a second time before it is used.&lt;/p&gt;

&lt;p&gt;Fixed.&lt;/p&gt;

&lt;p&gt;&amp;gt;  &lt;br/&gt;
&amp;gt; 3. AnsiTrimTest/CreateTableFromQueryTest: It is not clear to me what&lt;br/&gt;
&amp;gt;    the purpose of the refactoring of the statement executions is.  Is&lt;br/&gt;
&amp;gt;    this just preparing for future changes?&lt;/p&gt;

&lt;p&gt;Yes, it is preparing  for 3164.&lt;br/&gt;
This is to be able to run existing JUnit tests in a replication context &lt;br/&gt;
(specifying host and port in a client/server context).&lt;/p&gt;

&lt;p&gt;derby-3164.1-v1.diff.txt defines a suite including a subset of the existing&lt;br/&gt;
JUnit tests for running in client/server context. &lt;/p&gt;

&lt;p&gt;Tests which use decorateSQL() must use networkclient when running setUp/decorateSQL&lt;br/&gt;
in this context.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt; 4. Minor nits: &lt;br/&gt;
&amp;gt;    a. Several lines are longer that 80 chars.  &lt;/p&gt;

&lt;p&gt;Fixed.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;    b. Code that is commented out.&lt;/p&gt;

&lt;p&gt;Fixed.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;/p&gt;


&lt;p&gt;I will report back when tests are finished.&lt;/p&gt;</comment>
                            <comment id="12568232" author="olesolberg" created="Tue, 12 Feb 2008 17:31:54 +0000"  >&lt;p&gt;derbyall and suites.All: OK.&lt;/p&gt;

&lt;p&gt;Local/uncommitted replication tests: OK wrt. the current state of replication.&lt;/p&gt;</comment>
                            <comment id="12568274" author="djd" created="Tue, 12 Feb 2008 18:30:58 +0000"  >&lt;p&gt;Is there a write up that explains what the changes are? Several of the new methods in TestConfiguration have no comments so I have no idea what their purpose is.&lt;/p&gt;

&lt;p&gt;The switch to a static decorate() method in some of the tests is confusing. Is there some explanation for why this is required, is this a pattern required for all tests?&lt;/p&gt;</comment>
                            <comment id="12568835" author="olesolberg" created="Thu, 14 Feb 2008 09:04:14 +0000"  >&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt; Is there a write up that explains what the changes are? Several of the new methods in TestConfiguration have no comments so I have no idea what their purpose is.&lt;/p&gt;

&lt;p&gt;derby-3163.1-v4.diff.txt&lt;br/&gt;
------------------------&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;TestConfiguration:&lt;br/&gt;
Add decorators which takes server host and port, for running tests in a &lt;br/&gt;
server/client configuration, where a server has already &lt;br/&gt;
been started on a that host and port.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;CleanDatabaseTestSetup:&lt;br/&gt;
Added a constructor which takes server host and port, for an already started server in a &lt;br/&gt;
client/server configuration, to run the SQL decoration on that server.&lt;/li&gt;
&lt;/ul&gt;




&lt;p&gt;Comments are now included for the added test decorators (plus for a couple of existing decorators&lt;br/&gt;
which also lacked comments.)&lt;/p&gt;


&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt; The switch to a static decorate() method in some of the tests is confusing. Is there some explanation for why this is required, is this a pattern required for all tests?&lt;br/&gt;
&amp;gt; &lt;/p&gt;

&lt;p&gt;derby-3163.2-v4.diff.txt&lt;br/&gt;
------------------------&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;AnsiTrimTest, CreateTableFromQueryTest:&lt;br/&gt;
Factored out the SQL statement execution for database content setup to&lt;br/&gt;
be able to reuse the same code in other TestCases which add the same&lt;br/&gt;
test method in their &apos;suite()&apos; method.&lt;br/&gt;
Currently this is done for a few testcases reused in replication testing:&lt;br/&gt;
o.a.dT.ft.tests.replicationTests.StandardTests: e.g. as &apos;AnsiTrimTest.decorate(s);&apos; (derby-3164.1)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This pattern is required for all tests which is to be used in other &lt;br/&gt;
TestCases which add the same test method in their &apos;suite()&apos; method.&lt;/p&gt;</comment>
                            <comment id="12568925" author="oysteing" created="Thu, 14 Feb 2008 13:28:07 +0000"  >&lt;p&gt;I think the latest versions of the patches look.   The added comments are very useful.  My only remark is that it would be good if you could have used javadoc tags (e.g., @param and @returns) where applicable.&lt;/p&gt;</comment>
                            <comment id="12569279" author="oysteing" created="Fri, 15 Feb 2008 14:50:24 +0000"  >&lt;p&gt;Thanks, Ole. Committed v4 of patches as revision 628073.&lt;/p&gt;</comment>
                            <comment id="12585554" author="olesolberg" created="Fri, 4 Apr 2008 15:42:13 +0100"  >&lt;p&gt;Currently planned framework and tests for trunk and 10.4 branch are committed and used in nightly tests: Closing.&lt;br/&gt;
Additional improvements and additions will be traced by new JIRA issues. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12369079" name="derby-3163.1-v1.diff.txt" size="9009" author="olesolberg" created="Wed, 7 Nov 2007 07:32:06 +0000"/>
                            <attachment id="12374750" name="derby-3163.1-v2.diff.txt" size="5179" author="olesolberg" created="Tue, 5 Feb 2008 10:05:59 +0000"/>
                            <attachment id="12375376" name="derby-3163.1-v3.diff.txt" size="4591" author="olesolberg" created="Tue, 12 Feb 2008 15:34:57 +0000"/>
                            <attachment id="12375560" name="derby-3163.1-v4.diff.txt" size="7550" author="olesolberg" created="Thu, 14 Feb 2008 09:04:14 +0000"/>
                            <attachment id="12369081" name="derby-3163.2-v1.diff.txt" size="2975" author="olesolberg" created="Wed, 7 Nov 2007 07:43:25 +0000"/>
                            <attachment id="12374751" name="derby-3163.2-v2.diff.txt" size="2975" author="olesolberg" created="Tue, 5 Feb 2008 10:05:59 +0000"/>
                            <attachment id="12375375" name="derby-3163.2-v3.diff.txt" size="2975" author="olesolberg" created="Tue, 12 Feb 2008 15:34:57 +0000"/>
                            <attachment id="12375559" name="derby-3163.2-v4.diff.txt" size="3425" author="olesolberg" created="Thu, 14 Feb 2008 09:04:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 12 Nov 2007 13:02:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30749</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0jwn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37043</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>