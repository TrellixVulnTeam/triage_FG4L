<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:34:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2283/DERBY-2283.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2283] convert lang/currentof.java test to junit test</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2283</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Using this Jira entry to attach the converted test in future&lt;/p&gt;</description>
                <environment></environment>
        <key id="12361796">DERBY-2283</key>
            <summary>convert lang/currentof.java test to junit test</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mkutty">Manjula Kutty</assignee>
                                    <reporter username="mkutty">Manjula Kutty</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Feb 2007 20:42:43 +0000</created>
                <updated>Wed, 1 Jul 2009 00:40:23 +0100</updated>
                            <resolved>Wed, 21 Mar 2007 18:52:01 +0000</resolved>
                                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12469616" author="mkutty" created="Thu, 1 Feb 2007 23:32:43 +0000"  >&lt;p&gt;Attaching the CurrentOfTest.java for review. I ran the lang Suite and one test failed. It was UpdatableResultSetTest which timed out during getting a n/w server connection. This is my first attempt in conversion of tests to junit. &lt;/p&gt;</comment>
                            <comment id="12469623" author="djd" created="Fri, 2 Feb 2007 00:04:37 +0000"  >&lt;p&gt;The test generally looks good, usually the timeout failures are due to another test not closing its JDBC objects, such as statements. So it might be due to your test, I think at least one prepared statement is not closed.&lt;/p&gt;

&lt;p&gt;Some minor improvements that would make the test even more readable for others:&lt;/p&gt;

&lt;p&gt;Instead of:&lt;br/&gt;
   assertEquals(cursor.getCursorName(), null);&lt;br/&gt;
use&lt;br/&gt;
   assertNull(cursor.getCursorName());&lt;br/&gt;
Also the pattern for assert methods is the expected value is the left argument , and the tested value the right, the use with null above has it the other way around, just an FYI.&lt;/p&gt;

&lt;p&gt;Similar for:&lt;br/&gt;
   assertEquals(false, cursor.next());&lt;br/&gt;
use&lt;br/&gt;
   assertFalse(cursor.next());&lt;/p&gt;

&lt;p&gt;You can look at the JUnit javadoc for the Assert class to see the range of assert methods available.&lt;/p&gt;

&lt;p&gt;I think many of the try-catch blocks in the test can be replaced with the assert methods Army added a while ago:&lt;br/&gt;
e.g.&lt;br/&gt;
		try &lt;/p&gt;
{
			delete.executeUpdate(); // no current row / closed
			fail(&quot;Exception expected above!&quot;);
		}
&lt;p&gt; catch (SQLException se) &lt;/p&gt;
{
			assertSQLState(&quot;24000&quot;, se);
		}

&lt;p&gt;with&lt;br/&gt;
       // no current row / closed&lt;br/&gt;
       assertStatementError(&quot;24000&quot;, delete);&lt;/p&gt;

&lt;p&gt;This helps to give the code a cleaner look.&lt;/p&gt;

&lt;p&gt;That would also cleanup these try-catch blocks:&lt;br/&gt;
		try &lt;/p&gt;
{
			assertUpdateCount(update, 0);
			fail(&quot;Exception expected above!&quot;);

		}
&lt;p&gt; catch (SQLException se) &lt;/p&gt;
{
			assertSQLState(&quot;XCL07&quot;, se);
		}&lt;br/&gt;
&lt;br/&gt;
Here I think the assertUpdateCount() confuses the reader as you don&apos;t expect that update statement to succeed an return zero rows, but the assertUpdateCount implies that. If for some reason the assertStatementError() didn&apos;t work here, I think clearer code would be:&lt;br/&gt;
		try {
			update.executeUpdate();
			fail(&quot;Exception expected above!&quot;);

		} catch (SQLException se) {
			assertSQLState(&quot;XCL07&quot;, se);
		}
&lt;p&gt;but this is just an FYI, since the assertStatementError is the correct approach.&lt;/p&gt;

&lt;p&gt;Can you provide a patch using svn diff instead of individual files? Also are you going to remove the old test and its master files etc?&lt;/p&gt;
</comment>
                            <comment id="12469875" author="mkutty" created="Fri, 2 Feb 2007 21:21:57 +0000"  >&lt;p&gt;I changed the test to include Dan&apos;s comments. I&apos;m attaching the diff and stat files. Please review it and let me know if you have any comments/questions/suggestions&lt;/p&gt;</comment>
                            <comment id="12469887" author="mamtas" created="Fri, 2 Feb 2007 21:55:37 +0000"  >&lt;p&gt;Manjula, just an FYI and it is not a biggie but if you use svn stat -q, then you won&apos;t get following kind of output. &lt;br/&gt;
?      test&lt;br/&gt;
?      .project&lt;br/&gt;
?      system&lt;br/&gt;
?      .externalToolBuilders&lt;br/&gt;
?      .classpath&lt;br/&gt;
?      svn_stat_02_02&lt;br/&gt;
?      logs&lt;br/&gt;
?      svn_diff_02_02.txt&lt;/p&gt;</comment>
                            <comment id="12469892" author="mamtas" created="Fri, 2 Feb 2007 22:09:26 +0000"  >&lt;p&gt;Manjula, I just have one comment. Should the setUp() method be calling it&apos;s super&apos;s implementation (ie super.setUp) like the tearDown() method?&lt;/p&gt;</comment>
                            <comment id="12469893" author="djd" created="Fri, 2 Feb 2007 22:11:00 +0000"  >&lt;p&gt;Patch Committed revision 502769 - Thanks Manjula.&lt;/p&gt;

&lt;p&gt;The test is lacking javadoc comments on the class and fixture methods, if you gained any knowledge during the conversion it would be great if you could find time to save that knowledge as comments. Even an overview in the class javadoc of what the test is covering would be good.&lt;/p&gt;

&lt;p&gt;I think the remaining try/catch blocks could all use the JDBC.assertStatementError() utility method, thus cleaning up the test even more.&lt;/p&gt;

&lt;p&gt;In earlier comments I think you had said that this is the type of language test that should run in client server as well, but it&apos;s only setup to run embedded. This would make it work in both:&lt;/p&gt;

&lt;p&gt;    public static Test suite() &lt;/p&gt;
{
        return TestConfiguration.defaultSuite(CurrentOfTest.class);
     }</comment>
                            <comment id="12471160" author="mkutty" created="Thu, 8 Feb 2007 00:08:39 +0000"  >&lt;p&gt;I did svn delete to currentof.java and currentof_derby.properties. Ran the lang suite in the old harness and found some failures.  None are related to currentof.java removal. So attaching the modified test patch . I added some more assert methods for client/server mode, but have some problem, so making the test to run only in embedded mode.  Please review&lt;/p&gt;</comment>
                            <comment id="12471399" author="djd" created="Thu, 8 Feb 2007 16:50:22 +0000"  >&lt;p&gt;Patch committed - made two minor changes:&lt;br/&gt;
1) Moved the class comment to before the class definition so it is a javadoc comment for the class&lt;br/&gt;
2) renamed the suite to match the test name&lt;br/&gt;
Thanks Manjula.&lt;/p&gt;</comment>
                            <comment id="12471511" author="mkutty" created="Thu, 8 Feb 2007 22:49:18 +0000"  >&lt;p&gt;Adding patches for the removal of old test files. The following files are deleted&lt;/p&gt;

&lt;p&gt;java/testing/org/apache/derbyTesting/functionTests/tests/lang/currentof.java&lt;br/&gt;
java/testing/org/apache/derbyTesting/functionTests/tests/lang/currentof_derby.properties&lt;br/&gt;
java/testing/org/apache/derbyTesting/functionTests/master/currentof.out&lt;/p&gt;

&lt;p&gt;Also removed the currentof.java from derbylang.runall file&lt;/p&gt;

&lt;p&gt;Please review it and if every thing looks good, can any one please commit this patch?&lt;/p&gt;</comment>
                            <comment id="12471562" author="fuzzylogic" created="Fri, 9 Feb 2007 02:01:11 +0000"  >&lt;p&gt;Committed jira_2283_02_08_diff.txt with revision 505131.&lt;/p&gt;</comment>
                            <comment id="12476740" author="mkutty" created="Wed, 28 Feb 2007 22:23:38 +0000"  >&lt;p&gt;Closing this issue &lt;/p&gt;</comment>
                            <comment id="12477456" author="djd" created="Fri, 2 Mar 2007 21:35:00 +0000"  >&lt;p&gt;I was going to add a test case for a change in the cursor statement to this test but then I realized that the fixture testbug4395(0 was doing exactly that though its name did not indicate that and its javadoc comments did not describe what it is testing. I cleaned it up with revision 513967.&lt;/p&gt;

&lt;p&gt;Looking in detail at the test I see that even though it is testing UPDATE and DELETE WHERE CURRENT OF it only checks that the update counts are correct after an execution, not that the right values were updated or the right row deleted. I think this is because the old test would have tested the output be comparing it to the master file, something to watch out for when converting tests.&lt;/p&gt;

&lt;p&gt;Also the testUpdate() has a whole set of tests that are testing if a read only statement results in a null cursor name. These tests are not specific to UPDATE so ideally would be in their own fixture.&lt;/p&gt;</comment>
                            <comment id="12477566" author="djd" created="Sat, 3 Mar 2007 00:35:03 +0000"  >&lt;p&gt;Test needs to ensure that the UPDATE and DELETE statements are updating and deleting the correct rows and for update to the correct values.&lt;/p&gt;</comment>
                            <comment id="12478124" author="mkutty" created="Mon, 5 Mar 2007 18:45:55 +0000"  >&lt;p&gt;Will be attaching a new patch to address this issue&lt;/p&gt;</comment>
                            <comment id="12481745" author="mkutty" created="Fri, 16 Mar 2007 20:12:43 +0000"  >&lt;p&gt;Attaching the patch which will validate the rows to be deleted and updated. Please review and if looks fine please commit&lt;/p&gt;</comment>
                            <comment id="12482828" author="kmarsden" created="Wed, 21 Mar 2007 16:41:32 +0000"  >&lt;p&gt;committed  revision 520662 for this issue with patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2283&quot; title=&quot;convert lang/currentof.java test to junit test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2283&quot;&gt;&lt;del&gt;DERBY-2283&lt;/del&gt;&lt;/a&gt;_diff_03_16.txt&lt;/p&gt;</comment>
                            <comment id="12482870" author="mkutty" created="Wed, 21 Mar 2007 18:52:01 +0000"  >&lt;p&gt;Thanks for the commit Kathey&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12350179" name="CurrentOfTest.java" size="10174" author="mkutty" created="Thu, 1 Feb 2007 23:32:43 +0000"/>
                            <attachment id="12353538" name="DERBY-2283_diff_03_16.txt" size="5571" author="mkutty" created="Fri, 16 Mar 2007 20:12:43 +0000"/>
                            <attachment id="12353537" name="DERBY-2283_stat_03_16.txt" size="157" author="mkutty" created="Fri, 16 Mar 2007 20:12:43 +0000"/>
                            <attachment id="12350180" name="_Suite.java" size="3510" author="mkutty" created="Thu, 1 Feb 2007 23:32:43 +0000"/>
                            <attachment id="12350603" name="jira_2283_.diff.txt" size="7058" author="mkutty" created="Thu, 8 Feb 2007 00:08:38 +0000"/>
                            <attachment id="12350710" name="jira_2283_02_08_diff.txt" size="31112" author="mkutty" created="Thu, 8 Feb 2007 22:49:18 +0000"/>
                            <attachment id="12350711" name="jira_2283_02_08_stat.txt" size="413" author="mkutty" created="Thu, 8 Feb 2007 22:49:18 +0000"/>
                            <attachment id="12350604" name="jira_2283_stat.txt" size="157" author="mkutty" created="Thu, 8 Feb 2007 00:08:39 +0000"/>
                            <attachment id="12350253" name="svn_diff_02_02.txt" size="10674" author="mkutty" created="Fri, 2 Feb 2007 21:21:57 +0000"/>
                            <attachment id="12350254" name="svn_stat_02_02.txt" size="424" author="mkutty" created="Fri, 2 Feb 2007 21:21:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 2 Feb 2007 00:04:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30360</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0u0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38680</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>