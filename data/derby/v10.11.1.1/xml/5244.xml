<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:25:03 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5244/DERBY-5244.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5244] DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5244</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM.&lt;/p&gt;

&lt;p&gt;Sample java code use for testing.&lt;/p&gt;

&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;ListColumns.java&lt;br/&gt;
 */&lt;br/&gt;
import java.sql.*;&lt;br/&gt;
import java.util.Properties;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;public class ListColumns {&lt;br/&gt;
	public static void main(String[] args) {&lt;br/&gt;
		Connection con = null;&lt;br/&gt;
		try {&lt;/p&gt;

&lt;p&gt;			Class.forName(&quot;org.apache.derby.jdbc.ClientDriver&quot;);&lt;/p&gt;

&lt;p&gt;			Properties connectionProps = new Properties();&lt;br/&gt;
			connectionProps.put(&quot;user&quot;, &quot;app&quot;);&lt;br/&gt;
			connectionProps.put(&quot;password&quot;, &quot;app&quot;);&lt;/p&gt;

&lt;p&gt;			con = DriverManager.getConnection(&lt;br/&gt;
					&quot;jdbc:derby://localhost:1527/northwind&quot;, connectionProps);&lt;/p&gt;

&lt;p&gt;			String tableName = &quot;V1&quot;;&lt;/p&gt;

&lt;p&gt;			DatabaseMetaData meta = con.getMetaData();&lt;br/&gt;
			System.out.println(&quot;Database Product Version&quot;&lt;br/&gt;
					+ meta.getDatabaseProductVersion());&lt;/p&gt;

&lt;p&gt;			ResultSet res = meta.getColumns(null, null, tableName, null);&lt;br/&gt;
			System.out.println(&quot;List of columns for &quot; + tableName);&lt;br/&gt;
			while (res.next()) &lt;/p&gt;
{
				System.out.println(&quot;  &quot; + res.getString(&quot;TABLE_SCHEM&quot;) + &quot;, &quot;
						+ res.getString(&quot;TABLE_NAME&quot;) + &quot;, &quot;
						+ res.getString(&quot;COLUMN_NAME&quot;) + &quot;, &quot;
						+ res.getString(&quot;TYPE_NAME&quot;) + &quot;, &quot;
						+ res.getInt(&quot;COLUMN_SIZE&quot;) + &quot;, &quot;
						+ res.getString(&quot;NULLABLE&quot;));
			}
&lt;p&gt;			res.close();&lt;/p&gt;

&lt;p&gt;			con.close();&lt;br/&gt;
		} catch (java.lang.ClassNotFoundException e) &lt;/p&gt;
{
			System.err.println(&quot;ClassNotFoundException: &quot; + e.getMessage());
		}
&lt;p&gt; catch (SQLException e) &lt;/p&gt;
{
			System.err.println(&quot;SQLException: &quot; + e.getMessage());
		}
&lt;p&gt;	}&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment>Windows</environment>
        <key id="12508214">DERBY-5244</key>
            <summary>DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chaase3">Kim Haase</assignee>
                                    <reporter username="pgodey">Prashanth Godey</reporter>
                        <labels>
                            <label>SYNONYM</label>
                            <label>getColumns</label>
                    </labels>
                <created>Tue, 24 May 2011 17:18:32 +0100</created>
                <updated>Wed, 16 Apr 2014 03:40:56 +0100</updated>
                            <resolved>Fri, 18 Oct 2013 16:20:29 +0100</resolved>
                                    <version>10.8.1.2</version>
                                    <fixVersion>10.10.2.0</fixVersion>
                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Documentation</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13146494" author="mamtas" created="Tue, 8 Nov 2011 19:35:30 +0000"  >&lt;p&gt;Added(revision 1199096) a test case which confirms the behavior noticed by this jira&lt;/p&gt;</comment>
                            <comment id="13147997" author="mamtas" created="Thu, 10 Nov 2011 20:44:55 +0000"  >&lt;p&gt;I debugged this issue and found that the problem is that for synonyms, we do not keep any rows in SYSCOLUMNS. It may have been a conscious implementation decision to do so because columns in synonyms are going to be same as the columns in underlying table/view. But metadata query associated with DatabaseMetaData.getColumns() does a join on SYSTABLES, SYSCOLUMNS AND SYSSCHEMA to get the list of columns but since there are no rows in SYSCOLUMNS, we always get an empty resultset for synonyms. Following is part of the query associated with getColumns in impl.jdbc.metadata.properties&lt;br/&gt;
	FROM SYS.SYSSCHEMAS S, \&lt;br/&gt;
			SYS.SYSTABLES T, \&lt;br/&gt;
			SYS.SYSCOLUMNS C \&lt;br/&gt;
	WHERE C.REFERENCEID = T.TABLEID AND S.SCHEMAID = T.SCHEMAID \&lt;br/&gt;
	  AND ((1=1) OR ? IS NOT NULL) \&lt;br/&gt;
	  AND (S.SCHEMANAME LIKE ?) AND (T.TABLENAME LIKE ?) AND (C.COLUMNNAME LIKE ?) \&lt;br/&gt;
	ORDER BY TABLE_SCHEM, TABLE_NAME, ORDINAL_POSITION&lt;/p&gt;


&lt;p&gt;Java api for getColumns say that getColumns is called on tables(&lt;a href=&quot;http://download.oracle.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getColumns(java.lang.String&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.oracle.com/javase/6/docs/api/java/sql/DatabaseMetaData.html#getColumns(java.lang.String&lt;/a&gt;, java.lang.String, java.lang.String, java.lang.String)). Does it mean that it is ok for us to return empty resultset for synonyms? I did write a test for view and saw that we do return column information for views. I will commit the test for views soon.&lt;/p&gt;

&lt;p&gt;Possible options are&lt;br/&gt;
1)modify the metadata query to include synonyms - not sure how easy that might be(or if it is doable at all)&lt;br/&gt;
2)add rows in syscolumns(for existing databases, we can do this at the time of upgrade) so we know that the existing metadata query will work&lt;br/&gt;
3)see if we can tweak EmbedDatabaseMetaData.getColumns method to do something special for synonyms. Again, since we send a pattern for tablename to getColumns, I am not sure how we will be able to handle tables, views and synonyms starting with the given table name pattern,&lt;br/&gt;
4)I did some google search on synonyms and getColumns and found that both DB2 and Oracle it appears require a special knob to be set to true(the knob is not same for the 2 databases) before getColumns will start returning rows for synonyms. &lt;br/&gt;
For DB2, it is an optional connection property CatalogIncludesSynonyms  &lt;/p&gt;
{true | false}
&lt;p&gt;. When set to true, synonyms are included in the result sets returned from the following DatabaseMetaData methods: getColumns, getProcedureColumns, and getIndexInfo. When set to false, synonyms are omitted from result sets. The default is true.&lt;br/&gt;
For Oracle, it is a connection level property too, a property named &quot;includeSynonyms&quot; can be set to &quot;true&quot; to DriverManager.getConnection. &lt;/p&gt;</comment>
                            <comment id="13148111" author="mikem" created="Thu, 10 Nov 2011 23:34:58 +0000"  >&lt;p&gt;The current implementation seems in keeping with the standard.  If derby has a place in the documentation it would be reasonable to note the current behavior.  &lt;/p&gt;

&lt;p&gt;I would guess that option 2 might lead to problems unless other consequences are considered like drop table and drop synonym.  &lt;/p&gt;</comment>
                            <comment id="13148515" author="chaase3" created="Fri, 11 Nov 2011 14:40:00 +0000"  >&lt;p&gt;Thanks, Mike &amp;#8211; I am reclassifying this issue as a documentation improvement rather than a JDBC bug. We can add another subtopic in the JDBC section on the java.sql.DatabaseMetaData interface. &lt;/p&gt;</comment>
                            <comment id="13148574" author="mamtas" created="Fri, 11 Nov 2011 17:03:14 +0000"  >&lt;p&gt;Yes, Mike, I should have elaborated more on option 2). It is just not adding the rows in SYSCOLUMNS but also maintaining them as needed based on say ALTER TABLE.. DROP COLUMN, ALTER TABLE .. ADD COLUMN, DROP TABLE, DROP SYNONYM etc. There might be more than these few commands that might impact what happens to rows in SYSCOLUMNS for synonyms.&lt;/p&gt;</comment>
                            <comment id="13794486" author="chaase3" created="Mon, 14 Oct 2013 22:07:11 +0100"  >&lt;p&gt;Attaching &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;.diff and rrefjdbc15905.html, with a one-sentence addition to the introductory DatabaseMetaData topic describing our current lack of support for SYNONYMs. I hope I have stated the situation correctly.&lt;/p&gt;

&lt;p&gt;M       src/ref/rrefjdbc15905.dita&lt;/p&gt;

&lt;p&gt;Please let me know if changes are needed.&lt;/p&gt;</comment>
                            <comment id="13797936" author="knutanders" created="Thu, 17 Oct 2013 15:24:20 +0100"  >&lt;p&gt;Looks good to me. +1 to commit.&lt;/p&gt;</comment>
                            <comment id="13799164" author="jira-bot" created="Fri, 18 Oct 2013 16:05:19 +0100"  >&lt;p&gt;Commit 1533480 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chaase3&quot; class=&quot;user-hover&quot; rel=&quot;chaase3&quot;&gt;Kim Haase&lt;/a&gt; in branch &apos;docs/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1533480&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1533480&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;  DatabaseMetaData.getColumns(null, null, tableName, null) does not &lt;br/&gt;
return the columns meta for a SYNONYM&lt;/p&gt;

&lt;p&gt;Modified a Reference Manual topic.&lt;/p&gt;

&lt;p&gt;Patch: &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;.diff&lt;/p&gt;</comment>
                            <comment id="13799165" author="jira-bot" created="Fri, 18 Oct 2013 16:05:20 +0100"  >&lt;p&gt;Commit 1533480 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chaase3&quot; class=&quot;user-hover&quot; rel=&quot;chaase3&quot;&gt;Kim Haase&lt;/a&gt; in branch &apos;docs/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1533480&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1533480&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;  DatabaseMetaData.getColumns(null, null, tableName, null) does not &lt;br/&gt;
return the columns meta for a SYNONYM&lt;/p&gt;

&lt;p&gt;Modified a Reference Manual topic.&lt;/p&gt;

&lt;p&gt;Patch: &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;.diff&lt;/p&gt;</comment>
                            <comment id="13799184" author="jira-bot" created="Fri, 18 Oct 2013 16:19:04 +0100"  >&lt;p&gt;Commit 1533494 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chaase3&quot; class=&quot;user-hover&quot; rel=&quot;chaase3&quot;&gt;Kim Haase&lt;/a&gt; in branch &apos;docs/branches/10.10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1533494&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1533494&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;  Revise DatabaseMetaData section of Reference Manual&lt;/p&gt;

&lt;p&gt;Merged &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;.diff to 10.10 doc branch from trunk revision 1533480.&lt;/p&gt;</comment>
                            <comment id="13799185" author="jira-bot" created="Fri, 18 Oct 2013 16:19:05 +0100"  >&lt;p&gt;Commit 1533494 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chaase3&quot; class=&quot;user-hover&quot; rel=&quot;chaase3&quot;&gt;Kim Haase&lt;/a&gt; in branch &apos;docs/branches/10.10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1533494&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1533494&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;  Revise DatabaseMetaData section of Reference Manual&lt;/p&gt;

&lt;p&gt;Merged &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;.diff to 10.10 doc branch from trunk revision 1533480.&lt;/p&gt;</comment>
                            <comment id="13799188" author="chaase3" created="Fri, 18 Oct 2013 16:20:29 +0100"  >&lt;p&gt;Thanks, Knut!&lt;/p&gt;

&lt;p&gt;Committed patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5244&quot; title=&quot;DatabaseMetaData.getColumns(null, null, tableName, null) does not return the columns meta for a SYNONYM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5244&quot;&gt;&lt;del&gt;DERBY-5244&lt;/del&gt;&lt;/a&gt;.diff to documentation trunk at revision 1533480. &lt;br/&gt;
Merged to 10.10 doc branch at revision 1533494.&lt;/p&gt;</comment>
                            <comment id="13822972" author="chaase3" created="Thu, 14 Nov 2013 21:55:01 +0000"  >&lt;p&gt;Closing, since fixes have appeared in Latest Alpha Manuals and filer is unlikely to close it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12608347" name="DERBY-5244.diff" size="766" author="chaase3" created="Mon, 14 Oct 2013 22:07:11 +0100"/>
                            <attachment id="12608346" name="rrefjdbc15905.html" size="6862" author="chaase3" created="Mon, 14 Oct 2013 22:07:11 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 Nov 2011 19:35:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24731</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0el3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36181</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>