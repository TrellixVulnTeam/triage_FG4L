<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:08:51 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3207/DERBY-3207.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3207] The bin scripts should be able to run when DERBY_HOME is not set</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3207</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The scripts under bin should be able to run without requiring the users to set DERBY_HOME explicitly. The script derby_common.sh, which is sourced by all the scripts under bin, contains code to detect DERBY_HOME based on the value of $0, but since the scripts need to know DERBY_HOME in order to source derby_common.sh, they still fail when DERBY_HOME is not set.&lt;/p&gt;

&lt;p&gt;When I removed this part of bin/ij&lt;/p&gt;

&lt;p&gt;-------&lt;/p&gt;

&lt;p&gt;if [ -z &quot;$DERBY_HOME&quot; ] ; then&lt;br/&gt;
  echo &quot;Error: DERBY_HOME is not set. Please set the DERBY_HOME environment variable&quot;&lt;br/&gt;
  echo &quot;to the location of your Derby installation.&quot;&lt;br/&gt;
  exit 1&lt;br/&gt;
fi&lt;/p&gt;

&lt;p&gt;. $DERBY_HOME/bin/derby_common.sh&lt;/p&gt;

&lt;p&gt;-------&lt;/p&gt;

&lt;p&gt;and in-lined the code in derby_common.sh in its place, I was able to run ij successfully by typing the command &apos;./bin/ij&apos; without setting DERBY_HOME first.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12382606">DERBY-3207</key>
            <summary>The bin scripts should be able to run when DERBY_HOME is not set</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Nov 2007 20:12:15 +0000</created>
                <updated>Thu, 27 Dec 2012 16:22:36 +0000</updated>
                            <resolved>Wed, 17 Mar 2010 10:33:02 +0000</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>Demos/Scripts</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12542870" author="knutanders" created="Thu, 15 Nov 2007 20:17:48 +0000"  >&lt;p&gt;The simple solution is to inline derby_common.sh in all the scripts. To avoid the cost of maintaining duplicated code, I think it&apos;s best if we only have templates for the scripts in the repository, and let ant do the inlining for us in the build process.&lt;/p&gt;</comment>
                            <comment id="12845273" author="knutanders" created="Mon, 15 Mar 2010 10:38:54 +0000"  >&lt;p&gt;This should be an easy thing to fix, so I&apos;ll try to get it into 10.6. The Windows BAT files already works without DERBY_HOME set, so we only need to make this change for the Unix shell scripts.&lt;/p&gt;</comment>
                            <comment id="12845308" author="knutanders" created="Mon, 15 Mar 2010 13:46:54 +0000"  >&lt;p&gt;Here&apos;s a patch that addresses this issue. Before the patch can be applied, the original scripts must be moved from the bin directory to a new directory called bin/templates. Use the following commands to do that:&lt;/p&gt;

&lt;p&gt;mkdir bin/templates&lt;br/&gt;
svn add bin/templates&lt;/p&gt;

&lt;p&gt;svn mv bin/dblook bin/templates/&lt;br/&gt;
svn mv bin/ij bin/templates/&lt;br/&gt;
svn mv bin/sysinfo bin/templates/&lt;br/&gt;
svn mv bin/NetworkServerControl bin/templates/&lt;br/&gt;
svn mv bin/startNetworkServer bin/templates/&lt;br/&gt;
svn mv bin/stopNetworkServer bin/templates/&lt;br/&gt;
svn mv bin/derby_common.sh bin/templates/&lt;/p&gt;

&lt;p&gt;Then the patch can be applied. The patch will make the following changes:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;build.xml:&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;add a target that prepends the contents of derby_common.sh to each of the scripts in bin/templates/ and puts the resulting concatenated scripts directly under bin/&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;exclude the bin/template directory from the archives produced by &quot;ant snapshot&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;tools/release/build.xml:&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;exclude the bin/template directory from the bin archives created by &quot;ant release&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;bin/templates/
{ij,dblook,sysinfo,startNetworkServer,stopNetworkServer,NetworkServerControl}
&lt;p&gt;:&lt;/p&gt;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;removed the following section from all the files, since the content of derby_common.sh will now be included directly in the scripts:&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-if [ -z &quot;$DERBY_HOME&quot; ] ; then&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;echo &quot;Error: DERBY_HOME is not set. Please set the DERBY_HOME environment variable&quot;&lt;/li&gt;
	&lt;li&gt;echo &quot;to the location of your Derby installation.&quot;&lt;/li&gt;
	&lt;li&gt;exit 1&lt;br/&gt;
-fi&lt;br/&gt;
-&lt;br/&gt;
-. $DERBY_HOME/bin/derby_common.sh&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12845313" author="knutanders" created="Mon, 15 Mar 2010 13:56:00 +0000"  >&lt;p&gt;I tested the patch by building the snapshot and release targets and verified that the scripts worked without DERBY_HOME in the following scenarios:&lt;/p&gt;

&lt;p&gt;1) when the script was executed by specifying the full path (absolute or relative) on the command line&lt;/p&gt;

&lt;p&gt;2) when invoking a symbolic link that pointed to one of the scripts&lt;/p&gt;

&lt;p&gt;3) when having the bin directory in PATH and invoking the script without specifying full path&lt;/p&gt;

&lt;p&gt;Examples of the above scenarios copied from my terminal window:&lt;/p&gt;

&lt;p&gt;$ unset DERBY_HOME                                    &lt;br/&gt;
$ ./db-derby-snapshot-10.6.0.0-923109M/bin/ij         &lt;br/&gt;
ij version 10.6&lt;br/&gt;
ij&amp;gt; exit;&lt;br/&gt;
$ ln -s db-derby-snapshot-10.6.0.0-923109M/bin/ij .       &lt;br/&gt;
$ ./ij &lt;br/&gt;
ij version 10.6&lt;br/&gt;
ij&amp;gt; exit;&lt;br/&gt;
$ export PATH=`pwd`/db-derby-snapshot-10.6.0.0-923109M/bin:$PATH&lt;br/&gt;
$ ij&lt;br/&gt;
ij version 10.6&lt;br/&gt;
ij&amp;gt; exit;&lt;/p&gt;</comment>
                            <comment id="12846369" author="knutanders" created="Wed, 17 Mar 2010 10:33:02 +0000"  >&lt;p&gt;Committed revision 924209.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12524770">DERBY-5432</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12438821" name="d3207.diff" size="10387" author="knutanders" created="Mon, 15 Mar 2010 13:46:54 +0000"/>
                            <attachment id="12438820" name="d3207.stat" size="494" author="knutanders" created="Mon, 15 Mar 2010 13:46:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30770</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0qlz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38129</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>