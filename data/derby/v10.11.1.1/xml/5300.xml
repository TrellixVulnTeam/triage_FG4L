<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:29:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5300/DERBY-5300.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5300] Change derby.tests.trace to print the class as well as fixture name</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5300</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I was thinking it would be good for the test output with -Dderby.tests.trace=true to have the class name as well as the fixture as I think if I had a nickel  for every time I grepped for a fixture name to find out what class it is in, I would have a pretty big piggy bank.&lt;/p&gt;

&lt;p&gt;It could print the full class name, like this:&lt;br/&gt;
org.apache.derbyTesting.functionTests.tests.lang.SimpleTest.testBasicOperations used 844 ms .&lt;/p&gt;

&lt;p&gt;or strip off the org.apache.derbyTesting.functionTests for less output like:&lt;/p&gt;

&lt;p&gt;tests.lang.SimpleTest.testBugFixes used 6265 ms .&lt;/p&gt;

&lt;p&gt;Any preferences?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12511930">DERBY-5300</key>
            <summary>Change derby.tests.trace to print the class as well as fixture name</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rsjay1976">Jayaram Subramanian</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Jun 2011 00:12:35 +0100</created>
                <updated>Wed, 3 Sep 2014 09:31:25 +0100</updated>
                            <resolved>Sun, 6 Nov 2011 02:18:32 +0000</resolved>
                                    <version>10.9.1.0</version>
                                    <fixVersion>10.8.3.3</fixVersion>
                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13056432" author="kristwaa" created="Tue, 28 Jun 2011 11:23:01 +0100"  >&lt;p&gt;I&apos;d prefer a shorter version, such that the lines stays below 80 chars in most cases (looks better in terminal windows with default size).&lt;/p&gt;

&lt;p&gt;Additionally, I&apos;d like to see a hint telling me if the test ran with the embedded or the client driver (something along the lines added by the attached patch 1a):&lt;br/&gt;
(emb)testGetStreamsExceptionOnClose used 663 ms F.&lt;br/&gt;
(emb)testSetMaxFieldSizeLarge used 317 ms .&lt;br/&gt;
(net)testInsertData used 21 ms .&lt;br/&gt;
(net)testBinaryStreamProcessing used 18 ms .&lt;/p&gt;

&lt;p&gt;I chose &apos;emb&apos; and &apos;net&apos; because their lengths are equal, but maybe some find &apos;net&apos; a bit confusing due to the old DB2 driver? Could also do &apos;(E)&apos; and &apos;(C)&apos; or something.&lt;/p&gt;

&lt;p&gt;Ideally, I&apos;d like to see this hint in the error/failure report as well, but I&apos;m not sure if that can be done easily enough to be worth the effort &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;</comment>
                            <comment id="13068497" author="kmarsden" created="Wed, 20 Jul 2011 18:18:38 +0100"  >&lt;p&gt;I think maybe (emb) and (cli) as then it will be clear.&lt;/p&gt;

&lt;p&gt;So perhaps a good format would be to strip off  &quot;org.apache.derbyTesting.functionTests.tests.&quot;  where it exists. If a test is run from a class that does not have that prefix, we would print the whole thing, so output would typically look like:&lt;/p&gt;

&lt;p&gt;(emb) lang.SimpleTest.testBasicOperations used 1672 ms .&lt;br/&gt;
(cli) lang.SimpleTest.testBasicOperations used 1703 ms .&lt;/p&gt;

&lt;p&gt;I wonder if it would work to call setName to include this information so it will print with the failure traces.&lt;/p&gt;

</comment>
                            <comment id="13084706" author="rsjay1976" created="Sat, 13 Aug 2011 21:05:13 +0100"  >&lt;p&gt;On doing getclass().getName0  in basetestcase.java  i end up something like&lt;br/&gt;
org.apache.derbyTesting.functionTests.tests.management.JMXTesttestDerbyRegisteredMBeansSimpleInfo used 13 ms &lt;/p&gt;

&lt;p&gt;But i am not able to figure out best way to strip off  org.apache.derbyTesting.functionTests.tests.  since i dont think we should be hardcoding it in basetestcase.&lt;/p&gt;

&lt;p&gt;is there any better way to get rid off org.apache.derbyTesting.functionTests.tests in the logs?&lt;/p&gt;</comment>
                            <comment id="13088114" author="rsjay1976" created="Sat, 20 Aug 2011 04:11:08 +0100"  >&lt;p&gt;Attaching the patch&lt;/p&gt;</comment>
                            <comment id="13097107" author="kristwaa" created="Mon, 5 Sep 2011 11:17:07 +0100"  >&lt;p&gt;I think we have no choice but to hardcode the most common class prefix if we want to shorten the output.&lt;br/&gt;
However, you should make sure the prefix exists before trying to replace it, for instance by using String.startsWith(COMMON_CLASS_PREFIX).&lt;/p&gt;

&lt;p&gt;There&apos;s already a reference to the current configuration in runBare, you could consider writing a new (non-static) method to print the trace string.&lt;/p&gt;</comment>
                            <comment id="13124906" author="kristwaa" created="Tue, 11 Oct 2011 11:08:34 +0100"  >&lt;p&gt;This issue describes a useful improvement.&lt;br/&gt;
Jayaram, do you need any more feedback from the community to wrap up the patch?&lt;/p&gt;</comment>
                            <comment id="13125267" author="rsjay1976" created="Tue, 11 Oct 2011 19:36:03 +0100"  >&lt;p&gt;Thanks Kristian,&lt;br/&gt;
I already attached a patch as a fix. See the files classinfixture_Aug182011.txt and svnstat-classinfixture.txt attached to the jira.&lt;/p&gt;</comment>
                            <comment id="13125667" author="kristwaa" created="Wed, 12 Oct 2011 09:42:48 +0100"  >&lt;p&gt;I already commented on that patch (see comment from 05/Sep/11 10:17).&lt;br/&gt;
There are two issues with it that must be fixed:&lt;br/&gt;
 o a missing dot between the class name and the fixture/method name:&lt;br/&gt;
    (emb)lang.CollationTest2testDefaultCollation&lt;/p&gt;

&lt;p&gt; o it assumes the prefix is always present, which isn&apos;t the case:&lt;br/&gt;
    java ... junit.textui.TestRunner org.apache.derbyTesting.unitTests.junit._Suite&lt;br/&gt;
    (emb)ayInputStreamTesttestSkipLongMaxValue used 441 ms .&lt;br/&gt;
    (emb)ayInputStreamTesttestSkipBytesIntMaxValue used 0 ms .&lt;br/&gt;
    (emb)ayInputStreamTesttestSkipNegative used 0 ms .&lt;br/&gt;
    (emb)ayInputStreamTesttestSkipBytesNegative used 0 ms .&lt;br/&gt;
    (emb)matableBitSetTesttestSetup used 61 ms .&lt;br/&gt;
    (emb)matableBitSetTesttestIntCtor0 used 0 ms .&lt;br/&gt;
    (emb)matableBitSetTesttestIntCtor1 used 0 ms .&lt;/p&gt;

&lt;p&gt;I don&apos;t know if it&apos;s worth it, but we could consider doing the shortening in steps:&lt;br/&gt;
 a) Check if the prefix is &apos;org.apache.derbyTesting.functionTests.tests.&apos;&lt;br/&gt;
 b) Check if the prefix is &apos;org.apache.derbyTesting.&apos;&lt;br/&gt;
 c) Otherwise use fully qualified class name.&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;</comment>
                            <comment id="13126511" author="rsjay1976" created="Thu, 13 Oct 2011 13:11:46 +0100"  >&lt;p&gt;Thanks for your suggestions Kristian,&lt;br/&gt;
Attaching the patch addressing the 2 issues.. i am little not sure about your comments on invoking static method.. please review and let me know if i had missed something&lt;/p&gt;</comment>
                            <comment id="13126578" author="kristwaa" created="Thu, 13 Oct 2011 14:39:47 +0100"  >&lt;p&gt;Thanks, Jayaram.&lt;/p&gt;

&lt;p&gt;The newest patch looks ok to me - it does the right things.&lt;/p&gt;

&lt;p&gt;Some possible improvements:&lt;br/&gt;
 o there are no method JavaDoc&lt;br/&gt;
 o is the formatSubString a good method name for this method?&lt;br/&gt;
   To me it seems the method is specifically targeted at formatting test class names.&lt;br/&gt;
 o COMMON_&lt;span class=&quot;error&quot;&gt;&amp;#91;FUNCTION&amp;#93;&lt;/span&gt;TEST_PREFIX could be constants (private static final)&lt;br/&gt;
 o since you use startsWith and want the rest of the string,&lt;br/&gt;
      mainString.substring(mainString.indexOf(COMMON_FUNCTIONTEST_PREFIX)+COMMON_FUNCTIONTEST_PREFIX.length(),mainString.length());&lt;br/&gt;
    could be simplified to&lt;br/&gt;
      mainString.substring(COMMON_FUNCTIONTEST_PREFIX.length())&lt;br/&gt;
 o inconsistent use of tabs and spaces for indentation&lt;br/&gt;
 o mix of tabs and spaces for indentation (on the same line)&lt;br/&gt;
 o inconsistent placement of braces in formatSubString (either one is fine, but it&apos;s usually easier to read code where the placement is consistent)&lt;/p&gt;

&lt;p&gt;It&apos;s up to you which of the suggestions, if any, you want to address &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; In my opinion, they would increase the code quality. Feel free to ask questions if you have any.&lt;/p&gt;


&lt;p&gt;Regards,&lt;/p&gt;</comment>
                            <comment id="13128339" author="rsjay1976" created="Sun, 16 Oct 2011 05:03:49 +0100"  >&lt;p&gt;Thanks Kristian,&lt;br/&gt;
Attachin the patch..Implemented all your suggestions except private final static comment.. my eclipse compiler was complaining that only final is permitted in that context. i am using jdk 1.6&lt;/p&gt;</comment>
                            <comment id="13129098" author="kristwaa" created="Mon, 17 Oct 2011 20:14:57 +0100"  >&lt;p&gt;Thanks for following up on this issue, Jayaram.&lt;/p&gt;

&lt;p&gt;I committed the patch to trunk with revision 1185330.&lt;br/&gt;
I took the liberty to replace the tabs with spaces.&lt;/p&gt;

&lt;p&gt;You can now update the JIRA issue, i.e. resolve the issue if you believe your work is done.&lt;/p&gt;

&lt;p&gt;BTW, regarding the private final static comment, to do that you would have to move the constants out of the method and make them class variables (not that it matters for this issue).&lt;/p&gt;</comment>
                            <comment id="13129474" author="kristwaa" created="Tue, 18 Oct 2011 05:19:49 +0100"  >&lt;p&gt;Changed code to agree with the Javadoc param comment with revision 1185465.&lt;br/&gt;
This should take care of the Jenkins warning posted to derby-dev.&lt;/p&gt;</comment>
                            <comment id="13144890" author="rsjay1976" created="Sun, 6 Nov 2011 02:18:32 +0000"  >&lt;p&gt;Resolving as per  suggestions &lt;/p&gt;</comment>
                            <comment id="14119554" author="knutanders" created="Wed, 3 Sep 2014 09:31:24 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12498875" name="classinfixture-Oct132011.diff" size="2256" author="rsjay1976" created="Thu, 13 Oct 2011 13:11:46 +0100"/>
                            <attachment id="12499195" name="classinfixture-oct15.diff" size="2254" author="rsjay1976" created="Sun, 16 Oct 2011 05:03:49 +0100"/>
                            <attachment id="12498876" name="classinfixture-stat-oct132011.out" size="854" author="rsjay1976" created="Thu, 13 Oct 2011 13:11:46 +0100"/>
                            <attachment id="12499196" name="classinfixture-stat-oct15.txt" size="854" author="rsjay1976" created="Sun, 16 Oct 2011 05:03:49 +0100"/>
                            <attachment id="12491029" name="classinfixture_Aug182011.txt" size="1938" author="rsjay1976" created="Sat, 20 Aug 2011 04:11:08 +0100"/>
                            <attachment id="12484417" name="derby-5300-1a-print_jdbc_client.diff" size="893" author="kristwaa" created="Tue, 28 Jun 2011 11:23:01 +0100"/>
                            <attachment id="12491030" name="svnstat-classinfixture.txt" size="854" author="rsjay1976" created="Sat, 20 Aug 2011 04:11:08 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 28 Jun 2011 10:23:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31587</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10423"><![CDATA[Newcomer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0em7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36186</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>