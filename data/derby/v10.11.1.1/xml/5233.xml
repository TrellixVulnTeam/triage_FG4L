<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:28:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5233/DERBY-5233.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5233] Interrupt of create table or index (i.e. a container) will throw XSDF1 under NIO - connection survives</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5233</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Cf the enclosed repro. It would be good to make Derby ignore the interrupt here. Cf &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4741&quot; title=&quot;Make embedded Derby work reliably in the presence of thread interrupts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4741&quot;&gt;&lt;del&gt;DERBY-4741&lt;/del&gt;&lt;/a&gt;. Note that this is less serious than in the cases referred to in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4741&quot; title=&quot;Make embedded Derby work reliably in the presence of thread interrupts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4741&quot;&gt;&lt;del&gt;DERBY-4741&lt;/del&gt;&lt;/a&gt;: here the database does not get shut down, even the connection survives, cf the repro. So, this can be considered a follow-up to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4741&quot; title=&quot;Make embedded Derby work reliably in the presence of thread interrupts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4741&quot;&gt;&lt;del&gt;DERBY-4741&lt;/del&gt;&lt;/a&gt; to further improve Derby&apos;s robustness under interrupts.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12507184">DERBY-5233</key>
            <summary>Interrupt of create table or index (i.e. a container) will throw XSDF1 under NIO - connection survives</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 May 2011 22:15:57 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:08 +0100</updated>
                            <resolved>Tue, 31 May 2011 17:04:02 +0100</resolved>
                                    <version>10.2.1.6</version>
                    <version>10.2.2.0</version>
                    <version>10.3.1.4</version>
                    <version>10.3.2.1</version>
                    <version>10.3.3.0</version>
                    <version>10.4.1.3</version>
                    <version>10.4.2.0</version>
                    <version>10.5.1.1</version>
                    <version>10.5.2.0</version>
                    <version>10.5.3.0</version>
                    <version>10.6.1.0</version>
                    <version>10.6.2.1</version>
                    <version>10.7.1.1</version>
                    <version>10.8.1.2</version>
                                    <fixVersion>10.8.2.2</fixVersion>
                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13035485" author="dagw" created="Wed, 18 May 2011 17:50:50 +0100"  >&lt;p&gt;Setting &quot;seen in production&quot; flag, cf. duplicated issue &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5237&quot; title=&quot;interrupting thread performing &amp;quot;create table&amp;quot; doesn&amp;#39;t cause SQLException with sql state &amp;quot;08000&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5237&quot;&gt;&lt;del&gt;DERBY-5237&lt;/del&gt;&lt;/a&gt; posted by a user.&lt;/p&gt;</comment>
                            <comment id="13041332" author="dagw" created="Tue, 31 May 2011 00:33:08 +0100"  >&lt;p&gt;Uploading a patch for this problem. I also adds a new test case to InterruptResilienceTest: testCreateDropInterrupted.&lt;/p&gt;

&lt;p&gt;The patch makes RAFContainer, when seeing an interrupt exception during container creation, close it down and try again, up to MAX_INTERRUPT_RETRIES times. Since RAFContainer should work also under CDC/Foundation 1.1, the exceptions are checked using reflection (NIO classes are excluded there).&lt;/p&gt;

&lt;p&gt;Running regressions.&lt;/p&gt;</comment>
                            <comment id="13041569" author="knutanders" created="Tue, 31 May 2011 14:26:27 +0100"  >&lt;p&gt;The patch looks fine to me. Two minor comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The use of the success flag feels a little backwards. Perhaps it would be clearer if we only set it to true if the operation has succeeded?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A comment in testInterruptShutdown() says &quot;Assert and clear thread&apos;s flag:&quot;, but the code just below the comment doesn&apos;t clear the flag anymore. (It is cleared further down, so only the comment needs to be updated.)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13041605" author="dagw" created="Tue, 31 May 2011 15:52:29 +0100"  >&lt;p&gt;a) I agree it is awkward, I was following a preexisting pattern - I&apos;ll change both. b) Yes, I already corrected one of those, I apparently missed one, thanks.&lt;/p&gt;</comment>
                            <comment id="13041614" author="dagw" created="Tue, 31 May 2011 16:07:41 +0100"  >&lt;p&gt;Thanks for looking at the patch, Knut! Re a) Actually, I think it gets less clear if I change it around: the normal case is that we&apos;ll not loop, indicated by the early setting of the success flag. Only exceptionally will we loop using a continue, so I think I prefer setting success = false there. I&apos;d rather burden the abnormal case with extra logic than the normal case. &lt;/p&gt;</comment>
                            <comment id="13041633" author="dagw" created="Tue, 31 May 2011 16:42:45 +0100"  >&lt;p&gt;Uploading version #2.&lt;/p&gt;</comment>
                            <comment id="13041636" author="dagw" created="Tue, 31 May 2011 16:46:06 +0100"  >&lt;p&gt;Committed as svn 1129764.&lt;/p&gt;</comment>
                            <comment id="13041641" author="dagw" created="Tue, 31 May 2011 17:03:24 +0100"  >&lt;p&gt;Backported to 10.8 branch as svn 1129769, resolving.&lt;/p&gt;</comment>
                            <comment id="13685139" author="knutanders" created="Mon, 17 Jun 2013 10:19:08 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12507530">DERBY-5237</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12469090">DERBY-4741</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12480878" name="DERBY-5233-1.diff" size="9076" author="dagw" created="Tue, 31 May 2011 00:33:07 +0100"/>
                            <attachment id="12480879" name="DERBY-5233-1.stat" size="175" author="dagw" created="Tue, 31 May 2011 00:33:08 +0100"/>
                            <attachment id="12480956" name="DERBY-5233-2.diff" size="9180" author="dagw" created="Tue, 31 May 2011 16:42:45 +0100"/>
                            <attachment id="12480957" name="DERBY-5233-2.stat" size="175" author="dagw" created="Tue, 31 May 2011 16:42:45 +0100"/>
                            <attachment id="12479181" name="Repro5233.java" size="1959" author="dagw" created="Fri, 13 May 2011 23:16:38 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10421"><![CDATA[Seen in production]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 31 May 2011 13:26:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24724</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0dvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36067</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>