<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:46:32 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4480/DERBY-4480.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4480] &quot;No suitable driver found&quot; when attempting to connect while other thread is auto-loading the driver</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4480</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If you try to connect to embedded Derby from two threads simultaneously, and the embedded driver has not been loaded yet, one of the threads will trigger auto-loading of the driver and connect successfully, whereas the other thread will fail with this message: java.sql.SQLException: No suitable driver found for jdbc:derby:db;create=true&lt;/p&gt;

&lt;p&gt;This problem has been present since JDBC 4 auto-loading was implemented (10.2.1.6).&lt;/p&gt;</description>
                <environment>OpenSolaris snv_129, X86&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_17-b04)&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.7.0-ea-b76)</environment>
        <key id="12443668">DERBY-4480</key>
            <summary>&quot;No suitable driver found&quot; when attempting to connect while other thread is auto-loading the driver</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                            <label>derby_triage10_8</label>
                    </labels>
                <created>Thu, 17 Dec 2009 17:51:28 +0000</created>
                <updated>Mon, 17 Jun 2013 10:27:20 +0100</updated>
                            <resolved>Wed, 6 Feb 2013 13:01:51 +0000</resolved>
                                    <version>10.2.1.6</version>
                    <version>10.2.2.0</version>
                    <version>10.3.1.4</version>
                    <version>10.3.2.1</version>
                    <version>10.3.3.0</version>
                    <version>10.4.1.3</version>
                    <version>10.4.2.0</version>
                    <version>10.5.1.1</version>
                    <version>10.5.2.0</version>
                    <version>10.5.3.0</version>
                    <version>10.6.1.0</version>
                                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12792027" author="knutanders" created="Thu, 17 Dec 2009 17:56:08 +0000"  >&lt;p&gt;Attached is a repro for the bug. It creates two threads that both try to connect to an embedded database. One of the threads successfully connects and the other thread fails to obtain a connection. Here&apos;s the output from the repro in my environment:&lt;/p&gt;

&lt;p&gt;Thread failed: java.sql.SQLException: No suitable driver found for jdbc:derby:db;create=true&lt;br/&gt;
Thread succeeded&lt;/p&gt;

&lt;p&gt;Expected output is:&lt;/p&gt;

&lt;p&gt;Thread succeeded&lt;br/&gt;
Thread succeeded&lt;/p&gt;</comment>
                            <comment id="13483214" author="knutanders" created="Wed, 24 Oct 2012 14:23:36 +0100"  >&lt;p&gt;This does not appear to be a problem on Java 7. Not sure exactly what has changed, but I tried the repro on both Java 6 and 7 now, and it only reproduced on 6. Doesn&apos;t reproduce on the early access builds of JDK 8 either.&lt;/p&gt;</comment>
                            <comment id="13483310" author="myrna" created="Wed, 24 Oct 2012 16:32:01 +0100"  >&lt;p&gt;This sounds like a jvm bug, then?&lt;br/&gt;
Also, did you run with classes or jars in the classpath? derbyrun.jar and/or derby.jar?&lt;/p&gt;</comment>
                            <comment id="13483349" author="knutanders" created="Wed, 24 Oct 2012 17:10:23 +0100"  >&lt;p&gt;I ran with jars, since auto-loading does not work when running from classes. I only had derby.jar in the classpath.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure if it&apos;s a JVM bug or if it&apos;s a problem in Derby&apos;s engine boot code that gets triggered by the way that version of the JVM invokes it. I&apos;ll try to pinpoint exactly what is causing it and what has changed. Should probably also add a regression test case too before closing the issue.&lt;/p&gt;</comment>
                            <comment id="13561496" author="knutanders" created="Thu, 24 Jan 2013 08:23:26 +0000"  >&lt;p&gt;This problem was fixed in OpenJDK as part of: &lt;a href=&quot;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7026898&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7026898&lt;/a&gt;&lt;br/&gt;
Code changes: &lt;a href=&quot;http://hg.openjdk.java.net/jdk7/jdk7/jdk/rev/df9991dc1f0d&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://hg.openjdk.java.net/jdk7/jdk7/jdk/rev/df9991dc1f0d&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Before said change, all of DriverManager&apos;s public static methods would call some initialization code. That initialization code was guarded by a boolean flag to make sure it only ran once. This worked fine for the methods that were synchronized. However, those methods that weren&apos;t synchronized (like getConnection()) could end up concluding that no initialization was necessary and go ahead, just because some other thread was about to start the initialization. For example, a call to getConnection() could go through the list of available drivers without initializing it first, which would result in the &quot;No suitable driver found&quot; exception reported in this issue.&lt;/p&gt;

&lt;p&gt;After the change, the initialization code lives in a static initializer which runs exactly once when the class is loaded, so the list of available drivers is always ready before getConnection() gets to run the first time.&lt;/p&gt;</comment>
                            <comment id="13561536" author="knutanders" created="Thu, 24 Jan 2013 10:12:38 +0000"  >&lt;p&gt;The attached patch adds a test case that verifies that concurrent autoloading of the Derby engine isn&apos;t a problem on Java 7 and newer.&lt;/p&gt;

&lt;p&gt;I intend to close this issue as invalid once the test case has been checked in.&lt;/p&gt;</comment>
                            <comment id="13562452" author="dagw" created="Fri, 25 Jan 2013 06:01:05 +0000"  >&lt;p&gt;Verified that the test case shows the error if run with Java 6. It also worked without error for my attempts with Java 7. +1&lt;/p&gt;</comment>
                            <comment id="13572384" author="knutanders" created="Wed, 6 Feb 2013 13:01:51 +0000"  >&lt;p&gt;Thanks, Dag. Committed revision 1442937.&lt;/p&gt;

&lt;p&gt;Resolving the bug as invalid, since it was not a Derby bug that caused the exception.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12428312" name="AutoloadTest.java" size="593" author="knutanders" created="Thu, 17 Dec 2009 17:56:08 +0000"/>
                            <attachment id="12566280" name="testcase.diff" size="4991" author="knutanders" created="Thu, 24 Jan 2013 10:12:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 24 Oct 2012 15:32:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18510</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0i7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10053"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>