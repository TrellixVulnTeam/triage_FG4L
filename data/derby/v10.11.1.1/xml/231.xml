<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:50:21 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-231/DERBY-231.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-231] &quot;FOR UPDATE&quot; required for updatable result set to work</title>
                <link>https://issues.apache.org/jira/browse/DERBY-231</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;To get an updatable result set, the JDBC 3.0 spec, section 14.2.4 &lt;br/&gt;
&quot;Modifying ResultSet Objects&quot; states: &lt;/p&gt;

&lt;p&gt;    &quot;ResultSet objects with concurrency CONCUR_UPDATABLE can be updated&lt;br/&gt;
     using ResultSet objects&quot;.&lt;/p&gt;

&lt;p&gt;In addition, Derby requires the SQL SELECT statement to have a &quot;FOR&lt;br/&gt;
UPDATE&quot; clause for updates to be allowed. This may be a usability issue, as&lt;br/&gt;
many examples, e.g. in &quot;JDBC API tutorial and reference and reference&quot;&lt;br/&gt;
book and the JDBC 3.0 Specification (14.2.4.1) do not include a &quot;FOR&lt;br/&gt;
UPDATE&quot; clause in the SQL SELECT.&lt;/p&gt;

&lt;p&gt;Mamta Satoor says:&lt;/p&gt;

&lt;p&gt;&quot;Derby implements the JDBC updatable resultset by using the existing&lt;br/&gt;
 updatable cursor implementation. And in order to do that, it requires&lt;br/&gt;
 that the SELECT statement should include the FOR UPDATE clause. One&lt;br/&gt;
 can change the Derby implementation so that it does not require FOR&lt;br/&gt;
 UPDATE clause to piggyback on updatable cursor implementation.&quot;&lt;/p&gt;

&lt;p&gt;Dan DeBrunner says:&lt;/p&gt;

&lt;p&gt;&quot;Technically I wonder if this is covered by the JDBC standard, I see&lt;br/&gt;
 nothing in the JDBC 3.0 that states any requirements for the SQL&lt;br/&gt;
 statement for an updateable result set. I know the JDBC tutorial book&lt;br/&gt;
 has some guidelines as to what will typically work, but isn&apos;t it up to&lt;br/&gt;
 the database engine to define what works here?&lt;/p&gt;

&lt;p&gt; Having said that I think that not requiring the FOR UPDATE would be a&lt;br/&gt;
 useful improvement.&quot;&lt;/p&gt;</description>
                <environment></environment>
        <key id="31853">DERBY-231</key>
            <summary>&quot;FOR UPDATE&quot; required for updatable result set to work</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="andreask">Andreas Korneliussen</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Apr 2005 22:11:26 +0100</created>
                <updated>Sun, 14 Feb 2010 16:05:44 +0000</updated>
                            <resolved>Sat, 12 Nov 2005 01:36:24 +0000</resolved>
                                    <version>10.0.2.1</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="63281" author="dagw" created="Wed, 20 Apr 2005 22:15:19 +0100"  >&lt;p&gt;Code provoking issue, and stack trace&lt;/p&gt;</comment>
                            <comment id="63549" author="erayl" created="Sat, 23 Apr 2005 10:09:58 +0100"  >&lt;p&gt;In testing MySQL 4.1, PostgreSQL 8.0, and Oracle 10g Release 1, all drivers for these databases function identically regardless whether the query string contains &quot;FOR UPDATE&quot; or not. For source code compatibility with other databases, the current requirement should be lifted.&lt;/p&gt;</comment>
                            <comment id="12319649" author="rhillegas" created="Tue, 23 Aug 2005 08:10:52 +0100"  >&lt;p&gt;I&apos;m a little confused about why Derby allows a FOR UPDATE clause on naked SELECT statements. I would appreciate a pointer to where the SQL 2003 spec supports this syntax. This is my reading of the SQL 2003 spec:&lt;/p&gt;

&lt;p&gt;The SELECT statement is defined in Volume 2, section 7.12 of the SQL 2003 spec in the &amp;lt;query specification&amp;gt; production. This production does not allow a FOR UPDATE clause.&lt;/p&gt;

&lt;p&gt;The FOR UPDATE clause (the &amp;lt;updatability clause&amp;gt; production) is defined inside section 14.1 of the same spec, the &amp;lt;declare cursor&amp;gt; production. Looking through the index, it appears that an &amp;lt;updatability clause&amp;gt; is only legal in the context of a cursor.&lt;/p&gt;

&lt;p&gt;I recommend removing this non-standard syntax from naked SELECT statements which are not embedded in cursors.&lt;/p&gt;

&lt;p&gt;Perhaps what gave rise to this confusion is the jargon in the comments of Derby&apos;s language layer. In that jargon, a ResultSet is sometimes called a cursor. This is a useful way to look at a ResultSet but if you press the term too far, you blur the distinction between &amp;lt;query specification&amp;gt; and &amp;lt;declare cursor&amp;gt;.&lt;/p&gt;</comment>
                            <comment id="12319651" author="djd" created="Tue, 23 Aug 2005 08:27:34 +0100"  >&lt;p&gt;The FOR UPDATE support is probably more from a &apos;de-facto&apos; standard than the SQL spec. Most, if not all, other databases support  a FOR UPDATE on a SELECT statement. It is heavily used by application servers (e.g. EJB implementations). Removing it would affect a lot of existing applications.&lt;/p&gt;</comment>
                            <comment id="12319655" author="forsini" created="Tue, 23 Aug 2005 08:57:19 +0100"  >&lt;p&gt;Yes, quite a few RDBMS allow for SELECT FOR UPDATE without the use of explicit SQL Cursor...in fact, it was a recommended by Oracle a few years ago as this last one did not have &quot;true&quot; support for serializable isolation level...&lt;/p&gt;</comment>
                            <comment id="12319792" author="rhillegas" created="Wed, 24 Aug 2005 06:56:53 +0100"  >&lt;p&gt;Roy Lyseng has traced the tortuous path through the SQL spec which allows this syntax:&lt;/p&gt;

&lt;p&gt;part 3 - &quot;Call level interface&quot; chapter 6.50 Prepare, says that the statement text can (among other things) be a &amp;lt;dynamic select statement&amp;gt; which is defined in part 5 - &quot;Host language bindings&quot; chapter 15.6 Prepare statement as a &amp;lt;cursor specification&amp;gt;, which is defined in part 2 &quot;Foundation&quot;, chapter 14.1 Declare cursor as:&lt;/p&gt;

&lt;p&gt;&amp;lt;cursor specification&amp;gt; ::=&lt;br/&gt;
  &amp;lt;query expression&amp;gt; [ &amp;lt;order by clause&amp;gt; ] [ &amp;lt;updatability clause&amp;gt; ]&lt;/p&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;p&gt;&amp;lt;updatability clause&amp;gt; ::=&lt;br/&gt;
  FOR &lt;/p&gt;
{ READ ONLY | UPDATE [OF &amp;lt;column name list&amp;gt; ] }
&lt;p&gt; &lt;/p&gt;</comment>
                            <comment id="12356096" author="andreask" created="Fri, 28 Oct 2005 01:48:15 +0100"  >&lt;p&gt;Currently, the updatemode for the resultset node is determined in the bind() phase of the query compilation. If the updatability clause is unspecified, the updatemode is set to READ_ONLY.&lt;/p&gt;

&lt;p&gt;To get rid of the requirement of having &quot;for update&quot; in the query string, I plan doing the following :&lt;/p&gt;

&lt;p&gt;1. In the bind() phase, the nodes do currently not have any information about the concurrency mode for the java.sql.Statement object.  I would like to provide a mechanism to bring it down to the compiler by adding a field to the StatementContext object.&lt;/p&gt;

&lt;p&gt;2. If the concurrency mode for the java.sql.Statement object is CONCUR_READ_ONLY, the updatemode will be set to READ_ONLY. If the query string contains &quot;for update&quot; an error will be thrown.&lt;/p&gt;

&lt;p&gt;3. If the concurrency mode for the Statement object is CONCUR_UPDATABLE, the updatemode will be UPDATABLE if the resultset can be updatable (i.e contains no joins, order by etc). Otherwise it will be READ_ONLY and a warning will be given. &lt;/p&gt;

&lt;p&gt;4. Lockmodes: I do not plan to make any distinction between &quot;for update&quot; and unspecified updatability clause when it comes to determining the lock mode.&lt;/p&gt;

&lt;p&gt;It seems important that the update mode is determined in the bind() phase, because the compiler can do some optimizations if the cursor is not updatable (i.e not produce a target resultset).&lt;/p&gt;</comment>
                            <comment id="12356621" author="andreask" created="Thu, 3 Nov 2005 01:08:40 +0000"  >&lt;p&gt;The attached files contain a patch for providing this feature. It includes update of the lang/updatableResultSet.java test for testing updatable resultset,&lt;br/&gt;
and it has been modified to also support updatable resultsets where &quot;for update&quot; is not part of the statement. Please review the changes.&lt;/p&gt;</comment>
                            <comment id="12357033" author="andreask" created="Tue, 8 Nov 2005 21:01:57 +0000"  >&lt;p&gt;The update includes a new comment in CursorNode.java, regarding SQL compliance, and it also includes new tests for positioned updates and postioned deletes on queries not including &quot;FOR UPDATE&quot;.&lt;/p&gt;</comment>
                            <comment id="12371262" author="dagw" created="Wed, 22 Mar 2006 01:20:29 +0000"  >&lt;p&gt;Is part of trunk and is tested as part of regression tests.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12348792">DERBY-1773</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12320543" name="DERBY-231.diff" size="182687" author="andreask" created="Tue, 8 Nov 2005 21:01:57 +0000"/>
                            <attachment id="12320544" name="DERBY-231.stat" size="1551" author="andreask" created="Tue, 8 Nov 2005 21:01:57 +0000"/>
                            <attachment id="19698" name="fff" size="2662" author="dagw" created="Wed, 20 Apr 2005 22:15:19 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 23 Apr 2005 09:09:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29447</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0r4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38212</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>