<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:08:38 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6206/DERBY-6206.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6206] Cleanup suspect coding practices in misc Derby packages</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6206</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6177&quot; title=&quot;Cleanup suspect coding practices in org.apache.derby.catalog.types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6177&quot;&gt;&lt;del&gt;DERBY-6177&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12644618">DERBY-6206</key>
            <summary>Cleanup suspect coding practices in misc Derby packages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                            <label>derby_backport_reject_10_10</label>
                    </labels>
                <created>Thu, 25 Apr 2013 16:28:23 +0100</created>
                <updated>Tue, 9 Jul 2013 00:34:12 +0100</updated>
                            <resolved>Mon, 20 May 2013 13:34:29 +0100</resolved>
                                    <version>10.11.1.1</version>
                                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13641972" author="rhillegas" created="Thu, 25 Apr 2013 18:25:21 +0100"  >&lt;p&gt;Attaching derby-6206-01-aa-NetworkServerControlImpl.diff. This patch reduces the visibility of some fields in NetworkServerControlImpl. I am running tests now.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M       java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java&lt;br/&gt;
M       java/drda/org/apache/derby/impl/drda/DRDAConnThread.java&lt;br/&gt;
M       java/drda/org/apache/derby/impl/drda/DDMReader.java&lt;br/&gt;
M       java/drda/org/apache/derby/drda/NetworkServerControl.java&lt;/p&gt;</comment>
                            <comment id="13642114" author="rhillegas" created="Thu, 25 Apr 2013 20:27:31 +0100"  >&lt;p&gt;Tests passed cleanly for me on derby-6206-01-aa-NetworkServerControlImpl.diff. Committed at subversion revision 1475919.&lt;/p&gt;</comment>
                            <comment id="13642940" author="rhillegas" created="Fri, 26 Apr 2013 16:10:21 +0100"  >&lt;p&gt;Attaching derby-6206-02-aa-ExecutionContext.diff. This patch improves the encapsulation of the constants and string names for transaction isolation levels. I am running tests now.&lt;/p&gt;

&lt;p&gt;The patch moves the constants and their names from the ExecutionContext interface to the TransactionControl class. Moving them to a class makes it possible to retrieve values in a safe way with accessor methods.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;--------------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/iapi/sql/execute/ExecutionContext.java&lt;br/&gt;
M       java/engine/org/apache/derby/iapi/transaction/TransactionControl.java&lt;/p&gt;

&lt;p&gt;The substance of the patch.&lt;/p&gt;

&lt;p&gt;--------------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/iapi/sql/conn/LanguageConnectionContext.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/GenericStatement.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/compile/CompilerContextImpl.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/compile/FromVTI.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/compile/FromBaseTable.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/conn/GenericLanguageConnectionContext.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/ScanResultSet.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/DMLWriteResultSet.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/RowChangerImpl.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/VTIResultSet.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/jdbc/EmbedConnection.java&lt;br/&gt;
M       java/drda/org/apache/derby/impl/drda/DRDAStatement.java&lt;/p&gt;

&lt;p&gt;Corresponding changes to classes which reference the constants and their string names.&lt;/p&gt;</comment>
                            <comment id="13643026" author="rhillegas" created="Fri, 26 Apr 2013 18:00:02 +0100"  >&lt;p&gt;Tests passed cleanly for me on derby-6206-02-aa-ExecutionContext.diff. Committed at subversion revision 1476291.&lt;/p&gt;</comment>
                            <comment id="13643032" author="rhillegas" created="Fri, 26 Apr 2013 18:07:22 +0100"  >&lt;p&gt;Attaching derby-6206-03-aa-XPLAIN.diff. This patch clones Timestamps (mutable objects) in order to protect them in the construction of XPLAIN statistics. I am running tests now.&lt;/p&gt;

&lt;p&gt;This cloning should happen at most once per execution of a statement and only if XPLAIN statistics have been enabled.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;--------------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/sql/catalog/XPLAINStatementTimingsDescriptor.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/catalog/XPLAINStatementDescriptor.java&lt;/p&gt;</comment>
                            <comment id="13643149" author="rhillegas" created="Fri, 26 Apr 2013 20:14:12 +0100"  >&lt;p&gt;Tests passed cleanly for me on derby-6206-03-aa-XPLAIN.diff. I believe that this patch is checked in now, although my checkin attempt timed out before reporting a subversion timestamp. A later &quot;svn update&quot; showed me current at revision 1476346.&lt;/p&gt;</comment>
                            <comment id="13643832" author="rhillegas" created="Sun, 28 Apr 2013 00:24:08 +0100"  >&lt;p&gt;Attaching derby-6206-04-aa-implJDBC.diff. This patch cleans up some mutability issues in the org.apache.derby.impl.jdbc package. I will run tests.&lt;/p&gt;

&lt;p&gt;The following changes are made:&lt;/p&gt;

&lt;p&gt;1) Hide a globally visible field which was used to test the large update counts introduced by JDBC 4.2. The field is made private and given a globally visible set method. The set method is a NOP in insane builds and the test is changed to only run on debug jars.&lt;/p&gt;

&lt;p&gt;2) Copy the column descriptors which are passed to the constructor of the embedded ResultSetMetaData class. This copying only happens when you make a ResultSetMetaData object.&lt;/p&gt;

&lt;p&gt;3) Copy the argument array when you ask an embedded SQLException for its arguments.&lt;/p&gt;



&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;--------------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/sql/execute/DMLWriteResultSet.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/RowUtil.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/jdbc/EmbedResultSet.java&lt;br/&gt;
M       java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/StatementTest.java&lt;br/&gt;
M       java/client/org/apache/derby/client/am/ClientStatement.java&lt;/p&gt;

&lt;p&gt;Changes for (1).&lt;/p&gt;

&lt;p&gt;--------------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/jdbc/EmbedResultSetMetaData.java&lt;/p&gt;

&lt;p&gt;Changes for (2).&lt;/p&gt;

&lt;p&gt;--------------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/jdbc/EmbedSQLException.java&lt;/p&gt;

&lt;p&gt;Changes for (3).&lt;/p&gt;</comment>
                            <comment id="13644063" author="rhillegas" created="Sun, 28 Apr 2013 18:23:46 +0100"  >&lt;p&gt;Attaching derby-6206-04-ab-implJDBC.diff. The previous rev of the patch passed tests on both sane and insane builds except for errors in PreparedStatementTest on the insane build. Those errors were caused by the fact that the large-update-count-stuffing method is a NOP on insane builds. The revised patch makes the failing tests only run on sane builds.&lt;/p&gt;

&lt;p&gt;Touches the following additional file:&lt;/p&gt;

&lt;p&gt;M       java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/PreparedStatementTest.java&lt;/p&gt;</comment>
                            <comment id="13644444" author="rhillegas" created="Mon, 29 Apr 2013 13:18:28 +0100"  >&lt;p&gt;Tests passed cleanly for me on derby-6206-04-ab-implJDBC.diff against both sane and insane builds. Committed at revision 1476983.&lt;/p&gt;</comment>
                            <comment id="13644590" author="rhillegas" created="Mon, 29 Apr 2013 16:48:06 +0100"  >&lt;p&gt;Attaching derby-6206-05-aa-implSQL.diff. This patch fixes some mutability problems in the org.apache.derby.impl.sql package. I am running tests now.&lt;/p&gt;

&lt;p&gt;Two types of problems are addressed in GenericResultDescription and GenericPreparedStatement:&lt;/p&gt;

&lt;p&gt;1) Mutable Timestamps are copied. This copying occurs once per statement execution.&lt;/p&gt;

&lt;p&gt;2) Arrays of parameter and column types are copied. New type getters are introduced which return a single type rather than the whole array. The new getters are used when the type is retrieved more than once per statement execution.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/iapi/sql/ResultDescription.java&lt;br/&gt;
M       java/engine/org/apache/derby/iapi/sql/PreparedStatement.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/GenericResultDescription.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/GenericAggregator.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/GenericPreparedStatement.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/jdbc/EmbedPreparedStatement.java&lt;/p&gt;</comment>
                            <comment id="13644671" author="rhillegas" created="Mon, 29 Apr 2013 18:34:05 +0100"  >&lt;p&gt;Tests passed cleanly for me on derby-6206-05-aa-implSQL.diff. Committed at subversion revision 1477222.&lt;/p&gt;</comment>
                            <comment id="13644684" author="rhillegas" created="Mon, 29 Apr 2013 18:52:44 +0100"  >&lt;p&gt;Attaching derby-6206-06-aa-GenericResultDescription.diff. This patch cleans up another mutability problem, copying an array when a GenericResultDescription is created. This copying will be done only when GenericResultDescriptions are created. That is, when setting up for the execution of a statement. I will run tests.&lt;/p&gt;

&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/sql/GenericResultDescription.java&lt;/p&gt;</comment>
                            <comment id="13644827" author="rhillegas" created="Mon, 29 Apr 2013 21:28:06 +0100"  >&lt;p&gt;Tests passed cleanly for me on derby-6206-06-aa-GenericResultDescription.diff.  Committed at subversion revision 1477320.&lt;/p&gt;</comment>
                            <comment id="13645618" author="rhillegas" created="Tue, 30 Apr 2013 15:24:16 +0100"  >&lt;p&gt;Attaching derby-6206-07-aa-BaseActivation.diff. This patch fixes some mutability problems in BaseActivation. I am running tests now.&lt;/p&gt;

&lt;p&gt;Two changes are made:&lt;/p&gt;

&lt;p&gt;1) A method which used to return a mutable Hashtable now just returns an enumeration through its keys. It turns out that the callers only needed the keys.&lt;/p&gt;

&lt;p&gt;2) Some arrays are copied. This copying happens during the initialization phase of statement execution, not on the inner looping through rows.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/iapi/sql/Activation.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/DeleteCascadeResultSet.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/GenericActivationHolder.java&lt;/p&gt;

&lt;p&gt;Changes for (1).&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/sql/execute/InsertResultSet.java&lt;/p&gt;

&lt;p&gt;Cleanup to avoid materializing redundant copies of copies.&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/sql/execute/BaseActivation.java&lt;/p&gt;

&lt;p&gt;Changes for (1) and (2).&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/jdbc/EmbedStatement.java&lt;/p&gt;

&lt;p&gt;Changes for (2).&lt;/p&gt;</comment>
                            <comment id="13645690" author="rhillegas" created="Tue, 30 Apr 2013 17:18:10 +0100"  >&lt;p&gt;Tests passed cleanly for me on derby-6206-07-aa-BaseActivation.diff. Committed at subversion revision 1477711.&lt;/p&gt;</comment>
                            <comment id="13661755" author="dagw" created="Mon, 20 May 2013 04:52:31 +0100"  >&lt;p&gt;Can this issue be resolved or do you anticipate more changes?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12580553" name="derby-6206-01-aa-NetworkServerControlImpl.diff" size="10394" author="rhillegas" created="Thu, 25 Apr 2013 18:25:21 +0100"/>
                            <attachment id="12580711" name="derby-6206-02-aa-ExecutionContext.diff" size="28875" author="rhillegas" created="Fri, 26 Apr 2013 16:10:21 +0100"/>
                            <attachment id="12580719" name="derby-6206-03-aa-XPLAIN.diff" size="2500" author="rhillegas" created="Fri, 26 Apr 2013 18:07:22 +0100"/>
                            <attachment id="12580857" name="derby-6206-04-aa-implJDBC.diff" size="9047" author="rhillegas" created="Sun, 28 Apr 2013 00:24:08 +0100"/>
                            <attachment id="12580893" name="derby-6206-04-ab-implJDBC.diff" size="10086" author="rhillegas" created="Sun, 28 Apr 2013 18:23:46 +0100"/>
                            <attachment id="12580979" name="derby-6206-05-aa-implSQL.diff" size="8299" author="rhillegas" created="Mon, 29 Apr 2013 16:48:06 +0100"/>
                            <attachment id="12580995" name="derby-6206-06-aa-GenericResultDescription.diff" size="585" author="rhillegas" created="Mon, 29 Apr 2013 18:52:44 +0100"/>
                            <attachment id="12581160" name="derby-6206-07-aa-BaseActivation.diff" size="6802" author="rhillegas" created="Tue, 30 Apr 2013 15:24:16 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 20 May 2013 03:52:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>324983</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzdx2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>325328</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>