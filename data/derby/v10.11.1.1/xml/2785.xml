<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:53:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2785/DERBY-2785.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2785] ij &quot;describe&quot; built in command cannot describe a table named &quot;run&quot;</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2785</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;steps to duplicate:&lt;/p&gt;

&lt;p&gt;(attach ij to any database)&lt;/p&gt;

&lt;p&gt;ij&amp;gt; create table run (i int);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; desc run;&lt;br/&gt;
ERROR 42X01: Syntax error: Encountered &quot;desc&quot; at line 1, column 1.&lt;br/&gt;
ij&amp;gt; &lt;/p&gt;

&lt;p&gt;I think this is a parser problem within ij where the &quot;run&quot; is taken as a token and that token is not included in the definition of a tablename expression in the grammer (should be an easy fix).&lt;/p&gt;</description>
                <environment>OS-X, Java 1.5</environment>
        <key id="12371213">DERBY-2785</key>
            <summary>ij &quot;describe&quot; built in command cannot describe a table named &quot;run&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eranda">Eranda Sooriyabandara</assignee>
                                    <reporter username="hallorant">Tim Halloran</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Jun 2007 03:22:33 +0100</created>
                <updated>Mon, 29 Nov 2010 14:23:25 +0000</updated>
                            <resolved>Sun, 27 Jun 2010 23:06:04 +0100</resolved>
                                    <version>10.2.2.0</version>
                                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12502611" author="hallorant" created="Fri, 8 Jun 2007 03:24:47 +0100"  >&lt;p&gt;upps the steps should be:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; create table run (i int);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; describe run;      &lt;br/&gt;
ERROR 42X01: Syntax error: Encountered &quot;describe&quot; at line 1, column 1.&lt;/p&gt;

&lt;p&gt;I always type &quot;desc&quot; rather than &quot;describe&quot; (ye olde Oracle habit &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12648292" author="kmarsden" created="Mon, 17 Nov 2008 19:55:25 +0000"  >&lt;p&gt;Sandeep, are you still working on this issue? If not can you unassign yourself?&lt;/p&gt;</comment>
                            <comment id="12706977" author="kmarsden" created="Thu, 7 May 2009 17:32:03 +0100"  >&lt;p&gt;Unassigning due to inactivity.&lt;/p&gt;</comment>
                            <comment id="12727655" author="rhillegas" created="Mon, 6 Jul 2009 19:04:19 +0100"  >&lt;p&gt;Triaged for 10.5.2: noted that repro is available, recommended to newcomers.&lt;/p&gt;</comment>
                            <comment id="12778737" author="bryanpendleton" created="Tue, 17 Nov 2009 05:50:26 +0000"  >&lt;p&gt;As a workaround,&lt;/p&gt;

&lt;p&gt;   describe &apos;RUN&apos;;&lt;/p&gt;

&lt;p&gt;appears to work as desired.&lt;/p&gt;</comment>
                            <comment id="12846479" author="eranda" created="Wed, 17 Mar 2010 17:15:30 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I step to the code and found out that RUN is a ij keyword . (ij.java line 3398). But somehow it  skipped when executing the create table run(a int);. What can we do for this? Also I like to know where is this RUN keyword used? Do we want to remove it or can we restrict creating a table named run?&lt;/p&gt;</comment>
                            <comment id="12846800" author="sleroux" created="Thu, 18 Mar 2010 09:12:46 +0000"  >&lt;p&gt;Hi Eranda,&lt;/p&gt;

&lt;p&gt;&apos;RUN&apos; is a keyword used by ij.&lt;br/&gt;
&lt;a href=&quot;http://db.apache.org/derby/papers/DerbyTut/ij_intro.html#Run+SQL+Scripts&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.apache.org/derby/papers/DerbyTut/ij_intro.html#Run+SQL+Scripts&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The problem here is that if, in ij, you type a command like &apos;DESCRIBE RUN&apos;, the word RUN is recognized  by the JavaCC tokenizer as a keyword. Not an identifier.&lt;/p&gt;

&lt;p&gt;You might have to check - but it could be exactly the same for any other table having a keyword for name. It is even quite possible, each time we add a new keyword in ij, things are going worst!&lt;/p&gt;

&lt;p&gt;One option could be to change the identifier() production to accept keywords. But, this require a closer look, since by doing so, we might introduce ambiguities in the grammar.&lt;/p&gt;

&lt;p&gt;Hope this helps,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Sylvain&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12846832" author="knutanders" created="Thu, 18 Mar 2010 10:41:00 +0000"  >&lt;p&gt;I think what Sylvain said above is correct. Also, the reason why &quot;create table run(a int)&quot; does not fail, is that everything that does not match ij&apos;s grammar, is believed to be SQL and passed on to the JDBC driver as it is. That&apos;s the same thing that&apos;s happens with &quot;describe run&quot;, by the way. It is not recognized as an ij command, so it&apos;s executed as an SQL statement instead, and fails because Derby&apos;s SQL does not support DESCRIBE statements.&lt;/p&gt;</comment>
                            <comment id="12847039" author="eranda" created="Thu, 18 Mar 2010 18:16:57 +0000"  >&lt;p&gt;Hi Sylvain, Knut,&lt;br/&gt;
When executing the &quot;describe run&quot;, the error occurs before parse to JDBC. It resolve there and when it executing the run because the run is a keyword, it add a error token except the run. &lt;br/&gt;
This happens when the executing ij.jj_rescan_token() method line 8103.&lt;br/&gt;
That&apos;s how I understood. &lt;br/&gt;
I am I still in the wrong path??&lt;/p&gt;</comment>
                            <comment id="12847777" author="bryanpendleton" created="Sat, 20 Mar 2010 16:18:28 +0000"  >&lt;p&gt;Hi Eranda,&lt;br/&gt;
What is the full stack trace when the &quot;describe run&quot; error is generated?&lt;/p&gt;</comment>
                            <comment id="12847922" author="eranda" created="Sun, 21 Mar 2010 13:41:22 +0000"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
I compare describe statement for the tables &quot;run&quot; and &quot;t1&quot; (a normal table). &lt;br/&gt;
Up to runScriptGuts() method in utilMain class both are executed in same manner according to the stack trace. So I step into code after that method. The main difference of executing these two table was in the line 341 in utilMain class &quot;describe run&quot; statement throws an exception. Here I am attaching the step log up to throw the exception. (I thought it will more helpful than stack trace).&lt;br/&gt;
thanks&lt;/p&gt;</comment>
                            <comment id="12849035" author="bryanpendleton" created="Wed, 24 Mar 2010 03:27:26 +0000"  >&lt;p&gt;Hi Eranda,&lt;/p&gt;

&lt;p&gt;Here is a diff with an idea that might be worth pursuing. It changes the&lt;br/&gt;
behavior of the DESCRIBE statement so that, in addition to the identifier&lt;br/&gt;
or quoted string that it could take before, it now can also take a keyword,&lt;br/&gt;
which it then upper-cases and tries to use as a table name.&lt;/p&gt;

&lt;p&gt;The patch isn&apos;t elegant, but it seems to make &apos;DESCRIBE RUN&apos; work to&lt;br/&gt;
describe a table named &apos;run&apos;.&lt;/p&gt;

&lt;p&gt;If you think this idea has merit, then the next step, I think, would be to&lt;br/&gt;
do some more testing, and turn this simple diff into a complete patch&lt;br/&gt;
by adding a variety of test cases which show how the new code behaves.&lt;/p&gt;

&lt;p&gt;Also, I think some additional work would be needed to be able to describe&lt;br/&gt;
a table with the same name as an ij keyword, but in a non-default schema&lt;br/&gt;
(as in &apos;DESCRIBE bryan.run&apos; to describe the table named &apos;run&apos; in the schema&lt;br/&gt;
named &apos;bryan&apos;).&lt;/p&gt;

&lt;p&gt;Let me know what you think of this idea.&lt;/p&gt;</comment>
                            <comment id="12849096" author="knutanders" created="Wed, 24 Mar 2010 08:08:06 +0000"  >&lt;p&gt;Hi Bryan,&lt;/p&gt;

&lt;p&gt;The patch seems to have been generated against a fairly old copy of trunk, and it does not apply cleanly because of the changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4430&quot; title=&quot;Make ij&amp;#39;s SHOW and DESCRIBE commands more db agnostic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4430&quot;&gt;&lt;del&gt;DERBY-4430&lt;/del&gt;&lt;/a&gt;. Also, in the spirit of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4430&quot; title=&quot;Make ij&amp;#39;s SHOW and DESCRIBE commands more db agnostic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4430&quot;&gt;&lt;del&gt;DERBY-4430&lt;/del&gt;&lt;/a&gt;, we may want to check the meta-data for the underlying DBMS instead of unconditionally converting the keyword to upper case, see the caIdentifier() method introduced in that issue.&lt;/p&gt;

&lt;p&gt;Perhaps it&apos;s even safe to add keywords to caIdentifier(). It&apos;s not used many places, so it shouldn&apos;t be too much work to go through its usages and check if adding keywords to it would introduce any ambiguities in the grammar. The advantage of adding it to caIdentifier() is that it will then also work for other ij commands than DESCRIBE. For instance, &quot;show indexes from run&quot; would start working.&lt;/p&gt;</comment>
                            <comment id="12849205" author="bryanpendleton" created="Wed, 24 Mar 2010 14:41:21 +0000"  >&lt;p&gt;Thanks for catching my old client, Knut Anders; I was indeed quite out of date.&lt;/p&gt;

&lt;p&gt;I think the suggestion to add keywords to caIdentifier() is a good one; Eranda,&lt;br/&gt;
do you want to give that a try?&lt;/p&gt;</comment>
                            <comment id="12849249" author="eranda" created="Wed, 24 Mar 2010 16:10:32 +0000"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Yes I am quite happy to try on it.&lt;br/&gt;
Thanks&lt;br/&gt;
Eranda&lt;/p&gt;

</comment>
                            <comment id="12850566" author="eranda" created="Sat, 27 Mar 2010 19:32:17 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I tried to add the keyword to caIndetifier() but when the table name is a keyword for example &quot;RUN&quot; caIdentifier() does not called. So can&apos;t use keywords inside of caIdentifier(). So I use your method to fix it. It works properly in my machine. Need a feedback before proceeding  to test for ambiguities in the grammar.&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="12850596" author="bryanpendleton" created="Sat, 27 Mar 2010 22:31:49 +0000"  >&lt;p&gt;Can you post the change that you tried in caIdentifier?&lt;/p&gt;</comment>
                            <comment id="12850667" author="eranda" created="Sun, 28 Mar 2010 13:37:47 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
I fix the problem which I missed parenthesis. Also I did some basic tests and they passed.&lt;br/&gt;
Here I am attaching the patch file. Also I can create test which runs on ij. Can you clarify which tests do I need to include there.  &lt;br/&gt;
Thanks&lt;br/&gt;
Eranda&lt;/p&gt;</comment>
                            <comment id="12850711" author="bryanpendleton" created="Sun, 28 Mar 2010 19:34:27 +0100"  >&lt;p&gt;Hi Eranda,&lt;/p&gt;

&lt;p&gt;I think your change to caIdentifier is working. Perhaps you had a build&lt;br/&gt;
problem when you tried it? I tried your change and it seemed to work&lt;br/&gt;
for me.&lt;/p&gt;

&lt;p&gt;I modified the patch slightly, to fix the indentation, and to make sure&lt;br/&gt;
that the checks for DatabaseMetadata were done for both the keyword&lt;br/&gt;
and identifier cases, and have attached the revised patch as&lt;br/&gt;
caidentifier.diff.&lt;/p&gt;

&lt;p&gt;Please try applying this patch and see if it works for you.&lt;/p&gt;</comment>
                            <comment id="12850938" author="eranda" created="Mon, 29 Mar 2010 15:57:22 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Yes it works with me perfectly. Thanks for the changes. &lt;br/&gt;
What about the test??&lt;/p&gt;</comment>
                            <comment id="12851215" author="bryanpendleton" created="Tue, 30 Mar 2010 03:05:22 +0100"  >&lt;p&gt;Hi Eranda, Glad to hear the change is working for you too.&lt;/p&gt;

&lt;p&gt;I think that, to start with, we should have tests for DESCRIBE and for&lt;br/&gt;
SHOW, with both table names and schema names using keywords.&lt;/p&gt;

&lt;p&gt;So, how about:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;describe run&lt;/li&gt;
	&lt;li&gt;show indexes from run&lt;/li&gt;
	&lt;li&gt;describe nohold.execute&lt;/li&gt;
	&lt;li&gt;show views in nohold&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If you think of other tests along these lines, that would be great,&lt;br/&gt;
but this would be a fine start to add to the test suites.&lt;/p&gt;

&lt;p&gt;Have you run any of the existing test suites with the modified parser?&lt;/p&gt;</comment>
                            <comment id="12861833" author="eranda" created="Wed, 28 Apr 2010 16:44:24 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
I did derbyall test and saw that there are few errors. But I didn&apos;t think that they are related to my changes. Here I am attaching the test report file.&lt;br/&gt;
What you think?&lt;/p&gt;</comment>
                            <comment id="12862209" author="bryanpendleton" created="Thu, 29 Apr 2010 15:19:13 +0100"  >&lt;p&gt;It looks like maybe you ran the derbyall tests in a &quot;dirty&quot; directory; that is,&lt;br/&gt;
a directory in which you had previously been running Derby tests?&lt;/p&gt;

&lt;p&gt;If you run the derbyall tests again, with your classpath containing your&lt;br/&gt;
modified code, but the current directory set to a brand-new test directory,&lt;br/&gt;
are your test results any better?&lt;/p&gt;

&lt;p&gt;You can also run the junit tests, in addition to the derbyall tests.&lt;/p&gt;

&lt;p&gt;Here&apos;s the command I use to run all the tests, after I first &apos;cd&apos; into a brand&lt;br/&gt;
new test directory, with my CLASSPATH all set up:&lt;/p&gt;

&lt;p&gt;java org.apache.derbyTesting.functionTests.harness.RunSuite derbyall; java -Xmx512m -XX:MaxPermSize=128m junit.textui.TestRunner org.apache.derbyTesting.functionTests.suites.All &amp;gt;junitAll.out 2&amp;gt;&amp;amp;1&lt;/p&gt;</comment>
                            <comment id="12880480" author="eranda" created="Sat, 19 Jun 2010 14:01:49 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Here I am attaching the results I got after doing derbyall test and JUnit tests. There are some exceptions thrown in JUnit tests. I am looking forward to see what they are and inform you soon.&lt;/p&gt;</comment>
                            <comment id="12880510" author="bryanpendleton" created="Sat, 19 Jun 2010 17:46:43 +0100"  >&lt;p&gt;Hi Eranda,&lt;/p&gt;

&lt;p&gt;I am not sure why the BootLock test is failing for you. It is a new test in mainline,&lt;br/&gt;
and I&apos;m not completely familiar with it. It looks like the code in the test:&lt;/p&gt;

&lt;p&gt;            int port = TestConfiguration.getCurrent().getPort();&lt;br/&gt;
            cmd&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; = (new Integer(port)).toString();&lt;/p&gt;

&lt;p&gt;computed an input string of &quot;&quot; for your port number, since the error was:&lt;/p&gt;

&lt;p&gt;   Exception in thread &quot;main&quot; java.lang.NumberFormatException: For input string: &quot;&quot;&lt;/p&gt;

&lt;p&gt;Maybe somebody who is familiar with BootLockTest can spot why it couldn&apos;t&lt;br/&gt;
figure out your port number.&lt;/p&gt;

&lt;p&gt;The failures in ij7 test look like they could be related to your patch; the output&lt;br/&gt;
contains: JAVA ERROR: java.lang.NullPointerException&lt;/p&gt;

&lt;p&gt;Somewhere in a subdirectory of the place where you ran your junit tests there&lt;br/&gt;
should be some output files which recorded the results of the run of the ij7&lt;br/&gt;
tests, and in those files you should be able to find the complete stack trace.&lt;/p&gt;

&lt;p&gt;Try running something like:&lt;/p&gt;

&lt;p&gt;  find . -exec grep NullPointerException {} \; -print&lt;/p&gt;

&lt;p&gt;in the location where you ran your junit tests, and see if the file turns up.&lt;/p&gt;
</comment>
                            <comment id="12880514" author="eranda" created="Sat, 19 Jun 2010 18:36:38 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Here I found that this exception occurs with the presence of the single quotations with table name&lt;/p&gt;

&lt;p&gt;ij&amp;gt; DESCRIBE APP.t1;&lt;br/&gt;
COLUMN_NAME         |TYPE_NAME|DEC&amp;amp;|NUM&amp;amp;|COLUM&amp;amp;|COLUMN_DEF|CHAR_OCTE&amp;amp;|IS_NULL&amp;amp;&lt;br/&gt;
------------------------------------------------------------------------------&lt;br/&gt;
I                   |INTEGER  |0   |10  |10    |AUTOINCRE&amp;amp;|NULL      |NO      &lt;br/&gt;
D                   |DECIMAL  |2   |10  |5     |NULL      |NULL      |YES     &lt;br/&gt;
TEST                |VARCHAR  |NULL|NULL|20    |NULL      |40        |YES     &lt;br/&gt;
ij&amp;gt; DESCRIBE app.t1;&lt;br/&gt;
COLUMN_NAME         |TYPE_NAME|DEC&amp;amp;|NUM&amp;amp;|COLUM&amp;amp;|COLUMN_DEF|CHAR_OCTE&amp;amp;|IS_NULL&amp;amp;&lt;br/&gt;
------------------------------------------------------------------------------&lt;br/&gt;
I                   |INTEGER  |0   |10  |10    |AUTOINCRE&amp;amp;|NULL      |NO      &lt;br/&gt;
D                   |DECIMAL  |2   |10  |5     |NULL      |NULL      |YES     &lt;br/&gt;
TEST                |VARCHAR  |NULL|NULL|20    |NULL      |40        |YES     &lt;br/&gt;
ij&amp;gt; DESCRIBE v1;	&lt;br/&gt;
COLUMN_NAME         |TYPE_NAME|DEC&amp;amp;|NUM&amp;amp;|COLUM&amp;amp;|COLUMN_DEF|CHAR_OCTE&amp;amp;|IS_NULL&amp;amp;&lt;br/&gt;
------------------------------------------------------------------------------&lt;br/&gt;
I                   |INTEGER  |0   |10  |10    |NULL      |NULL      |NO      &lt;br/&gt;
D                   |DECIMAL  |2   |10  |5     |NULL      |NULL      |YES     &lt;br/&gt;
TEST                |VARCHAR  |NULL|NULL|20    |NULL      |40        |YES     &lt;/p&gt;


&lt;p&gt;ij&amp;gt; &amp;#8211; should find the table, as quoted string case is preserved.&lt;br/&gt;
describe &apos;CamelCaseTable&apos;;&lt;br/&gt;
JAVA ERROR: java.lang.NullPointerException&lt;br/&gt;
ij&amp;gt; &amp;#8211; should fail, as case is wrong:&lt;br/&gt;
describe &apos;CAMELCaseTable&apos;;&lt;br/&gt;
JAVA ERROR: java.lang.NullPointerException&lt;br/&gt;
ij&amp;gt; &amp;#8211; should work, note that schema name must be upper case:&lt;br/&gt;
describe &apos;APP.CamelCaseTable&apos;;&lt;br/&gt;
JAVA ERROR: java.lang.NullPointerException&lt;br/&gt;
ij&amp;gt; set SCHEMA USER1;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; &amp;#8211; should work, even after changing default schema, so long as schema is right&lt;br/&gt;
describe &apos;APP.CamelCaseTable&apos;;&lt;br/&gt;
JAVA ERROR: java.lang.NullPointerException&lt;br/&gt;
ij&amp;gt; &amp;#8211; should fail, since table is in the other schema&lt;br/&gt;
describe &apos;CamelCaseTable&apos;;&lt;br/&gt;
JAVA ERROR: java.lang.NullPointerException&lt;br/&gt;
ij&amp;gt; &amp;#8211; Can use * as a wildcard for table name:&lt;br/&gt;
describe &apos;*&apos;;&lt;br/&gt;
JAVA ERROR: java.lang.NullPointerException&lt;br/&gt;
ij&amp;gt; describe &apos;APP.*&apos;;&lt;br/&gt;
JAVA ERROR: java.lang.NullPointerException&lt;br/&gt;
ij&amp;gt; &amp;#8211; Observe behavior with empty string:&lt;br/&gt;
describe &apos;&apos;;&lt;br/&gt;
JAVA ERROR: java.lang.NullPointerException&lt;br/&gt;
ij&amp;gt; &lt;/p&gt;
</comment>
                            <comment id="12880515" author="bryanpendleton" created="Sat, 19 Jun 2010 18:42:15 +0100"  >&lt;p&gt;Hi Eranda&lt;/p&gt;

&lt;p&gt;You could try running one of those queries interactively, and then look&lt;br/&gt;
in your derby.log file for the stack trace information:&lt;/p&gt;

&lt;p&gt;  java org.apache.derby.tools.ij&lt;/p&gt;

&lt;p&gt;  connect &apos;jdbc:derby:brydb;create=true&apos;;&lt;br/&gt;
  describe &apos;CamelCaseTable&apos;;&lt;br/&gt;
  quit;&lt;/p&gt;

&lt;p&gt;After you run this, you should have a &apos;derby.log&apos; in your current directory.&lt;/p&gt;

&lt;p&gt;thanks,&lt;/p&gt;

&lt;p&gt;bryan&lt;/p&gt;</comment>
                            <comment id="12880590" author="eranda" created="Sun, 20 Jun 2010 06:35:15 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
I did it but in the log I don&apos;t see the stack trace of the errors.&lt;br/&gt;
Here is my log &lt;br/&gt;
----------------------------------------------------------------&lt;br/&gt;
2010-06-20 05:28:27.059 GMT:&lt;br/&gt;
 Booting Derby version The Apache Software Foundation - Apache Derby - 10.7.0.0 alpha - (1): instance a816c00e-0129-53d4-4411-000001c4b128 &lt;br/&gt;
on database directory /home/eranda/Desktop/derby/trunk/test2/brydb   with class loader sun.misc.Launcher$AppClassLoader@1ea2dfe&lt;/p&gt;

&lt;p&gt;Database Class Loader started - derby.database.classpath=&apos;&apos;&lt;/p&gt;

&lt;p&gt;2010-06-20 05:34:20.494 GMT:&lt;br/&gt;
Shutting down instance a816c00e-0129-53d4-4411-000001c4b128 with class loader sun.misc.Launcher$AppClassLoader@1ea2dfe &lt;br/&gt;
----------------------------------------------------------------&lt;br/&gt;
thanks&lt;br/&gt;
Eranda&lt;/p&gt;</comment>
                            <comment id="12880642" author="bryanpendleton" created="Sun, 20 Jun 2010 16:11:46 +0100"  >&lt;p&gt;Hi Eranda,&lt;/p&gt;

&lt;p&gt;I see you are right, there is no exception in the derby.log.&lt;/p&gt;

&lt;p&gt;To see the stack trace, I had to add&lt;/p&gt;

&lt;p&gt;  e.printStackTrace() ;&lt;/p&gt;

&lt;p&gt;to the 2 catch() blocks near line 375 of &lt;br/&gt;
java/tools/org/apache/derby/impl/tools/ij/utilMain.java&lt;/p&gt;

&lt;p&gt;When I did that, I see:&lt;/p&gt;


&lt;p&gt;ij&amp;gt; describe &apos;CamelCaseTable&apos;;&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.caIdentifier(ij.java:2635)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.DescTableStatement(ij.java:1445)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:1110)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:341)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.go(Main.java:229)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:184)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.main(Main.java:75)&lt;br/&gt;
	at org.apache.derby.tools.ij.main(ij.java:59)&lt;br/&gt;
JAVA ERROR: java.lang.NullPointerException&lt;/p&gt;

&lt;p&gt;In my tree, line 2635 of ij.java is the line:&lt;/p&gt;


&lt;p&gt;        haveConnection();&lt;br/&gt;
        DatabaseMetaData dbmd = theConnection.getMetaData();&lt;br/&gt;
        String identifier = i;&lt;/p&gt;

&lt;p&gt;        if(t!=null)&lt;br/&gt;
            identifier = t.image;&lt;br/&gt;
        if (dbmd.storesLowerCaseIdentifiers())&lt;br/&gt;
            identifier = identifier.toLowerCase(Locale.ENGLISH);&lt;br/&gt;
        else if (dbmd.storesUpperCaseIdentifiers())&lt;br/&gt;
            identifier = identifier.toUpperCase(Locale.ENGLISH);       &amp;lt;====== THIS IS LINE 2635&lt;/p&gt;

        {if (true) return identifier;}
&lt;p&gt;    throw new Error(&quot;Missing return statement in function&quot;);&lt;br/&gt;
  }&lt;/p&gt;

&lt;p&gt;So &apos;identifier&apos; must be NULL at this point.&lt;/p&gt;

&lt;p&gt;Maybe you can investigate and determine why this is?&lt;/p&gt;

&lt;p&gt;thanks,&lt;/p&gt;

&lt;p&gt;bryan&lt;/p&gt;</comment>
                            <comment id="12880752" author="eranda" created="Mon, 21 Jun 2010 10:01:58 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Got the point,&lt;br/&gt;
[ i=keyword()|t=&amp;lt;IDENTIFIER&amp;gt; ] means it is optional. Though both i and t doesn&apos;t have a match, execution proceed to the block. I remove squire brackets and now it passes my basic tests.&lt;br/&gt;
Here I am attaching the updated patch and I will attach derby all and JUnit test results asap.&lt;br/&gt;
Thanks&lt;br/&gt;
Eranda&lt;/p&gt;</comment>
                            <comment id="12880866" author="eranda" created="Mon, 21 Jun 2010 16:31:10 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Got the results of the tests and I don&apos;t see any difference between derbyall tests. But in the JUnit tests again there were 3 exceptions, one is same as in the previous and two new exceptions. Are there any method to reproduce them.  &lt;br/&gt;
Thanks&lt;br/&gt;
Eranda&lt;/p&gt;</comment>
                            <comment id="12881000" author="bryanpendleton" created="Tue, 22 Jun 2010 02:25:32 +0100"  >&lt;p&gt;Hi Eranda,&lt;br/&gt;
It looks like your most recent diff has resolved the NPE problems in ij7. Great!&lt;/p&gt;

&lt;p&gt;Now we just have to figure out what is wrong with your NetworkServer setup&lt;br/&gt;
in your environment, that is causing those three NetworkServer test failures.&lt;/p&gt;

&lt;p&gt;What happens if you do:&lt;/p&gt;

&lt;p&gt;  java junit.textui.TestRunner org.apache.derbyTesting.functionTests.tests.store.BootLockTest&lt;/p&gt;

&lt;p&gt;Does that reproduce the problem in your environment?&lt;/p&gt;</comment>
                            <comment id="12881144" author="eranda" created="Tue, 22 Jun 2010 10:44:44 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Yes it does.&lt;br/&gt;
Here I am attaching the log file with this and the test output file with this.&lt;br/&gt;
thanks&lt;/p&gt;</comment>
                            <comment id="12881160" author="knutanders" created="Tue, 22 Jun 2010 11:42:10 +0100"  >&lt;p&gt;I see you&apos;ve already solved the NPE in ij, but I thought I&apos;d mention the ij.exceptionTrace property in case you need to debug similar problems later. The property makes ij print the stack trace when it encounters an exception: &lt;a href=&quot;http://db.apache.org/derby/docs/dev/tools/rtoolsijproprefexceptiontrace.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.apache.org/derby/docs/dev/tools/rtoolsijproprefexceptiontrace.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12881509" author="bryanpendleton" created="Wed, 23 Jun 2010 02:31:38 +0100"  >&lt;p&gt;Hi Eranda, I wonder if you are seeing &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4667&quot; title=&quot;BootLockTest.testBootLock()  sometimes fails with connection refused.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4667&quot;&gt;&lt;del&gt;DERBY-4667&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="12881609" author="eranda" created="Wed, 23 Jun 2010 09:21:23 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
My trunk was not updated for a week and there were some updates I in BootLockTest. After updating trunk it successfully ran. Also I did the test again and all JUnit tests were passed. I think you may commit the patch now.&lt;br/&gt;
Thanks&lt;br/&gt;
PS: Thanks Knut, it will be very useful when tracking&lt;/p&gt;</comment>
                            <comment id="12881982" author="bryanpendleton" created="Thu, 24 Jun 2010 01:51:17 +0100"  >&lt;p&gt;Are there new tests to be added as part of this patch? I am looking at caidentifier.diff,&lt;br/&gt;
is that the right patch to look at? I think we need to add some tests which demonstrate&lt;br/&gt;
the behavior of IJ when using some of the new features, such as &apos;describe &quot;run&quot;&apos;, etc.&lt;/p&gt;</comment>
                            <comment id="12882448" author="eranda" created="Fri, 25 Jun 2010 06:14:42 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Where can I put the test? I could not able to find the place where the &quot;describe&quot; test?&lt;/p&gt;</comment>
                            <comment id="12882576" author="bryanpendleton" created="Fri, 25 Jun 2010 14:39:09 +0100"  >&lt;p&gt;I think the new tests could be added to&lt;br/&gt;
./java/testing/org/apache/derbyTesting/functionTests/tests/tools/ij7.sql&lt;/p&gt;

&lt;p&gt;The ij7.sql test runs as part of the complete JUnit test suite, and you&lt;br/&gt;
can also run just that test by itself by doing:&lt;br/&gt;
java org.apache.derbyTesting.functionTests.tests.tools.ToolScripts ij7&lt;br/&gt;
with your classpath set up like it would be to run the complete suite.&lt;/p&gt;</comment>
                            <comment id="12882930" author="eranda" created="Sun, 27 Jun 2010 09:18:59 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
I tried to work with new repo and get the following error&lt;br/&gt;
ij&amp;gt; describe run;&lt;br/&gt;
JAVA ERROR: java.lang.Error: Missing return statement in function&lt;br/&gt;
java.lang.Error: Missing return statement in function&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.caIdentifier(ij.java:2640)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.DescTableStatement(ij.java:1445)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:1110)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:341)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.go(Main.java:229)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:184)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.main(Main.java:75)&lt;br/&gt;
	at org.apache.derby.tools.ij.main(ij.java:59)&lt;/p&gt;

&lt;p&gt;I check ij.java and see as follows&lt;/p&gt;

&lt;p&gt;Token t=null;&lt;br/&gt;
    String i=null;&lt;br/&gt;
    if (jj_2_122(2)) &lt;/p&gt;
{
      i = keyword();
    }
&lt;p&gt; else if (jj_2_123(2)) {&lt;br/&gt;
      t = jj_consume_token(IDENTIFIER);&lt;br/&gt;
        haveConnection();&lt;br/&gt;
        DatabaseMetaData dbmd = theConnection.getMetaData();&lt;br/&gt;
        String identifier = i;&lt;/p&gt;

&lt;p&gt;        if(i==null)&lt;br/&gt;
            identifier = t.image;&lt;/p&gt;

&lt;p&gt;        if (dbmd.storesLowerCaseIdentifiers())&lt;br/&gt;
            identifier = identifier.toLowerCase(Locale.ENGLISH);&lt;br/&gt;
        else if (dbmd.storesUpperCaseIdentifiers())&lt;br/&gt;
            identifier = identifier.toUpperCase(Locale.ENGLISH);&lt;/p&gt;

        {if (true) return identifier;}
&lt;p&gt;    } else &lt;/p&gt;
{
      jj_consume_token(-1);
      throw new ParseException();
    }
&lt;p&gt;    throw new Error(&quot;Missing return statement in function&quot;);&lt;/p&gt;

&lt;p&gt;According to the code when we give a key word as table the error should appear.&lt;br/&gt;
Why this occurs suddenly? Here I am attaching the patch.&lt;br/&gt;
thanks&lt;/p&gt;</comment>
                            <comment id="12882941" author="eranda" created="Sun, 27 Jun 2010 11:26:53 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Now that thing was solved and I added some test to the ij7. But it gave me the following exception.&lt;/p&gt;

&lt;p&gt;ij7(org.apache.derbyTesting.functionTests.tests.tools.ToolScripts)junit.framework.ComparisonFailure: Output at line 113 expected:&amp;lt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ij&amp;gt; DESCRIBE APP.t1;&amp;#93;&lt;/span&gt;&amp;gt; but was:&amp;lt;&lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.derby.impl.tools.ij.ijException: No table exists with the name T1&amp;#93;&lt;/span&gt;&amp;gt;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon(CanonTestCase.java:106)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptTestCase.java:198)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:109)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:27)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.tools.ToolScripts.main(ToolScripts.java:101)&lt;/p&gt;

&lt;p&gt;FAILURES!!!&lt;br/&gt;
Tests run: 1,  Failures: 1,  Errors: 0&lt;/p&gt;</comment>
                            <comment id="12882954" author="eranda" created="Sun, 27 Jun 2010 14:37:04 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
All problem solved. &lt;br/&gt;
Here I included two tests to verify that this works.Also here I am attaching the patch for your review.&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="12882965" author="bryanpendleton" created="Sun, 27 Jun 2010 18:31:22 +0100"  >&lt;p&gt;I will have a close look at your latest patch soon. Thanks for adding the tests!&lt;/p&gt;</comment>
                            <comment id="12882997" author="bryanpendleton" created="Sun, 27 Jun 2010 23:06:04 +0100"  >&lt;p&gt;I think this patch is solid, and have committed it to the trunk as&lt;br/&gt;
revision 958431. Thanks Eranda for all the hard work on the patch,&lt;br/&gt;
and thanks Sylvain and others for suggestions and reviews along the way.&lt;/p&gt;</comment>
                            <comment id="12883018" author="eranda" created="Mon, 28 Jun 2010 04:53:17 +0100"  >&lt;p&gt;Thanks Bryan for committing and thanks all for the suggestions.&lt;br/&gt;
I am closing this issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12448152" name="Derby-2785.diff" size="835" author="eranda" created="Sun, 27 Jun 2010 09:18:59 +0100"/>
                            <attachment id="12448157" name="caidentifier.diff" size="2928" author="eranda" created="Sun, 27 Jun 2010 14:37:04 +0100"/>
                            <attachment id="12448153" name="caidentifier.diff" size="1491" author="eranda" created="Sun, 27 Jun 2010 11:26:52 +0100"/>
                            <attachment id="12447587" name="caidentifier.diff" size="849" author="eranda" created="Mon, 21 Jun 2010 10:01:58 +0100"/>
                            <attachment id="12440015" name="caidentifier.diff" size="843" author="bryanpendleton" created="Sun, 28 Mar 2010 19:34:27 +0100"/>
                            <attachment id="12440007" name="derby-2785.diff" size="1314" author="eranda" created="Sun, 28 Mar 2010 13:38:51 +0100"/>
                            <attachment id="12440006" name="derby-2785.diff" size="1314" author="eranda" created="Sun, 28 Mar 2010 13:37:47 +0100"/>
                            <attachment id="12439976" name="derby-2785.diff" size="784" author="eranda" created="Sat, 27 Mar 2010 19:32:17 +0000"/>
                            <attachment id="12447684" name="derby.log" size="6627" author="eranda" created="Tue, 22 Jun 2010 10:44:44 +0100"/>
                            <attachment id="12447530" name="derbyall_report.txt" size="2728" author="eranda" created="Sat, 19 Jun 2010 14:01:49 +0100"/>
                            <attachment id="12443090" name="derbyall_report.txt" size="14637" author="eranda" created="Wed, 28 Apr 2010 16:44:24 +0100"/>
                            <attachment id="12439629" name="describeKeywords.diff" size="729" author="bryanpendleton" created="Wed, 24 Mar 2010 03:27:26 +0000"/>
                            <attachment id="12447605" name="junitAll.out" size="16237" author="eranda" created="Mon, 21 Jun 2010 16:31:10 +0100"/>
                            <attachment id="12447531" name="junitAll.out" size="16872" author="eranda" created="Sat, 19 Jun 2010 14:01:49 +0100"/>
                            <attachment id="12439406" name="step logs.txt" size="10402" author="eranda" created="Sun, 21 Mar 2010 13:41:22 +0000"/>
                            <attachment id="12447685" name="test.out" size="1844" author="eranda" created="Tue, 22 Jun 2010 10:44:44 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 17 Nov 2008 19:55:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>672</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10423"><![CDATA[Newcomer]]></customfieldvalue>
    <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0oen:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37772</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>