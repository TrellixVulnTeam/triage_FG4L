<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:09:51 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-622/DERBY-622.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-622] sysinfo incorrectly requires permission on Derby jar files</title>
                <link>https://issues.apache.org/jira/browse/DERBY-622</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Running the test derbynet/sysinfo.java requires this permission in derby_tests.policy, in order to read the jar files.&lt;/p&gt;

&lt;p&gt;permission java.io.FilePermission &quot;$&lt;/p&gt;
{csinfo.codedir}
&lt;p&gt;$&lt;/p&gt;
{/}
&lt;p&gt;*&quot;, &quot;read&quot;&lt;/p&gt;

&lt;p&gt;But according to the Java security specs:&lt;/p&gt;

&lt;p&gt;&apos;Note: code can always read a file from the same directory it&apos;s in (or a subdirectory of that directory); it does not need explicit permission to do so.&apos;&lt;/p&gt;

&lt;p&gt;Probably means a privileged block is required when accessing the contents of the jar files in sysinfo&lt;/p&gt;</description>
                <environment></environment>
        <key id="12317921">DERBY-622</key>
            <summary>sysinfo incorrectly requires permission on Derby jar files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Oct 2005 23:36:44 +0100</created>
                <updated>Tue, 30 Jun 2009 01:14:44 +0100</updated>
                            <resolved>Tue, 1 Aug 2006 06:22:50 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12369769" author="myrna" created="Fri, 10 Mar 2006 09:58:30 +0000"  >&lt;p&gt;M      java\tools\org\apache\derby\impl\tools\sysinfo\Main.java&lt;/p&gt;

&lt;p&gt;This patch - &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-622&quot; title=&quot;sysinfo incorrectly requires permission on Derby jar files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-622&quot;&gt;&lt;del&gt;DERBY-622&lt;/del&gt;&lt;/a&gt;_step1.diff - adds privileged blocks around the getResourceAsStream sections in use.&lt;br/&gt;
This is a first step, it didn&apos;t have the result I expected. Maybe someone can review and see if I did something really dumb....&lt;/p&gt;</comment>
                            <comment id="12369771" author="myrna" created="Fri, 10 Mar 2006 10:06:24 +0000"  >&lt;p&gt;Without the step 1 patch, and without the lines currently in the derby_tests.policy file for derbynet.jar and derby.jar:&lt;br/&gt;
  permission java.io.FilePermission &quot;$&lt;/p&gt;
{derbyTesting.codedir}
&lt;p&gt;$&lt;/p&gt;
{/}
&lt;p&gt;*&quot;, &quot;read&quot;;&lt;/p&gt;

&lt;p&gt;the test will fail with output like this in the .tmp:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;- - - - - - - - - - - - - - - - - - - - - - - -
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;
			&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
				&lt;li&gt;
				&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
					&lt;li&gt;
					&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
						&lt;li&gt;
						&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
							&lt;li&gt;
							&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
								&lt;li&gt;
								&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
									&lt;li&gt;
									&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
										&lt;li&gt;
										&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
											&lt;li&gt;
											&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
												&lt;li&gt;
												&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
													&lt;li&gt;
													&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
														&lt;li&gt;
														&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
															&lt;li&gt;
															&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																&lt;li&gt;
																&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																	&lt;li&gt;
																	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																		&lt;li&gt;Java Information ------------------&lt;br/&gt;
Java Version:    1.4.2_07&lt;br/&gt;
Java Vendor:     Sun Microsystems Inc.&lt;br/&gt;
Java home:       Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission java.home read)&lt;br/&gt;
Java classpath:  Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission java.class.path read)&lt;br/&gt;
OS name:         Windows 2000&lt;br/&gt;
OS architecture: x86&lt;br/&gt;
OS version:      5.0&lt;br/&gt;
Java user name:  Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission user.name read)&lt;br/&gt;
Java user home:  C:\Documents and Settings\Administrator&lt;br/&gt;
Java user dir:   Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission user.dir read)&lt;br/&gt;
java.specification.name: Java Platform API Specification&lt;br/&gt;
java.specification.version: 1.4&lt;/li&gt;
																	&lt;/ul&gt;
																	&lt;/li&gt;
																&lt;/ul&gt;
																&lt;/li&gt;
															&lt;/ul&gt;
															&lt;/li&gt;
														&lt;/ul&gt;
														&lt;/li&gt;
													&lt;/ul&gt;
													&lt;/li&gt;
												&lt;/ul&gt;
												&lt;/li&gt;
											&lt;/ul&gt;
											&lt;/li&gt;
										&lt;/ul&gt;
										&lt;/li&gt;
									&lt;/ul&gt;
									&lt;/li&gt;
									&lt;li&gt;Derby Information --------&lt;br/&gt;
JRE - JDBC: J2SE 1.4.2 - JDBC 3.0&lt;br/&gt;
No Derby System info found!&lt;br/&gt;
------------------------------------------------------
									&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
										&lt;li&gt;
										&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
											&lt;li&gt;
											&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
												&lt;li&gt;
												&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
													&lt;li&gt;
													&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
														&lt;li&gt;
														&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
															&lt;li&gt;
															&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																&lt;li&gt;
																&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																	&lt;li&gt;Locale Information -----------------&lt;br/&gt;
------------------------------------------------------&lt;/li&gt;
																&lt;/ul&gt;
																&lt;/li&gt;
															&lt;/ul&gt;
															&lt;/li&gt;
														&lt;/ul&gt;
														&lt;/li&gt;
													&lt;/ul&gt;
													&lt;/li&gt;
												&lt;/ul&gt;
												&lt;/li&gt;
											&lt;/ul&gt;
											&lt;/li&gt;
										&lt;/ul&gt;
										&lt;/li&gt;
									&lt;/ul&gt;
									&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;End test&lt;br/&gt;
Testing Sysinfo (method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;- - - - - - - - - - -&lt;br/&gt;
Note that the sed-processing removes the Java info section.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With the patch, we see this:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;- - - - - - - - - - -
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;
			&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
				&lt;li&gt;
				&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
					&lt;li&gt;
					&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
						&lt;li&gt;
						&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
							&lt;li&gt;
							&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
								&lt;li&gt;
								&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
									&lt;li&gt;
									&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
										&lt;li&gt;
										&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
											&lt;li&gt;
											&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
												&lt;li&gt;
												&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
													&lt;li&gt;
													&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
														&lt;li&gt;
														&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
															&lt;li&gt;
															&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																&lt;li&gt;
																&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																	&lt;li&gt;
																	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																		&lt;li&gt;Java Information ------------------&lt;br/&gt;
Java Version:    1.4.2_07&lt;br/&gt;
Java Vendor:     Sun Microsystems Inc.&lt;br/&gt;
Java home:       Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission java.home read)&lt;br/&gt;
Java classpath:  Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission java.class.path read)&lt;br/&gt;
OS name:         Windows 2000&lt;br/&gt;
OS architecture: x86&lt;br/&gt;
OS version:      5.0&lt;br/&gt;
Java user name:  Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission user.name read)&lt;br/&gt;
Java user home:  C:\Documents and Settings\Administrator&lt;br/&gt;
Java user dir:   Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission user.dir read)&lt;br/&gt;
java.specification.name: Java Platform API Specification&lt;br/&gt;
java.specification.version: 1.4&lt;/li&gt;
																	&lt;/ul&gt;
																	&lt;/li&gt;
																&lt;/ul&gt;
																&lt;/li&gt;
															&lt;/ul&gt;
															&lt;/li&gt;
														&lt;/ul&gt;
														&lt;/li&gt;
													&lt;/ul&gt;
													&lt;/li&gt;
												&lt;/ul&gt;
												&lt;/li&gt;
											&lt;/ul&gt;
											&lt;/li&gt;
										&lt;/ul&gt;
										&lt;/li&gt;
									&lt;/ul&gt;
									&lt;/li&gt;
									&lt;li&gt;Derby Information --------&lt;br/&gt;
JRE - JDBC: J2SE 1.4.2 - JDBC 3.0&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;/org/apache/derby/info/DBMS.properties&amp;#93;&lt;/span&gt; 10.2.0.0 alpha - (384366M)&lt;br/&gt;
------------------------------------------------------
									&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
										&lt;li&gt;
										&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
											&lt;li&gt;
											&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
												&lt;li&gt;
												&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
													&lt;li&gt;
													&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
														&lt;li&gt;
														&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
															&lt;li&gt;
															&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																&lt;li&gt;
																&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
																	&lt;li&gt;Locale Information -----------------&lt;br/&gt;
------------------------------------------------------&lt;/li&gt;
																&lt;/ul&gt;
																&lt;/li&gt;
															&lt;/ul&gt;
															&lt;/li&gt;
														&lt;/ul&gt;
														&lt;/li&gt;
													&lt;/ul&gt;
													&lt;/li&gt;
												&lt;/ul&gt;
												&lt;/li&gt;
											&lt;/ul&gt;
											&lt;/li&gt;
										&lt;/ul&gt;
										&lt;/li&gt;
									&lt;/ul&gt;
									&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;End test&lt;br/&gt;
Testing Sysinfo (method)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;- - - - - - - -&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So, not much of an improvement...&lt;/p&gt;

&lt;p&gt;(Note, by the way, also, that in the mean time we ought to have another line in the derby_tests.policy file for the case that derbytools.jar is the first in the classpath - I guess everyone always puts derby.jar first...)&lt;/p&gt;
</comment>
                            <comment id="12370619" author="fuzzylogic" created="Thu, 16 Mar 2006 08:13:05 +0000"  >&lt;p&gt;Hi Myrna, that output is unusual, it implies to me that getResourceAsStream is returning null for most of the info properties files. I&apos;ll take a closer look at this patch tomorrow.&lt;/p&gt;</comment>
                            <comment id="12372383" author="fuzzylogic" created="Thu, 30 Mar 2006 16:32:14 +0100"  >&lt;p&gt;Committed _step1 patch with revision 390000.&lt;/p&gt;

&lt;p&gt;Several comments:&lt;/p&gt;

&lt;p&gt;1 - This had no effect on the test(s) in question because I did not commit the policy file change. This change was not included in the patch, but was described in the comments to this issue.  I committed this patch because it seemed like an obvious step forward to wrap these calls to getResourceAsStream in priv blocks since they have security implications, and the tests were not affected.&lt;/p&gt;

&lt;p&gt;2 - With this change and the policy file change - removing the permissions marked as Bug: &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-622&quot; title=&quot;sysinfo incorrectly requires permission on Derby jar files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-622&quot;&gt;&lt;del&gt;DERBY-622&lt;/del&gt;&lt;/a&gt; - the only difference in the output was the lack of reporting of the locales. I believe that the other information affected by this change, the location of the derby classes and the build number, have been filtered out by Sed.java&lt;/p&gt;

&lt;p&gt;3 - Following the execution of sysinfo in a debugger, with the policy file change, getResourceAsStream() for the locale info properties file returns null with no SecurityException thrown. I had expected a SecurityException to be thrown here, for lacking java.io.FilePermission &quot;read&quot; on the jar file with the locale property file. But in the debugger, it appeared as though the call to getResourceAsStream() was simply skipped over and the InputStream returned from the call is null. This explains why the locale information fails to report any information, but can anyone think of why I might be seeing this behavior? That is, why would the VM simply skip over the call to getResourceAsStream() without throwing a SecurityException?&lt;/p&gt;

&lt;p&gt;4 - With the policy file change, and with the privileged blocks, the result is the same as without the privileged blocks. So I am confused as to the nature of this issue. The original description of the issue refers to permissions being granted to codebase csinfo.codedir, which would be the compiled classes in a directory, not the packaged jar files. With or without this change, the behavior is the same with the classes in a directory, because the files in question would be accessible under the security manager by virtue of being in the same location as the rest of the code and test files (csinfo.codedir, now derbyTesting.codeclasses) - as mentioned in the description of the bug. The same is not true with jars because the jars are treated as separate locations and thus the policy for the jar files is specific to each jar (because they are separate locations, unlike having all classes in a single directory), so permission might need to be granted to read from each of the locale jar files, even with the privileged blocks. But, I had thought that the permission currently in derby_tests.policy should allow reading from any jar files in the same location as the jar files from which sysinfo is loaded, but the permissions are apparently not sufficient, or something else is going on. That something else would be the weird skipping over of the call to getResourceAsStream().&lt;/p&gt;

&lt;p&gt;So, I&apos;m confused as to what is going on here. Dan, you filed this issue, do you have any insight? Particularly, as to why the calls to getResourceAsStream() are being skipped without a SecurityException being thrown? My next steps are to test granting read permissions to each of the locale jar files specifically, and to find the source to the getResourceAsStream methods and antecedants to see if somehow the SecurityException is being consumed there without being thrown in the JVM that I am currently using.&lt;/p&gt;</comment>
                            <comment id="12372386" author="fuzzylogic" created="Thu, 30 Mar 2006 16:50:27 +0100"  >&lt;p&gt;Followup:&lt;/p&gt;

&lt;p&gt;I can confirm that both with and without the change in the _step1 patch, and with or without the policy file change to remove the lines marked Bug: &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-622&quot; title=&quot;sysinfo incorrectly requires permission on Derby jar files&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-622&quot;&gt;&lt;del&gt;DERBY-622&lt;/del&gt;&lt;/a&gt;, that adding the following line to the permissions of derby.jar and derbynet.jar in derby_tests.policy for each of the locale jars fixes the difference that is seen in the tests:&lt;/p&gt;

&lt;p&gt;permission java.io.FilePermission &quot;$&lt;/p&gt;
{derbyTesting.codejar}
&lt;p&gt;derbyLocale_$&lt;/p&gt;
{LOCALE}.jar&quot;, read&lt;br/&gt;
&lt;br/&gt;
where ${LOCALE}
&lt;p&gt; is one of the supported locale jar files removes the corresponding line from the diff in the test.&lt;/p&gt;</comment>
                            <comment id="12372392" author="fuzzylogic" created="Thu, 30 Mar 2006 18:04:22 +0100"  >&lt;p&gt;Sorry, mistake in that last comment. Getting late here. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  It should have read:&lt;/p&gt;

&lt;p&gt;I can confirm that with or without the change in the _step1 patch, and &lt;b&gt;with&lt;/b&gt; the policy file change to remove the lines...&lt;/p&gt;

&lt;p&gt;Without any changes to the policy file, there is no change in the behavior of the tests, which is why I opted to commit the _step1 patch as-is.&lt;/p&gt;</comment>
                            <comment id="12372476" author="bryanpendleton" created="Fri, 31 Mar 2006 03:15:15 +0100"  >&lt;p&gt;Hi Andrew. Whichever way we decide to go on the policy file, let&apos;s please make the changes to &lt;b&gt;all three&lt;/b&gt; of derby.jar, derbynet.jar, and derbytools.jar. This is relevant to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1152&quot; title=&quot;Failures in sysinfo and sysinfo_withproperties induced by classpath wiring&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1152&quot;&gt;&lt;del&gt;DERBY-1152&lt;/del&gt;&lt;/a&gt;, and has to do with the fact that the sysinfo code is included in all three jars, not just derby.jar and derbynet.jar.&lt;/p&gt;</comment>
                            <comment id="12372509" author="djd" created="Fri, 31 Mar 2006 05:06:57 +0100"  >&lt;p&gt;One comment on 3) in Andrew&apos;s comment. The specified behaviour for getResourceAsStream is that it returns  &quot;null if the resource could not be found or the caller doesn&apos;t have adequate privileges to get the resource.&quot;&lt;/p&gt;

&lt;p&gt;See ClassLoader.getResource(String)&lt;/p&gt;</comment>
                            <comment id="12372529" author="fuzzylogic" created="Fri, 31 Mar 2006 05:21:24 +0100"  >&lt;p&gt;Thanks, Dan. That&apos;s what I get for looking at the javadoc for the actual method being called. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  I think I actually ran into that in a previous issue, too&lt;/p&gt;

&lt;p&gt;So, do you think adding the permission to read the locale jar files is the way to go here? Or should we just leave the test the way it is and close this issue?&lt;/p&gt;</comment>
                            <comment id="12424740" author="fuzzylogic" created="Tue, 1 Aug 2006 06:22:49 +0100"  >&lt;p&gt;I am closing this issue as fixed. During testing, it became apparent that there were a couple of places in sysinfo that needed privileged blocks, and these were fixed by a patch by Myrna, which I committed with revision 390000.&lt;/p&gt;

&lt;p&gt;However, there is now a sysinfo.policy file which grants the permissions that the description of this issue complained should not be necessary. From the description of this issue:&lt;/p&gt;

&lt;p&gt;...&lt;br/&gt;
permission java.io.FilePermission &quot;$&lt;/p&gt;
{csinfo.codedir}
&lt;p&gt;$&lt;/p&gt;
{/}*&quot;, &quot;read&quot; &lt;br/&gt;
&lt;br/&gt;
But according to the Java security specs: &lt;br/&gt;
&lt;br/&gt;
&apos;Note: code can always read a file from the same directory it&apos;s in (or a subdirectory of that directory); it does not need explicit permission to do so.&apos; &lt;br/&gt;
...&lt;br/&gt;
&lt;br/&gt;
This is true for classes in a directory, but for jars, FilePermission to read other jars must be granted explicitly, which is why:&lt;br/&gt;
&lt;br/&gt;
grant codeBase &quot;${derbyTesting.codejar}/derbytools.jar&quot; {&lt;br/&gt;
  permission java.io.FilePermission &quot;${derbyTesting.codedir}${/}
&lt;p&gt;*&quot;, &quot;read&quot;;&lt;br/&gt;
};&lt;/p&gt;

&lt;p&gt;is granted, so that derbytools.jar can read from any other jar file (like the locale jar files) in the directory which it is in. Similar permissions are granted to derby.jar and derbynet.jar, depending on which jar file is first in the classpath, and thus, from which the sysinfo classes are loaded first.&lt;/p&gt;

&lt;p&gt;The only remaining comment I have is that, in light of the above with regard to the security spec, and the comments attached to this issue, these lines in derbynet/sysinfo.policy seem superfluous:&lt;/p&gt;

&lt;p&gt;grant codeBase &quot;$&lt;/p&gt;
{derbyTesting.codeclasses}&quot; {&lt;br/&gt;
  // the following two lines shouldn&apos;t be needed&lt;br/&gt;
  permission java.io.FilePermission &quot;${derbyTesting.codedir}&quot;, &quot;read&quot;;&lt;br/&gt;
  permission java.io.FilePermission &quot;${derbyTesting.codeclasses}
&lt;p&gt;$&lt;/p&gt;
{/}
&lt;p&gt;*&quot;, &quot;read&quot;;&lt;br/&gt;
};&lt;/p&gt;

&lt;p&gt;These lines were granted as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-955&quot; title=&quot;Get derbyall on jdk1.6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-955&quot;&gt;&lt;del&gt;DERBY-955&lt;/del&gt;&lt;/a&gt;, in particular see this mail: &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.nabble.com/Re%3A--jira--Updated%3A-%28DERBY-955%29-Get-derbyall-on-jdk1.6-p3977396.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/Re%3A--jira--Updated%3A-%28DERBY-955%29-Get-derbyall-on-jdk1.6-p3977396.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and the followups. I have tested derbynet/sysinfo.properties and derbynet/sysinfo_withproperties with JDK 1.5 on Mac OS X without the above lines and the tests passed. So, it might be desirable to revisit granting these permissions to the sysinfo tests.&lt;/p&gt;</comment>
                            <comment id="12551293" author="fuzzylogic" created="Thu, 13 Dec 2007 09:04:43 +0000"  >&lt;p&gt;This issue has been resolved for over a year with no further movement. Closing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12324001" name="DERBY-622_step1.diff" size="2076" author="myrna" created="Fri, 10 Mar 2006 09:58:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 10 Mar 2006 09:58:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22052</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0v4v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38862</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10053"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>