<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:29:07 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5648/DERBY-5648.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5648] Unclear password expiry warning when using separate credentials db</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5648</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If you log on to a database (other than the credentials db) and your password is about to expire, you&apos;ll be advised to change your password using the SYSCS_UTIL.SYSCS_MODIFY_PASSWORD procedure. However, the warning message does not say you need to log on to the credentials db to change your password. This may lead the user to modify the password in the current database instead of the credentials database, thinking everything is well.&lt;/p&gt;

&lt;p&gt;ij(CONNECTION1)&amp;gt; connect &apos;jdbc:derby:otherdb;user=test;password=abc&apos;;&lt;br/&gt;
WARNING 01J15: Your password will expire in 0 day(s). Please use the SYSCS_UTIL.SYSCS_MODIFY_PASSWORD  procedure to change your password.&lt;br/&gt;
ij(CONNECTION2)&amp;gt; CALL SYSCS_UTIL.SYSCS_MODIFY_PASSWORD(&apos;new-password&apos;);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij(CONNECTION2)&amp;gt; connect &apos;jdbc:derby:otherdb;user=test;password=new-password&apos;;&lt;br/&gt;
ERROR 08004: Connection authentication failure occurred.  Reason: Invalid authentication..&lt;/p&gt;

&lt;p&gt;Even though SYSCS_MODIFY_PASSWORD succeeds, the password has not been updated in the credentials db.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12546101">DERBY-5648</key>
            <summary>Unclear password expiry warning when using separate credentials db</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Mar 2012 14:42:36 +0000</created>
                <updated>Tue, 24 Jul 2012 18:28:06 +0100</updated>
                            <resolved>Tue, 13 Mar 2012 17:28:59 +0000</resolved>
                                    <version>10.9.1.0</version>
                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Services</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13227599" author="rhillegas" created="Mon, 12 Mar 2012 15:18:58 +0000"  >&lt;p&gt;Thanks for logging this issue Knut. Here are some options for clarifying this error situation:&lt;/p&gt;

&lt;p&gt;1) The error message could contain the name of the database whose credentials are expiring. If the warning is raised because credentials are expiring for a system-wide operation (like engine shutdown), then the name of the system-wide credentials db will be revealed. I don&apos;t know if that is a problem but I suppose someone might consider that to be a security risk.&lt;/p&gt;

&lt;p&gt;2) We could use different error text depending on whether the credentials are expiring in a system-wide credentials db or in the local db. Something like:&lt;/p&gt;

&lt;p&gt;&quot;Your password will expire in 0 day(s). Please use the SYSCS_UTIL.SYSCS_MODIFY_PASSWORD procedure to change your password in the system-wide credentials database.&quot;&lt;/p&gt;

&lt;p&gt;vs.&lt;/p&gt;

&lt;p&gt;&quot;Your password will expire in 0 day(s). Please use the SYSCS_UTIL.SYSCS_MODIFY_PASSWORD procedure to change your password in this database.&quot;&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Rick&lt;/p&gt;


</comment>
                            <comment id="13227612" author="knutanders" created="Mon, 12 Mar 2012 15:35:09 +0000"  >&lt;p&gt;Option 2 sounds fine to me.&lt;/p&gt;

&lt;p&gt;Another question is whether there should have been an error when calling SYSCS_MODIFY_PASSWORD on a database that&apos;s not a credentials database. But I suppose that must be allowed so that the password of the DBO can be set before NATIVE is enabled? Maybe SYSCS_MODIFY_PASSWORD (and SYSCS_RESET_PASSWORD) should fail, though, if there is no entry for the specified user in the local SYS.SYSUSERS table?&lt;/p&gt;</comment>
                            <comment id="13227718" author="rhillegas" created="Mon, 12 Mar 2012 17:47:31 +0000"  >&lt;p&gt;Thanks for the additional experiments, Knut.&lt;/p&gt;

&lt;p&gt;&amp;gt; Another question is whether there should have been an error when calling SYSCS_MODIFY_PASSWORD on a database that&apos;s not a credentials database. But I suppose that must be allowed so that the password of the DBO can be set before NATIVE is enabled?&lt;/p&gt;

&lt;p&gt;I think that the use-case is obscure: changing a password which you just set. However, I don&apos;t see a strong reason to forbid this.&lt;/p&gt;

&lt;p&gt;&amp;gt; Maybe SYSCS_MODIFY_PASSWORD (and SYSCS_RESET_PASSWORD) should fail, though, if there is no entry for the specified user in the local SYS.SYSUSERS table? &lt;/p&gt;

&lt;p&gt;And SYSCS_DROP_USER as well? The use-case for allowing these procedures to be called on non-existent users is obscure: It would involve delegating some but not all user-maintenance chores to an assistant. The assistant would be allowed to change the passwords of known users but would be prevented from using these procedures to fish for additional user names.&lt;/p&gt;

&lt;p&gt;The use-case for disallowing these procedures on non-existent users seems more important to me: alerting the DBO to the fact that she has mis-spelled a user name.&lt;/p&gt;

&lt;p&gt;Further thoughts?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Rick&lt;/p&gt;</comment>
                            <comment id="13228250" author="knutanders" created="Tue, 13 Mar 2012 06:56:16 +0000"  >&lt;p&gt;I agree that there&apos;s no strong reason to disallow SYSCS_MODIFY_PASSWORD completely in databases that doesn&apos;t use NATIVE::LOCAL.&lt;/p&gt;

&lt;p&gt;I think SYSCS_MODIFY_PASSWORD, SYSCS_RESET_PASSWORD and SYSCS_DROP_USER should fail if the user doesn&apos;t exist locally. It is a valid concern that a non-DBO user can use this to fish user names. However, that non-DBO user must be granted some admin rights by the DBO before, so it must be a trusted user in the first place. Also, someone with those rights has a much easier way to probe the user database: reset the password of a user account and then log on using the fresh credentials.&lt;/p&gt;</comment>
                            <comment id="13228433" author="rhillegas" created="Tue, 13 Mar 2012 15:20:55 +0000"  >&lt;p&gt;Attaching derby-5648-01-aa-missingUser.diff. This patch adds the database name to the password expiration messages. This patch also raises an error if you try to drop a user who doesn&apos;t exist or if you try to change the password of a missing user. I am running regression tests now.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/iapi/error/SQLWarningFactory.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/jdbc/authentication/NativeAuthenticationServiceImpl.java&lt;br/&gt;
M       java/engine/org/apache/derby/loc/messages.xml&lt;br/&gt;
M       java/shared/org/apache/derby/shared/common/reference/SQLState.java&lt;/p&gt;

&lt;p&gt;New message and 2 changed messages. Added a factory method for 2-arg warnings.&lt;/p&gt;

&lt;p&gt;------------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/catalog/SystemProcedures.java&lt;/p&gt;

&lt;p&gt;Checks for whether user exists.&lt;/p&gt;

&lt;p&gt;------------&lt;/p&gt;

&lt;p&gt;M       java/testing/org/apache/derbyTesting/functionTests/tests/lang/NativeAuthProcs.java&lt;/p&gt;

&lt;p&gt;Test cases.&lt;/p&gt;</comment>
                            <comment id="13228528" author="rhillegas" created="Tue, 13 Mar 2012 17:26:56 +0000"  >&lt;p&gt;Attaching derby-5648-01-ab-missingUser.diff. This patch removes a 10.9 upgrade test case which fails now that syscs_modify_password() raises the new error. Other than the upgrade failure, the tests ran cleanly for me. Committed at subversion revision 1300248.&lt;/p&gt;

&lt;p&gt;Touches the following additional file:&lt;/p&gt;

&lt;p&gt;M       java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_9.java&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12328052">DERBY-866</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12518191" name="derby-5648-01-aa-missingUser.diff" size="10197" author="rhillegas" created="Tue, 13 Mar 2012 15:20:55 +0000"/>
                            <attachment id="12518201" name="derby-5648-01-ab-missingUser.diff" size="11002" author="rhillegas" created="Tue, 13 Mar 2012 17:26:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 12 Mar 2012 15:18:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>231259</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0aov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35550</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>