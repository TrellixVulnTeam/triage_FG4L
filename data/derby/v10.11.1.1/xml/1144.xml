<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:12:12 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1144/DERBY-1144.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1144] With client PooledConnection.getConnection() does not reset holdability and isolation state properly</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1144</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I found this issue when working on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1044&quot; title=&quot;[xa] client XAConnection.getConnection()  does not have the correct  default isolation level if set by an earlier connection obtained from the same XAConnection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1044&quot;&gt;&lt;del&gt;DERBY-1044&lt;/del&gt;&lt;/a&gt; which was filed for the isolation not getting reset for XAConnections.&lt;br/&gt;
I found that this was a generic issue for PooledConnections and also that holdability was also wrong.&lt;/p&gt;

&lt;p&gt;The fix proposed for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1044&quot; title=&quot;[xa] client XAConnection.getConnection()  does not have the correct  default isolation level if set by an earlier connection obtained from the same XAConnection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1044&quot;&gt;&lt;del&gt;DERBY-1044&lt;/del&gt;&lt;/a&gt; should also fix this issue.  That bug has the repro for the isolation state issue&lt;/p&gt;

&lt;p&gt;For holdability, this code passes for embedded but fails for client:&lt;/p&gt;


&lt;p&gt;        // Test holdability   &lt;br/&gt;
        ConnectionPoolDataSource ds = TestUtil.getConnectionPoolDataSource(p);&lt;br/&gt;
        pc1 = ds.getPooledConnection();&lt;br/&gt;
        testPooledConnHoldability(&quot;PooledConnection&quot;, pc1);&lt;br/&gt;
        pc1.close();&lt;/p&gt;

&lt;p&gt;      **&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@param string&lt;/li&gt;
	&lt;li&gt;@param pc1&lt;br/&gt;
	 */&lt;br/&gt;
	private static void testPooledConnHoldability(String string, PooledConnection pc1) &lt;br/&gt;
	throws SQLException 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: { 		System.out.println(&amp;quot;n**Test holdability state**&amp;quot;);		Connection conn  = pc1.getConnection();		conn.setHoldability(ResultSet.CLOSE_CURSORS_AT_COMMIT);		// reset the connection and see if the holdability gets reset 		conn = pc1.getConnection();		int holdability = conn.getHoldability();		if (holdability != ResultSet.HOLD_CURSORS_OVER_COMMIT)		{
			System.out.println(&quot;FAIL: Holdability not reset on get Connection&quot;);			
		}		else 		{
			System.out.println(&quot;PASS: Holdability reset on getConnection&quot;);
		}		conn.close();	}&lt;/span&gt; &lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12330618">DERBY-1144</key>
            <summary>With client PooledConnection.getConnection() does not reset holdability and isolation state properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Mar 2006 03:24:01 +0000</created>
                <updated>Tue, 25 Apr 2006 05:00:03 +0100</updated>
                            <resolved>Tue, 25 Apr 2006 05:00:03 +0100</resolved>
                                    <version>10.1.3.1</version>
                                    <fixVersion>10.1.3.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12371623" author="kmarsden" created="Fri, 24 Mar 2006 03:38:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1044&quot; title=&quot;[xa] client XAConnection.getConnection()  does not have the correct  default isolation level if set by an earlier connection obtained from the same XAConnection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1044&quot;&gt;&lt;del&gt;DERBY-1044&lt;/del&gt;&lt;/a&gt; is a manifistation of this bug&lt;/p&gt;</comment>
                            <comment id="12372984" author="kmarsden" created="Tue, 4 Apr 2006 04:05:25 +0100"  >&lt;p&gt;This patch addresses this issue by changing PooledConnection.getConnection()  to reset the connection to the datasource defaults.&lt;/p&gt;

&lt;p&gt;Code changes:&lt;br/&gt;
Just a small code change in ClientPooledConnection to pass true to the reset method to reset the defaults.&lt;/p&gt;

&lt;p&gt;This change has the side effect of making DERBY- 1173 harder to reproduce. But I don&apos;t think it fixes that bug.  With the change, the checkDataSource test hangs only very intermittently.   The fixer of that bug will have to go back to a previous version to get a easily reproducable case.&lt;/p&gt;


&lt;p&gt;Tests - &lt;br/&gt;
Changed the checkDataSource30.java test to test holdability,isolation, and autocommit reset.&lt;/p&gt;

</comment>
                            <comment id="12373148" author="kmarsden" created="Wed, 5 Apr 2006 02:23:21 +0100"  >&lt;p&gt;Checked this change into trunk.&lt;br/&gt;
Leaving open for port into  10.1.   This fix makes &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1173&quot; title=&quot; conglomerate (129) requested does not exist error on create table after aborting and rerunning  jdbcapi/checkDataSource  test with client.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1173&quot;&gt;&lt;del&gt;DERBY-1173&lt;/del&gt;&lt;/a&gt; harder to reproduce, but I have no reason to believe it fixes the issue.   I will add a comment there&lt;/p&gt;

&lt;p&gt;Date: Tue Apr  4 10:17:34 2006&lt;br/&gt;
New Revision: 391369&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewcvs?rev=391369&amp;amp;view=rev&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs?rev=391369&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="12373709" author="kmarsden" created="Sat, 8 Apr 2006 12:13:28 +0100"  >&lt;p&gt;Checked in fix for this issue to 10.1&lt;/p&gt;

&lt;p&gt;Date: Fri Apr  7 18:16:59 2006&lt;br/&gt;
New Revision: 392471&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12329406">DERBY-1044</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12324897" name="derby1144.diff" size="14732" author="kmarsden" created="Tue, 4 Apr 2006 04:05:24 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22334</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy16lr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40720</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>