<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:13:05 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6178/DERBY-6178.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6178] AutoloadTest does not proprogate original jvm -D flags to spawned JVM, leading to LAB regression test failures</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6178</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;IBM lab nightly regression testing is seeing numerious intermittent errors while running the&lt;br/&gt;
AutoloadTest.   This regression testing often runs multiple runs of Suites.all on the same machine at&lt;br/&gt;
the same time and uses the -Dderby.tests.basePort=3500 option to the tests to insure network&lt;br/&gt;
server is created on different ports and don&apos;t intefere.&lt;/p&gt;

&lt;p&gt;I think the following code in this test that spawn a process is not going pass that port info onto the network&lt;br/&gt;
server startup and then lead to problems:&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Run 
{@code AutoloadTest}
&lt;p&gt; in a separate JVM.&lt;br/&gt;
     */&lt;br/&gt;
    public void spawnProcess() throws Exception {&lt;br/&gt;
        String[] cmd = &lt;/p&gt;
{
            &quot;junit.textui.TestRunner&quot;, spawnedTestClass.getName()
        }
&lt;p&gt;;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;        SpawnedProcess proc =&lt;br/&gt;
            new SpawnedProcess(execJavaCmd(cmd), spawnedTestClass.getName());&lt;/p&gt;

&lt;p&gt;        if (proc.complete() != 0) &lt;/p&gt;
{
            fail(proc.getFailMessage(&quot;Test process failed&quot;));
        }
&lt;p&gt;    }&lt;/p&gt;</description>
                <environment></environment>
        <key id="12642315">DERBY-6178</key>
            <summary>AutoloadTest does not proprogate original jvm -D flags to spawned JVM, leading to LAB regression test failures</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikem">Mike Matrigali</assignee>
                                    <reporter username="mikem">Mike Matrigali</reporter>
                        <labels>
                            <label>derby_backport_reject_10_8</label>
                    </labels>
                <created>Fri, 12 Apr 2013 21:48:06 +0100</created>
                <updated>Wed, 16 Apr 2014 03:41:11 +0100</updated>
                            <resolved>Mon, 15 Apr 2013 17:53:29 +0100</resolved>
                                    <version>10.9.2.2</version>
                    <version>10.10.2.0</version>
                    <version>10.11.1.1</version>
                                    <fixVersion>10.9.2.2</fixVersion>
                    <fixVersion>10.10.2.0</fixVersion>
                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13630618" author="mikem" created="Fri, 12 Apr 2013 22:00:23 +0100"  >&lt;p&gt;In trying to repro the various AutoloadTest errors I tried some experiments on my machine.  In 400 or so attempts using &lt;br/&gt;
various jvms and versions I was never able to reproduce the error.  For these experiments I made a copy of jdbcapi/_Suite.java&lt;br/&gt;
and then edited out all tests except for the AutoloadTest and called it _jdbcapisuite.java.  &lt;/p&gt;

&lt;p&gt;I then ran 2 of these concurrently and it failed a number of times with errors similar to what we are seeing in nightly runs.&lt;br/&gt;
Basically what you would expect from one test running in a network server and then having something external take it&lt;br/&gt;
down from underneath it.  &lt;/p&gt;

&lt;p&gt;Finally I tried running the following in 2 separate concurrent threads:&lt;/p&gt;

&lt;p&gt;    time java -Dderby.tests.trace=true -Dderby.tests.basePort=3500 junit.textui.&lt;br/&gt;
TestRunner org.apache.derbyTesting.functionTests.tests.jdbcapi._jdbcapisuite &amp;gt; t&lt;br/&gt;
est.out 2&amp;gt;&amp;amp;1&lt;br/&gt;
    time java -Dderby.tests.trace=true -Dderby.tests.basePort=3000 junit.textui.&lt;br/&gt;
TestRunner org.apache.derbyTesting.functionTests.tests.jdbcapi._jdbcapisuite &amp;gt; t&lt;br/&gt;
est.out 2&amp;gt;&amp;amp;1&lt;/p&gt;

&lt;p&gt;I tried this 200 times for each, and got 38 failures in one and 25 in the other.  In&lt;br/&gt;
looking at one of the failures I see in the derby.log that default network server port is&lt;br/&gt;
being used:&lt;br/&gt;
Fri Apr 12 11:35:39 PDT 2013 : Apache Derby Network Server - 10.11.0.0 alpha - (&lt;br/&gt;
1467322) started and ready to accept connections on port 1527^M&lt;/p&gt;

</comment>
                            <comment id="13630638" author="mikem" created="Fri, 12 Apr 2013 22:18:06 +0100"  >&lt;p&gt;It looks like the code in question was introduced to this test by&lt;br/&gt;
change #1303693, part of DERBY-&lt;/p&gt;</comment>
                            <comment id="13630758" author="mikem" created="Sat, 13 Apr 2013 00:33:37 +0100"  >&lt;p&gt;This patch disables running this test if basePort is set, until&lt;br/&gt;
someone fixes the test to handle concurrent runs with different baseports.  &lt;/p&gt;

&lt;p&gt;I tested that no AutoloadTest is run if baseport is set, and that all the tests are run as normal if no baseport is set.&lt;/p&gt;</comment>
                            <comment id="13631103" author="mikem" created="Sat, 13 Apr 2013 18:36:55 +0100"  >&lt;p&gt;disabled the test in trunk if non-default base port is set:&lt;br/&gt;
s1_ibm17:45&amp;gt;svn commit&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\jdbcapi\AutoloadTest.java&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\junit\TestConfiguration.java&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 1467664.&lt;/p&gt;</comment>
                            <comment id="13631143" author="mikem" created="Sat, 13 Apr 2013 21:04:11 +0100"  >&lt;p&gt;backported fix from trunk to 10.9 branch:&lt;br/&gt;
s10_9_ibm17:8&amp;gt;svn commit&lt;br/&gt;
Sending        .&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\jdbcapi\AutoloadTest.java&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\junit\TestConfiguration.java&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 1467688.&lt;/p&gt;</comment>
                            <comment id="13631144" author="mikem" created="Sat, 13 Apr 2013 21:05:55 +0100"  >&lt;p&gt;backported fix from trunk to 10.10 branch:&lt;br/&gt;
s10_10_ibm17:17&amp;gt;svn commit&lt;br/&gt;
Sending        .&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\jdbcapi\AutoloadTest.java&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\junit\TestConfiguration.java&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 1467683.&lt;/p&gt;</comment>
                            <comment id="13631145" author="mikem" created="Sat, 13 Apr 2013 21:07:34 +0100"  >&lt;p&gt;have disabled this test if baseport is set in 10.10, trunk, and 10.9 branches.&lt;/p&gt;</comment>
                            <comment id="13631852" author="mikem" created="Mon, 15 Apr 2013 17:53:29 +0100"  >&lt;p&gt;I am resolving this issue and plan on resolving and closing as duplicate all the outstanding &lt;br/&gt;
AutoloadTest issues that were encountered in IBM lab runs.  I have filed a new issue to&lt;br/&gt;
track work on fixing the test to correctly handle non-default baseports rather than just disabling&lt;br/&gt;
the test.  I tried fixing the test but did not have time to get it working.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12559535">DERBY-5800</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12608318">DERBY-5932</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12642106">DERBY-6170</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12403361">DERBY-3861</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12642562">DERBY-6181</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12547005">DERBY-5664</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12578548" name="derby-6178.diff" size="2264" author="mikem" created="Sat, 13 Apr 2013 00:33:37 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322729</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10422"><![CDATA[High Value Fix]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzdj67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>323074</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>