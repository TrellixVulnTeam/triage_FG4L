<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:47:06 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3215/DERBY-3215.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3215] Potential NullPointerException in CachedPage class</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3215</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;There&apos;s a potential for a NullPointerException to be thrown in the in the org.apache.derby.impl.store.raw.data.CachedPage class.  In the writePage() method, there&apos;s a test of the myContainer reference to ensure it&apos;s not null (line 771), however in the else block, myContainer is dereferenced (line 836), where a NullPointerException is guaranteed to be thrown.&lt;/p&gt;</description>
                <environment>Windows XP</environment>
        <key id="12382792">DERBY-3215</key>
            <summary>Potential NullPointerException in CachedPage class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="jrv680">Jason Valentine</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Nov 2007 14:44:31 +0000</created>
                <updated>Wed, 30 Apr 2008 00:32:29 +0100</updated>
                            <resolved>Wed, 21 Nov 2007 15:54:20 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.2.1</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12543598" author="knutanders" created="Mon, 19 Nov 2007 15:39:55 +0000"  >&lt;p&gt;Here&apos;s the relevant part of CachedPage:&lt;/p&gt;

&lt;p&gt;			throw dataFactory.markCorrupt(&lt;br/&gt;
                StandardException.newException(&lt;br/&gt;
                    SQLState.FILE_WRITE_PAGE_EXCEPTION, nested, &lt;br/&gt;
                    identity, new Integer(myContainer.getPageSize())));&lt;/p&gt;

&lt;p&gt;What&apos;s interesting is that it passes in two arguments to the message builder (identity and new Integer(...)). However, message.xml defines the message like this:&lt;/p&gt;

&lt;p&gt;            &amp;lt;msg&amp;gt;&lt;br/&gt;
                &amp;lt;name&amp;gt;XSDG1.D&amp;lt;/name&amp;gt;&lt;br/&gt;
                &amp;lt;text&amp;gt;Page &lt;/p&gt;
{0}
&lt;p&gt; could not be written to disk, please check if disk is full.&amp;lt;/text&amp;gt;&lt;br/&gt;
                &amp;lt;arg&amp;gt;page&amp;lt;/arg&amp;gt;&lt;br/&gt;
            &amp;lt;/msg&amp;gt;&lt;/p&gt;

&lt;p&gt;That is, there&apos;s only one argument, which is the page identity. So the parameter which causes the NPE is not even used when the message is generated, and it can probably be removed.&lt;/p&gt;</comment>
                            <comment id="12543611" author="dagw" created="Mon, 19 Nov 2007 16:46:32 +0000"  >&lt;p&gt;Enclosing a patch which removes the unused second argument.&lt;br/&gt;
Running regression tests.&lt;/p&gt;</comment>
                            <comment id="12543704" author="dagw" created="Mon, 19 Nov 2007 22:07:37 +0000"  >&lt;p&gt;I should mention that the wrong usage of FILE_WRITE_PAGE_EXCEPTION occurs in one more&lt;br/&gt;
instance in the same method (except for the one susceptible to the empty pointer). The patch &lt;br/&gt;
corrects both instances. There are no occurences in other classes.&lt;/p&gt;</comment>
                            <comment id="12543725" author="knutanders" created="Mon, 19 Nov 2007 22:58:19 +0000"  >&lt;p&gt;Thanks Dag, the patch looks good to me. +1 to commit if the tests pass.&lt;/p&gt;

&lt;p&gt;Perhaps out of the scope for this issue, but I think it would increase the readability of the method if we moved the contents of the &quot;else&quot; part nearer the beginning of the method and said&lt;/p&gt;

&lt;p&gt;    FileContainer myContainer = ...;&lt;br/&gt;
    if (myContainer == null) &lt;/p&gt;
{
        throw ...;
    }

&lt;p&gt;As it is now, with more than 50 lines between &quot;if&quot; and &quot;else&quot;, it is not so easy to see what &quot;else&quot; refers to.&lt;/p&gt;</comment>
                            <comment id="12544099" author="dagw" created="Tue, 20 Nov 2007 22:30:45 +0000"  >&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3215&quot; title=&quot;Potential NullPointerException in CachedPage class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3215&quot;&gt;&lt;del&gt;DERBY-3215&lt;/del&gt;&lt;/a&gt;.diff committed as svn 596853. I will make a follow-up patch&lt;br/&gt;
to address Knut&apos;s suggestion; I think it is a good idea, but I prefer to commit just this&lt;br/&gt;
minimal error patch first.&lt;/p&gt;</comment>
                            <comment id="12544501" author="dagw" created="Wed, 21 Nov 2007 15:32:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3215&quot; title=&quot;Potential NullPointerException in CachedPage class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3215&quot;&gt;&lt;del&gt;DERBY-3215&lt;/del&gt;&lt;/a&gt;b changes to code to test for empty myContainer up front&lt;br/&gt;
as suggested, plus removes some unused imports. Regression tests&lt;br/&gt;
passed. Will commit shortly.&lt;/p&gt;</comment>
                            <comment id="12544504" author="dagw" created="Wed, 21 Nov 2007 15:53:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3215&quot; title=&quot;Potential NullPointerException in CachedPage class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3215&quot;&gt;&lt;del&gt;DERBY-3215&lt;/del&gt;&lt;/a&gt;b committed as svn 597123.&lt;/p&gt;</comment>
                            <comment id="12561177" author="dagw" created="Tue, 22 Jan 2008 00:20:55 +0000"  >&lt;p&gt;Merged both patches to 10.3 branch as svn 614068 after running &lt;br/&gt;
regression tests without errors.&lt;/p&gt;</comment>
                            <comment id="12561178" author="dagw" created="Tue, 22 Jan 2008 00:24:39 +0000"  >&lt;p&gt;Issue fixed on both trunk and 10.3 branch, so closing. Jason, please feel free to reopen&lt;br/&gt;
if you don&apos;t agree the issue should be closed.&lt;/p&gt;</comment>
                            <comment id="12593169" author="mikem" created="Wed, 30 Apr 2008 00:32:29 +0100"  >&lt;p&gt;just updating that the fix has already been merged to the 10.3 branch in january.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12369799" name="DERBY-3215.diff" size="908" author="dagw" created="Mon, 19 Nov 2007 16:46:32 +0000"/>
                            <attachment id="12369986" name="DERBY-3215b.diff" size="4224" author="dagw" created="Wed, 21 Nov 2007 15:32:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 19 Nov 2007 15:39:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23497</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0yvz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39470</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>