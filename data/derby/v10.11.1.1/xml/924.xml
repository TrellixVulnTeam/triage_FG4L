<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:25:08 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-924/DERBY-924.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-924] new JDBC4 metadata API getFunctions() needs to be implemented</title>
                <link>https://issues.apache.org/jira/browse/DERBY-924</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;For now I am implementing this to return empty result set so at least we&apos;re compliant, but we should be able to implement this one&lt;/p&gt;</description>
                <environment>JDK 1.6</environment>
        <key id="12328557">DERBY-924</key>
            <summary>new JDBC4 metadata API getFunctions() needs to be implemented</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dyret">Dyre Tjeldvoll</assignee>
                                    <reporter username="davidvc">David Van Couvering</reporter>
                        <labels>
                    </labels>
                <created>Sat, 4 Feb 2006 09:59:45 +0000</created>
                <updated>Wed, 1 Jul 2009 01:34:32 +0100</updated>
                            <resolved>Wed, 12 Apr 2006 17:41:19 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12366246" author="davidvc" created="Tue, 14 Feb 2006 06:44:27 +0000"  >&lt;p&gt;This is in a way a subtask.  This metadata method needs to return new values.  Right now it returns an empty result set.&lt;/p&gt;</comment>
                            <comment id="12367857" author="dyret" created="Mon, 27 Feb 2006 04:19:24 +0000"  >&lt;p&gt;I think this could be done in much the same way as for getProcedures. I think we can re-use the same query, as long as we change the restriction from ALIASTYPE = &apos;P&apos; to ALIASTYPE = &apos;F&apos;.  &lt;/p&gt;

&lt;p&gt;I&apos;m wondering if it is a good idea to select JAVACLASSNAME as REMARKS. But since this is not done for getProcedures it may not be a good idea to do it here either...&lt;/p&gt;</comment>
                            <comment id="12368112" author="dyret" created="Wed, 1 Mar 2006 00:31:34 +0000"  >&lt;p&gt;Actually, my prvious comment was wrong. getProcedures returns CAST ((JAVACLASSNAME || &apos;.&apos; || ALIASINFO-&amp;gt;getMethodName()) AS VARCHAR(32672)) AS REMARKS, so I&apos;ll use that for getFunctions() as well.&lt;/p&gt;

&lt;p&gt;There is a comment in metadata.properties saying:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;&apos;REMARKS&apos; column is VARCHAR(32672), which is the max length allowed&lt;/li&gt;
	&lt;li&gt;for a VARCHAR.  This is because Java methods with the complete&lt;/li&gt;
	&lt;li&gt;package name plus possible signature can grow to be rather long.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;That is probably true, but ODBC 2.0 SQLProcedures specifies, that this column should be VARCHAR(254). But I guess it is better to be consitent with the existing getProcedures() implementation.&lt;/p&gt;</comment>
                            <comment id="12368116" author="army" created="Wed, 1 Mar 2006 00:53:57 +0000"  >&lt;p&gt;&amp;gt; That is probably true, but ODBC 2.0 SQLProcedures specifies, that this column should be VARCHAR(254). &lt;/p&gt;

&lt;p&gt;Can you give a link reference that says this?  I don&apos;t deny it, I&apos;m just curious where this is.  When I look here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbc/htm/odbcsqlprocedurecolumns.asp&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbc/htm/odbcsqlprocedurecolumns.asp&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I see the type of REMARKS as &quot;VARCHAR&quot; with no length specification.  It&apos;s possible that &quot;254&quot; is hidden somewhere in there, but if you can give a direct reference that&apos;d be nice &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  My work with ODBC metadata in the past (esp. &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-107&quot; title=&quot;Add Support for ODBC Metadata Calls to Derby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-107&quot;&gt;&lt;del&gt;DERBY-107&lt;/del&gt;&lt;/a&gt;) has suggested that while type is important (ex. CHAR vs VARCHAR, INT vs SMALLINT, nullable vs. not nullable, etc), the specific length of the VARCHAR hasn&apos;t been a concern.  But of course that&apos;s just based on observation from the tests/scenarios I was working with.  If length &lt;em&gt;is&lt;/em&gt; specified as part of the ODBC specification, then perhaps that&apos;s something that needs further investigation (as part of a different Jira issue).&lt;/p&gt;</comment>
                            <comment id="12368118" author="army" created="Wed, 1 Mar 2006 00:56:00 +0000"  >&lt;p&gt;Oops, wrong link in previous comment.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbc/htm/odbcsqlprocedures.asp&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/odbc/htm/odbcsqlprocedures.asp&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Same kind of thing, though--VARCHAR has no length specified...&lt;/p&gt;</comment>
                            <comment id="12368123" author="dyret" created="Wed, 1 Mar 2006 01:39:55 +0000"  >&lt;p&gt;Yes, I see that those links say VARCHAR. &lt;/p&gt;

&lt;p&gt;I got VARCHAR(254) from &quot;ODBC 3.5 Developer&apos;s Guide&quot; by Roger E. Sanders, McGraw-Hill, (page 836). In the text it says &quot;Adapted from the table on pages 878-879 of Microsoft ODBC 3.0 Software Development Kit &amp;amp; Programmer&apos;s reference&quot;.&lt;/p&gt;</comment>
                            <comment id="12368293" author="dyret" created="Wed, 1 Mar 2006 23:52:05 +0000"  >&lt;p&gt;Patch (derby-924.v1.*). Ran derbyall (1.5) verify that there are no regressions. Also ran the jdbc4 suite without failures (except the report-problem caused by a Mustang bug). Please review. Thanks.&lt;/p&gt;</comment>
                            <comment id="12368294" author="dyret" created="Wed, 1 Mar 2006 23:56:17 +0000"  >&lt;p&gt;I&apos;m checking the &apos;Patch available&apos; box to signal that a new, as of yet unreviewed, patch has been uploaded to this issue. If that is not the intended use of this feature, please let me know, (there seems to be some discussion about this).&lt;/p&gt;</comment>
                            <comment id="12368493" author="rhillegas" created="Thu, 2 Mar 2006 22:31:51 +0000"  >&lt;p&gt;Looks clean to me. Derbyall passes modulo the expected failure in wisconsin. The jdbc4 tests also pass modulo the mustang timestamp formatting problem. I have checked in this patch as subversion revision 382379.&lt;/p&gt;</comment>
                            <comment id="12373061" author="dyret" created="Tue, 4 Apr 2006 17:40:54 +0100"  >&lt;p&gt;I&apos;m reopening this issue since the client and NS part was missing from the first patch. (The TestDbMetaData test appeared to run  successfully with all frameworks, but it actually ignored the framework and always ran in embedded mode. This has been fixed now). &lt;/p&gt;</comment>
                            <comment id="12373732" author="dyret" created="Sat, 8 Apr 2006 21:20:58 +0100"  >&lt;p&gt;Attaching new patch (derby-924.v2) that also implements getFunctions() in the client (through a stored procedure). Added a new test case to metadata.java to ensure that this is tested in the upgrade test. The new upgrade test ran successfully. Please review, thanks.&lt;/p&gt;</comment>
                            <comment id="12373839" author="knutanders" created="Mon, 10 Apr 2006 19:57:28 +0100"  >&lt;p&gt;The patch looks very good. There are however two issues that I would&lt;br/&gt;
like to have resolved before I commit the patch.&lt;/p&gt;

&lt;p&gt;1) In DatabaseMetaData.getFunctionsX() you have this comment:&lt;/p&gt;

&lt;p&gt;       // Uncomment the following line when &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-970&quot; title=&quot;Add new metadata methods to network client driver&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-970&quot;&gt;&lt;del&gt;DERBY-970&lt;/del&gt;&lt;/a&gt; is committed&lt;br/&gt;
       // checkServerJdbcVersionX() &lt;/p&gt;

&lt;p&gt;   Since your patch is likely to get into trunk before my &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-970&quot; title=&quot;Add new metadata methods to network client driver&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-970&quot;&gt;&lt;del&gt;DERBY-970&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
   patch, please copy checkServerJdbcVersionX() into your patch and&lt;br/&gt;
   enable the check.&lt;/p&gt;

&lt;p&gt;2) I liked the way you managed to test JDBC 4.0 functionality in a&lt;br/&gt;
   test that doesn&apos;t require jdk 1.6 to compile and run, but I don&apos;t&lt;br/&gt;
   see any good reason why the methods are invoked only when&lt;br/&gt;
   jvm&amp;gt;=1.6. That is, I would have removed these lines from&lt;br/&gt;
   metadata_test.java:&lt;/p&gt;

&lt;p&gt;        // Make sure the method is available in the interface&lt;br/&gt;
	Class.forName(&quot;java.sql.DatabaseMetaData&quot;).&lt;br/&gt;
	    getMethod(&quot;getFunctions&quot;, a);&lt;/p&gt;

&lt;p&gt;   With this change, getFunctions() will be tested in JVM 1.4/1.5 as&lt;br/&gt;
   well, and you don&apos;t need to add separate canons for 1.6. Also note&lt;br/&gt;
   that this change will require you to update&lt;br/&gt;
   Upgrade_10_1_10_2.out. (Actually, in your current patch you should&lt;br/&gt;
   have created a jdk16 version of Upgrade_10_1_10_2.out, but that&lt;br/&gt;
   won&apos;t be necessary now.) I ran the upgrade test (jvm 1.5 and 1.6)&lt;br/&gt;
   with this change, and the diff looked reasonable.&lt;/p&gt;</comment>
                            <comment id="12374060" author="dyret" created="Wed, 12 Apr 2006 00:43:05 +0100"  >&lt;p&gt;Third version of the patch which addresses the review comments. getFunctions is now tested with all jvm versions, and new master for the Upgrade test is included. &lt;/p&gt;</comment>
                            <comment id="12374100" author="knutanders" created="Wed, 12 Apr 2006 05:43:46 +0100"  >&lt;p&gt;Committed revision 393304.&lt;/p&gt;

&lt;p&gt;I made some small changes to the patch before committing it:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;two of the jdk16 canons touched by the patch were removed by the&lt;br/&gt;
     &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1178&quot; title=&quot;NetworkServer doesn&amp;#39;t handle new subclasses of SQLException correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1178&quot;&gt;&lt;del&gt;DERBY-1178&lt;/del&gt;&lt;/a&gt; fix&lt;/li&gt;
	&lt;li&gt;updated jdk13 canon for metadata.java on DerbyNetClient&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I still have one minor question about the patch. getFunctionsX() ends&lt;br/&gt;
with these two lines:&lt;/p&gt;

&lt;p&gt;        lastGetProceduresResultSet_ = executeCatalogQuery(cs);&lt;br/&gt;
        return lastGetProceduresResultSet_;&lt;/p&gt;

&lt;p&gt;Should this have been lastGetFunctionsResultSet_ instead? Not that it&lt;br/&gt;
matters, since none of the lastGetXXXResultSet_ variables seem to have&lt;br/&gt;
any other purpose than ensuring that a lot of garbage is kept on the&lt;br/&gt;
heap.&lt;/p&gt;</comment>
                            <comment id="12374150" author="dyret" created="Wed, 12 Apr 2006 17:41:16 +0100"  >&lt;p&gt;Thanks for committing Knut-Anders. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12328909">DERBY-968</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12323561" name="derby-924.v1.diff" size="8660" author="dyret" created="Wed, 1 Mar 2006 23:52:05 +0000"/>
                            <attachment id="12323562" name="derby-924.v1.stat" size="745" author="dyret" created="Wed, 1 Mar 2006 23:52:05 +0000"/>
                            <attachment id="12325083" name="derby-924.v2.diff" size="118303" author="dyret" created="Sat, 8 Apr 2006 21:20:58 +0100"/>
                            <attachment id="12325084" name="derby-924.v2.stat" size="1077" author="dyret" created="Sat, 8 Apr 2006 21:20:58 +0100"/>
                            <attachment id="12325207" name="derby-924.v3.diff" size="44574" author="dyret" created="Wed, 12 Apr 2006 00:43:03 +0100"/>
                            <attachment id="12325209" name="derby-924.v3.report.txt" size="4148" author="dyret" created="Wed, 12 Apr 2006 00:43:05 +0100"/>
                            <attachment id="12325208" name="derby-924.v3.stat" size="2015" author="dyret" created="Wed, 12 Apr 2006 00:43:05 +0100"/>
                            <attachment id="12325085" name="derbyall_report.txt" size="51340" author="dyret" created="Sat, 8 Apr 2006 21:20:58 +0100"/>
                            <attachment id="12323563" name="derbyall_report.v1.txt" size="3904" author="dyret" created="Wed, 1 Mar 2006 23:52:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 27 Feb 2006 04:19:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29780</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0t1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38523</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>