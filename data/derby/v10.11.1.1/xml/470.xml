<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:55:11 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-470/DERBY-470.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-470] Exception when using LOCALIZEDDISPLAY with JSR169</title>
                <link>https://issues.apache.org/jira/browse/DERBY-470</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;As I did not get any response to my mail, I am opening a JIRA issue for this.&lt;/p&gt;

&lt;p&gt;When I run the test i18n/I18NImportExport.java with JSR169 using IBM&apos;s J2ME/CDC/Foundation Profile, I get the following exception:&lt;br/&gt;
&quot;JAVA ERROR: java.lang.NoSuchMethodError: java/sql/ResultSet.getBigDecimal(II)Ljava/math/BigDecimal;&quot;&lt;/p&gt;

&lt;p&gt;In the test, LOCALIZEDDISPLAY is on and the table has a DECIMAL column. This causes the exception. On looking at the code, following is done to format DECIMAL types in LocalizedResource:&lt;/p&gt;

&lt;p&gt;if (type == Types.NUMERIC || type == Types.DECIMAL) { &lt;br/&gt;
      return  getNumberAsString(rs.getBigDecimal(columnNumber, rsm.getScale(columnNumber)));&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;where getNumberAsString method does the following:&lt;/p&gt;

&lt;p&gt;public String getNumberAsString(Object o){&lt;br/&gt;
      if (enableLocalized)&lt;/p&gt;
{
            return formatNumber.format(o, new StringBuffer(), new FieldPosition(0)).toString();
      }
&lt;p&gt;      else &lt;/p&gt;
{
            return o.toString();
      }
&lt;p&gt; }&lt;/p&gt;

&lt;p&gt;As a solution, I am planning to do the following:&lt;br/&gt;
1. Check for BigDecimal class in the JVM by doing a Class.forName&lt;br/&gt;
2. Call getNumberAsString for NUMERIC and DECIMAL types only if BigDecimal class is available. Otherwise, return rs.getString.&lt;/p&gt;

&lt;p&gt;This solution would mean that NUMERIC and DECIMAL types will not  be localized in these JVM environments. Please let me know if any comments on this.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Deepa&lt;/p&gt;
</description>
                <environment>IBM&amp;#39;s J2ME/CDC/Foundation Profile and JSR169</environment>
        <key id="12312603">DERBY-470</key>
            <summary>Exception when using LOCALIZEDDISPLAY with JSR169</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="deepa">Deepa Remesh</assignee>
                                    <reporter username="deepa">Deepa Remesh</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jul 2005 04:55:36 +0100</created>
                <updated>Fri, 30 Sep 2005 03:25:29 +0100</updated>
                            <resolved>Fri, 30 Sep 2005 03:25:29 +0100</resolved>
                                                    <fixVersion>10.1.2.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Localization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                            <comments>
                            <comment id="12316936" author="deepa" created="Thu, 28 Jul 2005 03:23:03 +0100"  >&lt;p&gt;I have added the following in  LocalizedResource.java to check if BigDecimal is available in the JVM.&lt;/p&gt;

&lt;p&gt;	private static boolean HAVE_BIG_DECIMAL;&lt;/p&gt;

&lt;p&gt;	{&lt;br/&gt;
		boolean haveBigDecimal;&lt;br/&gt;
		try &lt;/p&gt;
{
			Class.forName(&quot;java.math.BigDecimal&quot;);
			haveBigDecimal = true;
		}
&lt;p&gt; catch (Throwable t) &lt;/p&gt;
{
			haveBigDecimal = false;
		}
&lt;p&gt;		HAVE_BIG_DECIMAL = haveBigDecimal;&lt;br/&gt;
	}&lt;/p&gt;

&lt;p&gt;The above code is also there in org.apache.derby.impl.tools.ij.util.java. Will it be okay to make HAVE_BIG_DECIMAL in util.java public and re-use it? This would be good if there are more scenarios which may need a similar check. Please let me know and I can submit a new patch, if needed.&lt;/p&gt;

&lt;p&gt;With this patch, I have run derbyall with Sun JDK 1.4.2 and IBM&apos;s WCTME 5.7 J2ME/CDC/FP. In J2ME, one testcase failed. The failure is not related to this change.&lt;/p&gt;</comment>
                            <comment id="12319889" author="kmarsden" created="Thu, 25 Aug 2005 04:14:35 +0100"  >&lt;p&gt;Committed revision 239718 to fix this issue.  You can submit centralization of  HAVE_BIG_DECIMAL  as another patch or with other JS169  changes.&lt;/p&gt;

&lt;p&gt;It seems to me that for sharing the function  for multiple tools it would be better to put the internal api in a shared utility class under&lt;/p&gt;

&lt;p&gt;org.apache.derby.iapi.tools&lt;/p&gt;

&lt;p&gt;rather than making the function in ij.util public. &lt;/p&gt;

&lt;p&gt;Perhaps the fact that NUMERIC and DECIMAL types will not be localized in these JVM environments should be mentioned in the documentation.&lt;/p&gt;</comment>
                            <comment id="12320077" author="deepa" created="Fri, 26 Aug 2005 10:04:27 +0100"  >&lt;p&gt;I think this patch can be applied to 10.1 branch also. &lt;/p&gt;

&lt;p&gt;I am opening a sub-task to update documentation.&lt;/p&gt;</comment>
                            <comment id="12320421" author="kmarsden" created="Mon, 29 Aug 2005 23:28:58 +0100"  >&lt;p&gt;Committed revision 264135 to the 10.1 branch&lt;/p&gt;</comment>
                            <comment id="12320832" author="deepa" created="Fri, 2 Sep 2005 11:02:31 +0100"  >&lt;p&gt;This patch was committed as revision 239718 to trunk and revision 264135 to the 10.1 branch&lt;/p&gt;</comment>
                            <comment id="12329437" author="kmarsden" created="Fri, 16 Sep 2005 02:40:05 +0100"  >&lt;p&gt;just reopening to fix up fix version&lt;/p&gt;</comment>
                            <comment id="12330835" author="deepa" created="Fri, 30 Sep 2005 03:25:09 +0100"  >&lt;p&gt;reopening to fix fix version&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12311425" name="derby-470.diff" size="1893" author="deepa" created="Thu, 28 Jul 2005 03:23:03 +0100"/>
                            <attachment id="12311426" name="derby-470.status" size="177" author="deepa" created="Thu, 28 Jul 2005 03:23:03 +0100"/>
                    </attachments>
                <subtasks>
                            <subtask id="12313820">DERBY-542</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 25 Aug 2005 03:14:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21970</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy17pr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40900</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>