<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:07:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-349/DERBY-349.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-349] setByte() with executeBatch causes hang with client if mapping is invalid, e.g. setByte to DATE</title>
                <link>https://issues.apache.org/jira/browse/DERBY-349</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;setByte() followed by an addBatch() and then an executeBatch causes a hang.&lt;br/&gt;
May apply to any setXXX call that will result in any invalid conversion, possibly only those conversions handled by the client.&lt;/p&gt;

&lt;p&gt;See the test jdbcapi/parameterMapping, look for this bug number in the code, to see the cases disabled when running with the client.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12311271">DERBY-349</key>
            <summary>setByte() with executeBatch causes hang with client if mapping is invalid, e.g. setByte to DATE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bryanpendleton">Bryan Pendleton</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Sun, 12 Jun 2005 00:44:49 +0100</created>
                <updated>Thu, 13 Dec 2007 09:04:39 +0000</updated>
                            <resolved>Tue, 4 Apr 2006 02:16:50 +0100</resolved>
                                    <version>10.1.1.0</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Network Client</component>
                    <component>Network Server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12313649" author="djd" created="Wed, 15 Jun 2005 08:03:15 +0100"  >&lt;p&gt;Priority to minor, since this is an error (hang) with conversions that are not supported and when executing in a batch&lt;/p&gt;</comment>
                            <comment id="12369163" author="bryanpendleton" created="Tue, 7 Mar 2006 13:39:43 +0000"  >&lt;p&gt;I tried re-enabling the test code in parameterMapping.java, and the result was that I did &lt;b&gt;not&lt;/b&gt; get a hang, but rather got a blizzard of diffs involving parameter conversion errors, which seems to be the intended behavior of this test.&lt;/p&gt;

&lt;p&gt;I also got similar results from writing a trivial 10 line standalone test program.&lt;/p&gt;

&lt;p&gt;So those experiments seem to indicate that maybe this bug has already been fixed by some other change along the way over the last 9 months.&lt;/p&gt;

&lt;p&gt;I&apos;ll double-check my results some more, to make sure that I&apos;m not overlooking something.&lt;/p&gt;</comment>
                            <comment id="12372791" author="bryanpendleton" created="Sun, 2 Apr 2006 03:30:27 +0100"  >&lt;p&gt;I have convinced myself that the original problem described by this bug is no longer present in the product, and there are just some test problems that need to be cleaned up. The test problems include:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The disabled tests for the client need to be turned back on. This is easy; I just need to delete the code that disabled those tests. One question is whether to delete all the no-longer-needed &quot;if (executeBatchTests)&quot; blocks, or just delete the little section at the head of the setXXX() method and leave the boolean executeBatchTests variable present, but always set to TRUE. I am leaning toward cleaning up all the dead code, even though it&apos;s a larger diff.&lt;/li&gt;
	&lt;li&gt;When the client gets a data conversion error in executeBatch, it wraps the actual exception in a BatchUpdateException. However, the judge_setXXX method in parameterMapping.java doesn&apos;t grok this, and so I need to enhance it to crawl through the exception chain looking for the actual data conversion exception of interest.&lt;/li&gt;
	&lt;li&gt;Then I need to carefully examine the new output, to ensure that it is safe to update the master file.&lt;/li&gt;
	&lt;li&gt;Lastly, unfortunately, there are a whole bunch of master files for this test. There are variations for different JVMs, different JDBC drivers, etc. Yuck. I think I&apos;ll have to crawl though a bunch of them. Unfortunately, I don&apos;t have access to all those JVMS and drivers, so I may need help from the community.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Still, the bottom line is good news: when I&apos;m done, we&apos;ll have more tests running, and easier-to-read result files.&lt;/p&gt;

&lt;p&gt;And one less open bug. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

</comment>
                            <comment id="12372805" author="bryanpendleton" created="Sun, 2 Apr 2006 09:50:55 +0100"  >&lt;p&gt;Attached is &apos;derby-349-testFixes.diff&apos;, which is a patch proposal to resolve this issue. &lt;/p&gt;

&lt;p&gt;The diff is a tad hard to read, so here are some notes. The proposed patch does the following:&lt;/p&gt;

&lt;p&gt;1) Adds a utility routine called &apos;checkForInvalidConversion&apos; to parameterMapping.java. This routine knows how to hunt through a SQLException chain looking for the exception which indicates a data conversion error. I added this routine because I needed to change the 2 &quot;judge&quot; routines to teach them how to deal with a BatchUpdateException&apos;s underlying cause, and I didn&apos;t want to make the same change in 2 places, so I extracted the common code from the 2 &quot;judge&quot; routines into a shared routine and modified it there.&lt;/p&gt;

&lt;p&gt;2) Modifies parameterMapping.java so that the batch tests are always run. Formerly, the batch tests had some conditional logic in them allowing them to be skipped for certain data type combinations for the DerbyNetClient. That logic is no longer needed, since the DerbyNetClient now works.&lt;/p&gt;

&lt;p&gt;3) Updates the master output files for the JDK 1.4 and JDK 1.5 runs of parameterMapping.java under the DerbyNetClient framework.&lt;/p&gt;

&lt;p&gt;I did &lt;b&gt;not&lt;/b&gt; update the JDK 1.6 master file, because I do not have a JDK 1.6 environment here. If somebody who has access to that environment could please:&lt;br/&gt;
a) Apply this patch&lt;br/&gt;
b) Run java -Dframework=DerbyNetClient org.apache.derbyTesting.functionTests.harness.RunTest jdbcapi/parameterMapping.java under 1.6&lt;br/&gt;
c) Attach the parameterMapping.out that they get from their run to this issue&lt;/p&gt;

&lt;p&gt;then I will inspect the parameterMapping.out diffs for JDK 1.6, ensure that they are reasonable, and re-post the diff with those changes.&lt;/p&gt;

&lt;p&gt;Please have a look at this patch when you get a chance. It would be nice to re-enable these tests and resolve this JIRA issue.&lt;/p&gt;</comment>
                            <comment id="12372823" author="knutanders" created="Sun, 2 Apr 2006 17:06:09 +0100"  >&lt;p&gt;Attaching patch (jdk16-master.diff) which updates the jdk16 master file.&lt;/p&gt;</comment>
                            <comment id="12372839" author="bryanpendleton" created="Mon, 3 Apr 2006 02:00:00 +0100"  >&lt;p&gt;Thanks, Knut, that was fast!&lt;/p&gt;

&lt;p&gt;The jdk1.6 results look great, and I&apos;ve incorporated the masterfile update into the patch.&lt;/p&gt;

&lt;p&gt;Did you have any other comments or feedback on the patch?&lt;/p&gt;

&lt;p&gt;As I looked at it again, I see now that the JDK1.4 and JDK 1.5 result files are identical, so I don&apos;t think this test needs a separate jdk1.4 result file. So I&apos;ve changed the patch to delete the jdk1.5 result file.&lt;/p&gt;

&lt;p&gt;Attached are &apos;derby-349-stat-with-jdk15.txt&apos; and &apos;derby-349-diff-with-jdk16.txt&apos;. The new patch proposal adds the jdk1.6 master file update, and issues &apos;svn del&apos; on the jdk1.4 master file, rather than updating it.&lt;/p&gt;

&lt;p&gt;I&apos;ll mark this issue &quot;Patch Available&quot;, because I think it&apos;s ready to go now.&lt;/p&gt;</comment>
                            <comment id="12372840" author="bryanpendleton" created="Mon, 3 Apr 2006 02:01:43 +0100"  >&lt;p&gt;Patch is ready now, I believe.&lt;/p&gt;

&lt;p&gt;Also, a typo in my last comment: this patch deletes the jdk14 master, not the jdk15 master. The svn stat should make it clear.&lt;/p&gt;</comment>
                            <comment id="12372974" author="bryanpendleton" created="Tue, 4 Apr 2006 02:15:18 +0100"  >&lt;p&gt;Thanks Knut Anders for the review and the assistance with JDK 1.6. I&apos;ve committed this change as: &lt;a href=&quot;http://svn.apache.org/viewcvs?rev=391086&amp;amp;view=rev&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs?rev=391086&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12372976" author="bryanpendleton" created="Tue, 4 Apr 2006 02:16:49 +0100"  >&lt;p&gt;I&apos;ve committed the test changes and new master files.&lt;/p&gt;

&lt;p&gt;Dan, if you could please confirm that the tests are now passing for you, and then close this issue, I&apos;d be grateful.&lt;/p&gt;</comment>
                            <comment id="12551275" author="fuzzylogic" created="Thu, 13 Dec 2007 09:04:39 +0000"  >&lt;p&gt;This issue has been resolved for over a year with no further movement. Closing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12324853" name="derby-349-diff-with-jdk16.txt" size="364741" author="bryanpendleton" created="Mon, 3 Apr 2006 02:00:00 +0100"/>
                            <attachment id="12324852" name="derby-349-stat-with-jdk16.txt" size="409" author="bryanpendleton" created="Mon, 3 Apr 2006 02:00:00 +0100"/>
                            <attachment id="12324844" name="derby-349-testFixes.diff" size="185495" author="bryanpendleton" created="Sun, 2 Apr 2006 09:50:50 +0100"/>
                            <attachment id="12324850" name="jdk16-master.diff" size="86250" author="knutanders" created="Sun, 2 Apr 2006 17:06:09 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 7 Mar 2006 13:39:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21912</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy10j3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39736</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>