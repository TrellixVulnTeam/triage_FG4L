<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:27:11 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4564/DERBY-4564.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4564] Replication tests do not pick up derby.tests.networkServerStartTimeout setting</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4564</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The property derby.tests.networkServerStartTimeout is sometimes used with testing to extend the wait for network server when JVM options are specified that make the start very slow, for example, for IBM JVM testing, -Xnoquickstart&#160; is used for some runs.  The replication tests do not seem to pick up this property.  Even when set to 90000 the tests wait only for 75 seconds.&lt;/p&gt;

&lt;p&gt;testReplication_Local_StateTest_part1_1(org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun_Local_StateTest_part1_1)java.lang.Exception: Could not ping in 150 * 500ms.: DRDA_NoIO.S&lt;br/&gt;
:Could not connect to Derby Network Server on host 127.0.0.1, port 1527: Connection refused&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.ping(ReplicationRun.java:2804)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.pingServer(ReplicationRun.java:2776)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.startServer(ReplicationRun.java:2453)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun_Local_StateTest_part1_1.testReplication_Local_StateTest_part1_1(ReplicationRun_Local_StateTest_part1_1.java:86)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:63)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:109)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.runBare(ReplicationRun.java:199)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:16)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12457184">DERBY-4564</key>
            <summary>Replication tests do not pick up derby.tests.networkServerStartTimeout setting</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Feb 2010 17:48:55 +0000</created>
                <updated>Wed, 12 Jan 2011 22:24:37 +0000</updated>
                            <resolved>Thu, 25 Mar 2010 19:44:53 +0000</resolved>
                                    <version>10.5.3.0</version>
                                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12837414" author="kmarsden" created="Tue, 23 Feb 2010 19:48:11 +0000"  >&lt;p&gt;Attached is a patch for this issue.  I verified the property is getting picked up by the test in the description and will do a full test run and check in if there are no comments. &lt;/p&gt;</comment>
                            <comment id="12837549" author="dagw" created="Wed, 24 Feb 2010 00:39:12 +0000"  >&lt;p&gt;Looks good to me. +1&lt;/p&gt;</comment>
                            <comment id="12837564" author="kmarsden" created="Wed, 24 Feb 2010 01:29:20 +0000"  >&lt;p&gt;Running tests, all tests passed, but I saw this exception print to the console during the run.   It is right in the code path I changed so a bit worrisome. &lt;/p&gt;

&lt;p&gt;testReplication_Local_3_p5_DERBY_3878 java.net.SocketException: Connection reset&lt;br/&gt;
        at java.net.SocketInputStream.read(SocketInputStream.java:179)&lt;br/&gt;
        at java.net.SocketInputStream.read(SocketInputStream.java:101)&lt;br/&gt;
        at org.apache.derby.impl.drda.NetworkServerControlImpl.fillReplyBuffer(NetworkServerControlImpl.java:2809)&lt;br/&gt;
        at org.apache.derby.impl.drda.NetworkServerControlImpl.readResult(NetworkServerControlImpl.java:2753)&lt;br/&gt;
        at org.apache.derby.impl.drda.NetworkServerControlImpl.pingWithNoOpen(NetworkServerControlImpl.java:1214)&lt;br/&gt;
        at org.apache.derby.impl.drda.NetworkServerControlImpl.ping(NetworkServerControlImpl.java:1189)&lt;br/&gt;
        at org.apache.derby.drda.NetworkServerControl.ping(NetworkServerControl.java:395)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.ping(ReplicationRun.java:2632)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.pingServer(ReplicationRun.java:26&lt;br/&gt;
19)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.startServer(ReplicationRun.java:2&lt;br/&gt;
291)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun_Local_3_p5.testReplication_Local_&lt;br/&gt;
3_p5_DERBY_3878(ReplicationRun_Local_3_p5.java:100)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:599)&lt;br/&gt;
        at junit.framework.TestCase.runTest(TestCase.java:154)&lt;br/&gt;
        at junit.framework.TestCase.runBare(TestCase.java:127)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:109)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.runBare(ReplicationRun.java:207)&lt;br/&gt;
        at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.framework.TestResult.run(TestResult.java:103)&lt;br/&gt;
        at junit.framework.TestCase.run(TestCase.java:118)&lt;br/&gt;
        at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
        at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
        at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
        at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:16)&lt;br/&gt;
        at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
        at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
        at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
        at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
        at junit.textui.TestRunner.doRun(TestRunner.java:116)&lt;br/&gt;
        at junit.textui.TestRunner.start(TestRunner.java:172)&lt;br/&gt;
        at junit.textui.TestRunner.main(TestRunner.java:138)&lt;/p&gt;</comment>
                            <comment id="12838106" author="kmarsden" created="Thu, 25 Feb 2010 00:07:50 +0000"  >&lt;p&gt;I noticed the exception printed to the console has happened before in the nightlies for this test, e.g.&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/902522-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/902522-suites.All_diff.txt&lt;/a&gt;&lt;br/&gt;
The test actually prints out the stack trace and then creates and throws a new exception if the start time expires and this is the only place I see it printing out an exception.  I don&apos;t understand though why the test would not fail if this happened.    This is the relevant code from ReplicationRun&lt;/p&gt;

&lt;p&gt; String msg = &quot;Could not ping in &quot; &lt;br/&gt;
                + iterations + &quot; * &quot; + PINGSERVER_SLEEP_TIME_MILLIS + &quot;ms.: &quot;&lt;br/&gt;
                + finalException.getMessage();&lt;br/&gt;
        util.DEBUG( msg );&lt;br/&gt;
        finalException.printStackTrace(); // REMOVE?&lt;br/&gt;
        throw new Exception(msg);&lt;/p&gt;

&lt;p&gt;In the attached patch I changed this code to just throw finalException instead of creating a new exception and verified the test does fail with a setting of derby.tests.networkServerStartTimeout=500 and doesn&apos;t with it set to 5000 on my machine.&lt;/p&gt;

&lt;p&gt;I&apos;ll do one more full test run and then check in this change.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;</comment>
                            <comment id="12842796" author="kmarsden" created="Mon, 8 Mar 2010 19:49:17 +0000"  >&lt;p&gt;Myrna pointed out that this property should be seconds and not milliseconds.    I&apos;ll need to rework the replication fix.  Thanks Myrna for catching this.&lt;/p&gt;
</comment>
                            <comment id="12842816" author="kmarsden" created="Mon, 8 Mar 2010 21:14:32 +0000"  >&lt;p&gt;Here is the updated patch that uses seconds and not milliseconds.&lt;/p&gt;</comment>
                            <comment id="12849870" author="kmarsden" created="Thu, 25 Mar 2010 19:44:53 +0000"  >&lt;p&gt;won&apos;t go back further than 10.5 for now&lt;/p&gt;</comment>
                            <comment id="12913767" author="kmarsden" created="Wed, 22 Sep 2010 21:38:56 +0100"  >&lt;p&gt;I noticed a typo in the check in comment backport of part of  revision 921028. I fixed the comment but am not sure if it will show up &lt;br/&gt;
in subversion commits.  The check in was the revision below:&lt;/p&gt;

&lt;p&gt;r921211 | kmarsden | 2010-03-09 18:35:46 -0800 (Tue, 09 Mar 2010) | 5 lines&lt;/p&gt;

&lt;p&gt;DERBY -4564 Replication tests do not pick up derby.tests.networkServerStartTimeo&lt;br/&gt;
ut setting&lt;/p&gt;

&lt;p&gt;fix replication tests to use property as seconds, not milliseconds.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12436749" name="derby-4564_diff.txt" size="1500" author="kmarsden" created="Tue, 23 Feb 2010 19:48:11 +0000"/>
                            <attachment id="12436934" name="derby-4564_throwfinalexception_diff.txt" size="1820" author="kmarsden" created="Thu, 25 Feb 2010 00:07:50 +0000"/>
                            <attachment id="12438230" name="derby-4564_useseconds_diff.txt" size="1028" author="kmarsden" created="Mon, 8 Mar 2010 21:14:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 24 Feb 2010 00:39:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24340</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10423"><![CDATA[Newcomer]]></customfieldvalue>
    <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0nx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37693</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>