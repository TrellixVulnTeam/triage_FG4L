<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:38:28 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3726/DERBY-3726.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3726] Don&apos;t call RAFContainer.padFile() from instances of RAFContainer4</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3726</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;In this thread on derby-dev, &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/db-derby-dev/200806.mbox/%3c48530848.3020501@sbcglobal.net%3e&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/db-derby-dev/200806.mbox/%3c48530848.3020501@sbcglobal.net%3e&lt;/a&gt;,&lt;br/&gt;
it was mentioned that RAFContainer4 calls padFile() when creating a container. Since padFile() uses old I/O calls and the rest of RAFContainer4 uses NIO, it could possibly cause similar issues as those seen in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3347&quot; title=&quot;ERROR XSDB3: Container information cannot change once written&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3347&quot;&gt;&lt;del&gt;DERBY-3347&lt;/del&gt;&lt;/a&gt;. Although we haven&apos;t verified that this is a problem, we should try to avoid mixing old I/O and NIO to be on the safe side.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12398497">DERBY-3726</key>
            <summary>Don&apos;t call RAFContainer.padFile() from instances of RAFContainer4</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Jun 2008 12:17:08 +0100</created>
                <updated>Mon, 4 May 2009 19:22:11 +0100</updated>
                            <resolved>Wed, 25 Jun 2008 15:34:47 +0100</resolved>
                                    <version>10.3.3.0</version>
                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.2.0</fixVersion>
                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12605918" author="knutanders" created="Wed, 18 Jun 2008 12:43:27 +0100"  >&lt;p&gt;padFile() is called from three locations in RAFContainer. Two of the calls come from writePage(), which is overloaded in RAFContainer4 and therefore not called by RAFContainer4. The last one is in writeRAFHeader() where it is called if the container is being created.&lt;/p&gt;

&lt;p&gt;This last call is the one we&apos;ll need to get rid of for RAFContainer4, and it is actually quite easy to get rid of it for RAFContainer as well. Here&apos;s what writeRAFHeader() does when it&apos;s called with create=true:&lt;/p&gt;

&lt;p&gt;a) get an empty embryonic page by calling getEmbryonicPage(null), which is the same as calling new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;AllocPage.MAX_BORROWED_SPACE&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;b) pass the empty embryonic page to writeHeader() which initializes it and writes it to the file&lt;/p&gt;

&lt;p&gt;c) call padFile() to make sure the file ends on a page boundary (to work around a bug in the EPOC jvm)&lt;/p&gt;

&lt;p&gt;Now, if the the byte array returned from getEmbryonicPage(null) had the size of a full page instead of just a fraction of a page, the call to writeHeader() would automatically give us a file that ended on a page boundary. The attached patch (d3726-1a) therefore replaces the call to getEmbryonicPage(null) with new byte&lt;span class=&quot;error&quot;&gt;&amp;#91;pageSize&amp;#93;&lt;/span&gt;, and then it can also remove the call to padFile() and the special handling of fileData==null in getEmbryonicPage().&lt;/p&gt;

&lt;p&gt;Derbyall and suites.All ran cleanly on Solaris 10/JDK 6.&lt;/p&gt;</comment>
                            <comment id="12607181" author="kristwaa" created="Mon, 23 Jun 2008 12:00:04 +0100"  >&lt;p&gt;The patch looks good to me.&lt;br/&gt;
I&apos;m not sure we really need the EPOC JVM bug workaround, but it doesn&apos;t seem to affect Derby negatively to keep it.&lt;/p&gt;

&lt;p&gt;+1 to commit.&lt;/p&gt;</comment>
                            <comment id="12607202" author="knutanders" created="Mon, 23 Jun 2008 13:22:34 +0100"  >&lt;p&gt;Thanks for looking at the patch, Kristian. Committed revision 670534.&lt;/p&gt;

&lt;p&gt;I wasn&apos;t sure whether to keep the workaround for the EPOC bug or not, but I found it safest to keep it for now.&lt;/p&gt;

&lt;p&gt;I&apos;m planning to port the fix to 10.4 and possibly 10.3 as well.&lt;/p&gt;</comment>
                            <comment id="12607904" author="knutanders" created="Wed, 25 Jun 2008 10:13:44 +0100"  >&lt;p&gt;Merged to 10.4 and committed revision 671480.&lt;/p&gt;</comment>
                            <comment id="12608059" author="knutanders" created="Wed, 25 Jun 2008 15:34:47 +0100"  >&lt;p&gt;Merged to 10.3 and committed revision 671567.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12384210" name="d3726-1a.diff" size="2824" author="knutanders" created="Wed, 18 Jun 2008 12:43:27 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 23 Jun 2008 11:00:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30972</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0xw7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39309</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>