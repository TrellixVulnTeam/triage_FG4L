<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:40:41 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4208/DERBY-4208.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4208] Parameters ? with OFFSET and/or FETCH</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4208</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The new OFFSET/FETCH syntax does not support Parameters. &lt;/p&gt;

&lt;p&gt;From ij against the toursdb I would like to do the following:&lt;/p&gt;

&lt;p&gt;    ij&amp;gt; prepare foo as &apos;select * from cities offset ? rows fetch first 10 rows only&apos;;&lt;/p&gt;

&lt;p&gt;but results in the following syntax error: &lt;/p&gt;

&lt;p&gt;    ERROR 42X01: Syntax error: Encountered &quot;?&quot; at line 1, column 29.&lt;/p&gt;

&lt;p&gt;Parameterized OFFSET/FETCH is important for performance (can be prepared) and security (SQL strings not created on the fly).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12424478">DERBY-4208</key>
            <summary>Parameters ? with OFFSET and/or FETCH</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="sradman">Steve Radman</reporter>
                        <labels>
                    </labels>
                <created>Sun, 3 May 2009 13:11:44 +0100</created>
                <updated>Tue, 11 May 2010 00:48:07 +0100</updated>
                            <resolved>Tue, 25 Aug 2009 04:08:32 +0100</resolved>
                                    <version>10.5.1.1</version>
                                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12705580" author="dagw" created="Mon, 4 May 2009 13:55:25 +0100"  >&lt;p&gt;Right, since this feature is not included by the SQL standard (offset&lt;br/&gt;
is a &amp;lt;simple value specification&amp;gt;, not a &amp;lt;general value specification&amp;gt;&lt;br/&gt;
in the syntax), we didn&apos;t implement it in the first version, but I&lt;br/&gt;
definitely see the utility of this extension. Feel free to vote for&lt;br/&gt;
this issue is you want it, folks.&lt;/p&gt;</comment>
                            <comment id="12727875" author="dagw" created="Tue, 7 Jul 2009 02:54:16 +0100"  >&lt;p&gt;Here is a first cut at a patch for this functionality. What do people think,&lt;br/&gt;
should let Derby have this functionality in spite of the standard not catering for it?&lt;/p&gt;

&lt;p&gt;The code is currently a little clumsy since it more or less lets the current code&lt;br/&gt;
in peace, and just extends with treatment for dynamic parameters. Not for commit yet,&lt;br/&gt;
I&apos;d just like some feedback on the desirability and general approach for now.&lt;/p&gt;

&lt;p&gt;I added some tests for it as well.&lt;/p&gt;</comment>
                            <comment id="12728253" author="dagw" created="Tue, 7 Jul 2009 18:45:30 +0100"  >&lt;p&gt;Uploading a fairly complete version of this patch, I did some simplifications, removed cruft&lt;br/&gt;
and added NULL handling (supplying a NULL argument will give an error now),&lt;br/&gt;
and added more tests.&lt;/p&gt;

&lt;p&gt;A note: ParameterNode.setType always make the type nullable, no matter if the passed in DVD is not nullable, not sure why. This makes the parameter metadata for ? always nullable, which doesn&apos;t seem right here.. Since dynamic arguments in OFFSET/FETCH is outside the standard, we don&apos;t have any guidance here...&lt;/p&gt;</comment>
                            <comment id="12728326" author="rhillegas" created="Tue, 7 Jul 2009 20:55:40 +0100"  >&lt;p&gt;Hi Dag,&lt;/p&gt;

&lt;p&gt;Thanks for tackling this important usability issue. I agree that the handling of dynamic parameters looks a little complicated. We use dynamic parameters all across the language, practically anywhere that a ValueNode can appear. It&apos;s hard to believe that special generated methods are added to the factory signatures of the ResultSets for all of these instances. I would recommend tracking down how we handle ? in a statement like &quot;select * from t where a = ?&quot;. Thanks.&lt;/p&gt;</comment>
                            <comment id="12728401" author="dagw" created="Tue, 7 Jul 2009 23:47:33 +0100"  >&lt;p&gt;Thanks for looking at the patch, Rick, I am still learning how to best&lt;br/&gt;
go about the code generation in non-trivial cases..&lt;/p&gt;

&lt;p&gt;&amp;gt; I would recommend tracking down how we handle ? in a statement like&lt;br/&gt;
&amp;gt;  &quot;select * from t where a = ?&quot;.&lt;/p&gt;

&lt;p&gt;Actually, thats how I found the pattern to make to it work at all; I&lt;br/&gt;
did look at the restrict generated code, cf. here:&lt;/p&gt;

&lt;p&gt;     ProjectRestrictNode.generateMinion&lt;/p&gt;

&lt;p&gt;which does pass in specially generated methods to the result set, and&lt;br/&gt;
also see the usage of these generated methods:&lt;/p&gt;

&lt;p&gt;    ProjectRestrictResultSet.openCore: constantRestriction.invoke and&lt;br/&gt;
    ProjectRestrictResultSet.getNextRowCore: restriction.invoke&lt;/p&gt;

&lt;p&gt;so I don&apos;t yet understand how this particular usage of ? would lead me to a&lt;br/&gt;
simplification. &lt;/p&gt;

&lt;p&gt;I could probaby mimic the constantRestriction handling for the&lt;br/&gt;
constant, but I&apos;m can&apos;t yet see how that would simplify things, if&lt;br/&gt;
anything that&apos;s an overkill, because in our case, we only allow&lt;br/&gt;
literals for the constant case.&lt;/p&gt;

&lt;p&gt;I&apos;ll read some more code.. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12728436" author="dagw" created="Wed, 8 Jul 2009 01:06:18 +0100"  >&lt;p&gt;Uploading a slightly simplified version, which removes the special casing of&lt;br/&gt;
literals (code is generated uniformly when a row count is provided). This makes for less clutter&lt;br/&gt;
(e.g. two fewer args to the result set class/factory methods, only one range check instance).&lt;/p&gt;
</comment>
                            <comment id="12742473" author="dagw" created="Wed, 12 Aug 2009 18:35:25 +0100"  >&lt;p&gt;I will commit this shortly, if there are no further review comments.&lt;/p&gt;</comment>
                            <comment id="12746681" author="dagw" created="Sun, 23 Aug 2009 22:57:31 +0100"  >&lt;p&gt;Uploading a documentation patch for this change; derby-4208-docs-a.&lt;br/&gt;
Looked OK in the HTML pages view and in the .pdf.&lt;/p&gt;</comment>
                            <comment id="12747016" author="dagw" created="Mon, 24 Aug 2009 19:56:57 +0100"  >&lt;p&gt;Committed patch derby4208c as svn 807337 on trunk.&lt;br/&gt;
I will let it remain unresolved until the docs patch has been committed.&lt;/p&gt;</comment>
                            <comment id="12747138" author="chaase3" created="Tue, 25 Aug 2009 00:25:09 +0100"  >&lt;p&gt;The doc looks fine, Dag, thanks! One line of code is long and runs over a line in the PDF, making a line break that wouldn&apos;t work in real code:&lt;/p&gt;

&lt;p&gt;PreparedStatement p = con.prepareStatement(&quot;SELECT * FROM T ORDER BY I OFFSET ? ROWS&quot;);&lt;/p&gt;

&lt;p&gt;You might fix it like this:&lt;/p&gt;

&lt;p&gt;PreparedStatement p = &lt;br/&gt;
    con.prepareStatement(&quot;SELECT * FROM T ORDER BY I OFFSET ? ROWS&quot;);&lt;/p&gt;

&lt;p&gt;This is optional if you don&apos;t want to bother &amp;#8211; people can probably figure it out.&lt;/p&gt;</comment>
                            <comment id="12747195" author="dagw" created="Tue, 25 Aug 2009 03:42:14 +0100"  >&lt;p&gt;Thanks for looking at the doc patch, Kim!&lt;br/&gt;
Uploading version &quot;b&quot; to fix the long time, committed as svn 807458.&lt;/p&gt;</comment>
                            <comment id="12747202" author="dagw" created="Tue, 25 Aug 2009 04:08:32 +0100"  >&lt;p&gt;Resolving.&lt;/p&gt;</comment>
                            <comment id="12851407" author="dagw" created="Tue, 30 Mar 2010 15:21:01 +0100"  >&lt;p&gt;Removing release note needed flag: this is a new feature which has been documented and it should not break existing applications.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12455644">DERBY-4541</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12415975">DERBY-4079</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12417419" name="derby4208-docs-a.diff" size="1747" author="dagw" created="Sun, 23 Aug 2009 22:57:31 +0100"/>
                            <attachment id="12417560" name="derby4208-docs-b.diff" size="1753" author="dagw" created="Tue, 25 Aug 2009 03:39:35 +0100"/>
                            <attachment id="12412688" name="derby4208a.diff" size="24356" author="dagw" created="Tue, 7 Jul 2009 02:54:16 +0100"/>
                            <attachment id="12412689" name="derby4208a.stat" size="753" author="dagw" created="Tue, 7 Jul 2009 02:54:16 +0100"/>
                            <attachment id="12412763" name="derby4208b.diff" size="26525" author="dagw" created="Tue, 7 Jul 2009 18:45:30 +0100"/>
                            <attachment id="12412764" name="derby4208b.stat" size="743" author="dagw" created="Tue, 7 Jul 2009 18:45:30 +0100"/>
                            <attachment id="12412805" name="derby4208c.diff" size="26039" author="dagw" created="Wed, 8 Jul 2009 01:06:18 +0100"/>
                            <attachment id="12412806" name="derby4208c.stat" size="733" author="dagw" created="Wed, 8 Jul 2009 01:06:18 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10362"><![CDATA[Performance]]></customfieldvalue>
    <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 4 May 2009 12:55:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31161</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10422"><![CDATA[High Value Fix]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0qdr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38092</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>