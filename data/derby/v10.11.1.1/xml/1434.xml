<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:47:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1434/DERBY-1434.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1434] Client can send incorrect database name to server after having made multiple connections to different databases.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1434</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I have a simple program that connects to a database using the Derby Client, executes a simple query, then connects to a different database using a different Connection object and executes another simple query on that second connection.  The queries both execute without error, so it appears that the connections are correct--i.e. each query will only work on one of the databases, and both queries work, therefore each must be getting executed against the correct database.&lt;/p&gt;

&lt;p&gt;But in looking at the client and server traces, I noticed that for the query on the second database, the client is actually sending the name of the &lt;b&gt;first&lt;/b&gt; database as RDBNAM, which (I think?) is wrong--it should be sending the name of the second database, since the query is being executed on the second Connection object.&lt;/p&gt;

&lt;p&gt;This behavior does not appear to occur for JCC.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12344754">DERBY-1434</key>
            <summary>Client can send incorrect database name to server after having made multiple connections to different databases.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="julo">Julius Stroffek</assignee>
                                    <reporter username="army">A B</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Jun 2006 05:54:07 +0100</created>
                <updated>Tue, 6 Mar 2007 09:40:47 +0000</updated>
                            <resolved>Fri, 24 Nov 2006 13:33:49 +0000</resolved>
                                    <version>10.1.3.1</version>
                    <version>10.2.1.6</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12417203" author="army" created="Thu, 22 Jun 2006 06:02:41 +0100"  >&lt;p&gt;Attaching a simple repro of the problem.  To run, start the server with tracing on:&lt;/p&gt;

&lt;p&gt;&amp;gt; java -Dderby.drda.traceAll=true org.apache.derby.drda.NetworkServerControl start -p 1527 &amp;amp;&lt;/p&gt;

&lt;p&gt;Then run the repro:&lt;/p&gt;

&lt;p&gt;&amp;gt; java d1434&lt;/p&gt;

&lt;p&gt;A look at the client trace in _driver_1 shows that the client is sending &quot;SECONDDB_2&quot; for the authentication phase-&lt;del&gt;i.e. for the EXCSAT, ACCSEC, SECCHK, and ACCRDB codepoints&lt;/del&gt;&lt;del&gt;but then it&apos;s sending &quot;FIRSTDB_1&quot; for the EXCSQLIMM codepoint.  However, a look at the the actual Connection object name shows that it is (correctly) the connection object for SECONDDB_2&lt;/del&gt;-so the connection is correct, but the database name is wrong.&lt;/p&gt;

&lt;p&gt;And a look at the server trace (Server2.trace) shows that the server is in fact receiving the wrong database name.&lt;/p&gt;

&lt;p&gt;I&apos;ve attached the server and client traces for the repro when run against 10.1.&lt;/p&gt;</comment>
                            <comment id="12417238" author="kmarsden" created="Thu, 22 Jun 2006 11:21:02 +0100"  >&lt;p&gt;A USER SYMPTOM&lt;/p&gt;

&lt;p&gt;I see that if our table in the first database has more data than can be retrieved in one QRYDTA  this can cause a  ResultSet to close prematurely if a query is executed against the second database before  all results are fetched from the server.&lt;/p&gt;

&lt;p&gt;TRIGGERING SCENARIO&lt;/p&gt;

&lt;p&gt;I am working with a user database, and  don&apos;t have the case incorporated into Army&apos;s repro , but  below is the general  code flow.&lt;/p&gt;

&lt;p&gt; PreparedStatement ps = conn1.prepareStatement(sql);&lt;/p&gt;

&lt;p&gt;	  rs = ps.executeQuery();  // execute a query from db 1 that returns a lot of  data&lt;br/&gt;
	  // get some data&lt;br/&gt;
	  rs.next();&lt;br/&gt;
	  // now interject another statement.&lt;br/&gt;
	  // This will reuse the statement id (pkgnamcsn) from our old db and close it.&lt;br/&gt;
	  PreparedStatement ps2 = conn2.prepareStatement(&quot;Select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from sys.systables&quot;);&lt;br/&gt;
	  ResultSet rs2 = ps.executeQuery();&lt;br/&gt;
	  rs2.next();&lt;br/&gt;
	  // now lets try to get the rest of the data from our first query.&lt;br/&gt;
		int rownum = 1;&lt;br/&gt;
		while(rs.next())&lt;/p&gt;
{
               ....
		}


&lt;p&gt;THE EXCEPTION&lt;/p&gt;

&lt;p&gt;SQLException: org.apache.derby.client.am.SqlException: Invalid operation: result set closed&lt;br/&gt;
org.apache.derby.client.am.SqlException: Invalid operation: result set closed&lt;br/&gt;
        at org.apache.derby.client.am.ResultSet.checkForClosedResultSet(ResultSet.java:3287)&lt;br/&gt;
        at org.apache.derby.client.am.ResultSet.nextX(ResultSet.java:250)&lt;br/&gt;
        at org.apache.derby.client.am.ResultSet.next(ResultSet.java:240)&lt;/p&gt;


&lt;p&gt;This occurs because  Network Server keys statements off of the PKGNAMCSCN which will be duplicated by the client incorrectly  in this case.  &lt;br/&gt;
The relevant server side code is in: org.apache.derby.impl.drda.Database:&lt;br/&gt;
protected DRDAStatement newDRDAStatement(Pkgnamcsn pkgnamcsn)&lt;br/&gt;
	throws SQLException&lt;br/&gt;
	{&lt;br/&gt;
		DRDAStatement stmt = getDRDAStatement(pkgnamcsn);&lt;br/&gt;
		if (stmt != null) &lt;/p&gt;
{
			stmt.close();
			stmt.reset();
		}
&lt;p&gt;It closes the statement as soon as it gets the duplicate pkgnamcsn in.   Of course the problem is that the client code sends a dup, not that the server closes when it sees a dup, but I don&apos;t  know where that code is off the top of my head #&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;


</comment>
                            <comment id="12417240" author="kmarsden" created="Thu, 22 Jun 2006 11:30:33 +0100"  >&lt;p&gt;Raising this to major as it can cause premature closing of the result set. and statement.&lt;/p&gt;</comment>
                            <comment id="12417352" author="kmarsden" created="Fri, 23 Jun 2006 03:26:29 +0100"  >&lt;p&gt;Well, I guess I have a little to say about the client code.&lt;br/&gt;
It looks like our client SectionManager logic is fatally flawed when it comes to two databases. It has these two static variables  for hold and non-hold  package names and consistency tokens.  &lt;/p&gt;

&lt;p&gt;// noHoldPKGNAMCBytes stores PKGNAMCBytes when holdability is no hold&lt;br/&gt;
    public static byte[] holdPKGNAMCBytes = null;&lt;br/&gt;
    public static byte[] noHoldPKGNAMCBytes = null;&lt;/p&gt;

&lt;p&gt;There seems to be a databaseName parameter for each SectionManager, so I don&apos;t understand why these  are static.&lt;/p&gt;</comment>
                            <comment id="12417392" author="kmarsden" created="Fri, 23 Jun 2006 07:35:38 +0100"  >&lt;p&gt;Wish I could delete the comment but the early closed result set with is issue is not a valid symptom.  This wrong line caused the test to fail.  Should have been ps2.&lt;/p&gt;

&lt;p&gt;ResultSet rs2 = ps.executeQuery(); &lt;/p&gt;</comment>
                            <comment id="12435827" author="rhillegas" created="Tue, 19 Sep 2006 15:49:28 +0100"  >&lt;p&gt;Moving to 10.2.2.0.&lt;/p&gt;</comment>
                            <comment id="12441150" author="julo" created="Tue, 10 Oct 2006 15:30:44 +0100"  >&lt;p&gt;Just posting the message below to the right place:&lt;br/&gt;
&amp;#8212;&lt;/p&gt;

&lt;p&gt;When client creates multiple connections to different databases (through the JDBC driver), the DRDA protocol &apos;always&apos; (I&apos;m not sure if always but i have not found any situation when it does not) sends the same PKGNAMCSN block as the one used for a first created connection.&lt;/p&gt;

&lt;p&gt;The reason of this behaviour is in a creation of the Section object in SectionManager using it&apos;s method &apos;getDynamicSection&apos;. It creates the section by calling the&lt;/p&gt;

&lt;p&gt;getSection(freeSections&lt;span class=&quot;error&quot;&gt;&amp;#91;Non&amp;#93;&lt;/span&gt;Hold_, packageNameWith&lt;span class=&quot;error&quot;&gt;&amp;#91;No&amp;#93;&lt;/span&gt;Hold_&lt;em&gt;, cursorNamePrefixWith&lt;span class=&quot;error&quot;&gt;&amp;#91;No&amp;#93;&lt;/span&gt;Hold&lt;/em&gt;_, resultSetHoldability)&lt;/p&gt;

&lt;p&gt;which later calls the init method of the Section class with the parameter isGenerated = false. Due to this the buffer which is used to store the PKGNAMCSN is initialized to the value stored in Agent.SectionManager.holdPKGNAMCBytes - this field is declared static so the value is shared among all created connections. The reusing of the value from the buffer is probably only a performance improvement and if the value in a Section object (created with isGenerated = false) is not initialized it is generated on demand and also stored to SectionManager.holdPKGNAMCBytes.&lt;/p&gt;

&lt;p&gt;I would suggest removing the static modifier from the fields noHoldPKGNAMCBytes and holdPKGNAMCBytes of the org.apache.derby.client.am.SectionManager class. Each Connection objects holds its own Agent object which holds its own SectionManager object. Thus, the PKGNAMCSN blocks will be generated once for each Connection object. Is this right?&lt;/p&gt;

&lt;p&gt;However, the description of DRDA protocol looks like a PKGNAMCSN block is important to identify the correct server&apos;s sql executional package (I&apos;m not an expert, it&apos;s only my opinion). How it is possible that sending a wrong PKGNAMCSN does not affect the database behavior? In the demonstration program on JIRA both connections connect to the same server instance. Might connecting these connections to different machines (or only server instances) lead to improper behavior? Why requests with the wrong PKGNAMCSN still work? I&apos;ll try two different machines tomorrow (approx. in 16 hours) and let you know.&lt;/p&gt;</comment>
                            <comment id="12441210" author="julo" created="Tue, 10 Oct 2006 18:10:58 +0100"  >&lt;p&gt;Two machines works fine. It seems that this behaviour does not have any influence on functionality.&lt;/p&gt;

&lt;p&gt;The databaseName parameter from the PKGNAMCBytes is never used by the server. The database is assigned to DRDAConnThread instance only in these functions on the server:&lt;/p&gt;

&lt;p&gt;org.apache.derby.impl.drda.DRDAConnThread.parseACCRDB()&lt;br/&gt;
org.apache.derby.impl.drda.DRDAConnThread.parseACCSEC()&lt;br/&gt;
org.apache.derby.impl.drda.DRDAConnThread.parseSECCHK()&lt;/p&gt;

&lt;p&gt;Thus, this behaviour should not cause using a wrong database (unless multiple databases are used in one session - which is  AFAIK not possible). The PKGNAMCSN is used in OPNQRY (used by PreparedStatement) to identify a statement in a org.apache.derby.impl.drda.Database.stmTable (by hashcode). However, the statement was even created with wrong PKGNAMCSN, so the hashes and even PKGNAMCSN of stored statement match.&lt;/p&gt;

&lt;p&gt;I observed a strange behaviour, when I changed the d1434.java (attached as d1434_v2.java) to insert multiple records in a database. The code in go method looks like (and behaves as described in comment).&lt;/p&gt;

&lt;p&gt;st.execute(&quot;create table FIRSTDB_T1 (i int, j int, k int)&quot;); // generates new PKGNAMCSN (but the same as before)&lt;br/&gt;
st.execute(&quot;insert into FIRSTDB_T1 values (21, 22, 23)&quot;);    // uses already generated PKGNAMCSN&lt;br/&gt;
st.execute(&quot;insert into FIRSTDB_T1 values (22, 23, 24)&quot;);    // generates new PKGNAMCSN (but the same as before)&lt;br/&gt;
st.execute(&quot;insert into FIRSTDB_T1 values (23, 24, 25)&quot;);    // uses already generated PKGNAMCSN&lt;br/&gt;
st.execute(&quot;insert into FIRSTDB_T1 values (24, 25, 26)&quot;);    // generates new PKGNAMCSN (but the same as before)&lt;/p&gt;

&lt;p&gt;st2.execute(&quot;create table SECONDDB_T1 (i int, j int, k int)&quot;); // uses already generated PKGNAMCSN&lt;br/&gt;
st2.execute(&quot;insert into SECONDDB_T1 values (11, 12, 13)&quot;);    // uses already generated PKGNAMCSN&lt;br/&gt;
st2.execute(&quot;insert into SECONDDB_T1 values (12, 13, 14)&quot;);    // uses already generated PKGNAMCSN&lt;br/&gt;
st2.execute(&quot;insert into SECONDDB_T1 values (13, 14, 15)&quot;);    // uses already generated PKGNAMCSN&lt;br/&gt;
st2.execute(&quot;insert into SECONDDB_T1 values (14, 15, 16)&quot;);    // uses already generated PKGNAMCSN&lt;/p&gt;</comment>
                            <comment id="12441455" author="julo" created="Wed, 11 Oct 2006 14:26:21 +0100"  >&lt;p&gt;Sumarization of behaviour:&lt;/p&gt;

&lt;p&gt;1.) For each connection to a database a Session object is created on a server. It is processed by a separate DRDAConnThread instance thread.&lt;/p&gt;

&lt;p&gt;2.) The database is assigned to DRDAConnThread object from the RDBNAM codepoint from terms ACCRDB, ACCSEC or SECCHK, which works correctly.&lt;/p&gt;

&lt;p&gt;3.) The Section Number in PKGNAMCSN code point is sent always correctly. This causes no problem with processing terms like CNTQRY or CLSQRY. The corresponding DRDAStatement object is found by looking for the whole PKGNAMCSN content. Because the wrong PKGNAMCSN is sent all the time and processed by the same instance of DRDAConnThread - it works also fine. The corresponding statements are managed locally by DRDAConnThread instance and the right statement is identified by the section number which is sent correctly.&lt;/p&gt;

&lt;p&gt;3.) In case of these terms PRPSQLSTT, EXCSQLIMM, OPNQRY, CNTQRY, CLSQRY, PRPSQLSTT, DSCSQLSTT, EXCSQLSTT, the codepoint PKGNAMCSN is optional in DRDA DDM but is mandatory for Derby&apos;s implementation. Instead of sending PKGNAMCSN the PKGSN code point is sufficient. This might increase a performance a bit. Derby has also some optimalizations parsing the pkgnamcsn assuming that PKGNAMCSN is the same most of the time (I cannot see any case when it should differ).&lt;/p&gt;

&lt;p&gt;Small note:&lt;br/&gt;
Code point PKGNAMCSN is optional in EXCSQLSET (even not described by DRDA DDM, but sent only by jcc1.2 driver), but according the comments in parseEXCSQLSET it is also required (changing the comment is sufficient).&lt;/p&gt;</comment>
                            <comment id="12441470" author="julo" created="Wed, 11 Oct 2006 15:43:14 +0100"  >&lt;p&gt;The database is also choosed from RDBNAM code point also in these terms: &lt;br/&gt;
OPNQRY, CNTQRY, PRPSQLSTT, DSCSQLSTT, EXCSQLSTT, EXCSQLIMM, EXCSQLSET, CLSQRY&lt;/p&gt;

&lt;p&gt;However, it have to be present in terms ACCRDB, ACCSEC or SECCHK in the connection before. If it is not, the error &quot;RDBNAM Mismatch&quot; is produced.&lt;/p&gt;</comment>
                            <comment id="12444318" author="julo" created="Tue, 24 Oct 2006 15:08:19 +0100"  >&lt;p&gt;Patch available.&lt;/p&gt;</comment>
                            <comment id="12445055" author="bryanpendleton" created="Fri, 27 Oct 2006 02:04:08 +0100"  >&lt;p&gt;There was some discussion of this issue, and the possible fixes, on the developer list:&lt;br/&gt;
&lt;a href=&quot;http://www.nabble.com/DERBY-1434---Client-can-send-incorrect-database-name-to-server-after-having-made-multiple-connections-to-different-databases.-tf2389323.html#a6705919&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/DERBY-1434---Client-can-send-incorrect-database-name-to-server-after-having-made-multiple-connections-to-different-databases.-tf2389323.html#a6705919&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12450088" author="julo" created="Wed, 15 Nov 2006 16:19:33 +0000"  >&lt;p&gt;I have to modify also a protocolTest.java because it was sending a wrong database name in PKGNAMCSN in all cases. I added two more tests.&lt;/p&gt;

&lt;p&gt;1.) drda protocol test to protocol.tests which ensures that the error of wrong RDBNAM field sent in PKGNAMCSN is handled correctly&lt;/p&gt;

&lt;p&gt;2.) junit test derbynet/DRDAProtocolTest.java which checks that on an application level the connections to different databases are handled correctly. The database files are not deleted yet after running a test. I have created a  	 &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2087&quot; title=&quot;Clean up of a database server directory after running junit tests.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2087&quot;&gt;&lt;del&gt;DERBY-2087&lt;/del&gt;&lt;/a&gt; to handle this.&lt;/p&gt;

&lt;p&gt;Please review&lt;/p&gt;</comment>
                            <comment id="12450091" author="julo" created="Wed, 15 Nov 2006 16:21:11 +0000"  >&lt;p&gt;I have to modify also a protocolTest.java because it was sending a wrong database name in PKGNAMCSN in all cases. I added two more tests.&lt;/p&gt;

&lt;p&gt;1.) drda protocol test to protocol.tests which ensures that the error of wrong RDBNAM field sent in PKGNAMCSN is handled correctly&lt;/p&gt;

&lt;p&gt;2.) junit test derbynet/DRDAProtocolTest.java which checks that on an application level the connections to different databases are handled correctly. The database files are not deleted yet after running a test. I have created a &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2087&quot; title=&quot;Clean up of a database server directory after running junit tests.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2087&quot;&gt;&lt;del&gt;DERBY-2087&lt;/del&gt;&lt;/a&gt; to handle this.&lt;/p&gt;

&lt;p&gt;Please review my change.&lt;/p&gt;</comment>
                            <comment id="12450097" author="julo" created="Wed, 15 Nov 2006 16:24:18 +0000"  >&lt;p&gt;Sorry for a mess in uploaded files, my connection got broken during first upload.&lt;/p&gt;

&lt;p&gt;These file describes my change:&lt;/p&gt;

&lt;p&gt;derby1434-try2.diff (attached multiple times, should have the same content)&lt;br/&gt;
derby1434-try2.stat&lt;/p&gt;
</comment>
                            <comment id="12450102" author="julo" created="Wed, 15 Nov 2006 16:31:09 +0000"  >&lt;p&gt;Just want to add that I ran all the junit tests and derbyall harness suit.&lt;/p&gt;</comment>
                            <comment id="12452082" author="knutanders" created="Wed, 22 Nov 2006 23:46:18 +0000"  >&lt;p&gt;Hi Julo,&lt;/p&gt;

&lt;p&gt;I haven&apos;t followed the discussion about this bug closely enough to say&lt;br/&gt;
whether the fix is correct, but it looks like it follows the approach&lt;br/&gt;
which was suggested in the discussion. The changes to the protocol&lt;br/&gt;
test also seem to be correct.&lt;/p&gt;

&lt;p&gt;A couple of questions/comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DRDAConnThread checks the version of the client. Is the check&lt;br/&gt;
   correct? Shouldn&apos;t the condition be&lt;br/&gt;
     (appRequester.getClientType() == AppRequester.DNC_CLIENT&lt;br/&gt;
       &amp;amp;&amp;amp; appRequester.greaterThanOrEqualTo(10,3,0)) ?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The class name in the copyright header in DRDAProtocolTest is wrong&lt;br/&gt;
   (&quot;lang&quot; should be &quot;derbynet&quot;).&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I think it would be good if the test case in DRDAProtocolTest had a&lt;br/&gt;
   comment which described what it is testing. Is it supposed to fail&lt;br/&gt;
   without the fix? In my environment it runs successfully even when&lt;br/&gt;
   the fix is not applied.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;It seems like your editor is set up with tab stops at eight&lt;br/&gt;
   characters. The Derby code uses tab stops at four characters, so&lt;br/&gt;
   the indentation does not match the indentation of the surrounding&lt;br/&gt;
   code. It would be good if you changed your tab settings and fixed&lt;br/&gt;
   the indentation.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12452204" author="julo" created="Thu, 23 Nov 2006 11:08:24 +0000"  >&lt;p&gt;Thanks for your comments. Sending a new version of a patch (*-try3.diff).&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The condition is correct but the explanation in a comment was a bit different than the condition. The check should not be performed only for the DNC_CLIENT version less then 10.3.0. I updated the comment.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;fixed&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I described a bit. However the test does not test much. The test should succeed without a fix. It should fail only if you apply a fix without changes in SectionManager.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;fixed&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I changed only comments and indentation so I only compiled the sources and run suites.All, no harness derbyall suite.&lt;/p&gt;</comment>
                            <comment id="12452247" author="knutanders" created="Thu, 23 Nov 2006 14:00:54 +0000"  >&lt;p&gt;Thanks for the explanations, Julo. They all make sense. So DRDAConnThread is supposed to check that the database name is correct if the DB2 client is used as well? Have you tested that it works with the DB2 client?&lt;/p&gt;</comment>
                            <comment id="12452406" author="julo" created="Fri, 24 Nov 2006 10:14:45 +0000"  >&lt;p&gt;The last sentense in the description of the issue states that the JCC driver works fine, so I have not tested this before.&lt;/p&gt;

&lt;p&gt;I tried to run the test program manually for DB2JCC and it works fine.&lt;/p&gt;</comment>
                            <comment id="12452452" author="knutanders" created="Fri, 24 Nov 2006 13:33:49 +0000"  >&lt;p&gt;Thank you. I ran derbyall and the JUnit tests with no failures. Committed revision 478877.&lt;/p&gt;</comment>
                            <comment id="12455757" author="kartha" created="Tue, 5 Dec 2006 21:14:21 +0000"  >&lt;p&gt;I think this will be a useful fix for the 10.2 branch also, can one of the committers look into porting the fix.&lt;/p&gt;</comment>
                            <comment id="12455931" author="knutanders" created="Wed, 6 Dec 2006 09:14:48 +0000"  >&lt;p&gt;This fix cannot be merged to 10.2 automatically because it depends on some changes to the JUnit framework that have not been back-ported. It also contains a version check which should be changed if we port the fix (this check should also be changed on trunk if we back-port the fix).&lt;/p&gt;</comment>
                            <comment id="12456741" author="julo" created="Fri, 8 Dec 2006 09:12:46 +0000"  >&lt;p&gt;Could we just remove the static modifier from the fields noHoldPKGNAMCBytes and holdPKGNAMCBytes of the org.apache.derby.client.am.SectionManager class in 10.2 branch and update the version check in trunk? So porting no tests for 10.2 branch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12335737" name="Server2.trace" size="17112" author="army" created="Thu, 22 Jun 2006 06:02:41 +0100"/>
                            <attachment id="12335736" name="_driver_1" size="61106" author="army" created="Thu, 22 Jun 2006 06:02:41 +0100"/>
                            <attachment id="12335735" name="d1434.java" size="2414" author="army" created="Thu, 22 Jun 2006 06:02:41 +0100"/>
                            <attachment id="12342670" name="d1434_v2.java" size="3266" author="julo" created="Tue, 10 Oct 2006 18:09:48 +0100"/>
                            <attachment id="12343543" name="derby-1434-trunk-diff.txt" size="739" author="julo" created="Tue, 24 Oct 2006 15:08:19 +0100"/>
                            <attachment id="12345054" name="derby1434-try2.diff" size="35854" author="julo" created="Wed, 15 Nov 2006 16:21:11 +0000"/>
                            <attachment id="12345053" name="derby1434-try2.diff" size="35854" author="julo" created="Wed, 15 Nov 2006 16:19:33 +0000"/>
                            <attachment id="12345055" name="derby1434-try2.stat" size="963" author="julo" created="Wed, 15 Nov 2006 16:21:11 +0000"/>
                            <attachment id="12345542" name="derby1434-try3.diff" size="35690" author="julo" created="Thu, 23 Nov 2006 11:08:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 22 Jun 2006 10:21:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22504</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy137r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40171</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>