<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:47 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2537/DERBY-2537.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2537] implement pushing collation info to store, storing collation info in store metadata, and creating templates based on store metadata</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2537</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Implement subtasks associated with pushing and using collation info in store.&lt;/p&gt;

&lt;p&gt;As was discussed on list the aproach will be:&lt;br/&gt;
o store collation info gets passed into createConglomerate() using an enhanced version of the exising CollumnOrdering interface&lt;br/&gt;
o store collation info will also have to get passed into interface that adds a column to a heap&lt;br/&gt;
o collation info will be added to the store metadata so that correct collation datatypes can be created internal to store where there&lt;br/&gt;
    may no access to system catalogs (for instance at  database recovery time).   A new heap and btree metadata version will be&lt;br/&gt;
    added which will included a &quot;sparse&quot; on disk format which will describe those columns that have a collation id that is different&lt;br/&gt;
    than the default.  &lt;br/&gt;
o soft upgrade will be handled by insuring old format is readable by existing code and automatically creates current version of in memory structures by&lt;br/&gt;
    assuming all old format conglomerates have default collation info.  Soft upgrade will never create new format heap or btree metadata.&lt;br/&gt;
o hard upgrade will  write new format conglomerate metadata for conglomerates created after the upgrade, no work  will be done at upgrade time.  &lt;br/&gt;
    Note the  proposed implementation of collation feature in 10.3 will only allow new dbs to set alternate collation, so in 10.3 hard upgrade is not &lt;br/&gt;
    actually necessary but  provides a consistent approach to internal store structures.  It also will allow  for a future where more collation control&lt;br/&gt;
    is allowed in dbs.&lt;br/&gt;
o store needs to create templates sometimes, to do this with correct collation info some of the Monitor functionality to create templates will be&lt;br/&gt;
    moved from monitor into datatype factory and enhanced to take collaiton id info where it currently only takes format ids.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12366919">DERBY-2537</key>
            <summary>implement pushing collation info to store, storing collation info in store metadata, and creating templates based on store metadata</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12345445">DERBY-1478</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikem">Mike Matrigali</assignee>
                                    <reporter username="mikem">Mike Matrigali</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Apr 2007 18:51:25 +0100</created>
                <updated>Thu, 2 May 2013 03:29:07 +0100</updated>
                            <resolved>Tue, 29 May 2007 18:25:43 +0100</resolved>
                                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12487848" author="mikem" created="Tue, 10 Apr 2007 18:59:23 +0100"  >&lt;p&gt;derby2537_1.diff provides the initial framework for reading/writing the new collaiton metadata in store.  I ran all the tests and got a few errors that I am still looking at - I think these are not related to my changes but will resolve before committing the change.  This change is an incremental step, it just stores the default  collate info - more work is needed to get the new collate info down to store.&lt;/p&gt;

&lt;p&gt;Note when this gets checked in you will get errors accessing any existing databases created off the trunk.  We don&apos;t handle upgrade within versions in the trunk.  Upgrade from 10.2 db&apos;s will be fully supported when released.&lt;/p&gt;</comment>
                            <comment id="12488422" author="mikem" created="Thu, 12 Apr 2007 17:35:52 +0100"  >&lt;p&gt;This patch is an updated version of the derby2537_2.diff patch.  It adds a few missing new files and also includes changes to push the collation info from language down to store.  Some paths still have default collation hardcoded and have been marked TODO-COLLATION for implementation in subsequent checkins.  I plan to commit this patch.  It has passed full nightly tests, except for those issues being reported in main trunk.&lt;/p&gt;</comment>
                            <comment id="12490196" author="mikem" created="Fri, 20 Apr 2007 00:17:26 +0100"  >&lt;p&gt;derby-2537_3.diff  is not ready for checkin. The main goal of this checkin is to finish the work of creating&lt;br/&gt;
&quot;correct&quot; dvd templates in the store, using the store&apos;s collation metadata and the new interface that takes&lt;br/&gt;
a format id and collation id and gives back an template object which can be initialized by store with a &lt;br/&gt;
readExternal.  The bulk of the changes are work to get the DataValueFactory into places where before we&lt;br/&gt;
called a static monitor routine.   It passed all tests before being integrated with the latest change&lt;br/&gt;
to return DVD&apos;s from DataValueFactory.getNull().  After integration it failed as store needs &lt;br/&gt;
DataValueFactory.getNull() to support returning classes for RowLocations.  The specific implementation&lt;br/&gt;
of Rowlocations is currently hidden from the data factory, but they are known to implement DVD.  &lt;/p&gt;

&lt;p&gt;I am not sure what the right way to implement this is.  In this patch I added support for the heap row location&lt;br/&gt;
format id by calling the Monitor to get it  from the format id.  If this is not ok, does anyone have an alternate&lt;br/&gt;
suggestion?&lt;/p&gt;

&lt;p&gt;I am rerunning all the tests to see if there is any other problems.  If all the tests pass and I don&apos;t hear otherwise I will check this in, and if later a better suggestion on the rowlocation support comes I will be&lt;br/&gt;
happy to change it.&lt;/p&gt;</comment>
                            <comment id="12493988" author="mikem" created="Mon, 7 May 2007 08:53:25 +0100"  >&lt;p&gt;change 535770:&lt;br/&gt;
This checkin fixes create index, alter table, and bulk insert to correctly&lt;br/&gt;
set the collation in the persistent tables and indexes that they create.&lt;/p&gt;</comment>
                            <comment id="12493989" author="mikem" created="Mon, 7 May 2007 09:03:19 +0100"  >&lt;p&gt;I think I have updated all the code that creates base tables or indexes to pass correct collation ids, except for the 2 following&lt;br/&gt;
cases.  Can anyone give me an idea how to get the collation types, basically access the DataTypeDescriptor of the columns&lt;br/&gt;
they are loading into a store table (see sections marked TODO-COLLATE):&lt;/p&gt;

&lt;p&gt;The 2 classes left are: MaterializedResultSet.java and TemporaryRowHolderImpl.java&lt;/p&gt;

&lt;p&gt;It may be that default collation is all right.  The kind of thing I am worried about is one of these  conglomerates be used to&lt;br/&gt;
create a hash table which then store would create a bunch of objects using default collation and then somewhere up the&lt;br/&gt;
tree a compare happening on the objects in the hash table.  &lt;/p&gt;</comment>
                            <comment id="12499027" author="knutanders" created="Fri, 25 May 2007 11:38:10 +0100"  >&lt;p&gt;Are there any plans to investigate what caused the performance regression Olav reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2657&quot; title=&quot;Performance regression after check-in of svn 531971&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2657&quot;&gt;&lt;del&gt;DERBY-2657&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12369447">DERBY-2657</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12367399">DERBY-2557</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12355870" name="derby-2537_3.diff" size="46570" author="mikem" created="Fri, 20 Apr 2007 00:17:26 +0100"/>
                            <attachment id="12355261" name="derby2537_1.diff" size="53024" author="mikem" created="Tue, 10 Apr 2007 18:59:23 +0100"/>
                            <attachment id="12355435" name="derby2537_2.diff" size="137029" author="mikem" created="Thu, 12 Apr 2007 17:35:52 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 25 May 2007 10:38:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30507</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0mhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37460</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>