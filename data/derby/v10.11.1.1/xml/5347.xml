<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:28:52 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5347/DERBY-5347.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5347] Derby loops filling logs and consuming all CPU with repeated error: java.net.SocketException: EDC5122I Input/output error.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5347</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When a TCP/IP Stack on a z/OS system running Derby is stopped and started, Derby loops with the following stack trace repeated until disk space is exhausted on the logging file system:&lt;/p&gt;

&lt;p&gt;Wed Jul 20 07:49:51 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;The derby log we generated was 498 megabytes and had 1,883,750 of these stack traces.&lt;/p&gt;

&lt;p&gt;Since Derby originated from IBM, the following link may provide a valuable clue as to how to fix the defect in Derby:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www-01.ibm.com/support/docview.wss?uid=swg1PQ93090&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www-01.ibm.com/support/docview.wss?uid=swg1PQ93090&lt;/a&gt;&lt;/p&gt;</description>
                <environment>java version &amp;quot;1.5.0&amp;quot;&lt;br/&gt;
Java(TM) 2 Runtime Environment, Standard Edition (build pmz31devifx-20100215 (SR11 FP1 ))&lt;br/&gt;
IBM J9 VM (build 2.3, J2RE 1.5.0 IBM J9 2.3 z/OS s390-31 j9vmmz3123ifx-20100127a (JIT enabled)&lt;br/&gt;
J9VM - 20100122_52103_bHdSMr&lt;br/&gt;
JIT  - 20091016_1845ifx1_r8&lt;br/&gt;
GC   - 20091026_AA)&lt;br/&gt;
JCL  - 20100215</environment>
        <key id="12514817">DERBY-5347</key>
            <summary>Derby loops filling logs and consuming all CPU with repeated error: java.net.SocketException: EDC5122I Input/output error.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="forcers">Force Rs</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Jul 2011 20:47:43 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:14 +0100</updated>
                            <resolved>Wed, 21 Dec 2011 16:56:00 +0000</resolved>
                                    <version>10.7.1.1</version>
                                    <fixVersion>10.5.3.2</fixVersion>
                    <fixVersion>10.6.2.4</fixVersion>
                    <fixVersion>10.7.1.4</fixVersion>
                    <fixVersion>10.8.2.2</fixVersion>
                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Network Server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13068587" author="mikem" created="Wed, 20 Jul 2011 21:01:30 +0100"  >&lt;p&gt;To be clear the error report is that the file &quot;derby.log&quot; becomes big, not recovery log files located in the &quot;log&quot; directory.  I also assume that the system is running Derby network server configuration when the problem appears.  Could you include more of the derby.log file.   Reasonable would be a copy of the derby.log file starting from the top and including 10 or so reiterations of the stack trace.&lt;/p&gt;</comment>
                            <comment id="13068597" author="forcers" created="Wed, 20 Jul 2011 21:12:41 +0100"  >&lt;p&gt;Well, the error (i.e., the loop) only occurs when the TCP/IP stack job on a z/OS mainframe is terminated. &lt;br/&gt;
The logs filling up is a result of the loop.  Perhaps the description of this bug in general would have more appropriately been: &quot;Derby loops when z/OS TCP/IP Stack is brought down&quot;.&lt;/p&gt;

&lt;p&gt;Here is start of derby.log:&lt;/p&gt;

&lt;p&gt;Tue Jul 12 10:15:22 CDT 2011 : Apache Derby Network Server - 10.7.1.1 - (1040133) started and ready to accept connections on port 31527&lt;br/&gt;
----------------------------------------------------------------&lt;br/&gt;
Tue Jul 12 10:19:39 CDT 2011:&lt;br/&gt;
Booting Derby version The Apache Software Foundation - Apache Derby - 10.7.1.1 - (1040133): instance a816c00e-0131-1eea-9e03-000044b0af97 &lt;br/&gt;
on database directory /qa/BLAH300/jun28/blahdata/databases/LIVEDB  with class loader sun.misc.Launcher$AppClassLoader@4ee44ee4 &lt;br/&gt;
Loaded from &lt;a href=&quot;file:/qa/BLAH300/jun28/blahdb/lib/derby.jar&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/qa/BLAH300/jun28/blahdb/lib/derby.jar&lt;/a&gt;&lt;br/&gt;
java.vendor=IBM Corporation&lt;br/&gt;
java.runtime.version=pmz31devifx-20100215 (SR11 FP1 )&lt;br/&gt;
java.fullversion=J2RE 1.5.0 IBM J9 2.3 z/OS s390-31 j9vmmz3123ifx-20100127a (JIT enabled)&lt;br/&gt;
J9VM - 20100122_52103_bHdSMr&lt;br/&gt;
JIT  - 20091016_1845ifx1_r8&lt;br/&gt;
GC   - 20091026_AA&lt;br/&gt;
Database Class Loader started - derby.database.classpath=&apos;&apos;&lt;br/&gt;
Wed Jul 20 07:49:49 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:49:51 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:49:51 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:49:51 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:49:52 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:03 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:04 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:05 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:05 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:05 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:05 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:05 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:05 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:06 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:06 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:07 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:07 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:07 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:08 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:08 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:08 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:09 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:09 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:09 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:10 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.socketAccept(Native Method)&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:10 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.socketAccept(Native Method)&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;br/&gt;
Wed Jul 20 07:50:13 CDT 2011 : EDC5122I Input/output error.&lt;br/&gt;
java.net.SocketException: EDC5122I Input/output error.&lt;br/&gt;
	at java.net.PlainSocketImpl.socketAccept(Native Method)&lt;br/&gt;
	at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:457)&lt;br/&gt;
	at java.net.ServerSocket.implAccept(ServerSocket.java:473)&lt;br/&gt;
	at java.net.ServerSocket.accept(ServerSocket.java:444)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread$1.run(Unknown Source)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:241)&lt;br/&gt;
	at org.apache.derby.impl.drda.ClientThread.run(Unknown Source)&lt;/p&gt;</comment>
                            <comment id="13068624" author="kmarsden" created="Wed, 20 Jul 2011 21:45:10 +0100"  >&lt;p&gt;I think this is a problem in at org.apache.derby.impl.drda.ClientThread.  It seems that Derby is expecting all errors in this loop to be caused by the client and so will loop and retry, but I think the accept() call should cause the server itself to fail and exit.&lt;/p&gt;

&lt;p&gt;        for (;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; { // Nearly infinite loop. The loop is terminated if&lt;br/&gt;
                   // 1) We are shut down or 2) SSL won&apos;t work. In all&lt;br/&gt;
                   // other cases we just continue and try another&lt;br/&gt;
                   // accept on the socket.&lt;/p&gt;</comment>
                            <comment id="13090485" author="kmarsden" created="Wed, 24 Aug 2011 22:04:33 +0100"  >&lt;p&gt;I am trying to think of a way to make a generic test case for this issue so that accept() won&apos;t block but will encounter an error right away.  I first thought maybe I could do it by removing accept() permission from the policy but because  the  permissions are  identified by client, accept still blocks and we just get one error on each  connection attempt.  Can anyone think of any tricks to simulate this scenario?&lt;/p&gt;
</comment>
                            <comment id="13090519" author="kmarsden" created="Wed, 24 Aug 2011 22:38:25 +0100"  >&lt;p&gt;As a temporary hack,  I can simulate the behavior by putting serverSocket.setSoTimeout(1000); in the constructor, but this won&apos;t allow me to add a regression test unless I added some testing property.  &lt;/p&gt;</comment>
                            <comment id="13090598" author="kmarsden" created="Wed, 24 Aug 2011 23:55:26 +0100"  >&lt;p&gt;The following Exceptions can occur on ServerSocket.accept() and the behavior I am considering.&lt;/p&gt;

&lt;p&gt;    SecurityException - if a security manager exists and its checkAccept method doesn&apos;t allow the operation. &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Continue to log and loop as this would likely be just an unauthorized connection attempt.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;    IOException - if an I/O error occurs when waiting for a connection. &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Perhaps on these we should fail and shutdown the server,  only if it happens three times in a row with a one second wait in between as it may be some intermittent hardware I/O noise.  I am not sure if this is necessary or if we should just bail on the first IOException.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    SocketTimeoutException - if a timeout was previously set with setSoTimeout and the timeout has been reached. &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Shouldn&apos;t happen, but handle like IOException since it is a subclass of IOException.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;    IllegalBlockingModeException - if this socket has an associated channel, the channel is in non-blocking mode, and there is no connection ready to be accepted&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Shouldn&apos;t happen, log and shutdown the server.&lt;/li&gt;
&lt;/ul&gt;



</comment>
                            <comment id="13094675" author="kmarsden" created="Wed, 31 Aug 2011 17:42:34 +0100"  >&lt;p&gt;Are there thoughts on whether we should retry if an IOException occurs on accept() or just log and shutdown the server on the first occurrence?&lt;/p&gt;
</comment>
                            <comment id="13094826" author="forcers" created="Wed, 31 Aug 2011 20:43:23 +0100"  >&lt;p&gt;I am not a Derby expert, but I do have significant programming experience.&lt;/p&gt;

&lt;p&gt;I would not kill the server immediately.  At least 2 consecutive failures.&lt;/p&gt;

&lt;p&gt;I recently fixed our DB server.  We had a watchdog thread that was pinging the DB and, when the ping failed, was killing the server.  I had to change this to fail 3 consecutive times before killing the server.  Having one ping fail was merely a hiccup (or separate Derby bug). &lt;/p&gt;

&lt;p&gt;Just my two cents. &lt;/p&gt;</comment>
                            <comment id="13094880" author="kmarsden" created="Wed, 31 Aug 2011 21:40:45 +0100"  >&lt;p&gt;Thank you for the input.  I&apos;ll have it retry three times then with a 1 sec wait between each and log a warning to the log for each failure.&lt;/p&gt;

</comment>
                            <comment id="13102215" author="kmarsden" created="Sun, 11 Sep 2011 05:49:13 +0100"  >&lt;p&gt;Attaching a patch for this issue.  I am not ready commit but would appreciate review.  I don&apos; think this will make it for the release as I would like to first understand some behavior I am seeing in manual testing of the case where a client does not have permission to connect under security manager.    &lt;/p&gt;

&lt;p&gt;Without the patch, after a couple failed security attempts I am seeing the server crash, but I am also seeing the same behavior without the patch. Either I am seeing some previously existing serious bug or perhaps my permissions are just way too restrictive in my policy file.  I&apos;ll nail down what&apos;s going on and file another bug if necessary.&lt;/p&gt;

</comment>
                            <comment id="13102638" author="knutanders" created="Mon, 12 Sep 2011 14:16:41 +0100"  >&lt;p&gt;The suggested approach looks fine to me. You may want to switch from PrivilegedExceptionAction to PrivilegedAction since the run() method doesn&apos;t throw any checked exceptions now. &lt;/p&gt;</comment>
                            <comment id="13151808" author="kmarsden" created="Thu, 17 Nov 2011 05:06:31 +0000"  >&lt;p&gt;I checked in the fix for this issue after making the change suggested by Knut.   I could not come up with a test case to make accept just fail and not block in my environment. I tried restricting accept permission but was surprised to find this only caused the client to be rejected and not the accept call to fail.   Does anyone have ideas for  a test case I can check in or even a manual test I could run on Windows or Linux (or even z/OS without administrator privs?&lt;/p&gt;

&lt;p&gt;Force Rs, would you be able to test the fix with trunk in a test environment?&lt;/p&gt;

&lt;p&gt; Unfortunately, I can&apos;t post a 10.8 patch right now as I picked a bad time to install svn and am suffering from this svn diff hang issue: &lt;a href=&quot;http://subversion.open.collab.net/ds/viewMessage.do?dsForumId=4&amp;amp;dsMessageId=434074&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://subversion.open.collab.net/ds/viewMessage.do?dsForumId=4&amp;amp;dsMessageId=434074&lt;/a&gt;&lt;br/&gt;
I&apos;ll work to get a different svn if it doesn&apos;t get fixed soon.&lt;/p&gt;</comment>
                            <comment id="13152073" author="forcers" created="Thu, 17 Nov 2011 14:28:33 +0000"  >&lt;p&gt;I will gladly test.  Easy to reproduce in my environment. &lt;/p&gt;

&lt;p&gt;We recently updated to Derby 10.8.2.2&lt;/p&gt;

&lt;p&gt;Is the fix in there?  If not, where do I go to get it?&lt;/p&gt;</comment>
                            <comment id="13152331" author="kmarsden" created="Thu, 17 Nov 2011 21:19:05 +0000"  >&lt;p&gt;Thank you for testing. I am sorry, it did not make it to 10.8.2.2&lt;/p&gt;

&lt;p&gt;You can test the fix with this trunk build:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://dbtg.foundry.sun.com/derby/bits/trunk/10.9.0.0alpha_2011-11-17T20-30-06_SVN1203267.zip&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.foundry.sun.com/derby/bits/trunk/10.9.0.0alpha_2011-11-17T20-30-06_SVN1203267.zip&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;but it should not touch any production or existing 10.8 database.  Once I get your confirmation that the issue is fixed, I will backport to the 10.8 branch.&lt;/p&gt;</comment>
                            <comment id="13152465" author="kmarsden" created="Thu, 17 Nov 2011 23:44:12 +0000"  >&lt;p&gt;Here is the 10.8 patch. svn diff is back!&lt;/p&gt;</comment>
                            <comment id="13160361" author="kmarsden" created="Wed, 30 Nov 2011 21:35:59 +0000"  >&lt;p&gt;Force Rs. Were you able to test this with the trunk build.   Do you need me to send you a 10.8 build?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;</comment>
                            <comment id="13160373" author="forcers" created="Wed, 30 Nov 2011 21:51:45 +0000"  >&lt;p&gt;Not tested yet.  Caught us at a major release QA point.  This will be tested next week.  I have the jars from the zip file provided 17/Nov/11 21:19.&lt;/p&gt;</comment>
                            <comment id="13174186" author="forcers" created="Wed, 21 Dec 2011 16:30:06 +0000"  >&lt;p&gt;Your fix works.&lt;/p&gt;

&lt;p&gt;QA reproduced the bug.  Applied the new jars.  Attempted to reproduce the bug.  It was not reproducible with the 10.9 jars.&lt;/p&gt;

&lt;p&gt;Thank you so much.&lt;/p&gt;

&lt;p&gt;I will be placing our Jira issue into pending state for now.  How will I know when a stable derby distributable is made available?&lt;/p&gt;</comment>
                            <comment id="13174205" author="kmarsden" created="Wed, 21 Dec 2011 16:56:00 +0000"  >&lt;p&gt;Resolving this issue. Thank you Force Rs for reporting this and  verifying the fix!&lt;br/&gt;
Ported fix to 10.8, 10.7, 10.6, and 10.5.  For some reason the 10.6 fix does not show up in subversion commits but was committed at 10.6 rev 1212214.&lt;/p&gt;


</comment>
                            <comment id="13174303" author="forcers" created="Wed, 21 Dec 2011 18:50:59 +0000"  >&lt;p&gt;Page &lt;a href=&quot;http://db.apache.org/derby/derby_downloads.html#Latest+Official+Release&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.apache.org/derby/derby_downloads.html#Latest+Official+Release&lt;/a&gt; lists 10.8.2.2 (October 24, 2011 / SVN 1181258) as the latest official release.&lt;/p&gt;

&lt;p&gt;To be clear, when Derby 10.8.2.3 is officially released, it will include your fix?&lt;/p&gt;

&lt;p&gt;Thanks again.&lt;/p&gt;</comment>
                            <comment id="13174325" author="kmarsden" created="Wed, 21 Dec 2011 19:08:18 +0000"  >&lt;p&gt;If there is a 10.8.2.3 release it will certainly include the fix, but I am not sure if/when someone will choose to volunteer to  make that release.&lt;/p&gt;

&lt;p&gt;As opposed to the trunk 10.9 build, I think it is perfectly reasonable to build a 10.8 with rolled up fixes and use it in production.  I know lots of users that do that.  It is of course not an official Apache release with all of the associated extensive testing and voting, but because we only typically backport low risk fixes,  I think it is a generally safe thing to do and may be  advisable in your case given the seriousness of this issue, especially if you think your users are likely to stop the TCP/IP Stack while network server is running.&lt;/p&gt;

</comment>
                            <comment id="13685170" author="knutanders" created="Mon, 17 Jun 2013 10:19:14 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12504143" name="derby-5347_10_8_diff.txt" size="4165" author="kmarsden" created="Thu, 17 Nov 2011 23:44:11 +0000"/>
                            <attachment id="12493945" name="derby-5347_diff.txt" size="3961" author="kmarsden" created="Sun, 11 Sep 2011 05:49:13 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10365"><![CDATA[Crash]]></customfieldvalue>
    <customfieldvalue key="10362"><![CDATA[Performance]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 20 Jul 2011 20:01:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24788</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0e0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36090</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>