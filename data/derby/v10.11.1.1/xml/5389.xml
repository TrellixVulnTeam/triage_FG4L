<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:21:06 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5389/DERBY-5389.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5389] SequenceGeneratorTest failures with weme 6.2 sane build ASSERT FAILED Identity being changed on a live cacheable</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5389</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I noticed these failures on trunk  10.9.0.0  1160489 with weme 6.2 and a sane build. They may have been around for some time as the nightlies only do an insane run with weme 6.2 and developers don&apos;t run weme tests with sane build frequently.&lt;/p&gt;

&lt;p&gt;2) test_09_defaultRangeSize(org.apache.derbyTesting.functionTests.tests.lang.SequenceGeneratorTest)java.sql.SQLException: The exception &apos;org.apache.de&lt;br/&gt;
rby.shared.common.sanity.AssertFailure: ASSERT FAILED Identity being changed on a live cacheable. Old uuidString = ff45762e-0131-f3dc-5f35-ffff92a7798&lt;br/&gt;
d&apos; was thrown while evaluating an expression.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.seeNextException(Util.java:278)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:407)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:348)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:82)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedResultSet.closeOnTransactionError(EmbedResultSet.java:4409)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:472)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedResultSet.next(EmbedResultSet.java:376)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.SequenceGeneratorTest.getScalarInteger(SequenceGeneratorTest.java:686)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.SequenceGeneratorTest.vetBumping(SequenceGeneratorTest.java:175)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.SequenceGeneratorTest.test_09_defaultRangeSize(SequenceGeneratorTest.java:608)&lt;br/&gt;
        at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:195)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:113)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: java.sql.SQLException: Java exception: &apos;ASSERT FAILED Identity being changed on a live cacheable. Old uuidString = ff45762e-0131-f3dc-5f35-&lt;br/&gt;
ffff92a7798d: org.apache.derby.shared.common.sanity.AssertFailure&apos;.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:412)&lt;br/&gt;
        ... 62 more&lt;br/&gt;
Caused by: org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED Identity being changed on a live cacheable. Old uuidString = ff45762e-01&lt;br/&gt;
31-f3dc-5f35-ffff92a7798d&lt;br/&gt;
        at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:162)&lt;br/&gt;
        at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:147)&lt;br/&gt;
        at org.apache.derby.impl.sql.catalog.SequenceUpdater.setIdentity(SequenceUpdater.java:255)&lt;br/&gt;
        at org.apache.derby.impl.services.cache.CachedItem.takeOnIdentity(CachedItem.java:222)&lt;br/&gt;
        at org.apache.derby.impl.services.cache.Clock.addEntry(Clock.java:800)&lt;br/&gt;
        at org.apache.derby.impl.services.cache.Clock.find(Clock.java:303)&lt;br/&gt;
        at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getCurrentValueAndAdvance(DataDictionaryImpl.java:10335)&lt;br/&gt;
        at org.apache.derby.impl.sql.execute.BaseActivation.getCurrentValueAndAdvance(BaseActivation.java:689)&lt;br/&gt;
        at org.apache.derby.exe.ac5135f637x0131xf3dcx5f35xffff92a7798d1.e0(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.services.reflect.DirectCall.invoke(ReflectGeneratedClass.java:139)&lt;br/&gt;
        at org.apache.derby.impl.sql.execute.RowResultSet.getNextRowCore(RowResultSet.java:148)&lt;br/&gt;
        at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(BasicNoPutResultSetImpl.java:478)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:432)&lt;br/&gt;
        ... 56 more&lt;br/&gt;
There was 1 failure:&lt;br/&gt;
1) test_08_userWrittenAllocators(org.apache.derbyTesting.functionTests.tests.lang.SequenceGeneratorTest)junit.framework.ComparisonFailure: Unexpected&lt;br/&gt;
SQL state. expected:&amp;lt;X&lt;span class=&quot;error&quot;&gt;&amp;#91;0Y85&amp;#93;&lt;/span&gt;&amp;gt; but was:&amp;lt;X&lt;span class=&quot;error&quot;&gt;&amp;#91;J001&amp;#93;&lt;/span&gt;&amp;gt;&lt;br/&gt;
        at java.lang.Throwable.&amp;lt;init&amp;gt;(Throwable.java:67)&lt;br/&gt;
        at junit.framework.AssertionFailedError.&amp;lt;init&amp;gt;(AssertionFailedError.java:13)&lt;br/&gt;
        at junit.framework.ComparisonFailure.&amp;lt;init&amp;gt;(ComparisonFailure.java:22)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertSQLState(BaseJDBCTestCase.java:791)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertSQLState(BaseJDBCTestCase.java:826)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertSQLState(BaseJDBCTestCase.java:840)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:1143)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.GeneratedColumnsHelper.expectExecutionError(GeneratedColumnsHelper.java:220)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.SequenceGeneratorTest.test_08_userWrittenAllocators(SequenceGeneratorTest.java:574)&lt;br/&gt;
        at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:195)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:113)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: java.sql.SQLException: Java exception: &apos;ASSERT FAILED Identity being changed on a live cacheable. Old uuidString = ff45762e-0131-f3dc-5f35-&lt;br/&gt;
ffff92a7798d: org.apache.derby.shared.common.sanity.AssertFailure&apos;.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:142)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.javaException(Util.java:299)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:412)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:407)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:348)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2290)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:82)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedResultSet.closeOnTransactionError(EmbedResultSet.java:4409)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:472)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedResultSet.next(EmbedResultSet.java:376)&lt;br/&gt;
        at org.apache.derbyTesting.junit.JDBC.assertDrainResults(JDBC.java:686)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseJDBCTestCase.fetchAndDiscardAllResults(BaseJDBCTestCase.java:1279)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:1139)&lt;br/&gt;
        ... 54 more&lt;br/&gt;
Caused by: org.apache.derby.shared.common.sanity.AssertFailure: ASSERT FAILED Identity being changed on a live cacheable. Old uuidString = ff45762e-01&lt;br/&gt;
31-f3dc-5f35-ffff92a7798d&lt;br/&gt;
        at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:162)&lt;br/&gt;
        at org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(SanityManager.java:147)&lt;br/&gt;
        at org.apache.derby.impl.sql.catalog.SequenceUpdater.setIdentity(SequenceUpdater.java:255)&lt;br/&gt;
        at org.apache.derby.impl.services.cache.CachedItem.takeOnIdentity(CachedItem.java:222)&lt;br/&gt;
        at org.apache.derby.impl.services.cache.Clock.addEntry(Clock.java:800)&lt;br/&gt;
        at org.apache.derby.impl.services.cache.Clock.find(Clock.java:303)&lt;br/&gt;
        at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getCurrentValueAndAdvance(DataDictionaryImpl.java:10335)&lt;br/&gt;
        at org.apache.derby.impl.sql.execute.BaseActivation.getCurrentValueAndAdvance(BaseActivation.java:689)&lt;br/&gt;
        at org.apache.derby.exe.ac942f362cx0131xf3dcx5f35xffff92a7798d1.e0(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.services.reflect.DirectCall.invoke(ReflectGeneratedClass.java:139)&lt;br/&gt;
        at org.apache.derby.impl.sql.execute.RowResultSet.getNextRowCore(RowResultSet.java:148)&lt;br/&gt;
        at org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow(BasicNoPutResultSetImpl.java:478)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(EmbedResultSet.java:432)&lt;br/&gt;
        ... 58 more &lt;/p&gt;</description>
                <environment>weme 6.2&lt;br/&gt;
java.runtime.version=2.4&lt;br/&gt;
java.fullversion=IBM J9 2.4 Windows XP x86-32  (JIT enabled, AOT enabled)&lt;br/&gt;
J9VM - 20080919_023055_lHdFGQ&lt;br/&gt;
JIT  - r9.weme62_20080724_2131&lt;br/&gt;
GC   - 20080609_AA&lt;br/&gt;
</environment>
        <key id="12519870">DERBY-5389</key>
            <summary>SequenceGeneratorTest failures with weme 6.2 sane build ASSERT FAILED Identity being changed on a live cacheable</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Aug 2011 20:58:36 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:42 +0100</updated>
                            <resolved>Thu, 22 Sep 2011 20:34:14 +0100</resolved>
                                                    <fixVersion>10.8.2.2</fixVersion>
                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13090983" author="rhillegas" created="Thu, 25 Aug 2011 13:54:04 +0100"  >&lt;p&gt;I see a version of this problem on phoneME. I need to disable the security manager in order to get the test to run there. I do this by specifying -Djava.security.policy=&quot;&amp;lt;NONE&amp;gt;&quot; on the command line. Running against sane jars I see the following:&lt;/p&gt;

&lt;p&gt;.Assertion failed at line 1396 in ../../src/share/javavm/runtime/jvm.c: count + 2 == CVMD_arrayGetLength(backtrace)&lt;br/&gt;
  JNI Frame         java.lang.Class.getMethod0(Ljava/lang/String;[Ljava/lang/Class;I)Ljava/lang/reflect/Method;(Native Method)&lt;br/&gt;
  Java Frame        java.lang.Class.getMethod(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;(Class.java:977)&lt;br/&gt;
  Java Frame        org.apache.derby.shared.common.sanity.AssertFailure.supportsThreadDump()Z(AssertFailure.java:136)&lt;br/&gt;
  Java Frame        org.apache.derby.shared.common.sanity.AssertFailure.dumpThreads()Ljava/lang/String;(AssertFailure.java:157)&lt;br/&gt;
  Java Frame        org.apache.derby.shared.common.sanity.AssertFailure.&amp;lt;init&amp;gt;(Ljava/lang/String;Ljava/lang/Throwable;)V(AssertFailure.java:72)&lt;br/&gt;
  Java Frame        org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(Ljava/lang/String;Ljava/lang/Throwable;)V(SanityManager.java:162)&lt;br/&gt;
  Java Frame        org.apache.derby.shared.common.sanity.SanityManager.THROWASSERT(Ljava/lang/String;)V(SanityManager.java:147)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.sql.catalog.SequenceUpdater.setIdentity(Ljava/lang/Object;)Lorg/apache/derby/iapi/services/cache/Cacheable;(SequenceUpdater.java:255)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.services.cache.CachedItem.takeOnIdentity(Lorg/apache/derby/iapi/services/cache/CacheManager;Lorg/apache/derby/iapi/services/cache/CacheableFactory;Ljava/lang/Object;ZLjava/lang/Object;)Lorg/apache/derby/iapi/servi  Java Frame        org.apache.derby.impl.services.cache.Clock.addEntry(Lorg/apache/derby/impl/services/cache/CachedItem;Ljava/lang/Object;ZLjava/lang/Object;)Lorg/apache/derby/iapi/services/cache/Cacheable;(Clock.java:800)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.services.cache.Clock.find(Ljava/lang/Object;)Lorg/apache/derby/iapi/services/cache/Cacheable;(Clock.java:303)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.sql.catalog.DataDictionaryImpl.getCurrentValueAndAdvance(ILjava/lang/String;Lorg/apache/derby/iapi/types/NumberDataValue;)V(DataDictionaryImpl.java:10335)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.sql.execute.BaseActivation.getCurrentValueAndAdvance(ILjava/lang/String;I)Lorg/apache/derby/iapi/types/NumberDataValue;(BaseActivation.java:689)&lt;br/&gt;
  Java Frame        org.apache.derby.exe.ac953a00d1x0132x00faxf0d0xffff932390437.e0()Ljava/lang/Object;(Unknown Source)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.services.reflect.DirectCall.invoke(Ljava/lang/Object;)Ljava/lang/Object;(ReflectGeneratedClass.java:139)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.sql.execute.RowResultSet.getNextRowCore()Lorg/apache/derby/iapi/sql/execute/ExecRow;(RowResultSet.java:148)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.sql.execute.BasicNoPutResultSetImpl.getNextRow()Lorg/apache/derby/iapi/sql/execute/ExecRow;(BasicNoPutResultSetImpl.java:478)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.jdbc.EmbedResultSet.movePosition(IILjava/lang/String;)Z(EmbedResultSet.java:432)&lt;br/&gt;
  Java Frame        org.apache.derby.impl.jdbc.EmbedResultSet.next()Z(EmbedResultSet.java:376)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.junit.JDBC.assertDrainResults(Ljava/sql/ResultSet;I)I(JDBC.java:686)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.junit.BaseJDBCTestCase.fetchAndDiscardAllResults(Ljava/sql/Statement;Z)V(BaseJDBCTestCase.java:1279)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(Ljava/lang/String;Ljava/sql/PreparedStatement;)V(BaseJDBCTestCase.java:1139)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.functionTests.tests.lang.GeneratedColumnsHelper.expectExecutionError(Ljava/sql/Connection;Ljava/lang/String;Ljava/lang/String;)V(GeneratedColumnsHelper.java:220)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.functionTests.tests.lang.SequenceGeneratorTest.test_09_defaultRangeSize()V(SequenceGeneratorTest.java:638)&lt;br/&gt;
  Transition Frame  org.apache.derbyTesting.functionTests.tests.lang.SequenceGeneratorTest.test_09_defaultRangeSize()V(Transition Method)&lt;br/&gt;
  Java Frame        java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;(Method.java:321)&lt;br/&gt;
  Java Frame        junit.framework.TestCase.runTest()V(TestCase.java:164)&lt;br/&gt;
  Java Frame        junit.framework.TestCase.runBare()V(TestCase.java:130)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.junit.BaseTestCase.runBare()V(BaseTestCase.java:112)&lt;br/&gt;
  Java Frame        junit.framework.TestResult$1.protect()V(TestResult.java:106)&lt;br/&gt;
  Java Frame        junit.framework.TestResult.runProtected(Ljunit/framework/Test;Ljunit/framework/Protectable;)V(TestResult.java:124)&lt;br/&gt;
  Java Frame        junit.framework.TestResult.run(Ljunit/framework/TestCase;)V(TestResult.java:109)&lt;br/&gt;
  Java Frame        junit.framework.TestCase.run(Ljunit/framework/TestResult;)V(TestCase.java:120)&lt;br/&gt;
  Java Frame        junit.framework.TestSuite.runTest(Ljunit/framework/Test;Ljunit/framework/TestResult;)V(TestSuite.java:230)&lt;br/&gt;
  Java Frame        junit.framework.TestSuite.run(Ljunit/framework/TestResult;)V(TestSuite.java:225)&lt;br/&gt;
  Java Frame        junit.extensions.TestDecorator.basicRun(Ljunit/framework/TestResult;)V(TestDecorator.java:24)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup$1.protect()V(TestSetup.java:21)&lt;br/&gt;
  Java Frame        junit.framework.TestResult.runProtected(Ljunit/framework/Test;Ljunit/framework/Protectable;)V(TestResult.java:124)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup.run(Ljunit/framework/TestResult;)V(TestSetup.java:25)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.junit.BaseTestSetup.run(Ljunit/framework/TestResult;)V(BaseTestSetup.java:57)&lt;br/&gt;
  Java Frame        junit.extensions.TestDecorator.basicRun(Ljunit/framework/TestResult;)V(TestDecorator.java:24)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup$1.protect()V(TestSetup.java:21)&lt;br/&gt;
  Java Frame        junit.framework.TestResult.runProtected(Ljunit/framework/Test;Ljunit/framework/Protectable;)V(TestResult.java:124)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup.run(Ljunit/framework/TestResult;)V(TestSetup.java:25)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.junit.BaseTestSetup.run(Ljunit/framework/TestResult;)V(BaseTestSetup.java:57)&lt;br/&gt;
  Java Frame        junit.extensions.TestDecorator.basicRun(Ljunit/framework/TestResult;)V(TestDecorator.java:24)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup$1.protect()V(TestSetup.java:21)&lt;br/&gt;
  Java Frame        junit.framework.TestResult.runProtected(Ljunit/framework/Test;Ljunit/framework/Protectable;)V(TestResult.java:124)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup.run(Ljunit/framework/TestResult;)V(TestSetup.java:25)&lt;br/&gt;
  Java Frame        junit.extensions.TestDecorator.basicRun(Ljunit/framework/TestResult;)V(TestDecorator.java:24)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup$1.protect()V(TestSetup.java:21)&lt;br/&gt;
  Java Frame        junit.framework.TestResult.runProtected(Ljunit/framework/Test;Ljunit/framework/Protectable;)V(TestResult.java:124)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup.run(Ljunit/framework/TestResult;)V(TestSetup.java:25)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.junit.BaseTestSetup.run(Ljunit/framework/TestResult;)V(BaseTestSetup.java:57)&lt;br/&gt;
  Java Frame        junit.extensions.TestDecorator.basicRun(Ljunit/framework/TestResult;)V(TestDecorator.java:24)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup$1.protect()V(TestSetup.java:21)&lt;br/&gt;
  Java Frame        junit.framework.TestResult.runProtected(Ljunit/framework/Test;Ljunit/framework/Protectable;)V(TestResult.java:124)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup.run(Ljunit/framework/TestResult;)V(TestSetup.java:25)&lt;br/&gt;
  Java Frame        org.apache.derbyTesting.junit.BaseTestSetup.run(Ljunit/framework/TestResult;)V(BaseTestSetup.java:57)&lt;br/&gt;
  Java Frame        junit.extensions.TestDecorator.basicRun(Ljunit/framework/TestResult;)V(TestDecorator.java:24)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup$1.protect()V(TestSetup.java:21)&lt;br/&gt;
  Java Frame        junit.framework.TestResult.runProtected(Ljunit/framework/Test;Ljunit/framework/Protectable;)V(TestResult.java:124)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup.run(Ljunit/framework/TestResult;)V(TestSetup.java:25)&lt;br/&gt;
  Java Frame        junit.extensions.TestDecorator.basicRun(Ljunit/framework/TestResult;)V(TestDecorator.java:24)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup$1.protect()V(TestSetup.java:21)&lt;br/&gt;
  Java Frame        junit.framework.TestResult.runProtected(Ljunit/framework/Test;Ljunit/framework/Protectable;)V(TestResult.java:124)&lt;br/&gt;
  Java Frame        junit.extensions.TestSetup.run(Ljunit/framework/TestResult;)V(TestSetup.java:25)&lt;br/&gt;
  Java Frame        junit.textui.TestRunner.doRun(Ljunit/framework/Test;Z)Ljunit/framework/TestResult;(TestRunner.java:121)&lt;br/&gt;
  Java Frame        junit.textui.TestRunner.start([Ljava/lang/String;)Ljunit/framework/TestResult;(TestRunner.java:185)&lt;br/&gt;
  Java Frame        junit.textui.TestRunner.main([Ljava/lang/String;)V(TestRunner.java:143)&lt;br/&gt;
  Transition Frame  junit.textui.TestRunner.main([Ljava/lang/String;)V(Transition Method)&lt;br/&gt;
  Java Frame        java.lang.reflect.Method.invoke(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;(Method.java:321)&lt;br/&gt;
  Java Frame        sun.misc.CVM.runMain()V(CVM.java:514)&lt;br/&gt;
  Transition Frame  sun.misc.CVM.runMain()V(Transition Method)&lt;br/&gt;
  Free List Frame   (JNI Local Frame)&lt;br/&gt;
Process #31164 received signal 11, suspending&lt;/p&gt;
</comment>
                            <comment id="13098314" author="rhillegas" created="Tue, 6 Sep 2011 21:15:15 +0100"  >&lt;p&gt;Attaching DERBY_5389.java. This test reproduces the problem. The test gets an EmbeddedSimpleDataSource and runs some queries. You need to compile the test using JDK 1.4. The test runs correctly under Java 5 but shows the error if you run under JDK 1.4.&lt;/p&gt;</comment>
                            <comment id="13102775" author="rhillegas" created="Mon, 12 Sep 2011 17:27:44 +0100"  >&lt;p&gt;Attaching derby-5389-01-aa-nullIdentity.diff. This adds some defensive logic to the identity setting method of SequenceUpdater. Without the defensive logic, a SequenceUpdater can be in an ambiguous state if there is an error instantiating a SequenceGenerator. I am running the full regression tests now.&lt;/p&gt;

&lt;p&gt;On an insane build and on Java 5 or higher, the ambiguous state appears to be harmless. The SequenceUpdater recovers from the ambiguity and correctly sets its state the next time that it actually becomes usable. However, if you are running on JDK 1.4 or CDC/FP 1.1, then Derby uses a different cache module (Clock instead of ConcurrentCache). The path through ConcurrentCache ends up cleaning the SequenceUpdater after the instantiation error, setting it to an unambiguously clean state.. The path through Clock does not clean the SequenceUpdater and this causes the Assertion to be raised the next time you try to set the identity of the ambiguous SequenceUpdater.&lt;/p&gt;

&lt;p&gt;The fix is to have the SequenceUpdater set its key to null if it can&apos;t instantiate a SequenceGenerator. This makes its internal state consistent and prevents us from raising the Assertion.&lt;/p&gt;

&lt;p&gt;With the fix, the repro runs cleanly on sane builds on JDK 1.4 and phoneME. In addition, the SequenceGenerator test runs cleanly for me on Java 6 and JDK 1.4. The test also gets further than it used to on phoneME. However, the test hangs at one point.  So there might be another problem behind this one.&lt;/p&gt;

&lt;p&gt;Kathey, could you test-drive the patch on a sane build on weme 6.2?&lt;/p&gt;


&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/catalog/SequenceUpdater.java&lt;/p&gt;</comment>
                            <comment id="13102860" author="rhillegas" created="Mon, 12 Sep 2011 19:06:16 +0100"  >&lt;p&gt;Tests passed cleanly for me.&lt;/p&gt;</comment>
                            <comment id="13106037" author="rhillegas" created="Fri, 16 Sep 2011 14:05:32 +0100"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;I realize you may be busy with release testing, but if you have a moment, I would be interested in whether this patch improves the situation on weme 6.2. Thanks.&lt;/p&gt;</comment>
                            <comment id="13106670" author="kmarsden" created="Fri, 16 Sep 2011 19:36:20 +0100"  >&lt;p&gt;Hi Rick,&lt;/p&gt;

&lt;p&gt;The test passes with weme 6.2. Thank you for the fix !&lt;/p&gt;

&lt;p&gt;test_01_basic used 344 ms .&lt;br/&gt;
test_02_boundary used 129938 ms .&lt;br/&gt;
test_03_nonCycling used 15 ms .&lt;br/&gt;
test_04_reboot used 703 ms .&lt;br/&gt;
test_05_concurrency used 532 ms .&lt;br/&gt;
test_06_bigStepSize used 0 ms .&lt;br/&gt;
test_07_dropSequence used 250 ms .&lt;br/&gt;
test_08_userWrittenAllocators used 140 ms .&lt;br/&gt;
test_09_defaultRangeSize used 188 ms .&lt;br/&gt;
test_10_5398 used 359 ms&lt;br/&gt;
Time: 139.828&lt;/p&gt;

&lt;p&gt;OK (10 tests)&lt;/p&gt;</comment>
                            <comment id="13107803" author="rhillegas" created="Mon, 19 Sep 2011 14:17:11 +0100"  >&lt;p&gt;Thanks for verifying the fix, Kathey. Committed at subversion revision 1172608.&lt;/p&gt;</comment>
                            <comment id="13107816" author="rhillegas" created="Mon, 19 Sep 2011 14:36:30 +0100"  >&lt;p&gt;Ported 1172608 from trunk to 10.8 branch at subversion revision 1172620.&lt;/p&gt;</comment>
                            <comment id="13685331" author="knutanders" created="Mon, 17 Jun 2013 10:19:42 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12524348">DERBY-5428</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12493206" name="DERBY_5389.java" size="1848" author="rhillegas" created="Tue, 6 Sep 2011 21:15:15 +0100"/>
                            <attachment id="12494057" name="derby-5389-01-aa-nullIdentity.diff" size="668" author="rhillegas" created="Mon, 12 Sep 2011 17:27:44 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 25 Aug 2011 12:54:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24811</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0dwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36070</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>