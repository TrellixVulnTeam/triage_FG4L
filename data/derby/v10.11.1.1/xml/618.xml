<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:32:28 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-618/DERBY-618.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-618] Make the client driver connection URL work when spaces are in the URL.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-618</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;At present, if I want to connect to a database on a Derby server which has a space in the path, there is no way to do it.&lt;/p&gt;

&lt;p&gt;This can be done with the embedded driver, and for consistency it would be good if it worked for the client driver in the same fashion.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12317840">DERBY-618</key>
            <summary>Make the client driver connection URL work when spaces are in the URL.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="deepa">Deepa Remesh</assignee>
                                    <reporter username="trejkaz">Trejkaz</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Oct 2005 10:48:38 +0100</created>
                <updated>Thu, 13 Dec 2007 09:04:43 +0000</updated>
                            <resolved>Fri, 10 Mar 2006 03:01:12 +0000</resolved>
                                    <version>10.1.1.0</version>
                                    <fixVersion>10.1.3.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12331853" author="trejkaz" created="Wed, 12 Oct 2005 10:59:38 +0100"  >&lt;p&gt;I just tried doing this by modifying ClientDriver.java to remove the space separators from all StringTokenizer calls.  If I do that, the connection works, but I get a new error a bit later on:&lt;/p&gt;

&lt;p&gt;Caused by: org.apache.derby.client.am.DisconnectException: A communication error has been detected. Communication protocol being used: Reply.fill(). Communication API being used: InputStream.read(). Location wh&lt;br/&gt;
ere the error was detected: insufficient data. Communication function detecting the error: *. Protocol specific error codes(s) TCP/IP SOCKETS&lt;br/&gt;
        at org.apache.derby.client.net.NetAgent.throwCommunicationsFailure(NetAgent.java:362)&lt;br/&gt;
        at org.apache.derby.client.net.Reply.fill(Reply.java:193)&lt;br/&gt;
        at org.apache.derby.client.net.Reply.ensureALayerDataInBuffer(Reply.java:212)&lt;br/&gt;
        at org.apache.derby.client.net.Reply.ensureBLayerDataInBuffer(Reply.java:225)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.parsePKGNAMCSN(NetStatementReply.java:1478)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.parsePKGSNLST(NetStatementReply.java:1721)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.parseRSLSETRM(NetStatementReply.java:1080)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.parseResultSetProcedure(NetStatementReply.java:343)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(NetStatementReply.java:279)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.readExecuteCall(NetStatementReply.java:97)&lt;br/&gt;
        at org.apache.derby.client.net.StatementReply.readExecuteCall(StatementReply.java:74)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatement.readExecuteCall_(NetStatement.java:174)&lt;br/&gt;
        at org.apache.derby.client.am.Statement.readExecuteCall(Statement.java:1105)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStatement.java:1426)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.executeQueryX(PreparedStatement.java:299)&lt;br/&gt;
        at org.apache.derby.client.am.DatabaseMetaData.executeCatalogQuery(DatabaseMetaData.java:1767)&lt;br/&gt;
        at org.apache.derby.client.am.DatabaseMetaData.getTablesX(DatabaseMetaData.java:1148)&lt;br/&gt;
        at org.apache.derby.client.am.DatabaseMetaData.getTables(DatabaseMetaData.java:1101)&lt;br/&gt;
        at com.nuix.store.database.AbstractDatabase.tableExists(AbstractDatabase.java:189)&lt;br/&gt;
        ... 12 more&lt;/p&gt;</comment>
                            <comment id="12368062" author="deepa" created="Tue, 28 Feb 2006 10:53:41 +0000"  >&lt;p&gt;I tried this by removing the space separator in the call to nextToken method in tokenizeDatabase method in ClientDriver.java. With this change, I am able to create and connect to a database with spaces in its name. I tried few simple operations like creates, inserts and selects with the database. &lt;/p&gt;

&lt;p&gt;Trejkaz mentions a getting a disconnect exception when trying some operation with such a database. From the stack trace, it looks like Trejkaz was getting an exception in the call to DatabaseMetaData.getTables. I tried this in a small repro and did not get any exception with my patch. Anyone has any idea what exactly was being done to get the stack trace above ? &lt;/p&gt;</comment>
                            <comment id="12368196" author="deepa" created="Wed, 1 Mar 2006 10:18:15 +0000"  >&lt;p&gt;Attaching a patch &apos;derby-618-v1.diff&apos;. This is a one line change in ClientDriver.java. It removes the space separator in the call to nextToken method in tokenizeDatabase method. This allows use of database names with spaces.&lt;/p&gt;

&lt;p&gt;With this patch, I can create and connect to databases with spaces in the path or name. After connecting to such a database, I tried few simple operations. I did not get any exceptions. I think Trejkaz was getting an exception because previously network server also did not support database name with spaces. The problem at network server was resolved as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-212&quot; title=&quot;Optimize some specific methods in Network Server to improve performance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-212&quot;&gt;&lt;del&gt;DERBY-212&lt;/del&gt;&lt;/a&gt;/&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-814&quot; title=&quot;Prevent unneeded object creation and excessive decoding in parsePKGNAMCSN()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-814&quot;&gt;&lt;del&gt;DERBY-814&lt;/del&gt;&lt;/a&gt;. Before this patch, parsePKGNAMCSN used to return a string with space separators (return rdbnam + &quot; &quot; + rdbcolid + &quot; &quot; + pkgid + &quot; &quot; + secnumber + &quot; &quot; + pkgcnstknStr&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. So, if the database name had spaces in it, it would&apos;nt work when the pkgnamcsn string is parsed later. This has been already fixed in the trunk.&lt;/p&gt;

&lt;p&gt;I have not added any new regression test for this patch since we will be able to run the test only on Windows. I think test harness does not allow excluding tests based on an operating system. I have repros to test this and I&apos;ll upload them shortly.&lt;/p&gt;

&lt;p&gt;With the patch, I have run derbynetclientmats using Sun JDK 1.4.2 on Windows XP. No failures. I would appreciate if someone can take a look at this patch.&lt;/p&gt;</comment>
                            <comment id="12368198" author="deepa" created="Wed, 1 Mar 2006 10:33:33 +0000"  >&lt;p&gt;Ataching repros to test the patch:&lt;/p&gt;

&lt;p&gt;1. repro1: derby-618.java - This is a simple java program which creates and connects to a database with spaces in path. And then does some operations on the database. &lt;/p&gt;

&lt;p&gt;2. repro2: derby-618-script.sql - This is an ij script.&lt;/p&gt;

&lt;p&gt;To run the repros:&lt;br/&gt;
1. Start network server on port 2222.&lt;br/&gt;
2. For repro1, run the command &apos;java derby-618&apos;.&lt;br/&gt;
3. For repro 2, start ij and run the script &apos;derby-618-script.sql&apos;.&lt;/p&gt;

&lt;p&gt;-----------------------------------&lt;br/&gt;
Without the patch:&lt;br/&gt;
-----------------------------------&lt;br/&gt;
The repros will not give any exception when run without the patch. They will just create the wrong databases:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;repro1 will create a database &apos;C:\directory&apos;&lt;/li&gt;
	&lt;li&gt;repro2 will create a database &apos;test&apos;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-----------------------------------&lt;br/&gt;
With the patch:&lt;br/&gt;
-----------------------------------&lt;br/&gt;
Repros should create the correct databases with spaces:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;repro1 will create &apos;C:\directory with spaces\db name with spaces&apos;&lt;/li&gt;
	&lt;li&gt;repro2 will create &apos;test db with spaces&apos;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12368202" author="trejkaz" created="Wed, 1 Mar 2006 11:26:04 +0000"  >&lt;p&gt;&amp;gt; I have not added any new regression test for this patch since we will be able to run the test only on Windows. &lt;/p&gt;

&lt;p&gt;Spaces exist on Linux as well, are you sure this issue only affected Windows?&lt;/p&gt;</comment>
                            <comment id="12368310" author="deepa" created="Thu, 2 Mar 2006 01:45:28 +0000"  >&lt;p&gt;Thanks for pointing this out. I think I can add a test to jdbcapi/checkDriver.java for an url with spaces in the database name. I had this wrong notion in my head that directory names with spaces apply only to Windows and hence not added a regression test. I see that other platforms allow creation of directory names with spaces, just that in some situations, it is recommended to avoid this. I will add this test and upload the new patch in a while. &lt;/p&gt;</comment>
                            <comment id="12368646" author="deepa" created="Fri, 3 Mar 2006 12:56:04 +0000"  >&lt;p&gt;Attaching a patch &apos;derby-618-v2.diff&apos; which includes code change and a test for this issue. Patch does the following:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Modifies ClientDriver.java - removes the space separator in the call to nextToken in tokenizeDatabase method. This allows use of URL containing database name with spaces.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Adds tests to jdbcapi/checkDriver.java for an url with spaces in database name. Since embedded and jcc driver work with spaces, I added this test for all three frameworks. Test verfies that the specified database gets created.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Modifies master files for the test&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Ran derbyall with Sun JDK 1.4.2 on Windows XP. I also ran jdbcapi/checkDriver.java with j9 vms. Please take a look at this patch. Thanks.&lt;/p&gt;</comment>
                            <comment id="12368783" author="kmarsden" created="Sat, 4 Mar 2006 04:55:02 +0000"  >&lt;p&gt;Checked this change into trunk but leaving opena and changing fixin to 10.1.2.3&lt;/p&gt;

&lt;p&gt;Date: Fri Mar  3 11:51:46 2006&lt;br/&gt;
New Revision: 382917&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewcvs?rev=382917&amp;amp;view=rev&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs?rev=382917&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12369675" author="deepa" created="Fri, 10 Mar 2006 01:21:33 +0000"  >&lt;p&gt;Attaching a patch &apos;derby-618-10.1.diff&apos; for 10.1 branch. Submiiting a patch because revision #382917 could not be merged directly using svn merge command. This patch requires the changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-814&quot; title=&quot;Prevent unneeded object creation and excessive decoding in parsePKGNAMCSN()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-814&quot;&gt;&lt;del&gt;DERBY-814&lt;/del&gt;&lt;/a&gt; to be applied to 10.1 branch first. This is uploaded as a separate patch at &lt;a href=&quot;http://issues.apache.org/jira/browse/DERBY-814&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/DERBY-814&lt;/a&gt;. Both these patches need to be committed together. I would appreciate if someone can look at these patches.&lt;/p&gt;

&lt;p&gt;Changes to resove the merge conflicts:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-618&quot; title=&quot;Make the client driver connection URL work when spaces are in the URL.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-618&quot;&gt;&lt;del&gt;DERBY-618&lt;/del&gt;&lt;/a&gt; - Manual merge was required for the test jdbcapi/checkDriver.java and masters since 10.1 branch tests hard-code localhost and do not have the test harness changes to get the host name.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-814&quot; title=&quot;Prevent unneeded object creation and excessive decoding in parsePKGNAMCSN()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-814&quot;&gt;&lt;del&gt;DERBY-814&lt;/del&gt;&lt;/a&gt; - Manual merge was required for DRDAConnThread.java (only conflict was in javadoc  comments) and Database.java (had to change two methods to use the new class Pkgnamcsn)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With both the patches applied, I ran the following tests:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;derbyall with sane jars using Sun JDK 1.4.2. One failure in unit/T_Diagnosticable.unit. This test is failing with sane jars. It does not fail with sane classes. The test fails with sane jars even without the patches. The failure is same as what is reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-496&quot; title=&quot;unit test &amp;#39;org.apache.derbyTesting.unitTests.services.T_Diagnosticable&amp;#39; was failed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-496&quot;&gt;&lt;del&gt;DERBY-496&lt;/del&gt;&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;jdbcapi/checkDriver.java with j9 vms.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;NOTE: This patch has to be committed together with the 10.1 branch patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-814&quot; title=&quot;Prevent unneeded object creation and excessive decoding in parsePKGNAMCSN()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-814&quot;&gt;&lt;del&gt;DERBY-814&lt;/del&gt;&lt;/a&gt; (derby-814-10.1.diff).&lt;/p&gt;</comment>
                            <comment id="12369718" author="kmarsden" created="Fri, 10 Mar 2006 03:01:12 +0000"  >&lt;p&gt;Checked into 10.1.2.4&lt;/p&gt;

&lt;p&gt;&apos;Date: Thu Mar  9 10:51:21 2006&lt;br/&gt;
New Revision: 384581&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewcvs?rev=384581&amp;amp;view=rev&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs?rev=384581&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12451206" author="myrna" created="Mon, 20 Nov 2006 01:55:39 +0000"  >&lt;p&gt;Something had gone wrong in the update of the j9_13/checkDriver.out, username and password had gotten reversed. Updated master/canon with: &lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=477004&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=477004&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="12551292" author="fuzzylogic" created="Thu, 13 Dec 2007 09:04:43 +0000"  >&lt;p&gt;This issue has been resolved for over a year with no further movement. Closing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12323975" name="derby-618-10.1.diff" size="9353" author="deepa" created="Fri, 10 Mar 2006 01:21:33 +0000"/>
                            <attachment id="12323976" name="derby-618-10.1.status" size="508" author="deepa" created="Fri, 10 Mar 2006 01:21:33 +0000"/>
                            <attachment id="12323530" name="derby-618-script.sql" size="175" author="deepa" created="Wed, 1 Mar 2006 10:33:33 +0000"/>
                            <attachment id="12323527" name="derby-618-v1.diff" size="878" author="deepa" created="Wed, 1 Mar 2006 10:18:15 +0000"/>
                            <attachment id="12323528" name="derby-618-v1.status" size="60" author="deepa" created="Wed, 1 Mar 2006 10:18:15 +0000"/>
                            <attachment id="12323657" name="derby-618-v2.diff" size="9255" author="deepa" created="Fri, 3 Mar 2006 12:56:04 +0000"/>
                            <attachment id="12323658" name="derby-618-v2.status" size="596" author="deepa" created="Fri, 3 Mar 2006 12:56:04 +0000"/>
                            <attachment id="12323529" name="derby-618.java" size="6647" author="deepa" created="Wed, 1 Mar 2006 10:33:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 28 Feb 2006 10:53:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22049</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy10hb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39728</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>