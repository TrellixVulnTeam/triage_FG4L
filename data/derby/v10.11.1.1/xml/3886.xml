<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:06 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3886/DERBY-3886.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3886] SQL roles: ij show enabled and settable roles</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3886</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Rick suggested it would be nice to have something to allow inspection of enabled roles, cf the &lt;br/&gt;
ENABLED_ROLES view of the information schema, SQL 2003, vol 11, section 5.29.&lt;/p&gt;

&lt;p&gt;I enclose patch suggestion for doing this via a new VTI table and syntactic sugar in ij:&lt;br/&gt;
SYSCS_DIAG.ENABLED_ROLES and and ij command &quot;show enabled_roles&quot;.&lt;br/&gt;
Not for commit at this point, we may want to handle to general question of information schemata&lt;br/&gt;
in another way. What say thee?&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12405269">DERBY-3886</key>
            <summary>SQL roles: ij show enabled and settable roles</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Fri, 26 Sep 2008 20:13:52 +0100</created>
                <updated>Mon, 4 May 2009 19:22:49 +0100</updated>
                            <resolved>Mon, 6 Oct 2008 22:16:24 +0100</resolved>
                                                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>SQL</component>
                    <component>Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12635380" author="rhillegas" created="Mon, 29 Sep 2008 14:35:47 +0100"  >&lt;p&gt;Hey Dag, this is pretty slick. Some small questions:&lt;/p&gt;

&lt;p&gt;1) Does the VTI need to implement VTICosting? I think that getEstimatedCostPerInstantiation() is probably returning a number that isn&apos;t tuned to any particular machine. I don&apos;t think that the optimizer has a lot of choice here and it doesn&apos;t seem to me that the VTICosting implementation will help the optimizer pick a better plan.&lt;/p&gt;

&lt;p&gt;2) Will the closure iterator return the roles in some reasonable sort order? For someone just selecting from the VTI it wouldn&apos;t matter because they could just slap an ORDER BY on the SELECT. But once the SELECT is hidden inside a system procedure, the user can&apos;t inject an ORDER BY clause.&lt;/p&gt;

&lt;p&gt;These are just nits. Looks like a great approach.&lt;/p&gt;</comment>
                            <comment id="12635453" author="dagw" created="Mon, 29 Sep 2008 18:16:38 +0100"  >&lt;p&gt;Thanks for looking at this, Rick!&lt;/p&gt;

&lt;p&gt;1) I was under the impression I had to provide a (dummy)&lt;br/&gt;
implementation of VTICosting, thank for letting me know I don&apos;t.&lt;/p&gt;

&lt;p&gt;2) It will perhaps be good to add an ORDER BY clause to the&lt;br/&gt;
implementation of ij &quot;show enabled_roles&quot;. Presently, the current role&lt;br/&gt;
is returned first; the rest of the rows do not have a defined order.&lt;/p&gt;

&lt;p&gt;Another thing; the present &quot;show role&quot; command shows all roles defined&lt;br/&gt;
in the database (similar to show tables etc).  Perhaps it would be&lt;br/&gt;
useful to have a command to show the roles which are settable for the&lt;br/&gt;
session (union of those granted to the current user and to PUBLIC)?  I don&apos;t&lt;br/&gt;
find that information as a predefined view in the &quot;definition schema&quot;&lt;br/&gt;
of volume 11, though.&lt;/p&gt;

&lt;p&gt;But there are many other views pertaining to roles in the definition&lt;br/&gt;
schema: ROLE_COLUMN_GRANTS, ROLE_ROUTINE_GRANTS, ROLE_TABLE_GRANTS,&lt;br/&gt;
ROLE_TABLE_METHOD_GRANTS, ROLE_USAGE_GRANTS, ROLE_UDT_GRANTS,&lt;br/&gt;
APPLICABLE_ROLES, and ADMINISTRABLE_ROLE_AUTHORIZATIONS, and the&lt;br/&gt;
*_PRIVILEGES views also consider the current role.&lt;/p&gt;

&lt;p&gt;I am not sure I have an itch to add all of these now, but it would be nice&lt;br/&gt;
to get a feeling for if the approach of adding such views as VTIs is&lt;br/&gt;
sound. Is the schema SYSCS_DIAG ok or do we need a new one?&lt;/p&gt;
</comment>
                            <comment id="12635469" author="rhillegas" created="Mon, 29 Sep 2008 19:16:44 +0100"  >&lt;p&gt;Hi Dag,&lt;/p&gt;

&lt;p&gt;I think this is a good use of vtis. SYSCS_DIAG sounds like a good home for your vti. Your vti seems to be compatible with the charter of that schema as described in the Reference Guide: &quot;Derby provides a set of system table expressions which you can use to obtain diagnostic information about the state of the database and about the database sessions.&quot;&lt;/p&gt;</comment>
                            <comment id="12635907" author="dagw" created="Wed, 1 Oct 2008 00:45:23 +0100"  >&lt;p&gt;Uploading version 2 of this patch which:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;took Rick&apos;s two suggestions&lt;/li&gt;
	&lt;li&gt;added &quot;show settable_roles&quot; command to ij (impl. as a SQL query)&lt;/li&gt;
	&lt;li&gt;modified the tools/ij_show_roles script by spitting it into&lt;br/&gt;
  two: ij_show_roles_dbo and ij_show_roles_usr to&lt;br/&gt;
  be able to test the settable_roles (which typically differ for the data base&lt;br/&gt;
  owner and an ordinary db user)&lt;/li&gt;
	&lt;li&gt;added help text for the ij roles show commands&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Regressions ran ok. &lt;/p&gt;</comment>
                            <comment id="12635908" author="dagw" created="Wed, 1 Oct 2008 00:48:50 +0100"  >&lt;p&gt;Thanks for your reply on this approach, Rick. Unless others have&lt;br/&gt;
objections I will commit this patch in a couple of days, then.&lt;/p&gt;</comment>
                            <comment id="12636418" author="rhillegas" created="Thu, 2 Oct 2008 19:22:27 +0100"  >&lt;p&gt;Hi Dag. What&apos;s the difference between the SQL in the patch:&lt;/p&gt;

&lt;p&gt;select roleid from sys.sysroles s, (values current_user) c(usr)&lt;br/&gt;
where s.grantee = c.usr or s.grantee = &apos;PUBLIC&apos;&lt;/p&gt;

&lt;p&gt;and the following query:&lt;/p&gt;

&lt;p&gt;select roleid from sys.sysroles s&lt;br/&gt;
where s.grantee = current_user or s.grantee = &apos;PUBLIC&apos;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12636463" author="dagw" created="Thu, 2 Oct 2008 21:58:47 +0100"  >&lt;p&gt;Thanks, Rick, for the proposed simplification; I believe there is no difference,&lt;br/&gt;
I found I could simplify the last part of the query in the same way.&lt;br/&gt;
Uploading revision #3 with that fix.&lt;/p&gt;</comment>
                            <comment id="12636486" author="rhillegas" created="Thu, 2 Oct 2008 23:11:01 +0100"  >&lt;p&gt;Thanks, Dag. Looks good. Cheers-Rick&lt;/p&gt;</comment>
                            <comment id="12637232" author="dagw" created="Mon, 6 Oct 2008 22:16:24 +0100"  >&lt;p&gt;Committed as svn 702266, closing.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12405887">DERBY-3903</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12380756">DERBY-3137</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12391244" name="enabled-roles-2.diff" size="23669" author="dagw" created="Wed, 1 Oct 2008 00:45:23 +0100"/>
                            <attachment id="12391245" name="enabled-roles-2.stat" size="1122" author="dagw" created="Wed, 1 Oct 2008 00:45:23 +0100"/>
                            <attachment id="12391378" name="enabled-roles-3.diff" size="23625" author="dagw" created="Thu, 2 Oct 2008 21:58:47 +0100"/>
                            <attachment id="12391379" name="enabled-roles-3.stat" size="1122" author="dagw" created="Thu, 2 Oct 2008 21:58:47 +0100"/>
                            <attachment id="12391045" name="enabled-roles.diff" size="10348" author="dagw" created="Fri, 26 Sep 2008 20:14:50 +0100"/>
                            <attachment id="12391046" name="enabled-roles.stat" size="426" author="dagw" created="Fri, 26 Sep 2008 20:14:50 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 29 Sep 2008 13:35:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31042</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0xbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39218</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>