<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:21:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4407/DERBY-4407.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4407] StringIndexOutOfBoundsException in ij when result has no columns</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4407</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;A query that returns no columns should perhaps raise an SQLException of some kind, I don&apos;t know, but currently it doesn&apos;t, and ij fails with a StringIndexOutOfBoundsException when it tries to display the result.&lt;/p&gt;

&lt;p&gt;After &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4370&quot; title=&quot;Implement JOIN ... USING syntax&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4370&quot;&gt;&lt;del&gt;DERBY-4370&lt;/del&gt;&lt;/a&gt; it is possible to construct queries that return no columns by having a select list like T1.* in a join where the USING clause contains all of T1&apos;s columns. To reproduce:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; create table t(x int);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; insert into t values (1),(2),(3);&lt;br/&gt;
3 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; select t1.* from t t1 join t t2 using &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;br/&gt;
JAVA ERROR: java.lang.StringIndexOutOfBoundsException: String index out of range: -1&lt;br/&gt;
java.lang.StringIndexOutOfBoundsException: String index out of range: -1&lt;br/&gt;
	at java.lang.AbstractStringBuilder.setLength(AbstractStringBuilder.java:143)&lt;br/&gt;
	at java.lang.StringBuffer.setLength(StringBuffer.java:153)&lt;br/&gt;
	at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayBanner(JDBCDisplayUtil.java:627)&lt;br/&gt;
	at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:368)&lt;br/&gt;
	at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:338)&lt;br/&gt;
	at org.apache.derby.tools.JDBCDisplayUtil.indent_DisplayResults(JDBCDisplayUtil.java:241)&lt;br/&gt;
	at org.apache.derby.tools.JDBCDisplayUtil.DisplayResults(JDBCDisplayUtil.java:229)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.displayResult(utilMain.java:448)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:522)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:363)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.go(Main.java:229)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:184)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.main(Main.java:75)&lt;br/&gt;
	at org.apache.derby.tools.ij.main(ij.java:59)&lt;br/&gt;
	at org.apache.derby.iapi.tools.run.main(run.java:53)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12437971">DERBY-4407</key>
            <summary>StringIndexOutOfBoundsException in ij when result has no columns</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Oct 2009 13:48:56 +0100</created>
                <updated>Mon, 19 Oct 2009 10:30:40 +0100</updated>
                            <resolved>Mon, 19 Oct 2009 10:30:17 +0100</resolved>
                                    <version>10.6.1.0</version>
                                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12765063" author="rhillegas" created="Tue, 13 Oct 2009 14:00:03 +0100"  >&lt;p&gt;Hi Knut,&lt;/p&gt;

&lt;p&gt;I think that a row returned by a query must have at least one column. Here&apos;s how I thread my way to this conclusion by reading part 2 of the SQL Standard:&lt;/p&gt;

&lt;p&gt;1) The result set returned by a query expression is a kind of table called a &quot;derived table&quot; according to 4.14.2 &quot;Types of tables&quot;.&lt;/p&gt;

&lt;p&gt;2) A row in a table must have at least one column according to the previous section, 4.14.1 &quot;Introduction to tables&quot;&lt;/p&gt;</comment>
                            <comment id="12765073" author="knutanders" created="Tue, 13 Oct 2009 14:24:15 +0100"  >&lt;p&gt;Thanks Rick. That sounds reasonable. So I guess a bind-time exception would be in order here, then.&lt;br/&gt;
Changing component from Tools to SQL, since the fix will have to go into the engine.&lt;/p&gt;</comment>
                            <comment id="12766499" author="knutanders" created="Fri, 16 Oct 2009 11:27:15 +0100"  >&lt;p&gt;The attached patch adds a check for empty result column list in SelectNode at the same place where we check whether the result column list is too long. All the regression tests ran cleanly.&lt;/p&gt;</comment>
                            <comment id="12767259" author="knutanders" created="Mon, 19 Oct 2009 10:30:17 +0100"  >&lt;p&gt;Committed revision 826616.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12434984">DERBY-4370</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12438211">DERBY-4410</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12422342" name="d4407-1a.diff" size="3600" author="knutanders" created="Fri, 16 Oct 2009 11:27:15 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Oct 2009 13:00:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24237</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0ron:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38303</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>