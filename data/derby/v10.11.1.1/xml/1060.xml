<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:43:23 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1060/DERBY-1060.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1060] ResultSet methods should throw exception when the ResultSet is closed</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1060</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The JDBC 4 spec says:&lt;/p&gt;

&lt;p&gt;  Once a ResultSet has been closed, any attempt to access any of its&lt;br/&gt;
  methods with the exception of the isClosed method will result in a&lt;br/&gt;
  SQLException being thrown.&lt;/p&gt;

&lt;p&gt;This is not always the case in Derby, and the behaviour is not the&lt;br/&gt;
same on the client driver and the embedded driver.&lt;/p&gt;

&lt;p&gt;The following ResultSet methods do not throw an exception when the&lt;br/&gt;
result set is closed:&lt;/p&gt;

&lt;p&gt;  Client driver:&lt;/p&gt;

&lt;p&gt;    clearWarnings()&lt;br/&gt;
    close()&lt;br/&gt;
    getMetaData()&lt;br/&gt;
    getStatement()&lt;br/&gt;
    getWarnings()&lt;/p&gt;

&lt;p&gt;  Embedded driver:&lt;/p&gt;

&lt;p&gt;    close()&lt;br/&gt;
    getConcurrency()&lt;br/&gt;
    getRow()&lt;br/&gt;
    getStatement()&lt;br/&gt;
    getType()&lt;br/&gt;
    rowDeleted()&lt;br/&gt;
    rowInserted()&lt;br/&gt;
    rowUpdated()&lt;br/&gt;
    setFetchDirection()&lt;br/&gt;
    getFetchDirection()&lt;br/&gt;
    setFetchSize()&lt;br/&gt;
    getFetchSize()&lt;/p&gt;</description>
                <environment></environment>
        <key id="12329499">DERBY-1060</key>
            <summary>ResultSet methods should throw exception when the ResultSet is closed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Feb 2006 22:45:46 +0000</created>
                <updated>Mon, 29 Jun 2009 14:13:26 +0100</updated>
                            <resolved>Mon, 6 Mar 2006 14:45:43 +0000</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>JDBC</component>
                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12368095" author="knutanders" created="Tue, 28 Feb 2006 21:42:15 +0000"  >&lt;p&gt;EmbedResultSet.close() has the following comment:&lt;/p&gt;

&lt;p&gt;    // Would like to throw an exception if already closed, but&lt;br/&gt;
    // some code assumes you can close a ResultSet more than once.&lt;br/&gt;
    // checkIfClosed(&quot;close&quot;);&lt;/p&gt;

&lt;p&gt;Does anyone know whether &quot;some code&quot; means &quot;some code in Derby&quot; or&lt;br/&gt;
&quot;some code in applications using Derby&quot;?&lt;/p&gt;</comment>
                            <comment id="12368127" author="djd" created="Wed, 1 Mar 2006 02:23:51 +0000"  >&lt;p&gt;I would guess application code. Statement.close() says it has no effect when the Statement is already closed, seems like it makes sense for ResultSet .close to be the same.&lt;/p&gt;

&lt;p&gt;Making ResultSet.close throw an exception when it is closed seems to lead to more complicated cleanup code, that may not be inline with the typical example in a JDBC book, e.g.&lt;/p&gt;

&lt;p&gt;Instead of&lt;/p&gt;

&lt;p&gt;   if (rs != null)&lt;br/&gt;
         rs.close();&lt;/p&gt;

&lt;p&gt;you would need&lt;/p&gt;

&lt;p&gt;  if (Irs != null &amp;amp;&amp;amp; !rs.isClosed())&lt;br/&gt;
       rs.close();&lt;/p&gt;

&lt;p&gt;Other (incorrect?) code I&apos;&apos;ve seen that would break with making close throw an exception is when the ResultSet is closed after the statement that created it, e.g.&lt;/p&gt;

&lt;p&gt;       ResultSet rs = ps.executeQuery();&lt;br/&gt;
        ....&lt;br/&gt;
        ps.close();&lt;br/&gt;
        rs.close();&lt;/p&gt;




</comment>
                            <comment id="12368276" author="knutanders" created="Wed, 1 Mar 2006 21:49:41 +0000"  >&lt;p&gt;Based on the comments from Dan and Lance I think it&apos;s best to leave&lt;br/&gt;
close() as it is. Modifying the other methods should be safe since&lt;br/&gt;
they all (except getStatement()) throw exception either on embedded or&lt;br/&gt;
on client.&lt;/p&gt;</comment>
                            <comment id="12368687" author="knutanders" created="Fri, 3 Mar 2006 19:15:32 +0000"  >&lt;p&gt;Attached patch derby1060-v1.diff.&lt;/p&gt;

&lt;p&gt;The patch adds calls to checkIfClosed (embeddded) or&lt;br/&gt;
checkForClosedResultSet (network client) in the ResultSet methods&lt;br/&gt;
which don&apos;t check whether the ResultSet is closed. It also adds a test&lt;br/&gt;
case to jdbc4/TestResultSetMethods.java.&lt;/p&gt;

&lt;p&gt;lang/closed.java is perhaps a more natural place for the test case,&lt;br/&gt;
but I chose to put it into the jdbc4 suite because&lt;/p&gt;

&lt;p&gt;  a) lang/closed.java does not run under DerbyNetClient&lt;/p&gt;

&lt;p&gt;  b) lang/closed.java is supposed to be able to run under JVM 1.3, so&lt;br/&gt;
     testing JDBC3 and JDBC4 methods was harder&lt;/p&gt;

&lt;p&gt;  c) throwing exception is a JDBC4 requirement (not clearly stated in&lt;br/&gt;
     previous versions of the spec)&lt;/p&gt;

&lt;p&gt;Derbyall ran without errors (Solaris 10 x86/Sun JVM 1.5.0). Jdbc4&lt;br/&gt;
suite ran without errors on Sun JVM 1.6.0-beta2-b74.&lt;/p&gt;</comment>
                            <comment id="12368689" author="knutanders" created="Fri, 3 Mar 2006 19:16:58 +0000"  >&lt;p&gt;Patch available. Please review. Thanks!&lt;/p&gt;</comment>
                            <comment id="12368822" author="rhillegas" created="Sat, 4 Mar 2006 09:38:08 +0000"  >&lt;p&gt;Again, looks solid. Easy to understand. Good tests.&lt;/p&gt;

&lt;p&gt;I successfully ran the jdbc4 tests--the only problem was the usual timestamp formatting issue. Derbyall ran cleanly for me modulo the diffs I see in a snapshot of the mainline: wisconsin, SURTest, and Stream.&lt;/p&gt;

&lt;p&gt;Feel free to commit when ready.&lt;/p&gt;</comment>
                            <comment id="12368998" author="knutanders" created="Mon, 6 Mar 2006 14:45:43 +0000"  >&lt;p&gt;Thanks for reviewing, Rick! Committed revision 383394.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12323664" name="derby1060-v1.diff" size="13352" author="knutanders" created="Fri, 3 Mar 2006 19:15:32 +0000"/>
                            <attachment id="12323665" name="derby1060-v1.stat" size="223" author="knutanders" created="Fri, 3 Mar 2006 19:15:32 +0000"/>
                            <attachment id="12323666" name="derbyall_report.txt" size="3737" author="knutanders" created="Fri, 3 Mar 2006 19:15:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 1 Mar 2006 02:23:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22287</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0wsn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39131</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>