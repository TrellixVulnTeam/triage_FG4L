<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:36 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3624/DERBY-3624.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3624] testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3624</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I saw this fail once; a couple of reruns didn&apos;t duplicate the problem.&lt;/p&gt;

&lt;p&gt;The only difference appears to be that one of the deadlock messages is missing from the output.&lt;/p&gt;

&lt;p&gt;4 del&lt;br/&gt;
&amp;lt; Got a Deadlock.&lt;/p&gt;
</description>
                <environment>iseries, ibm 1.5.: &lt;br/&gt;
java version &amp;quot;1.5.0&amp;quot;&lt;br/&gt;
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_13-b05)&lt;br/&gt;
Classic VM (build 1.5, build JDK-1.5, native threads, jitc_de)</environment>
        <key id="12394043">DERBY-3624</key>
            <summary>testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="myrna">Myrna van Lunteren</reporter>
                        <labels>
                            <label>derby_triage10_8</label>
                    </labels>
                <created>Tue, 15 Apr 2008 22:34:58 +0100</created>
                <updated>Wed, 22 Oct 2014 20:23:28 +0100</updated>
                            <resolved>Mon, 15 Sep 2014 14:51:54 +0100</resolved>
                                    <version>10.4.1.3</version>
                    <version>10.8.3.3</version>
                    <version>10.10.2.0</version>
                    <version>10.11.1.1</version>
                    <version>10.12.0.0</version>
                                    <fixVersion>10.11.1.3</fixVersion>
                    <fixVersion>10.12.0.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="12589247" author="myrna" created="Tue, 15 Apr 2008 22:36:09 +0100"  >&lt;p&gt;attaching derby.log found after failure, and .tmp file (which was same as .out).&lt;/p&gt;</comment>
                            <comment id="12697163" author="myrna" created="Wed, 8 Apr 2009 20:44:42 +0100"  >&lt;p&gt;saw this with 10.5.1.0 with ibm 1.6.&lt;/p&gt;</comment>
                            <comment id="13126194" author="myrna" created="Wed, 12 Oct 2011 22:57:59 +0100"  >&lt;p&gt;Saw this with 10.8.2.2 (RC3) with ibm 1.5, on AIX 6.1&lt;/p&gt;</comment>
                            <comment id="13233861" author="mikem" created="Tue, 20 Mar 2012 22:10:45 +0000"  >&lt;p&gt;failed also against 10.8 branch, windows, ibm142, build 1302750&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_8/windows/testlog/ibm142/1302750-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_8/windows/testlog/ibm142/1302750-derbyall_diff.txt&lt;/a&gt;&lt;br/&gt;
Failure Details:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/encryptionAll/encryptionBlowfish/T_CipherBlowfish.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: T_CipherBlowfish jdk1.4.2 encryptionAll:encryptionBlowfish 2012-03-19 20:29:58 ***&lt;br/&gt;
Test skipped: test cannot run with jvm: ibm14.  T_CipherBlowfish.unit&lt;/li&gt;
			&lt;li&gt;End:   T_CipherBlowfish jdk1.4.2 encryptionAll:encryptionBlowfish 2012-03-19 20:29:58 ***
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/storeall/storetests/st_derby715.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: st_derby715 jdk1.4.2 storeall:storetests 2012-03-19 20:04:53 ***&lt;br/&gt;
4 del&lt;br/&gt;
&amp;lt; Got a Deadlock.&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   st_derby715 jdk1.4.2 storeall:storetests 2012-03-19 20:05:10 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13233863" author="mikem" created="Tue, 20 Mar 2012 22:13:15 +0000"  >&lt;p&gt;failed slightly differently again against 10.8 branch, windows, ibm142, build 1302046:&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_8/windows/testlog/ibm142/1302046-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_8/windows/testlog/ibm142/1302046-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/storeall/storetests/st_derby715.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: st_derby715 jdk1.4.2 storeall:storetests 2012-03-17 20:09:34 ***&lt;br/&gt;
5 del&lt;br/&gt;
&amp;lt; Got a Deadlock.&lt;br/&gt;
5 add&lt;br/&gt;
&amp;gt; ERROR 40XL1: A lock could not be obtained within the time requested&lt;br/&gt;
&amp;gt; java.sql.SQLException: A lock could not be obtained within the time requested&lt;br/&gt;
&amp;gt; Caused by: ERROR 40XL1: A lock could not be obtained within the time requested&lt;br/&gt;
&amp;gt; 	... 5 more&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   st_derby715 jdk1.4.2 storeall:storetests 2012-03-17 20:09:53 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13676120" author="mikem" created="Wed, 5 Jun 2013 18:08:35 +0100"  >&lt;p&gt;test failed in nightly tests against trunk, ibm16, windows:&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/1485917-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/1485917-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/storeall/storetests/st_derby715.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: st_derby715 jdk1.6.0 storeall:storetests 2013-05-23 19:03:56 ***&lt;br/&gt;
4 del&lt;br/&gt;
&amp;lt; Got a Deadlock.&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   st_derby715 jdk1.6.0 storeall:storetests 2013-05-23 19:04:09 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13676201" author="mikem" created="Wed, 5 Jun 2013 19:27:40 +0100"  >&lt;p&gt;failed 3 times in may on 10.10, windows.  twice on ibm16 and once on ibm17&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm16/1487215-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm16/1487215-derbyall_diff.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm16/1486497-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm16/1486497-derbyall_diff.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm17/1484643-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm17/1484643-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13688582" author="myrna" created="Wed, 19 Jun 2013 23:45:46 +0100"  >&lt;p&gt;failed a few more times in June, once on the 10.8 machine, once on 10.9, three times on the 10.10 windows machine, different jvms.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm16/1492928-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm16/1492928-derbyall_diff.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm17/1493983-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm17/1493983-derbyall_diff.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm16/1494414-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm16/1494414-derbyall_diff.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_9/windows/testlog/ibm16/1490496-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_9/windows/testlog/ibm16/1490496-derbyall_diff.txt&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_8/windows/testlog/ibm142/1491673-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_8/windows/testlog/ibm142/1491673-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13695134" author="myrna" created="Thu, 27 Jun 2013 23:48:22 +0100"  >&lt;p&gt;Failed once more:10.9, windows, ibm 1.6: &lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_9/windows/testlog/ibm16/1495659-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_9/windows/testlog/ibm16/1495659-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="13695136" author="myrna" created="Thu, 27 Jun 2013 23:49:29 +0100"  >&lt;p&gt;Linking to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5692&quot; title=&quot;intermittent test failure in storetests/st_derby715.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5692&quot;&gt;&lt;del&gt;DERBY-5692&lt;/del&gt;&lt;/a&gt;, which was fixed, but appears to be similar.&lt;/p&gt;</comment>
                            <comment id="13756919" author="myrna" created="Tue, 3 Sep 2013 19:58:24 +0100"  >&lt;p&gt;Failed again: &lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm15/1517407-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm15/1517407-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13756955" author="myrna" created="Tue, 3 Sep 2013 20:20:18 +0100"  >&lt;p&gt;Also failed: &lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/weme6.2/1518050-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/weme6.2/1518050-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13756956" author="myrna" created="Tue, 3 Sep 2013 20:21:30 +0100"  >&lt;p&gt;And again: &lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm17/1518442-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm17/1518442-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13762045" author="mamtas" created="Mon, 9 Sep 2013 18:10:43 +0100"  >&lt;p&gt;Failed on 10.10.1.3 &lt;a href=&quot;http://cloudsoft.svl.ibm.com/intranet/nightlies/sdsvm904017/JarResults.2013-09-06/ibm17_derbyall/derbyall_report.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cloudsoft.svl.ibm.com/intranet/nightlies/sdsvm904017/JarResults.2013-09-06/ibm17_derbyall/derbyall_report.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13786673" author="kmarsden" created="Fri, 4 Oct 2013 22:59:03 +0100"  >&lt;p&gt;This looks like a timing issue with the test which relies on sleeps to synchronize the two threads. I can reliably lose deadlocks if I put a sleep at the beginning of t2.run().&lt;/p&gt;

&lt;p&gt;Attaching a patch which waits for locks to be taken rather than using the sleep to synchronize.  Even if I put a sleep in at the beginning of t2.run() the test passes with this patch.&lt;/p&gt;</comment>
                            <comment id="13790549" author="jira-bot" created="Wed, 9 Oct 2013 17:00:55 +0100"  >&lt;p&gt;Commit 1530696 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kmarsden&quot; class=&quot;user-hover&quot; rel=&quot;kmarsden&quot;&gt;Kathey Marsden&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1530696&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1530696&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3624&quot; title=&quot;testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3624&quot;&gt;&lt;del&gt;DERBY-3624&lt;/del&gt;&lt;/a&gt; testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&lt;/p&gt;

&lt;p&gt;Change test to check locks rather than sleep for synchronization.&lt;/p&gt;</comment>
                            <comment id="13790868" author="jira-bot" created="Wed, 9 Oct 2013 22:16:55 +0100"  >&lt;p&gt;Commit 1530796 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kmarsden&quot; class=&quot;user-hover&quot; rel=&quot;kmarsden&quot;&gt;Kathey Marsden&lt;/a&gt; in branch &apos;code/branches/10.10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1530796&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1530796&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3624&quot; title=&quot;testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3624&quot;&gt;&lt;del&gt;DERBY-3624&lt;/del&gt;&lt;/a&gt; testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&lt;br/&gt;
merge revision 1530696 from trunk&lt;/p&gt;</comment>
                            <comment id="13885635" author="jira-bot" created="Wed, 29 Jan 2014 18:38:20 +0000"  >&lt;p&gt;Commit 1562542 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/branches/10.9&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1562542&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1562542&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3624&quot; title=&quot;testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3624&quot;&gt;&lt;del&gt;DERBY-3624&lt;/del&gt;&lt;/a&gt;; testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5692&quot; title=&quot;intermittent test failure in storetests/st_derby715.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5692&quot;&gt;&lt;del&gt;DERBY-5692&lt;/del&gt;&lt;/a&gt;; intermittent test failure in storetests/st_derby715.java&lt;br/&gt;
   merge of revision 1530796 from 10.10 branch&lt;/p&gt;</comment>
                            <comment id="13885641" author="jira-bot" created="Wed, 29 Jan 2014 18:44:47 +0000"  >&lt;p&gt;Commit 1562544 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/branches/10.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1562544&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1562544&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3624&quot; title=&quot;testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3624&quot;&gt;&lt;del&gt;DERBY-3624&lt;/del&gt;&lt;/a&gt;; testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5692&quot; title=&quot;intermittent test failure in storetests/st_derby715.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5692&quot;&gt;&lt;del&gt;DERBY-5692&lt;/del&gt;&lt;/a&gt;; intermittent test failure in storetests/st_derby715.java&lt;br/&gt;
   merge of revision 1530796 from 10.10 branch&lt;/p&gt;</comment>
                            <comment id="14086219" author="rhillegas" created="Tue, 5 Aug 2014 13:59:21 +0100"  >&lt;p&gt;Re-opening this issue. Seen during nightly tests on Linux_jdk8-compact2: &lt;a href=&quot;http://download.java.net/javadesktop/derby/request_5594301/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.java.net/javadesktop/derby/request_5594301/&lt;/a&gt;. Unassigning from Kathey.&lt;/p&gt;</comment>
                            <comment id="14102030" author="knutanders" created="Tue, 19 Aug 2014 09:49:13 +0100"  >&lt;p&gt;The test originally did this:&lt;/p&gt;

&lt;p&gt;Thread 1:&lt;br/&gt;
  read all rows from table B&lt;br/&gt;
  sleep 1/2 sec&lt;br/&gt;
  insert a row into table A&lt;/p&gt;

&lt;p&gt;Thread 2:&lt;br/&gt;
  read all rows from table A&lt;br/&gt;
  sleep 1/2 sec&lt;br/&gt;
  insert a row into table B&lt;/p&gt;

&lt;p&gt;The patch changed it so that each thread, after first sleeping for half a second, would wait until the lock table contained at least two locks.&lt;/p&gt;

&lt;p&gt;Although this reduced the chance of one thread executing the INSERT statement before the other thread had completed the SELECT statement, it didn&apos;t completely plug the hole. I think the problem is that it only checks that the lock table contains two locks, and not that the two locks in fact are row locks on table A and table B. The locks could for example be locks on system tables held while one of the SELECT statements is compiled, in which case the other thread would mistakenly conclude that the other thread was done executing the SELECT statement, and it might go on and execute the INSERT statement too early to get a deadlock.&lt;/p&gt;

&lt;p&gt;The attached patch &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12662724/12662724_barrier.diff&quot; title=&quot;barrier.diff attached to DERBY-3624&quot;&gt;barrier.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; changes the wait logic so that it uses the Barrier class to make sure the other thread has executed far enough that it&apos;s safe to go on. It no longer checks the contents of the lock table. Instead, each thread will wait after executing the SELECT statement until the other thread has signaled that it too has completed the SELECT statement.&lt;/p&gt;

&lt;p&gt;I repeated Kathey&apos;s experiment with a long sleep at the beginning of t2.run(), and the test still passes with the new approach.&lt;/p&gt;</comment>
                            <comment id="14102043" author="jira-bot" created="Tue, 19 Aug 2014 10:05:07 +0100"  >&lt;p&gt;Commit 1618821 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1618821&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1618821&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3624&quot; title=&quot;testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3624&quot;&gt;&lt;del&gt;DERBY-3624&lt;/del&gt;&lt;/a&gt;: Missing deadlock in storetests/st_derby715.java&lt;/p&gt;

&lt;p&gt;Make both tests wait until the other thread has executed the SELECT&lt;br/&gt;
statement and exhausted the ResultSet before they go on to the INSERT&lt;br/&gt;
statements that should deadlock.&lt;/p&gt;</comment>
                            <comment id="14133902" author="knutanders" created="Mon, 15 Sep 2014 14:49:41 +0100"  >&lt;p&gt;This failure has not been seen again after the fix was checked in four weeks ago. Before the fix was checked in, it had failed twice in one week on the platform with the label Linux_jdk8-compact2. I&apos;ll backport the fix to 10.11 and re-resolve the issue.&lt;/p&gt;</comment>
                            <comment id="14133905" author="jira-bot" created="Mon, 15 Sep 2014 14:51:05 +0100"  >&lt;p&gt;Commit 1625033 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/branches/10.11&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1625033&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1625033&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3624&quot; title=&quot;testfailure in storetests/st_derby715 with ibm 1.5 on iseries machine; one deadlock message missing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3624&quot;&gt;&lt;del&gt;DERBY-3624&lt;/del&gt;&lt;/a&gt;: Missing deadlock in storetests/st_derby715.java&lt;/p&gt;

&lt;p&gt;Merged revision 1618821 from trunk.&lt;/p&gt;</comment>
                            <comment id="14180376" author="myrna" created="Wed, 22 Oct 2014 20:23:28 +0100"  >&lt;p&gt;closing all resolved issues reported by me.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12551276">DERBY-5692</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12654832">DERBY-6275</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12662724" name="barrier.diff" size="4504" author="knutanders" created="Tue, 19 Aug 2014 09:49:13 +0100"/>
                            <attachment id="12606908" name="derby-3624_diff.txt" size="2487" author="kmarsden" created="Fri, 4 Oct 2013 22:59:03 +0100"/>
                            <attachment id="12380221" name="derby.log" size="26838" author="myrna" created="Tue, 15 Apr 2008 22:36:09 +0100"/>
                            <attachment id="12380222" name="st_derby715.tmp" size="64" author="myrna" created="Tue, 15 Apr 2008 22:36:09 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 20 Mar 2012 22:10:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23751</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0clj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35859</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>