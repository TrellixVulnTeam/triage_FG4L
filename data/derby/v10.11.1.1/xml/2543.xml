<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:30:48 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2543/DERBY-2543.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2543]  testVirtualMemoryHeap junit test fails with &quot;Virtual memory heap test failed! Got unexpected value. expected:&lt;202&gt; but was:&lt;103&gt;&quot;</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2543</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;junit suite fails with the following error:&lt;/p&gt;

&lt;p&gt;2) testVirtualMemoryHeap(org.apache.derbyTesting.functionTests.tests.lang.UpdateCursorTest)junit.framework.AssertionFailedError: Virtual memory heap test failed! Got unexpected value. expected:&amp;lt;202&amp;gt; but was:&amp;lt;103&amp;gt;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.UpdateCursorTest.testVirtualMemoryHeap(UpdateCursorTest.java:178)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12367115">DERBY-2543</key>
            <summary> testVirtualMemoryHeap junit test fails with &quot;Virtual memory heap test failed! Got unexpected value. expected:&lt;202&gt; but was:&lt;103&gt;&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fuzzylogic">Andrew McIntyre</assignee>
                                    <reporter username="mikem">Mike Matrigali</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Apr 2007 00:51:16 +0100</created>
                <updated>Mon, 29 Jun 2009 23:42:51 +0100</updated>
                            <resolved>Fri, 25 May 2007 19:38:05 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12488538" author="mikem" created="Fri, 13 Apr 2007 00:54:46 +0100"  >&lt;p&gt;I did a quick scan of the tinder box results and it looks like the test has failed ever since it was checked in.&lt;br/&gt;
See link for all tinderbox results: &lt;a href=&quot;http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/Limited/index.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/Limited/index.html&lt;/a&gt;&lt;br/&gt;
See link for what I think was first occurence: &lt;a href=&quot;http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/testlog/SunOS-5.10_i86pc-i386/527072-org.apache.derbyTesting.functionTests.suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/testlog/SunOS-5.10_i86pc-i386/527072-org.apache.derbyTesting.functionTests.suites.All_diff.txt&lt;/a&gt;&lt;br/&gt;
checkin notes for that test run:&lt;br/&gt;
Changes from 525953/526069 to 526070:&lt;br/&gt;
------------------------------------------------------------------------&lt;br/&gt;
r526070 | fuzzylogic | 2007-04-06 08:20:46 +0200 (Fri, 06 Apr 2007) | 4 lines&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2467&quot; title=&quot;Convert lang/updateCursor.java to JUnit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2467&quot;&gt;&lt;del&gt;DERBY-2467&lt;/del&gt;&lt;/a&gt;: Convert lang/updateCursor.java to JUnit.&lt;/p&gt;

&lt;p&gt;Committed for Ugo Matrangolo &amp;lt;matra@santippe.dyndns.org&amp;gt;&lt;/p&gt;

&lt;p&gt;------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;D    java/testing/org/apache/derbyTesting/functionTests/tests/lang/updateCursor.java&lt;br/&gt;
D    java/testing/org/apache/derbyTesting/functionTests/tests/lang/updateCursor_derby.properties&lt;br/&gt;
U    java/testing/org/apache/derbyTesting/functionTests/tests/lang/_Suite.java&lt;br/&gt;
A    java/testing/org/apache/derbyTesting/functionTests/tests/lang/UpdateCursorTest.java&lt;br/&gt;
D    java/testing/org/apache/derbyTesting/functionTests/master/updateCursor.out&lt;br/&gt;
U    java/testing/org/apache/derbyTesting/functionTests/suites/derbylang.runall&lt;/p&gt;

&lt;p&gt;Fetching external item into &apos;tools/testing/derby/10.1&apos;&lt;br/&gt;
Updated external to revision 526070.&lt;/p&gt;

&lt;p&gt;Updated to revision 526070.&lt;br/&gt;
526070 URL: &lt;a href=&quot;https://svn.apache.org/repos/asf/db/derby/code/trunk&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/db/derby/code/trunk&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Performing status on external item at &apos;tools/testing/derby/10.1&apos;&lt;/p&gt;
</comment>
                            <comment id="12488539" author="fuzzylogic" created="Fri, 13 Apr 2007 01:16:28 +0100"  >&lt;p&gt;It is clear from the comments in the previous test that the row order was an expected behavior for the &apos;in-memory heap.&apos;  But, it does seem a bit dubious to rely on any particular ordering behavior for a Hashtable, and if we&apos;re talking about the behavior of BackingStoreHashtable, then it is also worth mentioning that the underlying Hashtable was recently changed to a HashMap.&lt;/p&gt;

&lt;p&gt;I&apos;m also a bit confused about the fact that the old harness test reliably reproduced the behavior, whereas the new JUnit one does not, and the fact that I cannot reproduce the failure that the nightlies see. Also, from the failure in the nightlies, it appears that the row order is not being reversed after all. It was expecting the first reversed row, but getting the next row in order (103) instead. I&apos;m curious if the rows are now coming back in order, or if perhaps some improvement in memory usage is allowing us to stash one extra row in memory.&lt;/p&gt;

&lt;p&gt;Should we just remove this testcase?&lt;/p&gt;</comment>
                            <comment id="12488712" author="fuzzylogic" created="Fri, 13 Apr 2007 17:43:07 +0100"  >&lt;p&gt;This test relies on the setting of a static property, derby.language.maxMemoryPerTable, which explains why it would always pass when run alone, but fail for others when run as part of a suite. I think the solution is to wrap the test in a singleUseDatabaseDecorator, trying that now.&lt;/p&gt;</comment>
                            <comment id="12488786" author="matra" created="Fri, 13 Apr 2007 22:15:21 +0100"  >&lt;p&gt;I was checking why the test passes when executed alone and fails in a suite.&lt;/p&gt;

&lt;p&gt;My first thought was that other tests can influence the derby.language.maxMemoryPerTable=1 property; a simple println() revealed&lt;br/&gt;
that it is not the case. Running the test in a suite doesn&apos;t affect this value.&lt;/p&gt;

&lt;p&gt;I composed a little suite with :&lt;/p&gt;

&lt;p&gt;suite.addTest(UpdateCursorTest.suite());&lt;br/&gt;
suite.addTest(DistinctTest.suite());       &lt;br/&gt;
suite.addTest(GroupByTest.suite());&lt;/p&gt;

&lt;p&gt;and the test did ok. Then I tried :&lt;/p&gt;

&lt;p&gt;suite.addTest(DistinctTest.suite());       &lt;br/&gt;
suite.addTest(UpdateCursorTest.suite());      &lt;br/&gt;
suite.addTest(GroupByTest.suite());&lt;/p&gt;

&lt;p&gt;and the test failed. Both times the property was ok.&lt;/p&gt;

&lt;p&gt;I&apos;m investigating what changes between these two cases.&lt;/p&gt;

&lt;p&gt;Hope this helps.&lt;/p&gt;



</comment>
                            <comment id="12488793" author="fuzzylogic" created="Fri, 13 Apr 2007 22:30:24 +0100"  >&lt;p&gt;derby.language.maxMemoryPerTable is a static property. It is set once, at boot time, and then does not change. See org.apache.derby.engine.impl.sql.compile.OptimizerFactoryImpl.boot(). See also the Tuning guide for a discussion of dynamic vs. static Derby properties.&lt;/p&gt;

&lt;p&gt;singleUseDatabaseDecorator wasn&apos;t exactly what I was looking for, but it doesn&apos;t appear that DatabasePropertyTestSetup(test, properties, true) is working either, although it appears to be doing the right thing as far as setting the properties, and shutting down / bringing up the database. Next to investigate is whether OptimizerFactoryImpl.boot() is being called again after the shutdown to pick up the new property values.&lt;/p&gt;</comment>
                            <comment id="12488796" author="fuzzylogic" created="Fri, 13 Apr 2007 22:47:53 +0100"  >&lt;p&gt;Committed fix to trunk with revision 528677. Needed to wrap the test in a DatabasePropertyTestSetup(test, props, true) that would shutdown and restart the database engine in order to pick up the new value for the static property maxMemoryPerTable.&lt;/p&gt;</comment>
                            <comment id="12488798" author="matra" created="Fri, 13 Apr 2007 22:52:58 +0100"  >&lt;p&gt;I did a little debug on OptimizerFactoryImpl.boot() . Seems that the different behavior is here. When i run the suite where updateCursor is the first test in test list , it gets the correct value from Optimizer.MAX_MEMORY_PER_TABLE. When i run the suite that fails the boot() method gets a null. The boot() method is called once.&lt;/p&gt;

&lt;p&gt;can updateCursor() suceeds only if it is the first test to run ??&lt;/p&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12365311">DERBY-2467</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 13 Apr 2007 00:16:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23089</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0w9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39047</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>