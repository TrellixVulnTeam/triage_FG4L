<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:33:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-24/DERBY-24.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-24] Client should not be able to raise an event on a PooledConnection it no longer owns.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-24</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Opening this bug on behalf of Daniel Debrunner.&lt;/p&gt;

&lt;p&gt;---------------------------------------------------------------&lt;br/&gt;
After closing a connection Derby generates a connectionErrorOccurred() event on the PooledConnection when a createStatement() call is made against the closed Connection.  &lt;/p&gt;

&lt;p&gt;The code gets a Connection from the PooledConnection, creates a &lt;br/&gt;
Statement, and then closes the Connection.  This causes a &lt;br/&gt;
connectionClose() event, like it&apos;s supposed to.  Then it closes &lt;br/&gt;
it again, which does not raise an exception (the spec doesn&apos;t &lt;br/&gt;
really say what should happen if you close it twice, so it&apos;s &lt;br/&gt;
hard to claim this is an error...).  A second connectionClose() &lt;br/&gt;
event is not generated, which is fine.  &lt;/p&gt;

&lt;p&gt;The testcase then calls createStatement() again on the closed &lt;br/&gt;
Connection.  This generates a connectionErrorOccurred() event &lt;br/&gt;
on the PooledConnection, which seems wrong.  The connection &lt;br/&gt;
pool code at this point is going to figure that the &lt;br/&gt;
PooledConnection is bad and needs to be discarded, even though &lt;br/&gt;
it&apos;s fine.  (The second createStatement() call receives a &lt;br/&gt;
SQLException, which is fine.)&lt;/p&gt;

&lt;p&gt;The code which receives the error event has to assume that the &lt;br/&gt;
event is associated with the current user of the &lt;br/&gt;
PooledConnection.  When the first Connection.close() occurs, we &lt;br/&gt;
will move the PooledConnection into the free pool, and then &lt;br/&gt;
assign it to the next Connection requester.  If the first &lt;br/&gt;
Connection client erroneously calls createStatement() on their &lt;br/&gt;
closed Connection facade, the Derby Connection facade &lt;br/&gt;
generates that error event which refers to the PooledConnection &lt;br/&gt;
now being used by the second client.  But the code will have to &lt;br/&gt;
assume that the second Connection client received an &lt;br/&gt;
unrecoverable error, and that the PooledConnection needs to be &lt;br/&gt;
closed, when in fact the first connection client has made a &lt;br/&gt;
programming error.  There&apos;s no way for to tell which client &lt;br/&gt;
caused the error.&lt;/p&gt;

&lt;p&gt;The upshot is that any events should be generated after the close event caused by close(), no matter what is done to that closed Connection facade, since the client&apos;s not supposed to be using it anymore.&lt;/p&gt;

&lt;p&gt;The reference for connection pooling semantics is: &lt;br/&gt;
&lt;a href=&quot;http://java.sun.com/products/jdbc/jdbc20.stdext.pdf&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/products/jdbc/jdbc20.stdext.pdf&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It doesn&apos;t explicitly say what should happen if an error occurs &lt;br/&gt;
on a closed Connection, but it seems like the current behavior &lt;br/&gt;
will confuse the connection pool built on top of &lt;br/&gt;
PooledConnection.&lt;/p&gt;</description>
                <environment></environment>
        <key id="27529">DERBY-24</key>
            <summary>Client should not be able to raise an event on a PooledConnection it no longer owns.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="djd">Daniel John Debrunner</assignee>
                                    <reporter username="ramank">Ramandeep Kaur</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Sep 2004 20:40:21 +0100</created>
                <updated>Mon, 4 Oct 2004 17:18:50 +0100</updated>
                            <resolved>Mon, 4 Oct 2004 17:18:50 +0100</resolved>
                                    <version>10.0.2.0</version>
                                    <fixVersion>10.0.2.0</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="53677" author="djd" created="Mon, 4 Oct 2004 17:18:50 +0100"  >&lt;p&gt;Fixed in commited revision 53730&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 4 Oct 2004 16:18:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21724</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy18ov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41058</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>