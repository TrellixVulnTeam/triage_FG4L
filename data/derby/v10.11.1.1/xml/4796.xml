<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:35 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4796/DERBY-4796.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4796] Missing escape for apostrophes in many messages</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4796</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The properties file format requires that single-quote characters are escaped with an extra single-quote. A number of messages don&apos;t follow this rule.&lt;/p&gt;

&lt;p&gt;Take this example from the Italian localization:&lt;/p&gt;

&lt;p&gt;42X34=Esiste un parametro ? nell&apos;elenco di selezione.  Ci\u00F2 non \u00E8 consentito.&lt;/p&gt;

&lt;p&gt;Note that there&apos;s only a single apostrophe in &quot;nell&apos;elenco&quot; above. When this message is printed, the apostrophe will be omitted:&lt;/p&gt;

&lt;p&gt;$ LC_ALL=it_IT.UTF-8 java -jar derbyrun.jar ij&lt;br/&gt;
Versione ij 10.6&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:db;create=true&apos;;&lt;br/&gt;
ij&amp;gt; select ? from sys.systables;&lt;br/&gt;
ERRORE 42X34: Esiste un parametro ? nellelenco di selezione.  Ci&#242; non &#232; consentito.&lt;/p&gt;

&lt;p&gt;We should go through the message files and add extra apostrophes where they are missing.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12473676">DERBY-4796</key>
            <summary>Missing escape for apostrophes in many messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Sep 2010 13:51:52 +0100</created>
                <updated>Mon, 29 Nov 2010 14:20:33 +0000</updated>
                            <resolved>Thu, 11 Nov 2010 16:07:51 +0000</resolved>
                                    <version>10.6.1.0</version>
                                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>Localization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12926988" author="knutanders" created="Mon, 1 Nov 2010 14:08:38 +0000"  >&lt;p&gt;A correction to what the bug description says: The escaping of single-quotes is not required by the properties file format. It is java.text.MessageFormat that requires the quotes to be escaped.&lt;/p&gt;</comment>
                            <comment id="12926991" author="knutanders" created="Mon, 1 Nov 2010 14:21:56 +0000"  >&lt;p&gt;Here&apos;s a patch that fixes the problems I found by grepping the engine messages. It simply changes all single single-quotes to double single-quotes, as that seemed to be the correct handling of all the cases I found.&lt;/p&gt;

&lt;p&gt;For the drda and tools messages, the solution won&apos;t be that simple. That&apos;s because they get the messages through LocalizedResource, which handles messages with arguments in a different way than messages with no arguments. The messages that have arguments will be passed through MessageFormat, and therefore require escaping. The messages with no arguments are taken literally, and therefore shouldn&apos;t be escaped.&lt;/p&gt;

&lt;p&gt;I&apos;m leaning towards changing LocalizedResource to always go through MessageFormat (just like MessageService does with the engine messages). That means we would have to escape single-quotes in all tools messages and drda messages, but that sounds easier to maintain than having some messages that should be escaped and some that shouldn&apos;t.&lt;/p&gt;</comment>
                            <comment id="12927085" author="dagw" created="Mon, 1 Nov 2010 18:53:32 +0000"  >&lt;p&gt;I think the idea of always running it through MessageFormat makes thigns more orthogonal, +1.&lt;/p&gt;</comment>
                            <comment id="12927117" author="knutanders" created="Mon, 1 Nov 2010 19:58:50 +0000"  >&lt;p&gt;I&apos;m considering writing a test that would tell us about such problems when updating the messages in the future. Where would such a test go? In a JUnit suite? I&apos;m not all that keen on writing code to get all message files known to the classloader... The easier option is probably to make a check at build time, for which we have some kind of precedence with MessageBundleTest. I think I&apos;ll go for the latter option, and if it turns out to slow down the build unacceptably, we can consider moving it to a JUnit suite later.&lt;/p&gt;</comment>
                            <comment id="12927134" author="knutanders" created="Mon, 1 Nov 2010 20:18:27 +0000"  >&lt;p&gt;All the regression tests ran cleanly with the changes in engine-messages.diff. Committed revision 1029820.&lt;/p&gt;</comment>
                            <comment id="12930118" author="knutanders" created="Tue, 9 Nov 2010 13:37:23 +0000"  >&lt;p&gt;Attaching a patch to fix the tools and drda messages. I haven&apos;t run any tests yet.&lt;/p&gt;

&lt;p&gt;The patch makes the following changes:&lt;/p&gt;

&lt;p&gt;M       java/tools/org/apache/derby/iapi/tools/i18n/LocalizedResource.java&lt;/p&gt;

&lt;p&gt;Send all messages through java.text.MessageFormat for orthogonality, also the messages that don&apos;t have parameters.&lt;/p&gt;

&lt;p&gt;M       build.xml&lt;br/&gt;
A       java/build/org/apache/derbyBuild/MessageVetter.java&lt;/p&gt;

&lt;p&gt;Added code to sanity check the message files at build-time. MessageVetter goes through every message and checks (1) that they don&apos;t contain lone single-quote characters, and (2) that no exception is raised when constructing a java.text.MessageFormat using the message. Exceptions from (1) were added for three messages in which single-quotes were needed to quote curly braces that should appear literally in the message. For these messages, MessageVetter checks that single-quotes either are doubled (to produce an apostrophe) or placed adjacent to curly braces.&lt;/p&gt;

&lt;p&gt;M       java/tools/org/apache/derby/loc/*.properties&lt;br/&gt;
M       java/drda/org/apache/derby/loc/drda/*.properties&lt;/p&gt;

&lt;p&gt;Doubled occurrences of lone single-quotes. Also added single-quotes around curly braces where that was needed.&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/loc/messages_it.properties&lt;/p&gt;

&lt;p&gt;Fixed a malformed parameter marker, noticed by MessageVetter.&lt;/p&gt;</comment>
                            <comment id="12930183" author="knutanders" created="Tue, 9 Nov 2010 16:30:29 +0000"  >&lt;p&gt;Attaching new patch for tools and drda messages (tools-drda-messages-2.diff). The new patch updates the canons for derbyrunjartest and NetworkServerControlAPITest. This was needed because the patch adds a missing space to one of the usage messages in NetworkServerControl.&lt;/p&gt;

&lt;p&gt;All the regression tests ran cleanly with the updated patch.&lt;/p&gt;</comment>
                            <comment id="12931061" author="knutanders" created="Thu, 11 Nov 2010 16:07:51 +0000"  >&lt;p&gt;Committed revision 1033977.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                            <outwardlinks description="requires">
                                        <issuelink>
            <issuekey id="12479323">DERBY-4893</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12458547" name="engine-messages.diff" size="33202" author="knutanders" created="Mon, 1 Nov 2010 14:21:56 +0000"/>
                            <attachment id="12459165" name="tools-drda-messages-2.diff" size="251230" author="knutanders" created="Tue, 9 Nov 2010 16:30:29 +0000"/>
                            <attachment id="12459156" name="tools-drda-messages.diff" size="247159" author="knutanders" created="Tue, 9 Nov 2010 13:37:23 +0000"/>
                            <attachment id="12459155" name="tools-drda-messages.stat" size="2140" author="knutanders" created="Tue, 9 Nov 2010 13:37:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 1 Nov 2010 18:53:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24469</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0p07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37869</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>