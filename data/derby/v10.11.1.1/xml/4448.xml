<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:41:16 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4448/DERBY-4448.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4448] ArrayIndexOutOfBoundsException when trying to override generated column</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4448</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;ij&amp;gt; create table t(a int, b generated always as (-a));&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; insert into t(b) values (default), (2);&lt;br/&gt;
ERROR XJ001: Java exception: &apos;0 &amp;gt;= 0: java.lang.ArrayIndexOutOfBoundsException&apos;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12441096">DERBY-4448</key>
            <summary>ArrayIndexOutOfBoundsException when trying to override generated column</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Nov 2009 21:17:52 +0000</created>
                <updated>Thu, 13 Jan 2011 17:18:34 +0000</updated>
                            <resolved>Sat, 3 Jul 2010 15:42:41 +0100</resolved>
                                    <version>10.5.3.0</version>
                    <version>10.6.1.0</version>
                                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12779704" author="knutanders" created="Wed, 18 Nov 2009 22:42:55 +0000"  >&lt;p&gt;I think the problem is that DMLModStatementNode.forbidGenerationOverrides() only looks at and modifies the RCL of the top-most source result set. Since it removes generated columns from both the target RCL and the source RCL, the child result sets of the UnionNode representing the multi-row VALUES clause are not processed, so all rows except the first row will end up with more columns than the target RCL.&lt;/p&gt;</comment>
                            <comment id="12779863" author="knutanders" created="Thu, 19 Nov 2009 08:12:06 +0000"  >&lt;p&gt;I tried a simple fix, removing the call to forbidGenerationOverrides() in InsertNode.bindStatement() and instead making sure InsertNode.enhanceAndCheckForAutoincrement() calls RCL.forbidOverrides() on all types of ResultSetNodes.&lt;/p&gt;

&lt;p&gt;This made the problematic statement fail gracefully, but it introduced one failure in GeneratedColumnsTest.test_005_basicInsert(). That was the same failure as was seen with the first partial patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4433&quot; title=&quot;Cannot insert from EXCEPT/INTERSECT when target table has more columns than the source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4433&quot;&gt;&lt;del&gt;DERBY-4433&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12779864" author="knutanders" created="Thu, 19 Nov 2009 08:14:58 +0000"  >&lt;p&gt;Unassigning since it&apos;s probably better to revisit the issue after &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4433&quot; title=&quot;Cannot insert from EXCEPT/INTERSECT when target table has more columns than the source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4433&quot;&gt;&lt;del&gt;DERBY-4433&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4442&quot; title=&quot;Evaluation of default value and identity in an INSERT result set evaluated too early.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4442&quot;&gt;&lt;del&gt;DERBY-4442&lt;/del&gt;&lt;/a&gt; have been addressed. But anyone should feel free to pick it up even before that if they see how to solve it.&lt;/p&gt;</comment>
                            <comment id="12779871" author="knutanders" created="Thu, 19 Nov 2009 08:25:25 +0000"  >&lt;p&gt;One doesn&apos;t actually need to override the generated column to see this error. Just trying to insert DEFAULT in all rows also fails this way:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; create table t(a int generated always as (-b), b int);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; insert into t(a) values (default);&lt;br/&gt;
1 row inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; insert into t(a) values (default), (default);&lt;br/&gt;
ERROR XJ001: Java exception: &apos;0 &amp;gt;= 0: java.lang.ArrayIndexOutOfBoundsException&apos;.&lt;/p&gt;</comment>
                            <comment id="12781085" author="dagw" created="Sun, 22 Nov 2009 02:12:00 +0000"  >&lt;p&gt;This patch attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4451&quot; title=&quot;ArrayIndexOutOfBoundsException or ASSERT FAILED when inserting generated columns out of order&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4451&quot;&gt;&lt;del&gt;DERBY-4451&lt;/del&gt;&lt;/a&gt; also solves this issue.&lt;/p&gt;</comment>
                            <comment id="12782474" author="dagw" created="Wed, 25 Nov 2009 16:03:18 +0000"  >&lt;p&gt;Resolving this, since the issue is fixed by the committed fix to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4451&quot; title=&quot;ArrayIndexOutOfBoundsException or ASSERT FAILED when inserting generated columns out of order&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4451&quot;&gt;&lt;del&gt;DERBY-4451&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12828556" author="knutanders" created="Tue, 2 Feb 2010 09:39:13 +0000"  >&lt;p&gt;Verified fix on trunk. Closing.&lt;/p&gt;</comment>
                            <comment id="12884443" author="lilywei" created="Thu, 1 Jul 2010 22:55:06 +0100"  >&lt;p&gt;Reopen to 10.5 back port.&lt;/p&gt;</comment>
                            <comment id="12884926" author="mikem" created="Sat, 3 Jul 2010 15:42:41 +0100"  >&lt;p&gt;this issue was also fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4451&quot; title=&quot;ArrayIndexOutOfBoundsException or ASSERT FAILED when inserting generated columns out of order&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4451&quot;&gt;&lt;del&gt;DERBY-4451&lt;/del&gt;&lt;/a&gt; which has already been backported to 10.5.  Resolving issue as fixed in 10.5 branch.&lt;/p&gt;</comment>
                            <comment id="12885213" author="knutanders" created="Mon, 5 Jul 2010 13:51:40 +0100"  >&lt;p&gt;Changed 10.5 fix version to match the version on the branch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12468384">DERBY-4728</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12425445" name="forbid.diff" size="977" author="knutanders" created="Thu, 19 Nov 2009 08:12:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 22 Nov 2009 02:12:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24261</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0nrj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37668</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>