<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:47:25 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1438/DERBY-1438.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1438] Text written by SQLException.toString differs between client and embedded driver</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1438</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The first part of the string written by SQLExeption.toString() differs&lt;br/&gt;
between the Derby client driver and the embedded driver. The embedded&lt;br/&gt;
driver writes:&lt;/p&gt;

&lt;p&gt;   SQL Exception: Table/View &apos;DERBYDB&apos; does not exist.&lt;/p&gt;

&lt;p&gt;while the client driver writes:&lt;/p&gt;

&lt;p&gt;   java.sql.SQLException: Table/View &apos;DERBYDB&apos; does not exist.&lt;/p&gt;

&lt;p&gt;It would be good if we changed this so the same text is written by&lt;br/&gt;
both drivers. This reduces the difference seen when changing between&lt;br/&gt;
client and embedded Derby and it make it possible to reduce the amount&lt;br/&gt;
of sed-ing or the number of master file variants for some tests.&lt;/p&gt;</description>
                <environment>Sun JDK 1.5</environment>
        <key id="12344795">DERBY-1438</key>
            <summary>Text written by SQLException.toString differs between client and embedded driver</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davidvc">David Van Couvering</assignee>
                                    <reporter username="olav">Olav Sandstaa</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Jun 2006 00:22:15 +0100</created>
                <updated>Mon, 29 Jun 2009 14:13:25 +0100</updated>
                            <resolved>Fri, 21 Jul 2006 18:01:11 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12417330" author="davidvc" created="Fri, 23 Jun 2006 00:46:30 +0100"  >&lt;p&gt;I&apos;ll take a look at this and see what I can do.  Thanks, Olav.&lt;/p&gt;</comment>
                            <comment id="12417334" author="olav" created="Fri, 23 Jun 2006 01:05:41 +0100"  >&lt;p&gt;Personally, I prefer the text written by the embedded driver (&quot;SQL Exception:&quot;) over the text written by the client driver (&quot;java.sql.Exception:&quot;), but with the introduction of the SQL exception hierarchy in Java SE 6 it might be better to use the exact exception name (e.g. &quot;java.sql.IamSorryThisShouldNotHappenTodayException&quot;) which is what I think you get if you call SQLException.toString() and running with jdk 1.6.&lt;/p&gt;</comment>
                            <comment id="12420944" author="davidvc" created="Fri, 14 Jul 2006 05:47:00 +0100"  >&lt;p&gt;We can&apos;t override the toString() method on the network client, as what&apos;s being returned to users is a vanilla java.sql.SQLException (or one of its subclasses in JDBC4).  So it&apos;s going to do the default behavior and there&apos;s nothing we can do about it.&lt;/p&gt;

&lt;p&gt;In the embedded deriver, you&apos;ll also get the default toString() output, because in SQLExceptionFactory40 we&apos;re converting to vanilla java.sql.SQLException classes and its subtypes.&lt;/p&gt;

&lt;p&gt;Running pre-Java SE 6, the user gets an org.apache.derby.impl.jdbc.EmbedSQLException class, and that&apos;s kind of ugly to print out, and still wouldn&apos;t be consistent with the client.&lt;/p&gt;

&lt;p&gt;What I have done (see attached patch) is change the toString() override method in EmbedSQLException to print out &quot;java.sql.SQLException&quot; rather than just &quot;SQL Exception&quot;.  This is correct, in that EmbedSQLException is a subclass of java.sql.SQLException, and makes the client and the embedded drivers consistent.&lt;/p&gt;

&lt;p&gt;Unless anyone objects, I&apos;ll commit this (and resulting master output changes) after running derbyall.&lt;/p&gt;

&lt;p&gt;David&lt;/p&gt;</comment>
                            <comment id="12422186" author="davidvc" created="Wed, 19 Jul 2006 17:35:48 +0100"  >&lt;p&gt;This attachment includes all updates to master files.  It is a comment on master-based testing that a one-line change to source results in a 1MB overall patch because of master file changes.&lt;/p&gt;

&lt;p&gt;I tried to scan all the diffs but there was a lot to read.  I did a couple of sanity tests to increase my confidence that I didn&apos;t miss anything:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I verified that the number of lines added was exactly equal to the number of lines removed&lt;/li&gt;
	&lt;li&gt;I verified that if I filtered out &quot;java.sql.SQLException&quot; and &quot;SQL Exception&quot; from the master file diffs, there was nothing else in there&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Reviews appreciated.  I&apos;m running derbyall again since a lot of changes have come in since my last run.  If it passes, I&quot;ll check it in tomorrow barring any review comments.&lt;/p&gt;

&lt;p&gt;=========&lt;/p&gt;

&lt;p&gt;svn status output:&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/impl/jdbc/EmbedSQLException.java&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/iepnegativetests_ES.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/statementJdbc30.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/parameterMapping.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/compressTable.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/importExportThruIJ.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/nestedCommit.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/TransactionTable.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/procedure.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/ieptests.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/iepnegativetests.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/streamingColumn.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/importExport.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/DerbyNetClient/ieptests.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/outparams.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/releaseCompileLocks.out&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/master/statementJdbc20.out&lt;/p&gt;</comment>
                            <comment id="12422421" author="knutanders" created="Thu, 20 Jul 2006 14:54:25 +0100"  >&lt;p&gt;David wrote:&lt;/p&gt;

&lt;p&gt;&amp;gt; We can&apos;t override the toString() method on the network client, as&lt;br/&gt;
&amp;gt; what&apos;s being returned to users is a vanilla java.sql.SQLException&lt;br/&gt;
&amp;gt; (or one of its subclasses in JDBC4).  So it&apos;s going to do the&lt;br/&gt;
&amp;gt; default behavior and there&apos;s nothing we can do about it.&lt;/p&gt;

&lt;p&gt;Actually, there is something we can do. The spec doesn&apos;t say that we&lt;br/&gt;
can&apos;t create subclasses of the provided exception classes, so we can&lt;br/&gt;
override the toString() method.&lt;/p&gt;

&lt;p&gt;I tried this code&lt;/p&gt;

&lt;p&gt;    throw new SQLFeatureNotSupportedException(&quot;some error message&quot;) {&lt;br/&gt;
        public String toString() &lt;/p&gt;
{
            return &quot;SQLException: &quot; + getMessage();
        }
&lt;p&gt;    };&lt;/p&gt;

&lt;p&gt;and it printed this message&lt;/p&gt;

&lt;p&gt;  SQLException: some error message&lt;/p&gt;

&lt;p&gt;not&lt;/p&gt;

&lt;p&gt;  java.sql.SQLFeatureNotSupportedException: some error message&lt;/p&gt;</comment>
                            <comment id="12422714" author="davidvc" created="Fri, 21 Jul 2006 18:01:10 +0100"  >&lt;p&gt;Committed revision 424389.&lt;/p&gt;</comment>
                            <comment id="12427237" author="olav" created="Thu, 10 Aug 2006 15:34:57 +0100"  >&lt;p&gt;I have verified that SQLException.toString() writes the same text in both network client and embedded driver. &lt;/p&gt;

&lt;p&gt;Thanks for fixing this, David!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12337183" name="DERBY-1438-rev2.diff" size="1056955" author="davidvc" created="Wed, 19 Jul 2006 17:35:48 +0100"/>
                            <attachment id="12336826" name="DERBY-1438.diff" size="861" author="davidvc" created="Fri, 14 Jul 2006 05:47:00 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 22 Jun 2006 23:46:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29992</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0wtj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39135</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>