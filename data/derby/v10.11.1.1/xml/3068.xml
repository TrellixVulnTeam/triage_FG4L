<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:32:09 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3068/DERBY-3068.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3068] testImportExportProcedureNegative(org.apache.derbyTesting.functionTests.tests.tools.ImportExportProcedureTest)junit.framework.ComparisonFailure: Unexpected SQL state. expected:&lt;38000&gt; but was:&lt;XIE0S&gt;</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3068</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;1) testImportExportProcedureNegative(org.apache.derbyTesting.functionTests.tests.tools.ImportExportProcedureTest)junit.framework.ComparisonFailure: Unexpected SQL state. expected:&amp;lt;38000&amp;gt; but was:&amp;lt;XIE0S&amp;gt;&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertSQLState(BaseJDBCTestCase.java:668)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertSQLState(BaseJDBCTestCase.java:717)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:898)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.tools.ImportExportProcedureTest.testImportExportProcedureNegative(ImportExportProcedureTest.java:1933)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:64)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
Caused by: java.sql.SQLException: The export operation was not performed, because the specified output file (extinout/t1.dat) already exists. Export processing will not overwrite an existing file, even if the process has permissions to write to that file, due to security concerns, and to avoid accidental file damage. Please either change the output file name in the export procedure arguments to specify a file which does not exist, or delete the existing file, then retry the export operation.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.execute(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertStatementError(BaseJDBCTestCase.java:893)&lt;br/&gt;
	... 45 more&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: The export operation was not performed, because the specified output file (extinout/t1.dat) already exists. Export processing will not overwrite an existing file, even if the process has permissions to write to that file, due to security concerns, and to avoid accidental file damage. Please either change the output file name in the export procedure arguments to specify a file which does not exist, or delete the existing file, then retry the export operation.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeX(Unknown Source)&lt;br/&gt;
	... 47 more&lt;/p&gt;</description>
                <environment>Windows XP IBM 1.5</environment>
        <key id="12378012">DERBY-3068</key>
            <summary>testImportExportProcedureNegative(org.apache.derbyTesting.functionTests.tests.tools.ImportExportProcedureTest)junit.framework.ComparisonFailure: Unexpected SQL state. expected:&lt;38000&gt; but was:&lt;XIE0S&gt;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Sep 2007 00:07:41 +0100</created>
                <updated>Mon, 29 Jun 2009 23:58:10 +0100</updated>
                            <resolved>Mon, 28 Jan 2008 22:31:40 +0000</resolved>
                                    <version>10.3.3.0</version>
                    <version>10.4.1.3</version>
                                    <fixVersion>10.3.3.0</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12557461" author="djd" created="Wed, 9 Jan 2008 22:42:54 +0000"  >&lt;p&gt;I think this could be the fact that the file input is not closed if a failure exists during an import.&lt;/p&gt;

&lt;p&gt;In ImportAbstract and Import class where ever this code exists:&lt;/p&gt;

&lt;p&gt;    } catch (Exception ex) &lt;/p&gt;
{
		throw LoadError.unexpectedError(ex);
	}

&lt;p&gt;instead there should probably be something like:&lt;/p&gt;

&lt;p&gt;    } catch (Exception ex) &lt;/p&gt;
{
		throw importError(ex);
	}

&lt;p&gt;and a new importError method that does something like:&lt;/p&gt;

&lt;p&gt;SQLException importError(Exception ex) &lt;/p&gt;
{
    if (importReadData != null)
	   importReadData.closeStream(); // &amp;lt;&amp;lt; need to add try/catch block here.
    throw LoadError.unexpectedError(ex);
    
}</comment>
                            <comment id="12561777" author="kmarsden" created="Wed, 23 Jan 2008 19:09:27 +0000"  >&lt;p&gt;I made the import changes recommended by Dan and saw the failure in an IBM 1.5 run after making those changes.  In order to track down further I changed the test to delete the files immediately after the test which creates them rather than before the test which recreates them and changed deleteFile()  to fail if it cannot delete the file.  After this change I can&apos;t get the test to fail.  I think the changes are an improvement except that somehow they may be making the file deletion problem more intermittent.  There may still be an issue with import or export.  I&apos;d like to commit my changes as an incremental improvement and monitor this issue further.  Patch is derby-3068_diff.txt.  I ran on IBM 1.5 but will run on jdk 1.6 as well before checking in.&lt;/p&gt;

</comment>
                            <comment id="12563259" author="myrna" created="Mon, 28 Jan 2008 19:42:05 +0000"  >&lt;p&gt;This also shows  up in the 10.3 tests. Is it possible to backport this?&lt;br/&gt;
See e.g. &lt;a href=&quot;http://people.apache.org/~fuzzylogic/derby_test_results/v10_3/windows/testlog/ibm142/615545-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~fuzzylogic/derby_test_results/v10_3/windows/testlog/ibm142/615545-suites.All_diff.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12563318" author="kmarsden" created="Mon, 28 Jan 2008 22:31:40 +0000"  >&lt;p&gt;This failure has not been seen on the trunk since the change to cleanup the files in the fixture which they were created.   There may still be an issue with import cleanup, but I have not been able to reproduce.  If it shows up, it will do so as failure to delete the file and will give a different error message.  We can open a new issue or reopen this one if it comes up.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12369071">DERBY-2636</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12383686">DERBY-3239</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12373857" name="derby-3068_diff.txt" size="4849" author="kmarsden" created="Wed, 23 Jan 2008 19:09:26 +0000"/>
                            <attachment id="12373858" name="derby-3068_stat.txt" size="302" author="kmarsden" created="Wed, 23 Jan 2008 19:09:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 9 Jan 2008 22:42:54 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23410</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0vbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38894</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>