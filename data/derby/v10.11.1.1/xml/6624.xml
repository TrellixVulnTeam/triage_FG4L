<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6624/DERBY-6624.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6624] Use javax.xml.xpath interfaces for XPath support</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6624</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Currently, Derby uses the interfaces in the org.w3c.dom.xpath package to implement XPath support. That package is not part of the Java SE specification. Even though the package is included as an internal API in some of the major Java runtimes, using the standard javax.xml.xpath package instead would be better. It would be more portable, and less likely to break in the future if JVM vendors remove the internal API.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12722452">DERBY-6624</key>
            <summary>Use javax.xml.xpath interfaces for XPath support</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Jun 2014 10:20:15 +0100</created>
                <updated>Wed, 25 Jun 2014 08:26:25 +0100</updated>
                            <resolved>Mon, 23 Jun 2014 13:54:08 +0100</resolved>
                                    <version>10.11.1.1</version>
                                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="14038672" author="knutanders" created="Fri, 20 Jun 2014 11:54:49 +0100"  >&lt;p&gt;Attaching &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12651649/12651649_d6624-1a.diff&quot; title=&quot;d6624-1a.diff attached to DERBY-6624&quot;&gt;d6624-1a.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; which removes the use of the org.w3c.dom.xpath package and replaces it with the standard javax.xml.xpath package.&lt;/p&gt;

&lt;p&gt;The main reason why it wasn&apos;t done as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2739&quot; title=&quot;Use DOM interfaces to implement XML operators&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2739&quot;&gt;&lt;del&gt;DERBY-2739&lt;/del&gt;&lt;/a&gt;, was that the javax.xml.xpath interfaces require you to specify the return type of the XPath queries when you evaluate them, and we don&apos;t know what the query will return until after the query has been evaluated.&lt;/p&gt;

&lt;p&gt;The patch works around this limitation by initially assuming that the XPath query will return a set of nodes, and evaluate the query as if it actually returns a set of nodes. If this fails, it reevaluates the query as one that returns a scalar value. It caches the type information so that it won&apos;t have to guess the type, and possibly reevaluate the query, the next time it is executed. The type information is cached on the activation level, so it means that the extra work to figure out the type typically only happens once when accessing the first row the first time a statement is executed.&lt;/p&gt;

&lt;p&gt;All the regression tests ran cleanly with the patch. I&apos;ve successfully run the XML tests on Oracle JDK 6, 7, 8 and 9. I&apos;ve also run them successfully on Java 8 compact profile 2, but there I had to disable the security manager because of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6625&quot; title=&quot;Many permission related test failures on Java 8 compact2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6625&quot;&gt;&lt;del&gt;DERBY-6625&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Details of the patch:&lt;/p&gt;

&lt;p&gt;&lt;b&gt;java/engine/org/apache/derby/iapi/types/SqlXmlUtil.java&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Replace use of org.w3c.dom.xpath with javax.xml.xpath.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;java/engine/org/apache/derby/iapi/types/XML.java&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Change the checks for availability of XPath support. Instead of getting the DOMImplementation instance and calling getFeature() on it, we now simply check that the javax.xml.xpath.XPathFactory class is available on the classpath.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;java/engine/org/apache/derby/iapi/types/build.xml&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Build SqlXmlUtil using the ordinary build target, since no extra jar files need to be on the classpath anymore.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;java/testing/org/apache/derbyTesting/junit/XML.java&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Stop looking for DOM level 3 XPath support to find out if the XML tests should run. It now suffices to have a working XPathFactory.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;tools/java/xml-apis.jar&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Remove this jar file since it is no longer needed for building Derby.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;tools/ant/properties/extrapath.properties&lt;/b&gt;&lt;br/&gt;
&lt;b&gt;tools/ide/netbeans/nbproject/project.xml&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Remove references to the deleted xml-apis.jar from the javadoc classpath and the NetBeans classpath.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;tools/release/notices/xalan.txt&lt;/b&gt;&lt;br/&gt;
&lt;b&gt;build.xml&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Remove the mentioning of Xalan in the NOTICE file, since there are no Xalan jar files in source tree anymore.&lt;/p&gt;</comment>
                            <comment id="14038836" author="bryanpendleton" created="Fri, 20 Jun 2014 15:22:01 +0100"  >&lt;p&gt;Neat! Anything that simplifies the setup of the XML functionality is nice.&lt;/p&gt;</comment>
                            <comment id="14040654" author="jira-bot" created="Mon, 23 Jun 2014 12:44:09 +0100"  >&lt;p&gt;Commit 1604758 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1604758&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1604758&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6624&quot; title=&quot;Use javax.xml.xpath interfaces for XPath support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6624&quot;&gt;&lt;del&gt;DERBY-6624&lt;/del&gt;&lt;/a&gt;: Use javax.xml.xpath interfaces for XPath support&lt;/p&gt;

&lt;p&gt;Stop using the interfaces in the org.w3c.dom.xpath package, since they&lt;br/&gt;
are not part of the Java SE specification.&lt;/p&gt;</comment>
                            <comment id="14040707" author="knutanders" created="Mon, 23 Jun 2014 13:54:08 +0100"  >&lt;p&gt;Thanks, Bryan. I&apos;ve committed the patch to trunk, and filed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6633&quot; title=&quot;Remove DOM level 3 XPath requirement from description of XML operators&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6633&quot;&gt;&lt;del&gt;DERBY-6633&lt;/del&gt;&lt;/a&gt; to simplify the documentation as well. I also noticed that we&apos;re lacking some test coverage in SqlXmlUtil.java, so I&apos;ve filed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6634&quot; title=&quot;Improve test coverage of SqlXmlUtil.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6634&quot;&gt;&lt;del&gt;DERBY-6634&lt;/del&gt;&lt;/a&gt; to improve the tests.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12370645">DERBY-2739</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12723119">DERBY-6634</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12723110">DERBY-6633</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12723434">DERBY-6637</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12651649" name="d6624-1a.diff" size="31836" author="knutanders" created="Fri, 20 Jun 2014 11:54:49 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Jun 2014 14:22:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>400643</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzqtmf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>400737</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>