<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:14:15 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3537/DERBY-3537.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3537] Invalid use shutdown authentication checks in NetworkServerControlImpl.directShutdown() </title>
                <link>https://issues.apache.org/jira/browse/DERBY-3537</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If ClientThread hits an SSLException exception it will call NetworkServerControlImpl.directShutdown().&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2109&quot; title=&quot;System privileges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2109&quot;&gt;DERBY-2109&lt;/a&gt; added privilege checking to directShutdown() that includes authentication.&lt;/p&gt;

&lt;p&gt;I can&apos;t see how this call by ClientThread can be valid. Authentication is not required to start the network server, thus a NetworkServerControl with no user,password may be used and thus passed onto directShutdown() failing authentication and then failing to perform the failed shutdown?&lt;/p&gt;

&lt;p&gt;I think the error was adding the privilege check in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2109&quot; title=&quot;System privileges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2109&quot;&gt;DERBY-2109&lt;/a&gt;, it looks like this method is for use only within the network server (actually this is the only use of it), maybe the correct security mechanism would have been to make the method package private?&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12391400">DERBY-3537</key>
            <summary>Invalid use shutdown authentication checks in NetworkServerControlImpl.directShutdown() </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mzaun">Martin Zaun</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Mar 2008 03:28:08 +0000</created>
                <updated>Fri, 21 Jan 2011 17:51:44 +0000</updated>
                            <resolved>Wed, 2 Apr 2008 00:16:49 +0100</resolved>
                                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Network Server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12580607" author="mzaun" created="Wed, 19 Mar 2008 23:16:08 +0000"  >
&lt;p&gt;Not 100% sure I understand your suggestion, but I think you mean changing&lt;br/&gt;
a) method NetworkServerControlImpl.directShutdownInternal()  from private to package access,&lt;br/&gt;
b) ClientThread to call parent.directShutdownInternal() instead of parent.directShutdown().&lt;/p&gt;

&lt;p&gt;This would circumvent both checks, authentication and authorization (once it&apos;s enabled), for a shutdown from ClientThread in case of an SSLException.&lt;/p&gt;

&lt;p&gt;I don&apos;t think method NetworkServerControlImpl.directShutdown() can be made package-local, since it&apos;s also invoked via reflection java.engine.org.apache.derby.iapi.jdbc.DRDAServerStarter.java.&lt;/p&gt;</comment>
                            <comment id="12580614" author="djd" created="Wed, 19 Mar 2008 23:32:40 +0000"  >&lt;p&gt;I read the code to be a shutdown due to a SSLException is a shutdown due to some failure in the server.&lt;br/&gt;
In that case requiring a user/password and permission seems wrong, especially since the code that&lt;br/&gt;
started the server is the code that is calling this shutdown and a user/password is not required for startup.&lt;/p&gt;</comment>
                            <comment id="12581203" author="mzaun" created="Fri, 21 Mar 2008 22:23:47 +0000"  >&lt;p&gt;&amp;gt; ... especially since the code that started the server is the code that is calling this shutdown and a user/password is not required for startup.&lt;/p&gt;

&lt;p&gt;Convinced.  Please, find attached a patch:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;NetworServerControlImpl.directShutdownInternal() changed from private to package access&lt;/li&gt;
	&lt;li&gt;ClientThread changed to call directShutdownInternal() circumventing any authentication/authorization checks&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The junit tests succeeded.  A few derbayall tests failed because of unexpected output due to a debugging println() I&apos;d overlooked (posted -01 patch is clean). Will run derbyall on posted patch again next week but really don&apos;t expect any difference.&lt;/p&gt;</comment>
                            <comment id="12581723" author="rhillegas" created="Mon, 24 Mar 2008 23:29:47 +0000"  >&lt;p&gt;The tests run cleanly for me except for a failure in ManagementMBeanTest, which I have seen without this patch.&lt;/p&gt;</comment>
                            <comment id="12581951" author="rhillegas" created="Tue, 25 Mar 2008 14:19:45 +0000"  >&lt;p&gt;Committed at subversion revision 640828.&lt;/p&gt;</comment>
                            <comment id="12581958" author="rhillegas" created="Tue, 25 Mar 2008 14:31:14 +0000"  >&lt;p&gt;Ported 640828 from trunk to 10.4 branch at subversion revision 640830.&lt;/p&gt;</comment>
                            <comment id="12584352" author="mzaun" created="Wed, 2 Apr 2008 00:16:49 +0100"  >&lt;p&gt;Changes committed, resolving this issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12378416" name="DERBY-3537-01.diff" size="1452" author="mzaun" created="Fri, 21 Mar 2008 22:23:47 +0000"/>
                            <attachment id="12378415" name="DERBY-3537-01.stat" size="136" author="mzaun" created="Fri, 21 Mar 2008 22:23:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 19 Mar 2008 23:16:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23697</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0ljz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37310</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>