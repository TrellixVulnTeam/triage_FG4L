<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:36 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4791/DERBY-4791.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4791] LIKE operator optimizations and concatenation</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4791</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;While queries of the form &quot;&amp;lt;column&amp;gt; LIKE &apos; &amp;lt;string-constant&amp;gt;%&apos; &quot; are optimized into index scans, the equivalent expression using a concatenation &quot;&amp;lt;column&amp;gt; LIKE &apos; &amp;lt;string-constant&amp;gt;&apos; || &apos;%&apos; &quot; would result in a table scan. &lt;br/&gt;
Queries of the form &quot;&amp;lt;column&amp;gt; LIKE ?&quot; are optimizable using an internally generated parameter, so it doesn&apos;t seem far-fetched to generate such a parameter for a concatenation of strings (or other string expressions) as well, once its value has been calculated. This is of course limited to cases where the result of the string expression can be calculated once, i.e. it is independent of columns in the query.&lt;br/&gt;
It is sometimes possible to work around this by manually adding the &quot; x &amp;gt;= &apos;&amp;lt;string-constant&amp;gt;&apos; AND x &amp;lt; &apos;&amp;lt;string-constant&amp;gt;\uffff...&apos;  &quot; condition.&lt;/p&gt;</description>
                <environment>All</environment>
        <key id="12473312">DERBY-4791</key>
            <summary>LIKE operator optimizations and concatenation</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="uriah">Uriah Eisenstein</reporter>
                        <labels>
                    </labels>
                <created>Sat, 4 Sep 2010 17:35:58 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:25 +0100</updated>
                            <resolved>Mon, 1 Nov 2010 11:00:24 +0000</resolved>
                                    <version>10.6.1.0</version>
                                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12906502" author="knutanders" created="Mon, 6 Sep 2010 14:10:38 +0100"  >&lt;p&gt;One part of this issue, making Derby handle &quot;LIKE &apos;ab&apos; || &apos;%&apos;&quot; the same way as it handles &quot;LIKE &apos;ab%&apos;&quot;, should be possible to solve using the constant folding mechanism added in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4416&quot; title=&quot;Handle comparison of two constants as a boolean constant&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4416&quot;&gt;&lt;del&gt;DERBY-4416&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;ve attached a patch (fold-constants.diff) that implements an override of evaluateConstantExpressions() for ConcatentationOperatorNode. Unfortunately, this change alone didn&apos;t make LIKE use indexes, because the constant folding happens right before the statement optimization phase. LIKE decides whether to add extra scan predicates earlier than that, during the bind phase. I therefore made ConcatenationOperatorNode&apos;s bindExpression() method invoke the constant folding as well, and then it seems to be happening early enough so that LikeEscapeOperatorNode is able to pick it up.&lt;/p&gt;

&lt;p&gt;The patch also contains a test case that verifies that indexes are used. I haven&apos;t run any other tests on the patch yet.&lt;/p&gt;</comment>
                            <comment id="12906518" author="knutanders" created="Mon, 6 Sep 2010 16:16:33 +0100"  >&lt;p&gt;All the regression tests ran cleanly with the patch, so I&apos;m setting the patch available flag to mark it as ready for review.&lt;/p&gt;</comment>
                            <comment id="12906519" author="bryanpendleton" created="Mon, 6 Sep 2010 16:19:57 +0100"  >&lt;p&gt;This looks like a fine approach to me. Thanks for putting the patch together. +1.&lt;/p&gt;</comment>
                            <comment id="12906525" author="knutanders" created="Mon, 6 Sep 2010 16:45:32 +0100"  >&lt;p&gt;Thanks for the quick review, Bryan! Committed revision 993074.&lt;/p&gt;</comment>
                            <comment id="12926935" author="knutanders" created="Mon, 1 Nov 2010 11:00:24 +0000"  >&lt;p&gt;I&apos;m marking this issue as resolved since the patch addresses the case described in the issue description. I think there were some other cases mentioned in the derby-user thread that prompted this issue (for example &apos;abc&apos; || ?), and that&apos;s why I left it open after checking in the fix. But I see that only concatenation of string literals is mentioned explicitly in this issue, and that has been fixed. If there are more cases that need to be fixed, we should open separate JIRA issues for them.&lt;/p&gt;</comment>
                            <comment id="13685234" author="knutanders" created="Mon, 17 Jun 2013 10:19:25 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12502273">DERBY-5149</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12453942" name="fold-constants.diff" size="5715" author="knutanders" created="Mon, 6 Sep 2010 14:10:38 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 6 Sep 2010 13:10:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31380</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0haf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36619</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>