<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:27:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2559/DERBY-2559.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2559] recreating a datasource using javax.naming.Reference from a ClientDataSource40 fails</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2559</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Consider the following code snippet from test DataSourceReferenceTest:&lt;br/&gt;
--------------------&lt;br/&gt;
        Referenceable refDS = (Referenceable) ds;&lt;br/&gt;
        Reference dsAsReference = refDS.getReference();&lt;br/&gt;
        String factoryClassName = dsAsReference.getFactoryClassName();&lt;br/&gt;
        ObjectFactory factory = &lt;br/&gt;
            (ObjectFactory) Class.forName(factoryClassName).newInstance();  &lt;br/&gt;
        Object recreatedDS = &lt;br/&gt;
            factory.getObjectInstance(dsAsReference, null, null, null);&lt;br/&gt;
---------------------&lt;/p&gt;

&lt;p&gt;When ds is a ClientDataSource40 (i.e. when running with jdk16), recreatedDS is null.&lt;/p&gt;

&lt;p&gt;Note, that this showed up only after converting the test to junit, because the original test hardcoded the ds to be a ClientDataSource. I confirmed this not to be related to my changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2296&quot; title=&quot;getProperties method deprecated on ClientDataSource&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2296&quot;&gt;&lt;del&gt;DERBY-2296&lt;/del&gt;&lt;/a&gt; (which prompted me to convert the test), by backing out my changes to ClientBaseDataSource and client/am/Connection and rerunning the test (needed some minor adjustments of expected values table/array).&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12367417">DERBY-2559</key>
            <summary>recreating a datasource using javax.naming.Reference from a ClientDataSource40 fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="myrna">Myrna van Lunteren</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Apr 2007 22:26:56 +0100</created>
                <updated>Thu, 13 Jan 2011 21:46:05 +0000</updated>
                            <resolved>Mon, 10 Mar 2008 14:43:09 +0000</resolved>
                                    <version>10.3.1.4</version>
                    <version>10.4.1.3</version>
                                    <fixVersion>10.3.3.0</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12564056" author="kristwaa" created="Wed, 30 Jan 2008 15:39:50 +0000"  >&lt;p&gt;&apos;derby-2559-1a.diff&apos; is a patch that fixes the reported problem, where attempts to (re)create a data source through Reference returned null.&lt;br/&gt;
The cause was an if with entries for the pre-JDBC 4.0 classes (like ClientDataSource), but no entries for the JDBC 4.0 classes. I changed the factory class to use the same approach as the embedded driver, as it seemed to be easier to use reflection because of the mix between pre-JDBC 4.0 classes and JDBC 4.0 classes.&lt;br/&gt;
The patch also removes the workaround (disabling) in DataSourceReferenceTest.&lt;/p&gt;

&lt;p&gt;I am not sure if the method behaves as documented. I don&apos;t think it will ever return null, but either succeed or throw an exception. I will look at the documentation in a separate patch.&lt;/p&gt;

&lt;p&gt;I&apos;m running tests and will post the results later.&lt;br/&gt;
Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="12564748" author="kristwaa" created="Fri, 1 Feb 2008 13:12:22 +0000"  >&lt;p&gt;Committed &apos;derby-2559-1a.diff&apos; to trunk with revision 617492.&lt;br/&gt;
This commit is an incremental fix. More thought must be put into how the object factory is to be well behaved.&lt;br/&gt;
The factory will now create all the client data source objects, but it might/will fail if another type of object (or null) is passed as the first argument.&lt;/p&gt;

&lt;p&gt;I&apos;m also thinking about porting the fix to 10.3.&lt;/p&gt;</comment>
                            <comment id="12569251" author="kristwaa" created="Fri, 15 Feb 2008 12:24:03 +0000"  >&lt;p&gt;I have attached two more patches:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;derby-2559-2a-defenses.diff: Does some defensive checking to ensure no exception is thrown when it should not be.&lt;/li&gt;
	&lt;li&gt;derby-2559-3a-documentation.diff: Fixes to the documentation, both formatting and content.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Patches ready for review. I&apos;m especially awaiting comments on the 2a patch.&lt;/p&gt;</comment>
                            <comment id="12569269" author="knutanders" created="Fri, 15 Feb 2008 13:41:21 +0000"  >&lt;p&gt;2a looks good. Seems like the patch makes the implementation more in line with the description in the javadoc, so that&apos;s good.&lt;/p&gt;</comment>
                            <comment id="12569809" author="kristwaa" created="Mon, 18 Feb 2008 09:05:27 +0000"  >&lt;p&gt;Thanks for looking at the patch Knut Anders.&lt;/p&gt;

&lt;p&gt;&apos;derby-2559-3b-documentation.diff&apos; adds a throw clause to the JavaDoc and corrects an invalid reference. I also refreshed the patch after applying patch 2a.&lt;/p&gt;

&lt;p&gt;Committed &apos;derby-2559-2a-defenses.diff&apos; to trunk with revision 628647.&lt;br/&gt;
Committed &apos;derby-2559-3b-documentation.diff&apos; to trunk with revision 628654.&lt;/p&gt;

&lt;p&gt;The previous code failed to create data sources when running with Java SE 6.&lt;br/&gt;
This suggest the patches could be backported to branches 10.2 and 10.3.&lt;br/&gt;
Patches 1 and 2 apply cleanly, the documentation patch (3) does not.&lt;/p&gt;</comment>
                            <comment id="12569810" author="kristwaa" created="Mon, 18 Feb 2008 09:06:53 +0000"  >&lt;p&gt;Clearing patch available flag, but considering backporting at least patches 1 and 2 to 10.2 and 10.3.&lt;/p&gt;</comment>
                            <comment id="12573655" author="kristwaa" created="Fri, 29 Feb 2008 09:53:42 +0000"  >&lt;p&gt;Merged patches 1 and 2 to 10.3 with revision 632274.&lt;br/&gt;
Tests ran cleanly.&lt;/p&gt;

&lt;p&gt;For 10.2, the merge also worked (except that the test changes were skipped because the file doesn&apos;t exist), but I got one error:&lt;br/&gt;
derbyall/derbyall.fail:lang/timestampArith.java.&lt;br/&gt;
I also got this failure without the merge as well. I don&apos;t have time to investigate, so I will hold back the merge to 10.2.&lt;br/&gt;
If anyone wants to merge the fix, please go ahead.&lt;/p&gt;

&lt;p&gt;If this issue is still open in one week, I&apos;ll mark it resolved.&lt;/p&gt;</comment>
                            <comment id="12573976" author="kristwaa" created="Fri, 29 Feb 2008 21:49:24 +0000"  >&lt;p&gt;Seems I was bitten by this one, due to leap year issues: &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3486&quot; title=&quot;timestampArith.java fails on 10.1 on 2/28/2008  with leap year related isssues &quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3486&quot;&gt;&lt;del&gt;DERBY-3486&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
Thus the merge also ran without failures on the 10.2 branch.&lt;br/&gt;
I leave it up to the release manager or someone else to do the merge if they feel it&apos;s worth the hassle.&lt;/p&gt;</comment>
                            <comment id="12574707" author="army" created="Mon, 3 Mar 2008 19:48:50 +0000"  >&lt;p&gt;&amp;gt; Merged patches 1 and 2 to 10.3 with revision 632274.&lt;/p&gt;

&lt;p&gt;I think this merge lead to a javadoc error:&lt;/p&gt;

&lt;p&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;javadoc&amp;#93;&lt;/span&gt; java\client\org\apache\derby\client\ClientDataSourceFactory.java:48: warning - Tag @see: reference not found: ClientDataSource&lt;/p&gt;

&lt;p&gt;Does 628654 need to be merged back, as well?&lt;/p&gt;</comment>
                            <comment id="12577013" author="kristwaa" created="Mon, 10 Mar 2008 14:43:09 +0000"  >&lt;p&gt;Thank you Army.&lt;br/&gt;
The revision you mention updates the documentation, but does not fix the JavaDoc error (didn&apos;t notice...). I didn&apos;t merge it right away because I got conflicts for 10.2, but it applies fine for 10.3.&lt;/p&gt;

&lt;p&gt;Merged patch 3b to 10.3 with revision 635567, and also fixed the JavaDoc error in the same commit.&lt;/p&gt;

&lt;p&gt;Resolving issue, reopen to merge the fixes back to 10.2.&lt;br/&gt;
Will close the issue in a few days.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12374384" name="derby-2559-1a.diff" size="2580" author="kristwaa" created="Wed, 30 Jan 2008 15:39:50 +0000"/>
                            <attachment id="12375663" name="derby-2559-2a-defenses.diff" size="1659" author="kristwaa" created="Fri, 15 Feb 2008 12:24:02 +0000"/>
                            <attachment id="12375664" name="derby-2559-3a-documentation.diff" size="6204" author="kristwaa" created="Fri, 15 Feb 2008 12:24:03 +0000"/>
                            <attachment id="12375817" name="derby-2559-3b-documentation.diff" size="6348" author="kristwaa" created="Mon, 18 Feb 2008 09:05:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 30 Jan 2008 15:39:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23102</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0nin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37628</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>