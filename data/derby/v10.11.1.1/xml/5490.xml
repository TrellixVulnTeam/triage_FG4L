<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:21:40 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5490/DERBY-5490.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5490] Lots of error trying to spawn a JVM in the SecureServerTest and Replication tests when running on the preview JDK 7 on Mac OS X</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5490</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I see lots of errors when the tests try to spawn a JVM while running on the OpenJDK 7 preview for Mac OS X.&lt;/p&gt;

&lt;p&gt;SecureServerTest runs cleanly when I use JDK 6. But I see lots of these errors when I use JDK 7:&lt;/p&gt;

&lt;p&gt;.java.io.IOException: Cannot run program &quot;/Library/Java/JavaVirtualMachines/JDK&quot;: error=2, No such file or directory&lt;br/&gt;
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1029)&lt;br/&gt;
	at java.lang.Runtime.exec(Runtime.java:615)&lt;br/&gt;
	at java.lang.Runtime.exec(Runtime.java:448)&lt;br/&gt;
	at java.lang.Runtime.exec(Runtime.java:345)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SecureServerTest$1.run(SecureServerTest.java:487)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SecureServerTest.runServerCommand(SecureServerTest.java:479)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SecureServerTest.runsysinfo(SecureServerTest.java:415)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SecureServerTest.testServerStartup(SecureServerTest.java:356)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:601)&lt;br/&gt;
	at junit.framework.TestCase.runTest(TestCase.java:164)&lt;br/&gt;
	at junit.framework.TestCase.runBare(TestCase.java:130)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:116)&lt;br/&gt;
	at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.framework.TestResult.run(TestResult.java:109)&lt;br/&gt;
	at junit.framework.TestCase.run(TestCase.java:120)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.textui.TestRunner.doRun(TestRunner.java:121)&lt;br/&gt;
	at junit.textui.TestRunner.start(TestRunner.java:185)&lt;br/&gt;
	at junit.textui.TestRunner.main(TestRunner.java:143)&lt;br/&gt;
Caused by: java.io.IOException: error=2, No such file or directory&lt;br/&gt;
	at java.lang.UNIXProcess.forkAndExec(Native Method)&lt;br/&gt;
	at java.lang.UNIXProcess.&amp;lt;init&amp;gt;(UNIXProcess.java:135)&lt;br/&gt;
	at java.lang.ProcessImpl.start(ProcessImpl.java:130)&lt;br/&gt;
	at java.lang.ProcessBuilder.start(ProcessBuilder.java:1021)&lt;br/&gt;
	... 41 more&lt;/p&gt;</description>
                <environment>OpenJDK Runtime Environment (build 1.7.0-ea-b213) on Mac OS X 10.7</environment>
        <key id="12530065">DERBY-5490</key>
            <summary>Lots of error trying to spawn a JVM in the SecureServerTest and Replication tests when running on the preview JDK 7 on Mac OS X</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Nov 2011 15:02:20 +0000</created>
                <updated>Fri, 14 Jun 2013 18:20:15 +0100</updated>
                            <resolved>Mon, 14 Nov 2011 18:39:07 +0000</resolved>
                                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13144017" author="rhillegas" created="Fri, 4 Nov 2011 13:43:42 +0000"  >&lt;p&gt;Attaching derby-5490-01-aa-fixForMac.diff. With this patch SecureServerTest runs cleanly for me on my Mac on JDKs 6 and 7. Committed at subversion revision 1197563.&lt;/p&gt;

&lt;p&gt;The problem is that the pathname of my JDK 7 executable contains spaces. Because of the way that the server process is spawned, those spaces are interpreted as argument separators. I fixed this by replacing the java executable name with just &quot;java&quot; if the executable name contains spaces and you are running on Mac OS X. If people are experiencing this problem on other platforms, we could consider removing the Mac OS X check. I am reluctant to attempt a more general solution for fear that this may break something that doesn&apos;t need fixing in other developers&apos; environments.&lt;/p&gt;

&lt;p&gt;I will leave this issue open until the next time I run full regression tests on JDK 7.&lt;/p&gt;

&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;p&gt;M       java/testing/org/apache/derbyTesting/junit/BaseTestCase.java&lt;/p&gt;</comment>
                            <comment id="13149806" author="rhillegas" created="Mon, 14 Nov 2011 18:39:07 +0000"  >&lt;p&gt;Resolving this issue. I have not seen these errors in my last couple test runs on Java 7. I see the trigger-related errors in the upgrade tests that everyone else sees and I see the errors described on derby-5402. But I don&apos;t see errors related to spawning server JVMs.&lt;/p&gt;</comment>
                            <comment id="13151224" author="dagw" created="Wed, 16 Nov 2011 14:22:41 +0000"  >&lt;p&gt;I think the patch for this issue can be backed out when &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5504&quot; title=&quot;SecureServerTest, Driver40UnbootedTest and replication tests not prepared for space in java.home&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5504&quot;&gt;&lt;del&gt;DERBY-5504&lt;/del&gt;&lt;/a&gt; is implemented: it turns out this patch caused another issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5502&quot; title=&quot;RestrictiveFilePermissionsTest and RecoveryTest fail with file permission errors on the OpenJDK 7 preview for Mac OS X&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5502&quot;&gt;&lt;del&gt;DERBY-5502&lt;/del&gt;&lt;/a&gt; since the patch makes tests start &quot;java&quot; subprocesses with a relative path (rather than absolute), which needs more Java privileges to run (execute on all files in fact), as opposed to execute privilege just on the java image.&lt;/p&gt;</comment>
                            <comment id="13151226" author="rhillegas" created="Wed, 16 Nov 2011 14:27:20 +0000"  >&lt;p&gt;Thanks Dag. I agree.&lt;/p&gt;</comment>
                            <comment id="13152927" author="rhillegas" created="Fri, 18 Nov 2011 15:40:41 +0000"  >&lt;p&gt;Attaching derby-5490-03-aa-revert.diff. This patch reverts the previous work done on this issue now that &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5504&quot; title=&quot;SecureServerTest, Driver40UnbootedTest and replication tests not prepared for space in java.home&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5504&quot;&gt;&lt;del&gt;DERBY-5504&lt;/del&gt;&lt;/a&gt; has provided a more comprehensive solution. I have verified that SecureServerTest and ReplicationSuite run cleanly after applying this reversion. Committed at subversion revision 1203706.&lt;/p&gt;

&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;p&gt;M       java/testing/org/apache/derbyTesting/junit/BaseTestCase.java&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12531611">DERBY-5504</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12531353">DERBY-5502</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12502396" name="derby-5490-01-aa-fixForMac.diff" size="713" author="rhillegas" created="Fri, 4 Nov 2011 13:43:42 +0000"/>
                            <attachment id="12504221" name="derby-5490-03-aa-revert.diff" size="671" author="rhillegas" created="Fri, 18 Nov 2011 15:40:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Nov 2011 14:22:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>215924</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0ejz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36176</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>