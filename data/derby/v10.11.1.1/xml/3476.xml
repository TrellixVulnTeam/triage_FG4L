<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:24:37 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3476/DERBY-3476.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3476] Permissions and Principal objects added by this feature need to be final and have serialization identifiers</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3476</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Need serialization id to ensure the class is portable across releases.&lt;br/&gt;
Need final to provide security.&lt;/p&gt;

&lt;p&gt;(assumes patch10 is committed from &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2109&quot; title=&quot;System privileges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2109&quot;&gt;DERBY-2109&lt;/a&gt;)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12389725">DERBY-3476</key>
            <summary>Permissions and Principal objects added by this feature need to be final and have serialization identifiers</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12356374">DERBY-2109</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Feb 2008 20:04:34 +0000</created>
                <updated>Wed, 9 Jul 2014 13:54:43 +0100</updated>
                            <resolved>Wed, 9 Jul 2014 13:54:43 +0100</resolved>
                                                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Services</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="14052264" author="knutanders" created="Fri, 4 Jul 2014 09:43:41 +0100"  >&lt;p&gt;DatabasePermission, SystemPermission and SystemPrincipal are all final and have serialization identifiers now.&lt;/p&gt;

&lt;p&gt;The serialization logic could still benefit from some improvements, tough:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DatabasePermission would be more future-proof if it persisted the action string (currently it doesn&apos;t because it knows it has to be &quot;create&quot;).&lt;/li&gt;
	&lt;li&gt;SystemPermission doesn&apos;t validate the name and the action string on deserialization. It should perform the same checks on deserialization as it does in its constructor.&lt;/li&gt;
	&lt;li&gt;SystemPrincipal doesn&apos;t validate the name on deserialization. It should perform the same checks as its constructor.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14053706" author="knutanders" created="Mon, 7 Jul 2014 15:33:21 +0100"  >&lt;p&gt;The patch &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12654325/12654325_d3476-1a-system-permission.diff&quot; title=&quot;d3476-1a-system-permission.diff attached to DERBY-3476&quot;&gt;d3476-1a-system-permission.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; makes the following changes:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add a readObject() method to the SystemPermission class which performs validation of name and actions when deserializing a SystemPermission object. (It performs the same checks as in the constructor.)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add a test case that verifies that deserialization will raise exceptions when invalid SystemPermission objects are read from a stream.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Add test cases that verify that the SystemPermission, DatabasePermission and SystemPrincipal classes are declared final.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;All regression tests ran cleanly with the patch.&lt;/p&gt;</comment>
                            <comment id="14054553" author="jira-bot" created="Tue, 8 Jul 2014 07:18:13 +0100"  >&lt;p&gt;Commit 1608670 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1608670&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1608670&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3476&quot; title=&quot;Permissions and Principal objects added by this feature need to be final and have serialization identifiers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3476&quot;&gt;&lt;del&gt;DERBY-3476&lt;/del&gt;&lt;/a&gt;: Improve serialization logic for SystemPermission&lt;/p&gt;

&lt;p&gt;Validate name and actions fields when deserializing a stored&lt;br/&gt;
SystemPermission, and throw an exception if the stored&lt;br/&gt;
SystemPermission is not a valid one.&lt;/p&gt;</comment>
                            <comment id="14054974" author="knutanders" created="Tue, 8 Jul 2014 15:18:43 +0100"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12654589/12654589_d3476-2a-database-permission.diff&quot; title=&quot;d3476-2a-database-permission.diff attached to DERBY-3476&quot;&gt;d3476-2a-database-permission.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; improves the serialization logic of the DatabasePermission class. It changes the stored format of DatabasePermission. This doesn&apos;t cause any compatibility issues, though, since the code paths that use DatabasePermission haven&apos;t been enabled yet.&lt;/p&gt;

&lt;p&gt;The patch makes the following changes:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The pathType field is made transient. It is recomputed on deserialization (also with the existing logic), so storing it is redundant.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The url field is removed from the class. This field holds exactly the same string as the name field of the parent class (Permission), so it&apos;s redundant. Also, the existing deserialization logic only checks the validity of the url field. The name field is not checked. So it is possible that a DatabasePermission object is inconsistent (has an invalid name) if it&apos;s read from a corrupted stream.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The Permission.name field is validated on deserialization.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A new field &quot;actions&quot; is added, which holds the value received in the actions parameter of the constructor. This isn&apos;t strictly necessary currently, since the constructor only accepts actions=&quot;create&quot;, so we always know its value. Adding the field allows us to accept more values later without changing the stored format, so it might avoid compatibility issues in the future. The new field is validated on deserialization the same way as on construction.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The logic to parse the actions string is refactored so that SystemPermission and DatabasePermission can share the code.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I noticed that the handing of the actions string isn&apos;t exactly the same in SystemPermission and DatabasePermission. SystemPermission ignores empty and invalid actions, whereas DatabasePermission raises an IllegalArgumentException if the constructor gets an empty actions string or one that contains an invalid action. The patch preserves this difference in the deserialization logic.&lt;/p&gt;

&lt;p&gt;All regression tests ran cleanly with the patch.&lt;/p&gt;</comment>
                            <comment id="14055960" author="jira-bot" created="Wed, 9 Jul 2014 08:36:41 +0100"  >&lt;p&gt;Commit 1609039 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1609039&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1609039&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3476&quot; title=&quot;Permissions and Principal objects added by this feature need to be final and have serialization identifiers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3476&quot;&gt;&lt;del&gt;DERBY-3476&lt;/del&gt;&lt;/a&gt;: Improve serialization of DatabasePermission&lt;/p&gt;

&lt;p&gt;Store the URL only once (remove the url field, as the URL is already&lt;br/&gt;
stored in Permission.name).&lt;/p&gt;

&lt;p&gt;Make the pathType field transient, since it is recalculated on&lt;br/&gt;
deserialization anyway.&lt;/p&gt;

&lt;p&gt;Store the actions portion of the permission.&lt;/p&gt;</comment>
                            <comment id="14056134" author="knutanders" created="Wed, 9 Jul 2014 12:38:27 +0100"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12654787/12654787_d3476-3a-system-principal.diff&quot; title=&quot;d3476-3a-system-principal.diff attached to DERBY-3476&quot;&gt;d3476-3a-system-principal.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; makes SystemPrincipal validate the name field on deserialization, and adds tests to verify that the validation happens.&lt;/p&gt;</comment>
                            <comment id="14056190" author="jira-bot" created="Wed, 9 Jul 2014 13:52:11 +0100"  >&lt;p&gt;Commit 1609138 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1609138&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1609138&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3476&quot; title=&quot;Permissions and Principal objects added by this feature need to be final and have serialization identifiers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3476&quot;&gt;&lt;del&gt;DERBY-3476&lt;/del&gt;&lt;/a&gt;: Improve serialization of SystemPrincipal&lt;/p&gt;

&lt;p&gt;Validate the name when reading a SystemPrincipal object from a stream.&lt;/p&gt;</comment>
                            <comment id="14056195" author="knutanders" created="Wed, 9 Jul 2014 13:54:43 +0100"  >&lt;p&gt;I believe the work on this issue is done. Resolving the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12654325" name="d3476-1a-system-permission.diff" size="14943" author="knutanders" created="Mon, 7 Jul 2014 15:33:21 +0100"/>
                            <attachment id="12654589" name="d3476-2a-database-permission.diff" size="19148" author="knutanders" created="Tue, 8 Jul 2014 15:18:43 +0100"/>
                            <attachment id="12654787" name="d3476-3a-system-principal.diff" size="4471" author="knutanders" created="Wed, 9 Jul 2014 12:38:27 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 4 Jul 2014 08:43:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30874</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0v2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38853</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>