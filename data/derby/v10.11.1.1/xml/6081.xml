<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:27:00 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6081/DERBY-6081.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6081] JDBC 4.2 setObject() and updateObject() methods throw NPE when type is null</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6081</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If the SQLType argument to the new JDBC 4.2 methods in PreparedStatement and ResultSet is null, the call will fail with a NullPointerException. It should fail with an SQLException.&lt;/p&gt;

&lt;p&gt;Stack trace on embedded:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util42.getTypeAsInt(Util42.java:57)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedPreparedStatement42.setObject(EmbedPreparedStatement42.java:57)&lt;/p&gt;

&lt;p&gt;Stack trace on client:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
        at org.apache.derby.client.am.Utils42.getTypeAsInt(Utils42.java:55)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement42.setObject(PreparedStatement42.java:78)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12633185">DERBY-6081</key>
            <summary>JDBC 4.2 setObject() and updateObject() methods throw NPE when type is null</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                            <label>derby_backport_reject_10_9</label>
                    </labels>
                <created>Wed, 20 Feb 2013 13:08:06 +0000</created>
                <updated>Tue, 9 Jul 2013 15:07:00 +0100</updated>
                            <resolved>Wed, 20 Feb 2013 16:27:29 +0000</resolved>
                                    <version>10.10.1.1</version>
                                    <fixVersion>10.10.1.1</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13582246" author="knutanders" created="Wed, 20 Feb 2013 15:36:13 +0000"  >&lt;p&gt;The current code detects that an invalid type is specified and tries to create an SQLException to report it. When creating the SQLException, it calls toString() on the type object in order to produce the message text. Since the object is null, a NullPointerException is thrown.&lt;/p&gt;

&lt;p&gt;The factory methods that create SQLExceptions don&apos;t require message arguments to be strings, they could be any object type. Eventually, MessageFormat will call toString() on them, but it will first check for null values in order to prevent NullPointerExceptions.&lt;/p&gt;

&lt;p&gt;The attached patch changes the code that produces the SQLException so that it simply passes the SQLType object to the message formatter without calling toString() on it first. This prevents the NullPointerException and makes setObject() and updateObject() produce an SQLException with the following message text instead:&lt;/p&gt;

&lt;p&gt;java.sql.SQLFeatureNotSupportedException: The data type &apos;null&apos; is not supported.&lt;/p&gt;

&lt;p&gt;The patch adds test cases to PreparedStatementTest42. This test fails with NPE without the suggested fix, and runs cleanly when the fix is applied. I&apos;ve started the full regression test suite on JDK 8. Will report back when it has completed.&lt;/p&gt;</comment>
                            <comment id="13582248" author="bryanpendleton" created="Wed, 20 Feb 2013 15:40:19 +0000"  >&lt;p&gt;Nice and clean, I like it!&lt;/p&gt;</comment>
                            <comment id="13582294" author="knutanders" created="Wed, 20 Feb 2013 16:27:29 +0000"  >&lt;p&gt;Thank you, Bryan!&lt;/p&gt;

&lt;p&gt;The test run failed in Changes10_10.testFloatLimits() and SystemPrivilegesPermissionTest.policyTestDatabasePermissionGrants(). The former also fails in the continuous testing, and the latter fails on Java 8 in my environment without the patch, so I believe they are both unrelated to my patch.&lt;/p&gt;

&lt;p&gt;Committed revision 1448278.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12570141" name="d6081-1a.diff" size="5382" author="knutanders" created="Wed, 20 Feb 2013 15:36:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 20 Feb 2013 15:40:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>313681</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzbzcf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>314026</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>