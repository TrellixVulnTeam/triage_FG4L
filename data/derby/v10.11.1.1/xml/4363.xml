<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:29:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4363/DERBY-4363.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4363] Add simple benchmark for measuring GROUP BY performance</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4363</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;As part of ROLLUP implementation (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3002&quot; title=&quot;Add support for GROUP BY ROLLUP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3002&quot;&gt;&lt;del&gt;DERBY-3002&lt;/del&gt;&lt;/a&gt;), it will be helpful to be able to measure the performance of GROUP BY.&lt;/p&gt;

&lt;p&gt;Using the o.a.dT.perf.clients framework, this sub-task proposes to add a GroupByClient to the performance runner&lt;br/&gt;
library; the GroupByClient will run GROUP BY statements against the Wisconsin benchmark database.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12434354">DERBY-4363</key>
            <summary>Add simple benchmark for measuring GROUP BY performance</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12375845">DERBY-3002</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bryanpendleton">Bryan Pendleton</assignee>
                                    <reporter username="bryanpendleton">Bryan Pendleton</reporter>
                        <labels>
                    </labels>
                <created>Sat, 29 Aug 2009 16:45:35 +0100</created>
                <updated>Fri, 21 Jan 2011 17:52:34 +0000</updated>
                            <resolved>Sat, 12 Sep 2009 22:09:41 +0100</resolved>
                                                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>Test</component>
                    <component>Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12749281" author="bryanpendleton" created="Sun, 30 Aug 2009 17:20:41 +0100"  >&lt;p&gt;Attached &apos;simpleBenchmark.diff&apos; is a patch proposal for a new benchmark&lt;br/&gt;
in the o.a.dT.perf.clients package.&lt;/p&gt;

&lt;p&gt;This benchmark runs 3 GROUP BY statements against the scalable&lt;br/&gt;
Wisconsin table TENKTUP1. The statements partition the entire table&lt;br/&gt;
into (a) 10 groups, (b) 100 groups, and (c) 1000 groups.&lt;/p&gt;

&lt;p&gt;Sample ways to run this benchmark:&lt;br/&gt;
1)  java org.apache.derbyTesting.perf.clients.Runner -load group_by -init&lt;/p&gt;

&lt;p&gt;     initializes the database and runs the benchmark against the 10,000 row&lt;br/&gt;
     default Wisconsin database.&lt;/p&gt;

&lt;p&gt;2) java org.apache.derbyTesting.perf.clients.Runner -load group_by -init -load_opts numRows=100000&lt;/p&gt;

&lt;p&gt;      Reloads the DB and runs the benchmark against a 100,000 row table.&lt;/p&gt;

&lt;p&gt;3) java org.apache.derbyTesting.perf.clients.Runner -load group_by -init -load_opts numRows=1000000 -rt 300&lt;/p&gt;

&lt;p&gt;    Reloads the DB and runs the benchmark against a 1,000,000 row table. Since&lt;br/&gt;
    the runtimes are much slower against a giant table, lets the benchmark run 5 minutes.&lt;/p&gt;

&lt;p&gt;Comments and suggestions would be wonderful.&lt;/p&gt;</comment>
                            <comment id="12749431" author="knutanders" created="Mon, 31 Aug 2009 10:05:35 +0100"  >&lt;p&gt;Hi Bryan,&lt;/p&gt;

&lt;p&gt;Thanks for writing the test. It looks good to me, and I think it will be helpful in evaluating whether &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3002&quot; title=&quot;Add support for GROUP BY ROLLUP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3002&quot;&gt;&lt;del&gt;DERBY-3002&lt;/del&gt;&lt;/a&gt; affects plain GROUP BY statements in any way.&lt;/p&gt;

&lt;p&gt;Currently, the test uses a mix of three different statements with different characteristics. This means that the reported results only show the average, and some effects may be hidden if the performance of one of the statements is improved whereas another one performs worse. Perhaps we should have an option to run with just one of the statements?&lt;/p&gt;

&lt;p&gt;Do you think it would add value to have a test case with multiple GROUP BY columns?&lt;/p&gt;</comment>
                            <comment id="12752180" author="bryanpendleton" created="Mon, 7 Sep 2009 16:40:24 +0100"  >&lt;p&gt;Attached is &apos;multiColumnBenchmark, an enhanced version of the GroupByClient proposal&lt;br/&gt;
which can now generate a richer variety of GROUP BY statements.&lt;/p&gt;

&lt;p&gt;It also only executes a single statement per run, since I agree with the&lt;br/&gt;
observation that it is hard to interpret the results of running a mixture&lt;br/&gt;
of statements in the same run.&lt;/p&gt;

&lt;p&gt;I put a lot of comments into the GroupByClient header which should explain&lt;br/&gt;
how to invoke the benchmark to run a richer set of statements.&lt;/p&gt;

&lt;p&gt;I gave getLoadOpt package visibility so that the GroupByClient could&lt;br/&gt;
interrogate the -load_opts settings in a more convenient fashion.&lt;/p&gt;

&lt;p&gt;Continued suggestions and comments would be greatly appreciated.&lt;/p&gt;

&lt;p&gt;Soon, I hope to find the time to run this benchmark against the current trunk,&lt;br/&gt;
as well as against the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3002&quot; title=&quot;Add support for GROUP BY ROLLUP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3002&quot;&gt;&lt;del&gt;DERBY-3002&lt;/del&gt;&lt;/a&gt; patch proposal, to get a first set of&lt;br/&gt;
numbers to explore the overall performance characteristics in a coarse fashion.&lt;/p&gt;

&lt;p&gt;I&apos;m hoping it will be sufficient to perform, say, 5 different GROUP BY statements&lt;br/&gt;
against each version of the code, at scales 10 thousand, 100 thousand, and&lt;br/&gt;
250 thousand rows. That will give us 15 numbers for each branch, and&lt;br/&gt;
maybe we can see some results from that data. &lt;/p&gt;

&lt;p&gt;I should be able to post those runs as a &quot;script&quot; of 18 perf.clients.Runner statements&lt;br/&gt;
to be run in sequence against each code branch.&lt;/p&gt;</comment>
                            <comment id="12752394" author="knutanders" created="Tue, 8 Sep 2009 09:54:26 +0100"  >&lt;p&gt;Thanks, Bryan. That sounds like a great plan to me. I&apos;ll see if I can find time to run the tests too.&lt;/p&gt;</comment>
                            <comment id="12752824" author="bryanpendleton" created="Wed, 9 Sep 2009 00:26:40 +0100"  >&lt;p&gt;Attached is &apos;benchmark.sh&apos;, which contains the simple script that I ran to&lt;br/&gt;
conduct a 15-item benchmark of the GROUP BY statement with and without&lt;br/&gt;
the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3002&quot; title=&quot;Add support for GROUP BY ROLLUP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3002&quot;&gt;&lt;del&gt;DERBY-3002&lt;/del&gt;&lt;/a&gt; patch applied.&lt;/p&gt;

&lt;p&gt;Also attached is &apos;bmTrunk.out&apos; and &apos;bmWithPatch.out&apos;, which are the benchmark&lt;br/&gt;
results of the script on a clean trunk build, and on a build with the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3002&quot; title=&quot;Add support for GROUP BY ROLLUP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3002&quot;&gt;&lt;del&gt;DERBY-3002&lt;/del&gt;&lt;/a&gt; patch.&lt;/p&gt;

&lt;p&gt;Unfortunately, the benchmark appears to show substantial performance&lt;br/&gt;
problems with the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3002&quot; title=&quot;Add support for GROUP BY ROLLUP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3002&quot;&gt;&lt;del&gt;DERBY-3002&lt;/del&gt;&lt;/a&gt; patch, so I&apos;ll have to look into the results more deeply.&lt;/p&gt;

&lt;p&gt;I suspect that this means that the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3002&quot; title=&quot;Add support for GROUP BY ROLLUP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3002&quot;&gt;&lt;del&gt;DERBY-3002&lt;/del&gt;&lt;/a&gt; patch cannot simply eliminate&lt;br/&gt;
the code patch which performs aggregation within the sort observer, because&lt;br/&gt;
the performance wins from doing such aggregation are substantial.&lt;/p&gt;</comment>
                            <comment id="12753600" author="knutanders" created="Thu, 10 Sep 2009 14:01:34 +0100"  >&lt;p&gt;I&apos;ve only run the tests in one configuration (-load group_by -load_opts numGroupingCols=2,numGroups1=10,numGroups2=100), but my runs confirm what you&apos;re seeing. I had a quick look at some profiling results, but nothing jumped at me. The runs with the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3002&quot; title=&quot;Add support for GROUP BY ROLLUP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3002&quot;&gt;&lt;del&gt;DERBY-3002&lt;/del&gt;&lt;/a&gt; patch did seem to spend more time copying values, though (ValueRow.getClone() and SQLInteger.getClone() in particular). Not sure if that helps, but I thought I&apos;d mention it.&lt;/p&gt;</comment>
                            <comment id="12754614" author="bryanpendleton" created="Sat, 12 Sep 2009 22:09:41 +0100"  >&lt;p&gt;I fixed a small typo in wisconsin.java (the &apos;compress&apos; argument was always being&lt;br/&gt;
set to &apos;false&apos;, ran a complete set of regression tests without problem, and submitted&lt;br/&gt;
this benchmark as revision 814237.&lt;/p&gt;

&lt;p&gt;We may end up adding more types of GROUP BY statements to this benchmark&lt;br/&gt;
over time, but for now it seems like the work on this task is done.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12418992" name="benchmark.sh" size="2543" author="bryanpendleton" created="Wed, 9 Sep 2009 00:26:40 +0100"/>
                            <attachment id="12418993" name="bmTrunk.out" size="6188" author="bryanpendleton" created="Wed, 9 Sep 2009 00:26:40 +0100"/>
                            <attachment id="12418994" name="bmWithPatch.out" size="6192" author="bryanpendleton" created="Wed, 9 Sep 2009 00:26:40 +0100"/>
                            <attachment id="12418819" name="multiColumnBenchmark.diff" size="13551" author="bryanpendleton" created="Mon, 7 Sep 2009 16:40:24 +0100"/>
                            <attachment id="12418097" name="simpleBenchmark.diff" size="9769" author="bryanpendleton" created="Sun, 30 Aug 2009 17:20:41 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10362"><![CDATA[Performance]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 31 Aug 2009 09:05:35 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31210</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0kz3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37216</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>