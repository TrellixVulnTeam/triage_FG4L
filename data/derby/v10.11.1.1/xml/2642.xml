<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:42:22 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2642/DERBY-2642.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2642] Convert lang/dynamicLikeOptimization.sql to JUnit</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2642</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description></description>
                <environment></environment>
        <key id="12369234">DERBY-2642</key>
            <summary>Convert lang/dynamicLikeOptimization.sql to JUnit</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 May 2007 10:16:39 +0100</created>
                <updated>Mon, 18 Jun 2007 15:45:51 +0100</updated>
                            <resolved>Wed, 23 May 2007 07:35:08 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12495524" author="knutanders" created="Mon, 14 May 2007 10:26:34 +0100"  >&lt;p&gt;This test contains one call to SYSCS_GET_RUNTIMESTATISTICS with the following comment:&lt;/p&gt;

&lt;p&gt;&amp;#8211; verify that like optimization being performed&lt;br/&gt;
execute p2 using &apos;values &apos;&apos;%&apos;&apos; &apos;;&lt;br/&gt;
values SYSCS_UTIL.SYSCS_GET_RUNTIMESTATISTICS();&lt;/p&gt;

&lt;p&gt;Does anyone know which part of the query plan that shows that like optimization has been performed?&lt;/p&gt;

&lt;p&gt;This is what the query plan in question looks like:&lt;/p&gt;

&lt;p&gt;Statement Name: &lt;br/&gt;
	null&lt;br/&gt;
Statement Text: &lt;br/&gt;
	select id from test where vc10 like ?&lt;br/&gt;
Parse Time: 0&lt;br/&gt;
Bind Time: 0&lt;br/&gt;
Optimize Time: 0&lt;br/&gt;
Generate Time: 0&lt;br/&gt;
Compile Time: 0&lt;br/&gt;
Execute Time: 0&lt;br/&gt;
Begin Compilation Timestamp : null&lt;br/&gt;
End Compilation Timestamp : null&lt;br/&gt;
Begin Execution Timestamp : null&lt;br/&gt;
End Execution Timestamp : null&lt;br/&gt;
Statement Execution Plan Text: &lt;br/&gt;
Project-Restrict ResultSet (3):&lt;br/&gt;
Number of opens = 1&lt;br/&gt;
Rows seen = 7&lt;br/&gt;
Rows filtered = 0&lt;br/&gt;
restriction = false&lt;br/&gt;
projection = true&lt;br/&gt;
	constructor time (milliseconds) = 0&lt;br/&gt;
	open time (milliseconds) = 0&lt;br/&gt;
	next time (milliseconds) = 0&lt;br/&gt;
	close time (milliseconds) = 0&lt;br/&gt;
	restriction time (milliseconds) = 0&lt;br/&gt;
	projection time (milliseconds) = 0&lt;br/&gt;
Source result set:&lt;br/&gt;
	Project-Restrict ResultSet (2):&lt;br/&gt;
	Number of opens = 1&lt;br/&gt;
	Rows seen = 7&lt;br/&gt;
	Rows filtered = 0&lt;br/&gt;
	restriction = true&lt;br/&gt;
	projection = false&lt;br/&gt;
		constructor time (milliseconds) = 0&lt;br/&gt;
		open time (milliseconds) = 0&lt;br/&gt;
		next time (milliseconds) = 0&lt;br/&gt;
		close time (milliseconds) = 0&lt;br/&gt;
		restriction time (milliseconds) = 0&lt;br/&gt;
		projection time (milliseconds) = 0&lt;br/&gt;
	Source result set:&lt;br/&gt;
		Table Scan ResultSet for TEST at read committed isolation level using instantaneous share row locking chosen by the optimizer&lt;br/&gt;
		Number of opens = 1&lt;br/&gt;
		Rows seen = 7&lt;br/&gt;
		Rows filtered = 0&lt;br/&gt;
		Fetch Size = 16&lt;br/&gt;
			constructor time (milliseconds) = 0&lt;br/&gt;
			open time (milliseconds) = 0&lt;br/&gt;
			next time (milliseconds) = 0&lt;br/&gt;
			close time (milliseconds) = 0&lt;br/&gt;
			next time in milliseconds/row = 0&lt;br/&gt;
		scan information: &lt;br/&gt;
			Bit set of columns fetched=&lt;/p&gt;
{0, 2}
&lt;p&gt;			Number of columns fetched=2&lt;br/&gt;
			Number of pages visited=1&lt;br/&gt;
			Number of rows qualified=7&lt;br/&gt;
			Number of rows visited=8&lt;br/&gt;
			Scan type=heap&lt;br/&gt;
			start position: &lt;br/&gt;
null			stop position: &lt;br/&gt;
null			qualifiers:&lt;br/&gt;
Column&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; Id: 2&lt;br/&gt;
Operator: &amp;lt;&lt;br/&gt;
Ordered nulls: false&lt;br/&gt;
Unknown return value: true&lt;br/&gt;
Negate comparison result: true&lt;br/&gt;
Column&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; Id: 2&lt;br/&gt;
Operator: &amp;lt;&lt;br/&gt;
Order&amp;amp;&lt;/p&gt;</comment>
                            <comment id="12496072" author="knutanders" created="Tue, 15 May 2007 19:11:28 +0100"  >&lt;p&gt;The last part of the query plan (truncated in the output above because the test sets maximumdisplaywidth too low) looks like this:&lt;/p&gt;

&lt;p&gt;qualifiers:&lt;br/&gt;
Column&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; Id: 2&lt;br/&gt;
Operator: &amp;lt;&lt;br/&gt;
Ordered nulls: false&lt;br/&gt;
Unknown return value: true&lt;br/&gt;
Negate comparison result: true&lt;br/&gt;
Column&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; Id: 2&lt;br/&gt;
Operator: &amp;lt;&lt;br/&gt;
Ordered nulls: false&lt;br/&gt;
Unknown return value: false&lt;br/&gt;
Negate comparison result: false&lt;/p&gt;

&lt;p&gt;I assume this means that the scan has two qualifiers &amp;gt;= (that is, &amp;lt; negated) and &amp;lt;. Is this what identifies the query plan as optimized for like?&lt;/p&gt;</comment>
                            <comment id="12496091" author="army" created="Tue, 15 May 2007 20:04:32 +0100"  >&lt;p&gt;I think the optimization in question here is described:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://db.apache.org/derby/docs/dev/tuning/rtuntransform472.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.apache.org/derby/docs/dev/tuning/rtuntransform472.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In particular, note the following line:&lt;/p&gt;

&lt;p&gt;  &quot;In this situation, the LIKE predicate is likewise transformed into three predicates: one LIKE predicate,&lt;br/&gt;
  one predicate using the &amp;gt;= operator, and one predicate using the &amp;lt; operator.&quot;&lt;/p&gt;

&lt;p&gt;This correlates to what you have noted about the qualifiers, so my guess is that Yes, this is what demonstrates the &quot;dynamic like optimization&quot;.&lt;/p&gt;</comment>
                            <comment id="12496200" author="knutanders" created="Wed, 16 May 2007 07:03:34 +0100"  >&lt;p&gt;Thanks Army! I&apos;ll add an isDynamicLikeOptimized() method to the RuntimeStatisticsParser class and try to convert the test to JUnit.&lt;/p&gt;</comment>
                            <comment id="12496879" author="knutanders" created="Fri, 18 May 2007 14:57:51 +0100"  >&lt;p&gt;Attaching the first version of DynamicLikeOptimizationTest. It covers most of what dynamicLikeOptimization.sql tests, except that it&apos;s still missing a couple of queries which cast the pattern or escape character to VARCHAR, and it doesn&apos;t check the query plans. I will add tests for that later.&lt;/p&gt;

&lt;p&gt;DynamicLikeOptimizationTest runs in both embedded mode and client/server mode (the old test only runs in embedded).&lt;/p&gt;</comment>
                            <comment id="12497150" author="knutanders" created="Sat, 19 May 2007 13:55:12 +0100"  >&lt;p&gt;Committed revision 539744.&lt;/p&gt;</comment>
                            <comment id="12497863" author="knutanders" created="Tue, 22 May 2007 14:16:47 +0100"  >&lt;p&gt;Attaching patch which adds a test which casts the pattern or escape character, and a test which checks the query plan. The patch also removes the old test.&lt;/p&gt;</comment>
                            <comment id="12498127" author="knutanders" created="Wed, 23 May 2007 07:35:08 +0100"  >&lt;p&gt;Committed revision 540856.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12357631" name="derby-2642-1.diff" size="21085" author="knutanders" created="Fri, 18 May 2007 14:57:51 +0100"/>
                            <attachment id="12357632" name="derby-2642-1.stat" size="183" author="knutanders" created="Fri, 18 May 2007 14:57:51 +0100"/>
                            <attachment id="12357881" name="derby-2642-2.diff" size="64440" author="knutanders" created="Tue, 22 May 2007 14:16:47 +0100"/>
                            <attachment id="12357882" name="derby-2642-2.stat" size="671" author="knutanders" created="Tue, 22 May 2007 14:16:47 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 15 May 2007 19:04:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30552</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy11pb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39926</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>