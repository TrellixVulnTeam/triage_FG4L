<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:34:18 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2573/DERBY-2573.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2573] Create master ant target for generating all release artifacts, including code and doc artifacts</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2573</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;This is one of the tasks tracked by master JIRA &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2571&quot; title=&quot;Create master scripts or ant targets for creating release branches, building all release artifacts, and publishing those artifacts to the Apache mirrors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2571&quot;&gt;DERBY-2571&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12367688">DERBY-2573</key>
            <summary>Create master ant target for generating all release artifacts, including code and doc artifacts</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                            <label>releasegeneration</label>
                    </labels>
                <created>Fri, 20 Apr 2007 16:39:07 +0100</created>
                <updated>Fri, 10 Jan 2014 19:51:25 +0000</updated>
                            <resolved>Fri, 14 Jun 2013 17:56:41 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Build tools</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12515834" author="myrna" created="Thu, 26 Jul 2007 20:10:25 +0100"  >&lt;p&gt;This target should include the following steps:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;check setting of ant property docs.out (from tools/ant/properties/packaging.properties that should have been created based on tools/ant/properties/packaging.tmpl)&lt;/li&gt;
	&lt;li&gt;check presence of $docs.out/../lib/DITA-OT1.1.2.1_bin-ASL.zip&lt;/li&gt;
	&lt;li&gt;check presence of java/tools/osgi.jar&lt;/li&gt;
	&lt;li&gt;check presence of ant property junit&lt;/li&gt;
	&lt;li&gt;check presence of junit.jar as set by ant property junit&lt;/li&gt;
	&lt;li&gt;check ant property setting of j14lib&lt;/li&gt;
	&lt;li&gt;check ant property setting of jdk16&lt;/li&gt;
	&lt;li&gt;check ant property setting of jsr169compile.classpath&lt;/li&gt;
	&lt;li&gt;check that version number in files referenced in tools/release/build.xml for updating the masters, matches the expected version based on tools/ant/properties/release.properties&lt;/li&gt;
	&lt;li&gt;check that $docs.out/../src/conrefs.dita has settings matching tools/ant/properties/release.properties for:&lt;/li&gt;
	&lt;li&gt;ph id=&quot;productinstallname&quot;&lt;/li&gt;
	&lt;li&gt;ph id=&quot;fullversionnumber&quot;&lt;/li&gt;
	&lt;li&gt;ph id=&quot;shortversionnumber&quot;&lt;/li&gt;
	&lt;li&gt;check that $docs.out/../src/*/*copyright.dita have the current year&lt;/li&gt;
	&lt;li&gt;ensure ant property sane is &lt;b&gt;not&lt;/b&gt; set (likely from &quot;$HOME&quot;/ant.properties)&lt;/li&gt;
	&lt;li&gt;ant all&lt;/li&gt;
	&lt;li&gt;copy classes/doc/rrefexcept71493.dita to docs.out/../src/ref&lt;/li&gt;
	&lt;li&gt;ant all for the doc tree&lt;/li&gt;
	&lt;li&gt;ant clobber for source tree&lt;/li&gt;
	&lt;li&gt;svn update&lt;/li&gt;
	&lt;li&gt;ant clobber&lt;/li&gt;
	&lt;li&gt;rm -rf jars javadoc snapshot  # really clean&lt;/li&gt;
	&lt;li&gt;rm tools/release/&lt;b&gt;.zip tools/release/&lt;/b&gt;.tar.gz  # really,&lt;/li&gt;
	&lt;li&gt;rm tools/release/&lt;b&gt;.md5 tools/release/&lt;/b&gt;.asc     # really clean&lt;/li&gt;
	&lt;li&gt;ant sane ; ant all ; ant buildjars   # for lib-debug&lt;/li&gt;
	&lt;li&gt;ant clobber&lt;/li&gt;
	&lt;li&gt;ant insane&lt;/li&gt;
	&lt;li&gt;ant -Dsane=false snapshot&lt;/li&gt;
	&lt;li&gt;ant publishedapi&lt;/li&gt;
	&lt;li&gt;ant  release target in tools/release/build.xml&lt;/li&gt;
	&lt;li&gt;copy snapshot/derby_core_plugin_&amp;lt;major.minor.maint.revision&amp;gt;.zip to tools/release&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Any of these staps failing should stop the process.&lt;/p&gt;

&lt;p&gt;As there may be trouble with ant sign I think that step may need to be manual.&lt;/p&gt;
</comment>
                            <comment id="12749546" author="myrna" created="Mon, 31 Aug 2009 18:21:06 +0100"  >&lt;p&gt;I&apos;m attaching a first step for this.&lt;br/&gt;
Some of the things I outlined in my comment are actually checked on already by the existing build steps, so may not be necessary...&lt;/p&gt;

&lt;p&gt;I made a target - prepareforrelease - which will do all the little ant steps to prepare for the actual build step; incl clobbering and deleting stuff; checking for sane property set, checking for state.properties existing, checking that tools/ant/packaging.properties exist, ant sane, ant all, ant buildjars, ant clobber, ant insane, ant -Dsane snapshot, ant publishedapi&lt;br/&gt;
That part works well enough and I think it&apos;s worth committing.&lt;/p&gt;

&lt;p&gt;It&apos;s not dealing with copying the built error list for the reference guide (not sure that&apos;s even possible, as we&apos;d have to do an svn commit?) nor with attempting to build the docs, nor any of the other tasks explicitly.&lt;/p&gt;

&lt;p&gt;I played with a second target (in the current patch) that&apos;s &lt;b&gt;not&lt;/b&gt; ready for commit: &apos;release&apos;. I tried to make an antcall to the &apos;release&apos; target in tools/release/build.xml, but so far I haven&apos;t been able to make it work.&lt;br/&gt;
So that one&apos;s not ready for commit.&lt;/p&gt;

&lt;p&gt;The trunk and 10.5 build.xml files haven&apos;t diverged much (yet), so I&apos;ve tried this build.xml on a 10.5 environment and it seems to work well.&lt;/p&gt;

&lt;p&gt;I&apos;m interested in feedback on this one.&lt;/p&gt;</comment>
                            <comment id="12750014" author="rhillegas" created="Tue, 1 Sep 2009 18:59:41 +0100"  >&lt;p&gt;Thanks for the patch, Myrna.&lt;/p&gt;

&lt;p&gt;&amp;gt;I made a target - prepareforrelease - which will do all the little ant steps to prepare for the actual build step; incl clobbering and deleting stuff; checking for sane property set, checking for state.properties existing, checking that tools/ant/packaging.properties exist, ant sane, ant all, ant buildjars, ant clobber, ant insane, ant -Dsane snapshot, ant publishedapi&lt;/p&gt;

&lt;p&gt;I took it for a test drive and it worked: it built sane and insane jars which seemed to be the right size. It told me that I needed to remove some directives from my ant.properties--I thought those error messages were helpful.&lt;/p&gt;

&lt;p&gt;&amp;gt;It&apos;s not dealing with copying the built error list for the reference guide (not sure that&apos;s even possible, as we&apos;d have to do an svn commit?) nor with attempting to build the docs, nor any of the other tasks explicitly.&lt;/p&gt;

&lt;p&gt;One thing I noticed is that packaging.properties already has a property which tells the build where the docs live. It should be easy to use that property to figure out where to copy rrefexcept71493.dita and then where to cd to so that the docs can be built. It also ought to be possible to run subversion commands from ant. At least, that&apos;s what&apos;s promised by this web page: &lt;a href=&quot;http://ant.apache.org/antlibs/svn/index.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://ant.apache.org/antlibs/svn/index.html&lt;/a&gt; . No doubt the devil is in the details.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12750056" author="myrna" created="Tue, 1 Sep 2009 20:20:50 +0100"  >&lt;p&gt;I committed the prepareforrelease target to trunk with revision 810178 and backported to 10.5 with revision 810180. (I left out the &apos;release&apos; target, as it wasn&apos;t working).&lt;/p&gt;

&lt;p&gt;I&apos;ll update &lt;a href=&quot;http://wiki.apache.org/db-derby/DerbySnapshotOrRelease&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/db-derby/DerbySnapshotOrRelease&lt;/a&gt; with the option of running this target. &lt;/p&gt;

&lt;p&gt;I don&apos;t plan to do more work on this at this time.&lt;/p&gt;</comment>
                            <comment id="12750060" author="myrna" created="Tue, 1 Sep 2009 20:27:10 +0100"  >&lt;p&gt;I updated the snapshotorrelease wiki. Thanks for the test drive and comments, Rick.&lt;/p&gt;</comment>
                            <comment id="12918627" author="rhillegas" created="Wed, 6 Oct 2010 19:48:05 +0100"  >&lt;p&gt;Attaching derby-2573-01-aa-masterTarget.diff. This patch expands on the work Myrna did. This patch adds a master release target which builds and signs the distributions. I would appreciate it if another release manager could test-drive the master release target to see if it works for someone other than me (see the &quot;How to Run It&quot; section below).&lt;/p&gt;

&lt;p&gt;After the target finishes, release/distributions holds all of the signed artifacts except for the Eclipse ui plugin.&lt;/p&gt;

&lt;p&gt;The remainder of this comment addresses the following topics:&lt;/p&gt;

&lt;p&gt;o What the Target Does&lt;/p&gt;

&lt;p&gt;o How to Run It&lt;/p&gt;

&lt;p&gt;o Future Work&lt;/p&gt;

&lt;p&gt;o Overview of Changes&lt;/p&gt;


&lt;p&gt;-------------- What the Target Does ------------------&lt;/p&gt;

&lt;p&gt;The master build target does the following:&lt;/p&gt;

&lt;p&gt;o Commits the generated SQLState tables to the docs repository.&lt;/p&gt;

&lt;p&gt;o Syncs both the code and doc clients so that they are up to date.&lt;/p&gt;

&lt;p&gt;o Builds sane and insane jars.&lt;/p&gt;

&lt;p&gt;o Builds the public javadoc and the Eclipse core plugin.&lt;/p&gt;

&lt;p&gt;o Builds the user docs.&lt;/p&gt;

&lt;p&gt;o Builds and signs the distributions.&lt;/p&gt;


&lt;p&gt;-------------- How to Run It ------------------&lt;/p&gt;

&lt;p&gt;The master build target can be invoked by a bash script, buildrelease. This script does two jobs for you:&lt;/p&gt;

&lt;p&gt;1) Sets the CLASSPATH needed to run the docs build&lt;/p&gt;

&lt;p&gt;2) Asks you for security credentials&lt;/p&gt;

&lt;p&gt;The very last line of the script is the actual ant command which invokes the master build target. If you don&apos;t use bash scripts, you can at least consult buildrelease for how to set up your ant command.&lt;/p&gt;

&lt;p&gt;The buildrelease script expects that you have set the DOCS_ROOT environment variable to point at the top directory of your docs client. If you have not done so, the script fails. The script prompts you for your Apache subversion credentials and for your pgp passphrase. Then the script invokes the master build target. So, to build a release, do the following:&lt;/p&gt;

&lt;p&gt;export DOCS_ROOT=someplaceInYourFileSystem&lt;br/&gt;
cd topDirectoryOfYourCodeClient&lt;br/&gt;
./buildrelease&lt;/p&gt;

&lt;p&gt;...and answer the questions which buildrelease asks.&lt;/p&gt;


&lt;p&gt;Again, if you don&apos;t use bash, you can invoke ant directly. Make sure that you have set CLASSPATH to include the libraries needed by the docs build. The actual ant command for invoking the master build target is this:&lt;/p&gt;

&lt;p&gt;ant &quot;-Ddocs.root=$DOCS_ROOT&quot; &quot;-Dpgp.passphrase=$pgpPassphrase&quot; &quot;-Dsvn.username=$subversionUserName&quot; &quot;-Dsvn.password=$subversionPassword&quot; -quiet release&lt;/p&gt;


&lt;p&gt;-------------- Future Work ------------------&lt;/p&gt;

&lt;p&gt;Follow-on patches can add more functionality:&lt;/p&gt;

&lt;p&gt;i) Fail the build if the docs and/or code clients have uncommitted work in them.&lt;/p&gt;

&lt;p&gt;ii) Prompt for a release string and then update and checkin tools/ant/properties/release.properties accordingly.&lt;/p&gt;


&lt;p&gt;-------------- Overview of Changes ------------------&lt;/p&gt;

&lt;p&gt;1) Replaced the docs.out variable with docs.root. The former pointed at the output of the docs build while the latter points at the root of the whole docs client. The docs.root variable allows more straightforward references to docs files.&lt;/p&gt;

&lt;p&gt;2) Made prepareforrelease check that docs.root has been set to something reasonable.&lt;/p&gt;

&lt;p&gt;3) Made prepareforrelease check that your subversion username and password have been specified. These are the subversion credentials which you use to commit work to the Apache repositories. They are used to checkin the generated SQLState tables in your docs client.&lt;/p&gt;

&lt;p&gt;4) Made prepareforrelease check that your pgp passphrase has been specified. The passphrase is needed in order to sign the distributions.&lt;/p&gt;

&lt;p&gt;5) Synced both the code and docs clients so that they are up to date.&lt;/p&gt;

&lt;p&gt;6) Fixed some problems in the setting of the sanity state.&lt;/p&gt;

&lt;p&gt;7) Added a master release target which creates and signs the distributions.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/loc/build.xml&lt;br/&gt;
M      build.xml&lt;br/&gt;
M      tools/release/build.xml&lt;br/&gt;
M      tools/ant/properties/packaging.tmpl&lt;br/&gt;
M      tools/ant/properties/dirs.properties&lt;br/&gt;
A      buildrelease&lt;/p&gt;</comment>
                            <comment id="12919041" author="rhillegas" created="Thu, 7 Oct 2010 20:51:15 +0100"  >&lt;p&gt;Attaching derby-2573-02-aa-generateReleaseProperties.diff. This patch introduces a new build target which generates release.properties based on a release identifier property. Checked in at subversion revision 1005590.&lt;/p&gt;

&lt;p&gt;A later patch will wire this machinery into the master release target after the derby-2573-01-aa-masterTarget.diff patch is committed.&lt;/p&gt;

&lt;p&gt;To run this target, do the following:&lt;/p&gt;

&lt;p&gt;    ant -Dderby.release.id=&quot;$releaseID&quot; writeReleaseProperties&lt;/p&gt;

&lt;p&gt;    where $releaseID is a string of the form &quot;N.N.N.N&quot; or &quot;N.N.N.N beta&quot;.&lt;/p&gt;

&lt;p&gt;    E.g.:&lt;/p&gt;

&lt;p&gt;    ant -Dderby.release.id=&quot;10.7.1.0&quot; writeReleaseProperties&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;A      java/build/org/apache/derbyPreBuild/ReleaseProperties.java&lt;/p&gt;

&lt;p&gt;New ant task.&lt;/p&gt;


&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/iapi/services/info/ProductVersionHolder.java&lt;/p&gt;

&lt;p&gt;Moved to ReleaseProperties the constant used to encode the fixpack and point numbers in the release id.&lt;/p&gt;


&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;

&lt;p&gt;Added a writeReleaseProperties target to drive the new ant task.&lt;/p&gt;


&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      tools/ant/properties/release.properties&lt;/p&gt;

&lt;p&gt;Removed a timestamp line which has not been kept up to date.&lt;/p&gt;</comment>
                            <comment id="12919276" author="rhillegas" created="Fri, 8 Oct 2010 14:36:44 +0100"  >&lt;p&gt;Committed derby-2573-01-aa-masterTarget.diff at subversion revision 1005815. I will continue to improve this for a while.&lt;/p&gt;</comment>
                            <comment id="12919332" author="rhillegas" created="Fri, 8 Oct 2010 18:45:47 +0100"  >&lt;p&gt;Attaching derby-2573-03-aa-propertyPrompt.diff. This patch adds a new ant task, which prompts the user for properties if they haven&apos;t been set already. This target lets us move the prompts out of the buildrelease shell script into the ant script, making the release process more portable. Committed at subversion revision 1005922.&lt;/p&gt;

&lt;p&gt;Now invoking the master build target is even simpler:&lt;/p&gt;

&lt;p&gt;   ant &quot;-Ddocs.root=$DOCS_ROOT&quot; -quiet release&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;A      java/build/org/apache/derbyPreBuild/PropertyPrompt.java&lt;/p&gt;

&lt;p&gt;New ant Task which prompts the user for a property value if the property is not set already.&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;

&lt;p&gt;The master release target now prompts for credentials if they weren&apos;t specified on the command line.&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      buildrelease&lt;/p&gt;

&lt;p&gt;The driving bash shell script is simpler now since it no longer needs to prompts for credentials.&lt;/p&gt;</comment>
                            <comment id="12919334" author="rhillegas" created="Fri, 8 Oct 2010 18:46:58 +0100"  >&lt;p&gt;Reset the &quot;Patch Available&quot; flag because all of the patches have been committed so far. The changes can be test-driven from the trunk now.&lt;/p&gt;</comment>
                            <comment id="12919354" author="rhillegas" created="Fri, 8 Oct 2010 20:20:35 +0100"  >&lt;p&gt;Attaching derby-2573-04-aa-emptyClient.diff. This patch adds a check to the master release build: the docs and code clients must have no in-flight edits. Committed at subversion revision 1005976.&lt;/p&gt;

&lt;p&gt;Once this patch is checked in, it becomes hard to improve the master release target because any edits to build.xml will cause the release build to fail. To get around this problem, I added a new property:&lt;/p&gt;

&lt;p&gt;  debug.release.build&lt;/p&gt;

&lt;p&gt;When this property is set to true, the release build goes ahead even though there are in-flight edits.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;</comment>
                            <comment id="12919770" author="knutanders" created="Mon, 11 Oct 2010 10:53:57 +0100"  >&lt;p&gt;The renaming of docs.out to docs.root stopped the cron job that builds the binaries for the nightly tests. It should be up and running again tomorrow, I hope.&lt;/p&gt;</comment>
                            <comment id="12919876" author="rhillegas" created="Mon, 11 Oct 2010 16:49:03 +0100"  >&lt;p&gt;Attaching derby-2573-05-aa-updateReleaseProperties.diff. This patch automates some of the drudgery involving release ids. Committed at subversion revision 1021394.&lt;/p&gt;

&lt;p&gt;My apologies to Knut, who has been fixing the nightly builds as my changes break them. Hopefully this change only affects code paths untrod by the nightly builds.&lt;/p&gt;

&lt;p&gt;Now the release builder does the following:&lt;/p&gt;

&lt;p&gt;1) Prompts you for the release id at the beginning.&lt;/p&gt;

&lt;p&gt;2) Generates release.properties accordingly and checks it in. This step happens before building the distributions.&lt;/p&gt;

&lt;p&gt;3) At the very end, bumps the last digit of the release id on the branch, regenerating release.properties and checking that file in again. This step happens after building the distributions.&lt;/p&gt;

&lt;p&gt;In addition, the standalone writeReleaseProperties target is now more capable. You can use it by itself to adjust the release id on the branch just after creating the branch. You can also use it to adjust the release id on the development trunk after creating a branch.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      java/build/org/apache/derbyPreBuild/ReleaseProperties.java&lt;/p&gt;

&lt;p&gt;Gives this ant Task a new argument, which determines whether the last digit of the release id should be incremented before writing release.properties.&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;

&lt;p&gt;Some refactoring so that we can call the more capable writeReleaseProperties target.&lt;/p&gt;</comment>
                            <comment id="12919952" author="rhillegas" created="Mon, 11 Oct 2010 20:17:06 +0100"  >&lt;p&gt;Attaching derby-2573-06-ab-docsClasspath.diff. This changes the way that the docs build is invoked. With this patch, the docs build is run inside another process. This lets us adjust the classpath for ant, based on $&lt;/p&gt;
{docs.root}
&lt;p&gt;. And this lets us boost the memory which we need to give the docs-building process. These changes, in turn, eliminate the need for a platform-specific buildrelease script. Committed at subversion revision 1021472.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;

&lt;p&gt;Prompt for docs.root if it isn&apos;t set. Then run the docs build with appropriate CLASSPATH and memory settings.&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;D      buildrelease&lt;/p&gt;

&lt;p&gt;This script is no longer needed.&lt;/p&gt;</comment>
                            <comment id="12920229" author="rhillegas" created="Tue, 12 Oct 2010 16:11:02 +0100"  >&lt;p&gt;Attaching derby-2573-07-aa-createBranch.diff. This adds some targets to support branch creation as the first step toward generating a feature release. Committed at subversion revision 1021793.&lt;/p&gt;

&lt;p&gt;This patch introduces a new top-level target: createBranch. You must specify your docs root in order to invoke this target. So you would do something like the following:&lt;/p&gt;

&lt;p&gt;  export DOCS_ROOT=$HOME/derby/docs/$BRANCH&lt;br/&gt;
  cd $HOME/derby/$SANDBOX/$BRANCH&lt;br/&gt;
  ant &quot;-Ddocs.root=$DOCS_ROOT&quot; -quiet createBranch&lt;/p&gt;

&lt;p&gt;I have test-driven the parts of this target which determine the branch and starting subversion revision. I have not tested the actual branch creation. Will do that when it&apos;s time to create the 10.7 branch.&lt;/p&gt;


&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;</comment>
                            <comment id="12922133" author="rhillegas" created="Mon, 18 Oct 2010 17:30:47 +0100"  >&lt;p&gt;Attaching derby-2573-08-aa-useReleaseVariablesInDocsBuild.diff. This patch improves the release-build so that it builds the docs using current release variables. Committed at subversion revision 1023889.&lt;/p&gt;

&lt;p&gt;This patch takes advantage of the work done by &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4851&quot; title=&quot;Parameterize documentation sources so that release-time variables (like copyright year and release id) can be plugged in when we build a release&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4851&quot;&gt;&lt;del&gt;DERBY-4851&lt;/del&gt;&lt;/a&gt; to parameterize the docs build. This patch passes the following variables to the docs build:&lt;/p&gt;

&lt;p&gt;copyright year&lt;br/&gt;
long release id (e.g., 10.7.1.0)&lt;br/&gt;
short release id (e.g. 10.7)&lt;br/&gt;
subversion revision stamp&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;----------&lt;/p&gt;

&lt;p&gt;M      java/build/org/apache/derbyPreBuild/ReleaseProperties.java&lt;/p&gt;

&lt;p&gt;Writes some extra properties to release.properties so that the values can be picked up by the release-build and passed to the docs builder.&lt;/p&gt;

&lt;p&gt;----------&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;

&lt;p&gt;Passes release properties to docs build as part of building release distributions.&lt;/p&gt;</comment>
                            <comment id="12922211" author="rhillegas" created="Mon, 18 Oct 2010 19:52:37 +0100"  >&lt;p&gt;Attaching derby-2573-09-aa-copySQLStateTableEarlier.diff. This moves the checkin of the SQLState documentation to an earlier point in the release-build. All of the checkins needed for the release should be finished before we sync the clients to bring them up-to-date. Committed at subversion revision 1023943.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;</comment>
                            <comment id="12922236" author="rhillegas" created="Mon, 18 Oct 2010 21:26:45 +0100"  >&lt;p&gt;Attaching derby-2573-10-aa-notice.diff. This patch makes the release-build update the NOTICE file with the current copyright year and then check it in. Committed at subversion revision 1023985.&lt;/p&gt;

&lt;p&gt;This patch makes the following changes:&lt;/p&gt;

&lt;p&gt;1) Splits the NOTICE file up into a number of separate files, one for each software grant.&lt;/p&gt;

&lt;p&gt;2) Parameterizes the ending copyright date on the preamble notice.&lt;/p&gt;

&lt;p&gt;3) Makes the release-build concatenate all of these files and substitute the copyright token with the current year.&lt;/p&gt;

&lt;p&gt;The preamble warns the user that NOTICE shouldn&apos;t be edited directly anymore. Instead, the preamble points the reader at the buildnotice target, which shows how the NOTICE file is built.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;--------&lt;/p&gt;

&lt;p&gt;A      tools/release/notices&lt;br/&gt;
A      tools/release/notices/jdbcstubs.txt&lt;br/&gt;
A      tools/release/notices/xalan.txt&lt;br/&gt;
A      tools/release/notices/initialgrant.txt&lt;br/&gt;
A      tools/release/notices/felix.txt&lt;br/&gt;
A      tools/release/notices/preamble.txt&lt;br/&gt;
A      tools/release/notices/nisttestgrant.txt&lt;br/&gt;
A      tools/release/notices/separator.txt&lt;/p&gt;

&lt;p&gt;New notice files, one for each grant.&lt;/p&gt;


&lt;p&gt;--------&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;br/&gt;
M      tools/ant/properties/dirs.properties&lt;/p&gt;

&lt;p&gt;Machinery to generate the NOTICE file when the release is built.&lt;/p&gt;</comment>
                            <comment id="12932099" author="rhillegas" created="Mon, 15 Nov 2010 16:04:46 +0000"  >&lt;p&gt;Attaching derby-2573-11-aa-signDebugArtifacts.diff. This adds a target for signing the debug artifacts. Committed at subversion revision 1035327.&lt;/p&gt;



&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M      tools/release/build.xml&lt;/p&gt;</comment>
                            <comment id="12932101" author="rhillegas" created="Mon, 15 Nov 2010 16:08:06 +0000"  >&lt;p&gt;Ported 1035327 from trunk to 10.7 branch at revision 1035332.&lt;/p&gt;</comment>
                            <comment id="12932482" author="rhillegas" created="Tue, 16 Nov 2010 14:50:40 +0000"  >&lt;p&gt;Attaching derby-2573-12-aa-eclipse_ui_doc_plugin.diff. This patch adds a variable for specifying the location of the eclipse ui/doc plugin and signs that artifact along with the others. Committed at subversion revision 1035647.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;


&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      tools/ant/properties/dirs.properties&lt;/p&gt;

&lt;p&gt;Added a constant for the plugin&apos;s name.&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;

&lt;p&gt;Prompt for the plugin&apos;s location if it was not specified on the command line or in ant.properties. Copy it to the directory where the other release artifacts live. While I was in there, I cleaned up the checkin target: now it is a nop if debug.release.build is set.&lt;/p&gt;

&lt;p&gt;-----------&lt;/p&gt;

&lt;p&gt;M      tools/release/build.xml&lt;/p&gt;

&lt;p&gt;Sign the eclipse ui/doc plugin along with the core eclipse plugin.&lt;/p&gt;</comment>
                            <comment id="12932485" author="rhillegas" created="Tue, 16 Nov 2010 14:56:23 +0000"  >&lt;p&gt;Backported 1035647 from trunk to 10.7 branch at subversion revision 1035648.&lt;/p&gt;</comment>
                            <comment id="13012591" author="rhillegas" created="Tue, 29 Mar 2011 19:11:20 +0100"  >&lt;p&gt;Attaching derby-2573-13-aa-writePropertiesTarget.diff. This patch creates a separate target for writing the release properties. Committed at subversion revision 1086660.&lt;/p&gt;

&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;p&gt;M      build.xml&lt;/p&gt;</comment>
                            <comment id="13274633" author="rhillegas" created="Mon, 14 May 2012 15:55:02 +0100"  >&lt;p&gt;Although many improvements in this area are still possible, I think this issue can be closed down. I don&apos;t intend to do any more work on this one.&lt;/p&gt;</comment>
                            <comment id="13868131" author="rhillegas" created="Fri, 10 Jan 2014 18:56:42 +0000"  >&lt;p&gt;Attaching derby-2573-14-aa-useAntExec.diff. It looks as though the builduserdocs target in the 10.8 branch was changed to use ant.bat instead of ant.exec. That probably makes the target work on Windows, but it breaks the build on my Mac. I am reverting the target to use ant.exec again so that I can build a release. We need to wrap some portability code around this difference so that we can build Derby releases on both platforms.&lt;/p&gt;</comment>
                            <comment id="13868132" author="jira-bot" created="Fri, 10 Jan 2014 18:58:07 +0000"  >&lt;p&gt;Commit 1557223 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhillegas&quot; class=&quot;user-hover&quot; rel=&quot;rhillegas&quot;&gt;Rick Hillegas&lt;/a&gt; in branch &apos;code/branches/10.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1557223&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1557223&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2573&quot; title=&quot;Create master ant target for generating all release artifacts, including code and doc artifacts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2573&quot;&gt;&lt;del&gt;DERBY-2573&lt;/del&gt;&lt;/a&gt;: Make 10.8 version of builduserdocs target use ant.exec rather than ant.bat; commit derby-2573-14-aa-useAntExec.diff.&lt;/p&gt;</comment>
                            <comment id="13868159" author="rhillegas" created="Fri, 10 Jan 2014 19:19:01 +0000"  >&lt;p&gt;Attaching derby-2573-15-aa-useAntExec2.diff, a second attempt to fix this problem. Replaced ant.exec with $&lt;/p&gt;
{ant.exec}
&lt;p&gt;.&lt;/p&gt;</comment>
                            <comment id="13868164" author="jira-bot" created="Fri, 10 Jan 2014 19:20:38 +0000"  >&lt;p&gt;Commit 1557228 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhillegas&quot; class=&quot;user-hover&quot; rel=&quot;rhillegas&quot;&gt;Rick Hillegas&lt;/a&gt; in branch &apos;code/branches/10.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1557228&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1557228&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2573&quot; title=&quot;Create master ant target for generating all release artifacts, including code and doc artifacts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2573&quot;&gt;&lt;del&gt;DERBY-2573&lt;/del&gt;&lt;/a&gt;: 2nd attempt to fix release scripts on 10.8; committing derby-2573-15-aa-useAntExec2.diff.&lt;/p&gt;</comment>
                            <comment id="13868187" author="rhillegas" created="Fri, 10 Jan 2014 19:34:39 +0000"  >&lt;p&gt;Attaching derby-2573-16-aa-useAntExec3.diff, a third attempt to fix this problem. This version copies more logic from the 10.10 version of build.xml. Hopefully that gets us closer to having a platform-portable approach to this problem.&lt;/p&gt;</comment>
                            <comment id="13868193" author="jira-bot" created="Fri, 10 Jan 2014 19:37:06 +0000"  >&lt;p&gt;Commit 1557234 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhillegas&quot; class=&quot;user-hover&quot; rel=&quot;rhillegas&quot;&gt;Rick Hillegas&lt;/a&gt; in branch &apos;code/branches/10.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1557234&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1557234&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2573&quot; title=&quot;Create master ant target for generating all release artifacts, including code and doc artifacts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2573&quot;&gt;&lt;del&gt;DERBY-2573&lt;/del&gt;&lt;/a&gt;: Incorporate more logic from the 10.10 build script to fix problem with running builduserdocs target on non-windows systems; checkin  derby-2573-16-aa-useAntExec3.diff.&lt;/p&gt;</comment>
                            <comment id="13868210" author="rhillegas" created="Fri, 10 Jan 2014 19:50:11 +0000"  >&lt;p&gt;Fourth attempt: derby-2573-17-aa-useAntExec4.diff. Copied more logic from the 10.10 version. Oh, I&apos;m really getting close now.&lt;/p&gt;</comment>
                            <comment id="13868212" author="jira-bot" created="Fri, 10 Jan 2014 19:51:25 +0000"  >&lt;p&gt;Commit 1557235 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhillegas&quot; class=&quot;user-hover&quot; rel=&quot;rhillegas&quot;&gt;Rick Hillegas&lt;/a&gt; in branch &apos;code/branches/10.8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1557235&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1557235&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2573&quot; title=&quot;Create master ant target for generating all release artifacts, including code and doc artifacts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2573&quot;&gt;&lt;del&gt;DERBY-2573&lt;/del&gt;&lt;/a&gt;: Add more logic from 10.10 build script to fix broken builduserdocs target in 10.8; commit derby-2573-17-aa-useAntExec4.diff.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12367686">DERBY-2571</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12368778">DERBY-2619</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12475541">DERBY-4826</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12418164" name="DERBY-2573.diff_1notforcommit" size="4427" author="myrna" created="Mon, 31 Aug 2009 18:21:06 +0100"/>
                            <attachment id="12456528" name="derby-2573-01-aa-masterTarget.diff" size="20808" author="rhillegas" created="Wed, 6 Oct 2010 19:48:05 +0100"/>
                            <attachment id="12456627" name="derby-2573-02-aa-generateReleaseProperties.diff" size="11583" author="rhillegas" created="Thu, 7 Oct 2010 20:51:15 +0100"/>
                            <attachment id="12456717" name="derby-2573-03-aa-propertyPrompt.diff" size="9683" author="rhillegas" created="Fri, 8 Oct 2010 18:45:47 +0100"/>
                            <attachment id="12456718" name="derby-2573-04-aa-emptyClient.diff" size="2142" author="rhillegas" created="Fri, 8 Oct 2010 20:20:35 +0100"/>
                            <attachment id="12456867" name="derby-2573-05-aa-updateReleaseProperties.diff" size="9901" author="rhillegas" created="Mon, 11 Oct 2010 16:49:03 +0100"/>
                            <attachment id="12456882" name="derby-2573-06-ab-docsClasspath.diff" size="4264" author="rhillegas" created="Mon, 11 Oct 2010 20:17:06 +0100"/>
                            <attachment id="12456971" name="derby-2573-07-aa-createBranch.diff" size="4094" author="rhillegas" created="Tue, 12 Oct 2010 16:11:02 +0100"/>
                            <attachment id="12457458" name="derby-2573-08-aa-useReleaseVariablesInDocsBuild.diff" size="4414" author="rhillegas" created="Mon, 18 Oct 2010 17:30:47 +0100"/>
                            <attachment id="12457469" name="derby-2573-09-aa-copySQLStateTableEarlier.diff" size="1777" author="rhillegas" created="Mon, 18 Oct 2010 19:52:37 +0100"/>
                            <attachment id="12457474" name="derby-2573-10-aa-notice.diff" size="12540" author="rhillegas" created="Mon, 18 Oct 2010 21:26:45 +0100"/>
                            <attachment id="12459621" name="derby-2573-11-aa-signDebugArtifacts.diff" size="1275" author="rhillegas" created="Mon, 15 Nov 2010 16:04:46 +0000"/>
                            <attachment id="12459702" name="derby-2573-12-aa-eclipse_ui_doc_plugin.diff" size="3652" author="rhillegas" created="Tue, 16 Nov 2010 14:50:40 +0000"/>
                            <attachment id="12474907" name="derby-2573-13-aa-writePropertiesTarget.diff" size="2887" author="rhillegas" created="Tue, 29 Mar 2011 19:11:20 +0100"/>
                            <attachment id="12622416" name="derby-2573-14-aa-useAntExec.diff" size="493" author="rhillegas" created="Fri, 10 Jan 2014 18:56:42 +0000"/>
                            <attachment id="12622420" name="derby-2573-15-aa-useAntExec2.diff" size="497" author="rhillegas" created="Fri, 10 Jan 2014 19:19:01 +0000"/>
                            <attachment id="12622427" name="derby-2573-16-aa-useAntExec3.diff" size="831" author="rhillegas" created="Fri, 10 Jan 2014 19:34:39 +0000"/>
                            <attachment id="12622430" name="derby-2573-17-aa-useAntExec4.diff" size="518" author="rhillegas" created="Fri, 10 Jan 2014 19:50:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 26 Jul 2007 19:10:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30523</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0btz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35735</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>