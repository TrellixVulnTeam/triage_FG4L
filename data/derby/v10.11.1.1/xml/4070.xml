<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:45:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4070/DERBY-4070.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4070] Embedded and client data sources throw different exception when a connection attribute is badly formatted</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4070</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If a connection attribute is badly formatted, for instance if the attribute name is specified without a corresponding value, the embedded and the client data sources throw different exceptions:&lt;br/&gt;
  o XJ212: Invalid attribute syntax: bad&lt;br/&gt;
  o XJ028: The URL &apos;jdbc:derby://localhost:1527/wombat;bad&apos; is not properly formed.&lt;/p&gt;

&lt;p&gt;Currently the only client data source affected is ClientDataSource, but the connection pool and XA data sources also have to deal with this issue when &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4067&quot; title=&quot;ClientConnectionPoolDataSource.getPooledConnection and ClientXADataSource.getXAConnection ignore connection attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4067&quot;&gt;&lt;del&gt;DERBY-4067&lt;/del&gt;&lt;/a&gt; has been fixed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12415560">DERBY-4070</key>
            <summary>Embedded and client data sources throw different exception when a connection attribute is badly formatted</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12415362">DERBY-4067</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="kristwaa">Kristian Waagan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Feb 2009 10:15:44 +0000</created>
                <updated>Tue, 13 Jul 2010 12:12:37 +0100</updated>
                            <resolved>Mon, 28 Jun 2010 14:32:51 +0100</resolved>
                                    <version>10.4.2.1</version>
                    <version>10.5.3.0</version>
                    <version>10.6.1.0</version>
                                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>JDBC</component>
                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12676657" author="kristwaa" created="Wed, 25 Feb 2009 14:25:24 +0000"  >&lt;p&gt;Patch 1a makes ClientDataSource behavior consistent with the embedded data source when a connection attribute is badly formatted. Both should now throw XJ028.&lt;/p&gt;

&lt;p&gt;I chose to include the new methods in ClientBaseDataSource, because they will be needed in ClientConnectionPoolDataSource and ClientXADataSource as well.&lt;/p&gt;

&lt;p&gt;Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="12677937" author="kristwaa" created="Mon, 2 Mar 2009 09:24:49 +0000"  >&lt;p&gt;Attached updated patch 1b, which checks if the connection attributes are null. We don&apos;t want to add &quot;&amp;lt;null&amp;gt;&quot; to the URL.&lt;br/&gt;
I&apos;m not sure if  &quot;&amp;lt;protocol&amp;gt;&amp;lt;databasename&amp;gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;;&amp;lt;connectionAttributes&amp;gt;&amp;#93;&lt;/span&gt;&quot; is enough for the URL.&lt;br/&gt;
What about the other properties, like Ssl or securityMechanism, which can be specified both by connectionAttributes and the specific setter methods?&lt;br/&gt;
At the moment the constructed URL is only used for the error message.&lt;/p&gt;

&lt;p&gt;I think the issue connectionAttributes vs setter method is something we should define guidelines for.&lt;br/&gt;
Which takes precedence?&lt;br/&gt;
Should using the connectionAttributes be disallowed for properties that have a setter?&lt;/p&gt;</comment>
                            <comment id="12678012" author="rhillegas" created="Mon, 2 Mar 2009 15:16:07 +0000"  >&lt;p&gt;Hi Kristian,&lt;/p&gt;

&lt;p&gt;The javadoc for ClientBaseDataSource.setConnectionAttributes() says that you should not use this method to set a property which has its own setter method--and if you nevertheless try to do this, the consequences are unpredictable. It&apos;s possible that we actually do one of the following and we could just document what we currently do:&lt;/p&gt;

&lt;p&gt;1) Throw an exception if setConnectionAttributes() is used to set a property which has its own setter method.&lt;/p&gt;

&lt;p&gt;2) Let setConnectionAttributes() always trump the individual setter methods&lt;/p&gt;

&lt;p&gt;3) Vice-versa&lt;/p&gt;

&lt;p&gt;4) Use whatever the MOST RECENT value of the property is, regardless of whether it was set by setConnectionAttributes() or an individual setter method.&lt;/p&gt;

&lt;p&gt;5) Use whatever the FIRST value of the property is, regardless of whether it was set by setConnectionAttributes() or an individual setter method.&lt;/p&gt;

&lt;p&gt;If you obtain your Connection from DriverManager, rather than a DataSource, then the situation is governed by the &quot;Attributes of the Derby database connection URL &quot; section of the Reference Guide. As I interpret that section, the URL attributes are added to the passed in Properties and therefore trump the values in the Properties object.&lt;/p&gt;</comment>
                            <comment id="12680129" author="kristwaa" created="Mon, 9 Mar 2009 11:50:52 +0000"  >&lt;p&gt;Attached patch 1c, which addresses the issue for CPDS and XADS also.&lt;/p&gt;

&lt;p&gt;I plan to commit this patch tomorrow.&lt;/p&gt;</comment>
                            <comment id="12688695" author="kristwaa" created="Tue, 24 Mar 2009 14:24:52 +0000"  >&lt;p&gt;Committed patch 1d to trunk with revision 757811.&lt;br/&gt;
Patch revision d removed some unused imports and a blank line.&lt;/p&gt;</comment>
                            <comment id="12688698" author="kristwaa" created="Tue, 24 Mar 2009 14:28:01 +0000"  >&lt;p&gt;Updated affects version and fix version.&lt;/p&gt;</comment>
                            <comment id="12750436" author="kristwaa" created="Wed, 2 Sep 2009 14:38:36 +0100"  >&lt;p&gt;This patch can be backported to 10.5 (all tests passed), and I&apos;ll check 10.4 too. Are there any objections?&lt;br/&gt;
I guess a release note should be written as well.&lt;/p&gt;</comment>
                            <comment id="12750721" author="dagw" created="Thu, 3 Sep 2009 00:12:31 +0100"  >&lt;p&gt;I notice Rick asked some question regarding this patch, but I can&apos;t see that you answered them, Kristian.. Did you resolve these offline, and if so what was the result?&lt;/p&gt;</comment>
                            <comment id="12865106" author="kristwaa" created="Fri, 7 May 2010 11:25:37 +0100"  >&lt;p&gt;Hi, Dag.&lt;/p&gt;

&lt;p&gt;I don&apos;t think I have answered Rick&apos;s question.&lt;/p&gt;

&lt;p&gt;A quick look at the ClientDataSource indicates that Rick&apos;s option (2) is what we&apos;re doing currently. The attribute string is parsed when getConnection() is invoked. &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4067&quot; title=&quot;ClientConnectionPoolDataSource.getPooledConnection and ClientXADataSource.getXAConnection ignore connection attributes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4067&quot;&gt;&lt;del&gt;DERBY-4067&lt;/del&gt;&lt;/a&gt; tracks the bug where two of the data source implementations fail to parse the attribute string - effectively ignoring them. There was also a problem with SSL, see &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4073&quot; title=&quot;Creation/configuration of ClientXDataSource fails because of two setSsl methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4073&quot;&gt;&lt;del&gt;DERBY-4073&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;My work on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4073&quot; title=&quot;Creation/configuration of ClientXDataSource fails because of two setSsl methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4073&quot;&gt;&lt;del&gt;DERBY-4073&lt;/del&gt;&lt;/a&gt; makes me wonder if option (1) may get us into trouble. Although it may be the most correct solution, I fear that it may cause issues when Derby is used with for instance application servers.&lt;br/&gt;
Maybe the variation (1a) below can be used instead?&lt;/p&gt;

&lt;p&gt; 1a) If a property with its own setter method is set using both the setter and in setConnectionAttributes(), throw an exception.&lt;/p&gt;

&lt;p&gt;The goal of (1a) is to notify users that a property is set in two different ways. It may come as a surprise that one of the values is overridden.&lt;/p&gt;

&lt;p&gt;Since the embedded data source implementations seem to differ from the client ones (wrt connection attributes), I think I&apos;ll write a test to determine the behavior.&lt;/p&gt;</comment>
                            <comment id="12872185" author="kristwaa" created="Thu, 27 May 2010 12:31:27 +0100"  >&lt;p&gt;Patch 2a adds some tests for the data source properties. Not for commit (yet), only for exploration.&lt;/p&gt;

&lt;p&gt;I also sent a message to derby-dev pointing out some of the current issues, asking what we should do about them (thread called &quot;Derby data sources&quot;).&lt;/p&gt;</comment>
                            <comment id="12883144" author="kristwaa" created="Mon, 28 Jun 2010 14:32:51 +0100"  >&lt;p&gt;Backported fix to 10.5 with revision 958572.&lt;/p&gt;

&lt;p&gt;For further discussion of the issues mentioned under this issue, see &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4719&quot; title=&quot;Define consistent Derby data source behavior&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4719&quot;&gt;DERBY-4719&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12400943" name="derby-4070-1a-ds_exception_handling.diff" size="5010" author="kristwaa" created="Wed, 25 Feb 2009 14:25:24 +0000"/>
                            <attachment id="12401225" name="derby-4070-1b-ds_exception_handling.diff" size="5171" author="kristwaa" created="Mon, 2 Mar 2009 09:24:49 +0000"/>
                            <attachment id="12401744" name="derby-4070-1c-ds_exception_handling.diff" size="8473" author="kristwaa" created="Mon, 9 Mar 2009 11:50:52 +0000"/>
                            <attachment id="12403520" name="derby-4070-1d-ds_exception_handling.diff" size="8490" author="kristwaa" created="Tue, 24 Mar 2009 14:24:52 +0000"/>
                            <attachment id="12445642" name="derby-4070-2a-ds_test.diff" size="43485" author="kristwaa" created="Thu, 27 May 2010 12:31:27 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10363"><![CDATA[Embedded/Client difference]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 2 Mar 2009 15:16:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31119</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0plz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37967</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>