<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:36:20 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1262/DERBY-1262.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1262] Like-predicates: % does not match tab character</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1262</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;% in like predicates does not seem to match tab character.  In the following example all whitespace in character literals is the tab character:&lt;/p&gt;


&lt;p&gt;ij&amp;gt; create table t4(i integer primary key, j integer, c varchar(10));&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; insert into t4 values (1, 1, &apos;abc	def&apos;);&lt;br/&gt;
1 row inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; select * from t4 where c like &apos;abc%&apos;;&lt;br/&gt;
I          |J          |C         &lt;br/&gt;
----------------------------------&lt;/p&gt;

&lt;p&gt;0 rows selected&lt;br/&gt;
ij&amp;gt; select * from t4 where c like &apos;abc	%&apos;;&lt;br/&gt;
I          |J          |C         &lt;br/&gt;
----------------------------------&lt;br/&gt;
1          |1          |abc    def   &lt;/p&gt;

&lt;p&gt;1 row selected&lt;/p&gt;</description>
                <environment>Embedded, Solaris 10 x86</environment>
        <key id="12332784">DERBY-1262</key>
            <summary>Like-predicates: % does not match tab character</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hmork">H&#229;vard Mork</assignee>
                                    <reporter username="oysteing">&#216;ystein Gr&#248;vlen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 27 Apr 2006 19:23:20 +0100</created>
                <updated>Wed, 16 May 2007 07:51:01 +0100</updated>
                            <resolved>Thu, 8 Jun 2006 03:07:57 +0100</resolved>
                                    <version>10.0.2.0</version>
                                    <fixVersion>10.1.3.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12377762" author="hmork" created="Thu, 4 May 2006 18:35:55 +0100"  >&lt;p&gt;I believe this is a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-20&quot; title=&quot;LIKE handles strings with control characters incorrectly.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-20&quot;&gt;&lt;del&gt;DERBY-20&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
This behaviour is due to the optimization of LikeEscapeOperatorNode. This node is converted to less-than and greater-than expressions (&quot;abc&quot; &amp;lt; column &amp;lt; &quot;abd&quot; ) that are  sent to the scan controller through &apos;qualifier&apos; objects. When these are evaluated with SQLChar.stringCompare, the shorter string is padded with spaces, and the comparison fail due to that the ordinal value of TAB is less than Space. The comparison is correct, but optimization probably not.&lt;/p&gt;</comment>
                            <comment id="12377878" author="bandaram" created="Fri, 5 May 2006 03:40:04 +0100"  >&lt;p&gt;Good find. By avoiding Like optimization, the results appear to be right. Like optimizations can be disabled by having an expression on the left, as below. But it has unwanted side effect to prevent using of any indexes, if present.&lt;/p&gt;

&lt;p&gt;Possible work around could be:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; select * from t4 where c like &apos;abc%&apos;;&lt;br/&gt;
I          |J          |C&lt;br/&gt;
----------------------------------&lt;/p&gt;

&lt;p&gt;0 rows selected&lt;br/&gt;
ij&amp;gt; select * from t4 where cast(c as varchar(20)) like &apos;abc%&apos;;&lt;br/&gt;
I          |J          |C&lt;br/&gt;
----------------------------------&lt;br/&gt;
1          |1          |abc     def&lt;/p&gt;

&lt;p&gt;1 row selected&lt;/p&gt;

&lt;p&gt;Fixing the code issue will involve correctly generating a lessThan/greaterThan value, I think.&lt;/p&gt;</comment>
                            <comment id="12378414" author="hmork" created="Mon, 8 May 2006 20:53:57 +0100"  >&lt;p&gt;Thanks Satheesh for your input. I believe you are right that correcting the lessthan/greaterthan values is the way to go. I made a tentative patch for this issue, which pads the greaterthan and lessthan values with null chars, up to the number of chars in the &apos;receiver&apos; column (at the left side of the LIKE statement).&lt;/p&gt;

&lt;p&gt;As always, I&apos;m not confident this is the most efficient approach. A different solution than adding a new param for Like.greaterThanXX() would be to insert a method call node that adds the padding (for preparedstatement executions).&lt;/p&gt;

&lt;p&gt;Patch passes derbylang.&lt;/p&gt;</comment>
                            <comment id="12413100" author="oysteing" created="Wed, 24 May 2006 18:14:00 +0100"  >&lt;p&gt;Patch looks good, but I am not expert on this code.  I would very much like this to be fixed in 10.1.3 so it would be nice if someone with more experience with this code could look at it.  &lt;/p&gt;

&lt;p&gt;One minor comment:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Why are the old versions of greaterEqualStringFromParameter() and greaterEqualStringFromParameterWithEsc() kept?  Do you need them anymore? Seems like they are only called from one location.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12413834" author="hmork" created="Tue, 30 May 2006 22:03:04 +0100"  >&lt;p&gt;Thanks for your comment. The reason I didn&apos;t remove the old functions was due to metadata upgrade. Since stored preparedstatements in EmbedDatabaseMetaData is referring to the old functions, it wasn&apos;t immediately apparent to me how to deal with this.&lt;/p&gt;

&lt;p&gt;But it is now my understanding that this is dealt with automatically by the upgrade mechanism? &lt;a href=&quot;http://wiki.apache.org/db-derby/MetadataUpgrade&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/db-derby/MetadataUpgrade&lt;/a&gt;&lt;br/&gt;
I will make the changes.&lt;/p&gt;</comment>
                            <comment id="12413842" author="hmork" created="Tue, 30 May 2006 23:07:52 +0100"  >&lt;p&gt;New patch:&lt;br/&gt;
Removed duplicate greaterThan/lessThan methods, and now relying on the upgrade mechanism to upgrade the stored preparedstatements (SPS).&lt;/p&gt;

&lt;p&gt;The patch addresses both greaterThan and lessThan, and adds null padding on the right side so the comparisons will correctly respond to control characters. Changing lessThan was necessary to make &apos;asdf%&apos; not include &apos;asdg\t&apos; (\t is tab char).&lt;/p&gt;

&lt;p&gt;All derbylang still passes.&lt;/p&gt;</comment>
                            <comment id="12414032" author="bernt" created="Wed, 31 May 2006 19:35:17 +0100"  >&lt;p&gt;Instead of the loop in padWithNulls, you could use StringBuffer.setLength(len) instead, e.g:&lt;/p&gt;

&lt;p&gt;		StringBuffer buf = new StringBuffer(len).append(string);&lt;br/&gt;
                buf.setLength(len);&lt;br/&gt;
		return buf.toString();&lt;/p&gt;</comment>
                            <comment id="12414035" author="bernt" created="Wed, 31 May 2006 19:59:24 +0100"  >&lt;p&gt;Isn&apos;t it somewhat dnagerous to use tab-cahacters in strings in dynamicLikeOptimization.sql since it seems to me that Derby developers converts tabs to spaces and vice versa almost at will?&lt;/p&gt;</comment>
                            <comment id="12414213" author="hmork" created="Thu, 1 Jun 2006 18:54:58 +0100"  >&lt;p&gt;Attached new patch with corrections (thanks, Bernt)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;using the more efficient stringbuffer.setLength for null-char padding&lt;/li&gt;
	&lt;li&gt;esc (0x1b) as control char in test case, to avoid potential future tab-&amp;gt;space conversion.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12414218" author="hmork" created="Thu, 1 Jun 2006 19:08:45 +0100"  >&lt;p&gt;Sorry about bugspam. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Last patch was unnecessarily resource-hungry, use this one.&lt;/p&gt;</comment>
                            <comment id="12414239" author="djd" created="Thu, 1 Jun 2006 22:20:34 +0100"  >&lt;p&gt;Couple of minor comments on the patch (1262_5.diff)&lt;/p&gt;

&lt;p&gt;In padWithNulls() can StandardException ever be thrown? If not the method should not declare that it throws it.&lt;/p&gt;

&lt;p&gt;In padWithNulls()  can  the input ever be null? Seems all the callers have already checked for null.&lt;/p&gt;</comment>
                            <comment id="12414309" author="hmork" created="Fri, 2 Jun 2006 05:45:24 +0100"  >&lt;p&gt;Removed unnecessary code. Thanks Daniel.&lt;/p&gt;</comment>
                            <comment id="12414440" author="knutanders" created="Fri, 2 Jun 2006 23:14:01 +0100"  >&lt;p&gt;All tests ran successfully. Committed 1262_6.diff to trunk with revision 411174. I have started derbyall on 10.1 with this fix, and I intend to check it in on that branch too.&lt;/p&gt;</comment>
                            <comment id="12414489" author="knutanders" created="Sat, 3 Jun 2006 02:01:38 +0100"  >&lt;p&gt;Committed to 10.1 with revision 411223.&lt;/p&gt;</comment>
                            <comment id="12415184" author="army" created="Thu, 8 Jun 2006 01:40:49 +0100"  >&lt;p&gt;I think there&apos;s a &lt;b&gt;regression&lt;/b&gt; after this patch was checked in.  The following query returns 2 rows before svn revision 411174 and NO rows after.  I admit I haven&apos;t looked closely enough to figure out which behavior is correct, but some more investigation is definitely required (at the very least, a release note is needed if the new behavior is correct).&lt;/p&gt;

&lt;p&gt;This change went into the 10.1 codeline as well, and I have verified that it returned 2 rows with the snapshot  405564 but no rows with the latest 10.1 codeline.&lt;/p&gt;

&lt;p&gt;So I&apos;m reopening this issue.  Note: it&apos;s currently marked as &quot;Unassigned&quot;, so anyone who is inclined to pick it up should certainly feel free...&lt;/p&gt;</comment>
                            <comment id="12415185" author="army" created="Thu, 8 Jun 2006 01:41:25 +0100"  >&lt;p&gt;Oops, forgot to include the query:&lt;/p&gt;

&lt;p&gt;create table escTable (c1 char(10));&lt;br/&gt;
insert into escTable values (&apos;%_\a&apos;);&lt;br/&gt;
insert into escTable values (&apos;%_b&apos;);&lt;br/&gt;
insert into escTable values (&apos;%c&apos;);&lt;br/&gt;
insert into escTable values (&apos;d&apos;);&lt;br/&gt;
insert into escTable values (&apos;%_\e&apos;);&lt;br/&gt;
select c1 from escTable where c1 like &apos;&amp;#37;&amp;#95;&lt;br class=&quot;atl-forced-newline&quot; /&gt;%&apos; ESCAPE &apos;\&apos;;&lt;/p&gt;</comment>
                            <comment id="12415186" author="kmarsden" created="Thu, 8 Jun 2006 01:57:29 +0100"  >&lt;p&gt;Army said:&lt;/p&gt;

&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;I think there&apos;s a &lt;b&gt;regression&lt;/b&gt; after this patch was checked in. The following &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;query returns 2 rows before svn revision 411174 and NO rows after.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;As I read it, the fix for this issue  created a bug that is  a wrong Results&lt;br/&gt;
regression that is in the 10.1 maintenance  branch.&lt;/p&gt;

&lt;p&gt;I think instead of reopening this bug there should be a new bug marked regression and we should not release 10.1.3 while it exists.  &lt;/p&gt;</comment>
                            <comment id="12415195" author="army" created="Thu, 8 Jun 2006 03:07:57 +0100"  >&lt;p&gt;Putting this back to &quot;Resolved&quot; after having filed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1386&quot; title=&quot;Wrong results with query using LIKE and ESCAPE clause that includes &amp;quot;%&amp;quot;, &amp;quot;\&amp;quot;, and &amp;quot;_&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1386&quot;&gt;&lt;del&gt;DERBY-1386&lt;/del&gt;&lt;/a&gt; for the regression.  If anyone decides to back out this change in 10.1 (instead of trying to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1386&quot; title=&quot;Wrong results with query using LIKE and ESCAPE clause that includes &amp;quot;%&amp;quot;, &amp;quot;\&amp;quot;, and &amp;quot;_&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1386&quot;&gt;&lt;del&gt;DERBY-1386&lt;/del&gt;&lt;/a&gt;), please reopen as appropriate.  Thanks.&lt;/p&gt;</comment>
                            <comment id="12496209" author="knutanders" created="Wed, 16 May 2007 07:51:01 +0100"  >&lt;p&gt;Assigning the issue to H&#229;vard since he was the one fixing it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12326383" name="1262.diff" size="11233" author="hmork" created="Mon, 8 May 2006 20:53:57 +0100"/>
                            <attachment id="12334782" name="1262_3.diff" size="10783" author="hmork" created="Tue, 30 May 2006 23:07:52 +0100"/>
                            <attachment id="12334882" name="1262_4.diff" size="10715" author="hmork" created="Thu, 1 Jun 2006 18:54:58 +0100"/>
                            <attachment id="12334883" name="1262_5.diff" size="10727" author="hmork" created="Thu, 1 Jun 2006 19:08:45 +0100"/>
                            <attachment id="12334914" name="1262_6.diff" size="10661" author="hmork" created="Fri, 2 Jun 2006 05:45:24 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 4 May 2006 17:35:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22403</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy126n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40004</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>