<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:36:14 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3724/DERBY-3724.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3724] Converting big.sql  to JUnit </title>
                <link>https://issues.apache.org/jira/browse/DERBY-3724</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;It is a task of &quot;Converting old tests to JUnit &quot;. It request coverting  &quot;derdy/java/testing/org/apache/derbyTesting/functionTests/tests/lang/big.sql&quot; into a junit. Also, it is a task of 2008 GSoc.&lt;/p&gt;</description>
                <environment>windows XP Professional SP2, </environment>
        <key id="12398440">DERBY-3724</key>
            <summary>Converting big.sql  to JUnit </summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thinkallday">Junjie Peng</assignee>
                                    <reporter username="thinkallday">Junjie Peng</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jun 2008 18:42:50 +0100</created>
                <updated>Thu, 3 Jul 2008 08:39:05 +0100</updated>
                            <resolved>Thu, 3 Jul 2008 08:38:33 +0100</resolved>
                                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Test</component>
                        <due>Fri, 27 Jun 2008 07:00:00 +0000</due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <timeoriginalestimate seconds="604800">168h</timeoriginalestimate>
                            <timeestimate seconds="604800">168h</timeestimate>
                                        <comments>
                            <comment id="12605675" author="thinkallday" created="Tue, 17 Jun 2008 18:48:11 +0100"  >&lt;p&gt;I added a TestCase named &quot;BigDataTest&quot; for &quot;big.sql&quot;, please check it. It is one of my tasks  for 2008 GSOC. Hope for instructions, especially from my sincere mentor Myrna!&lt;/p&gt;</comment>
                            <comment id="12606144" author="myrna" created="Thu, 19 Jun 2008 00:27:21 +0100"  >&lt;p&gt;Thanks for this great first effort!&lt;/p&gt;

&lt;p&gt;Kathey and I put our heads together and noticed the following:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;what tool did you use to create the patch? Normally, patches are created using svn diff from the top of the trunk. That way, the diff would have something like:&lt;br/&gt;
=========================================================
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;java/testing/org/apache/derbyTesting/functionTests/tests/lang/BigDataTest.java      (revision 0)&lt;br/&gt;
+++ java/testing/org/apache/derbyTesting/functionTests/tests/lang/BigDataTest.java      (revision 0)&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;   In your patch, we miss the revisions, and there&apos;s an extra level (&apos;derdy&apos;)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;at Derby, we have to convention to not use @author tags.	(ownership &amp;amp; history is documented in JIRA and svn)&lt;/li&gt;
	&lt;li&gt;BIG_TABLE_NAME should be static&lt;/li&gt;
	&lt;li&gt;There should be no need for private Connection conn. The fixtures can just call &apos;getConnection&apos; (picking up from BaseJDBCTestCase) to connect to the default db&lt;/li&gt;
	&lt;li&gt;similarly, you don&apos;t need to use Statement stmt = conn.createStatement(...), you can just use createStatement(int resultSetType,int resultSetConcurrency) from BaseJDBCTestCase.&lt;/li&gt;
	&lt;li&gt;it would be good to have a suite() method using defaultSuite. That way the test would run automatically with both embedded and network server/client, using cleanDatabaseSetup to remove all tables from the db between fixtures.&lt;/li&gt;
	&lt;li&gt;instead of validTabe() and validRows() it looks as if you should be able to use one of the JDBC.assertFullResultSet() methods&lt;/li&gt;
	&lt;li&gt;At the end of big.sql there are various tests commented out because at one point it wasn&apos;t supported. Some of that functionality is (again?) supported; you should be able to insert characters into tables with datatype char, varchar, long varchar. (The max lengths are different per char - should be in the manual). You should see if those test cases can be revived.&lt;/li&gt;
	&lt;li&gt;the fixture &apos;testMixture&apos; is based on a section that in big.sql has half of it commented out, mentioning some problem with getting a DRDAProtocolException. This section should make it into the test - if it does still return a protocolException it can be commented out with reference to a JIRA (I looked, but it doesn&apos;t appear one was logged, so that would need to get done too, if reproducible).&lt;/li&gt;
	&lt;li&gt;nit: we usually have the code inside a method indented 8 spaces.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In general, there&apos;s a utility that we can use to convert .sql type tests to junit type tests - org.apache.derbyTesting.functionTests.util.SQLToJUnit - when you use it, a lot of the conversion should get done for you.&lt;/p&gt;</comment>
                            <comment id="12606435" author="thinkallday" created="Thu, 19 Jun 2008 17:20:45 +0100"  >&lt;p&gt;Myrna:&lt;br/&gt;
    Thank you for the verbose instructions from you and Kathey! I accept your comments and will do the improvement. It seems most of my problem comes from not so good understanding of BaseJDBCTestCase, and I will reuse more reusable things.     &lt;/p&gt;

&lt;p&gt;   ---My IDE is Eclipse on Windows XP, I use subclipse to check and create the patch, the result starts with&lt;br/&gt;
 &quot;Index: D:/myproject/java/eclipse/javaderdy/java/testing/org/apache/derbyTesting/functionTests/tests/lang/BigDataTest.java&lt;br/&gt;
===================================================================&lt;br/&gt;
&amp;#8212; D:/myproject/java/eclipse/javaderdy/java/testing/org/apache/derbyTesting/functionTests/tests/lang/BigDataTest.java (revision 0)&lt;br/&gt;
+++ D:/myproject/java/eclipse/javaderdy/java/testing/org/apache/derbyTesting/functionTests/tests/lang/BigDataTest.java (revision 0)&quot;&lt;/p&gt;

&lt;p&gt;  I do know why it doesn&apos;t include a revision number. And &quot;D:/myproject/java/eclipse/java&quot; was deleted by hand. I have done another testing &amp;#8212; if I change a class file which has been submitted, the patch will include some Non-ASCII code. Maybe I should try SVN.&lt;/p&gt;

&lt;p&gt;   ----Besides, I have another question:&lt;br/&gt;
        Where to put unit test codes for the unit test itself?  When I do this converting, I have a trouble in doing unit testing for my new test case. So far, I just put the testing codes in the same class file, then delete all of them before submit. It is not so smart. How should we deal with this problem?&lt;br/&gt;
     Thank you!&lt;/p&gt;

&lt;p&gt;     Regards&lt;br/&gt;
     Junjie&lt;/p&gt;</comment>
                            <comment id="12609175" author="thinkallday" created="Mon, 30 Jun 2008 09:02:42 +0100"  >&lt;p&gt;New patch for big.sql.&lt;br/&gt;
I have accepted Myrna&apos;s advices, and do some improvement.&lt;br/&gt;
In this patch, I also add some test cases for the parts in &quot;big.sql&quot; which is commented.&lt;br/&gt;
i.e. Mix clob and varchar in the table, the test case will be supported without  DRDAProtocolException exception is thrown. &lt;br/&gt;
I also add testStringTable(), testLongVarchar() and testVarchar(). testStringTable() has been proved not supported yet, so I commented it again. For testVarchar(), When creating the table, a SQLException is thrown  with the prompt that 32767 is a invalid length. For testLongVarchar(),  When inserting a big row with the length of 33000, a SQLException is thrown  with the prompt that 33000 is a invalid length.  &lt;br/&gt;
In this situation, whether should I add testLongVarchar() and testVarchar() as new test cases.&lt;br/&gt;
I have another question: I have 10 test***() methods and 1 suite() method in the class of BigDataTest. When I run this test, I have seen 20 test cases run.  What&apos;s the problem?&lt;/p&gt;</comment>
                            <comment id="12609232" author="bryanpendleton" created="Mon, 30 Jun 2008 14:43:05 +0100"  >&lt;p&gt;&amp;gt; I have 10 test***() methods and 1 suite() method in the class of BigDataTest. When I run this test, I have seen 20 test cases run&lt;/p&gt;

&lt;p&gt;How are you running the test? Is it possible that you are running&lt;br/&gt;
the test in multiple configurations? For example, perhaps you&lt;br/&gt;
are running the 10 test methods in embedded mode, and then&lt;br/&gt;
running the same 10 test methods again, in client-server mode?&lt;/p&gt;</comment>
                            <comment id="12609343" author="kmarsden" created="Mon, 30 Jun 2008 20:55:00 +0100"  >&lt;p&gt;&amp;gt;For testVarchar(), When creating the table, a SQLException is thrown with the prompt &amp;gt;that 32767 is a invalid length. &lt;br/&gt;
I think you should create the table with the maximum size  allowed and only insert rows that will fit.&lt;/p&gt;

&lt;p&gt;&amp;gt;For testLongVarchar(), When inserting a big row with the length of 33000, a &amp;gt;SQLException is thrown with the prompt that 33000 is a invalid length.&lt;/p&gt;

&lt;p&gt;Again only insert colums that will fit up to the max.&lt;/p&gt;

&lt;p&gt;&amp;gt;I have another question: I have 10 test***() methods and 1 suite() method in the class &amp;gt;of BigDataTest. When I run this test, I have seen 20 test cases run. What&apos;s the problem?&lt;br/&gt;
Yes you are testing with both embedded and network client so this is expected.&lt;/p&gt;


&lt;p&gt;I will take a closer look at the patch later today.  A couple things I noticed glancing at it briefly is that you should remove big.sql from the old harness and add your new test to lang._Suite.  &lt;/p&gt;

&lt;p&gt;Also we should rename testJCCQueryBlock to testDefaultQueryBlock and change the comments to indicate client instead of JCC.&lt;/p&gt;


</comment>
                            <comment id="12609477" author="thinkallday" created="Tue, 1 Jul 2008 08:22:04 +0100"  >&lt;p&gt;Thanks for Bryan and Kathey! I have provided a new patch with changes below:&lt;br/&gt;
In this path, I have changed testVarchar() and testLongVarchar() to just test the max length of varchars to be OK.&lt;br/&gt;
Rename testJCCQueryBlock () to testDefaultQueryBlock(), and change the comments to indicate client instead of JCC.&lt;br/&gt;
Remove big.sql from the old harness.&lt;br/&gt;
Add my new test to lang._Suite.&lt;br/&gt;
Please check it!&lt;/p&gt;</comment>
                            <comment id="12609637" author="kmarsden" created="Tue, 1 Jul 2008 17:53:55 +0100"  >&lt;p&gt;Thanks Junjie, I committed the patch with revision 673136.  I removed big.sql big_derby.properties and the master (big.out) files.  Even though big_derby.properties had lock timeouts set to a lower timeout I don&apos;t see that that was necessary for the test because it doesn&apos;t have any lock timeouts as far as I can tell.  I think you can go ahead and resolve/close this issue once the nightly tests run.&lt;/p&gt;



</comment>
                            <comment id="12609763" author="thinkallday" created="Wed, 2 Jul 2008 01:57:23 +0100"  >&lt;p&gt;Good message! I will close this issue some later.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12385017" name="derby_3724_patch.txt" size="22634" author="thinkallday" created="Tue, 1 Jul 2008 08:22:04 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 18 Jun 2008 23:27:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30970</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0yrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39452</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>