<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:49:15 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2248/DERBY-2248.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2248] Place holder for the NetworkServer system test</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2248</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I will be using this Jira entry as the place holder for the contibution of NetworkServer system tests.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12360686">DERBY-2248</key>
            <summary>Place holder for the NetworkServer system test</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mkutty">Manjula Kutty</assignee>
                                    <reporter username="mkutty">Manjula Kutty</reporter>
                        <labels>
                    </labels>
                <created>Wed, 17 Jan 2007 18:54:43 +0000</created>
                <updated>Wed, 1 Jul 2009 01:04:54 +0100</updated>
                            <resolved>Mon, 5 Mar 2007 22:01:51 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12471534" author="jta" created="Fri, 9 Feb 2007 00:14:19 +0000"  >&lt;p&gt;The software grant for this contribution was received, it just hasn&apos;t been recorded yet. I suggest that Manjula go ahead and upload the code when it&apos;s ready so people can start looking at it. It just can&apos;t be committed until the ip clearance process is complete (including the software grant recorded).&lt;/p&gt;</comment>
                            <comment id="12471538" author="mkutty" created="Fri, 9 Feb 2007 00:24:39 +0000"  >&lt;p&gt;Adding the source file for review.  Thanks Jean for the update.&lt;/p&gt;</comment>
                            <comment id="12474445" author="johnemb" created="Tue, 20 Feb 2007 13:59:10 +0000"  >&lt;p&gt;I downloaded, unzipped, built and ran the test. I also looked at some of the &lt;br/&gt;
source code. I have some questions and comments (don&apos;t let the amount of text &lt;br/&gt;
scare you, it&apos;s mostly nitpicking, but I found at least one real bug as well):&lt;/p&gt;


&lt;p&gt;General comments:&lt;br/&gt;
------------------&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;How long (approximately) is the test expected to last with default settings?&lt;br/&gt;
  The README should include a comment on this.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Very few of the method and field comments have valid JavaDoc formatting. For&lt;br/&gt;
  example, the printException( ) method of nstest.utils.DbUtil.java has the&lt;br/&gt;
  following (rather messy, IMHO) method comment:&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;	// ** This method abstracts exception message printing for all exception&lt;br/&gt;
	// messages. You may want to change&lt;br/&gt;
	// ****it if more detailed exception messages are desired.&lt;br/&gt;
	// ***Method is synchronized so that the output file will contain sensible&lt;br/&gt;
	// stack traces that are not&lt;br/&gt;
	// ****mixed but rather one exception printed at a time&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Some of the Java statements spanning multiple lines are not indented&lt;br/&gt;
  &quot;properly&quot;, see for example line 522-523 of DbUtil.java:&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;		long rowToReturn = (minVal + 1)&lt;br/&gt;
		+ (Math.abs(rand.nextLong()) % (maxVal - minVal));&lt;/p&gt;

&lt;p&gt;  This may confuse reviewers, and may increase the possibility of bugs if the&lt;br/&gt;
  test is modified in the future.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;One possible item to add as &quot;future work&quot; could be to let the server host&lt;br/&gt;
  and port number be configurable (the client URL is currently hard-coded to &lt;br/&gt;
  localhost and port 1900).&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;o.a.d.s.nstest.NsTest.java:&lt;br/&gt;
---------------------------&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The CREATE_DATABASE_ONLY field could use a comment at the point of&lt;br/&gt;
  declaration. (Usage comments below are fine).&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;line 217, addStats( ) method: The switch (type) case statements could use the&lt;br/&gt;
  previously declared fields (static ints) INSERT, UPDATE, DELETE, etc. instead &lt;br/&gt;
  of using the ints 0, 1, 2 etc. directly, couldn&apos;t they? This would improve &lt;br/&gt;
  readability and maintainability.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;line 264, main( ) method: Why throw both SQLException, IOException,&lt;br/&gt;
  InterruptedException, Exception, and Throwable? I know it&apos;s a good habit to&lt;br/&gt;
  declare checked Exceptions individually, but just throwing Throwable would&lt;br/&gt;
  cover all of the above in this case. The JavaDoc should however document all &lt;br/&gt;
  of the exceptions in @throws clauses.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  Having said that, I think it&apos;s overkill to throw Exception and Throwable.&lt;br/&gt;
  For example, the methods in the DbUtil class probably won&apos;t throw anything&lt;br/&gt;
  but SQLExceptions, hardly even that, although it is declared to throw &lt;br/&gt;
  Exception. You may perhaps be able to avoid throwing anything from the main &lt;br/&gt;
  method at all if you reconsider which exceptions to throw from the various &lt;br/&gt;
  methods called from main( )...&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;line 429-&amp;gt;: while (numTestThread &amp;lt; maxTestThreads) { ...&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  **&lt;b&gt;BUG&lt;/b&gt;**:&lt;br/&gt;
    Why the while loop here? It is broken...&lt;/p&gt;

&lt;p&gt;    It seems that numTestThread will always be equal to maxTestThreads after one&lt;br/&gt;
    iteration, except when derby.nstest.backupRestore=false, in which case&lt;br/&gt;
    the entire loop will re-run, numTestThread will be incremented far above&lt;br/&gt;
    maxTestThreads, and you end up with an ArrayIndexOutOfBoundsException:&lt;/p&gt;

&lt;p&gt;    Exception in thread &quot;main&quot; java.lang.ArrayIndexOutOfBoundsException: 71&lt;br/&gt;
            at org.apache.derbyTesting.system.nstest.NsTest.main(NsTest.java:443)&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;line 471-490: When printing statistics: The text&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  &quot;Note that this may not be the same as the server side connections made to the&lt;br/&gt;
  database especially if connection pooling is employed&quot; &lt;/p&gt;

&lt;p&gt;  is printed, but the actual number of connections (numConnections) is not &lt;br/&gt;
  printed.&lt;/p&gt;


&lt;p&gt;o.a.d.s.nstest.utils.DbUtil.java:&lt;br/&gt;
---------------------------------&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;method pick_one( ) (line 490-&amp;gt;):&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  I don&apos;t understand the logic of this method. The comments say that a row with&lt;br/&gt;
  a random key value between minVal and maxVal will be returned. However, from &lt;br/&gt;
  what I can see, the value being returned is not really random unless the statement&lt;/p&gt;

&lt;p&gt;  &quot;select max(serialkey) from nstesttab where serialkey &amp;gt; ?&quot;&lt;/p&gt;

&lt;p&gt;  (where ? translates to &amp;lt;random value between minVal and maxVal&amp;gt;)&lt;br/&gt;
  returns a value &amp;lt;= 0. If max(serialkey) is &amp;gt; 0 (as it usually is), the max &lt;br/&gt;
  will be returned. This is supported by the output from the test program, e.g.:&lt;/p&gt;

&lt;p&gt;-----&lt;del&gt;&amp;lt;8&lt;/del&gt;------- output excerpt start --------------&lt;del&gt;&amp;lt;8&lt;/del&gt;--------------&lt;br/&gt;
Tester2Thread 24 deleted row with serialkey 50638 *** SUCCESS ***&lt;br/&gt;
Tester2Thread 17 dbutil.pick_one() -&amp;gt; Obtained row from the table 50636&lt;br/&gt;
Tester2Thread 17 attempting  to update col t_float to 8.4019195E17&lt;br/&gt;
Tester2Thread 17 updated 1 row with serialkey 50636 *** SUCCESS ***&lt;br/&gt;
Tester2Thread 17 inserted 1 row with id 1844913544 *** SUCCESS ***&lt;br/&gt;
Tester1Thread 1 dbutil.pick_one() -&amp;gt; Obtained row from the table 50639&lt;br/&gt;
Tester1Thread 1 attempting  to delete a row with serialkey = 50639&lt;br/&gt;
Tester1Thread 1 deleted row with serialkey 50639 *** SUCCESS ***&lt;br/&gt;
Tester2Thread 53 dbutil.pick_one() -&amp;gt; Obtained row from the table 50636&lt;br/&gt;
-----&lt;del&gt;&amp;lt;8&lt;/del&gt;------- output excerpt end --------------&lt;del&gt;&amp;lt;8&lt;/del&gt;----------------&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;line 597: println() typo, &quot;exection&quot; should be &quot;exception&quot;&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;o.a.d.s.nstest.tester.Tester&lt;span class=&quot;error&quot;&gt;&amp;#91;1,2&amp;#93;&lt;/span&gt;.java:&lt;br/&gt;
---------------------------------------&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;startTesting methods: Comments do not match the code...&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  Comments first say (this is from Tester2.java, line 57):&lt;/p&gt;

&lt;p&gt;  &quot;Autocommit is left on, so per connection, we make MAX_OPERATIONS_PER_CONN &lt;br/&gt;
  number of transaction batches&quot;&lt;/p&gt;

&lt;p&gt;  Later comments say (both Tester1 and Tester2):&lt;/p&gt;

&lt;p&gt;    //set autocommit to false to keep transaction control in your hand&lt;br/&gt;
    //Too many deadlocks amd locking issues if this is not commented out&lt;/p&gt;

&lt;p&gt;  Then, autocommit is actually set to false in both Testers, i.e. it is &lt;em&gt;not&lt;/em&gt;&lt;br/&gt;
  commented out, and is thus &lt;em&gt;not&lt;/em&gt; left on. Should autocommit be on or off by &lt;br/&gt;
  default?&lt;/p&gt;


&lt;p&gt;I did not study all classes/methods that carefully, so I may have missed a few&lt;br/&gt;
things.&lt;/p&gt;

&lt;p&gt;Running the test went fine (still running at the time of writing this, has been&lt;br/&gt;
running for several hours), apart from the ArrayIndexOutOfBoundsException &lt;br/&gt;
mentioned above. The bug(s) should be fixed, but I&apos;m fine with this code being &lt;br/&gt;
committed (barring any vetos in the vote on derby-dev).&lt;/p&gt;
</comment>
                            <comment id="12474531" author="djd" created="Tue, 20 Feb 2007 19:23:05 +0000"  >&lt;p&gt;This test seems similar in approach to the single table test added under &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2134&quot; title=&quot;Add long running System test for Derby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2134&quot;&gt;&lt;del&gt;DERBY-2134&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Do we need two similar tests or could they be combined into a single &quot;single table&quot; test?&lt;/p&gt;</comment>
                            <comment id="12476748" author="mkutty" created="Wed, 28 Feb 2007 22:50:19 +0000"  >&lt;p&gt;I agree that this test is similar to single table test in some ways. But this test tests more features like triggers ,backup/restore etc. &lt;/p&gt;</comment>
                            <comment id="12477152" author="mkutty" created="Fri, 2 Mar 2007 01:09:18 +0000"  >&lt;p&gt;Attaching build.xml and the patch for changes in the build.xml under java/testing directory. Please review and commit&lt;/p&gt;
</comment>
                            <comment id="12477371" author="jta" created="Fri, 2 Mar 2007 17:21:59 +0000"  >&lt;p&gt;This contribution is cleared for import. Here&apos;s the final notice sent to the Incubator:&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/incubator-general/200703.mbox/%3c45E857D1.6080909@bristowhill.com%3e&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/incubator-general/200703.mbox/%3c45E857D1.6080909@bristowhill.com%3e&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12478175" author="fuzzylogic" created="Mon, 5 Mar 2007 22:01:51 +0000"  >&lt;p&gt;Committed to trunk with revision 514882.&lt;/p&gt;</comment>
                            <comment id="12483095" author="johnemb" created="Thu, 22 Mar 2007 10:46:20 +0000"  >&lt;p&gt;I entered a new issue, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2479&quot; title=&quot;ArrayIndexOutOfBoundsException in system.nstest if derby.nstest.backupRestore=false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2479&quot;&gt;DERBY-2479&lt;/a&gt;, to track the ArrayIndexOutOfBoundsException I mentioned in an earlier comment to this issue, since I have not seen any indications of responses to any of the review comments or questions I posted.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12352385" name="DERBY-2248_diff.txt" size="611" author="mkutty" created="Fri, 2 Mar 2007 01:09:18 +0000"/>
                            <attachment id="12352384" name="DERBY-2248_stat.txt" size="1312" author="mkutty" created="Fri, 2 Mar 2007 01:09:17 +0000"/>
                            <attachment id="12350719" name="NsTest.zip" size="35679" author="mkutty" created="Fri, 9 Feb 2007 00:24:39 +0000"/>
                            <attachment id="12352386" name="build.xml" size="3247" author="mkutty" created="Fri, 2 Mar 2007 01:09:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 9 Feb 2007 00:14:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30340</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0tpz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38633</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>