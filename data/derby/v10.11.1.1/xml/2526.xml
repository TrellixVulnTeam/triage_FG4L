<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:23:49 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2526/DERBY-2526.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2526] Wrong results with queries that use the JOIN ... ON syntax to join with views or other non-base table expressions.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2526</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I think both select statements in the attached repro script should return 1 row, but in fact the first statement returns 1 row and the second returns zero rows.&lt;/p&gt;

&lt;p&gt;The only difference between the two statements is that the columns in the UNION view are listed in a different order (bvw vs. bvw2).&lt;/p&gt;

&lt;p&gt;This seems like a bug to me; the order of the columns in the view definition shouldn&apos;t matter, should it? &lt;/p&gt;

&lt;p&gt;As Army noted on the derby-dev list, the fact that this reproduces with 10.0 means that it is not caused by some of the 10.2 optimizer changes. Something else is going wrong.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12366604">DERBY-2526</key>
            <summary>Wrong results with queries that use the JOIN ... ON syntax to join with views or other non-base table expressions.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="army">A B</assignee>
                                    <reporter username="bryanpendleton">Bryan Pendleton</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Apr 2007 00:23:19 +0100</created>
                <updated>Tue, 25 Sep 2012 16:46:13 +0100</updated>
                            <resolved>Wed, 20 Jun 2007 02:25:30 +0100</resolved>
                                    <version>10.0.2.1</version>
                    <version>10.1.3.1</version>
                    <version>10.2.2.0</version>
                    <version>10.3.1.4</version>
                                    <fixVersion>10.1.3.2</fixVersion>
                    <fixVersion>10.2.2.1</fixVersion>
                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12486808" author="bryanpendleton" created="Thu, 5 Apr 2007 00:24:51 +0100"  >&lt;p&gt;derby-2526.sql is a test script which demonstrates the problem. Both SELECT statements should return 1 row, but in fact the first statement returns 1 row and the second returns 0 rows.&lt;/p&gt;</comment>
                            <comment id="12486834" author="bryanpendleton" created="Thu, 5 Apr 2007 02:52:10 +0100"  >&lt;p&gt;Attached is the output of derby.language.logQueryPlan for both queries.&lt;/p&gt;

&lt;p&gt;goodQuery.log is the query plan for the query that returns 1 row, correctly I believe.&lt;/p&gt;

&lt;p&gt;badQuery.log is the query plan for the query that returns 0 rows, wrongly I believe.&lt;/p&gt;
</comment>
                            <comment id="12486979" author="bryanpendleton" created="Thu, 5 Apr 2007 15:33:46 +0100"  >&lt;p&gt;The two query plans are &lt;b&gt;substantially&lt;/b&gt; different. They seem to show that the second query is&lt;br/&gt;
executed in a totally different fashion than the first. This would seem to rule out a variety of&lt;br/&gt;
theories and would seem to focus attention on either:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;optimizer chose an invalid query plan (one which could not produce the correct result)&lt;/li&gt;
	&lt;li&gt;or optimizer chose a valid, but different query plan, then something went wrong while executing it&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12487128" author="bryanpendleton" created="Fri, 6 Apr 2007 02:33:22 +0100"  >&lt;p&gt;In the &quot;good&quot; query plan, table B4 is joined against the UNION, and the result &lt;br/&gt;
is then joined against B3. This makes sense, and seems like a reasonable plan.&lt;/p&gt;

&lt;p&gt;In the &quot;bad&quot; query plan, table B4 is joined against table B3, and the result is&lt;br/&gt;
then joined against the UNION. This does &lt;b&gt;not&lt;/b&gt; make sense. The query does&lt;br/&gt;
not specify any criteria which would support such a join (unless it were a&lt;br/&gt;
cartesian product I guess, but still I don&apos;t understand this join). In this query plan,&lt;br/&gt;
here&apos;s an excerpt from the portion of the plan where table B4 is joined against&lt;br/&gt;
table B3:&lt;/p&gt;

&lt;p&gt;        Right result set:&lt;br/&gt;
            Table Scan ResultSet for B3 at read committed isolation level using instantaneous share row locking chosen by the optimizer&lt;br/&gt;
            Rows seen = 0&lt;br/&gt;
            Rows filtered = 0&lt;/p&gt;

&lt;p&gt;            scan information:&lt;br/&gt;
                Bit set of columns fetched=All&lt;br/&gt;
                Number of columns fetched=4&lt;br/&gt;
                Number of pages visited=1&lt;br/&gt;
                Number of rows qualified=0&lt;br/&gt;
                Number of rows visited=1&lt;/p&gt;

&lt;p&gt;The &quot;bad&quot; query plan visits the B3 row, but the B3 row does not qualify, so apparently&lt;br/&gt;
the query plan specified some sort of strange join criteria for this join between&lt;br/&gt;
table B4 and table B3, and according to that criteria no rows qualified, causing&lt;br/&gt;
the end result to be no rows found by the query.&lt;/p&gt;</comment>
                            <comment id="12487253" author="army" created="Fri, 6 Apr 2007 16:33:22 +0100"  >&lt;p&gt;Thank you for your investigation of this issue, Bryan.  I&apos;ve been a bit busy so I haven&apos;t had time to look at this more, but it sounds like you&apos;re doing a great job of narrowing this down.&lt;/p&gt;

&lt;p&gt;One suggestion (without having actually run done any investigation of my own): does this problem reproduce if you set &quot;derby.optimizer.noTimeout=true&quot;?  If it does, then you could set that property and then step through the code to see if there are any obvious differences in the optimization paths for the two statements.  I usually start by putting a break point in the &quot;getNextPermutation()&quot; method of OptimizerImpl and then doing a quick step through of that method for the different queries, to see if any there are any obvious differences in code flows (esp. number of times the method is called).&lt;/p&gt;

&lt;p&gt;Another technique I use (which is a tad less scientific) is to put System.outs in the &quot;rememberBestCost()&quot; method of OptimizerImpl to print out: a) the join order that is being saved as &quot;best&quot;, and b) the cost of that join order.  Then add a similar System.out to the &quot;modifyAccessPaths()&quot; method of OptimizerImpl and print out the final value of bestJoinOrder, along with the final cost estimate.  If you do that and then run the two different queries,  you can often see a difference in plans/costs that helps track down the issue at hand...&lt;/p&gt;</comment>
                            <comment id="12487261" author="bryanpendleton" created="Fri, 6 Apr 2007 17:03:58 +0100"  >&lt;p&gt;Hi Army, thanks for the ideas and the encouragement! The problem does appear to&lt;br/&gt;
reproduce with derby.optimizer.noTimeout=true, so I&apos;ll try some of your suggestions&lt;br/&gt;
and see how far I get.&lt;/p&gt;</comment>
                            <comment id="12487267" author="bryanpendleton" created="Fri, 6 Apr 2007 17:25:46 +0100"  >&lt;p&gt;The query that finds 1 row prints:&lt;br/&gt;
Modifying access paths to use join order: 2,1,0, with cost Level2CostEstimateImpl: at 602878, cost == 216.069408, rowCount == 0.25920000000000015, singleScanRowCount == 0.6000000000000001&lt;/p&gt;

&lt;p&gt;The query that finds 0 rows prints:&lt;br/&gt;
Modifying access paths to use join order: 2,0,1, with cost Level2CostEstimateImpl: at 17715159, cost == 186.67111680000002, rowCount == 0.1555200000000001, singleScanRowCount == 1.2000000000000002&lt;/p&gt;

&lt;p&gt;I believe that optimizable 2 is table b4, optimizable 1 is the UNION view, and optimizable 0 is table b3, so these results match the other info I was seeing in the query plan dumps.&lt;/p&gt;

&lt;p&gt;Time to fire up the debugger...&lt;/p&gt;</comment>
                            <comment id="12487271" author="army" created="Fri, 6 Apr 2007 17:40:17 +0100"  >&lt;p&gt;One thing that stands out here: estimated row count that is less than 1.0.  This means that whenever the row counts are multiplied through, we&apos;ll actually estimate fewer rows than we should., which could throw off estimates.  I&apos;ve noticed this oddity a couple of times myself when working with the optimizer--most recently while looking at &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1905&quot; title=&quot;Optimizer cost estimates for subqueries are way (way) too high.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1905&quot;&gt;DERBY-1905&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;ve always thought this was strange.  I wonder if you put a check for this at the end of FromBaseTable.estimateCost()-&lt;del&gt;ex. set anything with a row count less than 1 to be 1.0&lt;/del&gt;-what would happen?  Could be a red herring, but should be easy enough to check...&lt;/p&gt;

&lt;p&gt;@@ -1832,6 +1832,12 @@&lt;br/&gt;
 		/* Put the base predicates back in the predicate list */&lt;br/&gt;
 		currentJoinStrategy.putBasePredicates(predList,&lt;br/&gt;
 									   baseTableRestrictionList);&lt;br/&gt;
+&lt;br/&gt;
+if (costEstimate.rowCount() &amp;lt; 1.0)&lt;br/&gt;
+&lt;/p&gt;
{
+// System.out.println(&quot;-=- Oops! &quot; + costEstimate.rowCount() + &quot; -- &quot; + costEstimate.singleScanRowCount());
+costEstimate.setCost(costEstimate.getEstimatedCost(), 1.0d, costEstimate.singleScanRowCount());
+}
&lt;p&gt; 		return costEstimate;&lt;br/&gt;
 	}&lt;/p&gt;


&lt;p&gt;Proverbial (and potentialy irrelevant) 2c.&lt;/p&gt;</comment>
                            <comment id="12487299" author="bryanpendleton" created="Fri, 6 Apr 2007 19:08:59 +0100"  >&lt;p&gt;With those lines in FromBaseTable, the cost estimates are different, but the bottom line is the same:&lt;/p&gt;

&lt;p&gt;Good query plan:&lt;br/&gt;
Modifying access paths to use join order: 2,1,0 for 3 optimizables, with cost Level2CostEstimateImpl: at 7363880, cost == 401.716, rowCount == 7.2, singleScanRowCount == 0.6000000000000001&lt;/p&gt;

&lt;p&gt;Bad query plan:&lt;br/&gt;
Modifying access paths to use join order: 2,0,1 for 3 optimizables, with cost Level2CostEstimateImpl: at 18796902, cost == 401.616, rowCount == 12.0, singleScanRowCount == 12.0&lt;/p&gt;

&lt;p&gt;I&apos;ll look into this more later; I&apos;ve got a few other things to do first.&lt;/p&gt;</comment>
                            <comment id="12487411" author="bryanpendleton" created="Sat, 7 Apr 2007 20:37:46 +0100"  >&lt;p&gt;For both the &quot;good&quot; and &quot;bad&quot; queries, the optimizer examines the complete join orders:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;0,1,2&lt;/li&gt;
	&lt;li&gt;2,0,1&lt;/li&gt;
	&lt;li&gt;2,1,0&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In the &quot;good&quot; case, the optimizer assigns the costs:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1405&lt;/li&gt;
	&lt;li&gt;1405&lt;/li&gt;
	&lt;li&gt;401&lt;br/&gt;
And thus selects the join order 2,1,0&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In the &quot;bad&quot; case, the optimizer assigns the costs:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;1405&lt;/li&gt;
	&lt;li&gt;401&lt;/li&gt;
	&lt;li&gt;401&lt;br/&gt;
And thus selects the join order 2,0,1&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This leaves me with two &quot;next questions&quot; to study:&lt;br/&gt;
1) Why does the optimizer compute a different cost for the join order 2,0,1 in the two cases?&lt;br/&gt;
2) If the only problem is that the optimizer gets the costs wrong, it might pick a poorer query plan, but it still seems like it should pick a &lt;b&gt;valid&lt;/b&gt; query plan, right? So, why, in the &quot;bad&quot; case where the optimizer uses the join order 2,0,1, does it actually get &lt;b&gt;incorrect results&lt;/b&gt;? That is, is 2,0,1 actually a valid plan for executing this query? If so, why do we get wrong results? If it&apos;s &lt;b&gt;not&lt;/b&gt; valid, why does the optimizer proceed to fully cost it out, rather than dismissing it during optimization?&lt;/p&gt;</comment>
                            <comment id="12487420" author="bryanpendleton" created="Sun, 8 Apr 2007 02:07:02 +0100"  >&lt;p&gt;The optimizer also examines the join orders &lt;span class=&quot;error&quot;&gt;&amp;#91;0,2,1&amp;#93;&lt;/span&gt;, &lt;span class=&quot;error&quot;&gt;&amp;#91;1,0,2&amp;#93;&lt;/span&gt;, and &lt;span class=&quot;error&quot;&gt;&amp;#91;1,2,0&amp;#93;&lt;/span&gt;, but all of those have cost 401 also. I&apos;m just noting this for completeness, I don&apos;t think it&apos;s relevant to what&apos;s going on with this issue.&lt;/p&gt;</comment>
                            <comment id="12487447" author="bryanpendleton" created="Sun, 8 Apr 2007 17:47:14 +0100"  >&lt;p&gt;In the &quot;good&quot; case, the OptimizerImpl&apos;s predicateList contains two predicates:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: bvw.c1 = b4.c7&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: b3.c8 = bvw.c5&lt;br/&gt;
which seems all well and good. But in the &quot;bad&quot; case, the predicateList contains:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: b3.c8=b4.c7&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: bvw2.c1 = b4.c7&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;: b3.c8 = bvw2.c5&lt;br/&gt;
and while the second and third predicates are fine, that first one is completely bogus.&lt;/p&gt;

&lt;p&gt;So now I will try to figure out where that extra erroneous predicate is coming from.&lt;/p&gt;</comment>
                            <comment id="12487452" author="bryanpendleton" created="Sun, 8 Apr 2007 18:27:51 +0100"  >&lt;p&gt;The erroneous predicate is coming from PredicateList.joinClauseTransitiveClosure,&lt;br/&gt;
called by SelectNode.performTransitiveClosure, called by SelectNode.preprocess.&lt;/p&gt;

&lt;p&gt;PredicateList.joinClauseTransitiveClosure looks meaty, so I&apos;ll take a break for a bit&lt;br/&gt;
and investigate this code anon.&lt;/p&gt;</comment>
                            <comment id="12487471" author="bryanpendleton" created="Mon, 9 Apr 2007 05:09:22 +0100"  >&lt;p&gt;joinClauseTransitiveClosure is examining the two predicates:&lt;br/&gt;
    b3.c8 = bvw2.c5&lt;br/&gt;
and&lt;br/&gt;
   bvw2.c1 = b4.c7&lt;/p&gt;

&lt;p&gt;However, in the second predicate, the ColumnReference for bvw2.c1 has&lt;br/&gt;
columnNumber = 5, so joinClauseTransitiveClosure, which matches up&lt;br/&gt;
the predicates based on tableNumber and columnNumber, thinks that&lt;br/&gt;
this is the predicate&lt;br/&gt;
   bvw2.c5 = b4.c7&lt;/p&gt;

&lt;p&gt;And, therefore, it computes the transitive closure to include the predicate&lt;br/&gt;
   b3.c8 = b4.c7&lt;/p&gt;

&lt;p&gt;So next I need to figure out why the columnNumber is wrong in the&lt;br/&gt;
leftOperand ColumnReference in the BinaryRelationalOperatorNode for&lt;br/&gt;
   bvw2.c1 = b4.c7&lt;/p&gt;</comment>
                            <comment id="12487475" author="bryanpendleton" created="Mon, 9 Apr 2007 06:33:38 +0100"  >&lt;p&gt;In ColumnReference.bindExpression, we fetch and set the column&apos;s columnNumber&lt;br/&gt;
from the ResultColumn &quot;matchingRC&quot;, with the comment:&lt;/p&gt;

&lt;p&gt;		/* Set the columnNumber from the base table.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Useful for optimizer and generation.&lt;br/&gt;
		 */&lt;br/&gt;
		columnNumber = matchingRC.getColumnPosition();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;At this point, the ResultColumn instance for column C1 from view BVW2&lt;br/&gt;
has a null ColumnDescriptor, but has a virtualColumnId of 5.&lt;/p&gt;

&lt;p&gt;So next I need to figure out why the ResultColumn instance for BVw2.C1&lt;br/&gt;
is getting a virtualColumnId of 5.&lt;/p&gt;</comment>
                            <comment id="12487551" author="bryanpendleton" created="Mon, 9 Apr 2007 15:23:21 +0100"  >&lt;p&gt;The ResultColumn instance for BVW2.C1 with virtualColumnId = 5&lt;br/&gt;
comes from a 9-element ResultColumnList which is built for the&lt;br/&gt;
intermediate &quot;table&quot; that is built by JoinNode to represent the&lt;br/&gt;
joining of B3 with BVW2. This ResultColumnList has the following columns:&lt;br/&gt;
  Name      VirtualColumnId&lt;br/&gt;
   b3.c8       1&lt;br/&gt;
   b3.c9       2&lt;br/&gt;
   b3.c5       3&lt;br/&gt;
   b3.c6       4&lt;br/&gt;
   bvw2.c1   5&lt;br/&gt;
   bvw2.c2   6&lt;br/&gt;
   bvw2.c3   7&lt;br/&gt;
   bvw2.c4   8&lt;br/&gt;
   bvw2.c5   9&lt;/p&gt;

&lt;p&gt;In this context, the use of virtualColumnId=5 to represent BVW2.C1 makes complete sense.&lt;/p&gt;

&lt;p&gt;So it appears that I can now finally state the problem with some clarity:&lt;/p&gt;

&lt;p&gt;The problem involves an inconsistency in the handling of ColumnReference objects&lt;br/&gt;
during PredicateList.joinClauseTransitiveClosure. In this code, we are working with&lt;br/&gt;
ColumnReference objects whose columnNumber values refer to intermediate join tables,&lt;br/&gt;
but the code compares those ColumnReference objects against each other as though&lt;br/&gt;
the columnNumber values applied to the base tables.&lt;/p&gt;</comment>
                            <comment id="12487553" author="bryanpendleton" created="Mon, 9 Apr 2007 15:37:13 +0100"  >&lt;p&gt;Note that in the &quot;good&quot; case, the code also mixes join-table-based column numbers&lt;br/&gt;
and base-table-based column numbers, but since the columns in the view are&lt;br/&gt;
in a different order, it doesn&apos;t accidentally see a match where the other case did.&lt;br/&gt;
That is, when the &quot;good&quot; case is being examined in PredicateList.joinClauseTransitiveClosure,&lt;br/&gt;
it sees &lt;br/&gt;
    b3.c8 = bvw.c5&lt;br/&gt;
and&lt;br/&gt;
   bvw.c1 = b4.c7&lt;br/&gt;
but in this case the ColumnReference for bvw.c1 is 6, because it was drawn from&lt;br/&gt;
the 9-element ResultColumnList: &lt;span class=&quot;error&quot;&gt;&amp;#91;b3.c8,b3.c9,b3.c5,b3.c6,bvw.c5,bvw.c1,bvw.c2,bvw.c3,bvw.c4&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;So the transitive closure code does not think that bvw.c5 and bvw.c1 refer to the same&lt;br/&gt;
column, and thus does not &quot;close&quot; the two predicates together.&lt;/p&gt;</comment>
                            <comment id="12487562" author="army" created="Mon, 9 Apr 2007 16:30:00 +0100"  >&lt;p&gt;This investigation and analysis has been fantastic, Bryan.  I don&apos;t have anything to add--it sounds like you&apos;ve nailed down the issue and have a clear statement of the problem.  That&apos;s excellent news.&lt;/p&gt;

&lt;p&gt;I like the regular updates as you make progress--they are very helpful and also demonstrate the kind of steps developers in general can take to track down problems like this.  Thanks a ton for your continued work on this!&lt;/p&gt;</comment>
                            <comment id="12487670" author="bryanpendleton" created="Tue, 10 Apr 2007 02:57:28 +0100"  >&lt;p&gt;Thanks much for the encouragement and kind words Army! They are much appreciated.&lt;/p&gt;

&lt;p&gt;My observation for tonight is as follows:&lt;/p&gt;

&lt;p&gt;&lt;b&gt;First&lt;/b&gt;, we have the following:&lt;br/&gt;
  CursorNode.bindStatement calls&lt;br/&gt;
    SelectNode.bindResultColumns calls&lt;br/&gt;
      FromList.bindResultColumns calls&lt;br/&gt;
        JoinNode.bindResultColumns calls&lt;br/&gt;
          JoinNode.deferredBindExpressions&lt;/p&gt;

&lt;p&gt;Then, &lt;b&gt;later&lt;/b&gt;, we have:&lt;br/&gt;
  CursorNode.optimizeStatement calls&lt;br/&gt;
    DMLStatementNode.optimizeStatement calls&lt;br/&gt;
      SelectNode.preprocess calls&lt;br/&gt;
        SelectNode.performTransitiveClosure calls&lt;br/&gt;
          PredicateList.joinClauseTransitiveClosure&lt;/p&gt;

&lt;p&gt;I&apos;m wondering whether it would be possible to move the call&lt;br/&gt;
to SelectNode.performTransitiveClosure out of SelectNode.preprocess&lt;br/&gt;
and into the very start of SelectNode.bindResultColumns.&lt;/p&gt;

&lt;p&gt;That is, do the transitive closure processing earlier, during&lt;br/&gt;
bind processing, rather than at the start of optimizing the statement.&lt;/p&gt;

&lt;p&gt;I&apos;ll give this a try and see what my results are...&lt;/p&gt;</comment>
                            <comment id="12487782" author="bryanpendleton" created="Tue, 10 Apr 2007 15:30:29 +0100"  >&lt;p&gt;Moving the transitive closure processing earlier fixes this test case, so that&lt;br/&gt;
seems promising. I tried running the entire test suite and got about a&lt;br/&gt;
dozen test failures:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;lang/grantRevokeDDL.sql&lt;/li&gt;
	&lt;li&gt;lang/outerjoin.sql&lt;/li&gt;
	&lt;li&gt;lang/subqueryFlattening.sql&lt;/li&gt;
	&lt;li&gt;lang/wisconsin.java&lt;/li&gt;
	&lt;li&gt;lang/GroupByExpressionTest&lt;/li&gt;
	&lt;li&gt;lang/DistinctTest&lt;/li&gt;
	&lt;li&gt;derbynet/csPrepStmt.java&lt;/li&gt;
	&lt;li&gt;derbynet/testconnection.java&lt;/li&gt;
	&lt;li&gt;SecurityPolicyReloadingTest&lt;/li&gt;
	&lt;li&gt;lang/UpdateCursorTest&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;m not sure that all of these are related to this change, but the &quot;lang&quot; suite&lt;br/&gt;
failures are definitely connected.&lt;/p&gt;

&lt;p&gt;Still, the overall results seem promising, so I think I shall analyze the&lt;br/&gt;
test differences in more detail and try to understand how the change&lt;br/&gt;
provoked those failures.&lt;/p&gt;

&lt;p&gt;I&apos;ll attach this first try patch to share the ideas. It is not for commit.&lt;/p&gt;</comment>
                            <comment id="12487784" author="bryanpendleton" created="Tue, 10 Apr 2007 15:35:03 +0100"  >&lt;p&gt;I see the csPrepStmt test was just changed, so I think I can probably&lt;br/&gt;
remove that from the list of problems caused by my change. I&apos;ll focus&lt;br/&gt;
on the lang suite test diffs to start.&lt;/p&gt;</comment>
                            <comment id="12488220" author="bryanpendleton" created="Wed, 11 Apr 2007 23:57:07 +0100"  >&lt;p&gt;Thanks Myrna for helping me sort out those test failures somewhat. Now I think I am down to:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;lang/outerjoin.sql&lt;/li&gt;
	&lt;li&gt;lang/subqueryFlattening.sql&lt;/li&gt;
	&lt;li&gt;lang/wisconsin.java&lt;/li&gt;
	&lt;li&gt;lang/DistinctTest&lt;/li&gt;
	&lt;li&gt;lang/UpdateCursorTest&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The first 3 tests contain query plans in their output, and the query plans have changed&lt;br/&gt;
as a result of my patch. This requires some study, but it is possible that the new results&lt;br/&gt;
are correct.&lt;/p&gt;

&lt;p&gt;DistinctTest and UpdateCursorTest appear to be getting assertion failures.&lt;/p&gt;

&lt;p&gt;I&apos;ll continue to study these failures and see what I can learn.&lt;/p&gt;</comment>
                            <comment id="12488526" author="bryanpendleton" created="Fri, 13 Apr 2007 00:14:15 +0100"  >&lt;p&gt;I analyzed the DistinctTest failure in more detail, and wrote up my notes in the attached &apos;DistinctTestNotes.txt&apos;. I&apos;m still not yet sure whether this test failure indicates a problem in my proposed patch, or a weakness in the test.&lt;/p&gt;</comment>
                            <comment id="12488531" author="bryanpendleton" created="Fri, 13 Apr 2007 00:22:22 +0100"  >&lt;p&gt;The UpdateCursorTest failure appears to be in a test (testVirtualMemoryHeap) which is intimately tied to a particular query execution plan, but I&apos;m not sure how the test is forcing that particular query plan to be chosen. I sent a message about that test to the derby-dev list to see if I could get some help.&lt;/p&gt;</comment>
                            <comment id="12488534" author="army" created="Fri, 13 Apr 2007 00:31:37 +0100"  >&lt;p&gt;Just a knee-jerk reaction to the DistinctTest failure: I wonder if the transitive closure is leading to alteration or removal of predicates that break the conditions described here:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://db.apache.org/derby/docs/dev/tuning/ctuntransform16279.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.apache.org/derby/docs/dev/tuning/ctuntransform16279.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For example, there is some talk about how Derby will remove equijoin predicates as part of transitive closure at the bottom of this page:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://db.apache.org/derby/docs/dev/tuning/rtuntransform866587.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.apache.org/derby/docs/dev/tuning/rtuntransform866587.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Maybe one of the equijoin predicates that is removed breaks the condition for DISTINCT elimination?&lt;/p&gt;

&lt;p&gt;As I said, that&apos;s just knee-jerk feedback.  Apologies if it proves irrelevant...&lt;/p&gt;</comment>
                            <comment id="12488535" author="bryanpendleton" created="Fri, 13 Apr 2007 00:39:53 +0100"  >&lt;p&gt;It&apos;s interesting that in all three of the outerjoin.sql, subqueryFlattening, andDistinctTest&lt;br/&gt;
test failures, the queries that get different query plans have some similarities: for one&lt;br/&gt;
thing,  the failed query involves a case where there is both a join condition&lt;br/&gt;
and a simple restriction condition on the same column.&lt;/p&gt;

&lt;p&gt;Here&apos;s the query from outerjoin.sql which gets a different query plan with the patch:&lt;/p&gt;

&lt;p&gt;select * from tt1 left outer join tt2 on tt1.c1 = tt2.c2 where tt2.c2 = 3&lt;/p&gt;

&lt;p&gt;And here&apos;s the query from DistinctTest.java which gets a different query plan with&lt;br/&gt;
the patch:&lt;/p&gt;

&lt;p&gt;select distinct a.c1 from two a, four b where a.c1 = b.c1 and a.c3 = b.c3 and b.c3 = 1;&lt;/p&gt;

&lt;p&gt;And here&apos;s the query from subqueryFlattening.sql which gets a different query&lt;br/&gt;
plan with the patch:&lt;/p&gt;

&lt;p&gt;select * from outer1 o where exists (select * from idx2 i, idx1 where o.c1 = i.c1 and i.c2 = idx1.c1 and i.c2 = 1)&lt;/p&gt;

&lt;p&gt;Note that in all 3 cases, the column that is being compared against a constant value&lt;br/&gt;
is also part of the join criteria.&lt;/p&gt;

&lt;p&gt;I thought that the transitive closure processing was only looking at join conditions,&lt;br/&gt;
not at simple restriction conditions (&quot;tt2.c2 = 3&quot;), but perhaps I was wrong.&lt;/p&gt;</comment>
                            <comment id="12488537" author="army" created="Fri, 13 Apr 2007 00:45:41 +0100"  >&lt;p&gt;&amp;gt; I thought that the transitive closure processing was only looking at join conditions,&lt;br/&gt;
&amp;gt; not at simple restriction conditions (&quot;tt2.c2 = 3&quot;), but perhaps I was wrong.&lt;/p&gt;

&lt;p&gt;There are two types of transitive closure:&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;http://db.apache.org/derby/docs/dev/tuning/ctuntransform37032.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.apache.org/derby/docs/dev/tuning/ctuntransform37032.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The first is join conditions, as you&apos;ve noticed.  The second is &quot;search conditions&quot; and does indeed take into account predicates like &quot;tt2.c2 = 3&quot;, so maybe this is why you are seeing the different plans?&lt;/p&gt;</comment>
                            <comment id="12488676" author="bryanpendleton" created="Fri, 13 Apr 2007 15:19:00 +0100"  >&lt;p&gt;Thanks Army and Oystein for the help! The status now seems to be that:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the UpdateCursor test is unrelated&lt;/li&gt;
	&lt;li&gt;the other 4 failures all have the property that&lt;/li&gt;
	&lt;li&gt;with the patch, we get the right results for all the queries in the test suite&lt;/li&gt;
	&lt;li&gt;but some of the query plans have changed&lt;br/&gt;
I will study the docs that Army noted, and look closely into the query plans&lt;br/&gt;
before and after the patch, and see what I can learn.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12492516" author="bryanpendleton" created="Sat, 28 Apr 2007 21:40:07 +0100"  >&lt;p&gt;My firstTryPatch is just flat-out wrong. The patch attempted to fix the problem by&lt;br/&gt;
move the transitive closure processing from SelectNode.preprocess to&lt;br/&gt;
SelectNode.bindResultColumns. However, the transitive closure processing&lt;br/&gt;
tries to process the predicates in the predicate list held in SelectNode.wherePredicates,&lt;br/&gt;
and that field isn&apos;t set up until mid-way through SelectNode.preprocess, by the code:&lt;/p&gt;

&lt;p&gt;        /* Pull apart the expression trees */&lt;br/&gt;
        if (whereClause != null)&lt;/p&gt;
        {
            wherePredicates.pullExpressions(numTables, whereClause);
            whereClause = null;
        }

&lt;p&gt;So until that code has been run, we can&apos;t do the transitive closure processing.&lt;/p&gt;

&lt;p&gt;Now I am contemplating three alternate ideas:&lt;/p&gt;

&lt;p&gt;1) move the code which pulls the expressions out of the whereClause into&lt;br/&gt;
the wherePredicates list into SelectNode.bindResultColumns, though&lt;br/&gt;
that seems increasingly risky to me.&lt;br/&gt;
2) delay the call to JoinNode.deferredBindExpressions, which is where&lt;br/&gt;
the column renumbering is done, until after the transitive closure work&lt;br/&gt;
has occurred (that is, instead of moving transitive closure processing earlier,&lt;br/&gt;
move column renumbering later)&lt;br/&gt;
3) rework the code in the transitive closure processing so that it isn&apos;t&lt;br/&gt;
confused by the column renumbering, presumably by working with the&lt;br/&gt;
original column references, not by the renumbered bound references.&lt;/p&gt;

&lt;p&gt;So, it&apos;s somewhat back to the drawing board, but at least I understand&lt;br/&gt;
why the original patch proposal failed, which is good progress.&lt;/p&gt;</comment>
                            <comment id="12492523" author="bryanpendleton" created="Sat, 28 Apr 2007 23:57:14 +0100"  >&lt;p&gt;I tried various experiments toward alternates #1 and #2 from the previous&lt;br/&gt;
comment, and only succeeding in creating non-operational code. These&lt;br/&gt;
sections of the SelectNode code seem delicate, and the code can&apos;t &lt;br/&gt;
be re-arranged easily; it all seems to work in exactly this order.&lt;/p&gt;

&lt;p&gt;Now I&apos;m thinking I should investigate the transitive closure code more&lt;br/&gt;
carefully, to see if there is a way to revise it so that it isn&apos;t so sensitive&lt;br/&gt;
to the column re-ordering but rather can recognize transitive closures&lt;br/&gt;
based on the original expressions.&lt;/p&gt;</comment>
                            <comment id="12498861" author="army" created="Thu, 24 May 2007 23:02:28 +0100"  >&lt;p&gt;&amp;gt; Now I&apos;m thinking I should investigate the transitive closure code more carefully, to see&lt;br/&gt;
&amp;gt; if there is a way to revise it so that it isn&apos;t so sensitive to the column re-ordering ...&lt;/p&gt;

&lt;p&gt;Hi Bryan, I noticed that it&apos;s been a while since you posted anything to this issue.  Are you still actively looking into this one?  Have you had any luck with your attempts to revise the transitive closure code?&lt;/p&gt;</comment>
                            <comment id="12499249" author="army" created="Fri, 25 May 2007 23:49:42 +0100"  >&lt;p&gt;I started looking at this issue and, using Bryan&apos;s excellent analysis of the problem thus far, was able to track down what I believe is the underlying cause.  After reading all of Bryan&apos;s comments (thanks Bryan!), I found myself wondering why it was that &quot;bvw2.c1&quot; in the predicate &quot;bvw2.c1 = b4.c7&quot; had a column number w.r.t to the JoinNode while &quot;bvw.c5&quot; in the predicate &quot;b3.c8 = bvw2.c5&quot; had a column number w.r.t to the view (BVW) itself.  Given that both column references have the same tableNumber (by the time we get to transitive closure computation), I was expecting that their column numbers would be w.r.t to the same object--i.e. to &quot;BVW&quot;.  But that did not appear to be the case (as Bryan discovered).&lt;/p&gt;

&lt;p&gt;So I did some tracing through the &quot;preprocess()&quot; code and was able to come up with what I think is a reasonable explanation of the problem.  It also agrees with (and builds on) all of Bryan&apos;s previous findings (I think).  I&apos;m attaching the writeup as &quot;d2526_v1.html&quot;.&lt;/p&gt;

&lt;p&gt;If this explanation is correct, the fix is a two-liner--which I&apos;m attaching as d2526_v1.patch.  I ran derbyall and suites.All with this change and there were no failures.  I also verified that both of the queries in derby-2526 now return the same result (1 row).  I have not added any tests for this problem yet, as I&apos;m just looking for validation of the explanation and proposed fix from anyone who might have the time to read it over.  The fact that derbyall/suites.All both ran cleanly is encouraging.&lt;/p&gt;

&lt;p&gt;Many many thanks again to Bryan for all of his effort and analysis.  Regardless of whether or not the attached writeup is an accurate assessment of the problem, Bryan&apos;s comments have been very helpful.&lt;/p&gt;</comment>
                            <comment id="12499257" author="army" created="Sat, 26 May 2007 00:45:04 +0100"  >&lt;p&gt;Re-attaching with the intended file name (as indicated in previous comment) and with some minor corrections to section II.  Sorry for the noise.&lt;/p&gt;</comment>
                            <comment id="12499272" author="bryanpendleton" created="Sat, 26 May 2007 03:19:58 +0100"  >&lt;p&gt;Army, thank you very much! Your description is very clear. It describes exactly the behavior that I was seeing, and your analysis of the remapping feels spot-on. I agree with your fix, and your patch fixes the problem in my environment, too.&lt;/p&gt;

&lt;p&gt;Nothing like having another pair of eyes on things! Very good work.&lt;/p&gt;

&lt;p&gt;I re-assigned the issue to you, assuming that you&apos;ll take it the rest of the way at this point. Is that OK?&lt;/p&gt;</comment>
                            <comment id="12499958" author="army" created="Wed, 30 May 2007 00:06:28 +0100"  >&lt;p&gt;Thank you for reading the write-up and verifying the fix, Bryan.  I&apos;m attaching a second version of the patch, d2526_v2.patch, which adds some relevant test cases to the lang/joins.sql test.  That test is already run as part of JUnit via the lang.LangScripts class, so no additional JUnit work is required (I don&apos;t think).&lt;/p&gt;

&lt;p&gt;I re-ran derbyall and suites.All on SUSE Linux with ibm142 as a sanity check, and everything passed.  I also verified that if the engine change is backed out, lang/joins.sql will now fail due to incorrect results.&lt;/p&gt;

&lt;p&gt;Thanks again to Bryan for his extensive analysis of the problem.  The _v2 patch is, I think, ready for commit.&lt;/p&gt;</comment>
                            <comment id="12499990" author="bryanpendleton" created="Wed, 30 May 2007 01:43:43 +0100"  >&lt;p&gt;Patch2 looks great! The test cases are clear and make sense to me.&lt;br/&gt;
The patch applies without problems and ran as expected: failed without&lt;br/&gt;
the code change, and passes with it. +1 for commit from me.&lt;/p&gt;</comment>
                            <comment id="12500190" author="army" created="Wed, 30 May 2007 17:42:19 +0100"  >&lt;p&gt;Thanks, as always, for your willingness to review, Bryan.  I committed the _v2 patch with svn # 542867:&lt;/p&gt;

&lt;p&gt;  URL: &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=542867&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=542867&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Marking issue as resolved for 10.3, though I think it still needs a release note...&lt;/p&gt;</comment>
                            <comment id="12501744" author="army" created="Wed, 6 Jun 2007 00:44:51 +0100"  >&lt;p&gt;Attaching a release note for this issue.&lt;/p&gt;</comment>
                            <comment id="12501745" author="army" created="Wed, 6 Jun 2007 00:46:01 +0100"  >&lt;p&gt;Changing summary to more accurately reflect the problem as described in d2526_v1.html.&lt;/p&gt;</comment>
                            <comment id="12501788" author="bryanpendleton" created="Wed, 6 Jun 2007 05:30:09 +0100"  >&lt;p&gt;Release note looks great! Thanks.&lt;/p&gt;</comment>
                            <comment id="12501991" author="army" created="Wed, 6 Jun 2007 18:06:22 +0100"  >&lt;p&gt;Thank you for looking at the release note, Bryan.  I think that&apos;s the last of the work for this issue, so I&apos;m marking it as closed.&lt;/p&gt;</comment>
                            <comment id="12505547" author="myrna" created="Sat, 16 Jun 2007 23:06:24 +0100"  >&lt;p&gt;scrubbed releasenote&lt;/p&gt;</comment>
                            <comment id="12631978" author="kmarsden" created="Wed, 17 Sep 2008 23:22:34 +0100"  >&lt;p&gt;A user hit this bug in 10.1 but the symptom was different. Instead of wrong results, they got a message: The repro is attached as TestDerby.java&lt;br/&gt;
Exception in thread &quot;main&quot; ERROR 42818: Comparisons between &lt;br/&gt;
&apos;CHAR () FOR BIT DATA&apos; and &apos;CHAR&apos; are not supported.&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.iapi.error.StandardException.newException(Unkno&lt;br/&gt;
wn Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.sql.compile.BinaryComparisonOperatorNode.b&lt;br/&gt;
indComparisonOperator&lt;br/&gt;
(Unknown Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.sql.compile.PredicateList.searchClauseTran&lt;br/&gt;
sitiveClosure(Unknown&lt;br/&gt;
 Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.sql.compile.SelectNode.performTransitiveCl&lt;br/&gt;
osure(Unknown Source)&lt;/p&gt;

&lt;p&gt;        at &lt;br/&gt;
org.apache.derby.impl.sql.compile.SelectNode.preprocess(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.sql.compile.DMLStatementNode.optimize(Unkn&lt;br/&gt;
own Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.sql.compile.CursorNode.optimize(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.sql.GenericStatement.prepare(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.&lt;br/&gt;
prepareInternalStatem&lt;br/&gt;
ent(Unknown Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
        at &lt;br/&gt;
org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown &lt;br/&gt;
Source)&lt;/p&gt;

&lt;p&gt;I&apos;ll look into backporting this fix to 10.2 and 10.1&lt;/p&gt;</comment>
                            <comment id="12632272" author="army" created="Thu, 18 Sep 2008 17:18:17 +0100"  >&lt;p&gt;&amp;gt; I&apos;ll look into backporting this fix to 10.2 and 10.1&lt;/p&gt;

&lt;p&gt;For what it&apos;s worth, there was another bug in a similar area that also affected 10.1 and 10.2, namely, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3023&quot; title=&quot;Different result rows depending on the sequence of INNER JOIN and OUTER JOIN&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3023&quot;&gt;&lt;del&gt;DERBY-3023&lt;/del&gt;&lt;/a&gt;.  One of the comments for that issue includes the following quote:&lt;/p&gt;

&lt;p&gt;  &quot;It turns out that the introduction of these invalid predicates stems from a problem that is almost&lt;br/&gt;
  identical to the one described in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2526&quot; title=&quot;Wrong results with queries that use the JOIN ... ON syntax to join with views or other non-base table expressions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2526&quot;&gt;&lt;del&gt;DERBY-2526&lt;/del&gt;&lt;/a&gt;. For details please see d2526_v1.html as attached&lt;br/&gt;
  to that issue, since pretty much everything in that document applies to this issue, as well.&quot;&lt;/p&gt;

&lt;p&gt;So I wonder if it&apos;d be worth it to port &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3023&quot; title=&quot;Different result rows depending on the sequence of INNER JOIN and OUTER JOIN&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3023&quot;&gt;&lt;del&gt;DERBY-3023&lt;/del&gt;&lt;/a&gt; back, as well?  I don&apos;t feel strongly about it, I just figured I&apos;d mention it in case you were interested...&lt;/p&gt;</comment>
                            <comment id="12632291" author="kmarsden" created="Thu, 18 Sep 2008 17:52:20 +0100"  >&lt;p&gt;Thanks Army. I&apos;ll look into backporting &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3023&quot; title=&quot;Different result rows depending on the sequence of INNER JOIN and OUTER JOIN&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3023&quot;&gt;&lt;del&gt;DERBY-3023&lt;/del&gt;&lt;/a&gt; as well.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12354628">DERBY-2034</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12465506">DERBY-4679</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12608438">DERBY-5933</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12466382">DERBY-4695</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12376689">DERBY-3023</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12355470" name="DistinctTestNotes.txt" size="2589" author="bryanpendleton" created="Fri, 13 Apr 2007 00:14:15 +0100"/>
                            <attachment id="12390312" name="TestDerby.java" size="12368" author="kmarsden" created="Wed, 17 Sep 2008 23:22:34 +0100"/>
                            <attachment id="12354972" name="badQuery.log" size="5185" author="bryanpendleton" created="Thu, 5 Apr 2007 02:52:10 +0100"/>
                            <attachment id="12358291" name="d2526_v1.html" size="19011" author="army" created="Sat, 26 May 2007 00:45:04 +0100"/>
                            <attachment id="12358287" name="d2526_v1.patch" size="1550" author="army" created="Fri, 25 May 2007 23:49:42 +0100"/>
                            <attachment id="12358486" name="d2526_v2.patch" size="8779" author="army" created="Wed, 30 May 2007 00:06:28 +0100"/>
                            <attachment id="12358487" name="d2526_v2.stat" size="231" author="army" created="Wed, 30 May 2007 00:06:28 +0100"/>
                            <attachment id="12354961" name="derby-2526.sql" size="943" author="bryanpendleton" created="Thu, 5 Apr 2007 00:24:51 +0100"/>
                            <attachment id="12355250" name="firstTryPatch.diff" size="1228" author="bryanpendleton" created="Tue, 10 Apr 2007 15:30:29 +0100"/>
                            <attachment id="12354971" name="goodQuery.log" size="6835" author="bryanpendleton" created="Thu, 5 Apr 2007 02:52:10 +0100"/>
                            <attachment id="12359944" name="releaseNote.html" size="4310" author="myrna" created="Sat, 16 Jun 2007 23:06:24 +0100"/>
                            <attachment id="12359005" name="releaseNote.html" size="4587" author="army" created="Wed, 6 Jun 2007 00:44:51 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 6 Apr 2007 15:33:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23086</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10101"><![CDATA[Release Note Needed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy09o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35385</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>