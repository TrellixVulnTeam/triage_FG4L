<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:12:00 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5440/DERBY-5440.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5440] test failure in testBTreeForwardScan_fetchRows_resumeAfterWait_nonUnique_split(org.apache.derbyTesting.functionTests.tests.store.IndexSplitDeadlockTest)junit.framework.AssertionFailedError: expected:&lt;1&gt; but was:&lt;0&gt;</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5440</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;During the QA Cycle for 10.8.2.1 I also ran on a next version of the iseries OS, and saw this failure. It did not reproduce when I reran the test by itself. The test has the following comment:&lt;br/&gt;
       // Give the other thread time to obtain the lock&lt;br/&gt;
        Thread.sleep(1000);&lt;/p&gt;

&lt;p&gt;        // Perform an index scan. Will be blocked for a while when fetching&lt;br/&gt;
        // the row where x=100, but should be able to resume the scan.&lt;br/&gt;
        ResultSet rs = s.executeQuery(&lt;br/&gt;
                &quot;select * from t --DERBY-PROPERTIES index=IDX&quot;);&lt;br/&gt;
        for (int i = 0; i &amp;lt; 300; i++) &lt;/p&gt;
{
            assertTrue(rs.next());
            assertEquals(i, rs.getInt(1));                           &amp;lt;==== this is the line of the failure.
        }

&lt;p&gt;I think this is a rather slow machine, and that&apos;s likely why I saw the failure, perhaps the sleep wasn&apos;t long enough on this machine.&lt;br/&gt;
Here is the stack trace:&lt;/p&gt;

&lt;p&gt;1) testBTreeForwardScan_fetchRows_resumeAfterWait_nonUnique_split(org.apache.derbyTesting.functionTests.tests.store.IndexSplitDeadlockTest)junit.framework.AssertionFailedError: expected:&amp;lt;1&amp;gt; but was:&amp;lt;0&amp;gt;&lt;br/&gt;
	at java.lang.Throwable.&amp;lt;init&amp;gt;(Throwable.java:195)&lt;br/&gt;
	at java.lang.Error.&amp;lt;init&amp;gt;(Error.java:49)&lt;br/&gt;
	at junit.framework.AssertionFailedError.&amp;lt;init&amp;gt;(AssertionFailedError.java:13)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.store.IndexSplitDeadlockTest.testBTreeForwardScan_fetchRows_resumeAfterWait_nonUnique_split(IndexSplitDeadlockTest.java:526)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:27)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:92)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;

&lt;p&gt;derby.log has no useful info.&lt;/p&gt;</description>
                <environment>IBM iseries 6.1, Classic 1.6 JVM</environment>
        <key id="12525358">DERBY-5440</key>
            <summary>test failure in testBTreeForwardScan_fetchRows_resumeAfterWait_nonUnique_split(org.apache.derbyTesting.functionTests.tests.store.IndexSplitDeadlockTest)junit.framework.AssertionFailedError: expected:&lt;1&gt; but was:&lt;0&gt;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="myrna">Myrna van Lunteren</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Sep 2011 20:43:55 +0100</created>
                <updated>Fri, 15 Nov 2013 08:15:07 +0000</updated>
                            <resolved>Tue, 11 Oct 2011 13:57:02 +0100</resolved>
                                    <version>10.8.2.2</version>
                                    <fixVersion>10.8.3.0</fixVersion>
                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13123758" author="knutanders" created="Sun, 9 Oct 2011 20:26:55 +0100"  >&lt;p&gt;Looks similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5278&quot; title=&quot;AssertionFailedError in IndexSplitDeadlockTest.testBTreeForwardScan_fetchRows_resumeAfterWait_unique_split()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5278&quot;&gt;&lt;del&gt;DERBY-5278&lt;/del&gt;&lt;/a&gt;, except it&apos;s in another test method. Probably a similar solution is needed for this test method.&lt;/p&gt;</comment>
                            <comment id="13123762" author="knutanders" created="Sun, 9 Oct 2011 20:45:55 +0100"  >&lt;p&gt;The attached patch changes the test case in a way similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5278&quot; title=&quot;AssertionFailedError in IndexSplitDeadlockTest.testBTreeForwardScan_fetchRows_resumeAfterWait_unique_split()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5278&quot;&gt;&lt;del&gt;DERBY-5278&lt;/del&gt;&lt;/a&gt; to provide better synchronization between the main test thread and the helper thread. It adds a barrier to ensure that the main thread has started the index scan before the helper thread inserts new rows at the beginning of the index (the problem in this bug seems to be that the rows have been inserted before the scan started, and they unexpectedly show up in the scan result).&lt;/p&gt;

&lt;p&gt;A helper class called Barrier is introduced (java.util.concurrent.CyclicBarrier provides the same functionality, but cannot be used since it requires Java 5), and the patch rewrites the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5278&quot; title=&quot;AssertionFailedError in IndexSplitDeadlockTest.testBTreeForwardScan_fetchRows_resumeAfterWait_unique_split()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5278&quot;&gt;&lt;del&gt;DERBY-5278&lt;/del&gt;&lt;/a&gt; to use the new helper class too.&lt;/p&gt;</comment>
                            <comment id="13124985" author="knutanders" created="Tue, 11 Oct 2011 13:46:53 +0100"  >&lt;p&gt;Attaching an updated version of the patch. It improves some of the comments, and also moves the barrier from right before the index scan has started to the point where the first row has been read from the index. By moving the barrier to that point, we can be absolutely sure that the first row has been seen before the helper thread starts inserting more rows at the beginning of the index (protects against the unlikely event that the first rs.next() call takes more than a second).&lt;/p&gt;</comment>
                            <comment id="13124996" author="knutanders" created="Tue, 11 Oct 2011 13:57:02 +0100"  >&lt;p&gt;Committed to trunk with revision 1181756.&lt;br/&gt;
Committed to 10.8 with revision 1181761.&lt;/p&gt;</comment>
                            <comment id="13823389" author="knutanders" created="Fri, 15 Nov 2013 08:15:07 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update: close all resolved issues that haven&amp;#39;t had any activity the last year&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12510436">DERBY-5278</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12498588" name="d5440-2.diff" size="8519" author="knutanders" created="Tue, 11 Oct 2011 13:46:53 +0100"/>
                            <attachment id="12498366" name="d5440.diff" size="7693" author="knutanders" created="Sun, 9 Oct 2011 20:45:55 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 9 Oct 2011 19:26:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41608</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0f2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36260</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>