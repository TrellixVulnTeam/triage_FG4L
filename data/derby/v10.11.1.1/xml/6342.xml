<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:32 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6342/DERBY-6342.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6342] failure in testConstraintDrops(org.apache.derbyTesting.functionTests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint...</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6342</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Don&apos;t think this failure has been reported before.&lt;/p&gt;

&lt;p&gt;The url for failure is &lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/weme6.2/1520721-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/weme6.2/1520721-suites.All_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;1) testConstraintDrops(org.apache.derbyTesting.functionTests.tests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint &apos;DROPC_UIX2&apos; but &apos;DROPC_UIX2&apos; did not appear in the following error message: &quot;The statement was aborted because it would have caused a duplicate key value in a unique or primary key constraint or unique index identified by &apos;DROPC_UC1&apos; defined on &apos;DROPC_T2&apos;.&quot;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.ConglomerateSharingTest.checkStatementError(ConglomerateSharingTest.java:762)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.ConglomerateSharingTest.testConstraintDrops(ConglomerateSharingTest.java:272)&lt;br/&gt;
	at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:195)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:117)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBareOverridable(BaseJDBCTestCase.java:442)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBare(BaseJDBCTestCase.java:459)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;</description>
                <environment>weme6.2 Windows Server 2008 - x86 - 6.1 build 7601 Service Pack 1&lt;br/&gt;
Windows machine</environment>
        <key id="12667638">DERBY-6342</key>
            <summary>failure in testConstraintDrops(org.apache.derbyTesting.functionTests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint...</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="mamtas">Mamta A. Satoor</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Sep 2013 19:33:30 +0100</created>
                <updated>Fri, 3 Oct 2014 20:35:45 +0100</updated>
                            <resolved>Fri, 3 Oct 2014 20:35:45 +0100</resolved>
                                    <version>10.10.2.0</version>
                                    <fixVersion>10.10.2.1</fixVersion>
                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="13908271" author="rhillegas" created="Fri, 21 Feb 2014 13:01:18 +0000"  >&lt;p&gt;Similar stack trace seen on 10.11 trunk on windows_amd64_jdk8. See &lt;a href=&quot;http://download.java.net/javadesktop/derby/request_5587843/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.java.net/javadesktop/derby/request_5587843/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13962344" author="myrna" created="Mon, 7 Apr 2014 23:36:16 +0100"  >&lt;p&gt;I saw this happen, also with jdk 1.8, on windows 2008 (on vmware), with trunk 10.11.0.0 alpha - (1585371), but the error looks slightly different:&lt;br/&gt;
1) testConstraintDrops(org.apache.derbyTesting.functionTests.tests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint &apos;DROPC_UIX2&apos; but &apos;DROPC_UIX2&apos; did not appear in the following error message: &quot;The statement was aborted because it would have caused a duplicate key value in a unique or primary key constraint or unique index identified by &apos;DROPC_FK2&apos; defined on &apos;DROPC_T2&apos;.&quot;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.ConglomerateSharingTest.checkStatementError(ConglomerateSharingTest.java:762)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.ConglomerateSharingTest.testConstraintDrops(ConglomerateSharingTest.java:272)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:118)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBareOverridable(BaseJDBCTestCase.java:440)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBare(BaseJDBCTestCase.java:457)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57&lt;/p&gt;</comment>
                            <comment id="14020311" author="mamtas" created="Fri, 6 Jun 2014 21:17:10 +0100"  >&lt;p&gt;Test failed with jdk 1.5, on windows 2008 machine with trunk 10.10.2.1(1597921)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm15/1597921-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm15/1597921-suites.All_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;testConstraintDrops(org.apache.derbyTesting.functionTests.tests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint &apos;DROPC_UIX2&apos; but &apos;DROPC_UIX2&apos; did not appear in the following error message: &quot;The statement was aborted because it would have caused a duplicate key value in a unique or primary key constraint or unique index identified by &apos;DROPC_UC1&apos; defined on &apos;DROPC_T2&apos;.&quot;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.ConglomerateSharingTest.checkStatementError(ConglomerateSharingTest.java:762)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.ConglomerateSharingTest.testConstraintDrops(ConglomerateSharingTest.java:272)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:79)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:118)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBareOverridable(BaseJDBCTestCase.java:442)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBare(BaseJDBCTestCase.java:459)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;</comment>
                            <comment id="14042019" author="rhillegas" created="Tue, 24 Jun 2014 13:01:18 +0100"  >&lt;p&gt;Happened during last night&apos;s test run on Windows_amd64_jdk8 on the head of the 10.11.1 trunk: &lt;a href=&quot;http://download.java.net/javadesktop/derby/request_5593027/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.java.net/javadesktop/derby/request_5593027/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14052429" author="dagw" created="Fri, 4 Jul 2014 14:02:55 +0100"  >&lt;p&gt;And again last night (on trunk): &lt;a href=&quot;http://download.java.net/javadesktop/derby/request_5593567/javadb-task-3897851.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.java.net/javadesktop/derby/request_5593567/javadb-task-3897851.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14053578" author="rhillegas" created="Mon, 7 Jul 2014 13:06:15 +0100"  >&lt;p&gt;Note that the 2014-07-03 failure was on platform Windows_amd64_jdk9.&lt;/p&gt;</comment>
                            <comment id="14053673" author="knutanders" created="Mon, 7 Jul 2014 15:01:17 +0100"  >&lt;p&gt;The failing insert statement seems to violate two constraints: DROPC_UIX2 (unique index on column C) and DROPC_UC1 (unique constraint on column C). The test expects it to fail because of the violation of the unique index, but I don&apos;t think that&apos;s guaranteed.&lt;/p&gt;

&lt;p&gt;As far as I can see, InsertResultSet inserts the row into each backing index in the order that they are returned by TableDescriptor.getConglomerateDescriptors(), and the error message will contain the name of the first index that reports a violation. The table descriptor gets the conglomerate descriptors from DataDictionaryImpl.getConglomerateDescriptorsScan(), which uses the index identified by SYSCONGLOMERATES_INDEX3_ID. That index has only one key column: TABLEID. This means the order of a specific table&apos;s indexes is undefined, which would explain why the error message could vary.&lt;/p&gt;

&lt;p&gt;The error Myrna reported on 08/Apr/14, mentions another constraint: DROPC_FK2 (a foreign key on C). Although the insert statement doesn&apos;t violate the foreign key, the backing index of the foreign key is probably a unique index because the column C is unique. I think this error could happen if DataDictionaryImpl.getConglomerateDescriptorsScan() sees DROPC_FK2 before DROPC_UIX2 and DROPC_UC1.&lt;/p&gt;</comment>
                            <comment id="14058725" author="knutanders" created="Fri, 11 Jul 2014 13:48:20 +0100"  >&lt;p&gt;The attached patch &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12655204/12655204_d6342-1a.diff&quot; title=&quot;d6342-1a.diff attached to DERBY-6342&quot;&gt;d6342-1a.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; makes the asserts accept more than one constraint in the cases where it&apos;s not deterministic which constraint will be mentioned in the error message. I haven&apos;t been able to reproduce the original failure, but I believe this patch will fix it.&lt;/p&gt;</comment>
                            <comment id="14060495" author="jira-bot" created="Mon, 14 Jul 2014 10:58:55 +0100"  >&lt;p&gt;Commit 1610373 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1610373&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1610373&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6342&quot; title=&quot;failure in testConstraintDrops(org.apache.derbyTesting.functionTests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint...&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6342&quot;&gt;&lt;del&gt;DERBY-6342&lt;/del&gt;&lt;/a&gt;: failure in ConglomerateSharingTest.testConstraintDrops&lt;/p&gt;

&lt;p&gt;Accept different errors from statements that violate multiple&lt;br/&gt;
constraints, since it&apos;s not deterministic which constraint is checked&lt;br/&gt;
first.&lt;/p&gt;</comment>
                            <comment id="14157105" author="myrna" created="Thu, 2 Oct 2014 21:16:14 +0100"  >&lt;p&gt;I saw this in a non-published run with 10.10 (10.10.2.1 - (1628879)) so I&apos;ll see if I can backport this to 10.10.&lt;/p&gt;</comment>
                            <comment id="14157363" author="jira-bot" created="Fri, 3 Oct 2014 00:03:23 +0100"  >&lt;p&gt;Commit 1629097 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/branches/10.10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1629097&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1629097&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6342&quot; title=&quot;failure in testConstraintDrops(org.apache.derbyTesting.functionTests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint...&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6342&quot;&gt;&lt;del&gt;DERBY-6342&lt;/del&gt;&lt;/a&gt;; failure in testConstraintDrops(org.apache.derbyTesting.functionTests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint...&lt;br/&gt;
  backporting revision 16110373 from trunk.&lt;/p&gt;</comment>
                            <comment id="14158133" author="myrna" created="Fri, 3 Oct 2014 17:06:59 +0100"  >&lt;p&gt;Looks like I missed a String.contains reference which caused a failure in the test run with IBM&apos;s j2me implementation:&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/weme6.2/1629105-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/weme6.2/1629105-suites.All_diff.txt&lt;/a&gt;&lt;br/&gt;
I&apos;ll fix that up.&lt;/p&gt;</comment>
                            <comment id="14158410" author="jira-bot" created="Fri, 3 Oct 2014 20:33:20 +0100"  >&lt;p&gt;Commit 1629298 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/branches/10.10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1629298&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1629298&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6342&quot; title=&quot;failure in testConstraintDrops(org.apache.derbyTesting.functionTests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint...&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6342&quot;&gt;&lt;del&gt;DERBY-6342&lt;/del&gt;&lt;/a&gt;; failure in testConstraintDrops(org.apache.derbyTesting.functionTests.lang.ConglomerateSharingTest)junit.framework.AssertionFailedError: Error 23505 should have been caused by index/constraint...&lt;br/&gt;
   adjusting test to use j2me compatible code (String.indexOf()&amp;gt;0 instead of String.contains())&lt;/p&gt;</comment>
                            <comment id="14158418" author="myrna" created="Fri, 3 Oct 2014 20:35:45 +0100"  >&lt;p&gt;Done with backport to 10.10 and adjustment for j2me/cdc-foundation test run. I don&apos;t intend to take this further at this time; resetting to original fix state and assignee.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12655204" name="d6342-1a.diff" size="5669" author="knutanders" created="Fri, 11 Jul 2014 13:48:20 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 21 Feb 2014 13:01:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>347575</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzhs13:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>347874</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>