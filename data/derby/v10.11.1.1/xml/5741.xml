<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:33:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5741/DERBY-5741.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5741] Native user authentication: improve checking of syntax</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5741</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Trying to set derby.authentication.provider to &quot;NATIVE:&quot; correctly gives an error message complaining about the syntax:&lt;/p&gt;

&lt;p&gt;&quot;ERROR XCY05: Invalid setting of the derby.authentication.provider property. This property cannot be set to NATIVE::LOCAL unless credentials for the database owner have been stored in the database using the SYSCS_UTIL.SYSCS_CREATE_USER procedure.&quot;&lt;/p&gt;

&lt;p&gt;Trying to set it as &quot;NATIVE&quot; (no trailing colon) does not treat this the value as a malformed NATIVE authentication specification. This leads to it being interpreted as a used defined authentication class, so when I attempt to connect after disconnection from the database I see:&lt;/p&gt;

&lt;p&gt;ERROR XJ040: Failed to start database &apos;cred&apos; with class loader sun.misc.Launcher$AppClassLoader@18d107f, see the next exception for details.&lt;br/&gt;
ERROR XJ001: Java exception: &apos;NATIVE: java.lang.ClassNotFoundException&apos;.&lt;/p&gt;

&lt;p&gt;Another thing is that the error message in the first place is out of date now: we never shoudl be setting &quot;NATIVE::LOCAL&quot; explicitly, it id does once the first user is created according to version 7.0 of the spec. See &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5742&quot; title=&quot;Native user authentication: improve wording of error message&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5742&quot;&gt;&lt;del&gt;DERBY-5742&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12553759">DERBY-5741</key>
            <summary>Native user authentication: improve checking of syntax</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 May 2012 15:02:23 +0100</created>
                <updated>Fri, 14 Jun 2013 17:46:02 +0100</updated>
                            <resolved>Fri, 14 Jun 2013 17:45:50 +0100</resolved>
                                    <version>10.9.1.0</version>
                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Services</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13267437" author="dagw" created="Thu, 3 May 2012 15:03:50 +0100"  >&lt;p&gt;Uploading a repro.&lt;/p&gt;</comment>
                            <comment id="13267631" author="rhillegas" created="Thu, 3 May 2012 18:53:36 +0100"  >&lt;p&gt;Technically, this behavior is correct although the error message is not helpful. The NATIVE authentication service boots only when the authentication provider begins with NATIVE: (note the trailing colon). The trailing colon unambiguously marks the provider value as something which could not be a legal class name. For backward compatibility reasons, any value of derby.authentication.provider (other than BUILTIN and LDAP) which could be a class name is handed to the user-defined authentication service. The user-defined authentication service attempts to instantiate that class and boot it as the authentication provider.&lt;/p&gt;

&lt;p&gt;One fix to this confusion would be for the user-authentication service to throw a more helpful error message. Maybe a message which says that the value of derby.authentication.provider is not LDAP or BUILTIN, and does not begin with NATIVE:, and does not identify a class which can be reached.&lt;/p&gt;

&lt;p&gt;Would that be satisfactory? Thanks.&lt;/p&gt;</comment>
                            <comment id="13268296" author="dagw" created="Fri, 4 May 2012 13:37:53 +0100"  >&lt;p&gt;Yes, I guess that would cover it. It&apos;s unfortunate that the original syntax for this value didn&apos;t use a keyword for user-defined classes; lesson: API extension should always be considered..&lt;/p&gt;</comment>
                            <comment id="13268633" author="rhillegas" created="Fri, 4 May 2012 20:11:27 +0100"  >&lt;p&gt;Attaching derby-5741-01-aa-percolateDerbyErrorUp.diff. This patch improves the error message seen in this situation. I am running full regression tests now.&lt;/p&gt;

&lt;p&gt;It turns out that the user-supplied authentication service was throwing a more informative error. However, the informative part of that error was swallowed by EmbedConnection and the only error presented to the end-user was the triggering ClassNotFoundException.&lt;/p&gt;

&lt;p&gt;I have changed the error returned by the user-supplied authentication service so that it survives munging by EmbedConnection.&lt;/p&gt;

&lt;p&gt;This is what the error looks like now:&lt;/p&gt;

&lt;p&gt;&quot;ERROR XBM0M: Error creating an instance of a class named &apos;NATIVE&apos;. This class name was the value of the derby.authentication.provider property and was expected to be the name of an application-supplied implementation of org.apache.derby.authentication.UserAuthenticator. The underlying problem was: java.lang.ClassNotFoundException: NATIVE&quot;&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;--------&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/impl/jdbc/authentication/SpecificAuthenticationServiceImpl.java&lt;br/&gt;
M       java/engine/org/apache/derby/loc/messages.xml&lt;/p&gt;

&lt;p&gt;Improved error message.&lt;/p&gt;

&lt;p&gt;--------&lt;/p&gt;

&lt;p&gt;M       java/testing/org/apache/derbyTesting/functionTests/tests/lang/NativeAuthenticationServiceTest.java&lt;/p&gt;

&lt;p&gt;Regression test for this case.&lt;/p&gt;</comment>
                            <comment id="13269599" author="rhillegas" created="Mon, 7 May 2012 14:24:44 +0100"  >&lt;p&gt;Attaching derby-5741-01-ab-percolateDerbyErrorUp.diff. This adjusts ErrorCodeTest to account for the new wording of error condition XBM0M.D. Other than that test, the regression tests ran cleanly for me. Committed at subversion revision 1335010.&lt;/p&gt;

&lt;p&gt;Touches the following additional file:&lt;/p&gt;

&lt;p&gt;M       java/testing/org/apache/derbyTesting/functionTests/tests/lang/ErrorCodeTest.java&lt;/p&gt;</comment>
                            <comment id="13273659" author="dagw" created="Fri, 11 May 2012 23:07:59 +0100"  >&lt;p&gt;Thanks for fixing this, Rick! The hidden error message is indeed much more helpful. +1&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12328052">DERBY-866</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12553763">DERBY-5742</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12525665" name="derby-5741-01-aa-percolateDerbyErrorUp.diff" size="6886" author="rhillegas" created="Fri, 4 May 2012 20:11:27 +0100"/>
                            <attachment id="12525844" name="derby-5741-01-ab-percolateDerbyErrorUp.diff" size="8283" author="rhillegas" created="Mon, 7 May 2012 14:24:44 +0100"/>
                            <attachment id="12525443" name="repro2.sh" size="519" author="dagw" created="Thu, 3 May 2012 15:03:50 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 3 May 2012 17:53:36 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>237966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0bvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35741</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>