<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:47:35 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2018/DERBY-2018.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2018] NullPointerException in CREATE VIEW ... VALUES NULL;</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2018</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The following statement produces a NullPointerException:&lt;/p&gt;

&lt;p&gt;   CREATE VIEW v1 (f1) AS VALUES NULL;&lt;/p&gt;

&lt;p&gt;Stack trace:&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
2006-10-30 12:39:31.750 GMT:&lt;br/&gt;
 Booting Derby version The Apache Software Foundation - Apache Derby - 10.2.1.6 - (452058): instance c013800d-010e-993b-512f-00000012f418&lt;br/&gt;
on database directory C:\temp_sys\temp_Derby_TestErr_db&lt;/p&gt;

&lt;p&gt;Database Class Loader started - derby.database.classpath=&apos;&apos;&lt;br/&gt;
2006-10-30 12:39:38.484 GMT Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;main,5,main&amp;#93;&lt;/span&gt; (XID = 122), (SESSIONID = 0), (DATABASE = c:\temp_sys\temp_Derby_TestErr_db), (DRDAID = null), Cleanup action starting&lt;br/&gt;
2006-10-30 12:39:38.484 GMT Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;main,5,main&amp;#93;&lt;/span&gt; (XID = 122), (SESSIONID = 0), (DATABASE = c:\temp_sys\temp_Derby_TestErr_db), (DRDAID = null), Failed Statement is: CREATE VIEW v1 (f1) AS VALUES NULL&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
        at org.apache.derby.impl.sql.catalog.SYSCOLUMNSRowFactory.makeRow(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addDescriptorArray(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.execute.CreateViewConstantAction.executeConstantAction(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.execute.MiscResultSet.open(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.ij.executeImmediate(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.utilMain.doCatch(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.utilMain.go(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.go(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.mainCore(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main14.main(Unknown Source)&lt;br/&gt;
        at org.apache.derby.tools.ij.main(Unknown Source)&lt;/p&gt;</description>
                <environment>Java 1.5.0_06-b05</environment>
        <key id="12354287">DERBY-2018</key>
            <summary>NullPointerException in CREATE VIEW ... VALUES NULL;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yipng">Yip Ng</assignee>
                                    <reporter username="chdh@inventec.ch">Christian d&apos;Heureuse</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Oct 2006 12:42:35 +0000</created>
                <updated>Thu, 13 Dec 2007 09:05:17 +0000</updated>
                            <resolved>Sat, 11 Nov 2006 00:52:56 +0000</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12448321" author="yipng" created="Thu, 9 Nov 2006 00:00:25 +0000"  >&lt;p&gt;Attaching derby2018-trunk-diff01.txt.  This is a simple fix where it catches untyped null in CreateViewNode at bind phase (same logic as CursorNode) and throws the exception.&lt;br/&gt;
derbyall passes except for the following tests which already failed before this patch.&lt;/p&gt;

&lt;p&gt;derbyall/derbynetclientmats/derbynetclientmats.fail:junitTests/derbyNet/CompatibilityTest.java&lt;br/&gt;
derbyall/derbynetclientmats/derbynetmats.fail:derbynet/ShutDownDBWhenNSShutsDownTest.junit&lt;br/&gt;
derbyall/derbynetmats/derbynetmats.fail:derbynet/ShutDownDBWhenNSShutsDownTest.junit &lt;/p&gt;

&lt;p&gt;JUnit suite passes.  &lt;/p&gt;</comment>
                            <comment id="12448788" author="bryanpendleton" created="Fri, 10 Nov 2006 16:09:47 +0000"  >&lt;p&gt;This patch looks good to me. I intend to commit it this weekend.&lt;/p&gt;</comment>
                            <comment id="12448852" author="bryanpendleton" created="Fri, 10 Nov 2006 20:56:41 +0000"  >&lt;p&gt;I get the following diff on lang/views.sql. I wonder if this is somehow an issue with&lt;br/&gt;
carriage-return/line-feed issues? I think the patch was generated on Windows and&lt;br/&gt;
I am trying to apply it on Linux.&lt;/p&gt;

&lt;p&gt;java org.apache.derbyTesting.functionTests.harness.RunTest lang/views.sql&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;Start: views jdk1.4.2_11 2006-11-10 12:58:17 ***&lt;br/&gt;
18d17&lt;br/&gt;
&amp;lt;&lt;br/&gt;
74d72&lt;br/&gt;
&amp;lt;&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   views jdk1.4.2_11 2006-11-10 12:58:23 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12448855" author="bryanpendleton" created="Fri, 10 Nov 2006 21:11:32 +0000"  >&lt;p&gt;I get this diff with or without the patch, so it&apos;s not a problem with the patch. Must be something odd in my environment.&lt;/p&gt;</comment>
                            <comment id="12448865" author="yipng" created="Fri, 10 Nov 2006 21:30:16 +0000"  >&lt;p&gt;Hi Bryan.  It appears that the view.sql  test has been moved to JUnit.  Try:&lt;/p&gt;

&lt;p&gt;java org.apache.derbyTesting.functionTests.tests.lang.LangScripts views&lt;/p&gt;

&lt;p&gt;I discovered this when trying to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2048&quot; title=&quot;LangScripts JUnit test fails in views.sql&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2048&quot;&gt;&lt;del&gt;DERBY-2048&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;
</comment>
                            <comment id="12448870" author="bryanpendleton" created="Fri, 10 Nov 2006 21:40:25 +0000"  >&lt;p&gt;Thank you very much, Yip, that was exactly it! Now I get the results I expect: the new test fails without your code patch, and passes with your code patch. Excellent! I will proceed with my review/commit.&lt;/p&gt;</comment>
                            <comment id="12448913" author="bryanpendleton" created="Sat, 11 Nov 2006 00:52:34 +0000"  >&lt;p&gt;The rest of my testing was uneventful. Committed the patch to subversion as revision 473603.&lt;/p&gt;</comment>
                            <comment id="12449003" author="chdh@inventec.ch" created="Sat, 11 Nov 2006 16:56:17 +0000"  >&lt;p&gt;Why does Derby have such problems with untyped NULL values?&lt;br/&gt;
Why does the statement CREATE VIEW v1 (f1) AS VALUES NULL have to be forbidden?&lt;/p&gt;

&lt;p&gt;Other DBMS don&apos;t have such problems, e.g. in MS-SQL-Server 2000,&lt;br/&gt;
  CREATE VIEW v1 AS SELECT NULL as f1&lt;br/&gt;
is valid.&lt;/p&gt;

&lt;p&gt;Does the problem stem from the technique used for data flow paths within Derby, because there has to be an assigned data type for each data element?&lt;/p&gt;</comment>
                            <comment id="12449050" author="yipng" created="Sat, 11 Nov 2006 23:19:58 +0000"  >&lt;p&gt;&amp;gt;Christian d&apos;Heureuse wrote:&lt;br/&gt;
&amp;gt; Why does the statement CREATE VIEW v1 (f1) AS VALUES NULL have to be forbidden? &lt;/p&gt;

&lt;p&gt;One reason is to stay consistent with the behavior with issuing VALUES NULL in Derby.  e.g.:&lt;/p&gt;

&lt;p&gt;  ij&amp;gt; values null;&lt;br/&gt;
  ERROR 42X07: Null is only allowed in a VALUES clause within an INSERT statement.&lt;/p&gt;

&lt;p&gt;  ij&amp;gt; create view v1 (c1) as values null;&lt;br/&gt;
  ERROR 42X07: Null is only allowed in a VALUES clause within an INSERT statement.&lt;/p&gt;

&lt;p&gt;If CREATE VIEW v1 AS SELECT NULL as f1 executes successfully.  What is the data type for this &lt;br/&gt;
view column?  Integer type? Character type or something else?  In any case, it is going to be an implementation defined which in my opinion is not very portable and it is better to declare this explicitly:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; values cast(null as integer);&lt;br/&gt;
1&lt;br/&gt;
-----------&lt;br/&gt;
NULL&lt;/p&gt;

&lt;p&gt;1 row selected&lt;br/&gt;
ij&amp;gt; create view v1 (c1) as values cast(null as integer);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; select * from v1;&lt;br/&gt;
C1&lt;br/&gt;
-----------&lt;br/&gt;
NULL&lt;/p&gt;

&lt;p&gt;1 row selected&lt;/p&gt;

&lt;p&gt;Of course, you may not agree with me.  So perhaps this issue can be further discuss in the Derby dev list to see how the community feels about it.  In any case, the current state is better than having a NPE to occur.  =)&lt;/p&gt;</comment>
                            <comment id="12449302" author="bernt" created="Mon, 13 Nov 2006 10:27:44 +0000"  >&lt;p&gt;NOTE:&lt;/p&gt;

&lt;p&gt;VALUES NULL; (and thus CREATE VIEW V(F) AS VALUES NULL) is not a legal SQL statment according to the SQL standard since the type is undefined. &lt;/p&gt;

&lt;p&gt;VALUES (CAST NULL AS INTEGER)  on the other hand is legal.&lt;/p&gt;</comment>
                            <comment id="12449350" author="chdh@inventec.ch" created="Mon, 13 Nov 2006 12:52:20 +0000"  >&lt;p&gt;Bernt M. Johnsen wrote:&lt;br/&gt;
&amp;gt; VALUES NULL ... is not a legal SQL statement &lt;/p&gt;

&lt;p&gt;I agree that it&apos;s not conforming SQL according to the standard.&lt;br/&gt;
But non-conforming SQL is allowed (it&apos;s &quot;legal&quot;) and all DBMSs have it.&lt;/p&gt;

&lt;p&gt;(see also my discussion with Nip in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2002&quot; title=&quot;Case expression allows NULL in all parts of &amp;lt;result&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2002&quot;&gt;&lt;del&gt;DERBY-2002&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12551436" author="fuzzylogic" created="Thu, 13 Dec 2007 09:05:17 +0000"  >&lt;p&gt;This issue has been resolved for over a year with no further movement. Closing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12344624" name="derby2018-trunk-diff01.txt" size="1744" author="yipng" created="Thu, 9 Nov 2006 00:00:25 +0000"/>
                            <attachment id="12344623" name="derby2018-trunk-stat01.txt" size="326" author="yipng" created="Thu, 9 Nov 2006 00:00:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 9 Nov 2006 00:00:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22840</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0zwn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39635</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>