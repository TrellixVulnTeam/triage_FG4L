<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:54:29 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4246/DERBY-4246.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4246] &apos;.replicationTests.ReplicationRun_Local_3_p5).testReplication_Local_3_p5_DERBY_3878()&apos; fails w/ &quot;Could not perform operation &apos;stopSlave&apos; because the database &apos;...&apos; has not been booted&quot;.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4246</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>
&lt;p&gt;testReplication_Local_3_p5_DERBY_3878(org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun_Local_3_p5)junit.framework.AssertionFailedError: Got -1 XRE11 DERBY SQL error: SQLCODE: -1, SQLSTATE: XRE11, SQLERRMC: Could not perform operation &apos;stopSlave&apos; because the database &apos;C:\cludev\jagtmp\autoderbyN_regression\suitesAll_7\log\db_slave\wombat&apos; has not been booted.. Expected XRE42&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun.assertException(ReplicationRun.java:3388)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationRun_Local_3_p5.testReplication_Local_3_p5_DERBY_3878(ReplicationRun_Local_3_p5.java:96)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:106)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;/p&gt;


&lt;p&gt;See e.g.  &lt;a href=&quot;http://dbtg.thresher.com/derby/test/Daily/jvm1.6/testing/testlog/vista/778182-suitesAll_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.thresher.com/derby/test/Daily/jvm1.6/testing/testlog/vista/778182-suitesAll_diff.txt&lt;/a&gt;&lt;/p&gt;</description>
                <environment>OS:&lt;br/&gt;
Microsoft&amp;#xA9; Windows VistaT Ultimate - 6.0.6001 Service Pack 1 - WindowsNT 0 6&lt;br/&gt;
Microsoft(R) Windows(R) Server 2003, - 5.2.3790 Service Pack 2 - WindowsNT 2 5&lt;br/&gt;
Microsoft Windows XP Professional - 5.1.2600 Service Pack 3 Build 2600 - CYGWIN_NT-5.1 1.5.25(0.156/4/2) 2008-06-12 19:34 Cygwin&lt;br/&gt;
&lt;br/&gt;
JVM:&lt;br/&gt;
Sun Microsystems Inc. java version &amp;quot;1.6.0_06&amp;quot; Java(TM) SE Runtime Environment (build 1.6.0_06-b02) Java HotSpot(TM) Client VM (build 10.0-b22 mixed mode 32-bit)&lt;br/&gt;
Sun Microsystems Inc. java version &amp;quot;1.5.0_14&amp;quot; Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_14-b03) Java HotSpot(TM) Client VM (build 1.5.0_14-b03 mixed mode 32-bit)&lt;br/&gt;
Sun Microsystems Inc. java version &amp;quot;1.4.2_13&amp;quot; Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.2_13-b06) Java HotSpot(TM) Client VM (build 1.4.2_13-b06 mixed mode 32-bit)&lt;br/&gt;
Sun Microsystems Inc. java version &amp;quot;1.6.0_10&amp;quot; Java(TM) SE Runtime Environment (build 1.6.0_10-b33) Java HotSpot(TM) Client VM (build 11.0-b15, mixed mode)&lt;br/&gt;
Sun Microsystems Inc. java version &amp;quot;1.5.0_16&amp;quot; Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_16-b02) Java HotSpot(TM) Client VM (build 1.5.0_16-b02, mixed mode, sharing)&lt;br/&gt;
</environment>
        <key id="12426281">DERBY-4246</key>
            <summary>&apos;.replicationTests.ReplicationRun_Local_3_p5).testReplication_Local_3_p5_DERBY_3878()&apos; fails w/ &quot;Could not perform operation &apos;stopSlave&apos; because the database &apos;...&apos; has not been booted&quot;.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="olesolberg">Ole Solberg</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 May 2009 11:59:54 +0100</created>
                <updated>Wed, 29 Jul 2009 23:22:35 +0100</updated>
                            <resolved>Wed, 29 Jul 2009 23:22:35 +0100</resolved>
                                    <version>10.6.1.0</version>
                                    <fixVersion>10.5.3.0</fixVersion>
                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>Replication</component>
                    <component>Test</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12718427" author="dagw" created="Thu, 11 Jun 2009 13:34:39 +0100"  >&lt;p&gt;This appears to be another instance of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4175&quot; title=&quot;Instability in some replication tests under load, since tests don&amp;#39;t wait long enough for final state or anticipate intermediate states&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4175&quot;&gt;&lt;del&gt;DERBY-4175&lt;/del&gt;&lt;/a&gt;. In that case also,&lt;br/&gt;
after killing the master, it takes a while for the slave to react and&lt;br/&gt;
close down. XRE42 is actually not the expected end state here, but the&lt;br/&gt;
test expects it. This will &lt;b&gt;mostly&lt;/b&gt; work if the slave shutdown takes&lt;br/&gt;
some time, but not always, as seen in this issue. XRE42 is an&lt;br/&gt;
intermediate state before the slave shuts down.&lt;/p&gt;

&lt;p&gt;What is seen in the stack trace for this issue is that the connect&lt;br/&gt;
attempt receives XRE11 (REPLICATION_DB_NOT_BOOTED), which is the end&lt;br/&gt;
state of the slave. The fix is to make the test anticipate the&lt;br/&gt;
intermediate states, as in the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4175&quot; title=&quot;Instability in some replication tests under load, since tests don&amp;#39;t wait long enough for final state or anticipate intermediate states&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4175&quot;&gt;&lt;del&gt;DERBY-4175&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;
</comment>
                            <comment id="12718893" author="dagw" created="Fri, 12 Jun 2009 17:24:10 +0100"  >&lt;p&gt;Uploading patch derby-4246a, which factors out the stopSlave code for&lt;br/&gt;
both cases:&lt;/p&gt;

&lt;p&gt;   a) the master server is running&lt;br/&gt;
   b) the master server is no longer running&lt;/p&gt;

&lt;p&gt;and replaced all occurences of stop slave with a new method,&lt;br/&gt;
ReplicationRun.stopSlave (the old one of the same name, which was&lt;br/&gt;
unused, I removed).&lt;/p&gt;

&lt;p&gt;Case b) was inlined in the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4175&quot; title=&quot;Instability in some replication tests under load, since tests don&amp;#39;t wait long enough for final state or anticipate intermediate states&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4175&quot;&gt;&lt;del&gt;DERBY-4175&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
for ReplicationRun_Local_StateTest_part1_1 . The same fix applies here&lt;br/&gt;
for ReplicationRun_Local_3_p5, so I decided to factor it out. I did&lt;br/&gt;
the same thing for case a), sinc ethere were several instances of this&lt;br/&gt;
code as well. Replication suite had no errors with the patch.&lt;/p&gt;


</comment>
                            <comment id="12719436" author="knutanders" created="Mon, 15 Jun 2009 08:22:48 +0100"  >&lt;p&gt;This looks like a useful refactoring/cleanup. +1&lt;/p&gt;

&lt;p&gt;While you&apos;re at it, I noticed this diff in the patch (not code added by you, just restructured):&lt;/p&gt;

&lt;p&gt;+        } catch (SQLException se) {&lt;br/&gt;
+            int ec = se.getErrorCode();&lt;br/&gt;
+            String ss = se.getSQLState();&lt;br/&gt;
+            String msg = ec + &quot; &quot; + ss + &quot; &quot; + se.getMessage();&lt;br/&gt;
+            util.DEBUG(&quot;4. Unexpectedly failed to connect: &quot; +&lt;br/&gt;
+                       connectionURL +  &quot; &quot; + msg);&lt;br/&gt;
+            assertTrue(&quot;Unexpectedly failed to connect: &quot; +&lt;br/&gt;
+                       connectionURL +  &quot; &quot; + msg, false);&lt;/p&gt;

&lt;p&gt;Couldn&apos;t this catch block be removed? That would simplify the code even more and also preserve the stack trace of the unexpected exception.&lt;/p&gt;</comment>
                            <comment id="12720015" author="dagw" created="Tue, 16 Jun 2009 10:41:45 +0100"  >&lt;p&gt;Thank for looking at this, Knut. &lt;/p&gt;

&lt;p&gt;Yes, that catch could go, but I chose to stay faithful to the way the&lt;br/&gt;
rest of the code is written for now (this pattern is used throughout);&lt;br/&gt;
it does give the additional info on the connectionURL, which one would&lt;br/&gt;
otherwise need to infer from the code, but I agree simplifying would&lt;br/&gt;
be better.&lt;/p&gt;
</comment>
                            <comment id="12720022" author="dagw" created="Tue, 16 Jun 2009 10:51:13 +0100"  >&lt;p&gt;Committed on trunk as svn 785131, resolving.&lt;/p&gt;</comment>
                            <comment id="12727199" author="olesolberg" created="Sat, 4 Jul 2009 08:40:04 +0100"  >&lt;p&gt;Not seen since commit, so closing.&lt;/p&gt;</comment>
                            <comment id="12736869" author="dagw" created="Wed, 29 Jul 2009 23:18:10 +0100"  >&lt;p&gt;Re-opening to backport to 10.5 branch.&lt;/p&gt;</comment>
                            <comment id="12736870" author="dagw" created="Wed, 29 Jul 2009 23:18:55 +0100"  >&lt;p&gt;Backported to 10.5 as svn 799099, closing.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12423424">DERBY-4175</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12410492" name="derby-4246a.diff" size="25141" author="dagw" created="Fri, 12 Jun 2009 17:24:10 +0100"/>
                            <attachment id="12410493" name="derby-4246a.stat" size="688" author="dagw" created="Fri, 12 Jun 2009 17:24:10 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 11 Jun 2009 12:34:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24130</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0ry7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38346</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>