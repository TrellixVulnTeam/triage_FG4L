<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:16:27 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4748/DERBY-4748.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4748] StringIndexOutOfBoundsException on syntax error (invalid COMMIT)</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4748</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Start the network server on port 1527 on localhost.&lt;/p&gt;

&lt;p&gt;Run ant on the following:&lt;/p&gt;

&lt;p&gt;&amp;lt;project default=&quot;all&quot;&amp;gt; &lt;br/&gt;
  &amp;lt;property environment=&quot;env&quot; /&amp;gt; &lt;br/&gt;
  &amp;lt;path id=&quot;derby.classpath.id&quot;&amp;gt; &lt;br/&gt;
    &amp;lt;fileset dir=&quot;${env.DERBY_LIB&quot;&amp;gt; &lt;br/&gt;
      &amp;lt;include name=&quot;derbynet.jar&quot; /&amp;gt; &lt;br/&gt;
      &amp;lt;include name=&quot;derbyclient.jar&quot; /&amp;gt; &lt;br/&gt;
    &amp;lt;/fileset&amp;gt; &lt;br/&gt;
  &amp;lt;/path&amp;gt; &lt;/p&gt;

&lt;p&gt;  &amp;lt;target name=&quot;all&quot;&amp;gt; &lt;br/&gt;
    &amp;lt;sql driver=&quot;org.apache.derby.jdbc.ClientDriver&quot; &lt;/p&gt;

&lt;p&gt;url=&quot;jdbc:derby://localhost:1527/derbyDB;create=true;user=derbyuser;passsword=derbypwd&quot; &lt;br/&gt;
         userid=&quot;derbyuser&quot; &lt;br/&gt;
         password=&quot;derbypwd&quot; &lt;br/&gt;
         classpathref=&quot;derby.classpath.id&quot; &lt;br/&gt;
         onerror=&quot;continue&quot;&amp;gt;&lt;br/&gt;
create table mytable1 (mycol varchar(255)); &lt;br/&gt;
commit; &lt;br/&gt;
    &amp;lt;/sql&amp;gt; &lt;br/&gt;
  &amp;lt;/target&amp;gt; &lt;br/&gt;
&amp;lt;/project&amp;gt; &lt;/p&gt;

&lt;p&gt;On 10.5.3, I get&lt;br/&gt;
      &lt;span class=&quot;error&quot;&gt;&amp;#91;sql&amp;#93;&lt;/span&gt; Executing commands &lt;br/&gt;
      &lt;span class=&quot;error&quot;&gt;&amp;#91;sql&amp;#93;&lt;/span&gt; Failed to execute:  commit &lt;br/&gt;
      &lt;span class=&quot;error&quot;&gt;&amp;#91;sql&amp;#93;&lt;/span&gt; java.sql.SQLSyntaxErrorException: Syntax error: Encountered &lt;br/&gt;
&quot;commit&quot; &lt;br/&gt;
 at line 1, column 1. &lt;br/&gt;
      &lt;span class=&quot;error&quot;&gt;&amp;#91;sql&amp;#93;&lt;/span&gt; 1 of 2 SQL statements executed successfully &lt;/p&gt;

&lt;p&gt;but on 10.6.1, I get&lt;br/&gt;
     &lt;span class=&quot;error&quot;&gt;&amp;#91;sql&amp;#93;&lt;/span&gt; Executing commands &lt;/p&gt;

&lt;p&gt;BUILD FAILED &lt;br/&gt;
java.lang.StringIndexOutOfBoundsException: String index out of range: 6 &lt;br/&gt;
        at java.lang.String.charAt(String.java:686) &lt;br/&gt;
        at org.apache.derby.client.am.Statement.isolateAnyInitialIdentifier(Unknown Source) &lt;br/&gt;
        at org.apache.derby.client.am.Statement.getStatementToken(Unknown Source) &lt;br/&gt;
        at org.apache.derby.client.am.Statement.parseSqlAndSetSqlModes(Unknown Source) &lt;br/&gt;
....&lt;/p&gt;</description>
                <environment>Windows XP</environment>
        <key id="12469671">DERBY-4748</key>
            <summary>StringIndexOutOfBoundsException on syntax error (invalid COMMIT)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="sdfelts">Stephen Felts</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Jul 2010 00:13:09 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:27 +0100</updated>
                            <resolved>Tue, 10 Aug 2010 16:20:06 +0100</resolved>
                                    <version>10.4.2.1</version>
                    <version>10.5.3.1</version>
                    <version>10.6.1.0</version>
                    <version>10.7.1.1</version>
                                    <fixVersion>10.4.2.1</fixVersion>
                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.2.1</fixVersion>
                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>Network Client</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12890206" author="kristwaa" created="Tue, 20 Jul 2010 08:57:12 +0100"  >&lt;p&gt;Thanks for the report.&lt;/p&gt;

&lt;p&gt;This bug was introduced under &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4338&quot; title=&quot;Network client raises error &amp;quot;executeQuery method can not be used for update&amp;quot; when sql is preceded by /* */ comments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4338&quot;&gt;&lt;del&gt;DERBY-4338&lt;/del&gt;&lt;/a&gt;. I&apos;ll have a look.&lt;/p&gt;</comment>
                            <comment id="12890227" author="kristwaa" created="Tue, 20 Jul 2010 11:05:57 +0100"  >&lt;p&gt;Attaching patch 1a, which changes the logic in the loop.&lt;br/&gt;
I think there are many ways to write this logic/loop, and almost as many ways to get it wrong &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Regression tests passed.&lt;br/&gt;
Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="12890278" author="knutanders" created="Tue, 20 Jul 2010 16:20:45 +0100"  >&lt;p&gt;The fix looks correct to me. +1 to commit.&lt;/p&gt;

&lt;p&gt;Minor nit: The helper method assertCompileError() could be used to simplify the test case.&lt;/p&gt;</comment>
                            <comment id="12890284" author="knutanders" created="Tue, 20 Jul 2010 16:46:01 +0100"  >&lt;p&gt;By the way, I think the isolateAnyInitialIdentifier() method is somewhat more complex than it needs to be in the first place. Replacing it with something like the (untested) loop below would probably solve the out-of-bounds exception and also make the method easier to read since it has fewer special cases to check for.&lt;/p&gt;

&lt;p&gt;        int idx;&lt;br/&gt;
        for (idx = 0; idx &amp;lt; sql.length(); idx++) {&lt;br/&gt;
            char ch = sql.charAt(idx);&lt;br/&gt;
            if (!Character.isLetter(ch)) &lt;/p&gt;
{
                // first non-token char found
                break;
            }
&lt;p&gt;        }&lt;br/&gt;
        // return initial token if one is found, or the entire string otherwise&lt;br/&gt;
        return (idx &amp;gt; 0) ? sql.substring(0, idx) : sql;&lt;/p&gt;</comment>
                            <comment id="12891074" author="kristwaa" created="Thu, 22 Jul 2010 10:34:39 +0100"  >&lt;p&gt;Thanks, Knut.&lt;br/&gt;
That code looks better.&lt;/p&gt;

&lt;p&gt;I uploaded a new revision of the patch (1b), which uses your code and also includes some more changes to the test.&lt;br/&gt;
Regression tests passed, I expect to commit it shortly.&lt;/p&gt;</comment>
                            <comment id="12891100" author="knutanders" created="Thu, 22 Jul 2010 12:30:00 +0100"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="12893971" author="kristwaa" created="Fri, 30 Jul 2010 09:56:37 +0100"  >&lt;p&gt;Committed patch 1b to trunk with revision 980684.&lt;br/&gt;
Will backport before closing.&lt;/p&gt;</comment>
                            <comment id="12896906" author="kristwaa" created="Tue, 10 Aug 2010 16:15:19 +0100"  >&lt;p&gt;Now I understand why I&apos;m not supposed to resolve the issue before I have back-ported the fix &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12896907" author="kristwaa" created="Tue, 10 Aug 2010 16:20:06 +0100"  >&lt;p&gt;Backported to 10.6 with revision 984074, 10.5 with revision 984079, and finally to 10.4 with revision 984080. suites.All and derbyall ran without failures, with the exception of store/aes.sql on 10.4.&lt;/p&gt;

&lt;p&gt;Stephen, the issue is ready for verification and closing.&lt;/p&gt;</comment>
                            <comment id="13685245" author="knutanders" created="Mon, 17 Jun 2013 10:19:27 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12449917" name="derby-4748-1a-sioobe.diff" size="2032" author="kristwaa" created="Tue, 20 Jul 2010 11:05:56 +0100"/>
                            <attachment id="12450149" name="derby-4748-1b-sioobe.diff" size="2701" author="kristwaa" created="Thu, 22 Jul 2010 10:34:39 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10420"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 20 Jul 2010 07:57:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24443</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0orj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37830</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>