<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:15:29 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2999/DERBY-2999.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2999] convert lang/lockTable.sql to Junit</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2999</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description></description>
                <environment></environment>
        <key id="12375724">DERBY-2999</key>
            <summary>convert lang/lockTable.sql to Junit</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="myrna">Myrna van Lunteren</assignee>
                                    <reporter username="pandiri">Ravinder Reddy</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Aug 2007 07:55:25 +0100</created>
                <updated>Wed, 3 Sep 2014 09:31:37 +0100</updated>
                            <resolved>Tue, 20 Aug 2013 03:56:31 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12521322" author="pandiri" created="Tue, 21 Aug 2007 06:39:31 +0100"  >&lt;p&gt;It is ready for commit.&lt;br/&gt;
Thank You&lt;/p&gt;</comment>
                            <comment id="12521788" author="kristwaa" created="Wed, 22 Aug 2007 14:57:56 +0100"  >&lt;p&gt;Hello Ravinder,&lt;/p&gt;

&lt;p&gt;I had a look at the patch, and in my opinion it is not quite ready for commit.&lt;/p&gt;

&lt;p&gt;My initial comments:&lt;br/&gt;
 1) The drop table statements in the setUp method fails.&lt;br/&gt;
 2) After fixing 1, the test takes over 300 seconds to complete. Is this what you intended?&lt;br/&gt;
 3) Does the new test actually test/verify the same things as the old one?&lt;br/&gt;
 4) A mix of tabs and spaces are used for indentation.&lt;/p&gt;

&lt;p&gt;A nit, but don&apos;t you think it would be nicer with a blank line between methods?&lt;br/&gt;
I can have another look at the test when the initial comments are addressed.&lt;/p&gt;

&lt;p&gt;Thanks for working on the tests &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12522029" author="pandiri" created="Thu, 23 Aug 2007 06:52:44 +0100"  >
&lt;p&gt;Thank You Waagan for your Review.&lt;br/&gt;
I addressed your comments  in the next patch.&lt;/p&gt;

&lt;p&gt;1)  now it&apos;s working&lt;/p&gt;

&lt;p&gt;2) It takes  bcoz of the following reason.&lt;br/&gt;
     The table is locked by a user  U1  and the  user  U2  , trying to lock  the same table , &lt;br/&gt;
    get SQLExceptio &quot;40XL1&quot; (A lock could not be obtained within the time requested).&lt;br/&gt;
    And hence execution time depends on lock timeout.&lt;/p&gt;

&lt;p&gt;3) yes it is.&lt;/p&gt;

&lt;p&gt;4) resolved.&lt;/p&gt;

&lt;p&gt;Thank You.&lt;/p&gt;</comment>
                            <comment id="12522081" author="kristwaa" created="Thu, 23 Aug 2007 10:40:16 +0100"  >&lt;p&gt;Thanks for addressing comment 1 and 4.&lt;/p&gt;

&lt;p&gt;Regarding comment 2, I&apos;m wondering if you should use a decorator to set the appropriate Derby properties to make the test run faster. In the old test derby.storage.rowLocking=false was also set. Is this no longer needed?&lt;/p&gt;

&lt;p&gt;For comment 3, I don&apos;t see any verification of the locks by querying the lock table. If that is a conscious choice, then consider my comment addressed. However, I don&apos;t really understand what is tested in &quot;-- verify that user getting error on lock table doesn&apos;t get rolled back&quot;. The test case does not seem to verify that the other user still has its locks after the exception is thrown.&lt;br/&gt;
And in the method &quot;testTXvsTXLocks&quot;, maybe trying to insert a row with connection c2 would be a nice addition to the test?&lt;/p&gt;

&lt;p&gt;Another small thing I noticed, is that dropping the table in the test methods should not be required since you run with auto commit off and do a rollback in the tearDown-method, and also the tables are dropped in setUp.&lt;br/&gt;
The main reason for removing it from the test method would be to make it smaller and have it only contain code relevant to what&apos;s being tested, the secondary reason would be to do things only once (or twice).&lt;/p&gt;


&lt;p&gt;regards,&lt;/p&gt;</comment>
                            <comment id="12619746" author="myrna" created="Tue, 5 Aug 2008 01:00:22 +0100"  >&lt;p&gt;This issue appears stalled. Ravinder, if you&apos;re not working on this anymore, can you unassign yourself so someone else can finish it?&lt;/p&gt;</comment>
                            <comment id="12706965" author="kmarsden" created="Thu, 7 May 2009 17:18:18 +0100"  >&lt;p&gt;Unassigning due to inactivity.&lt;/p&gt;</comment>
                            <comment id="13744328" author="myrna" created="Mon, 19 Aug 2013 23:06:59 +0100"  >&lt;p&gt;I tried Ravinder&apos;s patch, but it wasn&apos;t working for me, for starters, the dropping and closing left or created locks. Having the statements as global variables also caused locks to remain in place, and finally the schemas didn&apos;t get created. &lt;/p&gt;

&lt;p&gt;So I basically started from scratch, but added Ravinder&apos;s check for the Lock Table command on sys.systables.&lt;/p&gt;


&lt;p&gt;Now the test uses a decorateSQL to create the schemas.&lt;br/&gt;
I did add Kristian&apos;s suggestion for an extra insert in the TXvsTX test.&lt;br/&gt;
I also have included the selects from syscs_diag.lock_table.&lt;br/&gt;
I also used the assert which checks on an array of errors instead of just 40XL1. Possibly this assert wasn&apos;t available when Ravinder made his version.&lt;br/&gt;
I also used the DatabasePropertyTestSetup, so we only wait as per the original test properties.&lt;/p&gt;

&lt;p&gt;Running tests...&lt;/p&gt;</comment>
                            <comment id="13744638" author="jira-bot" created="Tue, 20 Aug 2013 03:55:04 +0100"  >&lt;p&gt;Commit 1515691 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1515691&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1515691&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2999&quot; title=&quot;convert lang/lockTable.sql to Junit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2999&quot;&gt;&lt;del&gt;DERBY-2999&lt;/del&gt;&lt;/a&gt;; convert lang/lockTable.sql to Junit&lt;br/&gt;
  converted the test lang/lockTable.sql to lang/LockTableTest.java&lt;/p&gt;</comment>
                            <comment id="13744640" author="myrna" created="Tue, 20 Aug 2013 03:56:31 +0100"  >&lt;p&gt;Test ran cleanly. Committed (rev. 1515691), resolving.&lt;/p&gt;</comment>
                            <comment id="13744786" author="jira-bot" created="Tue, 20 Aug 2013 09:24:46 +0100"  >&lt;p&gt;Commit 1515737 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1515737&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1515737&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2999&quot; title=&quot;convert lang/lockTable.sql to Junit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2999&quot;&gt;&lt;del&gt;DERBY-2999&lt;/del&gt;&lt;/a&gt;: Fix javadoc warning&lt;/p&gt;</comment>
                            <comment id="14119610" author="knutanders" created="Wed, 3 Sep 2014 09:31:37 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12364207" name="DERBY-2999.diff-v1" size="27089" author="pandiri" created="Tue, 21 Aug 2007 06:38:46 +0100"/>
                            <attachment id="12364386" name="DERBY-2999.diff-v2" size="27858" author="pandiri" created="Thu, 23 Aug 2007 06:40:46 +0100"/>
                            <attachment id="12598847" name="DERBY-2999.diff_v3" size="24210" author="myrna" created="Mon, 19 Aug 2013 23:06:59 +0100"/>
                            <attachment id="12598846" name="DERBY-2999.stat_v3" size="629" author="myrna" created="Mon, 19 Aug 2013 23:06:59 +0100"/>
                            <attachment id="12364208" name="STATUS-2999-v1" size="728" author="pandiri" created="Tue, 21 Aug 2007 06:39:05 +0100"/>
                            <attachment id="12364387" name="STATUS-v2" size="728" author="pandiri" created="Thu, 23 Aug 2007 06:41:38 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 22 Aug 2007 13:57:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30686</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0u93:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38719</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>