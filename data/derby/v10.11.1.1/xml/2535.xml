<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:20:28 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2535/DERBY-2535.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2535] Make Locale available in DataValueFactory(DVF). This Locale object will be used to construct Collator object if the user has requested territory based collation.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2535</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Add a new api on DVF which will make Locale object available to DVF. This new api on DVF will get called by the boot method of  BasicDatabase after BasicDatabase has finished booting DVF. This Locale will be either the Locale obtained from the territory attribute supplied by the user on the JDBC url at database create time or if user didn&apos;t provide the territory attribute at database create time, then it will be set to the default JVM locale. This Locale object will be used by DVF to construct the Collator object if user has requested territory based collation.&lt;br/&gt;
The new api will look like following&lt;br/&gt;
        void setLocale(Locale localeOfTheDatabase);&lt;/p&gt;</description>
                <environment></environment>
        <key id="12366831">DERBY-2535</key>
            <summary>Make Locale available in DataValueFactory(DVF). This Locale object will be used to construct Collator object if the user has requested territory based collation.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mamtas">Mamta A. Satoor</assignee>
                                    <reporter username="mamtas">Mamta A. Satoor</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Apr 2007 19:28:50 +0100</created>
                <updated>Thu, 2 May 2013 03:29:05 +0100</updated>
                            <resolved>Mon, 14 May 2007 18:34:19 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12487597" author="mamtas" created="Mon, 9 Apr 2007 19:39:20 +0100"  >&lt;p&gt;Attaching a simple patch which will set a Locale object in DVF. This setting of Locale in DVF will be done by BasicDatabase after it has finished booting DVF. DVF will use the Locale object to construct Collator if user requested territory based collation.&lt;/p&gt;</comment>
                            <comment id="12487598" author="mamtas" created="Mon, 9 Apr 2007 19:41:08 +0100"  >&lt;p&gt;The attached patch (DERBY2535_Set_Locale_On_DVF_v1_diff.txt) changes following files&lt;br/&gt;
svn stat -q&lt;br/&gt;
M      java\engine\org\apache\derby\impl\db\BasicDatabase.java&lt;br/&gt;
M      java\engine\org\apache\derby\iapi\types\DataValueFactoryImpl.java&lt;br/&gt;
M      java\engine\org\apache\derby\iapi\types\DataValueFactory.java&lt;/p&gt;

&lt;p&gt;I have fired the tests but do not anticipate anything failing because BasicDatabase just sets the Locale on DVF. Will soon commit this patch.&lt;/p&gt;</comment>
                            <comment id="12487686" author="mamtas" created="Tue, 10 Apr 2007 06:25:17 +0100"  >&lt;p&gt;Committed patch DERBY2535_Set_Locale_On_DVF_v1_diff.txt as part of revision 527034&lt;/p&gt;</comment>
                            <comment id="12487808" author="army" created="Tue, 10 Apr 2007 17:11:58 +0100"  >&lt;p&gt;Thank you for the patch, Mamta.  I took a quick look at it and I just have one question: with this patch we now call the new &quot;setLocale()&quot; method on the DataValueFactory that is created within the BasicDatabase.boot() method.  That part looks good.  My question arises from the fact that there are actually &lt;b&gt;two&lt;/b&gt; places in the code where we create a DataValueFactory.  You&apos;ve changed the first one, but there is another call in:&lt;/p&gt;

&lt;p&gt;  sql/conn/GenericLanguageConnectionFactory.boot()&lt;/p&gt;

&lt;p&gt;that looks identical to the one you&apos;ve already changed.  Does this second DataValueFactory need to have its locale set, as well?  Or is it not required in this particular case?&lt;/p&gt;

&lt;p&gt;I haven&apos;t looked into the code so maybe the &quot;boot()&quot; method in GenericLanguageConnectionFactory returns the same DVF that is created in BasicDatabase.boot()?  If that&apos;s the case then I can see why we do not need to set locale a second time.  But as I&apos;m not familiar with this code, I thought I&apos;d bring it up...&lt;/p&gt;

&lt;p&gt;Also, I noticed that in the patch that you actually committed, the call to &quot;setLocale()&quot; is commented out (which is not the case in the patch that you posted).  Was that an intentional &quot;incremental development&quot; decision since the feature is not fully implemented yet?&lt;/p&gt;</comment>
                            <comment id="12487823" author="mamtas" created="Tue, 10 Apr 2007 17:59:03 +0100"  >&lt;p&gt;Army, thanks for the review. First let me answer the commenting of the call to &quot;setLocale()&quot;. I was experimenting in my codeline after adding the patch to this Jira entry and that is when I commented out the call to setLocale. I will go ahead and uncomment it because I will need it for the next incremental step. The patch for the uncommenting change is DERBY2535_Uncomment_locale_setting_on_DVF_v1_diff.txt I will commit in next few minutes.&lt;/p&gt;</comment>
                            <comment id="12487825" author="mamtas" created="Tue, 10 Apr 2007 18:01:50 +0100"  >&lt;p&gt;Committed patch DERBY2535_Uncomment_locale_setting_on_DVF_v1_diff.txt using revision 527199.&lt;/p&gt;</comment>
                            <comment id="12487842" author="mamtas" created="Tue, 10 Apr 2007 18:46:23 +0100"  >&lt;p&gt;Army, thanks for the careful review about DVF creation. BasicDatabase is the first one to create DVF and then it sets the locale on the DVF. Later in it&apos;s boot code, BasicDatabase creates LanguageConnectionFactory which causes a call to GenericLanguageConnectionFactory.boot. When GenericLanguageConnectionFactory asks Monitor to get DVF, Monitor return the already created DVF which has the locale set on it. So, although we see Monitor code getting called twice for DVF, the 2nd time around we get the same instance that was created by the first call.&lt;/p&gt;

&lt;p&gt;Thanks Army for your time in reviewing the code.&lt;/p&gt;</comment>
                            <comment id="12487845" author="army" created="Tue, 10 Apr 2007 18:55:22 +0100"  >&lt;p&gt;Thank you for the quick explanation, Mamta.  Do you think it would be worth it to add a comment saying this to the GenericLanguageConnectionFactory.boot() method? This certainly isn&apos;t a requirement, just a suggestion.&lt;/p&gt;

&lt;p&gt;Either way, thanks again for answering my question &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12487855" author="mamtas" created="Tue, 10 Apr 2007 19:04:04 +0100"  >&lt;p&gt;Army, I was already working on writing the comments in GenericLanguageConnectionFactory. So, yes, I will commit the comment changes in another few minutes.&lt;/p&gt;</comment>
                            <comment id="12487873" author="mamtas" created="Tue, 10 Apr 2007 19:26:11 +0100"  >&lt;p&gt;Committed a comment on GenericLanguageConnectionFactory as revision 527235.&lt;/p&gt;</comment>
                            <comment id="12488466" author="mamtas" created="Thu, 12 Apr 2007 19:36:04 +0100"  >&lt;p&gt;My earlier comment (that I just deleted) used incorrect terminology for what classes were involved in the patch(DERBY2535_Return_Collator_api_On_DVD_v1_diff.txt ) and what the exact changes were. Here is the correct comment for the patch that I just commited as revision 528070.&lt;/p&gt;

&lt;p&gt;Description of patch DERBY2535_Return_Collator_api_On_DVD_v1_diff.txt. &lt;/p&gt;

&lt;p&gt;This patch adds a new api on DataValueFactory(DVF) to return the Collator object depending on the collation type. The new api looks as follows &lt;br/&gt;
RuleBasedCollator getCharacterCollator(int collationType); &lt;/p&gt;

&lt;p&gt;If the collation type is UCS_BASIC, then Collator object returned by the new api above will be null. If the collation type is TERRITORY_BASED, then Collator object returned will be the one based on the territory of the database. &lt;/p&gt;

&lt;p&gt;This new api will be used in a method on DVF which will take format id and collation type and return a DVD based on those 2 values. That method on DVF will first consturct a DVD using just the format id. For character trype format ids, this means that the DVD will always be SQLChar/SQLVarchar/SQLLongvarchar/SQLClob. This is ok if we are dealing with collation type of UCS_BASIC. But if the collation type is TERRITORY_BASED, then we should construct a DVD of type CollatorSQLChar/CollatorSQLVarchar/CollatorSQLLongvarchar/CollatorSQLClob. In order to construct these collation sensitive DVDs, the method on DVF will call the new api on DVF (getCharacterCollator) and it will use the return Collator from getCharacterCollator to construct the right kind of character DVD. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12362830">DERBY-2336</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12355441" name="DERBY2535_Return_Collator_api_On_DVD_v1_diff.txt" size="3893" author="mamtas" created="Thu, 12 Apr 2007 19:00:55 +0100"/>
                            <attachment id="12355442" name="DERBY2535_Return_Collator_api_On_DVD_v1_stat.txt" size="212" author="mamtas" created="Thu, 12 Apr 2007 19:00:56 +0100"/>
                            <attachment id="12355184" name="DERBY2535_Set_Locale_On_DVF_v1_diff.txt" size="4185" author="mamtas" created="Mon, 9 Apr 2007 19:39:20 +0100"/>
                            <attachment id="12355258" name="DERBY2535_Set_Locale_On_DVF_v1_stat.txt" size="276" author="mamtas" created="Tue, 10 Apr 2007 17:59:03 +0100"/>
                            <attachment id="12355185" name="DERBY2535_Set_Locale_On_DVF_v1_stat.txt" size="276" author="mamtas" created="Mon, 9 Apr 2007 19:39:20 +0100"/>
                            <attachment id="12355257" name="DERBY2535_Uncomment_locale_setting_on_DVF_v1_diff.txt" size="1375" author="mamtas" created="Tue, 10 Apr 2007 17:59:02 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 10 Apr 2007 16:11:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30505</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0k3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37076</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>