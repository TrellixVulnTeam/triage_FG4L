<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:35:48 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1500/DERBY-1500.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1500] PreparedStatement#setObject(int parameterIndex, Object x) throws SQL Exception when binding Short value in embedded mode</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1500</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When trying to insert a row into the table &lt;/p&gt;

&lt;p&gt;SHORT_TEST( ID int, SHORT_VAL smallint)&lt;/p&gt;

&lt;p&gt;an exception is thrown, if the object value given to PreparedStatement#setObject(int parameterIndex, Object x) is of type Short. The exception thrown is:&lt;/p&gt;

&lt;p&gt;&amp;#8212; SQLException &amp;#8212;&lt;br/&gt;
SQLState:  22005&lt;br/&gt;
Message:  An attempt was made to get a data value of type &apos;SMALLINT&apos; from a data value of type &apos;java.lang.Short&apos;.&lt;br/&gt;
ErrorCode:  20000&lt;br/&gt;
SQL Exception: An attempt was made to get a data value of type &apos;SMALLINT&apos; from a data value of type &apos;java.lang.Short&apos;.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.ConnectionChild.newSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.dataTypeConversion(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.setObject(Unknown Source)&lt;/p&gt;

&lt;p&gt;Tested on Derby 10.1.1.0 and 10.1.3.1. The same test runs fine in network mode.&lt;/p&gt;</description>
                <environment>WindowsXP</environment>
        <key id="12345796">DERBY-1500</key>
            <summary>PreparedStatement#setObject(int parameterIndex, Object x) throws SQL Exception when binding Short value in embedded mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="m_fuchs">Markus Fuchs</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Jul 2006 03:14:45 +0100</created>
                <updated>Fri, 21 Jan 2011 17:49:05 +0000</updated>
                            <resolved>Thu, 24 Aug 2006 07:11:56 +0100</resolved>
                                    <version>10.1.1.0</version>
                    <version>10.1.3.1</version>
                                    <fixVersion>10.1.3.2</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12420407" author="m_fuchs" created="Wed, 12 Jul 2006 03:17:18 +0100"  >&lt;p&gt;Test case for issue 1500. The test throws an exception running in embedded mode, and runs fine in network mode.&lt;/p&gt;</comment>
                            <comment id="12421943" author="djd" created="Tue, 18 Jul 2006 21:27:28 +0100"  >&lt;p&gt;java.lang.Short is not a valid object mapping for SMALLINT, JDBC defines the mapping as java.lang.Integer. The bug is with the network client not the embedded.&lt;/p&gt;</comment>
                            <comment id="12424238" author="kmarsden" created="Sat, 29 Jul 2006 01:06:09 +0100"  >&lt;p&gt;This one really has to be fixed in a feature release and better sooner than later since it may affect existing applications. I&apos;d call this Normal +&lt;/p&gt;</comment>
                            <comment id="12424240" author="djd" created="Sat, 29 Jul 2006 01:17:26 +0100"  >&lt;p&gt;Not a bug, java.lang.Short is not a valid mapping to any type in JDBC&lt;/p&gt;</comment>
                            <comment id="12424612" author="m_fuchs" created="Mon, 31 Jul 2006 20:02:04 +0100"  >&lt;p&gt;Hi Daniel,&lt;/p&gt;

&lt;p&gt;1) &quot; java.lang.Short is not a valid object mapping for SMALLINT&quot;:&lt;/p&gt;

&lt;p&gt;Why do I get the same exception on setObject(int parameterIndex, Object x) if I create the table w/ an INTEGER column for SHORT_VAL?&lt;/p&gt;

&lt;p&gt;2) &quot;java.lang.Short is not a valid mapping to any type in JDBC&quot;:&lt;/p&gt;

&lt;p&gt;Does that mean that classes having a &quot;Short&quot; field can not be mapped to the database? &lt;br/&gt;
Also, why does stmnt.setShort(1, Short.valueOf(&quot;0&quot;)) work in this case?&lt;/p&gt;

&lt;p&gt;Please consider re-opening this issue.&lt;/p&gt;

&lt;p&gt;&amp;#8211; markus.&lt;/p&gt;
</comment>
                            <comment id="12424621" author="djd" created="Mon, 31 Jul 2006 20:30:39 +0100"  >&lt;p&gt;Markus wrote:&lt;br/&gt;
 &quot;Also, why does stmnt.setShort(1, Short.valueOf(&quot;0&quot;)) work in this case? &quot;&lt;/p&gt;

&lt;p&gt;Because that&apos;s part of the JDBC api, convert a Java primitive short to a SMALLINT value and send it to the database.&lt;/p&gt;

&lt;p&gt;What you are asking for is a non-standard extension to JDBC, accepting java.lang.Short values to be valid input for setObject,&lt;br/&gt;
that&apos;s against the Derby charter. Much the same as it would be non-standard to accept  java.util.Date for a DATE column.&lt;/p&gt;

</comment>
                            <comment id="12424627" author="m_fuchs" created="Mon, 31 Jul 2006 20:51:24 +0100"  >&lt;p&gt;This behavior is apparantly implemented by many major database vendors, e.g. Oracle, SQLServer, Sybase, and the Derby network server. Because it&apos;s undefined by the JDBC spec doesn&apos;t mean that it &lt;b&gt;must&lt;/b&gt; not be provided for user convenience. &lt;/p&gt;</comment>
                            <comment id="12428649" author="lancea" created="Thu, 17 Aug 2006 14:24:50 +0100"  >&lt;p&gt;This behavior is expected to work correctly in JDBC.  The JDB C 4.0 spec has clarified this, ,but it is expected that it would work with any JDBC release.&lt;/p&gt;</comment>
                            <comment id="12428675" author="rhillegas" created="Thu, 17 Aug 2006 16:01:54 +0100"  >&lt;p&gt;I am assigning this to 10.2 in case we have some spare cycles.&lt;/p&gt;</comment>
                            <comment id="12429195" author="knutanders" created="Sat, 19 Aug 2006 14:55:58 +0100"  >&lt;p&gt;Derby Network Client and JCC already work correctly. I will fix the embedded driver.&lt;/p&gt;</comment>
                            <comment id="12429227" author="knutanders" created="Sat, 19 Aug 2006 22:50:21 +0100"  >&lt;p&gt;Attached is a fix for the issue. I haven&apos;t seen the updated JDBC 4.0 spec myself, but I have assumed that the new rows for Byte and Short in table B-5 of the spec are identical to the ones for BigDecimal, Boolean, Integer, Long, Float and Double.&lt;/p&gt;

&lt;p&gt;setObject(int, Byte) is translated to setByte(int, byte)&lt;br/&gt;
setObject(int, Short) is translated to setShort(int, short)&lt;/p&gt;

&lt;p&gt;Test cases for Byte and Short have been added to jdbcapi/parameterMapping.java.&lt;/p&gt;

&lt;p&gt;All master files for parameterMapping were updated. I have verified that embedded, DerbyNetClient and DerbyNet work. The five others (j9_foundation, j9_13, DerbyNet/ver2.6, DerbyNet/v2.8 and DerbyNet/ibm15) were updated following the same pattern, but I haven&apos;t tested those.&lt;/p&gt;

&lt;p&gt;Derbyall ran successfully on Solaris 10 x64, Sun JVM 1.5.0. The patch is ready for review. Thanks!&lt;/p&gt;</comment>
                            <comment id="12430169" author="knutanders" created="Thu, 24 Aug 2006 07:11:56 +0100"  >&lt;p&gt;Committed into trunk with revision 434309.&lt;br/&gt;
Committed into 10.2 with revision 434311.&lt;/p&gt;</comment>
                            <comment id="12508966" author="kmarsden" created="Fri, 29 Jun 2007 00:59:48 +0100"  >&lt;p&gt;Committed revision 551736 to 10.1 branch &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="32841">DERBY-310</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12336678" name="ShortTest.java" size="4205" author="m_fuchs" created="Wed, 12 Jul 2006 03:17:18 +0100"/>
                            <attachment id="12339173" name="derby-1500.diff" size="104052" author="knutanders" created="Sat, 19 Aug 2006 22:50:21 +0100"/>
                            <attachment id="12339174" name="derby-1500.stat" size="1040" author="knutanders" created="Sat, 19 Aug 2006 22:50:21 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Jul 2006 20:27:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22541</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0n3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37562</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>