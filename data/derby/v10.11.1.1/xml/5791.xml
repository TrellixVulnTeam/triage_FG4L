<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:45:11 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5791/DERBY-5791.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5791] Replication tests should use BaseTestCase.execJavaCmd() to run local commands</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5791</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The replication tests invoke Runtime.exec() directly in order to spawn processes. The sub-processes that run on the same host as the main test process, should instead be started with the helper method BaseTestCase.execJavaCmd(). Having all the tests use the helper method would make it easier if we for example want to pass specific flags to all sub-processes created in a test run.&lt;/p&gt;

&lt;p&gt;Note that the replication tests also have code for starting processes on a remote host via ssh. BaseTestCase.execJavaCmd() cannot do that, so only local processes can be started with the helper method. When the replication tests run as part of suites.All, all the spawned processes run locally.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12558422">DERBY-5791</key>
            <summary>Replication tests should use BaseTestCase.execJavaCmd() to run local commands</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 May 2012 13:35:57 +0100</created>
                <updated>Tue, 24 Jul 2012 18:31:12 +0100</updated>
                            <resolved>Wed, 30 May 2012 11:59:50 +0100</resolved>
                                    <version>10.10.1.1</version>
                                    <fixVersion>10.10.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13284861" author="knutanders" created="Tue, 29 May 2012 15:47:48 +0100"  >&lt;p&gt;Attaching a patch that makes ReplicationRun use&lt;br/&gt;
BaseTestCase.execJavaCmd() to run local commands. The patch is built&lt;br/&gt;
on top of the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5783&quot; title=&quot;Remove duplicated code for starting remote processes in replication tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5783&quot;&gt;&lt;del&gt;DERBY-5783&lt;/del&gt;&lt;/a&gt;, so it can&apos;t be committed until&lt;br/&gt;
that patch has been checked in.&lt;/p&gt;

&lt;p&gt;The patch rearranges the code so that Runtime.exec() is only called&lt;br/&gt;
two places in the code (one for remote processes, and one for local&lt;br/&gt;
processes), and replaces the call that creates the local processes&lt;br/&gt;
with a call to BaseTestCase.execJavaCmd().&lt;/p&gt;

&lt;p&gt;The replication tests passed with the patch. Running the full&lt;br/&gt;
regression test suite now.&lt;/p&gt;

&lt;p&gt;More details:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;junit/BaseTestCase.java&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Overloaded execJavaCmd() with a variant that allows specifying the&lt;br/&gt;
  working directory.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;functionTests/tests/replicationTests/Utils.java&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Added helper methods toStringArray() and splice() to replace some&lt;br/&gt;
  repeated operations in ReplicationRun.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Removed unused method NIOcopy.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;functionTests/tests/replicationTests/ReplicationRun.java&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Moved body of runUserCommand() method into runUserCommandLocally()&lt;br/&gt;
  to make it clearer that it was never used for remote processes.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Renamed runUserCommandInThread() runUserCommandInThreadLocally() to&lt;br/&gt;
  make it clearer that it was only for local processes, and to make&lt;br/&gt;
  method naming consistent with that of the methods that start remote&lt;br/&gt;
  processes.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Made runUserCommandInThreadLocally() and&lt;br/&gt;
  runUserCommandInThreadRemotely() wrap runUserCommandLocally() and&lt;br/&gt;
  runUserCommandRemotely(), respectively, to reduce the number of&lt;br/&gt;
  places that call exec(), and to reduce the total amount of code.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Made startServer() call runUserCommandInThreadLocally() and&lt;br/&gt;
  runUserCommandInThreadRemotely() instead of calling exec() directly,&lt;br/&gt;
  and made stopServer() call runUserCommandLocally() and&lt;br/&gt;
  runUserCommandRemotely() for the same reason.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Changed signatures of runUserCommand&lt;span class=&quot;error&quot;&gt;&amp;#91;InThread&amp;#93;&lt;/span&gt;Locally() to take the&lt;br/&gt;
  command as an array instead of a flat string, so that it could&lt;br/&gt;
  easily be passed on to BaseTestCase.execJavaCmd().&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Made runUserCommandLocally() call BaseTestCase.execJavaCmd().&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13285220" author="dagw" created="Tue, 29 May 2012 23:43:13 +0100"  >&lt;p&gt;Good cleanup, approach is good. I did not vet all the details, but from 10000 feet, +1.&lt;br/&gt;
If nothing else, diffstat gave me: 235 insertions&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/add.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, 437 deletions, so Derby gets slimmer &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13285571" author="knutanders" created="Wed, 30 May 2012 11:59:50 +0100"  >&lt;p&gt;Thanks, Dag. Committed r1344191.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12558085">DERBY-5783</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12530045" name="d5791-1a.diff" size="40119" author="knutanders" created="Tue, 29 May 2012 15:47:48 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 29 May 2012 22:43:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245862</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0alj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35535</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>