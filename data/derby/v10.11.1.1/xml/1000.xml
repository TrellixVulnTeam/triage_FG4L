<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:22:21 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1000/DERBY-1000.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1000] For LDAP authentication: derby.authentication.server should support ldaps:// as part of the server url.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1000</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;derby.authentication.server does not recognize secure ldap url - ie if  the url starts with ldaps:// &lt;/p&gt;

&lt;p&gt;Trying to connect using LDAP authentication with the following properties set&lt;br/&gt;
derby.authentication.provider=LDAP&lt;br/&gt;
derby.authentication.server=ldaps://xyz.abc.com:636&lt;br/&gt;
derby.authentication.ldap.searchBase=&apos;ou=xyz,o=abc.com&apos;&lt;br/&gt;
derby.authentication.ldap.searchFilter=&apos;(emailaddress=%USERNAME%)&apos;&lt;br/&gt;
derby.connection.requireAuthentication=true&lt;/p&gt;

&lt;p&gt;throws InvalidNameException&lt;/p&gt;

&lt;p&gt;ij&amp;gt; connect &apos;jdbc:derby:testdb;user=a;password=p&apos;;&lt;br/&gt;
ERROR 08004: Connection refused : javax.naming.InvalidNameException: Invalid name: /xyz.abc.com:636&lt;/p&gt;

&lt;p&gt;Code - LDAPAuthenticationSchemeImpl#setJNDIProviderProperties.&lt;br/&gt;
Problem is the code expects that if Context.PROVIDER_URL is not and if derby.authentication.server is set, then the ldapServer is either of the format //server:port  or it already starts with ldap://  else it just adds ldap://  .&lt;/p&gt;

&lt;p&gt;Thus for a ldaps://xyz.com:636  url , it will become ldap://ldaps://xyz.com:636&lt;/p&gt;

&lt;p&gt;                                                                                     in the code snippet, dflLDAPURL is ldap://&lt;/p&gt;

&lt;p&gt;				if (ldapServer.startsWith(dfltLDAPURL))&lt;br/&gt;
					this.providerURL = ldapServer;&lt;br/&gt;
				else if (ldapServer.startsWith(&quot;//&quot;))&lt;br/&gt;
					this.providerURL = &quot;ldap:&quot; + ldapServer;&lt;br/&gt;
				else&lt;br/&gt;
					this.providerURL = dfltLDAPURL + ldapServer;&lt;br/&gt;
			}&lt;br/&gt;
			initDirContextEnv.put(Context.PROVIDER_URL, providerURL);&lt;/p&gt;


&lt;p&gt;We should support specifiying secure ldap , ie ldaps://  in the derby.authentication.server. Add condition to support the ldaps:// &lt;br/&gt;
ie. &lt;br/&gt;
			if (ldapServer.startsWith(dfltLDAPURL) || ldapServer.startsWith(&quot;ldaps://&quot;))&lt;br/&gt;
					this.providerURL = ldapServer;&lt;/p&gt;

&lt;p&gt;========&lt;br/&gt;
A workaround to the problem is to set the Context.PROVIDER_URL instead.  &lt;/p&gt;</description>
                <environment>all</environment>
        <key id="12329096">DERBY-1000</key>
            <summary>For LDAP authentication: derby.authentication.server should support ldaps:// as part of the server url.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="andersmo">Anders Morken</assignee>
                                    <reporter username="skambha">Sunitha Kambhampati</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Feb 2006 15:52:37 +0000</created>
                <updated>Tue, 30 Jun 2009 01:14:43 +0100</updated>
                            <resolved>Fri, 7 Jul 2006 18:00:58 +0100</resolved>
                                    <version>10.0.2.0</version>
                    <version>10.0.2.1</version>
                    <version>10.1.1.0</version>
                    <version>10.1.2.1</version>
                    <version>10.1.3.1</version>
                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12366858" author="forsini" created="Sat, 18 Feb 2006 07:46:01 +0000"  >&lt;p&gt;Correct - I remember testing LDAPS using the Context.PROVIDER_URL route.&lt;/p&gt;

&lt;p&gt;The derby tuning guide documentation should also make mention of using the JNDI Context.PROVIDER_URL property to connect to an LDAP server, as an alternative to the derby &apos;derby.authentication.server&apos; property. (see &apos;derby.authentication.server&apos; property section).&lt;/p&gt;

&lt;p&gt;Upon fixing this simple issue, The syntax for the derby &apos;derby.authentication.server&apos; property should be enhanced to also mention LDAPS: as a valid syntax as well as adding an example in the respective section.&lt;/p&gt;

&lt;p&gt;derby.authentication.server=&lt;br/&gt;
[&lt;/p&gt;
{ ldap: | ldaps: | nisplus: }
&lt;p&gt;]&lt;br/&gt;
&lt;a href=&quot;/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;//&lt;/a&gt;&lt;/p&gt;
{
hostname
:
portnumber |
nisServerName
/
nisDomain
}

&lt;p&gt;##LDAPS example&lt;br/&gt;
derby.authentication.server=ldaps://godfrey:9090&lt;/p&gt;</comment>
                            <comment id="12372830" author="andersmo" created="Sun, 2 Apr 2006 21:40:50 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1000&quot; title=&quot;For LDAP authentication: derby.authentication.server should support ldaps:// as part of the server url.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1000&quot;&gt;&lt;del&gt;DERBY-1000&lt;/del&gt;&lt;/a&gt;.patch: This little one-line change is all it takes to make derby authenticate against a ldap server over SSL for me. (In addition to the necessary setup of the LDAP server, the self-signed certificate and telling the java SSL certificate verifier to trust it, of course. And the change in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1174&quot; title=&quot;NullPointerException in network server with LDAP authentication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1174&quot;&gt;&lt;del&gt;DERBY-1174&lt;/del&gt;&lt;/a&gt; which I needed for LDAP authentication to work at all for me.)&lt;/p&gt;

&lt;p&gt;This change didn&apos;t seem to cause any problems in derbyall - sysinfo and sysinfo_withproperties failed due to my locale,  the forupdate test fails in the tinderbox test of 390705 as well, and one failure of CompatibilityTest in the initial derbyall run went away when I ran the derbynetclientmats suite without a network server already started.&lt;/p&gt;

&lt;p&gt;As for documentation issues, I agree that the docs could use a bit of polishing when it comes to LDAP authentication. I&apos;ll see if I can figure out how to update them. =)&lt;/p&gt;</comment>
                            <comment id="12372850" author="andersmo" created="Mon, 3 Apr 2006 04:34:52 +0100"  >&lt;p&gt;DERBY1000-docs.patch is a suggestion for an update to the documentation if we start supporting ldaps:// URLs. Further updates to the docs regarding LDAP support will be attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-870&quot; title=&quot;Update documentation on setting up LDAP user authentication.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-870&quot;&gt;&lt;del&gt;DERBY-870&lt;/del&gt;&lt;/a&gt; if I end up writing some. =)&lt;/p&gt;</comment>
                            <comment id="12418713" author="andersmo" created="Sat, 1 Jul 2006 05:45:37 +0100"  >&lt;p&gt;Now that &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1174&quot; title=&quot;NullPointerException in network server with LDAP authentication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1174&quot;&gt;&lt;del&gt;DERBY-1174&lt;/del&gt;&lt;/a&gt; is resolved the patches attached to this issue is technically all you need to let Derby use SSL-enabled LDAP connections to a LDAP directory. While I&apos;ve tested this manually I haven&apos;t written a regression test for it. You need a lot of manual preparation to test this - most notably an SSL-enabled LDAP server to query and bind against, and you need the LDAP server&apos;s SSL certificate (or the CA certificate that signed the LDAP server&apos;s cert) in your java installation&apos;s trusted certificate store. See &lt;a href=&quot;http://java.sun.com/products/jndi/tutorial/ldap/security/ssl.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/products/jndi/tutorial/ldap/security/ssl.html&lt;/a&gt; for more details.&lt;br/&gt;
The fact that you need to import the ldap server&apos;s cert should probably be mentioned in the docs as well. Is the above URL &quot;stable&quot; enough for us to refer to in Derby documentation?&lt;/p&gt;</comment>
                            <comment id="12419625" author="skambha" created="Fri, 7 Jul 2006 07:53:57 +0100"  >&lt;p&gt;Thanks Anders for posting the patch as well as the doc changes. I applied the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1000&quot; title=&quot;For LDAP authentication: derby.authentication.server should support ldaps:// as part of the server url.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1000&quot;&gt;&lt;del&gt;DERBY-1000&lt;/del&gt;&lt;/a&gt;.patch and could successfully connect to a secure ldap server  that I have access to and it all works ok.   I briefly looked at the docs patch and it looked ok to me. I will leave the doc changes for someone more familiar with dita to comment. &lt;/p&gt;

&lt;p&gt;I am not sure how we can add tests for ldap, because it needs a ldap server setup etc. &lt;/p&gt;

&lt;p&gt;derby-1000.patch looks good to me.  I vote +1 for commit.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12419676" author="knutanders" created="Fri, 7 Jul 2006 18:00:58 +0100"  >&lt;p&gt;I think the doc patch is ready to be committed too.&lt;/p&gt;

&lt;p&gt;Code patch committed with revision 419852.&lt;br/&gt;
Doc patch committed with revision 419853.&lt;/p&gt;

&lt;p&gt;Thanks to Anders for fixing the code and updating the documentation. Thanks to Sunitha for reviewing the changes.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12324851" name="DERBY-1000.patch" size="672" author="andersmo" created="Sun, 2 Apr 2006 21:40:50 +0100"/>
                            <attachment id="12324856" name="DERBY1000-docs.patch" size="3496" author="andersmo" created="Mon, 3 Apr 2006 04:34:52 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 18 Feb 2006 07:46:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22253</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0v5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38864</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>