<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:19:53 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5817/DERBY-5817.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5817] Add support for the JaCoCo code coverage tool</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5817</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Add support for the JaCoCo code coverage tool (&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;).&lt;br/&gt;
While we are currently relying on EMMA for code coverage, the tool isn&apos;t being maintained. It works nicely for the time being, but having additional support for a tool that&apos;s being actively developed and maintained would be nice.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://www.eclemma.org/jacoco/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.eclemma.org/jacoco/&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12560599">DERBY-5817</key>
            <summary>Add support for the JaCoCo code coverage tool</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="kristwaa">Kristian Waagan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Jun 2012 09:05:17 +0100</created>
                <updated>Wed, 6 Feb 2013 20:41:22 +0000</updated>
                            <resolved>Thu, 21 Jun 2012 12:46:49 +0100</resolved>
                                    <version>10.10.1.1</version>
                                    <fixVersion>10.10.1.1</fixVersion>
                                    <component>Miscellaneous</component>
                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13294900" author="kristwaa" created="Thu, 14 Jun 2012 09:37:06 +0100"  >&lt;p&gt;Attaching patch 1a, which adds support for JaCoCo.&lt;/p&gt;

&lt;p&gt;The change in build.xml enables JaCoCo, and the change in BaseTestCase ensure that JaCoCo will also be enabled in spawned Java processes (as for EMMA).&lt;/p&gt;

&lt;p&gt;There are two new top-level targets, based on junit-all and junit-single:&lt;br/&gt;
 jacoco-all&lt;br/&gt;
 jacoco-single&lt;/p&gt;

&lt;p&gt;You have to download JaCoCo and place the two jar files jacocoant.jar and jacocoagent.jar in tools/java. The targets above will complain if these files are missing.&lt;/p&gt;

&lt;p&gt;When running jacoco-all I&apos;m still seeing one error, which appears to be a problem with ASM, which is used by JaCoCo. I&apos;ll see if I can find any more information on this issue. The error doesn&apos;t cause the run to be aborted, and the coverage data appears ok.&lt;br/&gt;
The report ends up in junit_&lt;/p&gt;
{timestamp}
&lt;p&gt;/coverage-report.&lt;/p&gt;

&lt;p&gt;Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="13295651" author="kristwaa" created="Fri, 15 Jun 2012 14:31:07 +0100"  >&lt;p&gt;Attaching patch 1b, which also adds a derbyall target.&lt;/p&gt;

&lt;p&gt;Needs some additional testing, but feel free to provide feedback.&lt;br/&gt;
Not quite sure what to do about junit-pptesting yet, since it requires the classes-directory to be present. I&apos;ll probably move it away from junit-all and run it explicitly.&lt;/p&gt;

&lt;p&gt;With this patch the coverage increased with about 2 percent. The compatibility test is still not included (I want rewrite it first &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ).&lt;/p&gt;</comment>
                            <comment id="13395819" author="kristwaa" created="Mon, 18 Jun 2012 12:26:20 +0100"  >&lt;p&gt;Attaching patch 1c, which further improves the JaCoCo support in build.xml.&lt;/p&gt;

&lt;p&gt;I refactored some code related to getting the svn version, because I&apos;m adding the version to the report title.&lt;/p&gt;

&lt;p&gt;I updated the report at people.apache.org/~kristwaa/jacoco/ with the results produced by patch 1c and the target jacoco-complete.&lt;/p&gt;

&lt;p&gt;I think the EMMA results include coverage data from runs with several different JVM versions. I have not added support for that, but assuming the merged.exec file is kept from each run a separate merge/report target can be used.&lt;/p&gt;

&lt;p&gt;Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="13398357" author="kristwaa" created="Thu, 21 Jun 2012 12:46:50 +0100"  >&lt;p&gt;Committed patch 1c to trunk with revision 1352502.&lt;/p&gt;

&lt;p&gt;This concludes the initial work on adding support for JaCoCo. Further improvements can be tracked under their own JIRAs.&lt;/p&gt;</comment>
                            <comment id="13572798" author="kristwaa" created="Wed, 6 Feb 2013 20:41:22 +0000"  >&lt;p&gt;I was suspecting that JaCoCo was slower than EMMA, but the results from a new test disagrees.&lt;/p&gt;

&lt;p&gt;Here&apos;s what I saw from runs on a Windows Vista machine:&lt;br/&gt;
 o ant junit-all: ~107 minutes&lt;br/&gt;
 o ant emma-all: ~135 minutes&lt;br/&gt;
 o ant jacoco-junit: ~134 minutes&lt;/p&gt;

&lt;p&gt;The times for EMMA and JaCoCo are comparable, but there are some differences (EMMAs instrumentation step, the JaCoCo target doesn&apos;t build a report - use ant jacoco-complete for that).&lt;br/&gt;
I did see some warnings where files couldn&apos;t be deleted immediately, so it appears we still have issues in the tests where resources aren&apos;t closed timely or we otherwise do concurrent access on files.&lt;/p&gt;

&lt;p&gt;Closing the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12532058" name="derby-5817-1a-jacoco_support.diff" size="10583" author="kristwaa" created="Thu, 14 Jun 2012 09:37:06 +0100"/>
                            <attachment id="12532192" name="derby-5817-1b-jacoco_support.diff" size="13671" author="kristwaa" created="Fri, 15 Jun 2012 14:31:07 +0100"/>
                            <attachment id="12532398" name="derby-5817-1c-jacoco_support.diff" size="16056" author="kristwaa" created="Mon, 18 Jun 2012 12:26:20 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245894</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0bbr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35653</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>