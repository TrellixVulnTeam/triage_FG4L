<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:44:01 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4215/DERBY-4215.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4215] Extra permissions tuple if you hard-upgrade from 10.0 without doing an intermediate hard-upgrade to 10.1</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4215</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If you hard-upgrade a 10.0 database to 10.2 or later (without an intermediate hard-upgrade to 10.1), you will see an extra permissions tuple in SYSROUTINEPERMS.&lt;/p&gt;

&lt;p&gt;Running the following query&lt;/p&gt;

&lt;p&gt;  select p.grantee, p.grantor, a.alias, p.grantoption from sys.sysroutineperms p, sys.sysaliases a where a.aliasid = p.aliasid&lt;/p&gt;

&lt;p&gt;returns the following results when run against a 10.0 database which was hard-upgraded to 10.3.3.0:&lt;/p&gt;

&lt;p&gt;PUBLIC | null | SYSCS_INPLACE_COMPRESS_TABLE | N&lt;br/&gt;
PUBLIC | APP | SYSCS_SET_RUNTIMESTATISTICS | N&lt;br/&gt;
PUBLIC | APP | SYSCS_SET_STATISTICS_TIMING | N&lt;br/&gt;
PUBLIC | APP | SYSCS_INPLACE_COMPRESS_TABLE | N&lt;br/&gt;
PUBLIC | APP | SYSCS_COMPRESS_TABLE | N&lt;br/&gt;
PUBLIC | APP | SYSCS_GET_RUNTIMESTATISTICS | N&lt;/p&gt;

&lt;p&gt;versus the following results when the same query is run against a freshly created 10.3 database:&lt;/p&gt;

&lt;p&gt;PUBLIC | APP | SYSCS_COMPRESS_TABLE | N&lt;br/&gt;
PUBLIC | APP | SYSCS_SET_RUNTIMESTATISTICS | N&lt;br/&gt;
PUBLIC | APP | SYSCS_SET_STATISTICS_TIMING | N&lt;br/&gt;
PUBLIC | APP | SYSCS_GET_RUNTIMESTATISTICS | N&lt;br/&gt;
PUBLIC | APP | SYSCS_INPLACE_COMPRESS_TABLE | N&lt;/p&gt;</description>
                <environment></environment>
        <key id="12424629">DERBY-4215</key>
            <summary>Extra permissions tuple if you hard-upgrade from 10.0 without doing an intermediate hard-upgrade to 10.1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 May 2009 19:48:37 +0100</created>
                <updated>Fri, 21 Jan 2011 18:27:56 +0000</updated>
                            <resolved>Tue, 23 Jun 2009 18:22:40 +0100</resolved>
                                    <version>10.6.1.0</version>
                                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12723105" author="rhillegas" created="Tue, 23 Jun 2009 16:13:17 +0100"  >&lt;p&gt;Attaching derby-4215-01-aa-deleteTuple.diff. This patch adds 10.6 upgrade logic to delete the corrupt permissions tuple when upgrading from 10.2 or later.&lt;/p&gt;

&lt;p&gt;I added a new 10.6 upgrade test to make sure that the problem does not creep in again. I added some problem trajectories to the UpgradeTrajectoryTest to verify that this patch fixes the problem. The problem trajectories live in the method makeSampleTrajectories() and you can verify that this patch fixes the problem by uncommenting the call to that method.&lt;/p&gt;

&lt;p&gt;The direct upgrade from 10.0 to 10.6 appears to have been fixed by the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4127&quot; title=&quot;ArrayIndexOutOfBoundsException in DatabaseMetaDataTest when run in Soft Upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4127&quot;&gt;&lt;del&gt;DERBY-4127&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java&lt;/p&gt;

&lt;p&gt;Add new method which deletes the bad permissions tuple.&lt;/p&gt;


&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/catalog/DD_Version.java&lt;/p&gt;

&lt;p&gt;Call that method during hard-upgrade if the source version is 10.2, 10.3, 10.4, or 10.5.&lt;/p&gt;


&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Version.java&lt;/p&gt;

&lt;p&gt;Make the Version object more capable.&lt;/p&gt;



&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_6.java&lt;/p&gt;

&lt;p&gt;Add a regression test case to make sure that the problem does not creep in again.&lt;/p&gt;


&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/UpgradeTrajectoryTest.java&lt;/p&gt;

&lt;p&gt;Add a test trajectory to verify that the problem is fixed.&lt;/p&gt;</comment>
                            <comment id="12723195" author="rhillegas" created="Tue, 23 Jun 2009 18:22:27 +0100"  >&lt;p&gt;Regression tests passed cleanly for me. Committed at subversion revision 787754.&lt;/p&gt;</comment>
                            <comment id="12723196" author="kmarsden" created="Tue, 23 Jun 2009 18:29:38 +0100"  >&lt;p&gt;Hi Rick,&lt;/p&gt;

&lt;p&gt;I was wondering, does this bug have any potential impact on the user in normal operations?&lt;/p&gt;</comment>
                            <comment id="12723200" author="rhillegas" created="Tue, 23 Jun 2009 18:38:50 +0100"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;It&apos;s possible that a user application could become confused if it were doing something tricky like reading the system tables and making some kind of decision based on the permissions granted to SYSCS_INPLACE_COMPRESS_TABLE. Other than that, I can&apos;t think of how this would affect a user application today. I&apos;m regarding this as a ticking time-bomb: it hasn&apos;t gone off yet but we want to defuse it before it does.&lt;/p&gt;</comment>
                            <comment id="12723206" author="kmarsden" created="Tue, 23 Jun 2009 18:46:25 +0100"  >&lt;p&gt;Thanks for the explanation and for mining and correcting these upgrade issues.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12419671">DERBY-4127</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12422591">DERBY-4157</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12411543" name="derby-4215-01-aa-deleteTuple.diff" size="11090" author="rhillegas" created="Tue, 23 Jun 2009 16:13:17 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10364"><![CDATA[Data corruption]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 23 Jun 2009 17:29:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24107</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0jqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37016</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>