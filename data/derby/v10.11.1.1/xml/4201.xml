<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:40:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4201/DERBY-4201.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4201] SecureServerTest AssertionFailedError: Timed out waiting for network server to start</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4201</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I saw this  failure in the nightly run on  4/27 on the 10.5 branch - 10.5.1.2 - (769232).  I have not seen it in previous runs on the same machine.  There were actually two failures in the test. I think the second one failed because of the first so am not reporting a separate issue for that.&lt;/p&gt;

&lt;p&gt;There were 2 failures:&lt;br/&gt;
1) SecureServerTest( Opened = false, Authenticated= false, CustomDerbyProperties= null, WildCardHost= null )junit.framework.AssertionFailedError: Timed out waiting for network server to start:Spawned SpawnedNetworkServer exitCode=0&lt;br/&gt;
	at org.apache.derbyTesting.junit.NetworkServerTestSetup.setUp(NetworkServerTestSetup.java:200)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:18)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
2) SecureServerTest( Opened = false, Authenticated= false, CustomDerbyProperties= functionTests/tests/derbynet/SecureServerTest.derby.properties, WildCardHost= null )junit.framework.AssertionFailedError: directory trace does not exist&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SecureServerTest.setTraceDirectory(SecureServerTest.java:386)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SecureServerTest.testServerStartup(SecureServerTest.java:358)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:85)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:58)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java(Compiled Code))&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:105)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;/p&gt;

</description>
                <environment>java version &amp;quot;1.4.2&amp;quot;&lt;br/&gt;
Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.2)&lt;br/&gt;
Classic VM (build 1.4.2, J2RE 1.4.2 IBM build cxia32142-20061124 (SR7) (JIT enabled: jitc))&lt;br/&gt;
SUSE linux running on vmware.</environment>
        <key id="12424187">DERBY-4201</key>
            <summary>SecureServerTest AssertionFailedError: Timed out waiting for network server to start</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mamtas">Mamta A. Satoor</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                            <label>derby_triage10_8</label>
                    </labels>
                <created>Wed, 29 Apr 2009 17:42:02 +0100</created>
                <updated>Fri, 15 Nov 2013 08:15:13 +0000</updated>
                            <resolved>Thu, 22 Mar 2012 23:26:06 +0000</resolved>
                                    <version>10.5.2.0</version>
                    <version>10.7.1.1</version>
                    <version>10.8.2.2</version>
                                    <fixVersion>10.5.3.2</fixVersion>
                    <fixVersion>10.6.2.4</fixVersion>
                    <fixVersion>10.7.1.4</fixVersion>
                    <fixVersion>10.8.3.0</fixVersion>
                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12737183" author="myrna" created="Thu, 30 Jul 2009 18:14:18 +0100"  >&lt;p&gt;Seen again at least on linux/vmware combo with 10.5.2.1 (799161) with ibm 1.4.2. (same build); and also during the 10.5.2.0 testing (once with ibm15 on linux/vmware; once with ibm 16 on XP).&lt;/p&gt;</comment>
                            <comment id="12965656" author="knutanders" created="Wed, 1 Dec 2010 11:01:42 +0000"  >&lt;p&gt;Seen again when testing the 10.7.1.1 release candidate: &lt;a href=&quot;http://dbtg.foundry.sun.com/derby/test/10.7.1.1_RC/logs/jvm1.6-64/sles/suitesAll/report.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.foundry.sun.com/derby/test/10.7.1.1_RC/logs/jvm1.6-64/sles/suitesAll/report.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13128748" author="knutanders" created="Mon, 17 Oct 2011 10:43:52 +0100"  >&lt;p&gt;Seen again when testing the 10.8.2.2 release candidate: &lt;a href=&quot;http://dbtg.foundry.sun.com/derby/test/10.8.2.2_RC/logs/jvm1.6/lin/suitesAll/report.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.foundry.sun.com/derby/test/10.8.2.2_RC/logs/jvm1.6/lin/suitesAll/report.txt&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13162821" author="knutanders" created="Mon, 5 Dec 2011 15:17:37 +0000"  >&lt;p&gt;Using the sleep-repro.diff patch attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5194&quot; title=&quot;AutoloadTest timed out waiting for network server to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5194&quot;&gt;&lt;del&gt;DERBY-5194&lt;/del&gt;&lt;/a&gt;, I&apos;m able to reproduce the failure reported here too. Not when running SecureServerTest alone, but when running as part of a suite so that there is a network server from an earlier test case that&apos;s only partially shut down when SecureServerTest starts.&lt;/p&gt;

&lt;p&gt;See the attached repro.diff that combines the changes in the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5194&quot; title=&quot;AutoloadTest timed out waiting for network server to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5194&quot;&gt;&lt;del&gt;DERBY-5194&lt;/del&gt;&lt;/a&gt; repro patch with adding NetHarnessJavaTest at the beginning of the test suite returned by SecureServerTest.suite(). With that patch, SecureServerTest fails when running alone.&lt;/p&gt;

&lt;p&gt;The suspected cause of this intermittent failure is that the server used in an earlier test case might not be fully shut down when a new test case starts. The server shutdown command doesn&apos;t return until the server has stopped responding to ping. That works most of the time, but since it stops responding to ping before it actually releases the server socket, there is a possibility that the new server is started too early and fails to start listening on the port.&lt;/p&gt;</comment>
                            <comment id="13162828" author="knutanders" created="Mon, 5 Dec 2011 15:35:11 +0000"  >&lt;p&gt;Attaching a patch (d4201-1a.diff) which attempts to address these intermittent failures by making NetworkServerTestSetup wait until the previous test has completely shut down its server instance, before it tries to start a new server.&lt;/p&gt;

&lt;p&gt;This is done by attempting to start a ServerSocket listening on the server port and immediately closing it. If it succeeds, the decorator assumes it is safe to start a new server. If it fails, the decorator waits a little while (0.1 sec) before it tries again. If it doesn&apos;t succeed until the server startup timeout (default 40 sec, configurable with derby.tests.networkServerStartTimeout) has elapsed, it gives up and report an exception.&lt;/p&gt;

&lt;p&gt;SecureServerTest passes with this patch (when using the repro.diff patch to provoke the problem), and so does AutoloadTest (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5194&quot; title=&quot;AutoloadTest timed out waiting for network server to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5194&quot;&gt;&lt;del&gt;DERBY-5194&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="13163495" author="knutanders" created="Tue, 6 Dec 2011 10:22:56 +0000"  >&lt;p&gt;Committed revision 1210846.&lt;/p&gt;

&lt;p&gt;I believe this issue is also what&apos;s causing &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4265&quot; title=&quot;timed out waiting for server to start in  StatementPoolingTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4265&quot;&gt;&lt;del&gt;DERBY-4265&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4914&quot; title=&quot;Utf8CcsidManagerClientTest timed out waiting for network server to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4914&quot;&gt;&lt;del&gt;DERBY-4914&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5194&quot; title=&quot;AutoloadTest timed out waiting for network server to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5194&quot;&gt;&lt;del&gt;DERBY-5194&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5518&quot; title=&quot;NetworkServerMBeanTest timed out waiting for network server to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5518&quot;&gt;&lt;del&gt;DERBY-5518&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5520&quot; title=&quot;testDatabasesShutDownWhenNSShutdownAPI(org.apache.derbyTesting.functionTests.tests.derbynet.ShutDownDBWhenNSShutsDownTest)junit.framework.AssertionFailedError: Timed out waiting for network server to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5520&quot;&gt;&lt;del&gt;DERBY-5520&lt;/del&gt;&lt;/a&gt;, so we might close those issues as duplicates for now and reopen them if they happen again.&lt;/p&gt;</comment>
                            <comment id="13164012" author="dagw" created="Wed, 7 Dec 2011 00:46:03 +0000"  >&lt;p&gt;Clean patch, looks good to me! +1. &lt;br/&gt;
Good to get all these issues cleaned up. Thanks, Knut.&lt;/p&gt;</comment>
                            <comment id="13169942" author="myrna" created="Thu, 15 Dec 2011 02:44:11 +0000"  >&lt;p&gt;Is this fix suitable for backport to 10.8?&lt;/p&gt;</comment>
                            <comment id="13169997" author="knutanders" created="Thu, 15 Dec 2011 07:04:19 +0000"  >&lt;p&gt;I think so. I have run the regression tests on 10.8 with the patch without seeing any problems, and I haven&apos;t seen any related problems in the nightly tests on trunk after the fix went in. Backported and committed revision 1214635.&lt;/p&gt;</comment>
                            <comment id="13229392" author="kmarsden" created="Wed, 14 Mar 2012 17:19:50 +0000"  >&lt;p&gt;Reopen for 10.5 backport consideration. If working on the backport for this issue. Temporarily assign yourself and add a comment that you are working on it. When finished, reresolve with the new fix versions or label backport_reject_10_x as appropriate.&lt;/p&gt;</comment>
                            <comment id="13234767" author="mamtas" created="Wed, 21 Mar 2012 18:09:45 +0000"  >&lt;p&gt;Assigning to myself to do the backport. &lt;/p&gt;</comment>
                            <comment id="13823426" author="knutanders" created="Fri, 15 Nov 2013 08:15:13 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update: close all resolved issues that haven&amp;#39;t had any activity the last year&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12427599">DERBY-4265</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12504367">DERBY-5194</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12533669">DERBY-5518</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12533731">DERBY-5520</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12480807">DERBY-4914</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12379620">DERBY-3101</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12504344">DERBY-5192</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12533669">DERBY-5518</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12535750">DERBY-5547</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12541097">DERBY-5598</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12480807">DERBY-4914</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12501060">DERBY-5123</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12546430">DERBY-5654</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12506122" name="d4201-1a.diff" size="3932" author="knutanders" created="Mon, 5 Dec 2011 15:35:11 +0000"/>
                            <attachment id="12506120" name="repro.diff" size="1595" author="knutanders" created="Mon, 5 Dec 2011 15:17:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 30 Jul 2009 17:14:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24097</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0ckf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35854</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>