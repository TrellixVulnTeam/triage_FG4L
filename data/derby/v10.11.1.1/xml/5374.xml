<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:39:57 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5374/DERBY-5374.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5374] converted ij5Test fails with weme6.2 (CDC/Foundation): junit.framework.ComparisonFailure: Output at line 1 expected:&lt;CONNECTION0* - 	jdbc:derby:wombat&gt; but was:&lt;ERROR XJ004: Database &apos;&apos; not found.&gt;</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5374</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The newly converted (to junit) test ij5Test fails with weme 6.2:&lt;/p&gt;

&lt;p&gt;ij5(org.apache.derbyTesting.functionTests.tests.tools.ij5Test)junit.framework.ComparisonFailure: Output at line 1 expected:&amp;lt;CONNECTION0* - 	jdbc:derby:wombat&amp;gt; but was:&amp;lt;ERROR XJ004: Database &apos;&apos; not found.&amp;gt;&lt;br/&gt;
	at junit.framework.AssertionFailedError.&amp;lt;init&amp;gt;(AssertionFailedError.java:11)&lt;br/&gt;
	at junit.framework.ComparisonFailure.&amp;lt;init&amp;gt;(ComparisonFailure.java:19)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon(CanonTestCase.java:109)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptTestCase.java:204)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:112)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;

&lt;p&gt;This is likely a similar problem as described in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5373&quot; title=&quot;test ImportExportIJ fails with weme 6.2; junit.framework.ComparisonFailure: Output at line 1 expected:&amp;lt;ij&amp;gt; --&amp;gt; but was:&amp;lt;ERROR XJ004: Database &amp;#39;&amp;#39; not found.&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5373&quot;&gt;&lt;del&gt;DERBY-5373&lt;/del&gt;&lt;/a&gt; (re importExportIJ). &lt;/p&gt;

&lt;p&gt;see also (until cleaned up at some point in the future): &lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/weme6.2/1152992-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/weme6.2/1152992-suites.All_diff.txt&lt;/a&gt;&lt;/p&gt;</description>
                <environment>windows XP, with weme6.2 (IBM&amp;#39;s CDC/Foundation implementation)</environment>
        <key id="12517943">DERBY-5374</key>
            <summary>converted ij5Test fails with weme6.2 (CDC/Foundation): junit.framework.ComparisonFailure: Output at line 1 expected:&lt;CONNECTION0* - 	jdbc:derby:wombat&gt; but was:&lt;ERROR XJ004: Database &apos;&apos; not found.&gt;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="myrna">Myrna van Lunteren</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Aug 2011 18:37:40 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:45 +0100</updated>
                            <resolved>Tue, 9 Aug 2011 01:08:00 +0100</resolved>
                                    <version>10.9.1.0</version>
                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13079710" author="bryanpendleton" created="Fri, 5 Aug 2011 01:53:31 +0100"  >&lt;p&gt;Could it be that both &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5373&quot; title=&quot;test ImportExportIJ fails with weme 6.2; junit.framework.ComparisonFailure: Output at line 1 expected:&amp;lt;ij&amp;gt; --&amp;gt; but was:&amp;lt;ERROR XJ004: Database &amp;#39;&amp;#39; not found.&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5373&quot;&gt;&lt;del&gt;DERBY-5373&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5374&quot; title=&quot;converted ij5Test fails with weme6.2 (CDC/Foundation): junit.framework.ComparisonFailure: Output at line 1 expected:&amp;lt;CONNECTION0* - 	jdbc:derby:wombat&amp;gt; but was:&amp;lt;ERROR XJ004: Database &amp;#39;&amp;#39; not found.&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5374&quot;&gt;&lt;del&gt;DERBY-5374&lt;/del&gt;&lt;/a&gt; can be fixed the same way as &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5346&quot; title=&quot;ij3Test fails on phoneME&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5346&quot;&gt;&lt;del&gt;DERBY-5346&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;

&lt;p&gt;I don&apos;t have phoneme or weme, but hopefully the solution is to make the same change to ij5Test.java&lt;br/&gt;
and importExportIJTest.java as was made to ij3Test.java in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5346&quot; title=&quot;ij3Test fails on phoneME&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5346&quot;&gt;&lt;del&gt;DERBY-5346&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13079729" author="myrna" created="Fri, 5 Aug 2011 02:24:58 +0100"  >&lt;p&gt;I was hoping the same thing, but I cannot reproduce the test failure on my machine.&lt;/p&gt;

&lt;p&gt;I did see another test failure in the ij5 test on my machine though:&lt;/p&gt;

&lt;p&gt;1) ij5(org.apache.derbyTesting.functionTests.tests.tools.ij5Test)java.lang.NoSuchMethodError: java/sql/DatabaseMetaData.getURL()Ljava/lang/String;&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.showConnectionsMethod(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.supportIJProperties(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.goScript(Unknown Source)&lt;br/&gt;
	at org.apache.derby.tools.ij.runScript(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptTestCase.java:191)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:112)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;

&lt;p&gt;I will look at that more closely too, but I did notice that the old ij5.sql test did not run with foundation profile, for it had this in ij5_app.properties:&lt;br/&gt;
#Exclude for J2ME/Foundation - test requires java.sql.Driver&lt;br/&gt;
runwithfoundation=false&lt;/p&gt;</comment>
                            <comment id="13080578" author="houxzhang" created="Sun, 7 Aug 2011 15:02:57 +0100"  >&lt;p&gt;Then, for ij5Test, a JDBC.vmSupportsJSR169() should be added to avoid it run on j2me.&lt;/p&gt;

&lt;p&gt;Hi, Myrna, you&apos;ve said &quot;I did see another test failure in the ij5 test on my machine though: &quot;, What machine did you run on, please? Is it j2me or a common pc platform?&lt;/p&gt;
</comment>
                            <comment id="13081057" author="myrna" created="Mon, 8 Aug 2011 17:59:15 +0100"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Apologies if I&apos;ve been unclear. The failure from the description is seen on the machine where tests are run nightly - this is a Windows XP desktop (I think it&apos;s an IBM ThinkCentre). This machine runs suites.All with ibm 1.5, 1.6 and weme 6.2 (which is IBM&apos;s implementation of the J2ME/CDC/Foundation profile). The test failure is because at the top of the .out file, there is an extra message &apos;ERROR XJ004: Database &apos; &apos; not found, which isn&apos;t in the master (and doesn&apos;t show up on the other jvms). I think it&apos;s possible that this message would go away if we specify the properties as in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5346&quot; title=&quot;ij3Test fails on phoneME&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5346&quot;&gt;&lt;del&gt;DERBY-5346&lt;/del&gt;&lt;/a&gt;...&lt;/p&gt;

&lt;p&gt;But I tried to reproduce this failure with weme 6.2 on my laptop, which is a Thinkpad T60 with Windows XP - by running the test by itself, by running a modified tools suite, running the full tools suite, and finally running the full suites.All, and I did not see the failure. I used the same weme version on both machines.&lt;/p&gt;

&lt;p&gt;So I&apos;m still struggling to figure out when this happens on the nightly machine.&lt;/p&gt;

&lt;p&gt;The getURL(String) not found message I got on my laptop, in all of the experiments indicated above. I&apos;m confused about that too, because the failure on the nightly machine really indicates that the entire test was executed correctly, which seems impossible based on the behavior on my laptop.&lt;/p&gt;

&lt;p&gt;It would be interesting to know if either of those problems shows with PhoneME, but I don&apos;t have access to that.&lt;/p&gt;</comment>
                            <comment id="13081135" author="myrna" created="Mon, 8 Aug 2011 20:12:52 +0100"  >&lt;p&gt;I&apos;ve found out the difference between the nightly run and what I was doing on my laptop; in the nightly run it was already having -Dij.dataSource=org.apache.derby.jdbc.EmbeddedSimpleDataSource set.&lt;br/&gt;
Without that, like on my laptop, ij will try to connect using java.sql.Driver subclasses, including using a getURL method that&apos;s not available on this jvm.&lt;/p&gt;

&lt;p&gt;If memory serves me right, with ij.showNoConnectionsAtStart=false (so, show connections at start, if I understand this double negation) we get a different output between dataSources and Driver connections.&lt;br/&gt;
I&apos;m experimenting to see if there&apos;s a way to get the same output still for running with J2ME/CDC and full-fledged jvms, but no luck so far.&lt;/p&gt;</comment>
                            <comment id="13081305" author="myrna" created="Tue, 9 Aug 2011 00:52:14 +0100"  >&lt;p&gt;With weme 6.2 (j2ME/Foundation), with the following in ijTest5:&lt;br/&gt;
        if (JDBC.vmSupportsJSR169()) &lt;/p&gt;
{
            props.setProperty(&quot;ij.dataSource&quot;,
                              &quot;org.apache.derby.jdbc.EmbeddedSimpleDataSource&quot;);
            props.setProperty(&quot;ij.dataSource.databaseName&quot;, &quot;wombat&quot;);
            props.setProperty(&quot;ij.dataSource.createDatabase&quot;, &quot;create&quot;);
        }
&lt;p&gt;I get a diff with weme 6.2 if all three lines are there, because the database was already created. With showNoConnectionsAtStartup=true this gets masked...&lt;br/&gt;
If I comment out the createDatabase property line, I get a diff because of an extra connection (i.e. it shows Connection0 and Connection1. This is because of the CleanDatabase Setup).&lt;br/&gt;
If I comment out also the ij.dataSource.databaseName line, I get an extra line with error message &apos;XJ004: Database &apos; &apos; not found.&lt;br/&gt;
And if I don&apos;t set ij.dataSource at all, we get the getURL(String) method not found error.&lt;/p&gt;

&lt;p&gt;In all, I don&apos;t think this test can be made to work exactly the same with j2ME as with the more richer jvms. &lt;br/&gt;
In the old harness we handled this sort of difference by adding another master file, but although it would&apos;ve made the test work, maintaining multiple masters is a nightmare, and as this test never ran with JSR169/j2ME/Foundation, and it&apos;s not testing major functionality, but only one test case, I think it&apos;s ok to not run this with JSR169/j2ME/Foundation.&lt;/p&gt;

&lt;p&gt;So I&apos;m attaching a patch that I will commit shortly, which skips this test from running with JSR169, both in the test itself and in the tools._Suite.&lt;br/&gt;
In addition, I noticed the .sql file still mentions ConnOne, which was removed, so I changed that to say Connection0.&lt;/p&gt;</comment>
                            <comment id="13081311" author="myrna" created="Tue, 9 Aug 2011 01:01:22 +0100"  >&lt;p&gt;somehow the connection0 change didn&apos;t make it in the first svn diff. &lt;/p&gt;</comment>
                            <comment id="13081316" author="myrna" created="Tue, 9 Aug 2011 01:08:00 +0100"  >&lt;p&gt;resolving after commit of the patch with revision 1155163.&lt;br/&gt;
Will close after a round of nightly tests.&lt;/p&gt;</comment>
                            <comment id="13081382" author="bryanpendleton" created="Tue, 9 Aug 2011 03:43:31 +0100"  >&lt;p&gt;Thanks Myrna!&lt;/p&gt;</comment>
                            <comment id="13081650" author="houxzhang" created="Tue, 9 Aug 2011 15:22:56 +0100"  >&lt;p&gt;Thanks for your patient and valuable work, Myrna!&lt;/p&gt;</comment>
                            <comment id="13685347" author="knutanders" created="Mon, 17 Jun 2013 10:19:45 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12517717">DERBY-5373</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12489775" name="DERBY-5374.diff" size="4043" author="myrna" created="Tue, 9 Aug 2011 01:01:22 +0100"/>
                            <attachment id="12489773" name="DERBY-5374.diff" size="2670" author="myrna" created="Tue, 9 Aug 2011 00:52:13 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Aug 2011 00:53:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24804</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0fjr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36337</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>