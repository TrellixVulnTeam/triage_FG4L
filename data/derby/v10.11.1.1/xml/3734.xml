<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:07:22 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3734/DERBY-3734.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3734] Maximum value allowed for derby.storage.fileCacheSize (100) is too low for large system.  Increase the maximum value and redocument the property.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3734</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Increasing the value of the undocumented property:  derby.storage.fileCacheSize improves Derby performance in our system but the maximum allowed value (100) is not large enough to accommodate our system.  Our performance engineer reports:&lt;/p&gt;

&lt;p&gt;The following stack shows items being evicted from Derby&apos;s container cache.  Extra debug code showed that the cache was at its maximum size (100), and that about 1 in 25 accesses to the cache was resulting in a miss (forcing another item to be evicted).  Since this results in synchronous disk write, performance is bottlenecked on IO.  Patching Derby to allow the cache to grow to 200 entries solved the performance problem.&lt;/p&gt;

&lt;p&gt;Performance is severely degraded.  CPU utilization is low &amp;#8211; performance is IO bound.  A sampling of stack dumps for the key thread consistently have the following methods at the top of the stack:&lt;/p&gt;

&lt;p&gt;at sun/nio/ch/FileChannelImpl.force0(Native Method)&lt;br/&gt;
at sun/nio/ch/FileChannelImpl.force(FileChannelImpl.java:392(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/io/DirRandomAccessFile4.sync(Bytecode PC:5(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/store/raw/data/RAFContainer.writeRAFHeader(Bytecode PC:86(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/store/raw/data/RAFContainer.clean(Bytecode PC:84(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/services/cache/CachedItem.clean(Bytecode PC:7(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/services/cache/Clock.rotateClock(Bytecode PC:7(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/services/cache/Clock.findFreeItem(Bytecode PC:17(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/services/cache/Clock.find(Bytecode PC:71(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/store/raw/data/BaseDataFileFactory.openContainer(Bytecode PC:65(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/store/raw/data/BaseDataFileFactory.openContainer(Bytecode PC:7(Compiled Code))&lt;br/&gt;
at org/apache/derby/impl/store/raw/xact/Xact.openContainer(Bytecode PC:29(Compiled Code))&lt;/p&gt;</description>
                <environment>Derby 10.3.3</environment>
        <key id="12398728">DERBY-3734</key>
            <summary>Maximum value allowed for derby.storage.fileCacheSize (100) is too low for large system.  Increase the maximum value and redocument the property.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikem">Mike Matrigali</assignee>
                                    <reporter username="stan">Stan Bradbury</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Jun 2008 23:01:56 +0100</created>
                <updated>Fri, 21 Jan 2011 17:52:03 +0000</updated>
                            <resolved>Wed, 25 Jun 2008 21:27:20 +0100</resolved>
                                    <version>10.3.3.0</version>
                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.2.0</fixVersion>
                    <fixVersion>10.5.1.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12606931" author="knutanders" created="Sat, 21 Jun 2008 00:24:06 +0100"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;I don&apos;t think there&apos;s any need to limit the maximum value for this setting. On some systems, you may exceed the maximum allowed number of open files if you increase the size of the container cache too much, but that&apos;s not something we need to worry about if we leave the default as it is today.&lt;/p&gt;</comment>
                            <comment id="12607363" author="mikem" created="Mon, 23 Jun 2008 20:53:28 +0100"  >&lt;p&gt;unless there are any other opinions I am planning on just upping the maximum to max int and leave the default values as they are.&lt;/p&gt;</comment>
                            <comment id="12607378" author="mikem" created="Mon, 23 Jun 2008 22:03:25 +0100"  >&lt;p&gt;here is a patch of the simple change.  I only plan to hand test the parameters.  No default behavior is expected to change.  &lt;/p&gt;</comment>
                            <comment id="12608157" author="mikem" created="Wed, 25 Jun 2008 20:05:22 +0100"  >&lt;p&gt;The fix for this has been checked into trunk, 10.3 branch and 10.4 branch.&lt;/p&gt;</comment>
                            <comment id="12608176" author="mikem" created="Wed, 25 Jun 2008 21:27:20 +0100"  >&lt;p&gt;Fix to unlimit the maximum setting for the container cache have been applied to trunk, 10.3 branch and 10.4 branch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12384529" name="derby-3734-diff.txt" size="4708" author="mikem" created="Mon, 23 Jun 2008 22:03:25 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10362"><![CDATA[Performance]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Jun 2008 23:24:06 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23814</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0lcf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37276</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10051"><![CDATA[Urgent]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>