<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:43:44 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3140/DERBY-3140.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3140] InListMultiProbeTest creates 30000 DataRow objects that do not get released during suites.All run</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3140</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Using jhat I noticed that there are 30000 DataRow object created by InListMultiProbeTest that do not get released after the test is complete.  This is because foreignIdToRowsMap is declared as a field in the test.  &lt;/p&gt;
</description>
                <environment></environment>
        <key id="12380814">DERBY-3140</key>
            <summary>InListMultiProbeTest creates 30000 DataRow objects that do not get released during suites.All run</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12362990">DERBY-2344</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Oct 2007 23:42:56 +0100</created>
                <updated>Mon, 22 Oct 2007 18:20:16 +0100</updated>
                            <resolved>Mon, 22 Oct 2007 17:22:35 +0100</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.3.2.1</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12536368" author="kmarsden" created="Fri, 19 Oct 2007 23:45:20 +0100"  >&lt;p&gt;snapshot of instancecounts during test run that show DataRow allocation.&lt;/p&gt;
</comment>
                            <comment id="12536381" author="kmarsden" created="Sat, 20 Oct 2007 00:57:14 +0100"  >&lt;p&gt;Attached is a patch to null out foreignIdToRowsMap on teardown() for InListMultiProbeTest.  The interesting thing is that the test harness seems to keep a reference to all the classes for all the tests it has run.   I guess that makes sense so it can compile results, but it means we should be quite careful  adding fields to test classes as they will stick around.  I&apos;ll check the other tests and see if there is anything hanging around that shouldn&apos;t be.&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;</comment>
                            <comment id="12536475" author="kristwaa" created="Sat, 20 Oct 2007 23:34:51 +0100"  >&lt;p&gt;I guess this also means that larger data structures required for testing should be made static if possible?&lt;br/&gt;
As far as I know, JUnit creates a new instance of the class for each test (or test method).&lt;/p&gt;

&lt;p&gt;This does of course require that the data can be shared this way.&lt;/p&gt;</comment>
                            <comment id="12536727" author="kmarsden" created="Mon, 22 Oct 2007 17:17:53 +0100"  >&lt;p&gt;Kristian Waagan said:&lt;br/&gt;
&amp;gt;I guess this also means that larger data structures required for testing should be made static if &amp;gt;possible?&lt;br/&gt;
I think they should be avoided if possible and localized to the fixtures. If that is not possible they should be nulled out as proposed for InListMultiProbeTest &lt;/p&gt;

&lt;p&gt;&amp;gt;As far as I know, JUnit creates a new instance of the class for each test (or test method).&lt;/p&gt;

&lt;p&gt;Looking at the instance snapshot attached, it looks like most of the tests have one instance for the embedded run and one for Network Server. However some tests like ClosedObjectTest (3510 instances)  have many more. I haven&apos;t looked at that test to see exactly what&apos;s going on.  I am not sure yet if we could avoid all of this with a different TestRunner which might get rid of references after the test is run.&lt;/p&gt;

</comment>
                            <comment id="12536749" author="kmarsden" created="Mon, 22 Oct 2007 18:20:16 +0100"  >&lt;p&gt;I found this blog that might be of interest:&lt;br/&gt;
&lt;a href=&quot;http://blogs.atlassian.com/developer/2005/12/reducing_junit_memory_usage.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://blogs.atlassian.com/developer/2005/12/reducing_junit_memory_usage.html&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12368052" name="Snapshotinstancecounts.html" size="501102" author="kmarsden" created="Fri, 19 Oct 2007 23:45:19 +0100"/>
                            <attachment id="12368057" name="derby-3140_diff.txt" size="847" author="kmarsden" created="Sat, 20 Oct 2007 00:57:14 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 20 Oct 2007 22:34:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30739</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy10wf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39796</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>