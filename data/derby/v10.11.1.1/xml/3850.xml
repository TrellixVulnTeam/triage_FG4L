<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:30:15 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3850/DERBY-3850.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3850] Remove unneeded workarounds for DERBY-177 and DERBY-3693</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3850</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;After the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-177&quot; title=&quot;Unnecessary waiting within EmbedDatabaseMetaData.getIndexInfo()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-177&quot;&gt;&lt;del&gt;DERBY-177&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3693&quot; title=&quot;Deadlocks accessing DB metadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3693&quot;&gt;&lt;del&gt;DERBY-3693&lt;/del&gt;&lt;/a&gt; was committed, these code clean-ups could be performed:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;remove workaround for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-177&quot; title=&quot;Unnecessary waiting within EmbedDatabaseMetaData.getIndexInfo()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-177&quot;&gt;&lt;del&gt;DERBY-177&lt;/del&gt;&lt;/a&gt; in the tests (search for the string &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-177&quot; title=&quot;Unnecessary waiting within EmbedDatabaseMetaData.getIndexInfo()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-177&quot;&gt;&lt;del&gt;DERBY-177&lt;/del&gt;&lt;/a&gt;&quot; to find them)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;remove logic to prevent waiting for table locks in SPSDescriptor.updateSYSSTATEMENTS() since the new mechanism will prevent waiting for all types of locks&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12402999">DERBY-3850</key>
            <summary>Remove unneeded workarounds for DERBY-177 and DERBY-3693</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Aug 2008 17:08:01 +0100</created>
                <updated>Mon, 4 May 2009 19:21:53 +0100</updated>
                            <resolved>Tue, 16 Dec 2008 20:15:26 +0000</resolved>
                                    <version>10.5.1.1</version>
                                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>SQL</component>
                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12628323" author="knutanders" created="Thu, 4 Sep 2008 13:36:56 +0100"  >&lt;p&gt;The attached patch removes the calls to DatabasePropertyTestSetup.setLockTimeouts() to work around &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-177&quot; title=&quot;Unnecessary waiting within EmbedDatabaseMetaData.getIndexInfo()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-177&quot;&gt;&lt;del&gt;DERBY-177&lt;/del&gt;&lt;/a&gt; in lang/UpdatableResultSetTest.java and jdbcapi/DatabaseMetaDataTest.java. I have verified that the tests don&apos;t use more time when running with the default lock timeout.&lt;/p&gt;</comment>
                            <comment id="12628326" author="knutanders" created="Thu, 4 Sep 2008 13:40:30 +0100"  >&lt;p&gt;Committed d3850-test.diff with revision 691993.&lt;/p&gt;</comment>
                            <comment id="12628587" author="knutanders" created="Fri, 5 Sep 2008 08:58:09 +0100"  >&lt;p&gt;Here&apos;s a patch (d3850-wait.diff) that removes the wait parameter from some methods used by SPSDescriptor.updateSYSSTATEMENTS(). The wait parameter was passed further down by those methods too, so a number of classes had to be touched. I&apos;ve done my best to trace the callers of these methods, and as far as I could see, wait was always true when the calls didn&apos;t come from the code that we changed in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3693&quot; title=&quot;Deadlocks accessing DB metadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3693&quot;&gt;&lt;del&gt;DERBY-3693&lt;/del&gt;&lt;/a&gt; to use a different mechanism to prevent waiting. So it looks safe to me to remove the wait flag and use timed waits in these methods.&lt;/p&gt;</comment>
                            <comment id="12628588" author="knutanders" created="Fri, 5 Sep 2008 09:00:26 +0100"  >&lt;p&gt;Derbyall and suites.All ran cleanly with the patch.&lt;/p&gt;</comment>
                            <comment id="12628643" author="bryanpendleton" created="Fri, 5 Sep 2008 15:43:52 +0100"  >&lt;p&gt;Hi Knut, thanks for following up with this cleanup. I read through the diff and&lt;br/&gt;
it looks great to me; it is very nice to be able to accomplish all this simplification&lt;br/&gt;
and removal of that awkward &apos;wait&apos; parameter throughout all that code.&lt;/p&gt;

&lt;p&gt;The only thing I noticed was the removal of the &apos;colsToUpdate&apos; variable&lt;br/&gt;
in SPSDescriptor.java &amp;#8211; was that just an opportunistic removal of an&lt;br/&gt;
unrelated unused variable? If so, seems fine to me, I only noticed it&lt;br/&gt;
because it didn&apos;t seem related to the rest of the changes.&lt;/p&gt;

&lt;p&gt;I didn&apos;t build or run any tests, just read the diff, but it looks fine to me, +1.&lt;/p&gt;</comment>
                            <comment id="12628683" author="knutanders" created="Fri, 5 Sep 2008 18:41:15 +0100"  >&lt;p&gt;Thanks for looking at the patch, Bryan!&lt;/p&gt;

&lt;p&gt;You&apos;re right about the removal of &apos;colsToUpdate&apos;. That variable was declared and never used, so I felt that I could just as well remove it together with &apos;wait&apos; while I was cleaning up that method.&lt;/p&gt;

&lt;p&gt;Committed revision 692495.&lt;/p&gt;

&lt;p&gt;The comments around the wait parameters said they were introduced to fix bug 4821. There are other places in the code that mention this bug too, and that add wait parameters to method signatures. I&apos;ll take a look at them and see if cleanup is needed there as well and if the new mechanism to prevent waiting could be used instead of the wait flags.&lt;/p&gt;

&lt;p&gt;There is also one occurrence in the tests, in lang/predicatesIntoViews.sql:&lt;/p&gt;

&lt;p&gt;&amp;#8211; if we don&apos;t commit, the following insert will block due to fix of beetle 4821&lt;br/&gt;
commit;&lt;/p&gt;

&lt;p&gt;&amp;#8211; The following insert statement shouldn&apos;t block for 2 minutes!! The compile of the trigger&lt;br/&gt;
&amp;#8211; shouldn&apos;t wait for timeout!!&lt;/p&gt;

&lt;p&gt;I&apos;ll check if this still is a problem.&lt;/p&gt;</comment>
                            <comment id="12628686" author="knutanders" created="Fri, 5 Sep 2008 19:15:19 +0100"  >&lt;p&gt;It turns out that the workaround for bug 4821 in predicatesIntoViews.sql wasn&apos;t needed anymore. I removed the commit and the test finished in about 15 seconds, same as if it ran unchanged. When I reverted the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3693&quot; title=&quot;Deadlocks accessing DB metadata&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3693&quot;&gt;&lt;del&gt;DERBY-3693&lt;/del&gt;&lt;/a&gt;, the modified test needed 4 minutes 15 seconds to finish.&lt;/p&gt;

&lt;p&gt;Attaching a patch that removes the workaround from the test and from the canon.&lt;/p&gt;</comment>
                            <comment id="12628808" author="bryanpendleton" created="Sat, 6 Sep 2008 01:55:19 +0100"  >&lt;p&gt;I see the same results. I built with revision 688273 and removed the commit from predicatesIntoViews.sql,&lt;br/&gt;
and the test took 4.5 minutes. Then I updated to the current head of trunk, and left the commit removed,&lt;br/&gt;
and the test completed in just 20 seconds.&lt;/p&gt;

&lt;p&gt;I agree that it is now safe to remove that commit. Thanks for tracking this down!&lt;/p&gt;</comment>
                            <comment id="12628981" author="knutanders" created="Sun, 7 Sep 2008 18:35:30 +0100"  >&lt;p&gt;Thanks Bryan. Committed revision 692908.&lt;/p&gt;</comment>
                            <comment id="12629744" author="knutanders" created="Wed, 10 Sep 2008 10:37:52 +0100"  >&lt;p&gt;Attaching a new patch (d3850-tabinfo.diff) that removes the wait parameter from TabInfoImpl.updateRow(). The method only had two callers, both of which called it with wait=true. updateRow() passed the parameter on to RowChanger.openForUpdate(), but that method is sometimes called with wait=false, so I couldn&apos;t remove the parameter from that method.&lt;/p&gt;

&lt;p&gt;The patch also removes an unused variable in the method and some unused import statements.&lt;/p&gt;

&lt;p&gt;Derbyall and suites.All passed.&lt;/p&gt;</comment>
                            <comment id="12630893" author="knutanders" created="Sun, 14 Sep 2008 17:00:03 +0100"  >&lt;p&gt;Committed revision 695244.&lt;/p&gt;</comment>
                            <comment id="12657145" author="knutanders" created="Tue, 16 Dec 2008 20:15:26 +0000"  >&lt;p&gt;I&apos;m not aware of anything more that needs to be changed as part of this issue. Closing.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="31112">DERBY-177</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12396923">DERBY-3693</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12389573" name="d3850-predicatesIntoViews.diff" size="1774" author="knutanders" created="Fri, 5 Sep 2008 19:15:19 +0100"/>
                            <attachment id="12389574" name="d3850-predicatesIntoViews.stat" size="182" author="knutanders" created="Fri, 5 Sep 2008 19:15:19 +0100"/>
                            <attachment id="12389814" name="d3850-tabinfo.diff" size="4940" author="knutanders" created="Wed, 10 Sep 2008 10:37:52 +0100"/>
                            <attachment id="12389494" name="d3850-test.diff" size="2486" author="knutanders" created="Thu, 4 Sep 2008 13:36:56 +0100"/>
                            <attachment id="12389556" name="d3850-wait.diff" size="18376" author="knutanders" created="Fri, 5 Sep 2008 08:58:09 +0100"/>
                            <attachment id="12389557" name="d3850-wait.stat" size="539" author="knutanders" created="Fri, 5 Sep 2008 08:58:09 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 5 Sep 2008 14:43:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31028</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0y3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>