<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:19:49 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5819/DERBY-5819.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5819] Add logic to BaseTestCase to start subprocesses ready to be attached to from a Java debugger</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5819</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Sometimes it&apos;s useful to be able to attach to subprocesses of tests with a debugger.&lt;br/&gt;
Now that we have centralized subprocess creation in BaseTestCase#execJavaCmd it would be easy and useful to have subprocesses start, but wait for a debugger to attach to them, i.e. with these options on an Oracle VM:&lt;/p&gt;

&lt;p&gt;-Xdebug -Xrunjdwp:transport=dt_socket,address=&amp;lt;port&amp;gt;,server=y,suspend=y&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12560702">DERBY-5819</key>
            <summary>Add logic to BaseTestCase to start subprocesses ready to be attached to from a Java debugger</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Jun 2012 00:59:33 +0100</created>
                <updated>Mon, 2 Jul 2012 21:32:35 +0100</updated>
                            <resolved>Mon, 2 Jul 2012 21:31:22 +0100</resolved>
                                                    <fixVersion>10.10.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13295393" author="dagw" created="Fri, 15 Jun 2012 01:06:24 +0100"  >&lt;p&gt;Here is a crude patch which basically creates debug ports on all started subprocesses from 8800 and upward iff this setting applies in the parent VM:&lt;/p&gt;

&lt;p&gt;-DdebugSubprocesses=true&lt;/p&gt;

&lt;p&gt;We could parameterize the port offset, and the value for &quot;suspend=?&quot;. Defaults could be 8800 and &apos;y&apos; though. This method probably only applies to Oracle VMs, too, so the code should check for that, I guess.&lt;/p&gt;
</comment>
                            <comment id="13398647" author="dagw" created="Thu, 21 Jun 2012 18:57:07 +0100"  >&lt;p&gt;Attached version &quot;b&quot; of this patch. For now, it limits this to Sun VMs. Added another property, &quot;debugPortBase=&amp;lt;int&amp;gt;&quot;, but the default is still 8800. Refactored the code to a private method in BasetestCase: setupForDebuggerAttach.&lt;/p&gt;

&lt;p&gt;Summary of properties as the patch stands:&lt;/p&gt;

&lt;p&gt;     debugPortBase=&amp;lt;int&amp;gt;    default 8800&lt;br/&gt;
     debugSubProcesses=&amp;lt;boolean&amp;gt;    default false &lt;/p&gt;</comment>
                            <comment id="13399252" author="knutanders" created="Fri, 22 Jun 2012 11:35:33 +0100"  >&lt;p&gt;This sounds like useful functionality. A couple of comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Maybe the properties should be prefixed with &quot;derby.test.&quot; for consistency with the other test properties.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Won&apos;t this check fail with a NullPointerException if the debugSubprocesses property is not set?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+        if (isSunJVM() &amp;amp;&amp;amp; &quot;true&quot;.equals(&lt;br/&gt;
+                getSystemProperty(&quot;debugSubprocesses&quot;).toLowerCase())) {&lt;/p&gt;

&lt;p&gt;(Btw, Boolean.valueOf(String) would save you the trouble of normalizing/lowercasing the value, and it also handles null.)&lt;/p&gt;</comment>
                            <comment id="13399732" author="dagw" created="Sat, 23 Jun 2012 00:49:57 +0100"  >&lt;p&gt;Thanks, Knut. Indeed it would fail, sorry, I uploaded wrong version of the patch.&lt;/p&gt;</comment>
                            <comment id="13399745" author="dagw" created="Sat, 23 Jun 2012 01:04:10 +0100"  >&lt;p&gt;Uploading a new version of this patch which changes the properties to &lt;/p&gt;

&lt;p&gt;derby.test.debugPortBase=&amp;lt;int&amp;gt; default 8800&lt;br/&gt;
derby.test.debugSubProcesses=&amp;lt;boolean&amp;gt; default false &lt;/p&gt;
</comment>
                            <comment id="13399797" author="dagw" created="Sat, 23 Jun 2012 02:47:21 +0100"  >&lt;p&gt;Added an other option to control the way the subprocesses are started:&lt;/p&gt;

&lt;p&gt;derby.test.debugSuspend=&amp;lt;y|n&amp;gt; default &apos;y&apos;&lt;/p&gt;

&lt;p&gt;Unless this property is &apos;n&apos;, the subprocess will hang till the debugger is connected, cf the explanation here:&lt;br/&gt;
&lt;a href=&quot;http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/conninv.html#Invocation&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://docs.oracle.com/javase/1.5.0/docs/guide/jpda/conninv.html#Invocation&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13405309" author="dagw" created="Mon, 2 Jul 2012 21:27:50 +0100"  >&lt;p&gt;Committed version d as svn 1356457. Commit log:&lt;/p&gt;

&lt;p&gt;Adds options to allow this capability for Oracle Java (properties below&lt;br/&gt;
ignored for other implementations):&lt;/p&gt;

&lt;p&gt;derby.test.debugPortBase=&amp;lt;int&amp;gt; default 8800&lt;br/&gt;
derby.test.debugSubProcesses=&amp;lt;boolean&amp;gt; default false &lt;br/&gt;
derby.test.debugSuspend=&amp;lt;y|n&amp;gt; default &apos;y&apos; &lt;/p&gt;

&lt;p&gt;If several subprocesses are created, the port for subprocess two will be&lt;br/&gt;
debugPortBase + 1 (i.e. 8801 by default) etc.&lt;/p&gt;</comment>
                            <comment id="13405310" author="dagw" created="Mon, 2 Jul 2012 21:32:35 +0100"  >&lt;p&gt;Closing. If needed this patch could be backported.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12532146" name="derby-5819.diff" size="1276" author="dagw" created="Fri, 15 Jun 2012 01:06:24 +0100"/>
                            <attachment id="12532915" name="derby-5819b.diff" size="1965" author="dagw" created="Thu, 21 Jun 2012 18:57:07 +0100"/>
                            <attachment id="12533138" name="derby-5819c.diff" size="2008" author="dagw" created="Sat, 23 Jun 2012 01:04:10 +0100"/>
                            <attachment id="12533150" name="derby-5819d.diff" size="2238" author="dagw" created="Sat, 23 Jun 2012 02:47:21 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 22 Jun 2012 10:35:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245890</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0b8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35639</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>