<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:20:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4617/DERBY-4617.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4617] Sysinfo.testSysinfoLocale failed with IB47 M 1.6 on Windows 7 64bit</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4617</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Sysinfo.testSysinfoLocale failed with IB47 M 1.6 on Windows 7 64bit. This is the exception from running the test:&lt;br/&gt;
1) testSysinfoLocale(org.apache.derbyTesting.functionTests.tests.derbynet.SysinfoTest)junit.framework.AssertionFailedError: expected:&amp;lt;14&amp;gt; but was:&amp;lt;1&amp;gt;&lt;br/&gt;
    at org.apache.derbyTesting.functionTests.tests.derbynet.SysinfoTest.assertMatchingStringExists(SysinfoTest.java:322)&lt;br/&gt;
    at org.apache.derbyTesting.functionTests.tests.derbynet.SysinfoTest.testSysinfoLocale(SysinfoTest.java:249)&lt;br/&gt;
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)&lt;br/&gt;
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)&lt;br/&gt;
    at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:109)&lt;/p&gt;

&lt;p&gt;When running with SysinfoTest along, you will see the following error:&lt;br/&gt;
...before sed&lt;br/&gt;
2010-04-16 22:14:49.289 GMT : Ung?ltige Antwort von Network Server: Keine ausrei&lt;br/&gt;
chenden Daten.&lt;/p&gt;

&lt;p&gt;after sed&lt;br/&gt;
2010-04-16 22:14:49.289 GMT : Ung?ltige Antwort von Network Server: Keine ausrei&lt;br/&gt;
chenden Daten.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12462290">DERBY-4617</key>
            <summary>Sysinfo.testSysinfoLocale failed with IB47 M 1.6 on Windows 7 64bit</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="lilywei">Lily Wei</reporter>
                        <labels>
                            <label>derby_triage10_5_2</label>
                    </labels>
                <created>Fri, 16 Apr 2010 23:15:54 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:36 +0100</updated>
                            <resolved>Wed, 18 May 2011 18:05:24 +0100</resolved>
                                    <version>10.5.3.0</version>
                                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.2.4</fixVersion>
                    <fixVersion>10.7.1.4</fixVersion>
                    <fixVersion>10.8.2.2</fixVersion>
                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Localization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12991531" author="kmarsden" created="Mon, 7 Feb 2011 19:29:19 +0000"  >&lt;p&gt;With the fix below I am guessing the error message for this issue will change.   I am guessing it will say something like:&lt;br/&gt;
could not find &quot;derby.drda.maxThreads=0&quot; in sysinfo ouptut : Ung?ltige Antwort von Network Server: Keine ausrei&lt;br/&gt;
Lily, could you try the test on the failing platform and post the new trace.&lt;/p&gt;


&lt;p&gt; r1067250 | kmarsden | 2011-02-04 10:21:13 -0800 (Fri, 04 Feb 2011) | 3 lines&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4997&quot; title=&quot;SysinfoTest  version output filtering is fragile with new java versions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4997&quot;&gt;&lt;del&gt;DERBY-4997&lt;/del&gt;&lt;/a&gt; SysinfoTest version output filtering is fragile with new java version&lt;/p&gt;


&lt;p&gt;Also Myrna says: Ung?ltige Antwort von Network Server: Keine ausrei means nvalid Answer from Network Server; insufficient Data so sysinfo is not actually running in this scenario.&lt;/p&gt;


</comment>
                            <comment id="12991877" author="lilywei" created="Tue, 8 Feb 2011 09:58:36 +0000"  >&lt;p&gt;With the patch, this is the error trace I see in Windows 7 64 bits:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Error/failure logged at Tue Feb 08 09:49:23 GMT 2011&amp;#93;&lt;/span&gt;&lt;br/&gt;
junit.framework.AssertionFailedError: cannot find --------- Derby Network Server&lt;br/&gt;
 Information -------- in actualOutput:Tue Feb 08 01:49:23 PST 2011 : Invalid rep&lt;br/&gt;
ly from network server: Insufficient data.&lt;/p&gt;

&lt;p&gt;        at junit.framework.Assert.fail(Assert.java:47)&lt;br/&gt;
        at junit.framework.Assert.assertTrue(Assert.java:20)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.derbynet.SysinfoTest.asse&lt;br/&gt;
rtMatchingStringExists(SysinfoTest.java:285)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.derbynet.SysinfoTest.test&lt;br/&gt;
Sysinfo(SysinfoTest.java:202)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.&lt;br/&gt;
java:48)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces&lt;br/&gt;
sorImpl.java:37)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:600)&lt;br/&gt;
        at junit.framework.TestCase.runTest(TestCase.java:154)&lt;br/&gt;
        at junit.framework.TestCase.runBare(TestCase.java:127)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:&lt;br/&gt;
112)&lt;br/&gt;
        at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.framework.TestResult.run(TestResult.java:109)&lt;br/&gt;
        at junit.framework.TestCase.run(TestCase.java:118)&lt;br/&gt;
        at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
        at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57&lt;br/&gt;
)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57&lt;br/&gt;
)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
        at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
        at junit.textui.TestRunner.doRun(TestRunner.java:116)&lt;br/&gt;
        at junit.textui.TestRunner.start(TestRunner.java:172)&lt;br/&gt;
        at junit.textui.TestRunner.main(TestRunner.java:138)&lt;/p&gt;</comment>
                            <comment id="13019582" author="kmarsden" created="Wed, 13 Apr 2011 23:37:45 +0100"  >&lt;p&gt;I saw this occur on a different JDK I was testing on XP.  The message in the derby.log was:&lt;/p&gt;

&lt;p&gt;2011-04-13 22:21:07.511 GMT : Apache Derby Network Server - 10.5.3.2 - (1089552M) started and ready to accept connections on port 1527&lt;/p&gt;

&lt;p&gt;2011-04-13 22:21:55.482 GMT : Access denied (&quot;java.io.FilePermission&quot; &quot;C:\cygwin\svn4\10.5\jars\sane\derby.jar&quot; &quot;read&quot;)&lt;/p&gt;

&lt;p&gt;java.security.AccessControlException: Access denied (&quot;java.io.FilePermission&quot; &quot;C:\cygwin\svn4\10.5\jars\sane\derby.jar&quot; &quot;read&quot;)&lt;/p&gt;

&lt;p&gt;	at java.security.AccessController.checkPermission(AccessController.java:108)&lt;/p&gt;

&lt;p&gt;	at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)&lt;/p&gt;

&lt;p&gt;	at java.lang.SecurityManager.checkRead(SecurityManager.java:888)&lt;/p&gt;

&lt;p&gt;	at java.io.File.exists(File.java:772)&lt;/p&gt;

&lt;p&gt;	at java.io.Win32FileSystem.canonicalize(Win32FileSystem.java:420)&lt;/p&gt;

&lt;p&gt;	at java.io.File.getCanonicalPath(File.java:591)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.tools.sysinfo.Main.formatURL(Main.java:1224)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.tools.sysinfo.Main.loadZipFromResource(Main.java:892)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.tools.sysinfo.Main.getAllInfo(Main.java:796)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.tools.sysinfo.Main.reportDerby(Main.java:241)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.tools.sysinfo.Main.getMainInfo(Main.java:141)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.drda.NetworkServerControlImpl.getCLSSysInfo(NetworkServerControlImpl.java:2184)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.drda.NetworkServerControlImpl.sendSysInfo(NetworkServerControlImpl.java:2072)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.drda.NetworkServerControlImpl.processCommands(NetworkServerControlImpl.java:1751)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.drda.DRDAConnThread.sessionInitialState(DRDAConnThread.java:645)&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.drda.DRDAConnThread.run(DRDAConnThread.java:279)&lt;/p&gt;


&lt;p&gt;Looking at the offending code in Main.formatURL I see:&lt;br/&gt;
       try &lt;/p&gt;
{
            result = new File(filename).getCanonicalPath().replace(&apos;/&apos;, File.separatorChar);
        }
&lt;p&gt; catch (IOException e) &lt;/p&gt;
{
            result = e.getMessage();
        }

&lt;p&gt;getCanonicalPath() can throw a Security exception so should be wrapped I think in a priv block.&lt;br/&gt;
I will try that and see if it resolves the issue.&lt;/p&gt;
</comment>
                            <comment id="13019598" author="kmarsden" created="Thu, 14 Apr 2011 00:27:57 +0100"  >&lt;p&gt;The unwrapped getCanonicalPath() call would appear to be it.  Lily could you try this patch on Windows 7 derby-4617_try_diff.txt?&lt;/p&gt;

&lt;p&gt;I have not run the full test suite yet. I am not sure about a specific test for this. It seems some java versions  need to do something requiring  direct file access to derby.jar and thus the access check  and others do not.  &lt;/p&gt;


</comment>
                            <comment id="13019674" author="lilywei" created="Thu, 14 Apr 2011 03:58:50 +0100"  >&lt;p&gt;Hi Kathey:&lt;br/&gt;
    I applied the patch. testSysinfoLocal passed on my Windows 7 system. However, there are still some access denied messages within the test. &lt;br/&gt;
This is some output I got:&lt;br/&gt;
=================&lt;br/&gt;
Java user name:  Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission user.name read)^M&lt;br/&gt;
Java user home:  Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission user.home read)^M&lt;br/&gt;
Java user dir:   Security Exception: java.security.AccessControlException: access denied (java.util.PropertyPermission user.dir read)^M&lt;br/&gt;
java.specification.name: Java Platform API Specification^M&lt;br/&gt;
java.specification.version: 1.6^M&lt;br/&gt;
java.runtime.version: 1.6.0_13-b03^M&lt;br/&gt;
--------- Derby Information --------^M&lt;br/&gt;
JRE - JDBC: Java SE 6 - JDBC 4.0^M&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;C:\derby5\trunk\jars\sane\derby.jar&amp;#93;&lt;/span&gt; 10.9.0.0 alpha - (1091990M)^M&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;Java Security Exception: access denied (java.io.FilePermission . read)&amp;#93;&lt;/span&gt; &amp;lt;null&amp;gt;&lt;br/&gt;
[Java Security Exception: access denied (java.io.FilePermission c:\derby5\trunk\&lt;br/&gt;
tools\java\junit.jar read)] &amp;lt;null&amp;gt;&lt;br/&gt;
[Java Security Exception: access denied (java.io.FilePermission c:\derby5\trunk\&lt;br/&gt;
jars\sane\derbyrun.jar read)] &amp;lt;null&amp;gt;&lt;br/&gt;
[Java Security Exception: access denied (java.io.FilePermission c:\derby5\trunk\&lt;br/&gt;
jars\sane\derbyTesting.jar read)] &amp;lt;null&amp;gt;&lt;br/&gt;
[Java Security Exception: access denied (java.io.FilePermission c:\derby5\trunk\&lt;br/&gt;
tools\java\jakarta-oro-2.0.8.jar read)] &amp;lt;null&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13019683" author="kmarsden" created="Thu, 14 Apr 2011 05:21:39 +0100"  >&lt;p&gt;Thanks Lily, do you see these just with IBM 1.6 or also with Sun?  It seems to me at one point a decision was made to just print such access errors for classpath entries for which there was no read permission access. &lt;/p&gt;

&lt;p&gt;The property issues are filed as &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4616&quot; title=&quot;SysinfoTest prints permission errors when printing sysinfo&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4616&quot;&gt;DERBY-4616&lt;/a&gt;. Jayaram is assigned to that one, but we haven&apos;t heard from him in a while.&lt;/p&gt;
</comment>
                            <comment id="13019690" author="lilywei" created="Thu, 14 Apr 2011 05:37:28 +0100"  >&lt;p&gt;Thanks Kathey for the prompt reply. Yes, you are right about I see the access denied message from both IBM 1.6 and Sun jvm. And, it should be a different issue. +1 for the patch.&lt;/p&gt;</comment>
                            <comment id="13223460" author="kmarsden" created="Tue, 6 Mar 2012 17:43:23 +0000"  >&lt;p&gt;This issue has already been fixed in 10.5. Adjusting the fixVersion&lt;/p&gt;</comment>
                            <comment id="13685300" author="knutanders" created="Mon, 17 Jun 2013 10:19:36 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12476288" name="derby-4617_try_diff.txt" size="2860" author="kmarsden" created="Thu, 14 Apr 2011 00:27:56 +0100"/>
                            <attachment id="12470578" name="derby.log" size="8844" author="lilywei" created="Tue, 8 Feb 2011 09:58:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 7 Feb 2011 19:29:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24368</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10423"><![CDATA[Newcomer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0crb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35885</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10053"><![CDATA[Low]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>