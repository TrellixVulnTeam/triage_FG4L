<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:46:39 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3035/DERBY-3035.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3035] Cannot restore backups without BACKUP.HISTORY file</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3035</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I tried to restore a database backup from a backup directory by using the following connection url&lt;/p&gt;

&lt;p&gt;    jdbc:derby:mydb;restoreFrom=mybackup&lt;/p&gt;

&lt;p&gt;The follwoing error occured&lt;/p&gt;

&lt;p&gt;java.sql.SQLException: Failed to start database &apos;mydb&apos;, see the next exception for details.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.seeNextException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection30.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection40.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.EmbeddedDriver.connect(Unknown Source)&lt;br/&gt;
	at net.sourceforge.squirrel_sql.fw.sql.SQLDriverManager.getConnection(SQLDriverManager.java:133)&lt;br/&gt;
	at net.sourceforge.squirrel_sql.client.mainframe.action.OpenConnectionCommand.execute(OpenConnectionCommand.java:97)&lt;br/&gt;
	at net.sourceforge.squirrel_sql.client.mainframe.action.ConnectToAliasCommand$SheetHandler.run(ConnectToAliasCommand.java:283)&lt;br/&gt;
	at net.sourceforge.squirrel_sql.fw.util.TaskExecuter.run(TaskExecuter.java:82)&lt;br/&gt;
	at java.lang.Thread.run(Unknown Source)&lt;br/&gt;
Caused by: java.sql.SQLException: Failed to start database &apos;mydb&apos;, see the next exception for details.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)&lt;br/&gt;
	... 15 more&lt;br/&gt;
Caused by: java.sql.SQLException: Error copying file (during backup) from mybackup\BACKUP.HISTORY to mydb\BACKUP.HISTORY.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)&lt;br/&gt;
	... 12 more&lt;br/&gt;
Caused by: ERROR XSRS5: Error copying file (during backup) from mybackup\BACKUP.HISTORY to mydb\BACKUP.HISTORY.&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.store.raw.RawStore.restoreRemainingFromBackup(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.store.raw.RawStore.boot(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.boot(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.TopService.bootModule(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(Unknown Source)&lt;br/&gt;
	at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.store.access.RAMAccessManager.boot(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.boot(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.TopService.bootModule(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(Unknown Source)&lt;br/&gt;
	at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.db.BasicDatabase.bootStore(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.db.BasicDatabase.boot(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.boot(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.TopService.bootModule(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(Unknown Source)&lt;br/&gt;
	at org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Unknown Source)&lt;br/&gt;
	... 12 more&lt;/p&gt;


&lt;p&gt;I wonder why the file BACKUP.HISTORY is so importent that it blows the whole import process if it is not there. &lt;br/&gt;
I do not have this file because i retrieved the backup by performing an offline backup. In this case there is no BACKUP.HISTORY file.&lt;/p&gt;

&lt;p&gt;If i create a empty file with the name BACKUP.HISTORY in the backup folder, everything works fine.&lt;/p&gt;</description>
                <environment>Windows XP</environment>
        <key id="12377237">DERBY-3035</key>
            <summary>Cannot restore backups without BACKUP.HISTORY file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="s_huber">Stefan Huber</reporter>
                        <labels>
                    </labels>
                <created>Fri, 31 Aug 2007 14:17:31 +0100</created>
                <updated>Fri, 21 Jan 2011 17:50:48 +0000</updated>
                            <resolved>Fri, 14 Nov 2008 18:28:10 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.3.1</fixVersion>
                    <fixVersion>10.4.2.1</fixVersion>
                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12543834" author="kirkwylie" created="Tue, 20 Nov 2007 10:03:19 +0000"  >&lt;p&gt;This also affects you if you use createFrom=true semantics (to bootstrap a database from another database).&lt;/p&gt;

&lt;p&gt;Interestingly, if I create a brand new database, this file is never present.&lt;/p&gt;

&lt;p&gt;This is a massive regression in functionality for our environment. Thanks for the empty file workaround, but this is pretty serious.&lt;/p&gt;</comment>
                            <comment id="12644180" author="kmarsden" created="Fri, 31 Oct 2008 00:34:04 +0000"  >&lt;p&gt;Here is the debug stack trace.&lt;/p&gt;

&lt;p&gt;ij&amp;gt; connect &apos;jdbc:derby:wombat;create=true&apos;;&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:wombat2;createFrom=wombat&apos;;&lt;br/&gt;
ERROR XJ040: Failed to start database &apos;wombat2&apos;, see the next exception for details.&lt;br/&gt;
java.sql.SQLException: Failed to start database &apos;wombat2&apos;, see the next exception for details.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:95)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:87)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.seeNextException(Util.java:223)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2620)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.&amp;lt;init&amp;gt;(EmbedConnection.java:374)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection30.&amp;lt;init&amp;gt;(EmbedConnection30.java:73)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection40.&amp;lt;init&amp;gt;(EmbedConnection40.java:54)&lt;br/&gt;
        at org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:68)&lt;br/&gt;
        at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:238)&lt;br/&gt;
        at org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:119)&lt;br/&gt;
        at java.sql.DriverManager.getConnection(DriverManager.java:582)&lt;br/&gt;
        at java.sql.DriverManager.getConnection(DriverManager.java:154)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:1325)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:1175)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:1003)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:328)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:248)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.go(Main.java:215)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:181)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.main(Main.java:73)&lt;br/&gt;
        at org.apache.derby.tools.ij.main(ij.java:59)&lt;br/&gt;
Caused by: java.sql.SQLException: Failed to start database &apos;wombat2&apos;, see the next exception for details.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java&lt;br/&gt;
9)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)&lt;br/&gt;
        ... 20 more&lt;br/&gt;
Caused by: java.sql.SQLException: Error copying file (during backup) from wombat\BACKUP.HISTORY to C:\kmarsden\repro\&lt;br/&gt;
by-3035\wombat2\BACKUP.HISTORY.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java&lt;br/&gt;
9)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:201)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2614)&lt;br/&gt;
        ... 17 more&lt;br/&gt;
Caused by: ERROR XSRS5: Error copying file (during backup) from wombat\BACKUP.HISTORY to C:\kmarsden\repro\derby-3035&lt;br/&gt;
mbat2\BACKUP.HISTORY.&lt;br/&gt;
        at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:303)&lt;br/&gt;
        at org.apache.derby.impl.store.raw.RawStore.restoreRemainingFromBackup(RawStore.java:1145)&lt;br/&gt;
        at org.apache.derby.impl.store.raw.RawStore.boot(RawStore.java:238)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:2019)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:291)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:573)&lt;br/&gt;
        at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:427)&lt;br/&gt;
        at org.apache.derby.impl.store.access.RAMAccessManager.boot(RAMAccessManager.java:1019)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:2019)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:291)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:573)&lt;br/&gt;
        at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:427)&lt;br/&gt;
        at org.apache.derby.impl.db.BasicDatabase.bootStore(BasicDatabase.java:780)&lt;br/&gt;
        at org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:196)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:2019)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:291)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1856)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1722)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1602)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:1021)&lt;br/&gt;
        at org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:550)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2581)&lt;br/&gt;
        ... 17 more&lt;br/&gt;
ERROR XSRS5: Error copying file (during backup) from wombat\BACKUP.HISTORY to C:\kmarsden\repro\derby-3035\wombat2\BA&lt;br/&gt;
P.HISTORY.&lt;br/&gt;
java.sql.SQLException: Error copying file (during backup) from wombat\BACKUP.HISTORY to C:\kmarsden\repro\derby-3035\&lt;br/&gt;
bat2\BACKUP.HISTORY.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:95)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:201)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2614)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.&amp;lt;init&amp;gt;(EmbedConnection.java:374)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection30.&amp;lt;init&amp;gt;(EmbedConnection30.java:73)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection40.&amp;lt;init&amp;gt;(EmbedConnection40.java:54)&lt;br/&gt;
        at org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:68)&lt;br/&gt;
        at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:238)&lt;br/&gt;
        at org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:119)&lt;br/&gt;
        at java.sql.DriverManager.getConnection(DriverManager.java:582)&lt;br/&gt;
        at java.sql.DriverManager.getConnection(DriverManager.java:154)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.ij.dynamicConnection(ij.java:1325)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.ij.ConnectStatement(ij.java:1175)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.ij.ijStatement(ij.java:1003)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:328)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:248)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.go(Main.java:215)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:181)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.main(Main.java:73)&lt;br/&gt;
        at org.apache.derby.tools.ij.main(ij.java:59)&lt;br/&gt;
Caused by: java.sql.SQLException: Error copying file (during backup) from wombat\BACKUP.HISTORY to C:\kmarsden\repro\&lt;br/&gt;
by-3035\wombat2\BACKUP.HISTORY.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java&lt;br/&gt;
9)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)&lt;br/&gt;
        ... 19 more&lt;br/&gt;
Caused by: ERROR XSRS5: Error copying file (during backup) from wombat\BACKUP.HISTORY to C:\kmarsden\repro\derby-3035&lt;br/&gt;
mbat2\BACKUP.HISTORY.&lt;br/&gt;
        at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:303)&lt;br/&gt;
        at org.apache.derby.impl.store.raw.RawStore.restoreRemainingFromBackup(RawStore.java:1145)&lt;br/&gt;
        at org.apache.derby.impl.store.raw.RawStore.boot(RawStore.java:238)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:2019)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:291)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:573)&lt;br/&gt;
        at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:427)&lt;br/&gt;
        at org.apache.derby.impl.store.access.RAMAccessManager.boot(RAMAccessManager.java:1019)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:2019)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:291)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.startModule(BaseMonitor.java:573)&lt;br/&gt;
        at org.apache.derby.iapi.services.monitor.Monitor.bootServiceModule(Monitor.java:427)&lt;br/&gt;
        at org.apache.derby.impl.db.BasicDatabase.bootStore(BasicDatabase.java:780)&lt;br/&gt;
        at org.apache.derby.impl.db.BasicDatabase.boot(BasicDatabase.java:196)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.boot(BaseMonitor.java:2019)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.TopService.bootModule(TopService.java:291)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.bootService(BaseMonitor.java:1856)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.startProviderService(BaseMonitor.java:1722)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1602)&lt;br/&gt;
        at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:1021)&lt;br/&gt;
        at org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:550)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2581)&lt;br/&gt;
        ... 17 more&lt;br/&gt;
ij&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12644383" author="kmarsden" created="Fri, 31 Oct 2008 18:13:06 +0000"  >&lt;p&gt;The fix seems as simple as not trying to copy the history file if it does not exist.  Attached is a patch that does that.  I still need to add tests and run tests, but this is the approach I plan to take.  Let me know if that might cause any problems.&lt;/p&gt;
</comment>
                            <comment id="12644390" author="bryanpendleton" created="Fri, 31 Oct 2008 18:21:36 +0000"  >&lt;p&gt;If the backup is missing the history file, should the results of the restore be to:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;leave the restored database with no history file?&lt;/li&gt;
	&lt;li&gt;leave the restored database with a brand-new empty history file?&lt;/li&gt;
	&lt;li&gt;leave the restored database with whatever history file was present&lt;br/&gt;
   prior to doing the restore?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12644392" author="kmarsden" created="Fri, 31 Oct 2008 18:29:45 +0000"  >&lt;p&gt;The patch I propose will leave whatever history file was present prior to doing the restore or none if there was none.&lt;br/&gt;
I think this is right, because the current comments say:&lt;/p&gt;


&lt;p&gt;		// if this is a roll-forward recovery, backup history file &lt;br/&gt;
		// will already there in the database and will be the latest &lt;br/&gt;
		// copy; if it exists, do not copy from backup&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;</comment>
                            <comment id="12645291" author="kmarsden" created="Wed, 5 Nov 2008 18:54:03 +0000"  >&lt;p&gt;Attached is a patch for this issue, which will check for the existence of the backup history file before it tries to copy it.  Added a test OfflineBackupTest. Please review.&lt;/p&gt;

</comment>
                            <comment id="12645801" author="kmarsden" created="Fri, 7 Nov 2008 15:59:05 +0000"  >&lt;p&gt;If there are no comments. I&apos;ll check this in Monday  (derby-3035_diff.txt)&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12393388" name="derby-3035_diff.txt" size="6975" author="kmarsden" created="Wed, 5 Nov 2008 18:54:03 +0000"/>
                            <attachment id="12393174" name="derby-3035_preview_diff.txt" size="914" author="kmarsden" created="Fri, 31 Oct 2008 18:13:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 20 Nov 2007 10:03:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23388</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0m2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37395</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>