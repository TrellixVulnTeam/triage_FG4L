<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:42:50 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1490/DERBY-1490.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1490] Provide ALTER TABLE RENAME COLUMN functionality</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1490</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Provide a way to rename a column in an existing table. Possible syntax could be:&lt;/p&gt;

&lt;p&gt;  ALTER TABLE tablename RENAME COLUMN oldcolumn TO newcolumn;&lt;/p&gt;

&lt;p&gt;Feature should properly handle the possibility that the column is currently used in constraints, views, indexes, triggers, etc.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12345617">DERBY-1490</key>
            <summary>Provide ALTER TABLE RENAME COLUMN functionality</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bryanpendleton">Bryan Pendleton</assignee>
                                    <reporter username="bryanpendleton">Bryan Pendleton</reporter>
                        <labels>
                    </labels>
                <created>Sun, 9 Jul 2006 00:23:28 +0100</created>
                <updated>Thu, 2 May 2013 03:29:01 +0100</updated>
                            <resolved>Thu, 9 Nov 2006 00:03:13 +0000</resolved>
                                    <version>10.0.2.0</version>
                    <version>10.0.2.1</version>
                    <version>10.1.1.0</version>
                    <version>10.1.2.1</version>
                    <version>10.1.3.1</version>
                    <version>10.2.1.6</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Documentation</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12422215" author="brviking" created="Wed, 19 Jul 2006 19:07:07 +0100"  >&lt;p&gt;There is additional syntax that could be interesting (from SapDB):&lt;br/&gt;
To rename a column:&lt;/p&gt;

&lt;p&gt;RENAME tableName.columnName to newColumnName&lt;/p&gt;

&lt;p&gt;This syntax is very clear and easy to use (but could cause confusion for people searching for an &quot;ALTER...RENAME&quot; thing.&lt;/p&gt;

&lt;p&gt;If Derby team wish to maintain &quot;ALTER TABLE ... ALTER COLUMN&quot;, then the sintax could be:&lt;/p&gt;

&lt;p&gt;ALTER TABLE tableName ALTER COLUMN columnName RENAME TO newColumnName&lt;/p&gt;
</comment>
                            <comment id="12422455" author="phille" created="Thu, 20 Jul 2006 18:36:53 +0100"  >&lt;p&gt;Can&apos;t both be used? &lt;br/&gt;
Sorry if this is a stupid question, but can&apos;t DB work with aliases? (so that the easier RENAME directive resolves the more formal ALTER... cmd? This way we can all use what we like best. &lt;/p&gt;

&lt;p&gt;Philippe&lt;/p&gt;</comment>
                            <comment id="12442415" author="bryanpendleton" created="Sun, 15 Oct 2006 19:51:18 +0100"  >&lt;p&gt;Thanks Edson and Wolf for the suggestions on possible syntax. I see that&lt;br/&gt;
Postgres and Oracle appear to implement ALTER TABLE t RENAME COLUMN c TO new_c&lt;br/&gt;
while DB2 appears to implement RENAME COLUMN t.c to new_c&lt;/p&gt;

&lt;p&gt;I think that in the future it would be possible to support multiple syntax variants. For&lt;br/&gt;
now I have concentrated just on implementing the ALTER TABLE syntax as it is&lt;br/&gt;
the least amount of work.&lt;/p&gt;

&lt;p&gt;Attached is a not-ready-for-commit patch proposal &apos;derby1490_v1_needMoretests.diff&apos;.&lt;br/&gt;
This patch modifies the parser to support the new syntax&lt;br/&gt;
   ALTER TABLE t RENAME COLUMN c TO new_c&lt;br/&gt;
and&lt;br/&gt;
  ALTER TABLE t RENAME TABLE t TO new_t&lt;/p&gt;

&lt;p&gt;The patch also contains a handful of tests, to demonstrate the most rudimentary&lt;br/&gt;
aspects of the new command.&lt;/p&gt;

&lt;p&gt;I intend to write additional tests later and propose a replacement patch, but I would&lt;br/&gt;
like to hear any feedback on this patch, too!&lt;/p&gt;</comment>
                            <comment id="12443162" author="bryanpendleton" created="Wed, 18 Oct 2006 06:16:05 +0100"  >&lt;p&gt;I had overlooked that Derby already supports a RENAME TABLE and RENAME INDEX statement. Given that,&lt;br/&gt;
I think the idea of providing a RENAME COLUMN statement makes a lot of sense.&lt;/p&gt;

&lt;p&gt;I shall investigate a possible RENAME COLUMN statement further.&lt;/p&gt;

&lt;p&gt;I can see that it might make sense to provide both syntaxes for renaming a column, but I can also see&lt;br/&gt;
that one syntax is probably plenty, so if we provide a RENAME COLUMN statement there may be no&lt;br/&gt;
point to having an ALTER TABLE t RENAME COLUMN c TO new_c statement.&lt;/p&gt;

&lt;p&gt;Also, I&apos;m not sure if there is any purpose in providing support for ALTER TABLE t RENAME TABLE t TO new_t.&lt;br/&gt;
That syntax seems rather awkward, and given that there is already a RENAME TABLE statement, I&apos;m&lt;br/&gt;
not sure that there is any benefit to providing ALTER TABLE syntax which merely duplicates it.&lt;br/&gt;
So I think that part of my first patch makes no sense and should be withdrawn.&lt;/p&gt;

&lt;p&gt;I&apos;ll be back with a new patch proposal after thinking about this some more...&lt;/p&gt;</comment>
                            <comment id="12443673" author="bryanpendleton" created="Fri, 20 Oct 2006 02:14:15 +0100"  >&lt;p&gt;Attached is &apos;renameColumn_v2_with_tests.diff&apos;, a patch proposal which is,&lt;br/&gt;
I think, ready for review.&lt;/p&gt;

&lt;p&gt;I&apos;m interested in all feedback, but I particularly want to draw your attention&lt;br/&gt;
to the following questions:&lt;/p&gt;

&lt;p&gt;1) The patch proposes to add support for &lt;b&gt;both&lt;/b&gt; of these syntaxes:&lt;br/&gt;
       ALTER TABLE t RENAME COLUMN c1 TO c2&lt;br/&gt;
   and&lt;br/&gt;
       RENAME COLUMN t.c1 to c2;&lt;/p&gt;

&lt;p&gt;   I think it&apos;s probably wrong to add both syntaxes, but I&apos;m not sure which&lt;br/&gt;
   one to prefer, so I&apos;ve implemented both and am now looking for feedback&lt;br/&gt;
   about which one is better. (Or, if you think we should implement both, why?)&lt;/p&gt;

&lt;p&gt;2) Are there test cases that are missing?&lt;/p&gt;

&lt;p&gt;3) Is the handling of active prepared statements satisfactory? With the patch,&lt;br/&gt;
   if there is a prepared statement against the table, and you rename a&lt;br/&gt;
   column in the table, the rename is successful, and later attempts to execute&lt;br/&gt;
   the prepared statement get a &quot;the column does not exist&quot; error. I think it&apos;s&lt;br/&gt;
   pretty reasonable: the error message is accurate and the behavior is&lt;br/&gt;
   deterministic, but maybe there is room for improvement here?&lt;/p&gt;

&lt;p&gt;4) Is the handling of triggers satisfactory? With the patch, you cannot rename&lt;br/&gt;
   a column which would cause the &lt;b&gt;firing&lt;/b&gt; of a trigger, but you are able to&lt;br/&gt;
   successfully rename a column which is used by the &lt;b&gt;body&lt;/b&gt; of the trigger. In&lt;br/&gt;
   that case, the behavior is similar to that of the prepared statement case&lt;br/&gt;
   above: the rename column succeeds, and the next time the trigger fires, it&lt;br/&gt;
   gets a &quot;column does not exist&quot; error. Again, I think the behavior is pretty&lt;br/&gt;
   reasonable: the error message is clear and the behavior is deterministic,&lt;br/&gt;
   but again I&apos;m looking for your reaction.&lt;/p&gt;

&lt;p&gt;I haven&apos;t worked on the documentation yet, partly because until we know which&lt;br/&gt;
syntax we prefer, it&apos;s hard to know which doc pages to update.&lt;/p&gt;

&lt;p&gt;Please let me know your comments and suggestions on this patch.&lt;/p&gt;

</comment>
                            <comment id="12445250" author="bryanpendleton" created="Fri, 27 Oct 2006 19:44:56 +0100"  >&lt;p&gt;Does anyone anticipate having time to review this patch proposal?&lt;/p&gt;</comment>
                            <comment id="12445254" author="army" created="Fri, 27 Oct 2006 20:11:45 +0100"  >&lt;p&gt;&amp;gt; Does anyone anticipate having time to review this patch proposal?&lt;/p&gt;

&lt;p&gt;I&apos;ll try to look at this patch this afternoon.  Hopefully I can post comments sometime later today or tomorrow...&lt;/p&gt;</comment>
                            <comment id="12445287" author="yipng" created="Fri, 27 Oct 2006 23:54:28 +0100"  >&lt;p&gt;Hi Bryan, I have some time during the weekend to review this patch. &lt;/p&gt;

</comment>
                            <comment id="12445290" author="army" created="Fri, 27 Oct 2006 23:59:57 +0100"  >&lt;p&gt;I reviewed the patch and functionally it looks good to me.  I ran the new test cases in altertable.sql and they all passed.&lt;/p&gt;

&lt;p&gt;Just some minor things that jumped out at me while I was reviewing:&lt;/p&gt;

&lt;p&gt;---------------------------------&lt;/p&gt;

&lt;p&gt;Two comments on the patch itself:&lt;/p&gt;

&lt;p&gt;1. Test cases say &quot;FIXME&quot; for some of the trigger tests.  This appears to be correlated with your comment #4 above, except that the Jira comment says that this behavior is &quot;pretty reasonable&quot; while the test itself suggests that there is something here to be fixed.  Are we just waiting for community feedback in order to determine which conclusion (&quot;reasonable&quot; vs &quot;FIXME&quot;) is the most appropriate?&lt;/p&gt;

&lt;p&gt;2. sqlgrammar.jj has the following diff:&lt;/p&gt;

&lt;p&gt;+            if (oldColumnReference.getTableNameNode() == null)&lt;br/&gt;
+                throw StandardException.newException(&lt;br/&gt;
+                        SQLState.LANG_OBJECT_DOES_NOT_EXIST,&lt;br/&gt;
+                        &quot;RENAME COLUMN&quot;, &quot;(Missing Table)&quot;);&lt;/p&gt;

&lt;p&gt;From a user perspective this shows up as something like:&lt;/p&gt;

&lt;p&gt;ERROR 42Y55: &apos;RENAME COLUMN&apos; cannot be performed on &apos;(Missing Table)&apos; because it does not exist.&lt;/p&gt;

&lt;p&gt;The string literal &quot;(Missing Table)&quot; is hardcoded into the error message because it is passed as an error argument.  This means that someone who is using Derby in a different locale will see the phrase &quot;(Missing Table)&quot; in English; it will not be translated.  I don&apos;t know what the Derby practice regarding message translation is, but my understanding is that it&apos;s generally best to restrict hard-coded error tokens to actual SQL syntax words, since syntax words are constant across locales.  Thus it&apos;s fine to use &quot;RENAME COLUMN&quot; because that&apos;s an explicit part of the syntax and it does not change from locale to locale.  But &quot;Missing Table&quot; is a locale-specific phrase and so it&apos;s best to avoid passing it as an error message argument.  If needed, I think a new error message would be a cleaner way to go.&lt;/p&gt;

&lt;p&gt;Of course, after writing that I did a quick look in sqlgrammar.jj and I noticed two places where the English word &quot;MISSING&quot; is hard-coded as an error argument. So I guess it has been done before...but it still seems like something to avoid as a general rule.&lt;/p&gt;

&lt;p&gt;As an alternative, I wonder if you couldn&apos;t just pass the column name as an argument in this case?  Ex.&lt;/p&gt;

&lt;p&gt;ij&amp;gt; rename column renc_1 to b;&lt;br/&gt;
ERROR 42Y55: &apos;RENAME COLUMN&apos; cannot be performed on &apos;RENC_1&apos; because it does not exist.&lt;/p&gt;

&lt;p&gt;The plus side to this is that the message is locale-independent and there is a clear indication of what part of the command is causing the error.  The downside is that this error message does not really express what we want it to express--namely, that the syntax is missing a table name.  So again, perhaps the best bet is to create a new error message that explicitly tells what the problem is...?&lt;/p&gt;

&lt;p&gt;------------------------------------------&lt;/p&gt;

&lt;p&gt;In response to the questions you asked in your comment above:&lt;/p&gt;

&lt;p&gt;#1) Umm...don&apos;t know which is better.  I think I&apos;ll plea &quot;undecided&quot; on this one &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;#2) I think you&apos;ve done a great job of covering the various test cases. Thanks for being so thorough!  The only test case that I didn&apos;t see was one for trying to rename a column to itself, but when I tried that it threw the expected error (i.e. column already exists).  I also tried renaming the column on a synonym, which failed as expected, and I verified that renaming a column in a table &quot;renames&quot; it (functionally) in the synonym, as well.  So the tests look good to me.&lt;/p&gt;

&lt;p&gt;As for #3 and #4, I personally do not have any problems with the behavior as you describe.  I do wonder, though, why it is that we allow renaming to occur when it &quot;breaks&quot; a trigger but do not allow it when it would &quot;break&quot; a view or a check constraint.  Is this just because, as the altertable.sql test says, the trigger dependency information is not correctly updated?  If that&apos;s the case, then is there a Jira issue for fixing that particular problem?&lt;/p&gt;

&lt;p&gt;------------------------------------------------&lt;/p&gt;

&lt;p&gt;Other minor nits that shouldn&apos;t block the patch:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;There appears to be a mix of spaces and tabs in the new code, which makes the file a bit harder to read.  In some cases the difference is between existing code and new code, which is probably okay.  But there are also some places where the new code itself mixes spaces with tabs...&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;One line over 80 chars in sqlgrammar.jj...&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;As I said, nothing major to report here--certainly not anything I would call a &quot;blocker&quot; for the patch.  Functionally the patch looks solid to me.  Thanks for taking the time to work on this feature!&lt;/p&gt;</comment>
                            <comment id="12445341" author="kartha" created="Sat, 28 Oct 2006 07:00:42 +0100"  >&lt;p&gt;I tried to applying the patch in my Eclipse env but only the sqlgrammar.jj could be successfully patched. For the remaining files it complained - I will attach a screen shot  for those. Wonder if anyone else ran into this.&lt;/p&gt;

&lt;p&gt;Anyways,   I was able to look at the functionality and things worked fine - could not run the tests though.  Regarding the  questions you raised:&lt;/p&gt;

&lt;p&gt;1) I  think    RENAME COLUMN t.c1 to c2 seems to be more appropriate. This, as you righly pointed out earlier, seems to be consistent&lt;br/&gt;
with RENAME TABLE/INDEX. Of the databases  have worked on - I think  MySQL and Informix behaves in the same way.&lt;/p&gt;

&lt;p&gt;2)  I was wondering shouldn&apos;t  there be some tests  using the sqlAuthorization mode too. I manually tried them - a user with select only privileges attempting to rename the column etc. and those seem to work fine.&lt;/p&gt;</comment>
                            <comment id="12445342" author="kartha" created="Sat, 28 Oct 2006 07:01:09 +0100"  >&lt;p&gt;Patch error in Eclipse&lt;/p&gt;</comment>
                            <comment id="12445349" author="yipng" created="Sat, 28 Oct 2006 09:03:14 +0100"  >&lt;p&gt;Hi Bryan, thanks for working on this feature!&lt;/p&gt;

&lt;p&gt;I am having trouble applying the patch cleanly with the current trunk (rev# 468656) though.  I think its &lt;br/&gt;
probably due to some recent check-in with master outputs that conflicts with the current patch.  I did &lt;br/&gt;
however reviewed the diff files and they look reasonable to me.  Some comments regarding your questions:&lt;/p&gt;

&lt;p&gt;1)  IMHO, since Derby already have support for RENAME TABLE and RENAME INDEX statement, &lt;br/&gt;
    I think RENAME COLUMN would be a natural fit for this feature than the other form.&lt;/p&gt;

&lt;p&gt;2)  The patch&apos;s test coverage is good and I think adding testcases with synonym would be a nice addition.  &lt;/p&gt;

&lt;p&gt;3) and 4)  I am ok with the behavior you described.&lt;/p&gt;

&lt;p&gt;Since the lang/alterTable.sql is already setup to run in SQL authorization mode, I was wondering if it can also be run in legacy mode(non-SQL authorization) as well?  (Perhaps another jira entry should address this issue since it applies to other lang tests in general.)&lt;/p&gt;

</comment>
                            <comment id="12445382" author="bryanpendleton" created="Sat, 28 Oct 2006 16:03:27 +0100"  >&lt;p&gt;Thank you Rajesh and Yip and Army. That is very useful feedback.&lt;/p&gt;

&lt;p&gt;I think that I shall revise the patch to propose just the RENAME COLUMN statement syntax,&lt;br/&gt;
and to take into account the other comments and to update the patch to match current trunk.&lt;/p&gt;

&lt;p&gt;I think that it makes sense to file several follow-on issues to track several of the issues&lt;br/&gt;
raised by the reviewers. So I&apos;ll do that.&lt;/p&gt;

&lt;p&gt;Thanks very much !&lt;/p&gt;</comment>
                            <comment id="12445386" author="bryanpendleton" created="Sat, 28 Oct 2006 16:55:44 +0100"  >&lt;p&gt;Clear patch available while I work on revising the patch.&lt;/p&gt;</comment>
                            <comment id="12447064" author="bryanpendleton" created="Fri, 3 Nov 2006 20:13:43 +0000"  >&lt;p&gt;If/when &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2041&quot; title=&quot;Trigger should register a dependency on tables and columns used in its body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2041&quot;&gt;&lt;del&gt;DERBY-2041&lt;/del&gt;&lt;/a&gt; is addressed, this test script will need to change.&lt;/p&gt;</comment>
                            <comment id="12447099" author="bryanpendleton" created="Fri, 3 Nov 2006 23:57:43 +0000"  >&lt;p&gt;Attached is renameColumn_v3_after_reviews.diff, an updated patch proposal.&lt;/p&gt;

&lt;p&gt;Thank you very much to all the reviewers; the comments were very helpful!&lt;/p&gt;

&lt;p&gt;The major difference between this patch and the previous one is that this patch&lt;br/&gt;
includes only the RENAME COLUMN statement. The consensus seemed to be&lt;br/&gt;
that there was no need to provide two statements that did the same thing, and&lt;br/&gt;
the RENAME COLUMN statement feels more natural.&lt;/p&gt;

&lt;p&gt;I filed two issues for follow-on analysis:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2041&quot; title=&quot;Trigger should register a dependency on tables and columns used in its body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2041&quot;&gt;&lt;del&gt;DERBY-2041&lt;/del&gt;&lt;/a&gt;, to track the unexpected behavior I saw with triggers,&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2041&quot; title=&quot;Trigger should register a dependency on tables and columns used in its body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2041&quot;&gt;&lt;del&gt;DERBY-2041&lt;/del&gt;&lt;/a&gt;, to track the need for updating documentation to describe the new features.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The updated patch also includes several new tests as suggested by the reviewers,&lt;br/&gt;
and addresses some whitespace and formatting problems caused by the fact&lt;br/&gt;
that my default editor setup uses spaces, not tabs, while the sqlgrammar.jj file&lt;br/&gt;
is still largely tab-based, so tab-based patches are preferable.&lt;/p&gt;

&lt;p&gt;The patch is updated to a recent trunk, so should apply cleanly.&lt;/p&gt;

&lt;p&gt;Reviewers, could you please let me know what you think of this latest patch? Thanks!&lt;/p&gt;</comment>
                            <comment id="12447318" author="kartha" created="Sun, 5 Nov 2006 20:23:11 +0000"  >&lt;p&gt;The latest patch applied successfully.&lt;/p&gt;

&lt;p&gt;An initial observations:&lt;/p&gt;

&lt;p&gt;Rename column of a non-existent table throws an &apos; ALTER TABLE&quot; error:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; create table btab (i int, j varchar(100));&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; rename column btab1.i to id;&lt;br/&gt;
ERROR 42Y55: &apos;ALTER TABLE&apos; cannot be performed on &apos;BTAB1&apos; because it does not exist.&lt;/p&gt;

&lt;p&gt;I would expect this to be consistent to following&lt;/p&gt;

&lt;p&gt;ij&amp;gt; rename table abcd to bcd;&lt;br/&gt;
ERROR 42Y55: &apos;RENAME TABLE&apos; cannot be performed on &apos;ABCD&apos; because it does not exist.&lt;/p&gt;

&lt;p&gt;Will try out some other scenarios and provide further comments for the new patch.&lt;/p&gt;


&lt;p&gt;Meanwhile,  I was thinking:&lt;/p&gt;

&lt;p&gt;Like &apos;RENAME COLUMN&quot; isn&apos;t  &apos;RENAME CONSTRAINT&apos;  a good feature to have in Derby ? &lt;/p&gt;

&lt;p&gt;Currently it  is a two step process:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ALTER TABLE DROP CONSTRAINT&lt;/li&gt;
	&lt;li&gt;ALTER TABLE  ADD CONSTRAINT&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With a &apos;RENAME CONSTRAINT&apos;  this can be done in a single step.&lt;/p&gt;

&lt;p&gt;Maybe I will open a JIRA  enhancement request to track this.&lt;/p&gt;

&lt;p&gt;-Rajesh&lt;/p&gt;</comment>
                            <comment id="12447495" author="army" created="Mon, 6 Nov 2006 18:21:25 +0000"  >&lt;p&gt;Thank you for the updated patch, Bryan.  The _v3 patch addresses all of my previous comments and looks great to me.&lt;/p&gt;

&lt;p&gt;I do tend to agree with Rajesh about the presence of &quot;ALTER TABLE&quot; in the error messages--that could be slightly confusing since those words do not appear anywhere in the RENAME COLUMN syntax.  However, that seems like it could easily come as a follow-up patch to the _v3 one, if you are inclined to address it...&lt;/p&gt;

&lt;p&gt;+1 to commit _v3 (though I don&apos;t know what came of the sqlAuthorization discussion; was there some resolution as to how (or if) that affects the tests for altertable.sql?)&lt;/p&gt;</comment>
                            <comment id="12447504" author="yipng" created="Mon, 6 Nov 2006 19:04:29 +0000"  >&lt;p&gt;The _v3 patch applies cleanly.   There is one minor problem with the error message when attempting to rename:&lt;/p&gt;

&lt;p&gt;(1) A non-existing table (Rajesh has already commented on this one). e.g.:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; rename column t2.c1 to w2;&lt;br/&gt;
ERROR 42Y55: &apos;ALTER TABLE&apos; cannot be performed on &apos;T2&apos; because it does not exist&lt;/p&gt;

&lt;p&gt;(2) Renaming a column on a view.  e.g.:&lt;/p&gt;

&lt;p&gt;ij&amp;gt; create view v1 as select * from t1;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; rename column v1.w1 to y1;&lt;br/&gt;
ERROR 42Y62: &apos;ALTER TABLE&apos; is not allowed on &apos;APP.V1&apos; because it is a view.&lt;/p&gt;


&lt;p&gt;Both forms has the string &apos;ALTER TABLE&apos; which should be &apos;RENAME COLUMN&apos;.    Other than that, The patch looks great!  +1 to commit.&lt;/p&gt;</comment>
                            <comment id="12447515" author="kartha" created="Mon, 6 Nov 2006 19:50:25 +0000"  >&lt;p&gt;Sorry to be a pain &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;,  here is another reference to &apos;ALTER TABLE&apos; .&lt;/p&gt;

&lt;p&gt;ij&amp;gt; rename column sys.systables.tablenam to tabnameraj;&lt;br/&gt;
ERROR 42X62: &apos;ALTER TABLE&apos; is not allowed in the &apos;SYS&apos; schema.&lt;/p&gt;

&lt;p&gt;Otherwise, I think the patch looks good.&lt;/p&gt;

&lt;p&gt;Thanks Bryan.&lt;/p&gt;

&lt;p&gt;-Rajesh&lt;/p&gt;</comment>
                            <comment id="12447519" author="bryanpendleton" created="Mon, 6 Nov 2006 19:59:00 +0000"  >&lt;p&gt;Thanks to all for the review (no, you&apos;re not being a pain at all!)&lt;/p&gt;

&lt;p&gt;Good catch on the error message; it&apos;s easy to fix, and I&apos;ll revise the patch to say RENAME COLUMN not ALTER TABLE.&lt;/p&gt;

&lt;p&gt;Rajesh, I think the suggestion about RENAME CONSTRAINT is intriguing, and I think it is worth filing for future investigation. I don&apos;t know how often users with to be able to rename a constraint, but I agree that having to drop and re-add it just in order to rename it is awkward.&lt;/p&gt;

&lt;p&gt;Army, regarding the sqlAuthorization issue, I don&apos;t have a definite resolution. For now, the tests in lang/altertable.sql run only with sqlAuthorization=true. &lt;/p&gt;</comment>
                            <comment id="12447577" author="bryanpendleton" created="Mon, 6 Nov 2006 23:14:29 +0000"  >&lt;p&gt;Attached is  renameColumn_v4_fix_error_message.diff, which differs from the previous patch only in that fixes the error messages to say &quot;RENAME COLUMN&quot; rather than &quot;ALTER TABLE&quot;. &lt;/p&gt;</comment>
                            <comment id="12447961" author="bryanpendleton" created="Tue, 7 Nov 2006 23:12:33 +0000"  >&lt;p&gt;Attachment renameColumn_v5_with_schema_test.diff differs from the&lt;br/&gt;
previous patch proposal only in the addition of a new test that demonstrates&lt;br/&gt;
that you can rename a column in a table in the non-current schema by&lt;br/&gt;
explicitly specifying a schema name.&lt;/p&gt;

&lt;p&gt;That is, the proper syntax for the RENAME COLUMN statement is actually:&lt;/p&gt;

&lt;p&gt;  RENAME COLUMN &lt;span class=&quot;error&quot;&gt;&amp;#91;schema-name.&amp;#93;&lt;/span&gt;table-name.column-name TO new-column-name&lt;/p&gt;

&lt;p&gt;Thanks Knut Anders for noticing this; I&apos;ll fix the documentation in the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2042&quot; title=&quot;Provide documentation for new RENAME COLUMN statement&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2042&quot;&gt;&lt;del&gt;DERBY-2042&lt;/del&gt;&lt;/a&gt; patch.&lt;/p&gt;</comment>
                            <comment id="12448322" author="bryanpendleton" created="Thu, 9 Nov 2006 00:03:13 +0000"  >&lt;p&gt;Many thanks to the reviewers for the help and good suggestions! I decided that&lt;br/&gt;
the patch seems to be ready and so I&apos;ve committed it to subversion as revision 472708.&lt;/p&gt;</comment>
                            <comment id="12551367" author="fuzzylogic" created="Thu, 13 Dec 2007 09:05:02 +0000"  >&lt;p&gt;This issue has been resolved for over a year with no further movement. Closing.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12311732">DERBY-396</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12354729">DERBY-2041</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12311732">DERBY-396</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12354731">DERBY-2042</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12343827" name="1490_cannot_patch.jpg" size="66693" author="kartha" created="Sat, 28 Oct 2006 07:01:09 +0100"/>
                            <attachment id="12342957" name="derby1490_v1_needMoreTests.diff" size="5672" author="bryanpendleton" created="Sun, 15 Oct 2006 19:51:18 +0100"/>
                            <attachment id="12343304" name="renameColumn_v2_with_tests.diff" size="38714" author="bryanpendleton" created="Fri, 20 Oct 2006 02:14:15 +0100"/>
                            <attachment id="12344315" name="renameColumn_v3_after_review.diff" size="22407" author="bryanpendleton" created="Fri, 3 Nov 2006 23:57:43 +0000"/>
                            <attachment id="12344434" name="renameColumn_v4_fix_error_message.diff" size="22418" author="bryanpendleton" created="Mon, 6 Nov 2006 23:14:29 +0000"/>
                            <attachment id="12344517" name="renameColumn_v5_with_schema_test.diff" size="24101" author="bryanpendleton" created="Tue, 7 Nov 2006 23:12:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 19 Jul 2006 18:07:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30014</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0slz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38453</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>