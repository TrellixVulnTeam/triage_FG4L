<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:30:09 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4145/DERBY-4145.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4145] NullPointerException on CREATE TABLE when generated column depends on another generated column</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4145</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;ij&amp;gt; create table t (c1 int, c2 int, c3 generated always as (c1 + c4), c4 generated always as (-c1));&lt;br/&gt;
ERROR XJ001: Java exception: &apos;: java.lang.NullPointerException&apos;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12422076">DERBY-4145</key>
            <summary>NullPointerException on CREATE TABLE when generated column depends on another generated column</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Sun, 5 Apr 2009 21:31:16 +0100</created>
                <updated>Mon, 4 May 2009 19:24:10 +0100</updated>
                            <resolved>Tue, 7 Apr 2009 08:09:49 +0100</resolved>
                                                    <fixVersion>10.5.1.1</fixVersion>
                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12695911" author="knutanders" created="Sun, 5 Apr 2009 21:32:02 +0100"  >&lt;p&gt;Full stack trace:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.BinaryOperatorNode.genSQLJavaSQLTree(BinaryOperatorNode.java:416)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.BinaryOperatorNode.bindExpression(BinaryOperatorNode.java:329)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.BinaryArithmeticOperatorNode.bindExpression(BinaryArithmeticOperatorNode.java:129)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.GenerationClauseNode.bindExpression(GenerationClauseNode.java:117)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.TableElementList.bindAndValidateGenerationClauses(TableElementList.java:803)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.CreateTableNode.bindStatement(CreateTableNode.java:441)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:316)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:88)&lt;br/&gt;
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:802)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:606)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:555)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:329)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:505)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:347)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:245)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.go(Main.java:210)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:177)&lt;br/&gt;
	at org.apache.derby.impl.tools.ij.Main.main(Main.java:73)&lt;br/&gt;
	at org.apache.derby.tools.ij.main(ij.java:59)&lt;/p&gt;</comment>
                            <comment id="12696212" author="rhillegas" created="Mon, 6 Apr 2009 20:03:12 +0100"  >&lt;p&gt;The bug occurs when a generation clause includes a forward reference to a generated column which is declared later on in the table&apos;s signature. The bug occurs because we look for the referenced columns after we bind the generation clauses. When we bind the earlier generated columns, we trip across references to columns which haven&apos;t been bound yet. This raises an npe. The fix is to bind the generation clauses after we look for illegal references.&lt;/p&gt;</comment>
                            <comment id="12696213" author="rhillegas" created="Mon, 6 Apr 2009 20:04:36 +0100"  >&lt;p&gt;Attaching derby-4145-01-aa-forwardReference.diff. This changes the way that we find generation clauses which reference other generated columns.&lt;/p&gt;

&lt;p&gt;Previously, we bound the generation clauses before looking for illegal references. This failed if a generation clause had a forward reference to another generated column declared later in the table&apos;s signature. Now we look for illegal references before binding the generation clauses.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/compile/GenerationClauseNode.java&lt;/p&gt;

&lt;p&gt;Add a new method so that a generation clause can find the columns it references.&lt;/p&gt;


&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/compile/AlterTableNode.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/CreateTableNode.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/TableElementList.java&lt;/p&gt;

&lt;p&gt;Relocate the search for illegal references so that it happens just before we bind the generation clauses.&lt;/p&gt;


&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/tests/lang/GeneratedColumnsTest.java&lt;/p&gt;

&lt;p&gt;Add a test case for this bug.&lt;/p&gt;</comment>
                            <comment id="12696264" author="rhillegas" created="Mon, 6 Apr 2009 22:42:13 +0100"  >&lt;p&gt;Committed derby-4145-01-aa-forwardReference.diff at subversion revision 762520.&lt;/p&gt;</comment>
                            <comment id="12696269" author="rhillegas" created="Mon, 6 Apr 2009 22:47:42 +0100"  >&lt;p&gt;Ported 762520 from trunk to 10.5 branch at subversion revision 762521.&lt;/p&gt;</comment>
                            <comment id="12696424" author="knutanders" created="Tue, 7 Apr 2009 08:09:49 +0100"  >&lt;p&gt;Thanks, Rick! I&apos;ve verified that it now works on trunk and on the 10.5 branch. Closing the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12404758" name="derby-4145-01-aa-forwardReference.diff" size="9564" author="rhillegas" created="Mon, 6 Apr 2009 20:04:36 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 6 Apr 2009 19:03:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24058</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0x5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39189</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>