<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:31:05 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3589/DERBY-3589.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3589] AllocPage.createPage() doesn&apos;t initialize minimumRecordSize correctly</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3589</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;AllocPage.createPage() will initialize minimumRecordSize to the same&lt;br/&gt;
value as borrowedSpace. See this code taken from AllocPage.java:&lt;/p&gt;

&lt;p&gt;-------------------&lt;br/&gt;
	protected void createPage(PageKey newIdentity, int[] args) &lt;br/&gt;
		 throws StandardException&lt;br/&gt;
	{&lt;/p&gt;

&lt;p&gt;		super.createPage(newIdentity, args);&lt;/p&gt;

&lt;p&gt;		// args&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; is the format id&lt;br/&gt;
		// args&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; is whether to sync the page to disk or not&lt;br/&gt;
		// args&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; is the pagesize (used by StoredPage)&lt;br/&gt;
		// args&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; is the spareSize (used by StoredPage)&lt;br/&gt;
		// args&lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; is the number of bytes to reserve for container header&lt;br/&gt;
		// args&lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt; is the minimumRecordSize&lt;br/&gt;
		// NOTE: the arg list here must match the one in FileContainer&lt;br/&gt;
		int pageSize = args&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;;&lt;br/&gt;
		int minimumRecordSize = args&lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt;;&lt;br/&gt;
		borrowedSpace = args&lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt;;&lt;br/&gt;
-------------------&lt;/p&gt;

&lt;p&gt;Here it correctly takes args&lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt; and puts into the local variable&lt;br/&gt;
minimumRecordSize. However, that variable hides a field with the same&lt;br/&gt;
name, and that field is set to args&lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; in the call to&lt;br/&gt;
super.createPage() at the first line in the method. The local variable&lt;br/&gt;
is never used.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12392936">DERBY-3589</key>
            <summary>AllocPage.createPage() doesn&apos;t initialize minimumRecordSize correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Apr 2008 14:27:30 +0100</created>
                <updated>Mon, 4 May 2009 19:22:54 +0100</updated>
                            <resolved>Fri, 4 Apr 2008 23:24:00 +0100</resolved>
                                    <version>10.3.1.4</version>
                    <version>10.4.1.3</version>
                                    <fixVersion>10.3.3.1</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12585051" author="knutanders" created="Thu, 3 Apr 2008 12:26:13 +0100"  >&lt;p&gt;I wonder if it would be better if createPage() took a struct class instead of an array. With named fields we avoid the problem that one array element is interpreted differently by AllocPage.createPage() and StoredPage.createPage(). I think this would also solve &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3116&quot; title=&quot;totalSpace not properly initialized in AllocPage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3116&quot;&gt;&lt;del&gt;DERBY-3116&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12585070" author="knutanders" created="Thu, 3 Apr 2008 13:05:12 +0100"  >&lt;p&gt;I was too quick there. This change alone wouldn&apos;t solve &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3116&quot; title=&quot;totalSpace not properly initialized in AllocPage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3116&quot;&gt;&lt;del&gt;DERBY-3116&lt;/del&gt;&lt;/a&gt;, since that issue is about a field being initialized too late, not about being initialized to the wrong value.&lt;/p&gt;</comment>
                            <comment id="12585094" author="knutanders" created="Thu, 3 Apr 2008 14:00:01 +0100"  >&lt;p&gt;Attached is a patch that changes the signature of CachedPage.createPage() so that it takes a PageCreationArgs object instead of an int array. The PageCreationArgs object contains the same information as the array, only that it has named fields and thereby fixes the problem with minimumRecordSize being taken from the wrong array element.&lt;/p&gt;

&lt;p&gt;I have started the full regression test suite.&lt;/p&gt;</comment>
                            <comment id="12585280" author="knutanders" created="Thu, 3 Apr 2008 21:50:54 +0100"  >&lt;p&gt;Derbyall and suites.All ran cleanly.&lt;/p&gt;</comment>
                            <comment id="12585412" author="knutanders" created="Fri, 4 Apr 2008 07:12:32 +0100"  >&lt;p&gt;I committed the patch to trunk with revision 644620.&lt;br/&gt;
I don&apos;t know the consequences of this bug, if there are any, but I think it&apos;s worth porting it to 10.4 anyway as it looks obvious that the existing code doesn&apos;t do what it intends to do.&lt;/p&gt;</comment>
                            <comment id="12585805" author="knutanders" created="Fri, 4 Apr 2008 23:24:00 +0100"  >&lt;p&gt;Committed to 10.4 with revision 644961.&lt;/p&gt;</comment>
                            <comment id="12593122" author="mikem" created="Tue, 29 Apr 2008 22:16:24 +0100"  >&lt;p&gt;I am working on backporting this fix to 10.3, let me know if anyone see&apos;s a problem with this.  Merge went fine and&lt;br/&gt;
am running tests now.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12379847">DERBY-3112</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12379259" name="d3589-1a.diff" size="14904" author="knutanders" created="Thu, 3 Apr 2008 14:00:01 +0100"/>
                            <attachment id="12379260" name="d3589-1a.stat" size="368" author="knutanders" created="Thu, 3 Apr 2008 14:00:01 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 29 Apr 2008 21:16:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23729</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0xan:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39212</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>