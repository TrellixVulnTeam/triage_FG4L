<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:14:06 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2517/DERBY-2517.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2517] convert  lang/forupdate.sql to junit</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2517</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;convert  lang/forupdate.sql to junit&lt;/p&gt;</description>
                <environment></environment>
        <key id="12366432">DERBY-2517</key>
            <summary>convert  lang/forupdate.sql to junit</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ramand">Ramandeep Kaur</assignee>
                                    <reporter username="ramand">Ramandeep Kaur</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 Apr 2007 01:38:58 +0100</created>
                <updated>Wed, 1 Jul 2009 00:40:20 +0100</updated>
                            <resolved>Tue, 24 Apr 2007 17:33:41 +0100</resolved>
                                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12489264" author="ramand" created="Tue, 17 Apr 2007 00:11:39 +0100"  >&lt;p&gt;I am attaching patch for conversion of forupdate.sql to junit test &quot;ForUpdateTest.java&quot;. &lt;/p&gt;

&lt;p&gt;I am having one problem during conversion.&lt;br/&gt;
In method &quot;public void testUpdates2()&quot; in ForUpdateTest.java file, whenever, I uncomment line stmt3.executeUpdate(&quot;delete from t1 where current of C4&quot;);, I get the following error.&lt;br/&gt;
.......E..........E...&lt;br/&gt;
Time: 38.224&lt;br/&gt;
There were 2 errors:&lt;br/&gt;
1) testUpdates2(org.apache.derbyTesting.functionTests.tests.lang.ForUpdateTest)java.sql.SQLException: Cursor &apos;C4&apos; not found. Verify that autocommit is OFF.&lt;br/&gt;
        at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.CurrentOfNode.bindNonVTITables(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.ForUpdateTest.testUpdates2(ForUpdateTest.java:232)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
2) testUpdates2(org.apache.derbyTesting.functionTests.tests.lang.ForUpdateTest)java.sql.SQLException: Invalid cursor name &apos;C4&apos;.&lt;br/&gt;
        at org.apache.derby.client.am.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
        at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
        at org.apache.derby.client.am.Statement.executeUpdate(Unknown Source)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.ForUpdateTest.testUpdates2(ForUpdateTest.java:232)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: Invalid cursor name &apos;C4&apos;.&lt;br/&gt;
        at org.apache.derby.client.am.Statement.flowExecute(Unknown Source)&lt;br/&gt;
        at org.apache.derby.client.am.Statement.executeUpdateX(Unknown Source)&lt;br/&gt;
        ... 34 more&lt;/p&gt;

&lt;p&gt;FAILURES!!!&lt;br/&gt;
Tests run: 20,  Failures: 0,  Errors: 2&lt;/p&gt;</comment>
                            <comment id="12489840" author="kmarsden" created="Wed, 18 Apr 2007 19:06:47 +0100"  >&lt;p&gt;Thanks Raman for the patch.&lt;/p&gt;

&lt;p&gt;I have not seen the stmt and connection set as instance variables.  Typically I see each fixture call getConnection or createStatement as needed.  I don&apos;t know if this is a problem, but just something I noticed.&lt;/p&gt;

&lt;p&gt;With the new patch can you also submit a file with the stat output?&lt;/p&gt;

&lt;p&gt;The issue with the delete statement is because the cursor C4  is closed, first by JDBC.assertSingleValueResultSet(rs, &quot;1&quot;); and then again by rs.close().   The following edits should make it pass.&lt;/p&gt;

&lt;p&gt;    public void testUpdates2() throws SQLException {	&lt;br/&gt;
		stmt.executeUpdate(&quot;insert into t1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; values (1)&quot;);&lt;br/&gt;
		stmt.setCursorName(&quot;C4&quot;);&lt;br/&gt;
		ResultSet rs = stmt.executeQuery(&quot;select i from t1 s1 for update&quot;);&lt;br/&gt;
                rs.next();&lt;/p&gt;

&lt;p&gt;		Statement stmt2 = createStatement();&lt;br/&gt;
		try &lt;/p&gt;
{
			stmt2.executeUpdate(&quot;delete from s1 where current of C4&quot;);
			fail(&quot;ForUpdateTest: should have thrown exception&quot;);
		}
&lt;p&gt; catch (SQLException e) &lt;/p&gt;
{
                       
				assertSQLState(&quot;42X28&quot;, e);
			
		}


&lt;p&gt;		Statement stmt3 = createStatement();&lt;br/&gt;
		stmt3.executeUpdate(&quot;delete from t1 where current of C4&quot;);&lt;br/&gt;
		stmt3.executeUpdate(&quot;delete from t1&quot;);&lt;/p&gt;

&lt;p&gt;                rs.close();&lt;br/&gt;
                ...&lt;/p&gt;


&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;




</comment>
                            <comment id="12490424" author="ramand" created="Fri, 20 Apr 2007 19:48:00 +0100"  >&lt;p&gt;Kathy, thanks for your feedback.&lt;br/&gt;
I have incorporated your suggestions and tests runs successfully now.&lt;/p&gt;

&lt;p&gt;Thanks, Raman&lt;/p&gt;</comment>
                            <comment id="12491059" author="kmarsden" created="Mon, 23 Apr 2007 21:59:58 +0100"  >&lt;p&gt;The patch was committed with 530946/48&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12355655" name="DERBY-2517.diff" size="16670" author="ramand" created="Tue, 17 Apr 2007 00:11:39 +0100"/>
                            <attachment id="12355943" name="DERBY_2517-0419.diff" size="16573" author="ramand" created="Fri, 20 Apr 2007 19:48:00 +0100"/>
                            <attachment id="12355944" name="DERBY_2517.stat" size="953" author="ramand" created="Fri, 20 Apr 2007 19:48:00 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 18 Apr 2007 18:06:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30491</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0u5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38703</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>