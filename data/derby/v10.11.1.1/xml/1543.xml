<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:12:21 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1543/DERBY-1543.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1543] Address two remaining issues with GRANT/REVOKE functionality: 1) Add warning when sqlAuthorization is on with authentication off 2) Drop permission descriptors when objects they cover are dropped.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1543</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Address two remaining sub-tasks:&lt;/p&gt;

&lt;p&gt;Add warning when sqlAuthorization is on with authentication off: This is a precautionary warning, since sqlAuthorization doesn&apos;t mean much without authentication being ON.&lt;/p&gt;

&lt;p&gt;Drop permission descriptors when objects they cover are dropped: This applies to tables, routines. When these objects are dropped, automatically drop their permisson descriptors.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12346315">DERBY-1543</key>
            <summary>Address two remaining issues with GRANT/REVOKE functionality: 1) Add warning when sqlAuthorization is on with authentication off 2) Drop permission descriptors when objects they cover are dropped.</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12312336">DERBY-464</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bandaram">Satheesh Bandaram</assignee>
                                    <reporter username="bandaram">Satheesh Bandaram</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Jul 2006 01:37:45 +0100</created>
                <updated>Mon, 31 Jul 2006 18:08:14 +0100</updated>
                            <resolved>Mon, 31 Jul 2006 18:07:46 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12422344" author="mamtas" created="Thu, 20 Jul 2006 07:05:10 +0100"  >&lt;p&gt;Satheesh, when you say &quot;This applies to tables, routines&quot;, you mean base tables, derived tables(views) and routines, right? I guess table can implictly mean base table as well as views.&lt;/p&gt;</comment>
                            <comment id="12422981" author="bandaram" created="Mon, 24 Jul 2006 07:58:34 +0100"  >&lt;p&gt;This (temp) patch addresses both these remaining issues. Some work is needed to complete this patch... including 1) Extending droping of descriptors to cover routine perms. Covers Table and Column permission descriptors for now 2) Adding test cases 3) Improve warning mechanism.&lt;/p&gt;

&lt;p&gt;Any thoughts on when the Warning should be raised if authorization is ON without authentication? Should it be on every new connection creation or only at the boot time? Is there a concern that raising this warning might actually alert users about lack of authentication?&lt;/p&gt;

&lt;p&gt;I will submit complete patch in a day or two.&lt;/p&gt;
</comment>
                            <comment id="12423133" author="djd" created="Mon, 24 Jul 2006 20:56:01 +0100"  >&lt;p&gt;How does the dropping of permission descriptors relate to the permission cache? In this code it seems the cache is not touched when a table&apos;s permissions are removed.&lt;/p&gt;</comment>
                            <comment id="12423198" author="bandaram" created="Tue, 25 Jul 2006 00:31:20 +0100"  >&lt;p&gt;Good point, Dan. I will address this in my final version of the patch.&lt;/p&gt;</comment>
                            <comment id="12423205" author="bandaram" created="Tue, 25 Jul 2006 00:55:10 +0100"  >&lt;p&gt;I have a patch that is partial. Will post final complete patch soon.&lt;/p&gt;</comment>
                            <comment id="12423368" author="yipng" created="Tue, 25 Jul 2006 16:30:48 +0100"  >&lt;p&gt;Hi Satheesh:&lt;/p&gt;

&lt;p&gt;   One of my testcases failed for synonym for grant and revoke, will this be addressed in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1543&quot; title=&quot;Address two remaining issues with GRANT/REVOKE functionality: 1) Add warning when sqlAuthorization is on with authentication off 2) Drop permission descriptors when objects they cover are dropped.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1543&quot;&gt;&lt;del&gt;DERBY-1543&lt;/del&gt;&lt;/a&gt; or it will be documented as a restriction on GRANT/REVOKE functionality?&lt;/p&gt;</comment>
                            <comment id="12423757" author="bandaram" created="Thu, 27 Jul 2006 03:47:57 +0100"  >&lt;p&gt;What is the failure you are seeing with synonyms? Attempting to GRANT or REVOKE privileges to synonyms should fail. Synonyms are supposed to be used only in DML statements and not DDL statements. For example, attempting to create an index on synonym, expecting an index to be created on target of the synonym, should fail with error. However, DML statements are supposed to resolve synonyms to their target tables or views.&lt;/p&gt;
</comment>
                            <comment id="12423772" author="yipng" created="Thu, 27 Jul 2006 06:55:54 +0100"  >&lt;p&gt;Are you referring in the context of Derby?  For example, DB2 and IDS allows synonyms in their GRANT or REVOKE statements.&lt;/p&gt;

&lt;p&gt;db2 =&amp;gt; create table t1 (c1 int)&lt;br/&gt;
DB20000I  The SQL command completed successfully.&lt;br/&gt;
db2 =&amp;gt; create synonym s1 for t1&lt;br/&gt;
DB20000I  The SQL command completed successfully.&lt;br/&gt;
db2 =&amp;gt; grant select on s1 to user2&lt;br/&gt;
DB20000I  The SQL command completed successfully.&lt;br/&gt;
db2 =&amp;gt; revoke select on s1 from user2&lt;br/&gt;
DB20000I  The SQL command completed successfully.&lt;br/&gt;
db2=&amp;gt;&lt;/p&gt;

</comment>
                            <comment id="12423787" author="bandaram" created="Thu, 27 Jul 2006 08:23:58 +0100"  >&lt;p&gt;Yes, I was refering to Derby&apos;s handling of synonyms for GRANT/REVOKE. It was debated early on whether or how to handle synonyms for authorization work and was decided synonyms in Derby will be handled later. Here is the start of that thread:&lt;br/&gt;
(&lt;a href=&quot;http://www.nabble.com/Grant-and-Revoke%2C-Part-I-...-DERBY-464...-p1759712.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/Grant-and-Revoke%2C-Part-I-...-DERBY-464...-p1759712.html&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;May be I should mention this in the spec as well. Two more items to add to spec!&lt;/p&gt;</comment>
                            <comment id="12424134" author="bandaram" created="Fri, 28 Jul 2006 18:55:44 +0100"  >&lt;p&gt;This patch should address these two left over items in GRANT/REVOKE implementation. Some implementation notes:&lt;/p&gt;

&lt;p&gt;1) Now Derby raises an SQLWarning when SQL authorization is ON without authentication at connect time. This is done by checking if AuthenticationService being used is an instance of NoneAuthenticationServiceImpl. Since this is the default authentication service with Derby, it should always be present.&lt;/p&gt;

&lt;p&gt;2) Added code to drop permission descriptors from SYSTABLEPERMS, SYSCOLPERMS and SYSROUTINEPERMS when the object they provide permission for is dropped. This includes tables, views and routines and these descriptors needs to be removed from permissionCache as well.&lt;/p&gt;

&lt;p&gt;I have tested the cases when PermissionsDescriptors are in cache also.&lt;/p&gt;

&lt;p&gt;Passed GrantRevoke tests. Will run derbyAll tonight and submit changes over the weekend.&lt;/p&gt;</comment>
                            <comment id="12424136" author="bandaram" created="Fri, 28 Jul 2006 19:02:50 +0100"  >&lt;p&gt;One question I had with selecting hard coded UUIDs for internal system table indices... How does one generate them? Can I use any UUID generated by our internal service? Right now the patch uses cooked up UUIDs that need to be replaced with correctly generated UUIDs before commit.&lt;/p&gt;</comment>
                            <comment id="12424412" author="mamtas" created="Sun, 30 Jul 2006 18:17:23 +0100"  >&lt;p&gt;Satheesh, I ran the upgrade test (upgradeTests/Upgrade_10_1_10_2.java) on a clean client and the test failed. It has following stack trace&lt;br/&gt;
SQLSTATE(XSAI2):ERROR XSAI2: The conglomerate (-1) requested does not exist.&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:304)&lt;br/&gt;
	at org.apache.derby.impl.store.access.RAMTransaction.findExistingConglomerate(RAMTransaction.java:394)&lt;br/&gt;
	at org.apache.derby.impl.store.access.RAMTransaction.openConglomerate(RAMTransaction.java:1315)&lt;br/&gt;
	at org.apache.derby.impl.sql.catalog.TabInfoImpl.getRow(TabInfoImpl.java:794)&lt;br/&gt;
	at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.dropTablePermDescriptor(DataDictionaryImpl.java:2509)&lt;br/&gt;
	at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.dropAllTableAndColPermDescriptors(DataDictionaryImpl.java:2416)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.DropTableConstantAction.executeConstantAction(DropTableConstantAction.java:219)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.MiscResultSet.open(MiscResultSet.java:56)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:357)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1181)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:584)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:516)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.metadata_test.runTest(metadata_test.java:1192)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Method.java:324)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.upgradeTests.UpgradeTester.runMetadataTest(UpgradeTester.java:900)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.upgradeTests.UpgradeTester.runPhase(UpgradeTester.java:367)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.upgradeTests.UpgradeTester.runUpgradeTests(UpgradeTester.java:314)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.upgradeTests.Upgrade_10_1_10_2.main(Upgrade_10_1_10_2.java:43)&lt;/p&gt;

&lt;p&gt;Could this be related to your recent changes for dropping the permission descriptors associated with a table? If not, may be I should open a new jira for upgrade test failure.&lt;/p&gt;

&lt;p&gt;ps I have been out of the loop for last couple days because my laptop died on Thursday. So I hope this is not a known issue and there is already somebody working on it. &lt;/p&gt;</comment>
                            <comment id="12424413" author="mamtas" created="Sun, 30 Jul 2006 18:48:53 +0100"  >&lt;p&gt;syscat.sql is failing when run with framework as DerbyNetClient. Seems like it might be just a master update issue. I ran the test with Sun jdk1.4 on Windows XP machine as follows&lt;br/&gt;
java -Dframework=DerbyNetClient org.apache.derbyTesting.functionTests.harness.RunTest lang/syscat.sql&lt;/p&gt;</comment>
                            <comment id="12424585" author="bandaram" created="Mon, 31 Jul 2006 18:07:46 +0100"  >&lt;p&gt;Submitted a fix.&lt;/p&gt;</comment>
                            <comment id="12424586" author="bandaram" created="Mon, 31 Jul 2006 18:08:14 +0100"  >&lt;p&gt;Added tests and it seems to work as expected.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12337383" name="DERBY-1543.out" size="11234" author="bandaram" created="Mon, 24 Jul 2006 07:58:34 +0100"/>
                            <attachment id="12337724" name="Derby1543.diff" size="43532" author="bandaram" created="Fri, 28 Jul 2006 18:55:44 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 20 Jul 2006 06:05:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30042</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy150n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40463</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>