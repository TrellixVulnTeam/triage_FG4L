<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:25:26 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1039/DERBY-1039.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1039] Database creation should fail if specified log device path already exists</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1039</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If a database is created with logDevice pointing to a directory&lt;br/&gt;
containing old log files, one might experience errors during recovery.&lt;/p&gt;

&lt;p&gt;  ERROR XSDB4: Page Page(0,Container(0, 768)) is at version 2,657, the&lt;br/&gt;
  log file contains change version 2,715, either there are log records&lt;br/&gt;
  of this page missing, or this page did not get written out to disk&lt;br/&gt;
  properly.&lt;/p&gt;

&lt;p&gt;To avoid this problem, database creation should fail if logDevice is&lt;br/&gt;
pointing to an existing directory.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12329374">DERBY-1039</key>
            <summary>Database creation should fail if specified log device path already exists</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tsuresh">Suresh Thalamati</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Feb 2006 16:41:06 +0000</created>
                <updated>Mon, 29 Jun 2009 14:13:27 +0100</updated>
                            <resolved>Fri, 28 Apr 2006 00:50:31 +0100</resolved>
                                    <version>10.1.2.1</version>
                    <version>10.2.1.6</version>
                    <version>10.3.1.4</version>
                                    <fixVersion>10.1.3.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12367479" author="knutanders" created="Thu, 23 Feb 2006 16:47:33 +0000"  >&lt;p&gt;Repro provided by Suresh Thalamati:&lt;/p&gt;

&lt;p&gt;1) run logd.sql , then kill IJ&lt;br/&gt;
2) change the log swith interval to&lt;br/&gt;
   derby.storage.logSwitchInterval=3145727&lt;br/&gt;
3) run logd1.sql , then kill IJ&lt;br/&gt;
4) reconnect to wombat1 , it will fail with following error.&lt;br/&gt;
ij&amp;gt; connect &apos;wombat1&apos;;&lt;br/&gt;
ERROR XJ040: Failed to start database &apos;wombat1&apos;, see the next&lt;br/&gt;
exception for details.&lt;br/&gt;
ERROR XSDB4: Page Page(1,Container(0, 896)) is at version 2, the log&lt;br/&gt;
file contains change version 3, either there are log records of this&lt;br/&gt;
page missing, or this page did not get written out to disk properly.&lt;/p&gt;</comment>
                            <comment id="12367869" author="djd" created="Mon, 27 Feb 2006 08:32:12 +0000"  >&lt;p&gt;The proposed solution from the summary seems too extreme and could break existing applications.  If the logDevice path already exists but is empty then there is no problem, I know I&apos;ve set up scripts like this in the past. Should the checks be limited to situations that cause problems, namely as described in the description, the directory alredy contains old log files?&lt;/p&gt;</comment>
                            <comment id="12368132" author="mikem" created="Wed, 1 Mar 2006 03:05:25 +0000"  >&lt;p&gt;I think it is ok to allow existing empty directory, this probably is better for backward compatibility.  &lt;/p&gt;
</comment>
                            <comment id="12368133" author="mikem" created="Wed, 1 Mar 2006 03:07:29 +0000"  >&lt;p&gt;I am bumping the priority of this up, as there is a possibility of database corruption from this user error.  And it may be hard after the fact to identify that this was the cause of the problem.  When this gets fixed we should look and see to get it into 10.1 also.&lt;/p&gt;</comment>
                            <comment id="12375446" author="tsuresh" created="Fri, 21 Apr 2006 08:01:51 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1039&quot; title=&quot;Database creation should fail if specified log device path already exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1039&quot;&gt;&lt;del&gt;DERBY-1039&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;&amp;#8211; database create will fail with error if the user specified logDevice location &lt;br/&gt;
   already contains non-empty &quot;log&quot; dir at that location. &lt;br/&gt;
&amp;#8211; added a new test that tests database creation with logDevice location &lt;br/&gt;
   with absolute paths and also the above expected error case. &lt;/p&gt;

&lt;p&gt;TESTS : derbyall test suite passed on Windows XP/JDK142/ with sane classes&lt;br/&gt;
        directory and insane jars. &lt;/p&gt;

&lt;p&gt;It would be great if some can review and commit this patch. &lt;/p&gt;

&lt;p&gt;svn stat:&lt;br/&gt;
M      java\engine\org\apache\derby\impl\store\raw\log\LogToFile.java&lt;br/&gt;
M    java\testing\org\apache\derbyTesting\functionTests\tests\store\copyfiles.ant&lt;br/&gt;
A      java\testing\org\apache\derbyTesting\functionTests\tests\store\LogDeviceTest.java&lt;br/&gt;
A      java\testing\org\apache\derbyTesting\functionTests\tests\store\LogDeviceTest_app.properties&lt;br/&gt;
A      java\testing\org\apache\derbyTesting\functionTests\master\LogDeviceTest.out&lt;br/&gt;
M      java\testing\org\apache\derbyTesting\functionTests\suites\storemore.runall&lt;/p&gt;</comment>
                            <comment id="12376362" author="mikem" created="Wed, 26 Apr 2006 07:10:34 +0100"  >&lt;p&gt;reviewed and committed this patch to the trunk (initially forgot new files so commit is in 2 pieces):&lt;br/&gt;
------------------------------------------------------------------------&lt;br/&gt;
r397014 | mikem | 2006-04-25 16:09:04 -0700 (Tue, 25 Apr 2006) | 5 lines&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1039&quot; title=&quot;Database creation should fail if specified log device path already exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1039&quot;&gt;&lt;del&gt;DERBY-1039&lt;/del&gt;&lt;/a&gt;, committed on behalf of Suresh Thalamati&lt;/p&gt;

&lt;p&gt;New tests that should have been part of previous checkin for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1039&quot; title=&quot;Database creation should fail if specified log device path already exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1039&quot;&gt;&lt;del&gt;DERBY-1039&lt;/del&gt;&lt;/a&gt; fix.&lt;/p&gt;


&lt;p&gt;------------------------------------------------------------------------&lt;br/&gt;
r397011 | mikem | 2006-04-25 16:02:26 -0700 (Tue, 25 Apr 2006) | 8 lines&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1039&quot; title=&quot;Database creation should fail if specified log device path already exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1039&quot;&gt;&lt;del&gt;DERBY-1039&lt;/del&gt;&lt;/a&gt;, committed on behalf of Suresh Thalamati&lt;/p&gt;

&lt;p&gt;&amp;#8211; database create will fail with error if the user specified logDevice location&lt;br/&gt;
   already contains non-empty &quot;log&quot; dir at that location.&lt;br/&gt;
   &amp;#8211; added a new test that tests database creation with logDevice location&lt;br/&gt;
      with absolute paths and also the above expected error case.&lt;/p&gt;</comment>
                            <comment id="12376760" author="mikem" created="Fri, 28 Apr 2006 00:50:12 +0100"  >&lt;p&gt;backported the fix for this issue into the 10.1 branch, targeted for the 10.1.3 release:&lt;/p&gt;

&lt;p&gt;m101_142:20&amp;gt;svn commit&lt;/p&gt;

&lt;p&gt;Sending        java\engine\org\apache\derby\impl\store\raw\log\LogToFile.java&lt;br/&gt;
Adding         java\testing\org\apache\derbyTesting\functionTests\master\LogDevi&lt;br/&gt;
ceTest.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\master\dblook_&lt;br/&gt;
test.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\suites\storemo&lt;br/&gt;
re.runall&lt;br/&gt;
Adding         java\testing\org\apache\derbyTesting\functionTests\tests\store\Lo&lt;br/&gt;
gDeviceTest.java&lt;br/&gt;
Adding         java\testing\org\apache\derbyTesting\functionTests\tests\store\Lo&lt;br/&gt;
gDeviceTest_app.properties&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\store\co&lt;br/&gt;
pyfiles.ant&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\util\TestUtil.&lt;br/&gt;
java&lt;br/&gt;
Transmitting file data .....&lt;br/&gt;
Committed revision 397586.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12325641" name="derby-1039.diff" size="18561" author="tsuresh" created="Fri, 21 Apr 2006 08:01:51 +0100"/>
                            <attachment id="12323308" name="logd.sql" size="1187" author="knutanders" created="Thu, 23 Feb 2006 16:47:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 27 Feb 2006 08:32:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29827</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0wr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39124</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>