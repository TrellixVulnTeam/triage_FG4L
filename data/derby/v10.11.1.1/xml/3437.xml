<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:39:09 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3437/DERBY-3437.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3437] Give all replication threads meaningfull names</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3437</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Some threads are created for replication purposes:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;The log shipper thread on the master (o.a.d.i.services.master.MasterController)&lt;/li&gt;
	&lt;li&gt;The database boot thread on the slave (o.a.d.i.db.SlaveDatabase)&lt;/li&gt;
	&lt;li&gt;The log receiver thread on the slave (o.a.d.i.services.slave.SlaveController)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;These threads should be given names to simplify debugging.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12389115">DERBY-3437</key>
            <summary>Give all replication threads meaningfull names</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="serge.tsv">Serge Tsv</assignee>
                                    <reporter username="jorgenlo">J&#248;rgen L&#248;land</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Feb 2008 13:17:55 +0000</created>
                <updated>Mon, 29 Jun 2009 14:13:23 +0100</updated>
                            <resolved>Tue, 11 Mar 2008 13:10:30 +0000</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Replication</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12570680" author="jorgenlo" created="Wed, 20 Feb 2008 13:24:53 +0000"  >&lt;p&gt;A similar problem was reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3378&quot; title=&quot;Derby&amp;#39;s timer thread should have a name that identifies it as belong to a derby instance&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3378&quot;&gt;DERBY-3378&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12571480" author="serge.tsv" created="Fri, 22 Feb 2008 17:37:23 +0000"  >&lt;p&gt;Hello!&lt;/p&gt;

&lt;p&gt;I&apos;m trying to figure out if there&apos;s more then one instance of a particular replication-related thread could be started by a Derby engine. &lt;/p&gt;

&lt;p&gt;If this is the case, then by defining some hardcoded name for each thread could possibly result in more then one thread running with a same name (it&apos;s possible to have more then one thread with a same name). I depends on how it&apos;s important from a debugging perspective then. But a name per thread type scheme will be much easier to implement and support I suppose.&lt;/p&gt;

&lt;p&gt;By the way, I haven&apos;t found any public user-docs related to a replication in Derby. I guess it&apos;s still under development then and is not included into a recent public stable builds. Could there be any requirements/development documents which might give more information about Derby replication (besides the source code and java docs)?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12571513" author="oysteing" created="Fri, 22 Feb 2008 18:29:12 +0000"  >&lt;p&gt;There will be one set of threads for each database that is replicated.&lt;br/&gt;
Hence, the name of the thread should include the name of the database.&lt;/p&gt;
</comment>
                            <comment id="12571714" author="serge.tsv" created="Sat, 23 Feb 2008 09:51:26 +0000"  >&lt;p&gt;If a database name should be a part of a replication threads names, then I think the following thread naming scheme could be used:&lt;/p&gt;

&lt;p&gt;    derby.(slave or master)_dbname.threadtype,&lt;/p&gt;

&lt;p&gt;e.g. derby.slave_dbname.boot, derby.master_dbname.logger etc.&lt;/p&gt;

&lt;p&gt;I assume it&apos;s not necessary to include a component name (e.g. &quot;repl&quot;) as a part of a name thread, as &quot;slave&quot; and &quot;master&quot; implicitly refer to replication.&lt;/p&gt;

&lt;p&gt;I will try to reproduce the replication process, so I could see the thread in the jconsole. Then I&apos;ll make the changes, test them and will submit the patch.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12571727" author="serge.tsv" created="Sat, 23 Feb 2008 12:29:36 +0000"  >&lt;p&gt;Defines meaningful names for SlaveDatabaseBootThread thread instances created by SlaveDatabase, and SlaveLogReceiverThread thread instances created by SlaveController.&lt;/p&gt;

&lt;p&gt;The names have the format:&lt;/p&gt;

&lt;p&gt;    derby.(slave or master).threadtype-dbname,&lt;/p&gt;

&lt;p&gt;e.g derby.slave.boot-myDerby&lt;/p&gt;</comment>
                            <comment id="12571728" author="serge.tsv" created="Sat, 23 Feb 2008 12:43:12 +0000"  >&lt;p&gt;I have attached a patch with defines names for log receiver thread and slave boot thread. &lt;/p&gt;

&lt;p&gt;I&apos;ve decided to use a more conventional thread naming format, with a constant part of the name on the left side of a minus sign, and a variable part - on the right one.&lt;/p&gt;

&lt;p&gt;As of now, a database name is not accessibly from a log shipper thread class. To use a database name to name a log shipper thread would require one of the following I guess &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;pass the database name as a parameter to a log shipper constructor&lt;/li&gt;
	&lt;li&gt;make dbname field package-protected in the MasterController class&lt;/li&gt;
	&lt;li&gt;make a log shipper class an internal to MasterController (as a log reciever class, which is defined as internal in SlaveController)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;None of these solutions is perfect, but I haven&apos;t found any other ways that could make db name available to log receiver...&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12571805" author="myrna" created="Sat, 23 Feb 2008 23:44:26 +0000"  >&lt;p&gt;Marking &apos;patch available&apos; as it appears from the comments a patch is ready for review.&lt;/p&gt;</comment>
                            <comment id="12572462" author="oysteing" created="Tue, 26 Feb 2008 13:08:07 +0000"  >&lt;p&gt;Serge, thanks for the patch.  It looks good.  Would it be possible to create it relative to the trunk directory.   That would make it easier for me to apply it.&lt;/p&gt;

&lt;p&gt;For the log shipper issue, either of your first two suggestions is OK with me.  I do not think it is a good idea to move the class since there is a possibility that we will have several implementations of the LogShipper interface in the future.&lt;/p&gt;</comment>
                            <comment id="12574088" author="serge.tsv" created="Sat, 1 Mar 2008 09:15:31 +0000"  >&lt;p&gt;Hello!&lt;/p&gt;

&lt;p&gt;&#216;ystein, you&apos;re right, the patch was relative to a trunk/java folder. I&apos;ve attached a patch against a latest trunk revision relative to a trunk folder now which incorporates changes introduced in the previous patch and also a naming for an async log shipper thread.&lt;/p&gt;

&lt;p&gt;Below is a list of modified files with short explanations.&lt;/p&gt;

&lt;p&gt;M java/engine/org/apache/derby/impl/services/replication/slave/SlaveController.java&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Have added a package-protected non-arg constructor to an inner SlaveLogReceiverThread class, with a call to Thread constructor with a name parameter.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;M java/engine/org/apache/derby/impl/services/replication/master/MasterController.java&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Have created a new package-protected method &quot;getDbName&quot; now used by AsynchronousLogShipper to name a log shipper thread.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;M java/engine/org/apache/derby/impl/services/replication/master/AsynchronousLogShipper.java&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Have added a call to the Thread constructor with a thread name parameter.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;M java/engine/org/apache/derby/impl/db/SlaveDatabase.java&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Have added an additional name parameter to a Thread construtor creating a slave database boot thread.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Have tested it, everything seems to work fine.&lt;/p&gt;

&lt;p&gt;The following is an example of replication thread names:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;derby.slave.boot-localdb_slave&lt;/li&gt;
	&lt;li&gt;derby.slave.logger-localdb_slave&lt;/li&gt;
	&lt;li&gt;derby.master.logger-localdb&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12574954" author="oysteing" created="Tue, 4 Mar 2008 12:35:33 +0000"  >&lt;p&gt;Thanks for this useful patch, Serge.  I have already had use of it when debugging replication.&lt;br/&gt;
Committed as revision 633451.&lt;/p&gt;</comment>
                            <comment id="12577433" author="jorgenlo" created="Tue, 11 Mar 2008 13:10:30 +0000"  >&lt;p&gt;Thanks for the patch, Serge. I have confirmed that the threads in question now have meaningful names.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12387663">DERBY-3378</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12376896" name="DERBY-3437-1.diff" size="3299" author="serge.tsv" created="Sat, 1 Mar 2008 09:15:31 +0000"/>
                            <attachment id="12376897" name="DERBY-3437-1.stat" size="340" author="serge.tsv" created="Sat, 1 Mar 2008 09:15:31 +0000"/>
                            <attachment id="12376301" name="DERBY-3437.diff" size="1558" author="serge.tsv" created="Sat, 23 Feb 2008 12:29:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 22 Feb 2008 17:37:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30851</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0wuv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39141</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>