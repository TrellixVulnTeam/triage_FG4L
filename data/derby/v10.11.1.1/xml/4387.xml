<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:25:11 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4387/DERBY-4387.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4387] Infinite loop in PredicateList.joinClauseTransitiveClosure()</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4387</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;This sequence of statements triggers an infinite loop in PredicateList.joinClauseTransitiveClosure() and never completes:&lt;/p&gt;

&lt;p&gt;create table c (a int, b int, c int);&lt;br/&gt;
create table cc (aa int);&lt;/p&gt;

&lt;p&gt;select * from cc t1, c t2, cc t3 where t3.aa = t2.a and t3.aa = t2.b and t3.aa = t2.c;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12436592">DERBY-4387</key>
            <summary>Infinite loop in PredicateList.joinClauseTransitiveClosure()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Sep 2009 13:34:41 +0100</created>
                <updated>Thu, 20 Jan 2011 21:43:58 +0000</updated>
                            <resolved>Wed, 7 Jul 2010 23:53:06 +0100</resolved>
                                    <version>10.0.2.1</version>
                    <version>10.1.3.1</version>
                    <version>10.2.2.0</version>
                    <version>10.3.3.0</version>
                    <version>10.4.2.0</version>
                    <version>10.5.3.0</version>
                    <version>10.6.1.0</version>
                                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12759513" author="knutanders" created="Fri, 25 Sep 2009 13:37:29 +0100"  >&lt;p&gt;Thread dump when the statement has entered the infinite loop:&lt;/p&gt;

&lt;p&gt;&quot;main&quot; prio=3 tid=0x0806f400 nid=0x2 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0xfe28e000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.PredicateList.joinClauseTransitiveClosure(PredicateList.java:2071)&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.SelectNode.performTransitiveClosure(SelectNode.java:1109)&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.SelectNode.preprocess(SelectNode.java:954)&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.DMLStatementNode.optimizeStatement(DMLStatementNode.java:318)&lt;br/&gt;
        at org.apache.derby.impl.sql.compile.CursorNode.optimizeStatement(CursorNode.java:573)&lt;br/&gt;
        at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:373)&lt;br/&gt;
        at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:88)&lt;br/&gt;
        at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:824)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:606)&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;locked &amp;lt;0xbad3dc50&amp;gt; (a org.apache.derby.impl.jdbc.EmbedConnection40)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:555)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.ij.executeImmediate(ij.java:329)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.utilMain.doCatch(utilMain.java:521)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.utilMain.runScriptGuts(utilMain.java:366)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.utilMain.go(utilMain.java:261)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.go(Main.java:229)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.mainCore(Main.java:184)&lt;br/&gt;
        at org.apache.derby.impl.tools.ij.Main.main(Main.java:75)&lt;br/&gt;
        at org.apache.derby.tools.ij.main(ij.java:59)&lt;br/&gt;
        at org.apache.derby.iapi.tools.run.main(run.java:53)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12782953" author="dagw" created="Thu, 26 Nov 2009 18:02:02 +0000"  >&lt;p&gt;Uploading a patch which solves this case, and adds a test case to JoinTest.&lt;/p&gt;

&lt;p&gt;The problem here is that the computation of the transitive closure for&lt;br/&gt;
the repro case, finds that closure predicates that apply for two&lt;br/&gt;
columns &lt;b&gt;in the same table&lt;/b&gt;. Cf the following snapshot of the fully&lt;br/&gt;
computed joinClauses table (with the fix), where EC is equivalence&lt;br/&gt;
class assigned, and a * denotes a predicate added by the closure&lt;br/&gt;
computation.  cf. PredicateList#joinClauseTransitiveClosure:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: (t1)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: (t2)                      i.e.&lt;br/&gt;
       &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: 2.1 = 1.1 EC: 0           t3.aa == t2.a&lt;br/&gt;
       &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: 1.1 = 1.3 EC: 0           t2.a  == t2.c   *&lt;br/&gt;
       &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;: 1.1 = 1.2 EC: 0           t2.a  == t2.b   *&lt;br/&gt;
       &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;: 2.1 = 1.2 EC: 0           t3.aa == t2.b&lt;br/&gt;
       &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt;: 2.1 = 1.3 EC: 0           t3.aa == t2.c&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;: (t3)&lt;br/&gt;
       &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: 2.1 = 1.1 EC: 0           t3.aa == t2.a&lt;br/&gt;
       &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;: 2.1 = 1.2 EC: 0           t3.aa == t2.b&lt;br/&gt;
       &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;: 2.1 = 1.3 EC: 0           t3.aa == t2.c&lt;/p&gt;

&lt;p&gt;Before the fix, the derived predicates (e.g. t2.a == t2.b) were&lt;br/&gt;
added twice and caused an infinite loop. The patch makes sure to only&lt;br/&gt;
add the derived predicate once (when outer and inner predicates list&lt;br/&gt;
are the same, as they are here).&lt;/p&gt;

&lt;p&gt;Running regressions.&lt;/p&gt;</comment>
                            <comment id="12783012" author="dagw" created="Fri, 27 Nov 2009 02:32:36 +0000"  >&lt;p&gt;Regressions passed OK.&lt;/p&gt;</comment>
                            <comment id="12783112" author="knutanders" created="Fri, 27 Nov 2009 14:45:16 +0000"  >&lt;p&gt;The patch looks correct to me. I&apos;ve also verified that it makes the query in the bug description return successfully. +1 to commit.&lt;/p&gt;</comment>
                            <comment id="12785977" author="dagw" created="Fri, 4 Dec 2009 16:10:47 +0000"  >&lt;p&gt;Committed patch as svn 887246, resolving.&lt;/p&gt;</comment>
                            <comment id="12785982" author="bryanpendleton" created="Fri, 4 Dec 2009 16:17:38 +0000"  >&lt;p&gt;Looks like the PredicateList.java change may have a tabs-versus-spaces format inconsistency.&lt;br/&gt;
Sorry to be a bit late with this feedback.&lt;/p&gt;</comment>
                            <comment id="12785984" author="dagw" created="Fri, 4 Dec 2009 16:18:57 +0000"  >&lt;p&gt;Backported to 10.5 branch as svn 887249.&lt;/p&gt;

&lt;p&gt;Bryan, thanks for noticing, I&apos;ll fix it.&lt;/p&gt;</comment>
                            <comment id="12785988" author="dagw" created="Fri, 4 Dec 2009 16:24:39 +0000"  >&lt;p&gt;Bryan, I think the indentation is correct; but my new lines use blanks rather than tabs, I have given up&lt;br/&gt;
on tabs entirely lately. (I used to try to keep tabs-only files that way, but there are very few of them left, most already have many changed lines with space indentation.)&lt;/p&gt;</comment>
                            <comment id="12828551" author="knutanders" created="Tue, 2 Feb 2010 09:33:22 +0000"  >&lt;p&gt;Verified that the statement does not loop infinitely on trunk. Closing.&lt;/p&gt;</comment>
                            <comment id="12884454" author="lilywei" created="Thu, 1 Jul 2010 23:04:42 +0100"  >&lt;p&gt;Reopen to 10.5 back port&lt;/p&gt;</comment>
                            <comment id="12886141" author="mikem" created="Wed, 7 Jul 2010 23:53:06 +0100"  >&lt;p&gt;Dag had already backported this issue to 10.5, but had not updated the fix in field.  resolving it as fixed in 10.5.  I am not sure what version of 10.5 it may have gone in, so just marking it as fixed in next release.&lt;/p&gt;</comment>
                            <comment id="12886143" author="mikem" created="Wed, 7 Jul 2010 23:54:24 +0100"  >&lt;p&gt;i am working on backporting this to 10.5.&lt;/p&gt;</comment>
                            <comment id="12886147" author="dagw" created="Thu, 8 Jul 2010 00:00:10 +0100"  >
&lt;p&gt;The last official 10.5 release was 10.5.3.0  (August 21, 2009 / SVN 802917).&lt;br/&gt;
The patch went in at 887249, so marking it as fixed in next release is fine. Thanks for catching that, Mike!&lt;/p&gt;</comment>
                            <comment id="12984424" author="knutanders" created="Thu, 20 Jan 2011 21:43:58 +0000"  >&lt;p&gt;Reassigning the issue to Dag who wrote the fix.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12468384">DERBY-4728</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12426235" name="derby-4387.diff" size="3246" author="dagw" created="Thu, 26 Nov 2009 18:07:45 +0000"/>
                            <attachment id="12426234" name="derby-4387.stat" size="155" author="dagw" created="Thu, 26 Nov 2009 18:02:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10365"><![CDATA[Crash]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 26 Nov 2009 18:02:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24224</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10422"><![CDATA[High Value Fix]]></customfieldvalue>
    <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0ng7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37617</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>