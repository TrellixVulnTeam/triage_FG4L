<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:34:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2054/DERBY-2054.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2054] Rewrite &apos;derbynet/SuicideOfStreaming&apos; to a JUnit test</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2054</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The test &apos;derbynet/SuicideOfStreaming&apos; should be rewritten to a JUnit test more in line with our newly created test system.&lt;br/&gt;
It is one of the last tests still being run from the deprecated &apos;tests/junitTests/&apos; directory, through a wrapper class.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12355041">DERBY-2054</key>
            <summary>Rewrite &apos;derbynet/SuicideOfStreaming&apos; to a JUnit test</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="kristwaa">Kristian Waagan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Nov 2006 15:20:17 +0000</created>
                <updated>Tue, 25 May 2010 11:00:46 +0100</updated>
                            <resolved>Tue, 14 Nov 2006 14:38:48 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12448170" author="kristwaa" created="Wed, 8 Nov 2006 15:36:09 +0000"  >&lt;p&gt;&apos;derby-2054-preview.diff&apos; is the first attempt at rewriting SuicideOfStreaming.&lt;br/&gt;
It is kind of special, since it uses a property inside a sanity manager block in the Derby code to generate an exception on the server. There is also the matter of only returning a suite with tests if Derby is built in sane mode (see the suite-method).&lt;/p&gt;

&lt;p&gt;Please have a look at the suggested test, and read the comments in the code. The diffs of the two old files implementing this test are included for reference.&lt;/p&gt;

&lt;p&gt;I will post another patch shortly, which will add a _Suite in the derbynet directory and fix a few other small things.&lt;/p&gt;</comment>
                            <comment id="12448178" author="naka" created="Wed, 8 Nov 2006 15:55:39 +0000"  >&lt;p&gt;Hello.&lt;/p&gt;

&lt;p&gt;I remember OwnServerTests_app.properties which was needed only for OwnServerTests.java.&lt;br/&gt;
I think it also should be removed in your patch.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/repos/asf/db/derby/code/trunk/java/testing/org/apache/derbyTesting/functionTests/tests/junitTests/derbyNet/OwnServerTests_app.properties&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/db/derby/code/trunk/java/testing/org/apache/derbyTesting/functionTests/tests/junitTests/derbyNet/OwnServerTests_app.properties&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12448740" author="kristwaa" created="Fri, 10 Nov 2006 14:03:54 +0000"  >&lt;p&gt;Thanks Tomohito. My patch removes several files.&lt;/p&gt;

&lt;p&gt;&apos;derby-2054-1a.diff&apos; rewrites the SuicideOfStreaming tests to a JUnit test and: Deletes files no longer needed, adds SqlException and ByteArrayCombinerStreamTest to derbynet/_Suite, update suite files for the old harness, rewrite DDMWriter so that it requires the debug property to be true (not only set).&lt;/p&gt;

&lt;p&gt;Patch ready for review/commit.&lt;/p&gt;</comment>
                            <comment id="12448936" author="naka" created="Sat, 11 Nov 2006 05:58:25 +0000"  >&lt;p&gt;I&apos;m not familiar with newly created test system at all.&lt;br/&gt;
Then this comment may be missed ...&lt;/p&gt;

&lt;p&gt;System property of derby.debug.suicideOfLayerBStreaming is effective on code of NetworkServer.&lt;br/&gt;
Then System property must be set for process of NetworkServer.&lt;/p&gt;

&lt;p&gt;Reading the code setUp(), &lt;br/&gt;
I found both of code to call JDBC interface to execute sql which would be at NetworkClient and &lt;br/&gt;
code to set System property of derby.debug.suicideOfLayerBStreaming in a same method.&lt;/p&gt;

&lt;p&gt;In newly created test system, does NetworkServer and NetworkClient run on a same process ?&lt;br/&gt;
I remember that they are different in old test system ... &lt;/p&gt;
</comment>
                            <comment id="12448977" author="kristwaa" created="Sat, 11 Nov 2006 13:35:30 +0000"  >&lt;p&gt;You are correct, currently the NetworkServer and the client code run in the same process (see NetworkServerTestSetup).&lt;/p&gt;

&lt;p&gt;When/if we extend the test system to allow for running the NetworkServer in a separate process (possibly on a remote host), the test must be rewritten/modified. I wrote a comment regarding this in the class JavaDoc.&lt;/p&gt;</comment>
                            <comment id="12449035" author="djd" created="Sat, 11 Nov 2006 21:28:53 +0000"  >&lt;p&gt;An alternative is that the test could be skipped if running in a separate process/machine.&lt;br/&gt;
Would need to see how much extra value having a particular test running with a remote server would be if there were many other tests running remote.&lt;/p&gt;</comment>
                            <comment id="12449142" author="naka" created="Sun, 12 Nov 2006 15:12:39 +0000"  >&lt;p&gt;I think this may be very very basic question ...&lt;/p&gt;

&lt;p&gt;I executed derbyall suite with this patch.&lt;br/&gt;
But could not found the name of this test in derbyall_pass.txt (nor derbyall_fail.txt nor derbyall_skip.txt) ...&lt;/p&gt;

&lt;p&gt;Is newly created test system executed in derbyall suite ...?&lt;/p&gt;</comment>
                            <comment id="12449329" author="naka" created="Mon, 13 Nov 2006 11:40:38 +0000"  >&lt;p&gt;According to &lt;a href=&quot;http://wiki.apache.org/db-derby/DerbyJUnitTesting&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/db-derby/DerbyJUnitTesting&lt;/a&gt;,&lt;br/&gt;
I executed org.apache.derbyTesting.functionTests.suites.All and &lt;br/&gt;
confirmed that SuicideOfStreamingTest was passed.&lt;/p&gt;</comment>
                            <comment id="12449677" author="kristwaa" created="Tue, 14 Nov 2006 14:38:47 +0000"  >&lt;p&gt;Committed &apos;derby-2054-1a.diff&apos; to trunk with revision 474803.&lt;/p&gt;</comment>
                            <comment id="12450595" author="djd" created="Fri, 17 Nov 2006 02:27:39 +0000"  >&lt;p&gt;SuicideOfStreamingTest.tearDown() does not call super.tearDown() which may be causing other later tests to fail due to the extra time needed to start the network server. However adding super.tearDown() causes authentication errors in later tests and in the tearDown method.&lt;/p&gt;</comment>
                            <comment id="12450774" author="kristwaa" created="Fri, 17 Nov 2006 15:42:28 +0000"  >&lt;p&gt;Dan, could you please elaborate on the problems you see with the test?&lt;/p&gt;

&lt;p&gt;As far as I see, the only thing that would happen if super.tearDown is called, is that a rollback is issued and the the connection is closed.&lt;br/&gt;
I do not understand how not doing this would affect other tests with regard of &quot;the extra time needed to start the network server&quot;.&lt;/p&gt;

&lt;p&gt;I think that due to the other problems I had with converting the test, I forgot to close the connection manually. This would have to be done inside a try-block, where any exceptions are ignored. This is because setting the debug property causes havoc in the communication between the client and the server. My intention was that the network server I use is to be used only for this test, since simply unsetting the debug property is not enough for it to recover.&lt;/p&gt;

&lt;p&gt;Also, what authentication errors are you seeing?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;</comment>
                            <comment id="12450783" author="djd" created="Fri, 17 Nov 2006 16:20:04 +0000"  >&lt;p&gt;Having spent some time tracking down the network server timeouts (see &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1966&quot; title=&quot;NetworkServer startup can take 50+ seconds if a client holds an open connection to the previous server booted within the same vm&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1966&quot;&gt;DERBY-1966&lt;/a&gt;) I think those are probably unrelated.&lt;br/&gt;
Can you try caling super.tearDown() and see if you get  the authentication failures?&lt;/p&gt;</comment>
                            <comment id="12463886" author="kristwaa" created="Thu, 11 Jan 2007 13:27:39 +0000"  >&lt;p&gt;Committed &apos;derby-2054-1b.diff&apos; with revision 495213, which calls super.tearDown().&lt;br/&gt;
I can&apos;t see any authentication failures when running suites.All (Java 1.5 and Java SE 6) anymore.&lt;br/&gt;
Will close the issue soon if no problems arise in the nightly tests.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12343527">DERBY-1347</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12351772">DERBY-1888</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12344752" name="derby-2054-1a.diff" size="22241" author="kristwaa" created="Fri, 10 Nov 2006 14:03:54 +0000"/>
                            <attachment id="12344753" name="derby-2054-1a.stat" size="1429" author="kristwaa" created="Fri, 10 Nov 2006 14:03:54 +0000"/>
                            <attachment id="12348727" name="derby-2054-1b.diff" size="670" author="kristwaa" created="Thu, 11 Jan 2007 13:21:30 +0000"/>
                            <attachment id="12344591" name="derby-2054-preview.diff" size="15336" author="kristwaa" created="Wed, 8 Nov 2006 15:36:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Nov 2006 15:55:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30257</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0q9r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38074</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>