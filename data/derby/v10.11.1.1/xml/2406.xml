<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:12:59 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2406/DERBY-2406.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2406] XAResource.end does not set the XA transaction state correctly when the XAException is thrown</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2406</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;As the comments in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2360&quot; title=&quot;The XAResource.end(xid, XAResource.TMFAIL) throws an exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2360&quot;&gt;&lt;del&gt;DERBY-2360&lt;/del&gt;&lt;/a&gt; show when calling the XAResource.end the XAException may be thrown even when the transaction was successfully disassociated from the connection but the transaction was marked as rollback only. The code at the end of XAResource.end function does not handle this correctly. It either throws an XAException or sets the connection state to XA_T0_NOT_ASSOCIATED. The corresponding code from NetXAResource.end method is&lt;/p&gt;

&lt;p&gt;        if (rc != XAResource.XA_OK) &lt;/p&gt;
{
            throwXAException(rc, false);
        }
&lt;p&gt;else &lt;/p&gt;
{
        	conn_.setXAState(Connection.XA_T0_NOT_ASSOCIATED);
        }
&lt;p&gt; &lt;/p&gt;</description>
                <environment></environment>
        <key id="12364220">DERBY-2406</key>
            <summary>XAResource.end does not set the XA transaction state correctly when the XAException is thrown</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="julo">Julius Stroffek</assignee>
                                    <reporter username="julo">Julius Stroffek</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Mar 2007 10:47:51 +0000</created>
                <updated>Thu, 8 Mar 2007 13:20:23 +0000</updated>
                            <resolved>Thu, 8 Mar 2007 13:20:23 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12478353" author="julo" created="Tue, 6 Mar 2007 10:50:35 +0000"  >&lt;p&gt;I do not know the impact on derby functionality but the wrong XA connection state is used in the following functions:&lt;/p&gt;

&lt;p&gt;org.apache.derby.client.net.NetConnection.allowLocalCommitRollback_()&lt;br/&gt;
org.apache.derby.client.net.NetXAConnection.readCommit()&lt;br/&gt;
org.apache.derby.client.net.NetConnection.willAutoCommitGenerateFlow()&lt;br/&gt;
org.apache.derby.client.net.NetXAConnection.writeCommit()&lt;br/&gt;
org.apache.derby.client.net.NetXAConnection.writeTransactionStart()&lt;/p&gt;</comment>
                            <comment id="12479263" author="julo" created="Thu, 8 Mar 2007 08:31:55 +0000"  >&lt;p&gt;The implementation in derby is alright. I missed the call to setXaStateForXAException. The patch provided adds only a comment to the place in a code which is mentioned in a description. I added the following comment:&lt;/p&gt;

&lt;p&gt;            // The corresponding XA connection association state&lt;br/&gt;
            // is changed by setXaStateForXAException inside the call&lt;br/&gt;
            // to throwXAException according the error code of the XAException&lt;br/&gt;
            // to be thrown.&lt;/p&gt;

&lt;p&gt;Hopefully, it may help someone in a future not to miss it as I did.&lt;/p&gt;

&lt;p&gt;Feel free to ignore the patch if you find it unnecessary. If nobody applies the patch I&apos;ll close the issue in a few days.&lt;/p&gt;
</comment>
                            <comment id="12479287" author="knutanders" created="Thu, 8 Mar 2007 11:07:58 +0000"  >&lt;p&gt;Thanks Julo! The comment looks useful to me. Committed revision 516009.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12352913" name="d2406.diff" size="816" author="julo" created="Thu, 8 Mar 2007 08:31:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 8 Mar 2007 11:07:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23039</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy1373:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40168</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>