<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:10:30 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6144/DERBY-6144.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6144] nightly regression test failure, intermittent error : testStatisticsCorrectness(org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest)junit.framework.AssertionFailedError </title>
                <link>https://issues.apache.org/jira/browse/DERBY-6144</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;failure in nightly regression test, candidate 10.10 branch, ibm17&lt;/p&gt;

&lt;p&gt;may be related to daylight savings time change, there were similar resolved bugs that were marked fixed,&lt;br/&gt;
so reporting new one in case this is different.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm17/1461391-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/ibm17/1461391-suites.All_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There was 1 failure:&lt;br/&gt;
1) testStatisticsCorrectness(org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest)junit.framework.AssertionFailedError&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest.testStatisticsCorrectness(AutomaticIndexStatisticsTest.java:332)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:88)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:55)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:117)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBareOverridable(BaseJDBCTestCase.java:424)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBare(BaseJDBCTestCase.java:441)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;</description>
                <environment>windows, ibm17</environment>
        <key id="12640418">DERBY-6144</key>
            <summary>nightly regression test failure, intermittent error : testStatisticsCorrectness(org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest)junit.framework.AssertionFailedError </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikem">Mike Matrigali</assignee>
                                    <reporter username="mikem">Mike Matrigali</reporter>
                        <labels>
                            <label>derby_backport_reject_10_7</label>
                    </labels>
                <created>Wed, 3 Apr 2013 02:18:50 +0100</created>
                <updated>Wed, 16 Apr 2014 03:41:17 +0100</updated>
                            <resolved>Fri, 12 Apr 2013 00:21:03 +0100</resolved>
                                    <version>10.10.2.0</version>
                                    <fixVersion>10.8.3.3</fixVersion>
                    <fixVersion>10.9.2.2</fixVersion>
                    <fixVersion>10.10.2.0</fixVersion>
                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13623923" author="mikem" created="Fri, 5 Apr 2013 19:42:33 +0100"  >&lt;p&gt;have not seen this in a previous release, marking it a regression.&lt;/p&gt;</comment>
                            <comment id="13628430" author="mikem" created="Thu, 11 Apr 2013 00:26:33 +0100"  >&lt;p&gt;The following assert failed at line 332:&lt;br/&gt;
assertTrue(s.created.before(now));&lt;/p&gt;

&lt;p&gt;A snippet of the test:&lt;br/&gt;
        // Select to trigger statistics generation.&lt;br/&gt;
        forceRowCountEstimateUpdate(TAB);&lt;br/&gt;
        JDBC.assertDrainResults(&lt;br/&gt;
                prepareStatement(&quot;select * from &quot; + TAB + &quot; where id1 = 10&quot;)&lt;br/&gt;
                .executeQuery());&lt;/p&gt;

&lt;p&gt;        // We expect three stats objects for the single index; one per&lt;br/&gt;
        // leading columns combination (c1, c1-c2, and c1-c2-c3).&lt;br/&gt;
        IdxStats statsObj[] = stats.getStatsTable(TAB, 3);&lt;br/&gt;
        assertEquals(3, statsObj.length);&lt;/p&gt;

&lt;p&gt;        Timestamp now = new Timestamp(new Date().getTime());&lt;br/&gt;
        for (int i=0; i &amp;lt; statsObj.length; i++) {&lt;br/&gt;
            IdxStats s = statsObj&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;;&lt;br/&gt;
            assertEquals(rows, s.rows);&lt;br/&gt;
            assertTrue(s.created.before(now));&lt;br/&gt;
            switch (s.lcols) &lt;/p&gt;
{
                case 1:
                    assertEquals(100, s.card);
                    break;
                case 2:
                    assertEquals(5000, s.card);
                    break;
                case 3:
                    assertEquals(50000, s.card);
                    break;
            default:
                fail(&quot;unexpected number of leading columns: &quot; + s.lcols);
            }
&lt;p&gt;        }&lt;/p&gt;


&lt;p&gt;        Timestamp now = new Timestamp(new Date().getTime());&lt;/p&gt;

&lt;p&gt;It failed sometime friday 4/5 night or 4/6 morning.  I think this means it is not a daylight savings time issue.&lt;/p&gt;

&lt;p&gt;I think what is being tested is that background stat is creating stats and that those stats were created before &quot;now&quot;.  I have&lt;br/&gt;
sometimes seen harware dependent issues with this kind of thing and stuff going so fast that maybe the time they were&lt;br/&gt;
created and now are the same value. &lt;/p&gt;

&lt;p&gt;I am running 100 times to see if I can reproduce but so far no luck, and considering at least changing the test to print the interesting bits on failure,&lt;br/&gt;
and possibly adding a sleep before getting &quot;now&quot; to make sure clock time elapses between stat creation and &quot;now&quot;.&lt;/p&gt;
</comment>
                            <comment id="13628469" author="mikem" created="Thu, 11 Apr 2013 00:59:58 +0100"  >&lt;p&gt;looks like &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6144&quot; title=&quot;nightly regression test failure, intermittent error : testStatisticsCorrectness(org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest)junit.framework.AssertionFailedError &quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6144&quot;&gt;&lt;del&gt;DERBY-6144&lt;/del&gt;&lt;/a&gt; is another part of the test that needs same fix as &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5046&quot; title=&quot;Intermittent assert failure in AutomaticIndexStatisticsTest.testStatisticsCorrectness&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5046&quot;&gt;&lt;del&gt;DERBY-5046&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13628475" author="mikem" created="Thu, 11 Apr 2013 01:09:31 +0100"  >&lt;p&gt;will just change test in all places to allow for same timestamp like in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5046&quot; title=&quot;Intermittent assert failure in AutomaticIndexStatisticsTest.testStatisticsCorrectness&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5046&quot;&gt;&lt;del&gt;DERBY-5046&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13629187" author="mikem" created="Thu, 11 Apr 2013 19:11:23 +0100"  >&lt;p&gt;checked in fix to trunk:&lt;br/&gt;
------------------------------------------------------------------------&lt;br/&gt;
r1467011 | mikem | 2013-04-11 10:58:55 -0700 (Thu, 11 Apr 2013) | 9 lines&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6144&quot; title=&quot;nightly regression test failure, intermittent error : testStatisticsCorrectness(org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest)junit.framework.AssertionFailedError &quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6144&quot;&gt;&lt;del&gt;DERBY-6144&lt;/del&gt;&lt;/a&gt; nightly regression test failure, intermittent error : testStatisticsCorrectness(org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest)junit.framework.A&lt;/p&gt;

&lt;p&gt;test was asserting that stats had to be created after &quot;now&quot;.  I think the&lt;br/&gt;
nightly was getting a case where the time was the same.  &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5046&quot; title=&quot;Intermittent assert failure in AutomaticIndexStatisticsTest.testStatisticsCorrectness&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5046&quot;&gt;&lt;del&gt;DERBY-5046&lt;/del&gt;&lt;/a&gt; fixed&lt;br/&gt;
a different part to the same test to check for greater than now, so implemented&lt;br/&gt;
that same fix at the offending line.  Also added some text to be printed with&lt;br/&gt;
the variable values if it happens again.&lt;/p&gt;</comment>
                            <comment id="13629253" author="mamtas" created="Thu, 11 Apr 2013 20:25:05 +0100"  >&lt;p&gt;Test failed on 10.10(1465320) with ibm 16 (Mike has put in a fix though, so this should not be an issue anymore)&lt;br/&gt;
testStatisticsCorrectness(org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest)junit.framework.AssertionFailedError&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.store.AutomaticIndexStatisticsTest.testStatisticsCorrectness(AutomaticIndexStatisticsTest.java:332)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:117)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBareOverridable(BaseJDBCTestCase.java:442)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBare(BaseJDBCTestCase.java:459)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;</comment>
                            <comment id="13629529" author="mikem" created="Fri, 12 Apr 2013 00:04:58 +0100"  >&lt;p&gt;backported chage #1467011 fix from trunk to 10.10 branch&lt;br/&gt;
s10_10_ibm17:7&amp;gt;svn commit&lt;br/&gt;
Sending        .&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\store\AutomaticIndexStatisticsTest.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 1467128.&lt;/p&gt;</comment>
                            <comment id="13629533" author="mikem" created="Fri, 12 Apr 2013 00:09:02 +0100"  >&lt;p&gt;back ported fix from trunk to 10.9 branch.&lt;br/&gt;
s10_9_ibm17:10&amp;gt;svn commit&lt;br/&gt;
Sending        .&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\store\AutomaticIndexStatisticsTest.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 1467132.&lt;/p&gt;</comment>
                            <comment id="13629550" author="mikem" created="Fri, 12 Apr 2013 00:19:40 +0100"  >&lt;p&gt;backported fix from trunk to 10.8 branch:&lt;/p&gt;

&lt;p&gt;s10_8_ibm16:15&amp;gt;svn commit&lt;br/&gt;
Sending        .&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\store\AutomaticIndexStatisticsTest.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 1467136.&lt;/p&gt;

&lt;p&gt;This test was created for a new feature in 10.8, so this change need not be backported to any version before 10.8, addied the backport reject label.&lt;/p&gt;
</comment>
                            <comment id="13629552" author="mikem" created="Fri, 12 Apr 2013 00:21:03 +0100"  >&lt;p&gt;Marking this fixed.  If it shows up again in nightly&apos;s after this fix, just reopen the bug.  &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12498753">DERBY-5046</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10420"><![CDATA[Regression]]></customfieldvalue>
    <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 11 Apr 2013 19:25:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320881</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzd7r3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>321222</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>