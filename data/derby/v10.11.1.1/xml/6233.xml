<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:17:47 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6233/DERBY-6233.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6233] XMLBindingTest fails on latest JDK 8 EA</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6233</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;java.sql.SQLDataException: Invalid XML Document: External DTD: Failed to read external DTD &apos;personal.dtd&apos;, because &apos;file&apos; access is not allowed.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:79)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:148)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.seeNextException(Util.java:349)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:431)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:353)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2396)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:85)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1438)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(EmbedPreparedStatement.java:1695)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.execute(EmbedPreparedStatement.java:1379)&lt;br/&gt;
	at org.apache.derbyTesting.junit.XML.insertDocWithDTD(XML.java:240)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.XMLBindingTest$XBindTestSetup.setUp(XMLBindingTest.java:301)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:27)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:27)&lt;br/&gt;
Caused by: java.sql.SQLException: Invalid XML Document: External DTD: Failed to read external DTD &apos;personal.dtd&apos;, because &apos;file&apos; access is not allowed.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:42)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:126)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)&lt;br/&gt;
Caused by: java.sql.SQLException: Java exception: &apos;External DTD: Failed to read external DTD &apos;personal.dtd&apos;, because &apos;file&apos; access is not allowed.: org.xml.sax.SAXException&apos;.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:42)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:126)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:71)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:148)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.javaException(Util.java:370)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:436)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:432)&lt;br/&gt;
Caused by: org.xml.sax.SAXException: External DTD: Failed to read external DTD &apos;personal.dtd&apos;, because &apos;file&apos; access is not allowed.&lt;br/&gt;
org.xml.sax.SAXParseException; lineNumber: 20; columnNumber: 119; External DTD: Failed to read external DTD &apos;personal.dtd&apos;, because &apos;file&apos; access is not allowed.&lt;br/&gt;
	at org.apache.derby.iapi.types.SqlXmlUtil$XMLErrorHandler.fatalError(SqlXmlUtil.java:767)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:180)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:441)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:368)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLScanner.reportFatalError(XMLScanner.java:1388)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$DTDDriver.dispatch(XMLDocumentScannerImpl.java:1158)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$DTDDriver.next(XMLDocumentScannerImpl.java:1050)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(XMLDocumentScannerImpl.java:964)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:606)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:116)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:509)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:858)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:787)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:237)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:329)&lt;br/&gt;
	at org.apache.derby.iapi.types.SqlXmlUtil$1.run(SqlXmlUtil.java:320)&lt;br/&gt;
	at org.apache.derby.iapi.types.SqlXmlUtil$1.run(SqlXmlUtil.java:317)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
	at org.apache.derby.iapi.types.SqlXmlUtil.serializeToString(SqlXmlUtil.java:315)&lt;br/&gt;
	at org.apache.derby.iapi.types.XML.XMLParse(XML.java:632)&lt;br/&gt;
	at org.apache.derby.exe.acbfcc1aadx013exeff7x4f4fx000077cfc4780.e0(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.services.reflect.DirectCall.invoke(ReflectGeneratedClass.java:101)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.RowResultSet.getNextRowCore(RowResultSet.java:148)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.NormalizeResultSet.getNextRowCore(NormalizeResultSet.java:185)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.DMLWriteResultSet.getNextRowCore(DMLWriteResultSet.java:128)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.InsertResultSet.open(InsertResultSet.java:520)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(GenericPreparedStatement.java:453)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:334)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1346)&lt;br/&gt;
Caused by: org.xml.sax.SAXParseException; lineNumber: 20; columnNumber: 119; External DTD: Failed to read external DTD &apos;personal.dtd&apos;, because &apos;file&apos; access is not allowed.&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:203)&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:177)&lt;/p&gt;</description>
                <environment>java version &amp;quot;1.8.0-ea&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.8.0-ea-b91)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 25.0-b33, mixed mode)</environment>
        <key id="12649891">DERBY-6233</key>
            <summary>XMLBindingTest fails on latest JDK 8 EA</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 May 2013 13:02:50 +0100</created>
                <updated>Wed, 16 Apr 2014 03:41:03 +0100</updated>
                            <resolved>Fri, 31 May 2013 08:41:20 +0100</resolved>
                                    <version>10.11.1.1</version>
                                    <fixVersion>10.8.3.3</fixVersion>
                    <fixVersion>10.9.2.2</fixVersion>
                    <fixVersion>10.10.2.0</fixVersion>
                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13669180" author="knutanders" created="Wed, 29 May 2013 13:11:49 +0100"  >&lt;p&gt;I think the test fails because of the changes described here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://openjdk.java.net/jeps/185&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://openjdk.java.net/jeps/185&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://blogs.oracle.com/joew/entry/jaxp_1_5_in_jdk8&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://blogs.oracle.com/joew/entry/jaxp_1_5_in_jdk8&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13670191" author="knutanders" created="Thu, 30 May 2013 11:06:02 +0100"  >&lt;p&gt;The test passes on JDK 8 when it&apos;s run with the system property javax.xml.accessExternalDTD=file, which loosens the restrictions added by JEP 185 and allows the XML parser to read the DTD.&lt;/p&gt;

&lt;p&gt;The attached patch derby-6233-01-a.diff decorates the test with a SystemPropertyTestSetup that sets that property. The patch also adds convenience methods in SystemPropertyTestSetup for setting a single property, similar to existing convenience methods in DatabasePropertyTestSetup.&lt;/p&gt;</comment>
                            <comment id="13670284" author="knutanders" created="Thu, 30 May 2013 13:15:45 +0100"  >&lt;p&gt;The 01-a patch treats the issue as a test/configuration problem and doesn&apos;t make any changes to the product code. This means users who come across the problem when upgrading to JDK 8 will have to find a way to work around it themselves, for example by setting the system property used in the test. Let&apos;s call this option 1.&lt;/p&gt;

&lt;p&gt;We could also regard it as a product issue and try to fix it so that users who upgrade to JDK 8 don&apos;t get hit by it. Then we have at least these two options:&lt;/p&gt;

&lt;p&gt;2) Configure SqlXmlUtil&apos;s DocumentBuilderFactory so that external DTDs can be retrieved without setting the system property.&lt;/p&gt;

&lt;p&gt;3) Configure SqlXmlUtil&apos;s DocumentBuilderFactory so that it ignores external DTDs.&lt;/p&gt;

&lt;p&gt;Option 2 would make JDK 8&apos;s change in behaviour completely transparent to the users, and they would not have to change their application. So it&apos;s probably the best option from a compatibility point of view. However, this restriction was added to JDK 8 for a reason, and I don&apos;t think we&apos;d want to bypass this extra security check without the users&apos; explicit consent.&lt;/p&gt;

&lt;p&gt;Option 3 would have been fine if the parser didn&apos;t actually use the DTD. In fact, it doesn&apos;t use it for validating the XML document, because the SQL spec says the XMLPARSE function should do &quot;a non-validating parse&quot; of the input string. However, it does use the DTD for filling in default attribute values in the stored document. And we also have tests that verify that default values are used if attributes are not specified, so such a change may break applications that rely on this functionality.&lt;/p&gt;

&lt;p&gt;Since the alternatives seem to be either disabling a security feature by default, or breaking a different set of applications, I&apos;m leaning towards option 1 with a workaround in the affected test, as implemented by the 01-a patch. I think the main disadvantage with using that workaround in an application, is that it&apos;s a global switch that affects all XML parsers in the JVM, not only the one used by Derby. If this turns out to be a problem for users when they upgrade to JDK 8, we may consider adding functionality that gives users a more targeted workaround. For example, we could add a database property that controls how the parser handles DTDs per database.&lt;/p&gt;</comment>
                            <comment id="13670480" author="rhillegas" created="Thu, 30 May 2013 17:44:55 +0100"  >&lt;p&gt;Thanks for explaining your reasoning, Knut. +1&lt;/p&gt;</comment>
                            <comment id="13671217" author="knutanders" created="Fri, 31 May 2013 08:17:34 +0100"  >&lt;p&gt;Thanks, Rick.&lt;/p&gt;

&lt;p&gt;I&apos;ve committed the patch to trunk with revision 1488116.&lt;/p&gt;

&lt;p&gt;I plan to backport this workaround at least back to 10.9, since that&apos;s how far back JDK 8 is currently used in the automated tests.&lt;/p&gt;</comment>
                            <comment id="13671228" author="knutanders" created="Fri, 31 May 2013 08:41:20 +0100"  >&lt;p&gt;Committed to 10.10 with revision 1488118.&lt;br/&gt;
Committed to 10.9 with revision 1488120.&lt;br/&gt;
Committed to 10.8 with revision 1488121.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12585389" name="derby-6233-01-a.diff" size="4651" author="knutanders" created="Thu, 30 May 2013 11:06:02 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 30 May 2013 16:44:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>330218</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzetaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>330552</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>