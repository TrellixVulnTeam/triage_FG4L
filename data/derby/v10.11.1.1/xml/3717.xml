<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:51 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3717/DERBY-3717.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3717] convert derbynet/getCurrentProperties.java to junit</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3717</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Place holder to contribute the convered test&lt;/p&gt;</description>
                <environment></environment>
        <key id="12397854">DERBY-3717</key>
            <summary>convert derbynet/getCurrentProperties.java to junit</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mkutty">Manjula Kutty</assignee>
                                    <reporter username="mkutty">Manjula Kutty</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Jun 2008 00:52:55 +0100</created>
                <updated>Mon, 5 Jul 2010 17:58:57 +0100</updated>
                            <resolved>Thu, 14 Aug 2008 16:44:04 +0100</resolved>
                                    <version>10.4.2.0</version>
                                    <fixVersion>10.4.2.1</fixVersion>
                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12603956" author="mkutty" created="Tue, 10 Jun 2008 19:14:03 +0100"  >&lt;p&gt;Please review the attached converted test. If looks good please commit&lt;/p&gt;</comment>
                            <comment id="12604042" author="kristwaa" created="Tue, 10 Jun 2008 22:05:28 +0100"  >&lt;p&gt;A few comments on the test:&lt;br/&gt;
 1) Is it safe to assume a specific order for the properties?&lt;br/&gt;
    I&apos;m thinking if different JVM implementations, or versions, might give a different ordering.&lt;br/&gt;
 2) Why not just set the Properties object to null at declaration to avoid the extra nullifying? (see inside the catch-block)&lt;br/&gt;
 3) Add a comment for &quot;Connection conn = getConnection();&quot; in testPropertiesAfterConnection, since it is never used?&lt;br/&gt;
 4) If getting the property object from NetworkServerControl fails, I think there is an alternative way to preserve the stack-trace. I think Dag figured out how.&lt;br/&gt;
 5) &quot;testPropertiesBeforeConnection&quot; never throws Exception.&lt;br/&gt;
 6) A few lines with wrong indentation.&lt;br/&gt;
 7) First line of the class JavaDoc should be moved one line down.&lt;/p&gt;

&lt;p&gt;Except for possibly issue 1, the comments are just nits and should not stop a commit.&lt;br/&gt;
Thank you for the patch &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12604048" author="mkutty" created="Tue, 10 Jun 2008 22:25:09 +0100"  >&lt;p&gt;Thanks for the comments, Kristian. I have not come across the different odering problem , but I will try with other jvms on other platforms and see how the test goes. I will make other changes and will upload a new patch&lt;/p&gt;</comment>
                            <comment id="12604099" author="dagw" created="Wed, 11 Jun 2008 01:54:35 +0100"  >&lt;p&gt;Re item 4): I added a new fail method with lets you chain the exception, see BaseTestCase#fail(String, Exception)&lt;/p&gt;</comment>
                            <comment id="12606515" author="mkutty" created="Thu, 19 Jun 2008 20:07:54 +0100"  >&lt;p&gt;Please review the attached updated patch. If looks good, please commit&lt;/p&gt;</comment>
                            <comment id="12607170" author="kristwaa" created="Mon, 23 Jun 2008 10:46:43 +0100"  >&lt;p&gt;Thanks for the reviewed patch Manjula.&lt;/p&gt;

&lt;p&gt;I tried it out, and got some failures. Maybe they&apos;re expected, but I&apos;ll comment on them anyway.&lt;br/&gt;
 1) The test cannot be run repeatedly with an existing database &lt;b&gt;and&lt;/b&gt; a failure, as the table being created will exist after the first execution.&lt;br/&gt;
    I think this can be easily fixed by changing &quot;Connection conn = getConnection&quot; with &quot;getConnection.setAutoCommit(false)&quot; and remove the table deletion at the end.&lt;/p&gt;

&lt;p&gt; 2) With an existing database, there&apos;s one property missing.&lt;br/&gt;
    It seems &quot;derby.drda.trace.4&quot; isn&apos;t set when the database / trace file exists. Do you know why?&lt;/p&gt;

&lt;p&gt;Also, some other comments:&lt;br/&gt;
 a) Could PrivilegedFileOpsForTests.exists be used instead of duplication of code?&lt;br/&gt;
 b) Do &quot;Properties p = null&quot; to avoid special code (i.e. setting p = null in the catch clause), or just remove the try-catch block.&lt;br/&gt;
 c) Use &quot;fail(String,Exception)&quot; instead of printStackTrace (if try-catch is kept).&lt;br/&gt;
 d) Create a Properties object instead of just a String array with values?&lt;br/&gt;
    As it is now, it&apos;s not possible to see which property a value is for. This is dependent on the order of the properties returned by NetworkServerControl.getCurrentProperties(), or rather the order returned by the enumerator.&lt;br/&gt;
 e) Why isn&apos;t &quot;makeServerPolicyName&quot; static?&lt;br/&gt;
 f) Indentation.&lt;br/&gt;
 g) Wrong file name in the header for the policy file.&lt;/p&gt;


&lt;p&gt;thanks,&lt;/p&gt;</comment>
                            <comment id="12616295" author="mkutty" created="Wed, 23 Jul 2008 23:51:05 +0100"  >&lt;p&gt;Thanks for the comments. I have tried to incorporate most of the comments. But about the tracing property not set after the first run, I posted a seperate mail on this regard and didn&apos;t get any reply. I think it is the same issue as  &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2209&quot; title=&quot;derbynet/getCurrentProperties.java fails intermittently &quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2209&quot;&gt;&lt;del&gt;DERBY-2209&lt;/del&gt;&lt;/a&gt;. If that is the case then, it is bug. Can any one please confirm? &lt;/p&gt;

&lt;p&gt;Also please review and  if looks good please commit&lt;/p&gt;</comment>
                            <comment id="12616388" author="knutanders" created="Thu, 24 Jul 2008 10:02:51 +0100"  >&lt;p&gt;I think some of the previous comments are still unaddressed.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The try/catch/print code should be removed. Instead, the methods should be declared as &quot;throws Exception&quot; so that the JUnit framework picks up and reports the errors correctly.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;We cannot rely on the ordering of the elements in the Properties object.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The indentation still looks strange.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Could makeServerPolicyName() be made static so that decorateWithPolicy()&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;In all the test methods, element 0 of expectedValues is set in the for loop which compares the actual values with the expected values. Why not set element 0 to the correct value when expectedValues is initialized?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Should the test also be added to derbynet._Suite?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12616408" author="knutanders" created="Thu, 24 Jul 2008 10:11:17 +0100"  >&lt;p&gt;Some words fell out of my comment above. The fourth item should say:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Could makeServerPolicyName() be made static so that decorateWithPolicy() doesn&apos;t have to create a dummy test object in order to call the method?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12617091" author="mkutty" created="Fri, 25 Jul 2008 23:59:34 +0100"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The try/catch/print code should be removed. Instead, the methods should be declared as &quot;throws Exception&quot; so that the JUnit framework picks up and reports the errors correctly.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Done in the recent patch&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;We cannot rely on the ordering of the elements in the Properties object.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Changed the code to use Property object&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The indentation still looks strange.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Hope I have the correct indentation now..&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Could makeServerPolicyName() be made static so that decorateWithPolicy()&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Done in the recent patch&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;In all the test methods, element 0 of expectedValues is set in the for loop which compares the actual values with the expected values. Why not set element 0 to the correct value when expectedValues is initialized?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Done&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Should the test also be added to derbynet._Suite?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Yes, Added&lt;/p&gt;

&lt;p&gt;Please review this patch and let me know if it needs any modification.&lt;/p&gt;</comment>
                            <comment id="12620461" author="mkutty" created="Wed, 6 Aug 2008 23:39:34 +0100"  >&lt;p&gt;Please review my latest patch and if looks good , please commit&lt;/p&gt;
</comment>
                            <comment id="12620605" author="kristwaa" created="Thu, 7 Aug 2008 12:44:45 +0100"  >&lt;p&gt;Sorry this is taking so long, but here are some more comments on the latest patch.&lt;/p&gt;

&lt;p&gt; a) Is the full policy file required? It looks like a copy of the general testing policy file.&lt;br/&gt;
 b) The code verifying the properties doesn&apos;t look right. As far as I can see, the properties object from NetworkServerControl is never used. This goes for all three &quot;testXXX&quot; methods.&lt;br/&gt;
 c) Since makeServerPolicyName has been made static, why instantiate GetCurrentPropertiesTest?&lt;br/&gt;
 d) Would it be better to fail the test if an exception is raised in makeServerPolicyName? A fail-method taking an Exception has been added to BaseTestCase.&lt;br/&gt;
 e) Lots of unused imports (and some duplicate imports).&lt;/p&gt;

&lt;p&gt;thanks,&lt;/p&gt;</comment>
                            <comment id="12621628" author="mkutty" created="Mon, 11 Aug 2008 23:05:04 +0100"  >&lt;p&gt;Thanks for your comments Kristen. I know it is taking a long time, sorry for that. Even now I don&apos;t have a clear answer for Questions &quot;a &quot;and &quot;c&quot;. But I tried to incorporate the changes mentioned on &quot;b&quot;,&quot;d&quot; and &quot;e&quot; and have attached a new patch for that. Please review it and let me know if I need to make any more updates&lt;/p&gt;</comment>
                            <comment id="12622089" author="myrna" created="Wed, 13 Aug 2008 05:21:46 +0100"  >&lt;p&gt;I took a look at your patch. My comments:&lt;br/&gt;
1- Looks to me like you took care of Kristian&apos;s latest review&apos;s points b, d, and e.&lt;br/&gt;
2- I think Kristian&apos;s point c can be addressed by doing this at the top of decorateWithPolicy:&lt;br/&gt;
        String serverPolicyName = makeServerPolicyName();&lt;br/&gt;
3- Kristian&apos;s point a is indeed tricky. You probably don&apos;t need as much as you have, certainly not as much as is in derby_tests.policy, but more than what is in the original tests&apos; policy file.&lt;br/&gt;
I&apos;d have let this one go, to speed things up, if it was the only point. As it is, you should &lt;br/&gt;
try to minimize the contents of the policy file to only the minimal.&lt;br/&gt;
4- you didn&apos;t remove the old test from suites.derbynetmats (nor suites.j9derbynetmats, nor from the DerbyNet*.exclude files that list it as a test to be skipped).&lt;br/&gt;
5 - the other issues are nits or things I could&apos;ve corrected myself, but the test doesn&apos;t run clean - it leaves stuff behind somewhere. If I run it a second time without cleaning the directory I get  a failure.  &lt;br/&gt;
The failure I got was this: &lt;br/&gt;
1) testPropertiesAfterConnection(org.apache.derbyTesting.functionTests.tests.der&lt;br/&gt;
bynet.GetCurrentPropertiesTest)junit.framework.ComparisonFailure: expected:&amp;lt;true&lt;br/&gt;
&amp;gt; but was:&amp;lt;null&amp;gt;&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.derbynet.GetCurrentProper&lt;br/&gt;
tiesTest.testPropertiesAfterConnection(GetCurrentPropertiesTest.java:168)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.&lt;br/&gt;
java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces&lt;br/&gt;
sorImpl.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:&lt;br/&gt;
104)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;/p&gt;

&lt;p&gt;Did you run suites.All?&lt;/p&gt;</comment>
                            <comment id="12622344" author="mkutty" created="Wed, 13 Aug 2008 21:30:38 +0100"  >&lt;p&gt;Thanks for your comments Myrna. I used the SingleUseDatabase Decorator and can get rid of the left over db problem. Also I did remove the getcurrentproperties.java from other derbynet files. Please review the latest patch, and if everything looks good, please commit&lt;/p&gt;</comment>
                            <comment id="12622584" author="myrna" created="Thu, 14 Aug 2008 16:44:04 +0100"  >&lt;p&gt;I committed patch DERBY_3717_08_13_diff.txt with revision 685946.&lt;/p&gt;</comment>
                            <comment id="12622608" author="mkutty" created="Thu, 14 Aug 2008 18:12:57 +0100"  >&lt;p&gt;Thanks for the commit Myrna&lt;/p&gt;</comment>
                            <comment id="12718217" author="mikem" created="Wed, 10 Jun 2009 22:53:11 +0100"  >&lt;p&gt;backported fix to 10.4 branch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12402159">DERBY-3835</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12359727">DERBY-2209</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12383762" name="DERBY_3717_06_10_diff.txt" size="17825" author="mkutty" created="Tue, 10 Jun 2008 19:14:03 +0100"/>
                            <attachment id="12383761" name="DERBY_3717_06_10_stat.txt" size="617" author="mkutty" created="Tue, 10 Jun 2008 19:14:03 +0100"/>
                            <attachment id="12386766" name="DERBY_3717_07_22_diff.txt" size="33855" author="mkutty" created="Wed, 23 Jul 2008 23:51:05 +0100"/>
                            <attachment id="12386765" name="DERBY_3717_07_22_stat.txt" size="723" author="mkutty" created="Wed, 23 Jul 2008 23:51:05 +0100"/>
                            <attachment id="12386932" name="DERBY_3717_07_25_diff.txt" size="34035" author="mkutty" created="Fri, 25 Jul 2008 23:59:34 +0100"/>
                            <attachment id="12386931" name="DERBY_3717_07_25_stat.txt" size="809" author="mkutty" created="Fri, 25 Jul 2008 23:59:34 +0100"/>
                            <attachment id="12388001" name="DERBY_3717_08_11_diff.txt" size="34111" author="mkutty" created="Mon, 11 Aug 2008 23:05:04 +0100"/>
                            <attachment id="12388000" name="DERBY_3717_08_11_stat.txt" size="809" author="mkutty" created="Mon, 11 Aug 2008 23:05:04 +0100"/>
                            <attachment id="12388180" name="DERBY_3717_08_13_diff.txt" size="39683" author="mkutty" created="Wed, 13 Aug 2008 21:30:38 +0100"/>
                            <attachment id="12388179" name="DERBY_3717_08_13_stat.txt" size="1361" author="mkutty" created="Wed, 13 Aug 2008 21:30:38 +0100"/>
                            <attachment id="12384309" name="DERBY_3717_diff.txt" size="34622" author="mkutty" created="Thu, 19 Jun 2008 20:07:54 +0100"/>
                            <attachment id="12384308" name="DERBY_3717_stat.txt" size="723" author="mkutty" created="Thu, 19 Jun 2008 20:07:54 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 10 Jun 2008 21:05:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30966</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0pxr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38020</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>