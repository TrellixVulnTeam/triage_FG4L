<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:47:33 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-452/DERBY-452.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-452] Import/export fails for DECIMAL type in J2ME/Foundation</title>
                <link>https://issues.apache.org/jira/browse/DERBY-452</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Derby import/export tool has to be modified to work in J2ME/Foundation.&lt;/p&gt;

&lt;p&gt;I tried running the testcase importExport.java and it fails with following exception:&lt;br/&gt;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
Test importExport starting&lt;br/&gt;
testing non-existing data file&lt;br/&gt;
Data file not found: extinout/Z.dat&lt;br/&gt;
testing null data file&lt;br/&gt;
Data file cannot be null. &lt;br/&gt;
testing empty table&lt;br/&gt;
testing empty table with Delimited format&lt;br/&gt;
testing empty table import Field/Char Delimiters&lt;br/&gt;
PASS: setup complete&lt;br/&gt;
testing import/export with default options&lt;br/&gt;
FAIL: exception thrown:&lt;br/&gt;
ERROR 38000: The exception &apos;SQL Exception: An attempt was made to get a data value of type &apos;java.lang.Object&apos; from a data value of type &apos;DECIMAL&apos;.&apos; was thrown while evaluating an expression.&lt;br/&gt;
ERROR 22005: An attempt was made to get a data value of type &apos;java.lang.Object&apos; from a data value of type &apos;DECIMAL&apos;.&lt;br/&gt;
Test importExport finished&lt;br/&gt;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;The exception is thrown because Derby system procedure for export calls getObject() on a DECIMAL type. This is not supported in J2ME/Foundation. Derby Embedded JSR 169 Functional Spec asks to use alternate JDBC getXXX and setXXX methods (like getString and setString) for DECIMAL type. I think the Derby import/export utility can be modified to call getString and setString for DECIMAL type when using J2ME/Foundation.&lt;/p&gt;




</description>
                <environment>J2ME/CDC/Foundation using IBM&amp;#39;s WCTME 5.7</environment>
        <key id="12312146">DERBY-452</key>
            <summary>Import/export fails for DECIMAL type in J2ME/Foundation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="deepa">Deepa Remesh</assignee>
                                    <reporter username="deepa">Deepa Remesh</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Jul 2005 05:41:28 +0100</created>
                <updated>Thu, 1 Dec 2005 16:05:04 +0000</updated>
                            <resolved>Fri, 30 Sep 2005 03:19:22 +0100</resolved>
                                    <version>10.1.1.0</version>
                    <version>10.2.1.6</version>
                                    <fixVersion>10.1.2.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12315804" author="deepa" created="Thu, 14 Jul 2005 11:27:02 +0100"  >&lt;p&gt;This patch handles export of DECIMAL type in J2ME/Foundation. &lt;/p&gt;

&lt;p&gt;The code snippet which was throwing the exception is below:&lt;br/&gt;
	 //convert resultset data to string array&lt;br/&gt;
	  public String[] getOneRowAtATime(ResultSet rs) throws Exception {&lt;br/&gt;
	    int columnCount = exportResultSetForObject.getColumnCount();&lt;/p&gt;

&lt;p&gt;		ResultSetMetaData rsm=rs.getMetaData();&lt;br/&gt;
	    if (rs.next()){&lt;br/&gt;
	       String[] rowObjects = new String&lt;span class=&quot;error&quot;&gt;&amp;#91;columnCount&amp;#93;&lt;/span&gt;;&lt;br/&gt;
	       for (int colNum = 0; colNum &amp;lt; columnCount; colNum++) {&lt;br/&gt;
		   if (rs.getObject(colNum + 1) != null)&lt;/p&gt;
				{
					rowObjects[colNum]=rs.getString(colNum + 1);
				}
&lt;p&gt;	       }&lt;br/&gt;
	       return rowObjects;&lt;br/&gt;
	    }&lt;/p&gt;

&lt;p&gt;In J2ME/Foundation, this was throwing an exception because getObject on DECIMAL types is not supported.  I removed the call to getObject since it was a redundant check. getString internally checks for null values. The new code is below:&lt;br/&gt;
      	 //convert resultset data to string array&lt;br/&gt;
	  public String[] getOneRowAtATime(ResultSet rs) throws Exception {&lt;br/&gt;
	    int columnCount = exportResultSetForObject.getColumnCount();&lt;/p&gt;

&lt;p&gt;		ResultSetMetaData rsm=rs.getMetaData();&lt;br/&gt;
	    if (rs.next()){&lt;br/&gt;
	       String[] rowObjects = new String&lt;span class=&quot;error&quot;&gt;&amp;#91;columnCount&amp;#93;&lt;/span&gt;;&lt;br/&gt;
	       for (int colNum = 0; colNum &amp;lt; columnCount; colNum++) &lt;/p&gt;
{
		   rowObjects[colNum]=rs.getString(colNum + 1);
	       }
&lt;p&gt;	       return rowObjects;&lt;br/&gt;
	    }    &lt;/p&gt;

&lt;p&gt;The following tests now pass in J2ME/FP.  I have removed the excludes for them:&lt;br/&gt;
tools/importExport.java&lt;br/&gt;
tools/importExportThruIJ.sql&lt;br/&gt;
tools/ieptests.sql&lt;/p&gt;

&lt;p&gt;Ran derbyall with Sun Java 1.4.2 and IBM WCTME 5.7 Foundation Profile. One testcase failed in the latter. The failure is not related to this change. &lt;/p&gt;

&lt;p&gt;Please review this patch and commit it.     &lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Deepa     &lt;/p&gt;</comment>
                            <comment id="12315959" author="djd" created="Sat, 16 Jul 2005 09:12:43 +0100"  >&lt;p&gt;Committed revision 219259.&lt;/p&gt;</comment>
                            <comment id="12320463" author="deepa" created="Tue, 30 Aug 2005 05:14:32 +0100"  >&lt;p&gt;This patch can be applied to 10.1 branch also.&lt;/p&gt;</comment>
                            <comment id="12320746" author="kmarsden" created="Thu, 1 Sep 2005 13:41:22 +0100"  >&lt;p&gt;Committed revision 265639&lt;/p&gt;</comment>
                            <comment id="12320747" author="kmarsden" created="Thu, 1 Sep 2005 13:43:42 +0100"  >&lt;p&gt;Fixed in 10.1 branch with revision 265639.&lt;/p&gt;</comment>
                            <comment id="12330832" author="deepa" created="Fri, 30 Sep 2005 03:19:09 +0100"  >&lt;p&gt;reopening to fix fix version&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12311229" name="derby-452.diff" size="3210" author="deepa" created="Thu, 14 Jul 2005 11:27:02 +0100"/>
                            <attachment id="12311230" name="derby-452.status" size="366" author="deepa" created="Thu, 14 Jul 2005 11:27:02 +0100"/>
                            <attachment id="12311231" name="derbyall_report_j2me.txt" size="210047" author="deepa" created="Thu, 14 Jul 2005 11:27:02 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 16 Jul 2005 08:12:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21962</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy17in:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40868</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>