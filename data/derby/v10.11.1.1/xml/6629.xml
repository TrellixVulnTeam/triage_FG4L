<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:17 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6629/DERBY-6629.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6629] Restrict privileged operation in CreateXMLFile</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6629</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The PlanExporter tool has a public method CreateXMLFile.writeTheXMLFile(). This method opens a FileOutputStream in a privileged block. We should change this so that unprivileged code cannot use the method to write files using derbytools.jar&apos;s privileges.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12722762">DERBY-6629</key>
            <summary>Restrict privileged operation in CreateXMLFile</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                            <label>derby_backport_reject_10_10</label>
                    </labels>
                <created>Fri, 20 Jun 2014 12:43:19 +0100</created>
                <updated>Wed, 15 Oct 2014 03:52:13 +0100</updated>
                            <resolved>Tue, 14 Oct 2014 21:55:14 +0100</resolved>
                                    <version>10.10.2.0</version>
                                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="14040760" author="knutanders" created="Mon, 23 Jun 2014 14:50:33 +0100"  >&lt;p&gt;Attaching &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12651971/12651971_d6629-1a.diff&quot; title=&quot;d6629-1a.diff attached to DERBY-6629&quot;&gt;d6629-1a.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; which fixes the issue by making the createTheXMLFile() take a Writer as argument instead of a file name, so that it doesn&apos;t need a privileged block to create a Writer. Instead, the privileged block is now with the caller of createTheXMLFile(), which is a private method in PlanExporter. This prevents unprivileged code from invoking the privileged operation without going through the PlanExporter&apos;s public interface.&lt;/p&gt;

&lt;p&gt;XplainStatisticsTest actually called this method in order to test certain aspects of the plan exporter. I&apos;ve now changed the test to use PlanExporter&apos;s public interface instead of calling internal methods.&lt;/p&gt;

&lt;p&gt;All the regression tests passed with the patch.&lt;/p&gt;</comment>
                            <comment id="14041553" author="bryanpendleton" created="Tue, 24 Jun 2014 02:02:15 +0100"  >&lt;p&gt;Seems perfectly reasonable to me. I suspect I just called the internal method&lt;br/&gt;
from the test code without really giving it any thought. Going through the&lt;br/&gt;
public interface is far superior.&lt;/p&gt;</comment>
                            <comment id="14041820" author="jira-bot" created="Tue, 24 Jun 2014 08:37:48 +0100"  >&lt;p&gt;Commit 1605021 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1605021&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1605021&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6629&quot; title=&quot;Restrict privileged operation in CreateXMLFile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6629&quot;&gt;&lt;del&gt;DERBY-6629&lt;/del&gt;&lt;/a&gt;: Restrict privileged operation in CreateXMLFile&lt;/p&gt;

&lt;p&gt;Remove the privileged operation in the CreateXMLFile class. Instead, let&lt;br/&gt;
the caller do the privileged operation and pass in a Writer object that&lt;br/&gt;
CreateXMLFile can write the file to.&lt;/p&gt;

&lt;p&gt;Make the tests invoke the plan exporter tool via its main class instead&lt;br/&gt;
of calling the internal API.&lt;/p&gt;</comment>
                            <comment id="14041821" author="knutanders" created="Tue, 24 Jun 2014 08:38:38 +0100"  >&lt;p&gt;Thanks, Bryan. I&apos;ve checked in the patch on trunk. Resolving the issue.&lt;/p&gt;</comment>
                            <comment id="14169537" author="myrna" created="Mon, 13 Oct 2014 17:59:55 +0100"  >&lt;p&gt;reopen for evaluation backport to 10.10.&lt;/p&gt;</comment>
                            <comment id="14169977" author="jira-bot" created="Mon, 13 Oct 2014 22:06:09 +0100"  >&lt;p&gt;Commit 1631551 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/branches/10.10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1631551&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1631551&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6629&quot; title=&quot;Restrict privileged operation in CreateXMLFile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6629&quot;&gt;&lt;del&gt;DERBY-6629&lt;/del&gt;&lt;/a&gt;; Restrict privileged operation in CreateXMLFile&lt;br/&gt;
  backport of revision 1605021 from trunk.&lt;/p&gt;</comment>
                            <comment id="14171227" author="myrna" created="Tue, 14 Oct 2014 18:11:42 +0100"  >&lt;p&gt;The backport had a javadoc build problem:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;javadoc&amp;#93;&lt;/span&gt; (path-to-10.10branch)\java\testing\org\apache\derbyTesting\functionTests\tests\lang\XplainStatisticsTest.java:606: warning - @param argument &quot;args&quot; is not a parameter name.&lt;/p&gt;

&lt;p&gt;Also, all test cases failed with IBM&apos;s j2ME implementation:&lt;br/&gt;
testPlanExporterIllegalFileAccess(org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest)java.lang.NoSuchMethodError: java/sql/DatabaseMetaData.getURL()Ljava/lang/String;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest.disableXplainStyle(XplainStatisticsTest.java:555)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest.testPlanExporterIllegalFileAccess(XplainStatisticsTest.java:855)&lt;br/&gt;
	at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:195)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:119)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBareOverridable(BaseJDBCTestCase.java:442)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.runBare(BaseJDBCTestCase.java:459)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
3) ...etc.&lt;br/&gt;
see: &lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/weme6.2/1631607-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/v10_10/windows/testlog/weme6.2/1631607-suites.All_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(the CaseExpressionTest failure in the same run is due to the backport attempt for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6563&quot; title=&quot;NOT elimination for CASE expressions is broken&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6563&quot;&gt;&lt;del&gt;DERBY-6563&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="14171480" author="myrna" created="Tue, 14 Oct 2014 21:37:53 +0100"  >&lt;p&gt;I&apos;ve decided to back out backport and mark this one backport_reject.&lt;br/&gt;
The new version of the test relies on being able to pass a url around and so call the planexporter tool with that. This implies having a DriverManager connection. However, in the case of j2ME, there is no DriverManager connection, so this would not work.&lt;br/&gt;
I do not think it&apos;s ok to disable the test for this environment.&lt;br/&gt;
I played with trying to use the old version of the test and adjusting it, but the changes get complex so it&apos;s probably not a good thing.&lt;/p&gt;</comment>
                            <comment id="14171504" author="jira-bot" created="Tue, 14 Oct 2014 21:53:16 +0100"  >&lt;p&gt;Commit 1631882 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/branches/10.10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1631882&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1631882&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6629&quot; title=&quot;Restrict privileged operation in CreateXMLFile&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6629&quot;&gt;&lt;del&gt;DERBY-6629&lt;/del&gt;&lt;/a&gt;; Restrict privileged operation in CreateXMLFile&lt;br/&gt;
   revert revision 1631551&lt;/p&gt;</comment>
                            <comment id="14171506" author="myrna" created="Tue, 14 Oct 2014 21:55:14 +0100"  >&lt;p&gt;resolving again, resetting original assignee.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12651971" name="d6629-1a.diff" size="24826" author="knutanders" created="Mon, 23 Jun 2014 14:50:33 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 24 Jun 2014 01:02:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>400949</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzqvgf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>401034</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>