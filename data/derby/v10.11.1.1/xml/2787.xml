<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:53:06 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2787/DERBY-2787.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2787] make entry for clob in connection so that temporary file is removed when a connection is closed or transaction is commited/rolledback</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2787</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description></description>
                <environment></environment>
        <key id="12371226">DERBY-2787</key>
            <summary>make entry for clob in connection so that temporary file is removed when a connection is closed or transaction is commited/rolledback</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anurag">Anurag Shekhar</assignee>
                                    <reporter username="anurag">Anurag Shekhar</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Jun 2007 07:25:42 +0100</created>
                <updated>Thu, 2 May 2013 03:29:05 +0100</updated>
                            <resolved>Wed, 13 Jun 2007 15:06:41 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12502693" author="anurag" created="Fri, 8 Jun 2007 07:31:43 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2729&quot; title=&quot;temporary lob file should be cleaned when the transaction or connection is no longer valid.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2729&quot;&gt;&lt;del&gt;DERBY-2729&lt;/del&gt;&lt;/a&gt; introduces code required to cleanup the blob and clob during commit/rollback or when connection is closed. The only missing link for clob is to add an entry in EmbeddedConnection so that free method is called on EmbedClob.&lt;/p&gt;</comment>
                            <comment id="12502711" author="anurag" created="Fri, 8 Jun 2007 09:01:08 +0100"  >&lt;p&gt;This patch makes a call to connection.addLobMapping to add entry in connection. Once an entry is added EmbeddedConnection takes care of calling free method hence clearing file.&lt;/p&gt;

&lt;p&gt;please see the description of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2729&quot; title=&quot;temporary lob file should be cleaned when the transaction or connection is no longer valid.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2729&quot;&gt;&lt;del&gt;DERBY-2729&lt;/del&gt;&lt;/a&gt; for more info able SQLState changes. This patches follows similar scheme. &lt;/p&gt;

&lt;p&gt;modified files&lt;/p&gt;

&lt;p&gt;java/engine/org/apache/derby/impl/jdbc/EmbedClob.java&lt;/p&gt;

&lt;p&gt;added call to Connection.addLobMapping in constructors.&lt;br/&gt;
moved checking for closed connection before check for valid flag in checkValidity method. This ensures that if the clob is freed because of closed connection proper sql code is set in SQLException.&lt;br/&gt;
    java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/ClobStoredProcedureTest.java&lt;/p&gt;

&lt;p&gt;Modified tests to get new value for locators. As the Clob now add itself to the connection stored procedure will be getting different value for locator. &lt;br/&gt;
      java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/BlobClob4BlobTest.java&lt;/p&gt;

&lt;p&gt;If a clob is accessed after commit or after free SQLException gets a SSQLState of XJ217. Updated testClobAfterCommit to check for it.&lt;/p&gt;</comment>
                            <comment id="12503734" author="anurag" created="Tue, 12 Jun 2007 07:10:20 +0100"  >&lt;p&gt;fixed conflicts. &lt;br/&gt;
I have run jdbcapi/BlobClob4BlobTest after fixing the conflicts.&lt;br/&gt;
I am running all suites will post about the result after its done.&lt;/p&gt;</comment>
                            <comment id="12503806" author="anurag" created="Tue, 12 Jun 2007 10:48:34 +0100"  >&lt;p&gt;suites.All without any problem it can be considered for review/commit&lt;/p&gt;</comment>
                            <comment id="12504247" author="bernt" created="Wed, 13 Jun 2007 15:06:41 +0100"  >&lt;p&gt;Patch reviewed and found ok.&lt;br/&gt;
Committed revision 546881.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12370514">DERBY-2729</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12370414">DERBY-2715</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12359258" name="derby-2787.diff" size="9550" author="anurag" created="Fri, 8 Jun 2007 09:01:07 +0100"/>
                            <attachment id="12359470" name="derby-2787v2.diff" size="8269" author="anurag" created="Tue, 12 Jun 2007 07:10:19 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 13 Jun 2007 14:06:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23246</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy11tz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39947</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>