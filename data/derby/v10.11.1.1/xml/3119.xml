<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:32:43 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3119/DERBY-3119.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3119] Derby does not resolve functions to methods with Integer return type.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3119</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Derby can bind a function invocation to a method which returns int but not to a method which returns Integer. I think that both of these resolutions should succeed given the rules in the SQL Standard, part 13, section 8.6, syntax rule 5, case a, item ii. Here is some code which shows this problem. First a class to declare the methods:&lt;/p&gt;

&lt;p&gt;public class zz&lt;br/&gt;
{&lt;br/&gt;
    public  static  int returnsInt()&lt;/p&gt;
    {
        return 1;
    }

&lt;p&gt;    public  static  Integer returnsInteger()&lt;/p&gt;
    {
        return new Integer( 2 );
    }

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;The following ij script shows that the int-returning method is resolved but not the Integer-returning method:&lt;/p&gt;

&lt;p&gt;ij version 10.4&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:derby10.4;create=true&apos;;&lt;br/&gt;
WARNING 01J01: Database &apos;derby10.4&apos; not created, connection made to existing database instead.&lt;br/&gt;
ij&amp;gt; drop function returnsInt;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; drop function returnsInteger;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; create function returnsInt()&lt;br/&gt;
returns int&lt;br/&gt;
language java&lt;br/&gt;
parameter style java&lt;br/&gt;
no sql&lt;br/&gt;
external name &apos;zz.returnsInt&apos;&lt;br/&gt;
;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; create function returnsInteger()&lt;br/&gt;
returns int&lt;br/&gt;
language java&lt;br/&gt;
parameter style java&lt;br/&gt;
no sql&lt;br/&gt;
external name &apos;zz.returnsInteger&apos;&lt;br/&gt;
;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; values ( returnsInt() );&lt;br/&gt;
1          &lt;br/&gt;
-----------&lt;br/&gt;
1          &lt;/p&gt;

&lt;p&gt;1 row selected&lt;br/&gt;
ij&amp;gt; values ( returnsInteger() );&lt;br/&gt;
ERROR 42X50: No method was found that matched the method call int zz.returnsInteger(), tried all combinations of object and primitive types and any possible type conversion for any  parameters the method call may have. The method might exist but it is not public and/or static, or the parameter types are not method invocation convertible.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12379968">DERBY-3119</key>
            <summary>Derby does not resolve functions to methods with Integer return type.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="james.f.adams">James F. Adams</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Oct 2007 18:14:16 +0100</created>
                <updated>Tue, 13 Jul 2010 20:21:13 +0100</updated>
                            <resolved>Tue, 30 Oct 2007 01:07:09 +0000</resolved>
                                    <version>10.1.1.0</version>
                    <version>10.1.2.1</version>
                    <version>10.1.3.1</version>
                    <version>10.2.1.6</version>
                    <version>10.2.2.0</version>
                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.2.1</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12533651" author="alanbur" created="Wed, 10 Oct 2007 09:26:22 +0100"  >&lt;p&gt;Note that one important consequence of this bug is that functions that return primitive types (int, float, double etc) have no way of returning a database NULL.&lt;/p&gt;</comment>
                            <comment id="12534897" author="kmarsden" created="Mon, 15 Oct 2007 18:02:02 +0100"  >&lt;p&gt;Should this be marked as improvement or is it a bug?&lt;/p&gt;</comment>
                            <comment id="12534940" author="alanbur" created="Mon, 15 Oct 2007 20:07:01 +0100"  >&lt;p&gt;Because of this there is no way for a database function to return a NULL.  That is clearly a bug.&lt;/p&gt;</comment>
                            <comment id="12534941" author="alanbur" created="Mon, 15 Oct 2007 20:09:23 +0100"  >&lt;p&gt;See also &lt;a href=&quot;http://blog.tremend.ro/2006/10/03/about-the-maturity-of-apache-derby/:&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://blog.tremend.ro/2006/10/03/about-the-maturity-of-apache-derby/:&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&quot;It is important to know that Derby has a limited number of built-in functions, so one needs to frequently resort to custom stored functions. The problem with this is that, besides the lack of proper documentation, this support is quite limited. Stored functions can be defined only in Java. That would be mostly fine if it would work well. But for instance, if you want a stored function that returns an INTEGER value, you must specify the return type of the associated Java method as int. This means that basically you cannot return NULL integers from your function!&quot;&lt;/p&gt;</comment>
                            <comment id="12538167" author="james.f.adams" created="Sat, 27 Oct 2007 06:21:32 +0100"  >&lt;p&gt;Attached is a patch proposal that I believe corrects the problem.&lt;/p&gt;

&lt;p&gt;The resolveMethodCall  method of MethodCallNode has been modified to properly validate return types SMALLINT, INTEGER, BIGINT, REAL, and DOUBLE.  These types are object mappable to Integer, Integer, Long, Float, and Double as well as simply mappable to short, int, long, float, and double.&lt;/p&gt;

&lt;p&gt;In addition I added tests to RoutineTest.&lt;/p&gt;

&lt;p&gt;Ran Derbyall and suites.All with no new errors.&lt;/p&gt;</comment>
                            <comment id="12538546" author="rhillegas" created="Mon, 29 Oct 2007 17:45:35 +0000"  >&lt;p&gt;Thanks for the patch, James. It looks good to me. It fixes the problem case and the test you supplied verifies that the patch fixes the general problem. The tests ran cleanly for me as well. Committed at subversion revision 589766.&lt;/p&gt;</comment>
                            <comment id="12544868" author="james.f.adams" created="Thu, 22 Nov 2007 18:40:23 +0000"  >&lt;p&gt;Would it be possible for someone to merge this to the 10.3 branch?&lt;/p&gt;</comment>
                            <comment id="12545302" author="dagw" created="Sun, 25 Nov 2007 22:12:54 +0000"  >&lt;p&gt;10.3 version of this patch. Committed as svn 598069.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12370164" name="DERBY-3119-10_3.diff" size="7252" author="dagw" created="Sun, 25 Nov 2007 22:12:54 +0000"/>
                            <attachment id="12368531" name="derby-3119-1_diff.txt" size="7470" author="james.f.adams" created="Sat, 27 Oct 2007 06:21:32 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Oct 2007 08:26:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23445</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0pgf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37942</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>