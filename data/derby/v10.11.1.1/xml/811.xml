<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:18:00 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-811/DERBY-811.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-811] Creating trace files in derbytclient fails when running with a SecurityManager</title>
                <link>https://issues.apache.org/jira/browse/DERBY-811</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Can be seen by running the test jdbcapi/checkDriver.java in the DerbyNetClient framework.&lt;/p&gt;

&lt;p&gt;Another bug in the code is in ClientBaseDataSource.computePrintWriter  where the file separator is hard coded as &quot;/&quot;.&lt;/p&gt;


&lt;p&gt;java.security.AccessControlException: access denied (java.io.FilePermission C:&amp;#95;work\svn_clean2\trunk\systest\out2\DerbyNetClient\checkDriver\trace.out write)&lt;br/&gt;
        at java.security.AccessControlContext.checkPermission(AccessControlContext.java:292)&lt;br/&gt;
        at java.security.AccessController.checkPermission(AccessController.java:476)&lt;br/&gt;
        at java.lang.SecurityManager.checkPermission(SecurityManager.java:538)&lt;br/&gt;
        at java.lang.SecurityManager.checkWrite(SecurityManager.java:968)&lt;br/&gt;
        at java.io.FileOutputStream.&amp;lt;init&amp;gt;(FileOutputStream.java:191)&lt;br/&gt;
        at java.io.FileOutputStream.&amp;lt;init&amp;gt;(FileOutputStream.java:124)&lt;br/&gt;
        at org.apache.derby.client.am.LogWriter.getPrintWriter(LogWriter.java:1190)&lt;br/&gt;
        at org.apache.derby.jdbc.ClientBaseDataSource.computePrintWriter(ClientBaseDataSource.java:587)&lt;br/&gt;
        at org.apache.derby.jdbc.ClientBaseDataSource.computeDncLogWriter(ClientBaseDataSource.java:528)&lt;br/&gt;
        at org.apache.derby.jdbc.ClientBaseDataSource.computeDncLogWriterForNewConnection(ClientBaseDataSource.java:512)&lt;br/&gt;
        at org.apache.derby.jdbc.ClientDriver.connect(ClientDriver.java:116)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.jdbcapi.checkDriver.testConnect(checkDriver.java:397)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.jdbcapi.checkDriver.testClientAttributes(checkDriver.java:177)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.jdbcapi.checkDriver.main(checkDriver.java:133)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12327616">DERBY-811</key>
            <summary>Creating trace files in derbytclient fails when running with a SecurityManager</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mamtas">Mamta A. Satoor</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Sat, 14 Jan 2006 05:08:26 +0000</created>
                <updated>Fri, 21 Jan 2011 18:13:09 +0000</updated>
                            <resolved>Sun, 6 May 2007 03:05:02 +0100</resolved>
                                    <version>10.1.2.1</version>
                    <version>10.2.1.6</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12471470" author="mamtas" created="Thu, 8 Feb 2007 20:00:24 +0000"  >&lt;p&gt;I am looking into the derby dev list to see how to run an old harness test with java security but what I found so far does not seem to work for me. Following is what I am trying&lt;br/&gt;
java -Djava.security.manager -Djava.security.policy=&lt;a href=&quot;file:/c:/p4clients/maintest3/classes/derby_tests.policy&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/c:/p4clients/maintest3/classes/derby_tests.policy&lt;/a&gt; -DderbyTesting.codeclasses=&lt;a href=&quot;file:/c:/p4clients/maintest3/classes/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/c:/p4clients/maintest3/classes/&lt;/a&gt;. -DderbyTesting.codedir=&lt;a href=&quot;file:/c:/p4clients/maintest3/classes/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/c:/p4clients/maintest3/classes/&lt;/a&gt; -DderbyTesting.codejar=&lt;a href=&quot;file://unused/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file://unused/&lt;/a&gt; org.apache.derbyTesting.functionTests.harness.RunTest jdbcapi/checkDriver.java&lt;/p&gt;

&lt;p&gt;I get following error&lt;br/&gt;
Exception in thread &quot;main&quot; java.security.AccessControlException: access denied (java.io.FilePermission C:\p4clients\maintest3\classes write)&lt;br/&gt;
        at java.security.AccessControlContext.checkPermission(AccessControlContext.java:269)&lt;br/&gt;
        at java.security.AccessController.checkPermission(AccessController.java:401)&lt;br/&gt;
        at java.lang.SecurityManager.checkPermission(SecurityManager.java:524)&lt;br/&gt;
        at java.lang.SecurityManager.checkWrite(SecurityManager.java:954)&lt;br/&gt;
        at java.io.File.mkdir(File.java:1097)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.harness.RunTest.setDirectories(RunTest.java:636)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.harness.RunTest.main(RunTest.java:266)&lt;/p&gt;

&lt;p&gt;Can someone give me a pointer as to how a non-junit test is run with security manager?&lt;/p&gt;</comment>
                            <comment id="12471472" author="mamtas" created="Thu, 8 Feb 2007 20:13:57 +0000"  >&lt;p&gt;I added -Dderby.system.home to my command above and that moved me beuond the write FilePermission. Instead, now I get FilePermission &amp;lt;&amp;lt;ALL FILES&amp;gt;&amp;gt; execute) exception.&lt;/p&gt;

&lt;p&gt;Exact command is as follows&lt;br/&gt;
$ java -Djava.security.manager= -Djava.security.policy=&lt;a href=&quot;file:/c:/p4clients/maintest3/classes/derby_tests.policy&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/c:/p4clients/maintest3/classes/derby_tests.policy&lt;/a&gt; -Dframework=DerbyNetClient -DderbyTesting.codeclasses=&lt;a href=&quot;file:/c:/p4clients/maintest3/classes/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/c:/p4clients/maintest3/classes/&lt;/a&gt;. -DderbyTesting.codedir=&lt;a href=&quot;file:/c:/p4clients/maintest3/classes/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/c:/p4clients/maintest3/classes/&lt;/a&gt; -Dderby.system.home=&lt;a href=&quot;file:/c:/p4clients/maintest3/classes/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:/c:/p4clients/maintest3/classes/&lt;/a&gt; -DderbyTesting.codejar=&lt;a href=&quot;file://unused/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file://unused/&lt;/a&gt; org.apache.derbyTesting.functionTests.harness.RunTest jdbcapi/checkDriver.java&lt;/p&gt;

&lt;p&gt;And the error message returned is as follows&lt;br/&gt;
&amp;#8211; listing properties &amp;#8211;&lt;br/&gt;
derby.user.testuser=testpass&lt;br/&gt;
derby.authentication.provider=BUILTIN&lt;br/&gt;
derby.infolog.append=true&lt;br/&gt;
derby.debug.true=AuthenticationTrace&lt;br/&gt;
derby.database.users.testpropdb=testuser,APP&lt;br/&gt;
derby.user.APP=xxxx&lt;br/&gt;
Process exception: java.security.AccessControlException: access denied (java.io.FilePermission &amp;lt;&amp;lt;ALL FILES&amp;gt;&amp;gt; execute)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;Start: checkDriver jdk1.4.2_07 DerbyNetClient 2007-02-08 12:10:59 ***&lt;br/&gt;
Initialize for framework: DerbyNetClient&lt;br/&gt;
java -Duser.language=en -Duser.country=US -Dderby.system.home=C:\p4clients\maintest3\classes\DerbyNetClient\checkDriver -Djava.security.manager -Djava.security.policy=C:\p4clients\maintest3\classes\derby_tests.policy -DderbyTesting.codedir=C:\p4clients\maintest3\classes -DderbyTesting.serverhost=localhost -DderbyTesting.clienthost=localhost org.apache.derby.drda.NetworkServerControl start&lt;br/&gt;
Exception in thread &quot;main&quot; java.security.AccessControlException: access denied (java.io.FilePermission &amp;lt;&amp;lt;ALL FILES&amp;gt;&amp;gt; execute)&lt;br/&gt;
        at java.security.AccessControlContext.checkPermission(AccessControlContext.java:269)&lt;br/&gt;
        at java.security.AccessController.checkPermission(AccessController.java:401)&lt;br/&gt;
        at java.lang.SecurityManager.checkPermission(SecurityManager.java:524)&lt;br/&gt;
        at java.lang.SecurityManager.checkExec(SecurityManager.java:774)&lt;br/&gt;
        at java.lang.Runtime.exec(Runtime.java:563)&lt;br/&gt;
        at java.lang.Runtime.exec(Runtime.java:491)&lt;br/&gt;
        at java.lang.Runtime.exec(Runtime.java:457)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.harness.NetServer.start(NetServer.java:192)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.harness.RunTest.main(RunTest.java:351)&lt;br/&gt;
$&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12471474" author="fuzzylogic" created="Thu, 8 Feb 2007 20:18:42 +0000"  >&lt;p&gt;The old test harness runs with security manager enabled by default, unless the test specifies not to run with the security manager in its _app.properties.&lt;/p&gt;

&lt;p&gt;checkDriver currently has this in its _app.properties:&lt;/p&gt;

&lt;p&gt;#exclude with SecurityManager &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-811&quot; title=&quot;Creating trace files in derbytclient fails when running with a SecurityManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-811&quot;&gt;&lt;del&gt;DERBY-811&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
noSecurityManager=true&lt;/p&gt;

&lt;p&gt;remove these lines and rebuild to run the test with the security manager in the old harness. &lt;/p&gt;</comment>
                            <comment id="12471503" author="mamtas" created="Thu, 8 Feb 2007 22:19:18 +0000"  >&lt;p&gt;Thanks, Andrew. I was able to run the test with SecurityManager after removing the noSecurityManager=true from checkDriver_app.properties. &lt;/p&gt;

&lt;p&gt;I ran checkDriver test with the Derby jar files under DerbyNetClient framework after the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1275&quot; title=&quot;Provide a way to enable client tracing without changing the application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1275&quot;&gt;&lt;del&gt;DERBY-1275&lt;/del&gt;&lt;/a&gt; was committed and there was no security related exceptions. I have attached the patch DERBY811_RunCheckDriverWithSecurityManager_diff_v01.txt which removes noSecurityManager=true from checkDriver_app.properties. If there are no objections to this change, then I will commit it sometime tomorrow.&lt;/p&gt;

&lt;p&gt;As for the ClientBaseDataSource.computePrintWriter using hard coded &quot;/&quot; rather than File.separator, I will make that change next and post another patch after running some basic tests.&lt;/p&gt;</comment>
                            <comment id="12471715" author="mamtas" created="Fri, 9 Feb 2007 14:55:43 +0000"  >&lt;p&gt;Committed DERBY811_RunCheckDriverWithSecurityManager_diff_v01.txt with following comment (revision number 505317)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-811&quot; title=&quot;Creating trace files in derbytclient fails when running with a SecurityManager&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-811&quot;&gt;&lt;del&gt;DERBY-811&lt;/del&gt;&lt;/a&gt; Enabling SecurityManager for checkDriver test. This test was running into problems when run with Derby jar files in DerbyNetClient framework with SecurityManager. This is because required permissions were not granted to the jar in the policy file. Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1275&quot; title=&quot;Provide a way to enable client tracing without changing the application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1275&quot;&gt;&lt;del&gt;DERBY-1275&lt;/del&gt;&lt;/a&gt; took care of those permissions and hence checkDriver test can now start running with SecurityManager.&lt;/p&gt;</comment>
                            <comment id="12471720" author="djd" created="Fri, 9 Feb 2007 15:14:14 +0000"  >&lt;p&gt;Actually the code changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1275&quot; title=&quot;Provide a way to enable client tracing without changing the application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1275&quot;&gt;&lt;del&gt;DERBY-1275&lt;/del&gt;&lt;/a&gt; really fixed this issue. Before, the opening of the file was not in a privileged block (see the initial stack trace for this issue). Thus just adding the policies would not have fixed this. Just wanted to track this down to see what issue had fixed it.&lt;/p&gt;</comment>
                            <comment id="12471737" author="mamtas" created="Fri, 9 Feb 2007 16:08:50 +0000"  >&lt;p&gt;Agreed. Just the policy file changes wouldn&apos;t have been enough to fix checkDriver test failure.&lt;/p&gt;

&lt;p&gt;I guess what I meant to say is without the accompanying changes to policy file for jars, checkDriver would have still failed when run with jars (even with the code changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1275&quot; title=&quot;Provide a way to enable client tracing without changing the application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1275&quot;&gt;&lt;del&gt;DERBY-1275&lt;/del&gt;&lt;/a&gt;). Just like what happened with the JUnit test added as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1275&quot; title=&quot;Provide a way to enable client tracing without changing the application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1275&quot;&gt;&lt;del&gt;DERBY-1275&lt;/del&gt;&lt;/a&gt; failed when run with jar files (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2302&quot; title=&quot;AccessControlException for &amp;#39;user.dir read&amp;#39; in ClientSideSystemPropertiesTest.testConnection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2302&quot;&gt;&lt;del&gt;DERBY-2302&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12471738" author="mamtas" created="Fri, 9 Feb 2007 16:19:26 +0000"  >&lt;p&gt;Very simple change as part of review package DERBY811_RemoveHardcodedSlashForFileSeparator_diff_v01.txt to remove hard coded &quot;/&quot; and user File.separator instead.&lt;/p&gt;

&lt;p&gt;If no objections to the changes, then I will commit it over next couple days.&lt;/p&gt;</comment>
                            <comment id="12472147" author="mamtas" created="Sun, 11 Feb 2007 22:51:40 +0000"  >&lt;p&gt;Committed DERBY811_RemoveHardcodedSlashForFileSeparator_diff_v01.txt with revision 506160&lt;/p&gt;</comment>
                            <comment id="12493860" author="mikem" created="Sat, 5 May 2007 07:48:18 +0100"  >&lt;p&gt;Is this issue fixed now?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12350773" name="DERBY811_RemoveHardcodedSlashForFileSeparator_diff_v01.txt" size="1315" author="mamtas" created="Fri, 9 Feb 2007 16:19:26 +0000"/>
                            <attachment id="12350706" name="DERBY811_RunCheckDriverWithSecurityManager_diff_v01.txt" size="522" author="mamtas" created="Thu, 8 Feb 2007 22:19:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 8 Feb 2007 20:00:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22163</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0kc7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37113</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>