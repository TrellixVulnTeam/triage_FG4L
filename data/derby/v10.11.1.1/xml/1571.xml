<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:09:44 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1571/DERBY-1571.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1571] NetworkServerControlImpl.consoleExceptionPrintTrace() prints stack trace even when logWriter is null</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1571</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;NetworkServerControlImpl.consoleExceptionPrintTrace() prints the stack&lt;br/&gt;
trace to System.err if logWriter is null. This has occasionally caused&lt;br/&gt;
errors in the regression tests. See&lt;br/&gt;
&lt;a href=&quot;http://www.multinet.no/~solberg/public/Apache/10.2.0.3_Snapshot/jvm1.5/testlog/sparc_zone3/412239-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.multinet.no/~solberg/public/Apache/10.2.0.3_Snapshot/jvm1.5/testlog/sparc_zone3/412239-derbyall_diff.txt&lt;/a&gt;&lt;br/&gt;
for an example.&lt;/p&gt;

&lt;p&gt;The test failure happens when NetworkServerControlImpl.shutdown() has&lt;br/&gt;
sent the shutdown command and starts a loop calling ping() until it&lt;br/&gt;
gets an error. Since it expects ping() to fail, it sets logWriter to&lt;br/&gt;
null to avoid getting error messages printed on the console.&lt;/p&gt;

&lt;p&gt;In most cases, the network server is already stopped before the first&lt;br/&gt;
call to ping(). Then ping() fails when calling setUpSocket(), and no&lt;br/&gt;
message is printed. On the other hand, if the server is stopped while&lt;br/&gt;
ping() is being executed, the error might occur other places. For&lt;br/&gt;
instance, it might fail with a SocketException in&lt;br/&gt;
fillReplyBuffer(). fillReplyBuffer() then calls clientSocketError(),&lt;br/&gt;
which in turn calls consolePropertyMessage() and&lt;br/&gt;
consoleExceptionPrintTrace().  consolePropertyMessage() correctly&lt;br/&gt;
suppresses the error message, but consoleExceptionPrintTrace() prints&lt;br/&gt;
the stack trace.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12346490">DERBY-1571</key>
            <summary>NetworkServerControlImpl.consoleExceptionPrintTrace() prints stack trace even when logWriter is null</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Sat, 22 Jul 2006 21:19:44 +0100</created>
                <updated>Mon, 29 Jun 2009 23:42:58 +0100</updated>
                            <resolved>Wed, 26 Jul 2006 12:11:36 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Network Server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12423022" author="knutanders" created="Mon, 24 Jul 2006 10:59:07 +0100"  >&lt;p&gt;1571.diff changes NetworkServerControlImpl so that it doesn&apos;t print stack traces when logWriter is null. Derbyall runs cleanly (modulo the noise seen in Ole&apos;s testing), and I have not been able to reproduce the failure in testProperties.java with the patch applied.&lt;/p&gt;</comment>
                            <comment id="12423600" author="knutanders" created="Wed, 26 Jul 2006 11:09:43 +0100"  >&lt;p&gt;Uploading a new patch (1571-v2.diff) which replaces the previous patch. Instead of setting logWriter to null in shutdown(), logWriter is now set to an output stream that throws away all output. Since the stream is not null, the stack trace will be written to this stream instead of System.err. This way, all messages (including stack traces) are suppressed while shutdown() is running ping(), but we preserve the old behaviour with printing stack traces to System.err when logWriter is null.&lt;/p&gt;

&lt;p&gt;I have run derbyall and verified that the patch fixes the regression test failure. Please review. Thanks!&lt;/p&gt;

&lt;p&gt;% svn stat&lt;br/&gt;
M      java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java&lt;/p&gt;</comment>
                            <comment id="12423616" author="fernanda" created="Wed, 26 Jul 2006 12:04:58 +0100"  >&lt;p&gt;The patch 1571-v2.diff looks good. The test derbynet/ShutDownDBWhenNSShutsDownTest.junit was failing intermittently with SocketException in Solaris sparc (zones), I have verified that this patch fixes the problem.&lt;/p&gt;</comment>
                            <comment id="12423618" author="knutanders" created="Wed, 26 Jul 2006 12:11:35 +0100"  >&lt;p&gt;Thanks for looking at the patch, Fernanda! Committed revision 425703.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12337541" name="1571-v2.diff" size="1218" author="knutanders" created="Wed, 26 Jul 2006 11:09:43 +0100"/>
                            <attachment id="12337391" name="1571.diff" size="472" author="knutanders" created="Mon, 24 Jul 2006 10:59:07 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 26 Jul 2006 11:04:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22570</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0w67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39030</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>