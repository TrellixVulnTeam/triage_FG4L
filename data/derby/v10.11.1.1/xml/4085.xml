<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4085/DERBY-4085.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4085] Improve testing of the in-memory back end</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4085</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The in-memory back end should be tested as part of the standard regression tests.&lt;/p&gt;

&lt;p&gt;The following is a good start:&lt;br/&gt;
 o simple create / boot test&lt;br/&gt;
 o create in-memory db, backup, restore with default storage engine, modify, restore with createFrom into memory again&lt;br/&gt;
 o add the functional test(s) written by Cheng&lt;br/&gt;
 o more unit tests&lt;/p&gt;

&lt;p&gt;On a longer term, we should consider to add the possibility to run all or a subset of the general regression tests with the in-memory back end.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12416451">DERBY-4085</key>
            <summary>Improve testing of the in-memory back end</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12325015">DERBY-646</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="kristwaa">Kristian Waagan</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Mar 2009 16:03:18 +0000</created>
                <updated>Tue, 16 Jun 2009 11:23:25 +0100</updated>
                            <resolved>Tue, 16 Jun 2009 11:23:25 +0100</resolved>
                                    <version>10.5.1.1</version>
                                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12680859" author="kristwaa" created="Wed, 11 Mar 2009 12:22:50 +0000"  >&lt;p&gt;Patch 1a adds a very simple boot test and the backup / modify / restore test. The tests haven&apos;t been added to suites.All or the ant targets yet.&lt;br/&gt;
Patch ready for review.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure if we should continue to connect to the databases manually, or if it should be possible to add a decorator or set an option to use a specific subSubProtocol.&lt;/p&gt;</comment>
                            <comment id="12681681" author="kristwaa" created="Fri, 13 Mar 2009 11:34:56 +0000"  >&lt;p&gt;Committed patch 1b to trunk with revision 753210.&lt;br/&gt;
The difference from revision a is the changed subSubProtocol.&lt;/p&gt;

&lt;p&gt;Note that the tests must be run manually for the time being.&lt;/p&gt;</comment>
                            <comment id="12681714" author="knutanders" created="Fri, 13 Mar 2009 13:43:07 +0000"  >&lt;p&gt;I see this build-failure in my environment:&lt;/p&gt;

&lt;p&gt;memorytests:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 6 source files to /code/derby/trunk0/classes&lt;/p&gt;

&lt;p&gt;compile:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 2 source files to /code/derby/trunk0/classes&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; /code/derby/trunk0/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/BasicInMemoryDbTest.java:28: cannot find symbol&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; symbol  : class DriverManager&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; location: package java.sql&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; import java.sql.DriverManager;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;                ^&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; /code/derby/trunk0/java/testing/org/apache/derbyTesting/functionTests/tests/memorydb/BasicInMemoryDbTest.java:61: cannot find symbol&lt;/p&gt;</comment>
                            <comment id="12681726" author="knutanders" created="Fri, 13 Mar 2009 14:20:01 +0000"  >&lt;p&gt;Here&apos;s a patch that fixes the build break. Since BasicInMemoryDbTest uses DriverManager, it must be compiled against java14compile.classpath. The problem is only seen if jsr169compile.classpath points to JSR-169 + Foundation libraries.&lt;/p&gt;

&lt;p&gt;Committed revision 753279.&lt;/p&gt;

&lt;p&gt;When this test is enabled as part of a suite, we should make sure it&apos;s not run on Java ME. Or we should change the test so that it doesn&apos;t need DriverManager, in which case it should run on Java ME too, and the change that I just committed should be reverted.&lt;/p&gt;</comment>
                            <comment id="12688303" author="kristwaa" created="Mon, 23 Mar 2009 15:23:44 +0000"  >&lt;p&gt;Patch 2a adds the functional test contributed by Cheng Che Chen. I&apos;ve made some changes to integrate the test into Derby&apos;s test framework.&lt;br/&gt;
I see rather large variations in the time it takes to run the test (everything from less then a second to more then one minute), could it be due to the use of random?&lt;/p&gt;

&lt;p&gt;Change _Suite to return an empty Suite if JSR 169 / JavaME is being used.&lt;/p&gt;

&lt;p&gt;Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="12689944" author="kristwaa" created="Fri, 27 Mar 2009 15:47:55 +0000"  >&lt;p&gt;Committed patch 2a to trunk with revision 759181.&lt;br/&gt;
I will also enable the tests as part of suites.All to get exposure on more platforms.&lt;/p&gt;</comment>
                            <comment id="12689957" author="kristwaa" created="Fri, 27 Mar 2009 16:37:07 +0000"  >&lt;p&gt;Patch 3a enables the in-memory back end tests in suites.All.&lt;br/&gt;
This will give us more confidence that the in-memory back end works on more platforms.&lt;/p&gt;

&lt;p&gt;Committed to trunk with revision 759211.&lt;/p&gt;</comment>
                            <comment id="12693496" author="kristwaa" created="Sat, 28 Mar 2009 21:41:53 +0000"  >&lt;p&gt;The MOG test failed on a SPARC machine (daily testing). I&apos;ll check if it happens again, and investigate.&lt;/p&gt;</comment>
                            <comment id="12694038" author="kristwaa" created="Tue, 31 Mar 2009 10:42:46 +0100"  >&lt;p&gt;Committed patch 4a to trunk with revision 760380.&lt;/p&gt;

&lt;p&gt;The test has failed more than once in the daily tests. I added the improved error reporting to see if the error tolerance level is too low, or if there is something else wrong with the test.&lt;/p&gt;</comment>
                            <comment id="12694375" author="chatom" created="Wed, 1 Apr 2009 05:20:55 +0100"  >&lt;p&gt;The test program uses the current time to initialize its random number generator, so every run is different.  In the case of a failure, you&apos;d have to note the random seed that it printed out at the beginning of the run, and then modify one line of the program to reuse that seed instead of using the current time, in order to repeat the run.&lt;/p&gt;</comment>
                            <comment id="12694913" author="kristwaa" created="Thu, 2 Apr 2009 09:37:49 +0100"  >&lt;p&gt;Thank you, Cheng.&lt;/p&gt;

&lt;p&gt;Patch 5a makes the test report the seed when it fails in an assert. This allows us to repeat the run, as described by Cheng.&lt;br/&gt;
Committed patch to trunk with revision 761204.&lt;/p&gt;</comment>
                            <comment id="12698806" author="kristwaa" created="Tue, 14 Apr 2009 16:29:09 +0100"  >&lt;p&gt;The test continues to fail for certain seeds.&lt;br/&gt;
In the case I have been looking at, the Java computation ends up with 6 buckets (0 - 5), whereas the SQL computation ends up with 5 buckets (0-3, 5).&lt;br/&gt;
This is in the second round of computation, the first round works fine.&lt;/p&gt;</comment>
                            <comment id="12701363" author="kmarsden" created="Wed, 22 Apr 2009 04:21:51 +0100"  >&lt;p&gt;I saw the following failure with IBM 1.4.2 on trunk, Linux. Should I just post it here or open a separate issue?&lt;/p&gt;

&lt;p&gt;1) testClusMogInMemory(org.apache.derbyTesting.functionTests.tests.memorydb.MogTest)junit.framework.AssertionFailedError: Error too big;6.911593155944432E-4 &amp;gt;= 1.0E-6, seed=1240288888777&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.memorydb.MogTest.compare(MogTest.java:159)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.memorydb.MogTest.doTestClusMog(MogTest.java:143)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.memorydb.MogTest.testClusMogInMemory(MogTest.java:72)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java(Compiled Code))&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java(Compiled Code))&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java(Compiled Code))&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java(Compiled Code))&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;



</comment>
                            <comment id="12701417" author="kristwaa" created="Wed, 22 Apr 2009 08:27:56 +0100"  >&lt;p&gt;I&apos;m not sure what to do about this test - it fails in two different ways;&lt;br/&gt;
 a) Inconsistent number of buckets computed (by Java computation and SQL computation).&lt;br/&gt;
 b) Error too big.&lt;/p&gt;

&lt;p&gt;I don&apos;t know the test well enough to say if it is correct to increase the error threshold.&lt;br/&gt;
The error regarding the buckets seems more like a real problem to me.&lt;/p&gt;

&lt;p&gt;Shall we disable the test?&lt;br/&gt;
We can also hope that Cheng, who wrote the original test, will have some free cycles to help us out.&lt;/p&gt;</comment>
                            <comment id="12701583" author="kristwaa" created="Wed, 22 Apr 2009 16:58:52 +0100"  >&lt;p&gt;An example where the test fails with both the in-memory and the on-disk back end (with different seeds though):&lt;br/&gt;
1) testClusMogInMemory(org.apache.derbyTesting.functionTests.tests.memorydb.MogTest)junit.framework.AssertionFailedError: MOG configurations differ, seed=1240342031920 expected:&amp;lt;4&amp;gt; but was:&amp;lt;3&amp;gt;&lt;br/&gt;
2) testClusMogOnDisk(org.apache.derbyTesting.functionTests.tests.memorydb.MogTest)junit.framework.AssertionFailedError: MOG configurations differ, seed=1240342037948 expected:&amp;lt;4&amp;gt; but was:&amp;lt;3&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12704758" author="kmarsden" created="Thu, 30 Apr 2009 20:33:16 +0100"  >&lt;p&gt;Kristian asked:&lt;br/&gt;
&amp;gt;Shall we disable the test? &lt;/p&gt;

&lt;p&gt;Does the test have any value if we always use a seed that we know works?  If so we might be able to temporarily stabilize the test, but keep it in the suite.&lt;/p&gt;

</comment>
                            <comment id="12705488" author="kristwaa" created="Mon, 4 May 2009 06:29:08 +0100"  >&lt;p&gt;That&apos;s a good idea, Kathey!&lt;/p&gt;

&lt;p&gt;Patch &apos;derby-4085-6a-fixed_seed.diff&apos; fixes the seed in an attempt to stabilize the test.&lt;br/&gt;
Committed to trunk with revision 771180.&lt;br/&gt;
I&apos;ll await results from the daily testing, since all I know is that the test passes with the seed when run on my own system. If it fails again, a different seed must be used.&lt;br/&gt;
If the daily test passes on all platforms, I&apos;ll backport the change to the 10.5 branch.&lt;/p&gt;

&lt;p&gt;I have also created &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4209&quot; title=&quot;Stabilize and investigate failures in MogTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4209&quot;&gt;DERBY-4209&lt;/a&gt; to track the stabilization work.&lt;/p&gt;</comment>
                            <comment id="12720041" author="kristwaa" created="Tue, 16 Jun 2009 11:23:25 +0100"  >&lt;p&gt;Closing this issue, as the initially planned work has been completed.&lt;br/&gt;
Testing can always be improved, and this work should continue outside of this Jira. Note especially the issue logged to stabilize the MogTest.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12424497">DERBY-4209</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12402147" name="buildbreak.diff" size="671" author="knutanders" created="Fri, 13 Mar 2009 14:20:01 +0000"/>
                            <attachment id="12401928" name="derby-4085-1a-basic_tests.diff" size="16253" author="kristwaa" created="Wed, 11 Mar 2009 12:22:50 +0000"/>
                            <attachment id="12401929" name="derby-4085-1a-basic_tests.stat" size="369" author="kristwaa" created="Wed, 11 Mar 2009 12:22:50 +0000"/>
                            <attachment id="12402135" name="derby-4085-1b-basic_tests.diff" size="16238" author="kristwaa" created="Fri, 13 Mar 2009 11:34:56 +0000"/>
                            <attachment id="12403439" name="derby-4085-2a-mog_func_test.diff" size="40149" author="kristwaa" created="Mon, 23 Mar 2009 15:23:44 +0000"/>
                            <attachment id="12403440" name="derby-4085-2a-mog_func_test.stat" size="517" author="kristwaa" created="Mon, 23 Mar 2009 15:23:44 +0000"/>
                            <attachment id="12403818" name="derby-4085-3a-enable_in_suitesAll.diff" size="913" author="kristwaa" created="Fri, 27 Mar 2009 16:37:07 +0000"/>
                            <attachment id="12404218" name="derby-4085-4a-improved_assertion_reporting.diff" size="712" author="kristwaa" created="Tue, 31 Mar 2009 10:42:46 +0100"/>
                            <attachment id="12404424" name="derby-4085-5a-report_seed_on_failure.diff" size="2807" author="kristwaa" created="Thu, 2 Apr 2009 09:37:49 +0100"/>
                            <attachment id="12407130" name="derby-4085-6a-fixed_seed.diff" size="838" author="kristwaa" created="Mon, 4 May 2009 06:29:08 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 13 Mar 2009 13:43:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31124</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0wwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39148</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>