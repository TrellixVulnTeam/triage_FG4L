<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:22:44 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3871/DERBY-3871.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3871] EmbedBlob.setBytes returns incorrect insertion count</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3871</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;EmbedBlob.setBytes returns invalid insertion counts. According to the JavaDoc, it should return the number of bytes inserted. The current implementation seems to return the position in the Blob after the bytes have been written.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12404020">DERBY-3871</key>
            <summary>EmbedBlob.setBytes returns incorrect insertion count</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="kristwaa">Kristian Waagan</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Sep 2008 21:12:03 +0100</created>
                <updated>Mon, 4 May 2009 19:21:53 +0100</updated>
                            <resolved>Fri, 3 Oct 2008 14:18:35 +0100</resolved>
                                    <version>10.5.1.1</version>
                                    <fixVersion>10.4.2.1</fixVersion>
                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12629591" author="kristwaa" created="Tue, 9 Sep 2008 21:13:04 +0100"  >&lt;p&gt;&apos;BlobSetBytesTestRepro.diff&apos; demonstrates the bug by adding tests to jdbc4/BlobTest.&lt;/p&gt;</comment>
                            <comment id="12636577" author="kristwaa" created="Fri, 3 Oct 2008 10:01:41 +0100"  >&lt;p&gt;Patch 1a contains a fix and the tests (from the previously attached repro/test).&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;EmbedBlob&lt;br/&gt;
  JavaDoc fixes for setBytes methods.&lt;br/&gt;
  Fixed problem by ignoring return value from control.write().&lt;br/&gt;
  The write operation always writes the requested number of bytes, if not it fails (IndexOutOfBoundsException).&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;LOBStreamControl&lt;br/&gt;
  JavaDoc fixes for write(byte[], int, int, long)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;jdbc4/BlobTest&lt;br/&gt;
  Added three tests.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Running full regression tests.&lt;br/&gt;
Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="12636603" author="kristwaa" created="Fri, 3 Oct 2008 11:49:41 +0100"  >&lt;p&gt;suites.All and derbyall passed with JDK 1.6 on Solaris 10 (x86).&lt;/p&gt;</comment>
                            <comment id="12636627" author="knutanders" created="Fri, 3 Oct 2008 14:12:56 +0100"  >&lt;p&gt;The patch looks correct to me. Some minor comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&quot;@since 1.4&quot; in the javadoc refers to the version of the Java specification, I guess. When used in Derby code, shouldn&apos;t it rather say the Derby version that first supported it?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;When I read BlobTest.transferAlphabetData() I had to stop and think for a little while before I was convinced that the loop was correct, since InputStream.read() doesn&apos;t guarantee that the read buffer is filled before it returns. Perhaps a comment saying &quot;LoopingAlphabetStream always reads until the supplied buffer is full or end-of-stream is reached&quot; could be added?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12636629" author="kristwaa" created="Fri, 3 Oct 2008 14:18:35 +0100"  >&lt;p&gt;Committed patch 1a to trunk with revision 701372.&lt;br/&gt;
Merge to 10.4 is clean, I plan to backport the fix later unless someone objects.&lt;/p&gt;</comment>
                            <comment id="12636638" author="kristwaa" created="Fri, 3 Oct 2008 14:57:37 +0100"  >&lt;p&gt;Sorry Knut Anders, I committed just before I saw your comment...&lt;/p&gt;

&lt;p&gt;Regarding the @since tags, I asked the community to comment on the issue. I will correct the tags later.&lt;/p&gt;

&lt;p&gt;Actually, the loop is incorrect &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; It will write too much data, unless the data length is a multiple of the buffer size. It also requires the stream to be well behaved (always returning the requested number of bytes).&lt;br/&gt;
I&apos;ve fixed the problem in patch 2a.&lt;/p&gt;

&lt;p&gt;Thanks for the review!&lt;/p&gt;</comment>
                            <comment id="12636713" author="knutanders" created="Fri, 3 Oct 2008 20:09:18 +0100"  >&lt;p&gt;Thanks for the new patch, Kristian. That explains why I needed some time to convince myself. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Looks correct now.&lt;/p&gt;</comment>
                            <comment id="12637038" author="kristwaa" created="Mon, 6 Oct 2008 09:01:31 +0100"  >&lt;p&gt;Committed patch 2a to trunk with revision 701979.&lt;/p&gt;</comment>
                            <comment id="12644290" author="kristwaa" created="Fri, 31 Oct 2008 13:47:57 +0000"  >&lt;p&gt;Backported patches 1a and 2a to 10.4 with revision 709408.&lt;br/&gt;
Awaiting results of test runs before closing (my runs of derbyall and suites.All ran without failures).&lt;/p&gt;</comment>
                            <comment id="12644680" author="kristwaa" created="Mon, 3 Nov 2008 10:32:52 +0000"  >&lt;p&gt;Tinderbox and daily tests showed no failures. Closing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12389771" name="BlobSetBytesTestRepro.diff" size="4458" author="kristwaa" created="Tue, 9 Sep 2008 21:13:00 +0100"/>
                            <attachment id="12391407" name="derby-3871-1a_insertion_count.diff" size="9865" author="kristwaa" created="Fri, 3 Oct 2008 10:01:40 +0100"/>
                            <attachment id="12391417" name="derby-3871-2a-loop_fix.diff" size="841" author="kristwaa" created="Fri, 3 Oct 2008 14:57:37 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 3 Oct 2008 13:12:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23890</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0y3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39343</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>