<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:10 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-949/DERBY-949.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-949] Clean up tests to use common method to get connections</title>
                <link>https://issues.apache.org/jira/browse/DERBY-949</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Currently some tests have code to check the environment and get connection using DriverManager/DataSource. This logic has been moved to TestUtil.getConnection method. Cleanup tests to use this method. List of tests:&lt;/p&gt;

&lt;p&gt;store/TestDurabilityProperty.java&lt;br/&gt;
store/backupRestore1.java&lt;br/&gt;
store/OnlineBackup tests&lt;br/&gt;
lang/logStream.java&lt;br/&gt;
lang/closed.java&lt;/p&gt;

&lt;p&gt;Also, add comment to ij.startJBMS method mentioning TestUtil.getConnection method. See &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-907#action_12365954&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/DERBY-907#action_12365954&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12328838">DERBY-949</key>
            <summary>Clean up tests to use common method to get connections</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="myrna">Myrna van Lunteren</assignee>
                                    <reporter username="deepa">Deepa Remesh</reporter>
                        <labels>
                    </labels>
                <created>Sat, 11 Feb 2006 07:28:01 +0000</created>
                <updated>Wed, 1 Jul 2009 00:55:06 +0100</updated>
                            <resolved>Thu, 16 Mar 2006 07:33:47 +0000</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12370107" author="myrna" created="Mon, 13 Mar 2006 05:57:37 +0000"  >&lt;p&gt;Adding a patch to this issue.&lt;br/&gt;
The patch contains the following changes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;replacing if (jsr 169) blocks in the tests closed, OnlineBackup*, logStream, BackupRecovery and TestDurability.&lt;/li&gt;
	&lt;li&gt;fixes TestUtil.getConnection so you can get a connection to datasource or drivermanager even if there are no&lt;br/&gt;
   specific connection attributes to be used.&lt;/li&gt;
	&lt;li&gt;modified the testing/README.htm to have 3 suggestions for writing tests to ensure new test will work in various configuration that&lt;br/&gt;
   I currently care about (remote server testing, j2ME testing):    &lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
	&lt;li&gt;ensure the test cleans up any testobjects created. This is important for running the tests in suites with a remote server, or with useprocess=false, because in those cases, tests run against databases in the same directory.  Even if you do not anticipate your test to run in those configurations, it makes good practice. You may also want to protect your test from other tests leaving things behind by removing them before running also. The class org.apache.derbyTesting.functionTests.util.TestUtil has a cleanUpTest method that may be useful.&lt;/li&gt;
	&lt;li&gt;ensure that connections can be made with all supported jvms. This includes the j2ME/CDC/JSR169 configuration, which only has java.sql.Datasource available, no java.sql.DriverManager. One can use the method ij.startJBMS() to get an appropriate connection, or TestUtil.getConnection() if one needs to specify connection properties different from what is defined in the &amp;lt;test&amp;gt;_app.properties file. For instance, to shutdown a database one can use:&lt;br/&gt;
                            TestUtil(&quot;wombat&quot;,&quot;shutdown=true&quot;);&lt;/li&gt;
	&lt;li&gt;ensure the test does not have hard coded &apos;localhost&apos; for network connections. Instead, use the method TestUtil.getHostName() to find if a hostName was specified for remote server testing.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12370108" author="myrna" created="Mon, 13 Mar 2006 06:04:09 +0000"  >&lt;p&gt;The patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-949&quot; title=&quot;Clean up tests to use common method to get connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-949&quot;&gt;&lt;del&gt;DERBY-949&lt;/del&gt;&lt;/a&gt;_2006_03_11.* fixes this issue.&lt;br/&gt;
I ran derbyall with j2ME (wctme5.7_foundation) and jdk142 and encountered no new failures. (jdk142 - wisconsin, j9 - grantRevoke, bootLock).&lt;/p&gt;

&lt;p&gt;Note that with this patch I did modify TestUtil.getConnection() so it worked in all cases tested. I think this would be good place to have a generic getConnection method, but currently, it does not provide a connection to networkserver. I will work on that in a next patch - the tests listed in this bug do not currently run with networkserver and I tried to keep the changes specific to this issue.&lt;/p&gt;



</comment>
                            <comment id="12370109" author="myrna" created="Mon, 13 Mar 2006 06:06:59 +0000"  >&lt;p&gt;Note that also, I did not change ij.startJBMS() with comments, as was suggested with &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-907&quot; title=&quot;regression test failure in RecoveryAfterBackup on wssd5.6 ibm jvm (j2me)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-907&quot;&gt;&lt;del&gt;DERBY-907&lt;/del&gt;&lt;/a&gt;. I felt the tools source code should not have comments pertaining to the testing code. &lt;/p&gt;</comment>
                            <comment id="12370239" author="myrna" created="Tue, 14 Mar 2006 05:17:57 +0000"  >&lt;p&gt;new patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-949&quot; title=&quot;Clean up tests to use common method to get connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-949&quot;&gt;&lt;del&gt;DERBY-949&lt;/del&gt;&lt;/a&gt;_2006_03_13.diff) because previous oneresulted in a conflict when syncing up to a newer revision.&lt;br/&gt;
.stat is unchanged.&lt;/p&gt;</comment>
                            <comment id="12370575" author="myrna" created="Thu, 16 Mar 2006 03:54:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-949&quot; title=&quot;Clean up tests to use common method to get connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-949&quot;&gt;&lt;del&gt;DERBY-949&lt;/del&gt;&lt;/a&gt;_2006_03_15.diff - updated to newer revision. The TestUtil is now exactly as with patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1037&quot; title=&quot;new test lang/ShutdownDatabase.java fails with j2ME&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1037&quot;&gt;&lt;del&gt;DERBY-1037&lt;/del&gt;&lt;/a&gt; (i.e. handles network server connections too).&lt;/p&gt;</comment>
                            <comment id="12370604" author="fuzzylogic" created="Thu, 16 Mar 2006 07:33:31 +0000"  >&lt;p&gt;Committed revision 386216.&lt;/p&gt;</comment>
                            <comment id="12371037" author="myrna" created="Mon, 20 Mar 2006 14:00:41 +0000"  >&lt;p&gt;Refreshed patch (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-993&quot; title=&quot;junitTests cannot be run with J2ME&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-993&quot;&gt;&lt;del&gt;DERBY-993&lt;/del&gt;&lt;/a&gt;_2006_03_19.* ) after implementing patch v2 for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1058&quot; title=&quot;derby fails supporting holdable scrollable resultset: ERROR XSCB8: The btree conglomerate 1,141,037,436,752 is closed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1058&quot;&gt;&lt;del&gt;DERBY-1058&lt;/del&gt;&lt;/a&gt; the failure for HoldabilityTest.java (junit) &lt;br/&gt;
went away for embedded, but I noticed with networkserver &amp;amp; db2jcc that I had used a different user and password&lt;br/&gt;
than what was being done in RunTest.java...Resulting in a &apos;schema does not exist&apos; error in this test. &lt;br/&gt;
So I corrected TestUtil.getConnection() for that framework.&lt;br/&gt;
Note, that test still failed for me with DerbyNet, I reported that in a comment to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1058&quot; title=&quot;derby fails supporting holdable scrollable resultset: ERROR XSCB8: The btree conglomerate 1,141,037,436,752 is closed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1058&quot;&gt;&lt;del&gt;DERBY-1058&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I double checked all the references to TestUtil.getConnection, and only ShutdownDatabase ran with DerbyNet before, and shutdown&lt;br/&gt;
was not needing a schema, which is why no other tests failed.&lt;/p&gt;</comment>
                            <comment id="12371113" author="myrna" created="Tue, 21 Mar 2006 01:37:51 +0000"  >&lt;p&gt;oops, uploaded this &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-993&quot; title=&quot;junitTests cannot be run with J2ME&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-993&quot;&gt;&lt;del&gt;DERBY-993&lt;/del&gt;&lt;/a&gt; patch to the wrong bug. but it&apos;s been superceded already.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12329370">DERBY-1037</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12329019">DERBY-993</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12324079" name="DERBY-949_2006_03_11.diff" size="54955" author="myrna" created="Mon, 13 Mar 2006 05:57:37 +0000"/>
                            <attachment id="12324078" name="DERBY-949_2006_03_11.stat" size="744" author="myrna" created="Mon, 13 Mar 2006 05:57:37 +0000"/>
                            <attachment id="12324108" name="DERBY-949_2006_03_13.diff" size="27770" author="myrna" created="Tue, 14 Mar 2006 05:17:56 +0000"/>
                            <attachment id="12324241" name="DERBY-949_2006_03_15.diff" size="28910" author="myrna" created="Thu, 16 Mar 2006 03:54:00 +0000"/>
                            <attachment id="12324354" name="DERBY-993_2006_03_19.diff" size="15834" author="myrna" created="Mon, 20 Mar 2006 14:00:40 +0000"/>
                            <attachment id="12324353" name="DERBY-993_2006_03_19.stat" size="552" author="myrna" created="Mon, 20 Mar 2006 14:00:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 13 Mar 2006 05:57:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29799</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0txb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38666</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>