<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:40:31 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1322/DERBY-1322.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1322] Missing resets of isOnInsertRow state in net client when navigating away via other than ResultSet#next</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1322</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Please see the enclosed repro program.&lt;/p&gt;

&lt;p&gt;When attempting the deleteRow, it will fail with SQL state 24000 &quot;no&lt;br/&gt;
current row&quot;, since the first() call doesn&apos;t properly reset the&lt;br/&gt;
IsOnInsertRow_ state. By inspection of ../am/ResultSet.java I found&lt;br/&gt;
the other positioning calls beside next and moveToCurrentRow to suffer&lt;br/&gt;
the same problem.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12334147">DERBY-1322</key>
            <summary>Missing resets of isOnInsertRow state in net client when navigating away via other than ResultSet#next</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fernanda">Fernanda Pizzorno</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 May 2006 21:06:07 +0100</created>
                <updated>Tue, 10 Oct 2006 17:56:28 +0100</updated>
                            <resolved>Wed, 24 May 2006 22:08:58 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>JDBC</component>
                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12411992" author="fernanda" created="Tue, 16 May 2006 23:03:19 +0100"  >&lt;p&gt;Changes in patch derby-1322.diff:&lt;/p&gt;

&lt;p&gt;java/client/org/apache/derby/client/am/ResultSet.java&lt;br/&gt;
Moved part of the method moveToCurrentRow() into a new method moveToCurrentRowX() and added a call to moveToCurrentRowX() from all positioning methods.&lt;/p&gt;

&lt;p&gt;java/testing/org/apache/derbyTesting/functionTests/tests/jdbcapi/SURTest.java&lt;br/&gt;
Added a test case.&lt;/p&gt;

&lt;p&gt;I have run derbyall, two tests failed but it did not seem to be related to this patch. Can someone please review this patch?&lt;/p&gt;

&lt;p&gt;Thank you in advance!&lt;/p&gt;</comment>
                            <comment id="12412454" author="dagw" created="Fri, 19 May 2006 08:09:04 +0100"  >&lt;p&gt;The patch looks good. I verified that the changed SURTest.java exposes the problem&lt;br/&gt;
when run without the rest of the patch, and is OK after code changes.&lt;/p&gt;

&lt;p&gt;Just a few comments:&lt;/p&gt;

&lt;p&gt;*ResultSet.java&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;relativeX&lt;br/&gt;
        if (isOnInsertRow_) 
{
            moveToCurrentRowX();
        }
&lt;p&gt;	:&lt;br/&gt;
        // this method may not be called when the cursor on the insert row&lt;br/&gt;
        if (isOnInsertRow_) &lt;/p&gt;
{
            throw new SqlException(agent_.logWriter_, 
                new ClientMessageId(SQLState.CURSOR_INVALID_OPERATION_AT_CURRENT_POSITION));
        }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  The latter &quot;if&quot; can now be removed.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Since the method moveToCurrentRowX checks against isOnInsertRow_, I think&lt;br/&gt;
  you could remove the (redundant) tests in the &amp;lt;position&amp;gt;X methods, e.g. &lt;br/&gt;
  here in nextX:&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;      if (isOnInsertRow_) &lt;/p&gt;
{
          moveToCurrentRowX();
      }
&lt;p&gt;  -&amp;gt; &lt;br/&gt;
      moveToCurrentRowX();&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;typo in comment in moveToCurrentRowX:	// no affect&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  It should be &quot;effect&quot;, but I would omit this comment, as it&apos;s&lt;br/&gt;
  obvious.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;SURTest.java&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;testInsertRowWithScrollCursor:&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  Statement s should be closed at end.&lt;/p&gt;

&lt;p&gt;  &amp;gt; s.setCursorName(getNextCursorName());&lt;/p&gt;

&lt;p&gt;  I don&apos;t believe this is necessary; I suspect in SURTest.java, the&lt;br/&gt;
  cursor was named explicitly due to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-787&quot; title=&quot;cursor closed as a sideeffect of closing another cursor with the same name on another connection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-787&quot;&gt;&lt;del&gt;DERBY-787&lt;/del&gt;&lt;/a&gt;, but this has been&lt;br/&gt;
  fixed now.&lt;/p&gt;</comment>
                            <comment id="12412779" author="fernanda" created="Mon, 22 May 2006 22:25:13 +0100"  >&lt;p&gt;The attached patch (derby-1322v2.diff) addresses the comments of Dag&apos;s review.&lt;/p&gt;

&lt;p&gt;In SURTest.java, I agree that s.setCursorName(..) is not necessesary anymore, but it has been used in all of the other tests in SURTest.java. I think it is ok keep the same pattern as  used previously when adding new tests cases to an existing test. That&apos;s the reason why I have chosen not to remove it.&lt;/p&gt;

&lt;p&gt;Derbyall ran successfully.&lt;/p&gt;</comment>
                            <comment id="12413030" author="dagw" created="Wed, 24 May 2006 07:34:37 +0100"  >&lt;p&gt;Thanks for addressing my comments! I think it is ready to go.&lt;/p&gt;</comment>
                            <comment id="12413120" author="bernt" created="Wed, 24 May 2006 22:08:58 +0100"  >&lt;p&gt;Committed revision 409170.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12327409" name="Repro.java" size="6931" author="dagw" created="Fri, 12 May 2006 21:12:43 +0100"/>
                            <attachment id="12334190" name="derby-1322.diff" size="11071" author="fernanda" created="Tue, 16 May 2006 23:03:19 +0100"/>
                            <attachment id="12334191" name="derby-1322.stat" size="301" author="fernanda" created="Tue, 16 May 2006 23:03:19 +0100"/>
                            <attachment id="12334409" name="derby-1322v2.diff" size="11236" author="fernanda" created="Mon, 22 May 2006 22:25:13 +0100"/>
                            <attachment id="12334410" name="derby-1322v2.stat" size="301" author="fernanda" created="Mon, 22 May 2006 22:25:13 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 16 May 2006 22:03:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22435</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy147j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40332</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>