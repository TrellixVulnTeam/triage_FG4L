<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:20:35 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3346/DERBY-3346.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3346] DatabaseMetaData.getIndexInfo returns the wrong nullabilty for column 4 NON_UNIQUE</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3346</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Derby&apos;s implementation of the NON_UNIQUE column for getIndexInfo() resolves to this expression:&lt;/p&gt;

&lt;p&gt;(CASE WHEN CONGLOMS.DESCRIPTOR.isUnique() THEN FALSE ELSE TRUE END) AS NON_UNIQUE&lt;/p&gt;

&lt;p&gt;The possible return values for this are TRUE or FALSE (this is internal SQL), which are both non-null constants,&lt;br/&gt;
thus its type should be not nullable. A similar external SQL expression by itself does return the correct nullability,&lt;br/&gt;
thus it seems to be a possible case where one node&apos;s nullability is affecting another. See &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2775&quot; title=&quot;DataTypeDescriptor should be immutable so that multiple ValueNode referring to the same DTD do not have unexpected state changes.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2775&quot;&gt;DERBY-2775&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3342&quot; title=&quot;DatabaseMetaData.getProcedureColumns() returns incorrect nullability for column 9 LENGTH&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3342&quot;&gt;&lt;del&gt;DERBY-3342&lt;/del&gt;&lt;/a&gt;. This like &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3342&quot; title=&quot;DatabaseMetaData.getProcedureColumns() returns incorrect nullability for column 9 LENGTH&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3342&quot;&gt;&lt;del&gt;DERBY-3342&lt;/del&gt;&lt;/a&gt; was found while fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2775&quot; title=&quot;DataTypeDescriptor should be immutable so that multiple ValueNode referring to the same DTD do not have unexpected state changes.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2775&quot;&gt;DERBY-2775&lt;/a&gt;.&lt;/p&gt;


&lt;p&gt;Working SQL with correct nullability:&lt;br/&gt;
VALUES CASE WHEN 3=? THEN 1 ELSE 2 END&lt;/p&gt;</description>
                <environment></environment>
        <key id="12386980">DERBY-3346</key>
            <summary>DatabaseMetaData.getIndexInfo returns the wrong nullabilty for column 4 NON_UNIQUE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="djd">Daniel John Debrunner</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Jan 2008 22:36:01 +0000</created>
                <updated>Wed, 30 Jan 2008 19:40:19 +0000</updated>
                            <resolved>Wed, 30 Jan 2008 19:38:40 +0000</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>JDBC</component>
                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12561880" author="djd" created="Wed, 23 Jan 2008 23:56:56 +0000"  >&lt;p&gt;and for column 10 ASC_OR_DESC (same issue as NON_UNIQUE)&lt;/p&gt;</comment>
                            <comment id="12562174" author="djd" created="Thu, 24 Jan 2008 19:21:20 +0000"  >&lt;p&gt;Hit another problem with the NON_UNIQUE column. Changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2775&quot; title=&quot;DataTypeDescriptor should be immutable so that multiple ValueNode referring to the same DTD do not have unexpected state changes.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2775&quot;&gt;DERBY-2775&lt;/a&gt; fix it for the JDBC query  but the ODBC query continues to indicate the column is nullable. This is because the JDBC column is CAST for the ODBC query.&lt;/p&gt;

&lt;p&gt;The CAST operator incorrectly always sets its type to  nullable, even when the source is not nullable.&lt;br/&gt;
E.g.&lt;br/&gt;
  expression: &apos;a&apos; - not nullable&lt;br/&gt;
  expression CAST (&apos;a&apos; AS CHAR(4)) - nullable&lt;/p&gt;

&lt;p&gt;Simple tests appear to show the CAST is working correctly:&lt;br/&gt;
  expresion: 3 - not nullable&lt;br/&gt;
  expression CAST (3 AS SMALLINT) - not nullable&lt;/p&gt;

&lt;p&gt;I think this is because the bind is removing the cast node and modifying the constant node&apos;s type, as the code for CastNode always seems to set its type to be nullable.&lt;/p&gt;</comment>
                            <comment id="12564148" author="djd" created="Wed, 30 Jan 2008 19:38:40 +0000"  >&lt;p&gt;Fixed by Revision: 616853 for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2775&quot; title=&quot;DataTypeDescriptor should be immutable so that multiple ValueNode referring to the same DTD do not have unexpected state changes.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2775&quot;&gt;DERBY-2775&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23585</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0ziv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39573</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>