<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:15:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5475/DERBY-5475.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5475] Formalize use of old Derby distributions in tests</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5475</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Some types of tests need old Derby distributions to perform the required actions. Currently this includes the upgrade test and the compatibility test.&lt;br/&gt;
Instead of each test dealing with this in their own way, there should be support for accessing old Derby distributions in the test framework.&lt;/p&gt;

&lt;p&gt;I propose to add a Derby distribution repository in the test framework, with the following guidelines and changes:&lt;br/&gt;
 o keep it as simple as possible, which suggests it is the users responsibility to keep the repository updated&lt;br/&gt;
 o compatibility with the existing derbyTesting.oldReleasePath property&lt;br/&gt;
 o make the tests requiring old distributions fail if there are no distributions available&lt;br/&gt;
 o establish a default location where the test framework will look for old distributions if derbyTesting.oldReleasePath is unspecified&lt;br/&gt;
 o the repository should not incur any costs when not used by the test(s) being run&lt;/p&gt;

&lt;p&gt;In favor of simplicity the repository will not download releases itself. The user has to keep the repository contents up-to-date, which is as simple as running &apos;svn up&apos; each time a new Derby release is published. It is unclear if, and what, the repository and/or relevant tests should do if the repository is outdated. It seems useful to allow the user to make available only a subset of the distributions, but maybe printing a warning is helpful to remind developers that their repository is stale.&lt;/p&gt;

&lt;p&gt;Another related issue, which will only be relevant some time in the future, is whether a test framework of version X should make available distributions of version X+n. Currently I&apos;m leaning towards not doing that, but haven&apos;t really looked into it.&lt;/p&gt;

&lt;p&gt;See also thread on derby-dev: &lt;a href=&quot;http://db.markmail.org/thread/44uyusa726cwjuk2&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.markmail.org/thread/44uyusa726cwjuk2&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12528480">DERBY-5475</key>
            <summary>Formalize use of old Derby distributions in tests</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="3" iconUrl="https://issues.apache.org/jira/images/icons/statuses/inprogress.png" description="This issue is being actively worked on at the moment by the assignee.">In Progress</status>
                    <statusCategory id="4" key="indeterminate" colorName="yellow"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="kristwaa">Kristian Waagan</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Oct 2011 13:57:47 +0100</created>
                <updated>Mon, 24 Sep 2012 19:08:51 +0100</updated>
                                            <version>10.9.1.0</version>
                                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13138239" author="kristwaa" created="Fri, 28 Oct 2011 12:49:10 +0100"  >&lt;p&gt;Attaching patch 1a, which adds the following classes:&lt;br/&gt;
 o junit.DerbyVersion&lt;br/&gt;
    main class representing a Derby version. Has methods for comparing versions against each other. Holds major, minor, fixpack and point levels/versions.&lt;br/&gt;
    I decided to add all officially released versions as constants (code needing to use non-official/-released versions should create their constants elsewhere).&lt;br/&gt;
    The methods are inspired by existing use in the compatibility and the upgrade tests. A little more functionality may be added depending on what the UpgradeTrajectoryTest needs.&lt;br/&gt;
    There are a few version classes around (some as inner classes), hopefully this one can be used in all cases.&lt;/p&gt;

&lt;p&gt; o junit.DerbyVersionSimple&lt;br/&gt;
    Holds only major.minor levels. Introduced for compatibility, may be removed later on.&lt;/p&gt;

&lt;p&gt; o unitTests.junit.DerbyVersionTest&lt;br/&gt;
    Basic test for the comparison methods.&lt;/p&gt;

&lt;p&gt;Also added the new test to unitTests.junit._Suite.&lt;br/&gt;
All the code is currently unused. The coming release repository will use it, so will the rewritten compatibility test (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2076&quot; title=&quot;Rewrite junitTests/derbyNet/CompatibilityTest to conform to current JUnit usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2076&quot;&gt;&lt;del&gt;DERBY-2076&lt;/del&gt;&lt;/a&gt;). I will also make changes to the upgrade tests.&lt;/p&gt;

&lt;p&gt;Patch 1a ready for review.&lt;/p&gt;</comment>
                            <comment id="13140150" author="kristwaa" created="Mon, 31 Oct 2011 13:29:00 +0000"  >&lt;p&gt;Attaching patch 1b, which makes DerbyVersion use the Utilities.split method instead of String.split (JSR169 limitation). Added a test case for the parseVersionString method.&lt;/p&gt;

&lt;p&gt;Committed patch 1b to trunk with revision 1195449.&lt;br/&gt;
I will incorporate any after-commit comments in coming patches (there is no code using these classes yet).&lt;/p&gt;</comment>
                            <comment id="13140187" author="kristwaa" created="Mon, 31 Oct 2011 14:41:10 +0000"  >&lt;p&gt;Fixed incorrect class name in license header in DerbyVersionTest with revision 1195481.&lt;/p&gt;</comment>
                            <comment id="13210147" author="kristwaa" created="Fri, 17 Feb 2012 09:02:21 +0000"  >&lt;p&gt;Patch 2a renames DerbyVersionSimple to Version to indicate that it isn&apos;t tied speicifally to a Derby version.&lt;br/&gt;
Renamed method &apos;atLeastAs&apos; to &apos;atLeast&apos;, and did some other minor changes.&lt;/p&gt;

&lt;p&gt;Committed to trunk with revision 1245349.&lt;/p&gt;</comment>
                            <comment id="13213791" author="kristwaa" created="Wed, 22 Feb 2012 17:52:18 +0000"  >&lt;p&gt;Attaching patch 3a, which adds two classes:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;junit/DerbyDistribution&lt;br/&gt;
A class representing a Derby distribution on disk. Has a set of convenience methods to work with the distribution, i.e. getting the paths to various JAR-files and the version.&lt;br/&gt;
It only supports distributions based off JARs. It is not problematic to add support for classes-based distributions, but using such distributions in tests is more complicated due to various classpath issues. For instance, some tests require that you only add the client code. I suspect further problems like classpath shadowing and possibly sealing violations.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;junit/ReleaseRepository&lt;br/&gt;
Builds a list of distributions found in a directory on disk.&lt;br/&gt;
This repository does nothing to fetch or verify that the directory on disk contains a recent set of releases. It&apos;s up to the user to keep the directory updated, and up to the tests using the repository to require specific releases etc.&lt;br/&gt;
The repository will look in a default location ($HOME/.derbyTestingReleases), but this can by overridden by specifying derbyTesting.oldReleasePath. That property is already used by existing tests.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="13262512" author="kristwaa" created="Thu, 26 Apr 2012 11:30:52 +0100"  >&lt;p&gt;Committed patch 3a to trunk with revision 1330751.&lt;br/&gt;
The next step is probably to rewrite one of the tests to start using the repository, and to make it available in the test framework.&lt;br/&gt;
I do plan to remove the code that downloads the JARs from Apache because. In my opinion downloading the JARs each time you run the test needing them is a waste of resources. Instead the developer should download them once and then update the local repository, which is as simple as typing &apos;svn up&apos;, at regular intervals or explicitly when a new release happens.&lt;/p&gt;

&lt;p&gt;As for more functionality, I&apos;m considering moving the handling of derbyTesting.oldVersionsPath into ReleaseRepository. I have no feel for how much this is being used, but it does allow for a solution where the configuration can be relatively easy scripted from a shell or similar.&lt;/p&gt;</comment>
                            <comment id="13398290" author="kristwaa" created="Thu, 21 Jun 2012 09:42:23 +0100"  >&lt;p&gt;Attaching patch 4a, which removes some leftover throws-clauses and changes the exception handling in one case.&lt;br/&gt;
It also exposes the release repository through a static method in TestConfiguration.&lt;/p&gt;</comment>
                            <comment id="13398355" author="kristwaa" created="Thu, 21 Jun 2012 12:30:48 +0100"  >&lt;p&gt;Committed patch 4a to trunk with revision 1352498.&lt;/p&gt;</comment>
                            <comment id="13461961" author="myrna" created="Mon, 24 Sep 2012 19:08:51 +0100"  >&lt;p&gt;Kristian, is there still more work to come under this JIRA?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12556717">DERBY-5775</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12355551">DERBY-2076</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12501280" name="derby-5475-1a-DerbyVersion.diff" size="21873" author="kristwaa" created="Fri, 28 Oct 2011 12:49:10 +0100"/>
                            <attachment id="12501609" name="derby-5475-1b-DerbyVersion.diff" size="23820" author="kristwaa" created="Mon, 31 Oct 2011 13:29:00 +0000"/>
                            <attachment id="12514966" name="derby-5475-2a-rename_and_cleanup.diff" size="7603" author="kristwaa" created="Fri, 17 Feb 2012 09:02:20 +0000"/>
                            <attachment id="12514967" name="derby-5475-2a-rename_and_cleanup.stat" size="304" author="kristwaa" created="Fri, 17 Feb 2012 09:02:20 +0000"/>
                            <attachment id="12515620" name="derby-5475-3a-repository.diff" size="23918" author="kristwaa" created="Wed, 22 Feb 2012 17:52:18 +0000"/>
                            <attachment id="12532845" name="derby-5475-4a-less_exceptions_and_expose.diff" size="5751" author="kristwaa" created="Thu, 21 Jun 2012 09:42:22 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 24 Sep 2012 18:08:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>214340</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy09qf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35395</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>