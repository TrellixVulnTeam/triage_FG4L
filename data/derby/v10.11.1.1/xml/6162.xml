<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:16:25 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6162/DERBY-6162.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6162] Simplify privileged actions in NetworkServerControlApiTest</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6162</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Noticed two privileged blocks in NetworkServerControlApiTest that could be simplified:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;privInetAddressGetByName() tests whether the PrivilegedActionException wraps a SecurityException. PAE only wraps checked exceptions, and SecurityException is an unchecked exception, so that can never happen.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;fileExists() could use the existing helper method PrivilegedFileOpsForTests.exists() and remove its privileged block.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12641803">DERBY-6162</key>
            <summary>Simplify privileged actions in NetworkServerControlApiTest</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Apr 2013 11:36:40 +0100</created>
                <updated>Mon, 17 Jun 2013 10:27:19 +0100</updated>
                            <resolved>Thu, 11 Apr 2013 16:09:23 +0100</resolved>
                                    <version>10.11.1.1</version>
                                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13627663" author="knutanders" created="Wed, 10 Apr 2013 11:44:47 +0100"  >&lt;p&gt;Attaching d6162-1a.diff which simplifies the two methods as described above.&lt;/p&gt;

&lt;p&gt;While at it, I also moved NetworkServerControlApiTest to a different build target that makes it compiled with source level 1.5, so that generics could be used to simplify the call to the privileged code further (saved a cast). The test only runs on Java 5 and higher, so it should be OK to raise the compiler level.&lt;/p&gt;

&lt;p&gt;I&apos;ve run the derbynet suite successfully on Java 7 and on OJEC 1.1 with the patch.&lt;/p&gt;</comment>
                            <comment id="13627790" author="dagw" created="Wed, 10 Apr 2013 14:38:08 +0100"  >&lt;p&gt;Looks good. I see you added a -Xlint option; is that our current convention? +1&lt;/p&gt;
</comment>
                            <comment id="13627885" author="knutanders" created="Wed, 10 Apr 2013 16:11:25 +0100"  >&lt;p&gt;Thanks, Dag.&lt;/p&gt;

&lt;p&gt;We also use the -Xlint option when compiling the client code and the JDBC 4.x test code. Maybe not a convention, but at least it&apos;s not unprecedented. I found it useful to add it so that I didn&apos;t have to recompile manually in order to find out what was causing a warning. Without the flag, the compiler says there are warnings, but doesn&apos;t give any details about where and why.&lt;/p&gt;

&lt;p&gt;Committed revision 1466508.&lt;/p&gt;</comment>
                            <comment id="13628306" author="knutanders" created="Wed, 10 Apr 2013 22:46:04 +0100"  >&lt;p&gt;Reopening. Rick said in a comment on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3110&quot; title=&quot;server hangs after trace on command fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3110&quot;&gt;&lt;del&gt;DERBY-3110&lt;/del&gt;&lt;/a&gt; that he saw a deprecation warning in NetworkServerControlApiTest on trunk now. I suspect this is because of the changed compiler level. I didn&apos;t see that warning myself, but I think deprecation warnings may vary depending on how the compile classpath is set. I will take a look.&lt;/p&gt;</comment>
                            <comment id="13628863" author="knutanders" created="Thu, 11 Apr 2013 12:53:37 +0100"  >&lt;p&gt;I see the deprecation warning if I don&apos;t set j15lib in ant.properties. The File.toURL() method wasn&apos;t deprecated until Java 6, so we only see the warning if java15compile.classpath is constructed from Java 6 or newer class libraries.&lt;/p&gt;

&lt;p&gt;We could silence the warning by replacing the call to File.toURL() with a call to File.toURI() and then call toURL() on the returned URI instance, as suggested by the deprecation text in java.io.File&apos;s javadoc. However, the call doesn&apos;t seem to be necessary. It is used when the test copies a custom policy file from derbyTesting.jar (or the classes directory) to the test directory. This is not necessary, since SecurityManagerTestSetup knows how to use policy files in derbyTesting.jar (or classes) directly.&lt;/p&gt;

&lt;p&gt;The attached patch (d6162-2a-deprecation.diff) removes the code that copies the policy file, including the call to the deprecated method. This code was duplicated in lots of tests, and the patch fixes all occurrences. (One exception: SecurityPolicyReloadingTest actually needs to copy the policy file to a writable location in order to modify it and see if Derby picks up the changes. In this test, I changed the toURL() call to the suggested toURI().toURL().)&lt;/p&gt;

&lt;p&gt;All the modified tests passed when I ran them individually. Running suites.All now to verify that the patch didn&apos;t break anything else.&lt;/p&gt;</comment>
                            <comment id="13628999" author="knutanders" created="Thu, 11 Apr 2013 16:09:23 +0100"  >&lt;p&gt;suites.All passed.&lt;/p&gt;

&lt;p&gt;Committed revision 1466914.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12577982" name="d6162-1a.diff" size="6263" author="knutanders" created="Wed, 10 Apr 2013 11:44:47 +0100"/>
                            <attachment id="12578201" name="d6162-2a-deprecation.diff" size="32570" author="knutanders" created="Thu, 11 Apr 2013 12:53:37 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 10 Apr 2013 13:38:08 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322218</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzdg0n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>322563</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>