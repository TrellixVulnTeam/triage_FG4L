<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:19:32 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5705/DERBY-5705.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5705] Authorization decorators don&apos;t null out connections when done</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5705</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Some decorators used to test authorization don&apos;t close and null out references to Connection objects when they have completed. Since these tests often create/boot single-use databases, and the Connection objects have references to the database instance and, directly or indirectly, many of its modules, this prevents much garbage from being removed from the heap after the tests have completed and shut down their single-use databases. We should close the default connection and clear the reference to it when tearing down these decorators, so the space is released for subsequent tests to use.&lt;/p&gt;

&lt;p&gt;This problem affects decorators returned by the following methods:&lt;/p&gt;

&lt;p&gt;DatabasePropertyTestSetup.builtinAuthenticationNoTeardown()&lt;br/&gt;
TestConfiguration.sqlAuthorizationDecorator()&lt;br/&gt;
TestConfiguration.sqlAuthorizationDecoratorSingleUse()&lt;/p&gt;

&lt;p&gt;These methods return modified versions of DatabasePropertyTestSetup where the tearDown() method is a no-op.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12552270">DERBY-5705</key>
            <summary>Authorization decorators don&apos;t null out connections when done</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Apr 2012 09:55:46 +0100</created>
                <updated>Wed, 25 Apr 2012 12:20:07 +0100</updated>
                            <resolved>Wed, 25 Apr 2012 12:20:07 +0100</resolved>
                                    <version>10.9.1.0</version>
                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13260379" author="knutanders" created="Tue, 24 Apr 2012 10:23:50 +0100"  >&lt;p&gt;Attaching a patch that makes the following changes:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Use the (already existing) method DatabasePropertyTestSetup.getNoTeardownInstance() instead of having many DatabasePropertyTestSetup classes that override tearDown() with an empty method. (To make it possible to have the new logic that releases the resources at just one location.)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Make the tearDown() method in the decorator returned by DatabasePropertyTestSetup.getNoTeardownInstance() close and null out the default connection.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;These changes preserve the main purpose of these decorators, which is that they shouldn&apos;t reset the properties in tearDown(), and at the same time allows the connection and its resources to be garbage collected once they&apos;re no longer used.&lt;/p&gt;

&lt;p&gt;suites.All ran successfully with the patch.&lt;/p&gt;

&lt;p&gt;I also verified that the patch reduced the number of BasicDatabase instances still held on the heap after running RolesTest and DboPowersTest. The numbers were reduced from 8 to 4, and from 50 to 36, respectively. (I had expected that the numbers would go down to one or two (wombat + dbsqlauth), so there may still be some other related bugs.)&lt;/p&gt;</comment>
                            <comment id="13261451" author="knutanders" created="Wed, 25 Apr 2012 12:20:07 +0100"  >&lt;p&gt;Committed revision 1330196.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12523948" name="d5705-1a.diff" size="4068" author="knutanders" created="Tue, 24 Apr 2012 10:23:50 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>237463</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0c67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35790</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>