<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:19:07 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6502/DERBY-6502.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6502] Failure in OnlineCompressTest</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6502</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The following error in OnlineCompressTest appeared in the nightly test run on the 10.11 trunk. See &lt;a href=&quot;http://download.java.net/javadesktop/derby/request_5588473/javadb-task-3816823.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.java.net/javadesktop/derby/request_5588473/javadb-task-3816823.html&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/storeall/storemore/OnlineCompressTest.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: OnlineCompressTest jdk1.8.0_05 storeall:storemore 2014-03-07 13:25:17 ***&lt;br/&gt;
34 del&lt;br/&gt;
&amp;lt; Executing test: delete all rows case succeeded.&lt;br/&gt;
35 del&lt;br/&gt;
&amp;lt; Executing test: end deleteAllRows,4000 row test.&lt;br/&gt;
36 del&lt;br/&gt;
&amp;lt; Executing test: begin deleteAllRows,4000 row test, create = false.&lt;br/&gt;
37 del&lt;br/&gt;
&amp;lt; Executing test: no delete case complete.&lt;br/&gt;
38 del&lt;br/&gt;
&amp;lt; Executing test: delete all rows case succeeded.&lt;br/&gt;
39 del&lt;br/&gt;
&amp;lt; Executing test: end deleteAllRows,4000 row test.&lt;br/&gt;
40 del&lt;br/&gt;
&amp;lt; Executing test: begin checkPurgePhase4000 row test, create = false.&lt;br/&gt;
41 del&lt;br/&gt;
&amp;lt; Executing test: end checkPurgePhase4000 row test.&lt;br/&gt;
42 del&lt;br/&gt;
&amp;lt; Ending test: test1&lt;br/&gt;
43 del&lt;br/&gt;
&amp;lt; Beginning test: test3&lt;br/&gt;
44 del&lt;br/&gt;
&amp;lt; Executing test: begin deleteAllRows,1 row test, create = true.&lt;br/&gt;
45 del&lt;br/&gt;
&amp;lt; Executing test: no delete case complete.&lt;br/&gt;
46 del&lt;br/&gt;
&amp;lt; Executing test: delete all rows case succeeded.&lt;br/&gt;
47 del&lt;br/&gt;
&amp;lt; Executing test: end deleteAllRows,1 row test.&lt;br/&gt;
48 del&lt;br/&gt;
&amp;lt; Executing test: begin deleteAllRows,1 row test, create = false.&lt;br/&gt;
49 del&lt;br/&gt;
&amp;lt; Executing test: no delete case complete.&lt;br/&gt;
50 del&lt;br/&gt;
&amp;lt; Executing test: delete all rows case succeeded.&lt;br/&gt;
51 del&lt;br/&gt;
&amp;lt; Executing test: end deleteAllRows,1 row test.&lt;br/&gt;
52 del&lt;br/&gt;
&amp;lt; Executing test: begin checkPurgePhase1 row test, create = false.&lt;br/&gt;
53 del&lt;br/&gt;
&amp;lt; Executing test: end checkPurgePhase1 row test.&lt;br/&gt;
54 del&lt;br/&gt;
&amp;lt; Executing test: begin deleteAllRows,2 row test, create = true.&lt;br/&gt;
55 del&lt;br/&gt;
&amp;lt; Executing test: no delete case complete.&lt;br/&gt;
56 del&lt;br/&gt;
&amp;lt; Executing test: delete all rows case succeeded.&lt;br/&gt;
57 del&lt;br/&gt;
&amp;lt; Executing test: end deleteAllRows,2 row test.&lt;br/&gt;
58 del&lt;br/&gt;
&amp;lt; Executing test: begin deleteAllRows,2 row test, create = false.&lt;br/&gt;
59 del&lt;br/&gt;
&amp;lt; Executing test: no delete case complete.&lt;br/&gt;
60 del&lt;br/&gt;
&amp;lt; Executing test: delete all rows case succeeded.&lt;br/&gt;
61 del&lt;br/&gt;
&amp;lt; Executing test: end deleteAllRows,2 row test.&lt;br/&gt;
62 del&lt;br/&gt;
&amp;lt; Executing test: begin checkPurgePhase2 row test, create = false.&lt;br/&gt;
63 del&lt;br/&gt;
&amp;lt; Executing test: end checkPurgePhase2 row test.&lt;br/&gt;
64 del&lt;br/&gt;
&amp;lt; Executing test: begin deleteAllRows,50 row test, create = true.&lt;br/&gt;
65 del&lt;br/&gt;
&amp;lt; Executing test: no delete case complete.&lt;br/&gt;
66 del&lt;br/&gt;
&amp;lt; Executing test: delete all rows case succeeded.&lt;br/&gt;
67 del&lt;br/&gt;
&amp;lt; Executing test: end deleteAllRows,50 row test.&lt;br/&gt;
68 del&lt;br/&gt;
&amp;lt; Executing test: begin deleteAllRows,50 row test, create = false.&lt;br/&gt;
69 del&lt;br/&gt;
&amp;lt; Executing test: no delete case complete.&lt;br/&gt;
70 del&lt;br/&gt;
&amp;lt; Executing test: delete all rows case succeeded.&lt;br/&gt;
71 del&lt;br/&gt;
&amp;lt; Executing test: end deleteAllRows,50 row test.&lt;br/&gt;
72 del&lt;br/&gt;
&amp;lt; Executing test: begin checkPurgePhase50 row test, create = false.&lt;br/&gt;
73 del&lt;br/&gt;
&amp;lt; Executing test: end checkPurgePhase50 row test.&lt;br/&gt;
74 del&lt;br/&gt;
&amp;lt; Ending test: test3&lt;br/&gt;
75 del&lt;br/&gt;
&amp;lt; Beginning test: test5&lt;br/&gt;
76 del&lt;br/&gt;
&amp;lt; Executing test: begin test5: 2000 row test.&lt;br/&gt;
77 del&lt;br/&gt;
&amp;lt; Executing test: end test5: 2000 row test.&lt;br/&gt;
78 del&lt;br/&gt;
&amp;lt; Executing test: begin test5: 10000 row test.&lt;br/&gt;
79 del&lt;br/&gt;
&amp;lt; Executing test: end test5: 10000 row test.&lt;br/&gt;
80 del&lt;br/&gt;
&amp;lt; Ending test: test5&lt;br/&gt;
81 del&lt;br/&gt;
&amp;lt; Beginning test: test6&lt;br/&gt;
82 del&lt;br/&gt;
&amp;lt; Executing test: no delete case complete.&lt;br/&gt;
83 del&lt;br/&gt;
&amp;lt; Executing test: delete all rows case succeeded.&lt;br/&gt;
84 del&lt;br/&gt;
&amp;lt; Executing test: end simple deleteAllRows,104000 row test.&lt;br/&gt;
85 del&lt;br/&gt;
&amp;lt; Ending test: test6&lt;br/&gt;
86 del&lt;br/&gt;
&amp;lt; Beginning test: test7&lt;br/&gt;
87 del&lt;br/&gt;
&amp;lt; Executing test: delete rows case succeeded.&lt;br/&gt;
88 del&lt;br/&gt;
&amp;lt; Ending test: test7&lt;br/&gt;
88 add&lt;br/&gt;
&amp;gt; ERROR 38000: The exception &apos;java.sql.SQLException: A lock could not be obtained within the time requested&apos; was thrown while evaluating an expression.&lt;br/&gt;
&amp;gt; ERROR 40XL1: A lock could not be obtained within the time requested&lt;br/&gt;
&amp;gt; java.sql.SQLException: The exception &apos;java.sql.SQLException: A lock could not be obtained within the time requested&apos; was thrown while evaluating an expression.&lt;br/&gt;
&amp;gt; Caused by: ERROR 38000: The exception &apos;java.sql.SQLException: A lock could not be obtained within the time requested&apos; was thrown while evaluating an expression.&lt;br/&gt;
&amp;gt; 	... 15 more&lt;br/&gt;
&amp;gt; Caused by: java.sql.SQLException: A lock could not be obtained within the time requested&lt;br/&gt;
&amp;gt; 	... 8 more&lt;br/&gt;
&amp;gt; Caused by: ERROR 40XL1: A lock could not be obtained within the time requested&lt;br/&gt;
&amp;gt; 	... 21 more&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   OnlineCompressTest jdk1.8.0_05 storeall:storemore 2014-03-07 13:25:35 ***&lt;br/&gt;
------------------------------------------------------&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

</description>
                <environment>Mac OS X: x86_64 10.9.2&lt;br/&gt;
java.runtime.version: 1.8.0_05-b11&lt;br/&gt;
Derby: 10.11 development trunk</environment>
        <key id="12699415">DERBY-6502</key>
            <summary>Failure in OnlineCompressTest</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="myrna">Myrna van Lunteren</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Mar 2014 13:33:18 +0000</created>
                <updated>Wed, 8 Oct 2014 19:18:31 +0100</updated>
                            <resolved>Wed, 8 Oct 2014 19:06:00 +0100</resolved>
                                                    <fixVersion>10.10.2.1</fixVersion>
                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13925667" author="knutanders" created="Mon, 10 Mar 2014 11:24:17 +0000"  >&lt;p&gt;Uploading derby.log and the full test output from the failing test run.&lt;/p&gt;

&lt;p&gt;All the rows in the table have been deleted just before the compress operation, so maybe it could be a lock conflict with the B-tree post commit work in the background thread.&lt;/p&gt;</comment>
                            <comment id="13984749" author="myrna" created="Tue, 29 Apr 2014 21:35:21 +0100"  >&lt;p&gt;I tried to reproduce the problem by running the test 100x (with jdk 1.8); it did not fail.&lt;br/&gt;
I tried the same with derbynetclientmats suite, also did not fail.&lt;br/&gt;
However, I did see a similar error with a private JVM build against trunk (10.11.0.0 alpha at revision 1590210).&lt;/p&gt;</comment>
                            <comment id="13985258" author="knutanders" created="Wed, 30 Apr 2014 09:12:02 +0100"  >&lt;p&gt;Failed again here: &lt;a href=&quot;http://download.java.net/javadesktop/derby/request_5590437/javadb-task-3850971.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.java.net/javadesktop/derby/request_5590437/javadb-task-3850971.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13986930" author="myrna" created="Thu, 1 May 2014 21:00:55 +0100"  >&lt;p&gt;Attaching a patch which adds a call to wait_for_post_commit after each commit following a delete.&lt;/p&gt;</comment>
                            <comment id="13986935" author="myrna" created="Thu, 1 May 2014 21:03:15 +0100"  >&lt;p&gt;I have added the wait_for_post_commit call not just in spot in the original report, but everywhere where there&apos;s a delete followed by commit.&lt;br/&gt;
If this looks good, as I cannot duplicate the behavior, I think I&apos;ll just commit this and hopefully it will fix the issue.&lt;/p&gt;</comment>
                            <comment id="13987623" author="knutanders" created="Fri, 2 May 2014 13:07:21 +0100"  >&lt;p&gt;Looks fine to me. You may want to close stmt and cstmt for good measure, since this test is in the old test harness, which doesn&apos;t close statements automatically.&lt;/p&gt;</comment>
                            <comment id="13989969" author="jira-bot" created="Mon, 5 May 2014 22:01:53 +0100"  >&lt;p&gt;Commit 1592630 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1592630&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1592630&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6502&quot; title=&quot;Failure in OnlineCompressTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6502&quot;&gt;&lt;del&gt;DERBY-6502&lt;/del&gt;&lt;/a&gt;; Failure in OnlineCompressTest&lt;br/&gt;
   adding calls to wait for post commit tasks in the hope of addressing instability in OnlineCompressTest.&lt;/p&gt;</comment>
                            <comment id="13989978" author="myrna" created="Mon, 5 May 2014 22:08:56 +0100"  >&lt;p&gt;Thanks for the review Knut.&lt;br/&gt;
I added the close statements, and committed the change.&lt;/p&gt;

&lt;p&gt;I am resolving this issue, but given the continuing instability in other tests after adding calls to wait for post commit (such as SpaceTable.sql, see &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5133&quot; title=&quot;nightly test failure in derbyall/storeall/storemore/SpaceTable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5133&quot;&gt;&lt;del&gt;DERBY-5133&lt;/del&gt;&lt;/a&gt;), it is quite possible this does not address the instability. If the the OnlineCompressTest continues to have trouble, we can reopen this issue, or open a new one...&lt;/p&gt;</comment>
                            <comment id="14161817" author="rhillegas" created="Tue, 7 Oct 2014 13:10:59 +0100"  >&lt;p&gt;Re-opening this issue. We saw it again in last night&apos;s tests on the 10.10 branch on Solaris_amd64_jdk8: &lt;a href=&quot;http://download.java.net/javadesktop/derby/request_5597226/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.java.net/javadesktop/derby/request_5597226/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14162047" author="myrna" created="Tue, 7 Oct 2014 17:15:49 +0100"  >&lt;p&gt;I will backport the change to the 10.10 branch...&lt;/p&gt;</comment>
                            <comment id="14162121" author="jira-bot" created="Tue, 7 Oct 2014 18:04:35 +0100"  >&lt;p&gt;Commit 1629929 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/branches/10.10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1629929&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1629929&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6502&quot; title=&quot;Failure in OnlineCompressTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6502&quot;&gt;&lt;del&gt;DERBY-6502&lt;/del&gt;&lt;/a&gt;; Failure in OnlineCompressTest&lt;br/&gt;
  merge of revision 1592630 from trunk; adding wait for post commit calls&lt;/p&gt;</comment>
                            <comment id="14163882" author="myrna" created="Wed, 8 Oct 2014 19:05:25 +0100"  >&lt;p&gt;The test did not fail on this branch after the backport. Of course it&apos;s hard to say if it helped with an issue this intermittent.&lt;br/&gt;
I will resolve this again - if it pops up in 10.10 or above we can re-re-open.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12746192">DERBY-6759</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12599854">DERBY-5876</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12642891" name="DERBY-6502.diff" size="4181" author="myrna" created="Thu, 1 May 2014 21:00:55 +0100"/>
                            <attachment id="12633676" name="OnlineCompressTest.txt" size="8718" author="knutanders" created="Mon, 10 Mar 2014 11:24:17 +0000"/>
                            <attachment id="12633675" name="derby.log" size="87876" author="knutanders" created="Mon, 10 Mar 2014 11:24:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 10 Mar 2014 11:24:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>377762</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzmy2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>378054</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>