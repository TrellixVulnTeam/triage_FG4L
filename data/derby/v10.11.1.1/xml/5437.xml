<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:18:33 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5437/DERBY-5437.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5437] Load all toursdb tables in one invocation of ij</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5437</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The toursdb example database is built as part of &quot;ant all&quot;. Currently, java/demo/toursdb/build.xml invokes ij nine times, as well as a custom Java program (toursdb.insertMaps) once, to create the database, and all of these run in separate Java processes. This means the database engine is cold booted 10 times, which can take considerable time.&lt;/p&gt;

&lt;p&gt;There is already a script called loadTables.sql, which calls loadCOUNTRIES.sql, loadCITIES.sql, loadAIRLINES.sql, loadFLIGHTS1.sql, loadFLIGHTS2.sql, loadFLIGHTAVAILABILITY1.sql and loadFLIGHTAVAILABILITY2.sql. I propose that we use that script instead of invoking each of the sub-scripts separately. This would reduce the number of times the database engine would have to be booted from 10 to 4 per full build.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525169">DERBY-5437</key>
            <summary>Load all toursdb tables in one invocation of ij</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Sep 2011 12:14:19 +0100</created>
                <updated>Tue, 24 Jul 2012 18:26:08 +0100</updated>
                            <resolved>Thu, 6 Oct 2011 20:42:54 +0100</resolved>
                                    <version>10.9.1.0</version>
                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Demos/Scripts</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13117216" author="knutanders" created="Thu, 29 Sep 2011 12:21:23 +0100"  >&lt;p&gt;Attaching a patch that loads all the tables in one invocation of ij. This reduces the time it takes to run &quot;ant all&quot; in my environment by 30 seconds (from 1 min 40 sec to 1 min 10 sec).&lt;/p&gt;</comment>
                            <comment id="13117233" author="knutanders" created="Thu, 29 Sep 2011 13:12:11 +0100"  >&lt;p&gt;Oops... The patch doesn&apos;t actually load the tables. Looking at the log in generated/toursdb/toursdb.out, I see messages like this:&lt;/p&gt;

&lt;p&gt;run &apos;loadCOUNTRIES.sql&apos;;&lt;br/&gt;
IJ ERROR: File not found&lt;br/&gt;
ij&amp;gt; run &apos;loadCITIES.sql&apos;;&lt;br/&gt;
IJ ERROR: File not found&lt;br/&gt;
ij&amp;gt; run &apos;loadAIRLINES.sql&apos;;&lt;br/&gt;
IJ ERROR: File not found&lt;br/&gt;
ij&amp;gt; run &apos;loadFLIGHTS1.sql&apos;;&lt;br/&gt;
IJ ERROR: File not found&lt;br/&gt;
ij&amp;gt; run &apos;loadFLIGHTS2.sql&apos;;&lt;br/&gt;
IJ ERROR: File not found&lt;br/&gt;
ij&amp;gt; run &apos;loadFLIGHTAVAILABILITY1.sql&apos;;&lt;br/&gt;
IJ ERROR: File not found&lt;br/&gt;
ij&amp;gt; run &apos;loadFLIGHTAVAILABILITY2.sql&apos;;&lt;br/&gt;
IJ ERROR: File not found&lt;/p&gt;

&lt;p&gt;Probably because the working directory of the ij process isn&apos;t the directory in which the sql files live.&lt;/p&gt;

&lt;p&gt;While looking at the toursdb log, I also noticed an error that&apos;s also seen on a clean trunk, where the toursdb.insertMaps program doesn&apos;t find the database. Filed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5438&quot; title=&quot;Empty MAPS table in toursdb&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5438&quot;&gt;&lt;del&gt;DERBY-5438&lt;/del&gt;&lt;/a&gt; to track that problem.&lt;/p&gt;</comment>
                            <comment id="13117981" author="knutanders" created="Fri, 30 Sep 2011 12:28:04 +0100"  >&lt;p&gt;Attaching version 2 of the patch, which makes ij run with java/demo/toursdb as working directory (so that it finds the scripts invoked indirectly by loadTables.sql), and sets derby.system.home to make sure the database and derby.log ends up in the generated/toursdb directory.&lt;/p&gt;

&lt;p&gt;The patch also changes the toursdb.insertMaps class so that its main() method shuts down the database cleanly before exiting. This removes the need for a new invocation of ij just to perform recovery and shut down the database after on, so the disconnect.sql script could be removed from the source tree.&lt;/p&gt;

&lt;p&gt;The patch reduces the number of ij invocations from 9 to 1. Now that toursdb is actually built, it takes a little longer than with the previous patch, but I still see a 25 second speedup of &quot;ant all&quot; compared to a clean trunk.&lt;/p&gt;</comment>
                            <comment id="13122192" author="knutanders" created="Thu, 6 Oct 2011 20:42:54 +0100"  >&lt;p&gt;Committed revision 1179786.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12497143" name="d5437-2.diff" size="6260" author="knutanders" created="Fri, 30 Sep 2011 12:28:04 +0100"/>
                            <attachment id="12496993" name="d5437.diff" size="1435" author="knutanders" created="Thu, 29 Sep 2011 12:21:23 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39769</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0axj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35589</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>