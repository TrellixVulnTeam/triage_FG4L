<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:53:29 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2673/DERBY-2673.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2673] If derby.system.home does not exist Derby should only attempt to create that specific folder, not any missing parents (ie. use File.mkdir(), not File.mkdirs())</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2673</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Currently if the system property derby.system.home is set and the folder does not exist then derby will attempt to create the folder using File.mkdirs() on the value of derby.system.home.&lt;/p&gt;

&lt;p&gt;This operation actually requires &lt;b&gt;read&lt;/b&gt; permission on the parent directory (at least, maybe all folders in the path). E.g. when running the junit tests using ant:&lt;/p&gt;

&lt;p&gt; derby.system.home=/home/djd/derby/trunk/junit_20070518_1216/system&lt;/p&gt;

&lt;p&gt;and thus read permission is required on the parent&lt;/p&gt;

&lt;p&gt; /home/djd/derby/trunk/junit_20070518_1216&lt;/p&gt;

&lt;p&gt;The requirement to have this permission was added (I think) in JDK 1.5 and is intentional, see Sun bug 4932924&lt;/p&gt;

&lt;p&gt; &lt;a href=&quot;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4932924&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4932924&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The testing policy file does not include this permission thus some of the tests fail when running using ant. &lt;span class=&quot;error&quot;&gt;&amp;#91;I think most tests pass because the driver gets loaded outside of the security manager, thus allowing the mkdirs() to succeed.&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m not sure that this permission should simply be added to the test policy file. This would mean that users would also have to add such an entry in their policy file. Of course the entry would need to be the explicit parent path, I don&apos;t think $&lt;/p&gt;
{derby.system.home}${/}.. would be portable.&lt;br/&gt;
[actually&lt;br/&gt;
&lt;br/&gt;
The reason for not adding it is that from a security point of view it expands the range of files Derby can read to be outside of the ${derby.system.home}
&lt;p&gt;. I think being able to encapsulate Derby&apos;s permissions to files under $&lt;/p&gt;
{derby.system.home}
&lt;p&gt; is a better security model.&lt;/p&gt;

&lt;p&gt;The simple change in Derby behaviour that seems to fix this is to change the mkdirs() to a mkdir(). The visible change to users would be that parent folder of derby.system.home must exist, previously Derby would have created all non-existent parent directories.&lt;/p&gt;

&lt;p&gt;I think this is an acceptable change in behaviour for a security issue and unlikely to cause many issues for users. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12369715">DERBY-2673</key>
            <summary>If derby.system.home does not exist Derby should only attempt to create that specific folder, not any missing parents (ie. use File.mkdir(), not File.mkdirs())</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="djd">Daniel John Debrunner</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 May 2007 21:00:52 +0100</created>
                <updated>Tue, 30 Jun 2009 01:14:40 +0100</updated>
                            <resolved>Fri, 18 May 2007 23:11:44 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Services</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12497023" author="kmarsden" created="Fri, 18 May 2007 21:31:01 +0100"  >&lt;p&gt;The mkdirs() call in rg.apache.derby.impl.store.raw.RawStore.backup seems to be causing some of the Encryption failures in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2644&quot; title=&quot;multiple junit failures during nightly of the form: 2) Encryption Algorithm: defaultjava.security.AccessControlException: Access denied (java.util.PropertyPermission derby.system.home read)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2644&quot;&gt;&lt;del&gt;DERBY-2644&lt;/del&gt;&lt;/a&gt;.  Is it reasonable to change this to mkdir() as well or would we expect to be able to create the parent directories.&lt;/p&gt;</comment>
                            <comment id="12497034" author="djd" created="Fri, 18 May 2007 21:55:30 +0100"  >&lt;p&gt;I would have thought that for databases under derby.system.home (which is the case in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2644&quot; title=&quot;multiple junit failures during nightly of the form: 2) Encryption Algorithm: defaultjava.security.AccessControlException: Access denied (java.util.PropertyPermission derby.system.home read)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2644&quot;&gt;&lt;del&gt;DERBY-2644&lt;/del&gt;&lt;/a&gt;) then intermediate folders should be created.&lt;br/&gt;
Especially since the permission failing is stack traces is granted to derby.jar by the testing policy file, thus something else is going on.&lt;/p&gt;</comment>
                            <comment id="12497042" author="knutanders" created="Fri, 18 May 2007 22:10:12 +0100"  >&lt;p&gt;What about replacing file.mkdirs() with (file.mkdir() || file.mkdirs())? Wouldn&apos;t that preserve the old behaviour for those applications which need the parents to be created, and also remove the need for read permission if the parent directory exists?&lt;/p&gt;</comment>
                            <comment id="12497048" author="djd" created="Fri, 18 May 2007 22:34:59 +0100"  >&lt;p&gt;Interesting idea Knut Anders, I&apos;ll try it out.&lt;/p&gt;</comment>
                            <comment id="12497055" author="djd" created="Fri, 18 May 2007 23:00:53 +0100"  >&lt;p&gt;Knut Anders&apos; cool trick will mean no change in behaviour. Thanks!&lt;/p&gt;</comment>
                            <comment id="12497056" author="djd" created="Fri, 18 May 2007 23:11:44 +0100"  >&lt;p&gt;Committed revision 539614 - patch with code as described by Knu Anders (plus comments).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 18 May 2007 20:31:01 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23169</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0v6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38871</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>