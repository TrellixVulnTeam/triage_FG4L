<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:36:10 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1681/DERBY-1681.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1681] Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1681</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If Derby chooses to do a join between two FromTables and the right table is a chain of UNIONs, then the optimizer may choose to push the join predicate (if provided) down into the UNION and to both children of every UNION in the chain.  But if the predicate cannot be pushed to the children of any of the UNIONs (except the top-level one)  the predicate can end up being ignored altogether with respect to that UNION&apos;s children.  The result is that query execution can return rows that do not satisfy the predicate.&lt;/p&gt;

&lt;p&gt;This is a regression introduced in 10.1.2.4 and thus it affects 10.1.3 and 10.2.  I came across this while tracing through code for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12347828">DERBY-1681</key>
            <summary>Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="army">A B</assignee>
                                    <reporter username="army">A B</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Aug 2006 23:03:12 +0100</created>
                <updated>Mon, 5 Jul 2010 18:32:43 +0100</updated>
                            <resolved>Tue, 29 Aug 2006 19:46:46 +0100</resolved>
                                    <version>10.1.3.1</version>
                    <version>10.2.1.6</version>
                                    <fixVersion>10.1.3.3</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12427635" author="army" created="Fri, 11 Aug 2006 23:15:02 +0100"  >&lt;p&gt;Attaching three things to this issue:&lt;/p&gt;

&lt;p&gt;  1. A patch for the problem: d1681_v1.patch&lt;br/&gt;
  2. A patch for a test to verify the fix: d1681_test.patch&lt;br/&gt;
  3. A (short) description of the issue and the fix.&lt;/p&gt;

&lt;p&gt;The reason I&apos;ve separated the fix from the test is that the test case relies on database objects that are included in the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt;, and thus the test patch cannot be applied until the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt; has been applied.&lt;/p&gt;

&lt;p&gt;The actual fix to the problem, though-&lt;del&gt;i.e. d1681_v1.patch&lt;/del&gt;-can be applied and committed independently of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt;, and thus I&apos;ve separated it out.&lt;/p&gt;

&lt;p&gt;I ran derbyall on Red Hat Linux with ibm142 against SANE jars and there were no new failures.&lt;/p&gt;

&lt;p&gt;Both patches are ready for review and commit (with the caveat just noted about the test case).&lt;/p&gt;</comment>
                            <comment id="12428568" author="yipng" created="Thu, 17 Aug 2006 05:09:04 +0100"  >&lt;p&gt;I have reviewed the patch and the logic looks reasonable to me.  I think its ready to be committed.  +1&lt;/p&gt;</comment>
                            <comment id="12428776" author="mikem" created="Thu, 17 Aug 2006 20:52:37 +0100"  >&lt;p&gt;Reviewed and ran tests on this patch.  Committed to trunk:&lt;br/&gt;
m1_142:151&amp;gt;svn commit&lt;/p&gt;

&lt;p&gt;Sending        java\engine\org\apache\derby\impl\sql\compile\SetOperatorNode.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 432367.&lt;/p&gt;</comment>
                            <comment id="12428778" author="mikem" created="Thu, 17 Aug 2006 20:53:22 +0100"  >&lt;p&gt;changing fix in version as I believe this fix should be back ported to 10.1.&lt;/p&gt;</comment>
                            <comment id="12428818" author="mikem" created="Thu, 17 Aug 2006 23:41:59 +0100"  >&lt;p&gt;committed backport of change from trunk to 10.1:&lt;/p&gt;

&lt;p&gt;------------------------------------------------------------------------&lt;br/&gt;
r432414 | mikem | 2006-08-17 15:33:59 -0700 (Thu, 17 Aug 2006) | 20 lines&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1681&quot; title=&quot;Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1681&quot;&gt;&lt;del&gt;DERBY-1681&lt;/del&gt;&lt;/a&gt;, submitted by Army Brown&lt;/p&gt;

&lt;p&gt;Backporting svn r432367 from trunk into 10.1.&lt;/p&gt;

&lt;p&gt;Fixes the following issue:&lt;br/&gt;
If Derby chooses to do a join between two FromTables and the right table is a&lt;br/&gt;
chain of UNIONs, then the optimizer may choose to push the join predicate (if&lt;br/&gt;
provided) down into the UNION and to both children of every UNION in the chain.&lt;br/&gt;
But if the predicate cannot be pushed to the children of any of the UNIONs&lt;br/&gt;
(except the top-level one) the predicate can end up being ignored altogether&lt;br/&gt;
with respect to that UNION&apos;s children. The result is that query execution can&lt;br/&gt;
return rows that do not satisfy the predicate.&lt;/p&gt;

&lt;p&gt;This is a regression introduced in 10.1.2.4 and thus it affects 10.1.3 and 10.2.&lt;br/&gt;
I came across this while tracing through code for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For more detailed explanation of problem and solution see html doc attached to&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1681&quot; title=&quot;Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1681&quot;&gt;&lt;del&gt;DERBY-1681&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12430664" author="army" created="Fri, 25 Aug 2006 23:55:55 +0100"  >&lt;p&gt;Attaching a second version of the new test case for this issue.  The test changed as part of the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt; checkins and thus the patch had to be re-synced.&lt;/p&gt;

&lt;p&gt;Note that the test cases which were added for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt; actually already demonstrate the problem reported (and now fixed) in this issue.  However, I don&apos;t think it hurts to have a dedicated test case, so I still think  it would be good to commit d1681_tests_v2.patch to the trunk and 10.2 codelines (those are the codelines into which the fix for this issue has already been comitted).&lt;/p&gt;

&lt;p&gt;I&apos;m also working to port &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt; to 10.1; when that&apos;s done, the test patch for this issue should be ported to 10.1, as well.&lt;/p&gt;

&lt;p&gt;This is test-only patch: d1681_test_v2.patch is ready for commit.&lt;/p&gt;</comment>
                            <comment id="12430803" author="mikem" created="Sun, 27 Aug 2006 00:46:32 +0100"  >&lt;p&gt;I will look at committing these test changes to trunk and 10.2&lt;/p&gt;</comment>
                            <comment id="12430868" author="mikem" created="Sun, 27 Aug 2006 16:09:01 +0100"  >&lt;p&gt;committed d1681_test_v2.patch to trunk:&lt;/p&gt;

&lt;p&gt;m1_142:27&amp;gt;svn commit&lt;/p&gt;

&lt;p&gt;Sending        java\testing\org\apache\derbyTesting\functionTests\master\predicatePushdown.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\lang\predicatePushdown.sql&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 437380.&lt;/p&gt;</comment>
                            <comment id="12430907" author="mikem" created="Mon, 28 Aug 2006 01:33:42 +0100"  >&lt;p&gt;backported and committed patch d1681_test_v2.patch from trunk to 10.2 branch:&lt;/p&gt;

&lt;p&gt;r437487 | mikem | 2006-08-27 17:34:07 -0700 (Sun, 27 Aug 2006) | 14 lines&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1681&quot; title=&quot;Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1681&quot;&gt;&lt;del&gt;DERBY-1681&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
merging change 437380 from trunk to 10.2 branch:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1691&quot; title=&quot;jdbcapi/blobclob4BLOB.java fails under DerbyNet framework with JCC 2.6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1691&quot;&gt;&lt;del&gt;DERBY-1691&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
contributed by Army Brown&lt;/p&gt;

&lt;p&gt;Adding extra tests for this issue, fix already committed.&lt;/p&gt;

&lt;p&gt;Note that the test cases which were added for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt; actually already&lt;br/&gt;
demonstrate the problem reported (and now fixed) in this issue. This checkin&lt;br/&gt;
is a dedicated test case for this issue.&lt;/p&gt;</comment>
                            <comment id="12431007" author="army" created="Mon, 28 Aug 2006 17:43:23 +0100"  >&lt;p&gt;Thanks for commiting the new test case to trunk and 10.2, Mike.  Since the changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1633&quot; title=&quot;Regression: The fields of views are not being calculated properly since 10.1.2.4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1633&quot;&gt;&lt;del&gt;DERBY-1633&lt;/del&gt;&lt;/a&gt; have now been ported to 10.1 (thank you for that, too, Mike!), can the test case for this issue go to 10.1, as well?  It should be a simple merge:&lt;/p&gt;

&lt;p&gt;svn merge -r 437379:437380 &lt;a href=&quot;http://svn.apache.org/repos/asf/db/derby/code/trunk&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/repos/asf/db/derby/code/trunk&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also, one small note: it looks there&apos;s a typo in the Jira issue for the svn commit logs with the d1681_test_v2.patch: there are a couple of references to &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1691&quot; title=&quot;jdbcapi/blobclob4BLOB.java fails under DerbyNet framework with JCC 2.6&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1691&quot;&gt;&lt;del&gt;DERBY-1691&lt;/del&gt;&lt;/a&gt;&quot; instead of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1681&quot; title=&quot;Regression (wrong results): Join predicate can be ignored for left-most child in a chain of nested unions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1681&quot;&gt;&lt;del&gt;DERBY-1681&lt;/del&gt;&lt;/a&gt;&quot;.  Perhaps these can be corrected?&lt;/p&gt;</comment>
                            <comment id="12431310" author="mikem" created="Tue, 29 Aug 2006 19:07:22 +0100"  >&lt;p&gt;merged test case from trunk to 10.1 branch:&lt;/p&gt;

&lt;p&gt;437380&lt;/p&gt;

&lt;p&gt;m101_142:9&amp;gt;svn commit&lt;/p&gt;

&lt;p&gt;Sending        java\testing\org\apache\derbyTesting\functionTests\master\predicatePushdown.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\lang\predicatePushdown.sql&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 438138.&lt;/p&gt;</comment>
                            <comment id="12431313" author="army" created="Tue, 29 Aug 2006 19:24:04 +0100"  >&lt;p&gt;Reopening to update Fixin to include trunk (10.3)&lt;/p&gt;</comment>
                            <comment id="12431314" author="army" created="Tue, 29 Aug 2006 19:25:09 +0100"  >&lt;p&gt;Fix and tests for this issue have not been commited to 10.1, 10.2, and 10.3 branches (thanks Mike and Rick).  Un-checking the &quot;patch available&quot; flag and resolving the issue.&lt;/p&gt;</comment>
                            <comment id="12431315" author="army" created="Tue, 29 Aug 2006 19:26:00 +0100"  >&lt;p&gt;oops, typo:&lt;/p&gt;

&lt;p&gt;&quot;have not been committed to...&quot;&lt;/p&gt;

&lt;p&gt;should be&lt;/p&gt;

&lt;p&gt;&quot;have now been committed to...&quot;&lt;/p&gt;</comment>
                            <comment id="12431316" author="mikem" created="Tue, 29 Aug 2006 19:26:09 +0100"  >&lt;p&gt;I fixed the typo&apos;s that I could see, if there are any others let me know.  Not a svn expert, you may have to svn update to see changes - not sure.  Easiest if you give the svn rev number of the problem log,  it is very easy to edit them:  ie. svn propedit svn:log --revprop -r 437487, pops you into an edit window like svn commit.&lt;/p&gt;</comment>
                            <comment id="12431320" author="army" created="Tue, 29 Aug 2006 19:46:28 +0100"  >&lt;p&gt;Looks like I was making changes the same time Mike was, and our changes clashed.  So I&apos;m reopening (again) to correct fix-in and uncheck patch available...&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12338734" name="DERBY-1681_v1.html" size="21856" author="army" created="Fri, 11 Aug 2006 23:15:02 +0100"/>
                            <attachment id="12338733" name="d1681_test.patch" size="5151" author="army" created="Fri, 11 Aug 2006 23:15:02 +0100"/>
                            <attachment id="12339622" name="d1681_test_v2.patch" size="4994" author="army" created="Fri, 25 Aug 2006 23:55:55 +0100"/>
                            <attachment id="12338732" name="d1681_v1.patch" size="2768" author="army" created="Fri, 11 Aug 2006 23:15:02 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10420"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 17 Aug 2006 04:09:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22635</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10101"><![CDATA[Release Note Needed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0ppj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37983</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10050"><![CDATA[Blocker]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>