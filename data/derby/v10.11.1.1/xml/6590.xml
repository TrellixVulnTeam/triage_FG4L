<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:24:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6590/DERBY-6590.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6590] Make JUnit tests run the fixtures in a deterministic order.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6590</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Since JDK 7, when we use the standard decorator for JUnit tests, e.g.&lt;/p&gt;

&lt;p&gt;return TestConfiguration.defaultSuite(AggBuiltinTest.class);&lt;/p&gt;

&lt;p&gt;the order in which the test fixtures get run is indeterministic. This is undesirable because it doesn&apos;t add much coverage to the product and makes the tests more brittle than they need to be.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12717065">DERBY-6590</key>
            <summary>Make JUnit tests run the fixtures in a deterministic order.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 May 2014 16:24:52 +0100</created>
                <updated>Tue, 8 Jul 2014 15:48:45 +0100</updated>
                            <resolved>Tue, 8 Jul 2014 15:48:45 +0100</resolved>
                                                    <fixVersion>10.11.1.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="14049263" author="dagw" created="Tue, 1 Jul 2014 21:16:35 +0100"  >&lt;p&gt;I am testing out a preliminary patch using a new DerbyTestSuite class that extends JUnit TestSuite. When using a Class argument in its constructor or in its addTestSuite method, it would order the fixtures, e.g. in this way:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class DerbyTestSuite &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; TestSuite {
    
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DerbyTestSuite() {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;();
    }
    
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DerbyTestSuite(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name) {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(name);
    }
    
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DerbyTestSuite(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; cls, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name) {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(name);
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.addTest(TestConfiguration.orderedSuite(cls));
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DerbyTestSuite(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; cls) {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(TestConfiguration.suiteName(cls));
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.addTest(TestConfiguration.orderedSuite(cls));
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void addTestSuite(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt; cls) {
        Test ts = TestConfiguration.orderedSuite(cls);
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.addTest(ts);
    }
    
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14050851" author="dagw" created="Thu, 3 Jul 2014 00:10:25 +0100"  >&lt;p&gt;Attaching a patch for this issue: &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12653717/12653717_derby-6590-1.diff&quot; title=&quot;derby-6590-1.diff attached to DERBY-6590&quot;&gt;derby-6590-1.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;. From its local Git commit message:&lt;/p&gt;

&lt;p&gt;A new test suite class is introduced to replace the standard JUnit TestSuite: DerbyTestSuite. From its Javadoc:&lt;/p&gt;
&lt;blockquote&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/**
 * Derby replacement &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; TestSuite. This version, when provided with a
 * {@code &lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;} argument in a constructor or method, wraps a {@code TestSuite}
 * around a lexicographically sorted set of fixtures to avoid random fixture
 * ordering after Java 6. It is a somewhat leaky abstraction: a call to
 * {@code tests()} will &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the wrapped {@code TestSuite} instead of
 * the tests of the provided class argument}. So in order to locate the
 * tests, a client of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; class must step one further step down, i.e. ask &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;
 * the tests of that wrapped {@code TestSuite}. Except &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, its usage
 * should be straight forward, similar to the original TestSuite.
 */
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;For an example of the changed semantics in &quot;tests()&quot;, cf the change to StatementEventsTest in this patch.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;All tests have been modified to use the new class. If we decide to commit this patch, new JUnit tests should all use the new test suite class in order to retain the deterministic ordering of the regression tests. I have verified that all tests are still performed (manually: in my environment I see 19023 tests in &quot;suites.All&quot; and 122 in the harness &quot;derbyall&quot; - with Java 8). &lt;/p&gt;</comment>
                            <comment id="14051209" author="knutanders" created="Thu, 3 Jul 2014 09:50:50 +0100"  >&lt;p&gt;Thanks, Dag. The changes look fine to me.&lt;/p&gt;

&lt;p&gt;Maybe it would be better to invert the relationship between DerbyTestSuite and TestConfiguration.orderedSuite(). That is, move the implementation from orderedSuite() into DerbyTestSuite, and make orderedSuite() return a DerbyTestSuite. The advantage is that the test cases will be added directly to the DerbyTestSuite instance, and not wrapped in an extra TestSuite, so that we don&apos;t need hacks to see through the wrapper, like in StatementEventsTest.&lt;/p&gt;

&lt;p&gt;Should perhaps the new class be called BaseTestSuite instead, so that it&apos;s consistent with BaseTestCase and BaseTestSetup?&lt;/p&gt;</comment>
                            <comment id="14051364" author="dagw" created="Thu, 3 Jul 2014 13:00:43 +0100"  >&lt;p&gt;Thanks, Knut. That&apos;s a good improvement. In fact, I removed TestConfiguration.orderedSuite altogether, replacing it with the new class. Patch &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12653817/12653817_derby-6590-2.diff&quot; title=&quot;derby-6590-2.diff attached to DERBY-6590&quot;&gt;derby-6590-2.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;, re-running regressions.&lt;/p&gt;</comment>
                            <comment id="14051895" author="dagw" created="Thu, 3 Jul 2014 21:42:21 +0100"  >&lt;p&gt;Regressions of the latest patch ran without errors.&lt;/p&gt;</comment>
                            <comment id="14052357" author="knutanders" created="Fri, 4 Jul 2014 12:12:14 +0100"  >&lt;p&gt;Thanks, Dag. The #2 patch looks good to me. One nit: The javadoc comment for the BaseTestSuite class still says that a TestSuite will be wrapped around the test cases.&lt;/p&gt;</comment>
                            <comment id="14052400" author="dagw" created="Fri, 4 Jul 2014 13:21:47 +0100"  >&lt;p&gt;Oops, was sure I had changed that. Thanks! Now I just need to clean up the import sections.... &lt;/p&gt;</comment>
                            <comment id="14053665" author="dagw" created="Mon, 7 Jul 2014 14:53:30 +0100"  >&lt;p&gt;Adding a third version of the patch, which also cleans up the import section of the tests touched by this change. &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12654313/12654313_derby-6590-3.zip&quot; title=&quot;derby-6590-3.zip attached to DERBY-6590&quot;&gt;derby-6590-3.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="14054948" author="jira-bot" created="Tue, 8 Jul 2014 14:51:57 +0100"  >&lt;p&gt;Commit 1608782 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dagw&quot; class=&quot;user-hover&quot; rel=&quot;dagw&quot;&gt;Dag H. Wanvik&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1608782&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1608782&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6590&quot; title=&quot;Make JUnit tests run the fixtures in a deterministic order.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6590&quot;&gt;&lt;del&gt;DERBY-6590&lt;/del&gt;&lt;/a&gt; Make JUnit tests run the fixtures in a deterministic order.&lt;/p&gt;

&lt;p&gt;A new test suite class is introduced to replace the standard JUnit&lt;br/&gt;
TestSuite: BaseTestSuite. From its Javadoc:&lt;/p&gt;

&lt;p&gt;/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Derby replacement for TestSuite. This version, when provided with a&lt;/li&gt;
	&lt;li&gt;{@code Class}
&lt;p&gt; argument in a constructor or method, wraps a &lt;/p&gt;
{@code TestSuite}&lt;/li&gt;
	&lt;li&gt;around a lexicographically sorted set of fixtures (i.e. test cases) to avoid&lt;/li&gt;
	&lt;li&gt;random fixture ordering (after Java 6). Its usage is similar to the original&lt;/li&gt;
	&lt;li&gt;JUnit TestSuite class.&lt;br/&gt;
 */&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The old TestConfiguration#orderedSuite has been removed. Import&lt;br/&gt;
sections have been updated.&lt;/p&gt;</comment>
                            <comment id="14054999" author="jira-bot" created="Tue, 8 Jul 2014 15:47:15 +0100"  >&lt;p&gt;Commit 1608810 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dagw&quot; class=&quot;user-hover&quot; rel=&quot;dagw&quot;&gt;Dag H. Wanvik&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1608810&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1608810&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6590&quot; title=&quot;Make JUnit tests run the fixtures in a deterministic order.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6590&quot;&gt;&lt;del&gt;DERBY-6590&lt;/del&gt;&lt;/a&gt; Make JUnit tests run the fixtures in a deterministic order.&lt;/p&gt;

&lt;p&gt;Javadoc fix.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12653717" name="derby-6590-1.diff" size="653673" author="dagw" created="Thu, 3 Jul 2014 00:10:25 +0100"/>
                            <attachment id="12653817" name="derby-6590-2.diff" size="659851" author="dagw" created="Thu, 3 Jul 2014 13:23:06 +0100"/>
                            <attachment id="12654313" name="derby-6590-3.zip" size="96689" author="dagw" created="Mon, 7 Jul 2014 14:53:30 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 3 Jul 2014 08:50:50 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>395273</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzpwt3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>395404</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>