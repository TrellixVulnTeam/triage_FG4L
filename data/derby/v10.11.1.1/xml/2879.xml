<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:11:52 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2879/DERBY-2879.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2879] CREATE TABLE AS &lt;subquery&gt; does not maintain the collation for character types.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2879</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;create table t as select tablename from sys.systables with no data;&lt;/p&gt;

&lt;p&gt;This creates a column TABLENAME with collation based upon the user schema, but the type of  sys.systables.tablename has collation UCS_BASIC.&lt;/p&gt;

&lt;p&gt;The required behaviour should be verified with the SQL standard (11.3 SR6), but since collation is an attribute of a type it seems logical that the collation is maintained by the create.&lt;/p&gt;

&lt;p&gt;Fixing this to keep the collation of the system column will cause problems though as there would be no way to recreate this table through a regular create table, say if the schema is dumped and recreated using ddlutils.&lt;/p&gt;

&lt;p&gt;I think this is critical as fixing it after a release would lead to a change in behaviour for applications.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12372511">DERBY-2879</key>
            <summary>CREATE TABLE AS &lt;subquery&gt; does not maintain the collation for character types.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mamtas">Mamta A. Satoor</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Jun 2007 15:18:03 +0100</created>
                <updated>Mon, 2 Jul 2007 19:05:14 +0100</updated>
                            <resolved>Mon, 2 Jul 2007 19:05:07 +0100</resolved>
                                    <version>10.3.1.4</version>
                    <version>10.4.1.3</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12508562" author="djd" created="Wed, 27 Jun 2007 15:23:55 +0100"  >&lt;p&gt;A simple approach for 10.3 would be to disable creating user tables with UCS_BASIC collations when the schema collation is no UCS_BASIC. The approach taken in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2605&quot; title=&quot;You can create BOOLEAN columns in 10.3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2605&quot;&gt;&lt;del&gt;DERBY-2605&lt;/del&gt;&lt;/a&gt; may help.&lt;/p&gt;</comment>
                            <comment id="12509607" author="mamtas" created="Mon, 2 Jul 2007 17:24:58 +0100"  >&lt;p&gt;With the revision 552531, changes have been committed for this Jira entry and a minor cleanup is done. The commit comments as copied below has the details. Will soon commit this change in Derby 10.3.1.1 codeline.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2879&quot; title=&quot;CREATE TABLE AS &amp;lt;subquery&amp;gt; does not maintain the collation for character types.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2879&quot;&gt;&lt;del&gt;DERBY-2879&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Derby currently requires all the character columns in a table to have the same collation as the collation of the schema in&lt;br/&gt;
which the table is getting defined. In order to implement this behavior, CreateTableNods&apos;s bind method will check the&lt;br/&gt;
collation of it&apos;s character columns against the schema&apos;s collation and if there is a mismatch, an exception will be thrown.&lt;/p&gt;

&lt;p&gt;In addition, this patch does minor cleanup. The string constants for the 2 collation types in Derby were declared in both&lt;br/&gt;
StringDataValue.java and Property.java I have removed it from StringDataValue so we don&apos;t have duplicate constants.&lt;/p&gt;</comment>
                            <comment id="12509609" author="mamtas" created="Mon, 2 Jul 2007 17:29:41 +0100"  >&lt;p&gt;Changes merged into 10.3.1.1 codeline with revision 552534.&lt;/p&gt;</comment>
                            <comment id="12509612" author="mamtas" created="Mon, 2 Jul 2007 17:37:51 +0100"  >&lt;p&gt;I have checked in following code in CreateTableNode&lt;br/&gt;
+                                       (schemaCollationType ==&lt;br/&gt;
+                                               StringDataValue.COLLATION_TYPE_UCS_BASIC ?&lt;br/&gt;
+                                       Property.UCS_BASIC_COLLATION :&lt;br/&gt;
+                                       Property.TERRITORY_BASED_COLLATION);&lt;/p&gt;

&lt;p&gt;Basically, the code above is trying to find the string representation for the int collation type so that string can be used in the exception that will be thrown. There is similar code to get string representation from the TypeDescriptor&apos;s collaiton type in TypeDescriptorImpl.java which is as follows&lt;br/&gt;
public String getCollationName()&lt;/p&gt;
    {
        return(
            collationType == StringDataValue.COLLATION_TYPE_UCS_BASIC ? 
                Property.UCS_BASIC_COLLATION : 
                Property.TERRITORY_BASED_COLLATION);
    }

&lt;p&gt;I wonder if there is any common utility class where I can move this logic from TypeDescriptorImpl and CreateTableNode so the code is not duplicated. Please let me know if there is any recommendation for where I can move this code. &lt;/p&gt;</comment>
                            <comment id="12509634" author="mamtas" created="Mon, 2 Jul 2007 19:05:07 +0100"  >&lt;p&gt;Closing this issue.&lt;/p&gt;

&lt;p&gt;Entered a new Jira entry for the code cleanup for duplication of code to get string representation from an int collation type. That jira entry is &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2889&quot; title=&quot;Code cleanup : remove duplicate code from TypeDescriptorImpl and CreateTableNode wich gets string representation of an int collation type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2889&quot;&gt;DERBY-2889&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12368561">DERBY-2605</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12345445">DERBY-1478</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 2 Jul 2007 16:24:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23296</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy11jb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39899</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>