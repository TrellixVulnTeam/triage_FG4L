<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:43:21 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1069/DERBY-1069.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1069] Client should unwrap exceptions thrown in privilege blocks rather than throwing the java.security.PrivilegedActionException</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1069</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Can lead to misunderstanding the root cause of the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12329563">DERBY-1069</key>
            <summary>Client should unwrap exceptions thrown in privilege blocks rather than throwing the java.security.PrivilegedActionException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davidvc">David Van Couvering</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Mar 2006 05:20:05 +0000</created>
                <updated>Thu, 13 Dec 2007 09:04:49 +0000</updated>
                            <resolved>Tue, 6 Jun 2006 07:08:18 +0100</resolved>
                                                    <fixVersion>10.1.3.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12414321" author="davidvc" created="Fri, 2 Jun 2006 07:54:56 +0100"  >&lt;p&gt;I search for all instances of PrivilegedActionException in the trunk, and all these appear to be correcty unwrapping the exception.  I&apos;ll check the 10.1 code base.&lt;/p&gt;</comment>
                            <comment id="12414326" author="kmarsden" created="Fri, 2 Jun 2006 08:22:20 +0100"  >&lt;p&gt;on 10.2 if I  connect without network server up I see the  java.security.PrivilegedActionException in the message.&lt;/p&gt;

&lt;p&gt;ij&amp;gt;  connect &apos;jdbc:derby://localhost:1527/wombat&apos;;&lt;br/&gt;
ERROR 08001: java.security.PrivilegedActionException : Error connecting to server localhost on port 1,527 with message Connection refused: connect.&lt;/p&gt;</comment>
                            <comment id="12414331" author="davidvc" created="Fri, 2 Jun 2006 08:42:36 +0100"  >&lt;p&gt;Hm.  In the source code I have:&lt;/p&gt;

&lt;p&gt;        try &lt;/p&gt;
{
            socket_ = (java.net.Socket) java.security.AccessController.doPrivileged(new OpenSocketAction(server, port));
        }
&lt;p&gt; catch (java.security.PrivilegedActionException e) {&lt;br/&gt;
            throw new DisconnectException(this,&lt;br/&gt;
                new ClientMessageId(SQLState.CONNECT_UNABLE_TO_CONNECT_TO_SERVER),&lt;br/&gt;
                new Object[] &lt;/p&gt;
{ e.getClass().getName(), server, new Integer(port), 
                    e.getException().getMessage() }
&lt;p&gt;,&lt;br/&gt;
                e.getException());&lt;br/&gt;
        }&lt;/p&gt;


&lt;p&gt;So, we are unwrapping the exception to get the message, and chaining the unwrapped exception.  However, the name of the original exception is not used as the first parameter in the Object array.  That I can fix.&lt;/p&gt;

&lt;p&gt;But, what happens to the stack trace when you use ij?  Do you have to enable logging to see it?&lt;/p&gt;</comment>
                            <comment id="12414334" author="davidvc" created="Fri, 2 Jun 2006 08:47:28 +0100"  >&lt;p&gt;OK, with a fix to the above code, I have in ij:&lt;/p&gt;

&lt;p&gt;ij version 10.2&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby://localhost:1527/wombat&apos;;&lt;br/&gt;
ERROR 08001: java.net.ConnectException : Error connecting to server localhost on port 1,527 with message Connection refused.&lt;br/&gt;
ij&amp;gt;&lt;/p&gt;

&lt;p&gt;Is this what we are looking for?&lt;/p&gt;</comment>
                            <comment id="12414335" author="djd" created="Fri, 2 Jun 2006 09:10:09 +0100"  >&lt;p&gt;Looks good, directs people to the actual problem, rather than confusing them.&lt;/p&gt;</comment>
                            <comment id="12414539" author="davidvc" created="Sat, 3 Jun 2006 07:44:29 +0100"  >&lt;p&gt;Fixed in 10.2, revision 41136.  Need to do a similar fix in the 10.1 branch&lt;/p&gt;</comment>
                            <comment id="12414878" author="davidvc" created="Tue, 6 Jun 2006 07:08:18 +0100"  >&lt;p&gt;Fixed in the 10.1 branch as well now.  Here&apos;s the new output from ij:&lt;/p&gt;

&lt;p&gt;ERROR (no SQLState): java.net.ConnectException : Error opening socket to server localhost on port 1527 with message : Connection refused&lt;/p&gt;

&lt;p&gt;In the trunk you get an actual SQL state, and the trace file will contain the stack trace with all causes.  Note I also fixed the port number so it is formatted correctly.&lt;/p&gt;</comment>
                            <comment id="12414884" author="kmarsden" created="Tue, 6 Jun 2006 08:03:05 +0100"  >&lt;p&gt;Adding 10.1.2.5  for the current snapshot version.&lt;br/&gt;
Thanks David for the fix!&lt;/p&gt;
</comment>
                            <comment id="12551317" author="fuzzylogic" created="Thu, 13 Dec 2007 09:04:49 +0000"  >&lt;p&gt;This issue has been resolved for over a year with no further movement. Closing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 2 Jun 2006 06:54:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22291</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy10d3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39709</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>