<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:21:10 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1958/DERBY-1958.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1958] improve XSDG3 error to print container, actual i/o operation, and file name.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1958</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The current error does not give enough information to know what container is the problem:&lt;br/&gt;
ERROR XSDG3: Meta-data for Container&lt;br/&gt;
org.apache.derby.impl.store.raw.data.RAFContainer@10632cd could not be&lt;br/&gt;
accessed &lt;/p&gt;</description>
                <environment></environment>
        <key id="12353087">DERBY-1958</key>
            <summary>improve XSDG3 error to print container, actual i/o operation, and file name.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eranda">Eranda Sooriyabandara</assignee>
                                    <reporter username="mikem">Mike Matrigali</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Oct 2006 18:37:18 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:27 +0100</updated>
                            <resolved>Thu, 26 Aug 2010 15:01:33 +0100</resolved>
                                    <version>10.1.3.1</version>
                    <version>10.2.1.6</version>
                    <version>10.3.1.4</version>
                                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12880879" author="eranda" created="Mon, 21 Jun 2010 17:24:41 +0100"  >&lt;p&gt;Hi,&lt;br/&gt;
What is the reason for this exception? and how can I reproduce it?&lt;br/&gt;
thanks&lt;br/&gt;
Eranda&lt;/p&gt;</comment>
                            <comment id="12880892" author="mikem" created="Mon, 21 Jun 2010 18:02:25 +0100"  >&lt;p&gt;This is an issue that &quot;should not happen.&quot;  You can search JIRA for XSDG3 to see the reported issues where this exception has been thrown, but I believe all the reproducible cases have been fixed.  I reported this so that if we get another bug in the future the error at least the error will be more descriptive.&lt;/p&gt;

&lt;p&gt;If you are interested in fixing, I would find somewhere in the code that throws this&lt;br/&gt;
exception and in your private codeline change it so that the code always throws this&lt;br/&gt;
error so that you can hand test the error message change.  I don&apos;t know of any way&lt;br/&gt;
to cause this in a correctly running current system.&lt;/p&gt;</comment>
                            <comment id="12881037" author="eranda" created="Tue, 22 Jun 2010 04:13:00 +0100"  >&lt;p&gt;Hi Mike,&lt;br/&gt;
Yes I like to have a try. If you can provide me a code which trows that exception that would be much appreciated.&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="12881064" author="bryanpendleton" created="Tue, 22 Jun 2010 05:55:36 +0100"  >&lt;p&gt;Hi Eranda,&lt;br/&gt;
I did a somewhat similar private alteration to Derby for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3729&quot; title=&quot;Error message is rather unrevealing when creating large databases on FAT32 drives&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3729&quot;&gt;&lt;del&gt;DERBY-3729&lt;/del&gt;&lt;/a&gt;,&lt;br/&gt;
so hopefully looking at that work will be a good place to start.&lt;/p&gt;

&lt;p&gt;If you look through the comments and attachments to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3729&quot; title=&quot;Error message is rather unrevealing when creating large databases on FAT32 drives&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3729&quot;&gt;&lt;del&gt;DERBY-3729&lt;/del&gt;&lt;/a&gt;,&lt;br/&gt;
and in particular this comment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3729?focusedCommentId=12829808&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_12829808&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/DERBY-3729?focusedCommentId=12829808&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_12829808&lt;/a&gt;&lt;br/&gt;
I think you should be able to get some ideas about how to make a&lt;br/&gt;
similar modification in order to expose this XSDG3 error message.&lt;/p&gt;

&lt;p&gt;Of course, whereas I modified CachedPage.java, you&apos;ll want to make&lt;br/&gt;
a modification somewhere in RAFContainer.java instead. But the basic&lt;br/&gt;
principles of the technique should be the same.&lt;/p&gt;
</comment>
                            <comment id="12884764" author="eranda" created="Fri, 2 Jul 2010 19:18:12 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Can I know for what sql commands this readPage and writePage methods in RAFContainer class are called?&lt;br/&gt;
thanks&lt;br/&gt;
Eranda&lt;/p&gt;</comment>
                            <comment id="12884816" author="bryanpendleton" created="Fri, 2 Jul 2010 22:36:25 +0100"  >&lt;p&gt;Almost all SQL commands will end up calling readPage, and almost all&lt;br/&gt;
update commands will end up calling writePage. Try:&lt;/p&gt;

&lt;p&gt;  create table t (a i)&lt;br/&gt;
  insert into t values (1), (2), (3)&lt;/p&gt;

&lt;p&gt;This should call both readPage and writePage a number of times.&lt;/p&gt;</comment>
                            <comment id="12884946" author="eranda" created="Sat, 3 Jul 2010 17:52:58 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
I put breakpoints at the beginning of the pageRead and pageWrite methods and execute those commands but it did not hit. Do I need to set something to get it work? &lt;br/&gt;
thanks&lt;/p&gt;</comment>
                            <comment id="12884958" author="bryanpendleton" created="Sat, 3 Jul 2010 19:24:32 +0100"  >&lt;p&gt;Hi Eranda, Sorry about that, I should have tried it first not just guessed.&lt;/p&gt;

&lt;p&gt;It looks like readPage and writePage in RAFContainer are overridden&lt;br/&gt;
by readPage and writePage in RAFContainer4, and it looks like we always&lt;br/&gt;
use RAFContainer4 for any JDK 1.4+ configuration. Mike or Knut Anders or somebody&lt;br/&gt;
else who&apos;s familiar with the store can probably confirm this for sure.&lt;/p&gt;

&lt;p&gt;There is a class called BaseDataFileFactoryJ4 which arranges for this&lt;br/&gt;
overriding, though, and so I was able to re-point the store to use the&lt;br/&gt;
RAFContainer rather than the RAFContainer4 by simply making this change&lt;br/&gt;
to BaseDataFileFactoryJ4:&lt;/p&gt;

&lt;p&gt;&amp;#8212; java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactoryJ4.java(revision 958595)&lt;br/&gt;
+++ java/engine/org/apache/derby/impl/store/raw/data/BaseDataFileFactoryJ4.java(working copy)&lt;br/&gt;
@@ -42,6 +42,6 @@&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;objects capable of exploiting the NIO API available in Java 1.4+&lt;br/&gt;
      */&lt;br/&gt;
     protected Cacheable newRAFContainer(BaseDataFileFactory factory) 
{
-        return new RAFContainer4(factory);
+        return new RAFContainer(factory);
     }
&lt;p&gt; }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Once I did this, I started to hit the readPage and writePage methods in RAFContainer.&lt;/p&gt;

&lt;p&gt;Now, I&apos;m not totally sure what the implications of this are. Since (I believe) Derby&lt;br/&gt;
no longer supports any JDK version prior to JDK 1.4 (I think Derby 10.2 was the&lt;br/&gt;
last version that supported JDK 1.3 &amp;#8211; see &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1982&quot; title=&quot;Remove support for JDK 1.3 in 10.3 and onwards&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1982&quot;&gt;&lt;del&gt;DERBY-1982&lt;/del&gt;&lt;/a&gt;), if RAFContainer is ONLY&lt;br/&gt;
used for JDK 1.3, then perhaps we should just remove RAFContainer, rather&lt;br/&gt;
than trying to fix it.&lt;/p&gt;

&lt;p&gt;Does the problematic XSDG3 message arise in RAFContainer4 as well?&lt;/p&gt;

&lt;p&gt;I did a quick search for FILE_CONTAINER_EXCEPTION in the code, and maybe&lt;br/&gt;
the message only occurs in RAFContainer, but it would be nice if somebody else&lt;br/&gt;
could confirm these analyses.&lt;/p&gt;

&lt;p&gt;Basically, the question is: can we just remove RAFContainer (or, at least,&lt;br/&gt;
RAFContainer.readPage and RAFContainer.writePage), now that we no longer&lt;br/&gt;
support JDK 1.3?&lt;/p&gt;

</comment>
                            <comment id="12884964" author="knutanders" created="Sat, 3 Jul 2010 21:12:27 +0100"  >&lt;p&gt;RAFContainer is still used on J2ME, since java.nio.* is not part of&lt;br/&gt;
the CDC Foundation Profile.&lt;/p&gt;

&lt;p&gt;I think RAFContainer4 can end up throwing this exception too, since it&lt;br/&gt;
inherits many methods from RAFContainer, and some of the overridden&lt;br/&gt;
methods also call methods in the super-class. One example is the stack&lt;br/&gt;
trace in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3688&quot; title=&quot;multiple db instance and ERROR XSDG3: Meta-data for Container org.apache.derby.impl.store.raw.data.RAFContainer4@d1cfbb could not be accessed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3688&quot;&gt;&lt;del&gt;DERBY-3688&lt;/del&gt;&lt;/a&gt;, where RAFContainer4.openContainer() calls&lt;br/&gt;
RAFContainer.openContainer() and ends up raising this error.&lt;/p&gt;

&lt;p&gt;It may be difficult to predict exactly which SQL statements end up&lt;br/&gt;
calling readPage() and writePage() because of the page cache. If the&lt;br/&gt;
database is small, you&apos;ll probably only see calls to readPage() when&lt;br/&gt;
you access data for the first time. writePage() should normally only&lt;br/&gt;
be called during checkpoint/shutdown, when a page is evicted from the&lt;br/&gt;
cache to give room for another page, or when a new page is created.&lt;/p&gt;</comment>
                            <comment id="12885380" author="bryanpendleton" created="Tue, 6 Jul 2010 02:07:44 +0100"  >&lt;p&gt;Thanks Knut, that makes sense.&lt;/p&gt;

&lt;p&gt;It seems to me that the best approach for this particular issue, then, is:&lt;br/&gt;
1) Using a custom version of BaseDataFileFactoryJ4, as described&lt;br/&gt;
above, force the code through RAFContainer.readPage/writePage&lt;br/&gt;
2) Using a custom version of RAFContainer, force readPage/writePage&lt;br/&gt;
to generate the XSDG3 error&lt;br/&gt;
3) Verify that the new message is formatted as expected, and&lt;br/&gt;
contains the expected information&lt;br/&gt;
4) Commit the changes with the improved error message, and&lt;br/&gt;
declare this issue complete.&lt;/p&gt;

&lt;p&gt;Eranda, does this strategy seem reasonable?&lt;/p&gt;</comment>
                            <comment id="12885468" author="eranda" created="Tue, 6 Jul 2010 09:56:46 +0100"  >&lt;p&gt;If RAFContainer is in use I can&apos;t see any problem of doing so. I&apos;ll start the working on it.&lt;br/&gt;
Thanks for the ideas. &lt;/p&gt;</comment>
                            <comment id="12885498" author="eranda" created="Tue, 6 Jul 2010 12:10:55 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
writePage is used only when create the connection, create a table and shutdown the connection. When I insert a value to a table both methods were not called. Also I didn&apos;t see any use of the readPage method. Is that possible?&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="12885546" author="bryanpendleton" created="Tue, 6 Jul 2010 15:07:12 +0100"  >&lt;p&gt;I think you may be seeing the page cache at work. I think that&lt;br/&gt;
pages may only when the database is checkpointed or shut down.&lt;/p&gt;

&lt;p&gt;And to cause a page to be read you may need to shut down and&lt;br/&gt;
restart, since the page you wrote remains in the cache.&lt;/p&gt;</comment>
                            <comment id="12885556" author="mikem" created="Tue, 6 Jul 2010 16:07:13 +0100"  >&lt;p&gt;As others have suggested, in order to go through those routines you need to &quot;avoid&quot; the page cache.&lt;br/&gt;
Here are some suggestions:&lt;br/&gt;
    o for read the easiest thing is probably to shut down the database&lt;br/&gt;
       and restart.  On restart there is nothing in the cache so it is&lt;br/&gt;
       necessary to read pages from disk to the cache.&lt;br/&gt;
    o to cause both read and write I would suggest changing the&lt;br/&gt;
       size of the page cache from it&apos;s default of 1000 pages to&lt;br/&gt;
       something much smaller, like 40 pages using    derby.storage.pageCacheSize.  Then create a table that has actual data in it that is bigger than 40*32k.  Maybe a row with a blob that has actual data in it bigger than this number.  Updates to that blob should cause both reads and writes since the pages should not fit in the cache.  &lt;/p&gt;</comment>
                            <comment id="12888432" author="eranda" created="Wed, 14 Jul 2010 17:54:11 +0100"  >&lt;p&gt;Hi,&lt;br/&gt;
How can I pass parameters to a Error message. &lt;/p&gt;

&lt;p&gt;I use the exception as&lt;br/&gt;
throw StandardException.newException(SQLState.FILE_CONTAINER_EXCEPTION,new IOException(&quot;FAKE FAKE FAKE&quot;),this.toString(),&quot;read&quot;,file);&lt;/p&gt;

&lt;p&gt;Here is my change to modify  the error message,&lt;br/&gt;
Index: java/engine/org/apache/derby/loc/messages.xml&lt;br/&gt;
===================================================================&lt;br/&gt;
&amp;#8212; java/engine/org/apache/derby/loc/messages.xml	(revision 961244)&lt;br/&gt;
+++ java/engine/org/apache/derby/loc/messages.xml	(working copy)&lt;br/&gt;
@@ -5724,7 +5724,7 @@&lt;/p&gt;

&lt;p&gt;             &amp;lt;msg&amp;gt;&lt;br/&gt;
                 &amp;lt;name&amp;gt;XSDG3.D&amp;lt;/name&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;text&amp;gt;Meta-data for Container 
{0} could not be accessed&amp;lt;/text&amp;gt;&lt;br/&gt;
+                &amp;lt;text&amp;gt;Meta-data for Container {0}
&lt;p&gt; could not be accessed to &lt;/p&gt;
{1} file {2}&amp;lt;/text&amp;gt;&lt;br/&gt;
                 &amp;lt;arg&amp;gt;containerName&amp;lt;/arg&amp;gt;&lt;br/&gt;
             &amp;lt;/msg&amp;gt;&lt;br/&gt;
&lt;br/&gt;
But still I don&apos;t understand how to get the parameters here {1}
&lt;p&gt; and &lt;/p&gt;
{2}
&lt;p&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With this change I am not able to build, The error was &lt;br/&gt;
Could not generate English properties from message descriptors. &lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Eranda&lt;/p&gt;</comment>
                            <comment id="12888646" author="bryanpendleton" created="Thu, 15 Jul 2010 01:50:23 +0100"  >&lt;p&gt;&amp;gt; But still I don&apos;t understand how to get the parameters here &lt;/p&gt;
{1}
&lt;p&gt; and &lt;/p&gt;
{2}
&lt;p&gt;. &lt;/p&gt;

&lt;p&gt;StandardException.newException() has a whole bunch of overloads,&lt;br/&gt;
each one is a different way to pass arguments to an error message.&lt;/p&gt;

&lt;p&gt;To create an exception with a message with 3 parameters, try using&lt;br/&gt;
the overload which takes (messageID, Object[]), and in the Object array&lt;br/&gt;
put your three arguments.&lt;/p&gt;

&lt;p&gt;Something like:&lt;/p&gt;

&lt;p&gt;  throw StandardException.newException(&lt;br/&gt;
                         SQLState.FILE_CONTAINER_EXCEPTION,&lt;br/&gt;
                         new Object[] &lt;/p&gt;
{
                                    this.toString(),
                                    &quot;read&quot;,
                                    file }
&lt;p&gt;);&lt;/p&gt;</comment>
                            <comment id="12890600" author="eranda" created="Wed, 21 Jul 2010 08:56:38 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Here I reproduce the error and do the following changes to the code and get the following result.&lt;/p&gt;

&lt;p&gt;First create database&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:MyDB;create=true&apos;;&lt;br/&gt;
ij&amp;gt; create table t1(a int);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; insert into t1 values(1),(2);&lt;br/&gt;
2 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; select a from t1;&lt;br/&gt;
A          &lt;br/&gt;
-----------&lt;br/&gt;
1          &lt;br/&gt;
2          &lt;/p&gt;

&lt;p&gt;2 rows selected&lt;br/&gt;
ij&amp;gt; exit;&lt;/p&gt;

&lt;p&gt;then restart&lt;/p&gt;

&lt;p&gt;ij&amp;gt; connect &apos;jdbc:derby:MyDB;create=true&apos;;&lt;br/&gt;
ij&amp;gt; select a from t1;&lt;br/&gt;
ERROR XSDG3: Meta-data for Container org.apache.derby.impl.store.raw.data.RAFContainer@1318b could not be accessed to read /home/eranda/Desktop/DERBY/Derby-1958/trunk/test/MyDB/seg0/ca1.dat&lt;br/&gt;
ij&amp;gt; &lt;/p&gt;

&lt;p&gt;what you think about the message?&lt;/p&gt;</comment>
                            <comment id="12890731" author="bryanpendleton" created="Wed, 21 Jul 2010 15:16:18 +0100"  >&lt;p&gt;What do you think about adding a toString() method to RAFContainer? Then instead of getting&lt;/p&gt;

&lt;p&gt;  Container org.apache.derby.impl.store.raw.data.RAFContainer@1318b&lt;/p&gt;

&lt;p&gt;the message might contain something like:&lt;/p&gt;

&lt;p&gt;  Container (seg=1,ctr=113) version=4, estRows=104679 estPages=645 file=ca1.dat inBackup=false&lt;/p&gt;

&lt;p&gt;The best way to do this is probably to put toString() methods on BaseContainer,&lt;br/&gt;
FileContainer, and RAFContainer, and make sure that each toString() method&lt;br/&gt;
invokes super.toString() as part of its processing, since the printable information&lt;br/&gt;
about a container is contained in classes up and down the hierarchy.&lt;/p&gt;

&lt;p&gt;Mike can probably help us decide what information is most important to&lt;br/&gt;
include in the toString method so that the container state will be preserved in&lt;br/&gt;
the error message, but you could start by just looking at the member fields&lt;br/&gt;
of each of the classes and including them in the message.&lt;/p&gt;

&lt;p&gt;From a quick scan, I suspect that the most important fields to include in the&lt;br/&gt;
toString are:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;BaseContainer.identity&lt;/li&gt;
	&lt;li&gt;FileContainer.pageSize&lt;/li&gt;
	&lt;li&gt;FileContainer.containerVersion&lt;/li&gt;
	&lt;li&gt;FileContainer.estimatedRowCount&lt;/li&gt;
	&lt;li&gt;FileContainer.estimatedPageCount&lt;/li&gt;
	&lt;li&gt;FileContainer.isDirty&lt;/li&gt;
	&lt;li&gt;RAFContainer.fileData&lt;/li&gt;
	&lt;li&gt;RAFContainer.actionCode&lt;/li&gt;
	&lt;li&gt;RAFContainer.inBackup&lt;/li&gt;
	&lt;li&gt;RAFContainer.inRemove&lt;/li&gt;
&lt;/ul&gt;


</comment>
                            <comment id="12890831" author="mikem" created="Wed, 21 Jul 2010 20:10:43 +0100"  >&lt;p&gt;I am not sure it is worth it for this internal error, but you should not be passing english words as parameters to the error message.  ie. passing &quot;read&quot; in.   By doing this it is impossible to have the&lt;br/&gt;
error message correctly translated.  The options are either to not have the parameter and have &lt;br/&gt;
different error messages, or there is a facility to pass in a message id that can be translated.  This&lt;br/&gt;
is heavily used for stuff like query plan printing.  Again as an internal message it may be ok, but in general it should not be used.&lt;/p&gt;

&lt;p&gt;If you go down the route of adding to/creating a toString() I would give up on translation as that would&lt;br/&gt;
fall more into a &quot;dump&quot; and probably be ok to not translate.&lt;/p&gt;

&lt;p&gt;The usual info printed for a container in an error message I  think comes from a ContainerKey.  I think you can get this from a getIdentity() call.  See the SQLState.DATA_UNKNOWN_CONTAINER_FORMAT error thrown in the FileContainer class.  &lt;/p&gt;

&lt;p&gt;Historically (pre-open source) not a lot of &quot;toString()&quot; were implemented, and if they were they were often only implemented in SANE mode with the following type of construct:&lt;br/&gt;
public String toString()&lt;br/&gt;
{&lt;br/&gt;
    if (SanityManager.DEBUG)&lt;/p&gt;
    {
        String str =
            &quot;*** Alloc page ***\n&quot;      +
            &quot;nextAllocPageNumber = &quot;    + nextAllocPageNumber   +
            &quot;\nnextAllocPageOffset = &quot;  + nextAllocPageOffset   +
            &quot;\nreserved1 = &quot;            + reserved1             +
            &quot;\nreserved2 = &quot;            + reserved2             +
            &quot;\nreserved3 = &quot;            + reserved3             +
            &quot;\nreserved4 = &quot;            + reserved4             +
            &quot;\nborrowedSpace = &quot;        + borrowedSpace         +
            &quot;\nextent = &quot;               + extent.toDebugString() + &quot;\n&quot; +
            super.toString();
        return str;
    }
&lt;p&gt;    else&lt;/p&gt;
    {
        return null;
    }
&lt;p&gt;}&lt;/p&gt;


&lt;p&gt;  This was to keep the foot print as small as possible, and recognizing that they were not translatable.&lt;/p&gt;</comment>
                            <comment id="12891065" author="eranda" created="Thu, 22 Jul 2010 09:44:13 +0100"  >&lt;p&gt;Hi Mike,&lt;br/&gt;
getIdentity() method only print &quot;Container(0, 161)&quot; for me. Other than that we can over right the toString() to print all stuff as Bryan mentioned.&lt;br/&gt;
Here is a sample I made,&lt;br/&gt;
public String toString()&lt;/p&gt;
{
            String str = this.identity+&quot; Version=&quot;+this.containerVersion+
                                &quot; estRows=&quot;+this.estimatedRowCount+&quot; inBackup=&quot;+this.inBackup+
                                &quot; inRemove=&quot;+this.inRemove+&quot; isDirty=&quot;+this.isDirty+
                                &quot; pageSize=&quot;+this.pageSize+&quot; fileData=&quot;+this.fileData+
                                &quot; actionCode=&quot;+this.actionCode;

            return str;      
        }

&lt;p&gt;and its results,&lt;/p&gt;

&lt;p&gt;ERROR XSDG3: Meta-data for Container(0, 161) Version=0 estRows=149 inBackup=false inRemove=false isDirty=false pageSize=4096 fileData=org.apache.derby.impl.io.DirRandomAccessFile4@1690ab actionCode=1 could not be accessed to read /home/eranda/Desktop/DERBY/Derby-1958/trunk/test/MyDB/seg0/ca1.dat&lt;/p&gt;

&lt;p&gt;Also I did not find a variable called FileContainer.estimatedPageCount. So I miss it in the toString method.&lt;br/&gt;
Thanks&lt;/p&gt;
</comment>
                            <comment id="12896036" author="bryanpendleton" created="Fri, 6 Aug 2010 14:59:51 +0100"  >&lt;p&gt;I think that using the getIdentity() method to provide container information&lt;br/&gt;
would be a good resolution for now. Eranda, what do you think about&lt;br/&gt;
providing a toString() method which returns getIdentity()? What would&lt;br/&gt;
the message look like in that case?&lt;/p&gt;</comment>
                            <comment id="12898664" author="eranda" created="Sun, 15 Aug 2010 06:51:49 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
I throw exception,&lt;br/&gt;
throw StandardException.newException(SQLState.FILE_CONTAINER_EXCEPTION, new Object[] &lt;/p&gt;
{getIdentity().toString(),type,file}
&lt;p&gt;)&lt;br/&gt;
and the message format of the XSDG3 error as,&lt;br/&gt;
Meta-data for &lt;/p&gt;
{0}
&lt;p&gt; could not be accessed to &lt;/p&gt;
{1}
&lt;p&gt; &lt;/p&gt;
{2}
&lt;p&gt; in message.xml&lt;br/&gt;
and got the exception error message as&lt;br/&gt;
ERROR XSDG3: Meta-data for Container(0, 161) could not be accessed to read /home/eranda/Desktop/DERBY/Derby-1958/trunk/test/MyDB/seg0/ca1.dat&lt;br/&gt;
Is it good enough for now?&lt;br/&gt;
thanks&lt;/p&gt;</comment>
                            <comment id="12898702" author="bryanpendleton" created="Sun, 15 Aug 2010 17:21:30 +0100"  >&lt;p&gt;Yes, I think that would be a considerable improvement over the current behavior,&lt;br/&gt;
and would certainly address this issue appropriately.&lt;/p&gt;

&lt;p&gt;Can you attach your proposed patch which creates the message as you suggest above?&lt;/p&gt;

&lt;p&gt;Also, you should mark this issue as assigned to you.&lt;/p&gt;</comment>
                            <comment id="12898707" author="eranda" created="Sun, 15 Aug 2010 18:01:10 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Here I am attaching the actual patch file and the patch with the error reproduction for your concern. &lt;br/&gt;
thanks&lt;/p&gt;</comment>
                            <comment id="12898759" author="bryanpendleton" created="Sun, 15 Aug 2010 23:05:58 +0100"  >&lt;p&gt;I think that the changes to messages.xml and ErrorCodeTest.java look fine.&lt;/p&gt;

&lt;p&gt;I think what we need is a patch which includes the changes to messages.xml and&lt;br/&gt;
ErrorCodeTest.java, and also includes changes to InputStreamContainer.java and&lt;br/&gt;
RAFContainer.java which adjust all of the places where FILE_CONTAINER_EXCEPTION&lt;br/&gt;
is generated, to use the new invocation&lt;/p&gt;

&lt;p&gt;       throw StandardException.newException(SQLState.FILE_CONTAINER_EXCEPTION, &lt;br/&gt;
                                       new Object[] &lt;/p&gt;
{getIdentity().toString(),type,file}
&lt;p&gt;) ;&lt;/p&gt;

&lt;p&gt;I don&apos;t think we need the &apos;reproduction&apos; changes to BaseDataFileFactoryJ4.java,&lt;br/&gt;
nor the &quot;if(pageNumber&amp;gt;1)&quot; section in RAFContainer, in the final patch, as those&lt;br/&gt;
were just present to enable you to verify the proper formatting of the error message.&lt;/p&gt;

&lt;p&gt;Does that make sense?&lt;/p&gt;</comment>
                            <comment id="12900173" author="eranda" created="Thu, 19 Aug 2010 06:12:15 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Yes Bryan I understood and I introduced them to see the model for such exception. Are there any documents to change or can we commit the patch?&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="12900289" author="bryanpendleton" created="Thu, 19 Aug 2010 15:36:57 +0100"  >&lt;p&gt;Hi Eranda,&lt;/p&gt;

&lt;p&gt;I don&apos;t think we can commit the current Derby-1958.diff, because it changes&lt;br/&gt;
messages.xml to add new arguments, but it does not change the users of&lt;br/&gt;
the XSDG3 message to pass the new arguments.&lt;/p&gt;

&lt;p&gt;In addition to the changes to messages.xml and ErrorCodeTest.java, the&lt;br/&gt;
patch needs to ALSO modify InputStreamContainer.java and RAFContainer.java&lt;br/&gt;
to pass the getIdentity(), type, and file arguments when the XSDG3 message&lt;br/&gt;
(which is called FILE_CONTAINER_EXCEPTION in the code) is thrown.&lt;/p&gt;

&lt;p&gt;I think the patch should contain about 7 modified calls to newException()&lt;br/&gt;
in those two source files.&lt;/p&gt;</comment>
                            <comment id="12900703" author="eranda" created="Fri, 20 Aug 2010 15:21:48 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
I came up with a patch. While creating this I faced a problem with the type variable in which we define read/write. So I came up with a class variables for both type and file (openType and fileName) where they are initialized at readPage/writePage methods. So what you think, can we have such variable or does it need changes?&lt;/p&gt;</comment>
                            <comment id="12901095" author="bryanpendleton" created="Sat, 21 Aug 2010 22:09:00 +0100"  >&lt;p&gt;Hi Eranda,&lt;/p&gt;

&lt;p&gt;I took your patch and made some additional changes, and have attached&lt;br/&gt;
the revised patch as &apos;reviewedPatch.diff&apos;.&lt;/p&gt;

&lt;p&gt;It would be great if you could have a look and proof-read the updated patch.&lt;/p&gt;

&lt;p&gt;The regression tests run clean for me with this patch.&lt;/p&gt;

&lt;p&gt;I also planted fake IOExceptions into the code in a couple cases&lt;br/&gt;
and verified that the message is printed cleanly to derby.log.&lt;/p&gt;

&lt;p&gt;Let me know if you see anything else that we need to attend to&lt;br/&gt;
prior to committing this patch.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12902354" author="eranda" created="Wed, 25 Aug 2010 10:17:07 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
Thanks for the updated patch and I got the changed which you did. Also I successfully ran the regression tests in my machine after applying it. I think this can be committed now.&lt;br/&gt;
Thanks   &lt;/p&gt;</comment>
                            <comment id="12902867" author="bryanpendleton" created="Thu, 26 Aug 2010 15:01:33 +0100"  >&lt;p&gt;Committed to the trunk as revision 989696.&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Eranda!&lt;/p&gt;

&lt;p&gt;Although we don&apos;t hit this message frequently, the next time it&lt;br/&gt;
happens it will be good to have this extra information.&lt;/p&gt;</comment>
                            <comment id="12902890" author="knutanders" created="Thu, 26 Aug 2010 16:06:55 +0100"  >&lt;p&gt;One little thing... The new message will be virtually impossible to translate to other languages, since the verb in the sentence (&quot;open&quot;, &quot;read&quot;, &quot;encrypt&quot;) is passed as a parameter that&apos;s always in English.&lt;/p&gt;</comment>
                            <comment id="13685246" author="knutanders" created="Mon, 17 Jun 2013 10:19:27 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12452631" name="Derby-1958.diff" size="7199" author="eranda" created="Fri, 20 Aug 2010 15:21:47 +0100"/>
                            <attachment id="12452122" name="Derby-1958.diff" size="1970" author="eranda" created="Sun, 15 Aug 2010 18:01:10 +0100"/>
                            <attachment id="12450040" name="Derby-1958.diff" size="3463" author="eranda" created="Wed, 21 Jul 2010 08:56:38 +0100"/>
                            <attachment id="12452123" name="reproduce.diff" size="3478" author="eranda" created="Sun, 15 Aug 2010 18:01:10 +0100"/>
                            <attachment id="12452723" name="reviewedPatch.diff" size="7357" author="bryanpendleton" created="Sat, 21 Aug 2010 22:09:00 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 21 Jun 2010 16:24:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30202</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10423"><![CDATA[Newcomer]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0p2f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37879</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>