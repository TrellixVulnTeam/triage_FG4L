<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:53:53 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3222/DERBY-3222.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3222] &apos;CollationTest&apos; fails with &apos; expected:&lt;1&gt; but was:&lt;0&gt;&apos; in testPolishCollation(CollationTest.java:402)</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3222</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;See &lt;a href=&quot;http://dbtg.thresher.com/derby/test/10.3Branch/jvm1.6/testing/Limited/testSummary-597152.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.thresher.com/derby/test/10.3Branch/jvm1.6/testing/Limited/testSummary-597152.html&lt;/a&gt; : sol.&lt;/p&gt;

&lt;p&gt;There was 1 failure:&lt;br/&gt;
1) testPolishCollation(org.apache.derbyTesting.functionTests.tests.lang.CollationTest)junit.framework.AssertionFailedError: expected:&amp;lt;1&amp;gt; but was:&amp;lt;0&amp;gt;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.CollationTest.commonTestingForTerritoryBasedDB(CollationTest.java:1141)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.CollationTest.testPolishCollation(CollationTest.java:402)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:88)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;/p&gt;</description>
                <environment>OS: Solaris 10 8/07 s10x_u4wos_12b X86 64bits - SunOS 5.10 Generic_120012-14&lt;br/&gt;
JVM: Sun Microsystems Inc. 1.6.0_01-b06</environment>
        <key id="12383052">DERBY-3222</key>
            <summary>&apos;CollationTest&apos; fails with &apos; expected:&lt;1&gt; but was:&lt;0&gt;&apos; in testPolishCollation(CollationTest.java:402)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mamtas">Mamta A. Satoor</assignee>
                                    <reporter username="olesolberg">Ole Solberg</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Nov 2007 10:51:42 +0000</created>
                <updated>Mon, 29 Jun 2009 23:58:04 +0100</updated>
                            <resolved>Fri, 30 Nov 2007 21:44:46 +0000</resolved>
                                    <version>10.3.2.1</version>
                                    <fixVersion>10.3.2.1</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12545525" author="kmarsden" created="Mon, 26 Nov 2007 17:40:11 +0000"  >&lt;p&gt;I am thinking this shouldn&apos;t hold up the release, since the test passes on other platforms/jvms, it is likely a jvm issue.  Is anyone actively working on this issue or think it should hold up the release?&lt;/p&gt;</comment>
                            <comment id="12546912" author="mamtas" created="Thu, 29 Nov 2007 21:42:01 +0000"  >&lt;p&gt;I am curious if this test is still failing on Solaris? The particular test case in CollationTest that is failing is as below&lt;br/&gt;
    rs = s.executeQuery(&quot;select vc from a where &apos;&apos; || CURRENT_DATE = vc&quot;);&lt;br/&gt;
    assertEquals(1,JDBC.assertDrainResults(rs));&lt;/p&gt;

&lt;p&gt;But this test was added back in August, so I wonder why it&apos;s failing only now. The checkin info for the test case is as below&lt;br/&gt;
Date: Tue Aug 28 13:26:16 2007&lt;br/&gt;
New Revision: 570562&lt;/p&gt;</comment>
                            <comment id="12546927" author="djd" created="Thu, 29 Nov 2007 22:47:57 +0000"  >&lt;p&gt;The test is unstable in that it is subject to failure if run across midnight. CURRENT_DATE will return a different value in any statements that execute after midnight, thus leading to queries returning a different number of rows.&lt;/p&gt;</comment>
                            <comment id="12547007" author="mamtas" created="Fri, 30 Nov 2007 06:06:58 +0000"  >&lt;p&gt;Since the main goal of the test in question is to make sure that we do not throw collation type mismatch error for the comparison operation, I think it will be fine to alter the existing test as shown below&lt;br/&gt;
***************&lt;b&gt;existing test&lt;/b&gt;*****************&lt;br/&gt;
    s.executeUpdate(&quot;create table a (vc varchar(30))&quot;);&lt;br/&gt;
    s.executeUpdate(&quot;insert into a values(CURRENT_DATE)&quot;);&lt;br/&gt;
    rs = s.executeQuery(&quot;select vc from a where vc = CURRENT_DATE&quot;);&lt;br/&gt;
    assertEquals(1,JDBC.assertDrainResults(rs));&lt;br/&gt;
    rs = s.executeQuery(&quot;select vc from a where vc = UPPER(CURRENT_DATE)&quot;);&lt;br/&gt;
    JDBC.assertDrainResults(rs,1);&lt;br/&gt;
    rs = s.executeQuery(&quot;select vc from a where vc =  &apos;&apos; || CURRENT_DATE&quot;);&lt;br/&gt;
    JDBC.assertDrainResults(rs,1);&lt;br/&gt;
    rs = s.executeQuery(&quot;select vc from a where &apos;&apos; || CURRENT_DATE = vc&quot;);&lt;br/&gt;
    assertEquals(1,JDBC.assertDrainResults(rs));&lt;br/&gt;
    assertStatementError(&quot;42818&quot;,s,&quot;select TABLENAME FROM SYS.SYSTABLES WHERE UPPER(CURRENT_DATE) = TABLENAME&quot;);&lt;br/&gt;
***************&lt;b&gt;existing test end&lt;/b&gt;************&lt;/p&gt;

&lt;p&gt;to following&lt;/p&gt;

&lt;p&gt;***************&lt;b&gt;suggested change&lt;/b&gt;*********&lt;br/&gt;
    s.executeUpdate(&quot;create table a (vc varchar(30))&quot;);&lt;br/&gt;
    s.executeUpdate(&quot;insert into a values(CURRENT_DATE)&quot;);&lt;br/&gt;
    rs = s.executeQuery(&quot;select vc from a where vc &amp;lt;= CURRENT_DATE&quot;);&lt;br/&gt;
    assertEquals(1,JDBC.assertDrainResults(rs));&lt;br/&gt;
    rs = s.executeQuery(&quot;select vc from a where vc &amp;lt;= UPPER(CURRENT_DATE)&quot;);&lt;br/&gt;
    JDBC.assertDrainResults(rs,1);&lt;br/&gt;
    rs = s.executeQuery(&quot;select vc from a where vc &amp;lt;=  &apos;&apos; || CURRENT_DATE&quot;);&lt;br/&gt;
    JDBC.assertDrainResults(rs,1);&lt;br/&gt;
    rs = s.executeQuery(&quot;select vc from a where &apos;&apos; || CURRENT_DATE &amp;gt;= vc&quot;);&lt;br/&gt;
    assertEquals(1,JDBC.assertDrainResults(rs));&lt;br/&gt;
    assertStatementError(&quot;42818&quot;,s,&quot;select TABLENAME FROM SYS.SYSTABLES WHERE UPPER(CURRENT_DATE) = TABLENAME&quot;);&lt;br/&gt;
***************&lt;b&gt;suggested test end&lt;/b&gt;************&lt;/p&gt;



&lt;p&gt;If no one has objection to this, I will go ahead and make this change tomorrow.&lt;/p&gt;</comment>
                            <comment id="12547300" author="mamtas" created="Fri, 30 Nov 2007 21:44:46 +0000"  >&lt;p&gt;Merged the changes(599933) from 10.3 into trunk(599973) with the same commit comments as for the checkin into 10.3&lt;/p&gt;</comment>
                            <comment id="12547301" author="mamtas" created="Fri, 30 Nov 2007 21:45:26 +0000"  >&lt;p&gt;The commit comments were as follows&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3222&quot; title=&quot;&amp;#39;CollationTest&amp;#39; fails with &amp;#39; expected:&amp;lt;1&amp;gt; but was:&amp;lt;0&amp;gt;&amp;#39; in testPolishCollation(CollationTest.java:402)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3222&quot;&gt;&lt;del&gt;DERBY-3222&lt;/del&gt;&lt;/a&gt; The test will fail depending on the timing. It inserts CURRENT_DATE into a column and then compares that&lt;br/&gt;
column with whatever the CURRENT_DATE might be during the run of compare sql. If the insert happened right before&lt;br/&gt;
midnight and comparison happens right after midnight, the comparison of the dates will return FALSE. Since the main&lt;br/&gt;
purpose of the test is to make sure that Derby derives correct collation type for CURRENT_DATE and&lt;br/&gt;
UPPER(CURRENT_DATE), it really does not matter if the 2 current dates actually match or not. Because of this, I&lt;br/&gt;
have changed the test to look for &amp;lt;= while doing date comparison rather than =. This should resolve the timing&lt;br/&gt;
related fact of the test. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 26 Nov 2007 17:40:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23503</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0vhz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38921</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>