<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:12:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1148/DERBY-1148.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1148] Client XA getTransactionIsolation()   does not return the correct isolation level when rejoining a global transaction</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1148</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When rejoining a global transaction, client does not report the correct isolation level with a &lt;br/&gt;
getTransactionIsolation().    The server side isolation should be ok I think.&lt;/p&gt;

&lt;p&gt;This was discovered when testing the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1044&quot; title=&quot;[xa] client XAConnection.getConnection()  does not have the correct  default isolation level if set by an earlier connection obtained from the same XAConnection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1044&quot;&gt;&lt;del&gt;DERBY-1044&lt;/del&gt;&lt;/a&gt;.  After the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1044&quot; title=&quot;[xa] client XAConnection.getConnection()  does not have the correct  default isolation level if set by an earlier connection obtained from the same XAConnection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1044&quot;&gt;&lt;del&gt;DERBY-1044&lt;/del&gt;&lt;/a&gt;, there is a new diff in the test, but the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1044&quot; title=&quot;[xa] client XAConnection.getConnection()  does not have the correct  default isolation level if set by an earlier connection obtained from the same XAConnection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1044&quot;&gt;&lt;del&gt;DERBY-1044&lt;/del&gt;&lt;/a&gt; just exposed this issue.  The output for the test was correct before by circumstance.&lt;/p&gt;

&lt;p&gt;I will put comments with this bug in checkDataSource test.&lt;/p&gt;

&lt;p&gt;// now re-join the transaction, should pick up the read-only&lt;br/&gt;
// and isolation level from the transaction,&lt;br/&gt;
// holdability remains that of this handle.&lt;br/&gt;
xar.start(xid, XAResource.TMJOIN);&lt;br/&gt;
printState(&quot;re-join X1&quot;, cs1);&lt;br/&gt;
xar.end(xid, XAResource.TMSUCCESS);&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12330637">DERBY-1148</key>
            <summary>Client XA getTransactionIsolation()   does not return the correct isolation level when rejoining a global transaction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="deepa">Deepa Remesh</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Mar 2006 09:44:43 +0000</created>
                <updated>Tue, 14 Nov 2006 13:27:08 +0000</updated>
                            <resolved>Sat, 3 Jun 2006 00:26:20 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.1.3.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12376788" author="deepa" created="Fri, 28 Apr 2006 03:35:27 +0100"  >&lt;p&gt;Kathey mentioned the problem could be in reporting of isolation level by client.  So I was trying to check that the isolation level at the server is correct. To check this, I created a smaller repro (XACheckIsolation.java) with a part of the checkDataSource test. In the test, I added calls to a stored procedure which checks the isolation level of a nested connection. From the results, it seems to me the server-side isolation is correct when rejoining a global transaction. It is only the return value of getTransactionIsolation in client driver which is wrong. However, the switch from global back to local does not seem to restore the isolation level in the server. Here are the outputs of running the attached repro. I have added my comments starting with ----&amp;gt; as to what I think the problem is:&lt;/p&gt;

&lt;p&gt;---------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
With client driver:&lt;br/&gt;
---------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
initial local&lt;br/&gt;
  isolation level: READ_COMMITTED&lt;br/&gt;
initial  X1&lt;br/&gt;
  isolation level: READ_COMMITTED&lt;br/&gt;
modified X1&lt;br/&gt;
  isolation level: READ_UNCOMMITTED&lt;br/&gt;
modified local&lt;br/&gt;
  isolation level: READ_UNCOMMITTED&lt;br/&gt;
reset local&lt;br/&gt;
  isolation level: READ_COMMITTED&lt;br/&gt;
re-join X1&lt;br/&gt;
  isolation level: READ_COMMITTED   ----&amp;gt; This is wrong. But isolation level in the server is correct.&lt;br/&gt;
back to local (same as reset)&lt;br/&gt;
  isolation level: READ_COMMITTED&lt;/p&gt;

&lt;p&gt;---------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
Corresponding server-side isolation (with client driver):&lt;br/&gt;
---------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
  isolation level in procedure: READ_COMMITTED&lt;br/&gt;
  isolation level in procedure: READ_COMMITTED&lt;br/&gt;
  isolation level in procedure: READ_UNCOMMITTED&lt;br/&gt;
  isolation level in procedure: READ_UNCOMMITTED&lt;br/&gt;
  isolation level in procedure: READ_COMMITTED&lt;br/&gt;
  isolation level in procedure: READ_UNCOMMITTED&lt;br/&gt;
  isolation level in procedure: READ_UNCOMMITTED   ----&amp;gt; This is wrong.&lt;/p&gt;

&lt;p&gt;---------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
Output with embedded driver (for reference):&lt;br/&gt;
---------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
initial local&lt;br/&gt;
  isolation level: READ_COMMITTED&lt;br/&gt;
  isolation level in procedure: READ_COMMITTED&lt;br/&gt;
initial  X1&lt;br/&gt;
  isolation level: READ_COMMITTED&lt;br/&gt;
  isolation level in procedure: READ_COMMITTED&lt;br/&gt;
modified X1&lt;br/&gt;
  isolation level: READ_UNCOMMITTED&lt;br/&gt;
  isolation level in procedure: READ_UNCOMMITTED&lt;br/&gt;
modified local&lt;br/&gt;
  isolation level: READ_UNCOMMITTED&lt;br/&gt;
  isolation level in procedure: READ_UNCOMMITTED&lt;br/&gt;
reset local&lt;br/&gt;
  isolation level: READ_COMMITTED&lt;br/&gt;
  isolation level in procedure: READ_COMMITTED&lt;br/&gt;
re-join X1&lt;br/&gt;
  isolation level: READ_UNCOMMITTED&lt;br/&gt;
  isolation level in procedure: READ_UNCOMMITTED&lt;br/&gt;
back to local (same as reset)&lt;br/&gt;
  isolation level: READ_COMMITTED&lt;br/&gt;
  isolation level in procedure: READ_COMMITTED&lt;br/&gt;
---------------------------------------------------------------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;From the test, I think there are two problems:&lt;br/&gt;
1. Isolation level reported by client driver is wrong. This seems to be because of the disconnect between the connection object states in the client and the server.&lt;br/&gt;
2. With client driver, when switching from global to local transaction, the isolation level does not get restored at the server.&lt;/p&gt;

&lt;p&gt;I would appreciate if someone can go through the attached test and outputs and tell me if I have understood this correctly.&lt;/p&gt;</comment>
                            <comment id="12376971" author="deepa" created="Sat, 29 Apr 2006 01:30:17 +0100"  >&lt;p&gt;Currently, I am using what is implemented in embedded driver as my reference. JDBC 3.0 standard mentions this: &quot;Applications should also refrain from calling Connection.setTransactionIsolation within the bounds of a distributed transaction. The resulting behavior is implementation-defined.&quot;. I could not find any documentation which describes the Derby implementation. Is this documented at some place? If not, I plan to write up the behaviour referring to what is done in the embedded driver.&lt;/p&gt;

&lt;p&gt;In my previous comment, I had identified two problems which I am restating (with some additions) as follows:&lt;/p&gt;

&lt;p&gt;1. Isolation level reported by client driver is wrong in some cases. This seems to be because of the disconnect between the connection object states in the client and the server.&lt;br/&gt;
2. With client driver, when switching from a global transaction (which we joined) to a local transaction, the isolation level does not get restored at the server.  In this case, the isolation level of the local transaction should be restored to what it was before joining the global transaction.&lt;/p&gt;

&lt;p&gt;Assuming I have understood the problem correctly, here is what I have done so far for problem# 1 :&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Add a variable(xaTransactionIsolation_) to NetXACallInfo to store the transaction isolation level used in the distributed transaction.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;*. When &quot;joining&quot; a distributed transaction, get the isolation level from the callInfo and use it to update the client connection&apos;s isolation level locally. Do not flow anything to the server since the server uses the correct isolation level. This will make sure the client reports the same isolation that is used by the server. Before updating the connection&apos;s isolation level, store it in a temporary variable so that we can use it restore the isolation level when the distributed transaction ends.&lt;/p&gt;

&lt;p&gt;*. When ending the distributed transaction, store the isolation level used in the distributed transaction in the callInfo. Restore the connection&apos;s transaction isolation only if we had changed it (when we joined the global transaction).&lt;/p&gt;

&lt;p&gt;I have run my repro with these code changes and verified that the transaction isolation reported by client in various cases is okay. I also need to understand the behaviour when we resume a suspended transaction and run more tests. I am puzzled by problem 2 and need to look at it in more detail. Meanwhile, I would appreciate any feedback on this.&lt;/p&gt;</comment>
                            <comment id="12376996" author="deepa" created="Sat, 29 Apr 2006 05:17:01 +0100"  >&lt;p&gt;Attaching an updated repro with cases for suspend/resume of a transaction. These were also behaving wrongly with the client. I&apos;ll add these cases to checkDataSource test.&lt;/p&gt;</comment>
                            <comment id="12383326" author="deepa" created="Sat, 13 May 2006 07:27:23 +0100"  >&lt;p&gt;Problem 2 mentioned above seems to be a problem in the embedded driver and not just a client problem. I have opened &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1325&quot; title=&quot;Isolation level of local connection does not get reset after exiting a global transaction if the isolation level was changed using SQL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1325&quot;&gt;&lt;del&gt;DERBY-1325&lt;/del&gt;&lt;/a&gt; for this.&lt;/p&gt;</comment>
                            <comment id="12412228" author="deepa" created="Thu, 18 May 2006 02:17:14 +0100"  >&lt;p&gt;Attaching a patch &apos;derby-1148_v1.diff&apos; which changes the getTransactionIsolation method in client&apos;s Connection class to get the transaction isolation from the server. This patch solves both &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1148&quot; title=&quot;Client XA getTransactionIsolation()   does not return the correct isolation level when rejoining a global transaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1148&quot;&gt;&lt;del&gt;DERBY-1148&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1053&quot; title=&quot;stress.multi test on ibm142  in SANE builds fails with ASSERTION at org.apache.derby.impl.services.cache.CachedItem.unkeep(CachedItem.java:152)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1053&quot;&gt;&lt;del&gt;DERBY-1053&lt;/del&gt;&lt;/a&gt;. I found these issues are specific cases of a more general problem -----&quot;isolation_&quot; stored in client&apos;s connection object can get out of sync with the actual isolation e.g., when in an XA transaction, when isolation is set using SQL instead of JDBC. &lt;/p&gt;

&lt;p&gt;I am also attaching a repro &apos;SetIsolationUsingSQL.java&apos; which shows this problem is not limited to XA. To run this repro, start network server on port 1527, and run &apos;java SetIsolationUsingSQL&apos;. Without the patch, the isolation level reported by client is wrong when SQL is used to set it.&lt;/p&gt;

&lt;p&gt;In my previous comment, I had mentioned I tried to solve this problem by trying to store the isolation used in the distributed transaction in NetXACallInfo. This solved one case but for other cases, I tried to change client&apos;s XA and did not find much success. Also, I found that this a generic problem. So the patch I am uploading takes a completely different approach.&lt;/p&gt;

&lt;p&gt;Summary of patch:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Changes getTransactionIsolation method in org.apache.derby.client.am.Connection class to get the isolation level from server. The built-in function &quot;CURRENT ISOLATION&quot; is used for this. If we do not get the isolation from the server, we return what is stored in &quot;isolation_&quot; variable. Is this okay or should we throw an exception if we do not get the isolation level from the server?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Removes the excludes for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1148&quot; title=&quot;Client XA getTransactionIsolation()   does not return the correct isolation level when rejoining a global transaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1148&quot;&gt;&lt;del&gt;DERBY-1148&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1035&quot; title=&quot;With client, Connection.getTransactionIsolation() return value is wrong after changing the isolation level with an SQL statement such as &amp;quot;set current isolation = RS&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1035&quot;&gt;&lt;del&gt;DERBY-1035&lt;/del&gt;&lt;/a&gt; from checkDataSource test.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Adds a test for transaction suspend/resume in checkDataSource test.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Adds exclusions for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1325&quot; title=&quot;Isolation level of local connection does not get reset after exiting a global transaction if the isolation level was changed using SQL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1325&quot;&gt;&lt;del&gt;DERBY-1325&lt;/del&gt;&lt;/a&gt;. These cases were coincidentally correct before this patch. However, the actual isolation used at server was wrong (mentioned as problem 2 in previous comments). This is fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1325&quot; title=&quot;Isolation level of local connection does not get reset after exiting a global transaction if the isolation level was changed using SQL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1325&quot;&gt;&lt;del&gt;DERBY-1325&lt;/del&gt;&lt;/a&gt;. I have a patch uploaded to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1325&quot; title=&quot;Isolation level of local connection does not get reset after exiting a global transaction if the isolation level was changed using SQL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1325&quot;&gt;&lt;del&gt;DERBY-1325&lt;/del&gt;&lt;/a&gt; which has become out of sync. When I upload the new patch, I will remove these exclusions and verify that problem 2 is solved. I will also upload a small write-up which summarizes the isolation level changes across transaction boundaries.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Updates master files&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This patch modifies client code and the checkDataSource tests. With this patch, I have run derbynetclientmats using Sun jdk 1.4.2 on Windows XP. I have also run the changed tests jdbcapi/checkDataSource.java and jdbcapi/checkDataSource30.java in embedded framework. Please take a look at this patch and provide feedback. Thanks.&lt;/p&gt;</comment>
                            <comment id="12412233" author="kmarsden" created="Thu, 18 May 2006 03:39:14 +0100"  >&lt;p&gt;Deepa said:&lt;br/&gt;
&amp;gt;The built-in function &quot;CURRENT ISOLATION&quot; is used for this.&lt;br/&gt;
I have a couple of concerns with this:&lt;br/&gt;
1)  Might the  VALUES CURRENT ISOLATION statement that is called upon getTransactionIsolation()  cause a commit when autocommit is on?&lt;/p&gt;

&lt;p&gt;2) I sem to recall a problem with setTransactionIsolationStmt that it was    not null but not valid on  connection reset. But I don&apos;t see the bug or the fix. It might be good to null out this variable in closeResourcesX() in addition to closing it.&lt;/p&gt;


&lt;p&gt;&amp;gt;If we do not get the isolation from the server, we return what is stored in &quot;isolation_&quot; variable. &lt;/p&gt;

&lt;p&gt;Under what circumstances would we not get the isolation from the server. Might the value stored in the isolation_ variable be wrong? If so it is better to throw an exception I think.&lt;/p&gt;





</comment>
                            <comment id="12412241" author="deepa" created="Thu, 18 May 2006 04:13:08 +0100"  >&lt;p&gt;Yes, the VALUES CURRENT ISOLATION statement that is called upon getTransactionIsolation() can cause a commit when autocommit is on. Does this mean we cannot use this to get the isolation from the server?&lt;/p&gt;

&lt;p&gt;For other comments from Kathey, I will make the changes if we decide we can use this approach. Otherwise, I will go back to my first approach which partly solves this problem. Any pointers/suggestions are welcome.&lt;/p&gt;</comment>
                            <comment id="12412997" author="deepa" created="Wed, 24 May 2006 05:02:08 +0100"  >&lt;p&gt;As Kathey pointed out, my previous patch changes getTransactionIsolation method and will cause a commit when autocommit is on. So I am off to my first approach which solved one case where transaction isolation was wrong. I am attaching a draft patch (not for commit) &apos;derby-1148-draft1.diff&apos; which does the following:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Add a variable(xaTransactionIsolation_) to NetXACallInfo to store the transaction isolation level used in the distributed transaction.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;*. When &quot;joining&quot; a distributed transaction, get the isolation level from the callInfo and use it to update the client connection&apos;s isolation level locally. Do not flow anything to the server since the server uses the correct isolation level. This will make sure the client reports the same isolation that is used by the server. Before updating the connection&apos;s isolation level, store it in a temporary variable so that we can use it restore the isolation level when the distributed transaction ends.&lt;/p&gt;

&lt;p&gt;*. When ending the distributed transaction, store the isolation level used in the distributed transaction in the callInfo. Restore the connection&apos;s transaction isolation only if we had changed it (when we joined the global transaction). &lt;/p&gt;

&lt;p&gt;But it does not solve all cases in checkDataSource test. I would like to solve the general problem which is not specific to XA - &quot;isolation_&quot; stored in client&apos;s connection object can get out of sync with the actual isolation. This will solve all issues in the client driver in this area. Looking for some solution similar (but without the side effects) of what I tried in my previous patch &apos;derby-1148_v1.diff&apos;. As I have&apos;nt found any, I am going back to my first  approach which partly solves the XA problem. Any suggestions/feedback are welcome.&lt;/p&gt;</comment>
                            <comment id="12413289" author="deepa" created="Fri, 26 May 2006 03:14:54 +0100"  >&lt;p&gt;I am attaching another patch &apos;derby-1148_v2.diff&apos; which is based on proposal 2 ----  change the getTransactionIsolation method in client&apos;s Connection class to get the transaction isolation from the server. It addresses Kathey&apos;s concern of auto-commit by changing/restoring auto-commit inside the method call. &lt;br/&gt;
I have tried to address all comments from Kathey in this patch.&lt;/p&gt;

&lt;p&gt;Summary of patch:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Changes getTransactionIsolation method in org.apache.derby.client.am.Connection class to get the isolation level from server. The built-in function &quot;CURRENT ISOLATION&quot; is used for this. It throws SQLException in case of failures. At the start of the method, the current auto-commit value is stored in a variable. When executing the function, auto-commit is set to false. At the end of the method, auto-commit value is restored. As it is the client which drives the auto-commit, this strategy of locally changing the auto-commit works.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Removes the excludes for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1148&quot; title=&quot;Client XA getTransactionIsolation()   does not return the correct isolation level when rejoining a global transaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1148&quot;&gt;&lt;del&gt;DERBY-1148&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1035&quot; title=&quot;With client, Connection.getTransactionIsolation() return value is wrong after changing the isolation level with an SQL statement such as &amp;quot;set current isolation = RS&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1035&quot;&gt;&lt;del&gt;DERBY-1035&lt;/del&gt;&lt;/a&gt; from checkDataSource test. Adds a test for transaction suspend/resume in checkDataSource test. Updates master files&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With this patch, I have run derbynetclientmats with Sun jdk 1.4.2 on Windows XP. I also ran checkDataSource.java and checkDataSource30.java with embedded and client framework. No failures. Please take a look at this patch and provide feedback.&lt;/p&gt;

&lt;p&gt;If this change looks okay, it will solve both &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1148&quot; title=&quot;Client XA getTransactionIsolation()   does not return the correct isolation level when rejoining a global transaction&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1148&quot;&gt;&lt;del&gt;DERBY-1148&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1035&quot; title=&quot;With client, Connection.getTransactionIsolation() return value is wrong after changing the isolation level with an SQL statement such as &amp;quot;set current isolation = RS&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1035&quot;&gt;&lt;del&gt;DERBY-1035&lt;/del&gt;&lt;/a&gt;. Sorry for going back and forth between the proposed solutions. As I mentioned earlier, solving the general problem seems better than trying to address individual cases. I have also attached a small write-up &apos;XA_TransactionIsolation.html&apos; based on my understanding of how isolation levels change across transaction boundaries.&lt;/p&gt;</comment>
                            <comment id="12414286" author="deepa" created="Fri, 2 Jun 2006 03:41:34 +0100"  >&lt;p&gt;Attaching a patch &quot;derby-1148-javadoc.diff&quot; which adds a javadoc comment that I missed with the previous patch. This is a one-line change. I ran ant javadoc to check that the warning does not occur. I also ran ant clobber, ant all. I would appreciate if someone can commit this small patch.&lt;/p&gt;</comment>
                            <comment id="12414299" author="deepa" created="Fri, 2 Jun 2006 04:56:37 +0100"  >&lt;p&gt;Port this fix to 10.1 branch&lt;/p&gt;</comment>
                            <comment id="12414300" author="deepa" created="Fri, 2 Jun 2006 05:06:21 +0100"  >&lt;p&gt;Attaching a patch &quot;derby-1148_10.1.diff&quot; for 10.1 branch. There were conflicts with a direct merge, hence attaching a patch. With the patch, I ran derbynetclientmats using Sun jdk1.4.2 on Windows XP.  No failures.&lt;/p&gt;

&lt;p&gt;Please note that there are two pending patches attached to this issue:&lt;br/&gt;
1. derby-1148-javadoc.diff - for trunk&lt;br/&gt;
2. derby-1148_10.1.diff - for 10.1 branch&lt;/p&gt;

&lt;p&gt;Please take a look at these. &lt;/p&gt;</comment>
                            <comment id="12414468" author="kmarsden" created="Sat, 3 Jun 2006 00:26:20 +0100"  >&lt;p&gt;Submitted to 10.1&lt;/p&gt;

&lt;p&gt;Date: Fri Jun  2 09:15:08 2006&lt;br/&gt;
New Revision: 411202&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=411202&amp;amp;view=rev&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?rev=411202&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks Deepa!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12329365">DERBY-1035</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12334191">DERBY-1325</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12355583">DERBY-2084</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12334251" name="SetIsolationUsingSQL.java" size="4110" author="deepa" created="Thu, 18 May 2006 02:17:14 +0100"/>
                            <attachment id="12325965" name="XACheckIsolation.java" size="5967" author="deepa" created="Fri, 28 Apr 2006 03:35:27 +0100"/>
                            <attachment id="12326031" name="XACheckIsolation_2.java" size="6617" author="deepa" created="Sat, 29 Apr 2006 05:17:01 +0100"/>
                            <attachment id="12334579" name="XA_TransactionIsolation.html" size="1868" author="deepa" created="Fri, 26 May 2006 03:14:54 +0100"/>
                            <attachment id="12334462" name="derby-1148-draft1.diff" size="4877" author="deepa" created="Wed, 24 May 2006 05:02:08 +0100"/>
                            <attachment id="12334463" name="derby-1148-draft1.status" size="230" author="deepa" created="Wed, 24 May 2006 05:02:08 +0100"/>
                            <attachment id="12334908" name="derby-1148-javadoc.diff" size="660" author="deepa" created="Fri, 2 Jun 2006 03:41:34 +0100"/>
                            <attachment id="12334911" name="derby-1148_10.1.diff" size="18331" author="deepa" created="Fri, 2 Jun 2006 05:06:21 +0100"/>
                            <attachment id="12334912" name="derby-1148_10.1.status" size="535" author="deepa" created="Fri, 2 Jun 2006 05:06:21 +0100"/>
                            <attachment id="12334249" name="derby-1148_v1.diff" size="17923" author="deepa" created="Thu, 18 May 2006 02:17:14 +0100"/>
                            <attachment id="12334250" name="derby-1148_v1.status" size="631" author="deepa" created="Thu, 18 May 2006 02:17:14 +0100"/>
                            <attachment id="12334577" name="derby-1148_v2.diff" size="17970" author="deepa" created="Fri, 26 May 2006 03:14:54 +0100"/>
                            <attachment id="12334578" name="derby-1148_v2.status" size="631" author="deepa" created="Fri, 26 May 2006 03:14:54 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 28 Apr 2006 02:35:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22336</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy13yn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40292</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>