<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:53:49 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-530/DERBY-530.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-530] ClientDriver ignores Properties object in connect(String url, Properties connectionProperties) method</title>
                <link>https://issues.apache.org/jira/browse/DERBY-530</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;In contrast to EmbeddedDriver, a connection attribute create=true is not recognized when presented as a property in a Properties object.&lt;/p&gt;

&lt;p&gt; As a workaround I append the attributes from the Properties object to the url string before invoking the connect() method: then a new database is created and a connection is established.&lt;/p&gt;

&lt;p&gt;Next code fragment illustrates the bug and the workaround:&lt;/p&gt;



&lt;p&gt;    private static final ClientDriver clientDriver = new ClientDriver();&lt;/p&gt;


&lt;p&gt;    private Connection getClientConnection(String database,&lt;br/&gt;
            Properties connectionProperties) throws SQLException {&lt;br/&gt;
        try &lt;/p&gt;
{
            System.out.println(&quot;Try to connect with properties&quot;);
            String connectionURL = &quot;jdbc:derby://127.0.0.1:1527/&quot; + database;
            System.out.println(&quot;connectionURL: &quot; + connectionURL);
            Connection rv = clientDriver.connect(connectionURL,
                    connectionProperties);
            System.out.println(&quot;Connection: &quot; + rv);
            return rv;
        }
&lt;p&gt; catch (SQLException e) {&lt;br/&gt;
            System.out.println(&quot;Try to connect with URL attributes&quot;);&lt;br/&gt;
            StringBuffer sb = new StringBuffer();&lt;br/&gt;
            for (Enumeration enu = connectionProperties.propertyNames(); enu&lt;br/&gt;
                    .hasMoreElements()&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;
{
                String key = (String) enu.nextElement();
                sb.append(&apos;;&apos;);
                sb.append(key);
                sb.append(&apos;=&apos;);
                sb.append(connectionProperties.getProperty(key, &quot;&quot;));
            }
&lt;p&gt;            String connectionURL = &quot;jdbc:derby://127.0.0.1:1527/&quot; + database&lt;br/&gt;
                    + sb.toString();&lt;br/&gt;
            System.out.println(&quot;connectionURL: &quot; + connectionURL);&lt;br/&gt;
            Connection rv = clientDriver.connect(connectionURL,&lt;br/&gt;
                    connectionProperties);&lt;br/&gt;
            System.out.println(&quot;Connection: &quot; + rv);&lt;br/&gt;
            System.out&lt;br/&gt;
                    .println(&quot;!!!!!!!!!!! seems a bug: Properties argument in ClientDriver.connect(String, Properties) has not been used&quot;);&lt;br/&gt;
            return rv;&lt;br/&gt;
        }&lt;br/&gt;
    }&lt;/p&gt;
</description>
                <environment>windows XP, JRE 1.5.0_04</environment>
        <key id="12313700">DERBY-530</key>
            <summary>ClientDriver ignores Properties object in connect(String url, Properties connectionProperties) method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="pietblok">Piet Blok</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Aug 2005 01:25:47 +0100</created>
                <updated>Thu, 2 May 2013 03:28:57 +0100</updated>
                            <resolved>Sat, 17 Sep 2005 09:07:26 +0100</resolved>
                                    <version>10.1.1.0</version>
                                    <fixVersion>10.1.2.1</fixVersion>
                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12322749" author="kmarsden" created="Wed, 7 Sep 2005 02:32:26 +0100"  >&lt;p&gt;Currently the client sends all attributes specified in the the url to the server in the RDBNAM parameter of the ACCSEC command.  This includes  any client attributes (which the server ignores).  It does not however make proper consideration for the properties specified in the info parameter of the connect(String url, Properties info) method.  Another issue with the current approach is that user and password attributes get passed to the server without encryption if specified with the url.&lt;/p&gt;


&lt;p&gt;I propose to fix this issue by sending  both the properties specified in the info parameter and those specified in the url to the server in the RDBNAM. user and password attributes will be the exception.  user and password  will be sent via the standard DRDA mechanism and excluded from the attributes sent with RDBNAM whether specified with the url or info properties.   As a result of the combination, the order of attributes sent to the server may be different than originally specified in the URL.&lt;/p&gt;

</comment>
                            <comment id="12323076" author="kmarsden" created="Sat, 10 Sep 2005 06:03:05 +0100"  >
&lt;p&gt;Send both the properties specified in the info parameter and those specified in the url to the server in the RDBNAM. user and password attributes will be the exception. user and password will be sent via the standard DRDA mechanism and excluded from the attributes sent with RDBNAM whether specified with the url or info properties. As a result of the combination, the order of attributes sent to the server may be different than originally specified in the URL.&lt;/p&gt;

&lt;p&gt;Also added additional driver tests and attrbute tests to checkDriver.  &lt;/p&gt;
</comment>
                            <comment id="12323117" author="pietblok" created="Sat, 10 Sep 2005 16:39:54 +0100"  >&lt;p&gt;I just add this because it was not explicitly mentioned by Kathey :  I guess encryption applies both to the user password and the bootPassword property?&lt;/p&gt;</comment>
                            <comment id="12323215" author="kmarsden" created="Mon, 12 Sep 2005 21:39:40 +0100"  >&lt;p&gt;To answer Piet&apos;s question. No . bootPassword is not encrypted.  I added a note to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-474&quot; title=&quot;Improve Network Server security  documentation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-474&quot;&gt;&lt;del&gt;DERBY-474&lt;/del&gt;&lt;/a&gt; to update the documentation to provide a  warning that this is the case. &lt;/p&gt;</comment>
                            <comment id="12323230" author="deepa" created="Tue, 13 Sep 2005 01:43:41 +0100"  >&lt;p&gt;I ran derbyall with this patch and got two failures:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;derbyall/derbynetclientmats/derbynetmats.fail:jdbcapi/checkDriver.java&lt;/li&gt;
	&lt;li&gt;derbyall/derbynetmats/derbynetmats.fail:jdbcapi/checkDriver.java&lt;br/&gt;
I think new master files have to be created for DerbyNet and DerbyNetClient frameworks because of addition of tests for Client attributes.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I looked at the changes and I have one comment on one of the comments in the code. The comment for &apos;tokenizeDatabase&apos; method in ClientDriver.java can be changed from &quot;//return database name and attributes&quot; to &quot;//return database name&quot;. With the changes for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-530&quot; title=&quot;ClientDriver ignores Properties object in connect(String url, Properties connectionProperties) method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-530&quot;&gt;&lt;del&gt;DERBY-530&lt;/del&gt;&lt;/a&gt;, it only returns the databaseName. &lt;/p&gt;

&lt;p&gt;Currently in jdbcapi/checkDriver.java, I see tests only for &apos;traceFile&apos; property in &apos;testClientAttributes&apos;. I think it would be good to test some more properties using the Properties object.&lt;/p&gt;</comment>
                            <comment id="12323245" author="kmarsden" created="Tue, 13 Sep 2005 02:57:34 +0100"  >&lt;p&gt;Thanks Deepa for the review.&lt;br/&gt;
I will fix up the code comments.&lt;/p&gt;

&lt;p&gt;svn add bites me again.&lt;/p&gt;

&lt;p&gt;On the test, I agree that additional tests for all the attributes should be added, and started to do that, but found &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-530&quot; title=&quot;ClientDriver ignores Properties object in connect(String url, Properties connectionProperties) method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-530&quot;&gt;&lt;del&gt;DERBY-530&lt;/del&gt;&lt;/a&gt; growing, so thought it best to check in with the tests that the embedded attributes get passed to the server and the client attributes get processed and put a todo in the test  to add the additional attributes.  I&apos;ll file a separate Jira entry to enhance the test.&lt;/p&gt;

&lt;p&gt;When I ran derbyAll, I found there is another problem too with the test that tracefile goes to a different subdirectory based on whether the test is run in a suite or independently.&lt;br/&gt;
I will fix that too.&lt;/p&gt;
</comment>
                            <comment id="12329429" author="kmarsden" created="Thu, 15 Sep 2005 23:08:47 +0100"  >&lt;p&gt;Checked into the trunk.&lt;/p&gt;

&lt;p&gt;Date: Thu Sep 15 05:49:14 2005&lt;br/&gt;
New Revision: 289227&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewcvs?rev=289227&amp;amp;view=rev&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs?rev=289227&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-530&quot; title=&quot;ClientDriver ignores Properties object in connect(String url, Properties connectionProperties) method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-530&quot;&gt;&lt;del&gt;DERBY-530&lt;/del&gt;&lt;/a&gt; &lt;br/&gt;
ClientDriver ignores Properties object in connect(String url, Properties connectionProperties) method&lt;/p&gt;

&lt;p&gt;In 1  derbyAll run I saw a failure in DerbyNetAutoStart.  It was an exception from network server  closing   the connections after Derby was intentionally shut down,  similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-273&quot; title=&quot;The derbynet/dataSourcePermissions_net.java test fails intermittently&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-273&quot;&gt;&lt;del&gt;DERBY-273&lt;/del&gt;&lt;/a&gt;.   I was not able to reproduce the failure after many dozens of runs of the test and repeating derbyAll.  Looking at the test   I see that Derby is intentionally shut  down and so the exception is not unexpected but the shutdown is not passed through properties, so I am assuming that this was a rare intermittent diff and not caused by this change.  &lt;/p&gt;

&lt;p&gt;Probably still to be resolved is what  Network Server should do with exceptions that occur before Derby is started or after Derby is shut down.  Right now it prints them to the console or System.out if the console is not specified. It seems like it could at least print them to derby.log if only the database and not the engine was shut down.&lt;/p&gt;</comment>
                            <comment id="12329598" author="kmarsden" created="Sat, 17 Sep 2005 09:07:25 +0100"  >&lt;p&gt;Committed to trunk (2892227) and 10.1 (289672)&lt;/p&gt;

&lt;p&gt;Date: Fri Sep 16 15:59:43 2005&lt;br/&gt;
New Revision: 289672&lt;br/&gt;
URL: &lt;a href=&quot;http://svn.apache.org/viewcvs?rev=289672&amp;amp;view=rev&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs?rev=289672&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-530&quot; title=&quot;ClientDriver ignores Properties object in connect(String url, Properties connectionProperties) method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-530&quot;&gt;&lt;del&gt;DERBY-530&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ClientDriver ignores Properties object in connect(String url, Properties connectionProperties) method&lt;br/&gt;
Merge from trunk&lt;br/&gt;
svn merge -r289226:289227 &lt;a href=&quot;https://svn.apache.org/repos/asf/db/derby/code/trunk&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/db/derby/code/trunk&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12329600" author="kmarsden" created="Sat, 17 Sep 2005 09:12:33 +0100"  >&lt;p&gt;The sending of user/password in RDBNAM is fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-530&quot; title=&quot;ClientDriver ignores Properties object in connect(String url, Properties connectionProperties) method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-530&quot;&gt;&lt;del&gt;DERBY-530&lt;/del&gt;&lt;/a&gt;.  getURL still needs to be fixed.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12314789">DERBY-559</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12312811" name="DERBY530.diff" size="33114" author="kmarsden" created="Sat, 10 Sep 2005 06:03:05 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 7 Sep 2005 01:32:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22000</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy12yf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40129</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>