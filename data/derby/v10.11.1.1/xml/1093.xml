<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:40:12 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1093/DERBY-1093.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1093] Make DatabaseMetaData.getProcedures() JDBC4 compliant</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1093</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;JDBC 4.0 requires that the result set returned from getProcedures must contain a new column SPECIFIC_NAME&quot;and that the result set must be ordered by&lt;br/&gt;
PROCEDURE_SCHEM, PROCEDURE_NAME and SPECIFIC_ NAME.&lt;/p&gt;

&lt;p&gt;The SYSALIASES table already has a column called SPECIFICNAME, so it should only be necessary to modify the query in metadata.properties.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12330058">DERBY-1093</key>
            <summary>Make DatabaseMetaData.getProcedures() JDBC4 compliant</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12328834">DERBY-946</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dyret">Dyre Tjeldvoll</assignee>
                                    <reporter username="dyret">Dyre Tjeldvoll</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Mar 2006 21:59:00 +0000</created>
                <updated>Thu, 2 May 2013 03:28:57 +0100</updated>
                            <resolved>Fri, 21 Apr 2006 21:25:20 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12369649" author="dyret" created="Thu, 9 Mar 2006 23:19:11 +0000"  >&lt;p&gt;1093 should really be a subtask of 969, but subtasks cannot be nested.&lt;/p&gt;</comment>
                            <comment id="12370497" author="dyret" created="Wed, 15 Mar 2006 19:38:27 +0000"  >&lt;p&gt;This is a bit more tricky than I first imagined. The first thing to note is that the modified query in metadata.properties must be given a new name (key) in order to ensure that the new query gets used after an upgrade, (see &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1107&quot; title=&quot;For existing databases JDBC metadata queries do not get updated properly  between maintenance versions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1107&quot;&gt;&lt;del&gt;DERBY-1107&lt;/del&gt;&lt;/a&gt;). But the query named getProcedures is also used as input to generate queries for ODBC. It turns out that the JDBC 4.0 version of getProcedures is NOT compatible with ODBC since it adds SPECIFIC_NAME which has no counter part in ODBC. This leaves us with 3 alternatives:&lt;/p&gt;

&lt;p&gt;1) Keep both the old and the new version of the query. This will leave the ODBC queries as before, but makes metadata.properties more cluttered. &lt;br/&gt;
2) Replace the existing query with a new one with a new name, and rewrite the ODBC logic to use the new query name as input. Will result in additional non-standard columns in ODBC.&lt;br/&gt;
3) Modify the ODBCQueryGenerator so that the extra column gets removed in the ODBC version of the query. Will work but is more work, and potentially more risky?&lt;/p&gt;

&lt;p&gt;What do people think?&lt;/p&gt;</comment>
                            <comment id="12370530" author="dyret" created="Thu, 16 Mar 2006 01:04:07 +0000"  >&lt;p&gt;If I don&apos;t hear otherwise I think I&apos;ll go with option 1) since I believe it has the least potential to break any ODBC stuff. And with that option it should be easy enough for someone familiar with ODBC to clean up metadata.properties later.&lt;/p&gt;</comment>
                            <comment id="12370533" author="army" created="Thu, 16 Mar 2006 01:19:29 +0000"  >&lt;p&gt;My own personal preference would be for option #3.  ODBCMetadataGenerator.java has the following:&lt;/p&gt;

&lt;p&gt;	// Types of changes that are possible.  There are three&lt;br/&gt;
	// types that we handle here:&lt;br/&gt;
	//&lt;br/&gt;
	//	1. Column rename:&lt;br/&gt;
	//		Rename a column to have an ODBC-specified name.&lt;br/&gt;
	//		For ex. change &quot;SCALE&quot; to &quot;DECIMAL_DIGITS&quot;&lt;br/&gt;
	//	2. Type and/or value change:&lt;br/&gt;
	//		Cast a column to an OBDC-specified type.  At time&lt;br/&gt;
	//		of writing, this was just for casting INTs to&lt;br/&gt;
	//		SMALLINTs; OR modify an existing JDBC value&lt;br/&gt;
	//		to match the ODBC specification.&lt;br/&gt;
	//	3. Additional column(s):&lt;br/&gt;
	//		Add a new, ODBC-specified column to an existing&lt;br/&gt;
	//		result set.&lt;br/&gt;
	private final byte COL_RENAME_CHANGE = 0x01;&lt;br/&gt;
	private final byte TYPE_VALUE_CHANGE = 0x02;&lt;br/&gt;
	private final byte ADD_COLUMN_CHANGE = 0x04;&lt;/p&gt;

&lt;p&gt;So it seems like the most &quot;complete&quot; change would be to add a #4 for removing non-ODBC columns.  As you said, that would be more work, but I also think it would be most helpful as it would provide a common basis for generating ODBC-compliant queries in the future.&lt;/p&gt;

&lt;p&gt;That said, Derby is a scratch-your-own-itch world so if you feel like going with approach #1 and it doesn&apos;t break existing ODBC functionality, that&apos;s your choice.  However, I am a bit concerned by this comment:&lt;/p&gt;

&lt;p&gt;&amp;gt; And with that option it should be easy enough for someone familiar with ODBC to clean up metadata.properties later.&lt;/p&gt;

&lt;p&gt;What kind of &quot;cleanup&quot; are we talking about here?&lt;/p&gt;</comment>
                            <comment id="12370659" author="dyret" created="Thu, 16 Mar 2006 17:12:08 +0000"  >&lt;p&gt;I was just thinking about removing the old queries when ODBCMetadataGenerator has been changed so that the new queries get transformed correctly.&lt;br/&gt;
Would it be ok if I go with option 1), for now, but create a new JIRA for the change to ODBCMetadataGenerator ? I might even try to fix it myself at some point, but right now I would like to limit the scope of this patch if at all possible. &lt;/p&gt;</comment>
                            <comment id="12370705" author="dyret" created="Fri, 17 Mar 2006 00:23:32 +0000"  >&lt;p&gt;Based on the information in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-573&quot; title=&quot;Provide support for optimizer overrides in Derby.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-573&quot;&gt;&lt;del&gt;DERBY-573&lt;/del&gt;&lt;/a&gt; I have run the runphases script to test upgrade. But I don&apos;t really understand the output (there&apos;s a lot of it) since it contains both &quot;PASS&quot; and &quot;FAIL&quot; and exceptions... I have attached the output here, so hopefully someone can have a look at it and tell me if there are any problems...&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="12370706" author="army" created="Fri, 17 Mar 2006 00:25:54 +0000"  >&lt;p&gt;&amp;gt; Would it be ok if I go with option 1), for now, but create a new JIRA &lt;br/&gt;
&amp;gt; for the change to ODBCMetadataGenerator ? I might even try to fix it &lt;br/&gt;
&amp;gt; myself at some point, but right now I would like to limit the scope of &lt;br/&gt;
&amp;gt; this patch if at all possible.&lt;/p&gt;

&lt;p&gt;Sure, that sounds fair to me.&lt;/p&gt;</comment>
                            <comment id="12370798" author="dyret" created="Fri, 17 Mar 2006 18:07:00 +0000"  >&lt;p&gt;I have attached a patch (derby-1006.v1.*) for this. There is currently much discussion around metadata and upgrade, so a couple of comments are in order:&lt;/p&gt;

&lt;p&gt;1) As mentioned previously, the patch introduces a NEW query (getProcedures40) to ensure that it gets picked up, even when doing soft upgrade&lt;br/&gt;
2) I have tried to run the phaseTester.java test, but since I have modified the metadata.java master files, the output is expected to change (as I understand it). The resulting output was attached previously (upgrade.txt)&lt;br/&gt;
3) A new column is added to the returned result set, but the value for this column comes from an existing column in a system table, so this should not be an upgrade problem &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
4)  If/when this patch gets accepted into the code line, I will log a new JIRA for the task of modifying ODBCMetaDataGenerator to transform the new queries into ODBC queries, so that the old queries can be removed from metadata.properties.&lt;/p&gt;</comment>
                            <comment id="12370800" author="dyret" created="Fri, 17 Mar 2006 18:11:35 +0000"  >&lt;p&gt;There is a typo in my attachment comment: &apos;derby-1006&apos; should be &apos;derby-1093&apos;. Sorry about the confusion.&lt;/p&gt;</comment>
                            <comment id="12370849" author="kmarsden" created="Sat, 18 Mar 2006 01:33:16 +0000"  >&lt;p&gt;Please wait to commit  this patch until the current issues with ugprade and metadata have been identified and there is community concensus on how to approach for 10.2.  This change affects  metadata.java which impacts the upgrade tests and makes the  current task of identifying the issues that exist even more difficult.  Relevant issues are: &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1076&quot; title=&quot;Resolve the ouput differences in upgrade test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1076&quot;&gt;&lt;del&gt;DERBY-1076&lt;/del&gt;&lt;/a&gt;,  &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1107&quot; title=&quot;For existing databases JDBC metadata queries do not get updated properly  between maintenance versions.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1107&quot;&gt;&lt;del&gt;DERBY-1107&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1120&quot; title=&quot;DatabaseMetaData.getColumnPrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1120&quot;&gt;&lt;del&gt;DERBY-1120&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1075&quot; title=&quot;Combine the script and the test available for upgrade testing into a java test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1075&quot;&gt;&lt;del&gt;DERBY-1075&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

</comment>
                            <comment id="12374022" author="dyret" created="Tue, 11 Apr 2006 21:31:10 +0100"  >&lt;p&gt;Need a new patch that includes changes to the master for the new Upgrade test.&lt;/p&gt;</comment>
                            <comment id="12374073" author="dyret" created="Wed, 12 Apr 2006 02:02:37 +0100"  >&lt;p&gt;I now have a new patch in my sandbox that includes an updated master file for the new Upgrade test. The new master file shows the new column in the result set returned from getProcedures(). With this new master, the Upgrade test passes. &lt;/p&gt;

&lt;p&gt;I see that 2 of the blocker issues, mentioned in a previous comment, remain open. I guess I should delay uploading a new patch until these issues have been closed, so that the patch doesn&apos;t become stale. &lt;/p&gt;</comment>
                            <comment id="12375526" author="dyret" created="Fri, 21 Apr 2006 17:50:44 +0100"  >&lt;p&gt;Although there are still two &quot;blocking&quot; issues open, I&apos;m now attaching a new patch, derby-1093.v2 to this issue. In addition to passing derbyall the patch also passes the jdbc4 suite (embedded and DerbyNetClient), metadata.java and odbc_metadata.java  in all frameworks with java 1.5 and 1.6_b80, and in DerbyNetClient with java 1.3.&lt;/p&gt;

&lt;p&gt;Finally, the patch passes the new UpgradeTest was  with both java 1.5 and java 1.6. (The output is slightly modified since the master for metadata.java was also modified).&lt;/p&gt;

&lt;p&gt;Please review.&lt;br/&gt;
Thanks.  &lt;/p&gt;</comment>
                            <comment id="12375530" author="knutanders" created="Fri, 21 Apr 2006 18:15:13 +0100"  >&lt;p&gt;The patch looks good. I have started a test run and plan to commit the patch if it runs cleanly.&lt;/p&gt;</comment>
                            <comment id="12375560" author="knutanders" created="Fri, 21 Apr 2006 21:25:20 +0100"  >&lt;p&gt;Committed revision 395877.&lt;/p&gt;

&lt;p&gt;Dyre, if you haven&apos;t already done so, could you please file a JIRA issue for the ODBC rewriting? Thanks.&lt;/p&gt;

&lt;p&gt;The JDBC 4.0 tests and the upgrade test ran cleanly. One failure in derbyall, but it looks like a timing issue which I don&apos;t think is related to the patch.&lt;/p&gt;

&lt;p&gt;Diff from the failing test:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/storeall/storemore/onlineBackupTest4.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: onlineBackupTest4 jdk1.5.0_04 storeall:storemore 2006-04-21 13:22:59&lt;br/&gt;
***&lt;br/&gt;
72a73,76&lt;br/&gt;
&amp;gt; 509        |derby backup/compress test                                        &lt;br/&gt;
                                                             &amp;amp;&lt;br/&gt;
&amp;gt; 510        |derby backup/compress test                                        &lt;br/&gt;
                                                             &amp;amp;&lt;br/&gt;
&amp;gt; 511        |derby backup/compress test                                        &lt;br/&gt;
                                                             &amp;amp;&lt;br/&gt;
&amp;gt; 512        |derby backup/compress test                                        &lt;br/&gt;
                                                             &amp;amp;&lt;br/&gt;
74,77d77&lt;br/&gt;
&amp;lt; 509        |derby backup/compress test                                        &lt;br/&gt;
                                                             &amp;amp;&lt;br/&gt;
&amp;lt; 510        |derby backup/compress test                                        &lt;br/&gt;
                                                             &amp;amp;&lt;br/&gt;
&amp;lt; 511        |derby backup/compress test                                        &lt;br/&gt;
                                                             &amp;amp;&lt;br/&gt;
&amp;lt; 512        |derby backup/compress test                                        &lt;br/&gt;
                                                             &amp;amp;&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   onlineBackupTest4 jdk1.5.0_04 storeall:storemore 2006-04-21 13:23:05&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12328911">DERBY-969</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12332491">DERBY-1243</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12328913">DERBY-971</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12324283" name="derby-1093.v1.diff" size="22617" author="dyret" created="Fri, 17 Mar 2006 18:07:00 +0000"/>
                            <attachment id="12324284" name="derby-1093.v1.stat" size="990" author="dyret" created="Fri, 17 Mar 2006 18:07:00 +0000"/>
                            <attachment id="12325659" name="derby-1093.v2.diff" size="19889" author="dyret" created="Fri, 21 Apr 2006 17:50:44 +0100"/>
                            <attachment id="12325660" name="derby-1093.v2.stat" size="1589" author="dyret" created="Fri, 21 Apr 2006 17:50:44 +0100"/>
                            <attachment id="12324285" name="derbyall_report.txt" size="2019601" author="dyret" created="Fri, 17 Mar 2006 18:07:00 +0000"/>
                            <attachment id="12325661" name="derbyall_report.v2.txt" size="3980" author="dyret" created="Fri, 21 Apr 2006 17:50:44 +0100"/>
                            <attachment id="12324260" name="upgrade.txt" size="148896" author="dyret" created="Fri, 17 Mar 2006 00:23:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 16 Mar 2006 01:19:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29855</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0wt3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39133</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>