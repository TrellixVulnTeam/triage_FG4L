<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:24:11 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-928/DERBY-928.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-928] Add ability to network server to accept connections with a certain security mechanism.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-928</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Currently the network server has support for the following security mechanisms&lt;br/&gt;
1) USRIDONL (userid only),&lt;br/&gt;
2) USRIDPWD (clear text userid and password),&lt;br/&gt;
3) EUSRIDPWD (encrypted userid and password).&lt;/p&gt;

&lt;p&gt;Thus the #3 encrypted userid and password security mechanism is secure with respect to the userid/password sent across the wire.  Currently there is no way to setup the network server to ensure that it accepts connections coming in at a certain security mechanism.   It seems reasonable &amp;amp; useful to have a server want to accept connections from clients with a particular security mechanism (e.g  lets say encrypted userid/password and reject usridpwd ie clear text userid and password)&lt;/p&gt;

&lt;p&gt;This jira will add support for this by adding a property to enable the server to be able to accept connections from clients with a certain security mechanism.&lt;br/&gt;
--------------------&lt;br/&gt;
I actually couldnt find if a rank was given to the security mechanisms in the drda spec.  If it were so, then maybe a property for setting the minimum security mechanism accepted by the server would be appropriate.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12328642">DERBY-928</key>
            <summary>Add ability to network server to accept connections with a certain security mechanism.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="skambha">Sunitha Kambhampati</assignee>
                                    <reporter username="skambha">Sunitha Kambhampati</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Feb 2006 09:41:59 +0000</created>
                <updated>Wed, 1 Jul 2009 01:34:47 +0100</updated>
                            <resolved>Wed, 1 Mar 2006 23:29:44 +0000</resolved>
                                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Network Server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12365369" author="skambha" created="Tue, 7 Feb 2006 09:45:40 +0000"  >&lt;p&gt;Proposal as follows:&lt;br/&gt;
Property name:  derby.drda.securityMechanism&lt;br/&gt;
Use this property to set the security mechanism accepted by the server.  If this property is set, then client connections with the security mechanism equal to this property value will only be able to connect to the server.&lt;/p&gt;

&lt;p&gt;This property will be static. Server must be restarted for the property to take effect.&lt;/p&gt;

&lt;p&gt;Currently the network server has support for the following security mechanisms&lt;br/&gt;
1) USRIDONL (userid only),&lt;br/&gt;
2) USRIDPWD (clear text userid and password),&lt;br/&gt;
3) EUSRIDPWD (encrypted userid and password).&lt;/p&gt;

&lt;p&gt;Syntax:&lt;br/&gt;
derby.drda.securityMechanism=securitymechanism&lt;br/&gt;
    where securityMechanism can be one of the following values - USRIDONL, USRIDPWD,EUSRIDPWD.&lt;/p&gt;

&lt;p&gt;E.g.&lt;br/&gt;
derby.drda.securityMechanism=USRIDONL          // to accept connections at USRIDONL security mechanism&lt;br/&gt;
derby.drda.securityMechanism=EUSRIDPWD       // to accept connections at EUSRIDPWD security mechanism&lt;br/&gt;
derby.drda.securityMechanism=USRIDPWD         // to accept connections at USRIDPWD security mechanism&lt;/p&gt;

&lt;p&gt;Question: Whats the best way to specify the values.&lt;br/&gt;
DRDA spec specifies the following secmec (securitymechanism) values.&lt;br/&gt;
USRIDONL = 4&lt;br/&gt;
USRIDPWD = 3&lt;br/&gt;
EUSRIDPWD = 9&lt;/p&gt;

&lt;p&gt;From client perspective:&lt;br/&gt;
Currently in the client url, one would have to pass in the integer value for securityMechanism.&lt;br/&gt;
ij&amp;gt;connect &apos;testdb;securityMechanism=9;user=sa;password=p1&apos;;&lt;/p&gt;

&lt;p&gt;when using the datasource, the setSecurityMechanism(int) on the ClientDataSource can be used.&lt;br/&gt;
Constants are&lt;br/&gt;
ClientDataSource.CLEAR_TEXT_PASSWORD_SECURITY (0x03)&lt;br/&gt;
ClientDataSource.USER_ONLY_SECURITY (0x04)&lt;br/&gt;
ClientDataSource.ENCRYPTED_USER_AND_PASSWORD_SECURITY (0x09)&lt;/p&gt;

&lt;p&gt;Given that there is different ways that the same value is represented,  some possible ways to address this:&lt;br/&gt;
1) Go with integer values for the property.&lt;br/&gt;
e.g  derby.drda.securityMechanism=9&lt;br/&gt;
This will mean the encrypted userid and password.&lt;br/&gt;
pros: consistent with what the client uses to set security mechanism in url when using drivermanager.&lt;br/&gt;
cons: It might be easy to make a mistake with setting number and the number by itself doesnt tell anything unless one looks up the spec/or the code.&lt;/p&gt;

&lt;p&gt;2) Go with names used by ClientDataSource constants.&lt;br/&gt;
e.g. derby.drda.securityMechanism=ENCRYPTED_USER_AND_PASSWORD_SECURITY&lt;br/&gt;
so.&lt;br/&gt;
CLEAR_TEXT_PASSWORD_SECURITY would be same as drda&apos;s USRIDPWD&lt;br/&gt;
USER_ONLY_SECURITY would be same as drda&apos;s USRIDONL&lt;br/&gt;
ENCRYPTED_USER_AND_PASSWORD_SECURITY  would be same as drda&apos;s EUSRIDPWD&lt;br/&gt;
pros: Use these names as it is consistent with the client datasource constants.&lt;br/&gt;
cons: names are too long&lt;/p&gt;

&lt;p&gt;3) Use the drda secmec values itself.&lt;br/&gt;
USRIDONL, USRIDPWD,EUSRIDPWD.&lt;br/&gt;
pros: names are short and are the secmec values used in drda spec.&lt;br/&gt;
cons: names are somewhat cryptic.&lt;/p&gt;

&lt;p&gt;4) A combination of #1 &amp;amp; #2. Support both integer values as well as string values.&lt;br/&gt;
requires more code for validity checking, otherwise ok.&lt;/p&gt;

&lt;p&gt;I lean towards #2 to be consistent with names used to represent the same security mechanism in derby. Does this seem reasonable ?&lt;br/&gt;
I welcome any suggestions/comments on this. Thanks.&lt;/p&gt;

&lt;p&gt;Future possible enhancements:&lt;br/&gt;
1) This property could be used to have a list of security mechanisms to allow instead of just one.&lt;br/&gt;
2) Allow a way to set the security mechanism value in client connection url as a string instead of integer.&lt;br/&gt;
==============================&lt;/p&gt;

&lt;p&gt;Behavior:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;If the property is set to a value that is invalid/unsupported , it will be rejected and an error will be thrown when starting the server.&lt;/li&gt;
	&lt;li&gt;if this property is not set, then the server will accept connections from client with security mechanisms that are currently supported by the server.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;-Client sends ACCSEC with secmec (security mechanism)  to use.&lt;br/&gt;
Server sees ACCSEC, reads the SECMEC value. It the server does not support the requested security mechanism, it returns a list of supported security mechanism otherwise the apprpriate reply data is generated for the requested security mechanism.&lt;br/&gt;
(Reference: Security flows are in DRDA manual, pg 96. Section 4.4.2.)&lt;/p&gt;

&lt;p&gt;When server sees ACCSEC,  and if this property is set, then the server will check if the secmec value requested by client is the same security mechanism set by this property. If yes, then an appropriate reply data is generated for the requested security mechanism, else the server will return just the security mechanism set by this property to represent the security mechanisms that the server supports/accepts.&lt;/p&gt;

&lt;p&gt;I&apos;d appreciate comments and suggestions. Thanks much for reading this.&lt;/p&gt;</comment>
                            <comment id="12365456" author="bryanpendleton" created="Wed, 8 Feb 2006 03:15:04 +0000"  >&lt;p&gt;I&apos;d prefer the friendly string names (USER_ONLY_SECURITY, etc.).&lt;/p&gt;

&lt;p&gt;Actually, I&apos;d prefer to use the friendly string names for &lt;b&gt;both&lt;/b&gt; the server property and the client URL, but you didn&apos;t mention whether that was an option or not. I find &quot;connect &apos;testdb;securityMechanism=9&apos;&quot; to be unappealing.&lt;/p&gt;</comment>
                            <comment id="12365466" author="skambha" created="Wed, 8 Feb 2006 03:57:23 +0000"  >&lt;p&gt;Thanks Bryan for your comments. Yes option #2 - USER_ONLY_SECURITY makes sense to me too. &lt;/p&gt;

&lt;p&gt;In this jira I plan to add this server side property and take can take in values as USER_ONLY_SECURITY, etc. These will internally map to integer constants - the correct SECMEC values. &lt;/p&gt;

&lt;p&gt;I agree the client connection url can be enhanced to take security mechanism as friendly string names and this should be possible with changes to the client side. I think the client connection url should allow even an integer value for the securityMechanism to allow for backward compatibility with older clients. I&apos;ll open a jira for this. Thanks. &lt;/p&gt;</comment>
                            <comment id="12366294" author="skambha" created="Tue, 14 Feb 2006 13:44:18 +0000"  >&lt;p&gt;This patch(Derby928.diff.txt) includes the following changes:&lt;/p&gt;

&lt;p&gt;1. Adds a new property derby.drda.securityMechanism. This property can take in the following valid values&lt;br/&gt;
USER_ONLY_SECURITY, CLEAR_TEXT_PASSWORD_SECURITY,ENCRYPTED_USER_AND_PASSWORD_SECURITY.&lt;/p&gt;

&lt;p&gt;The secmec value mapping of these values is as follows:&lt;br/&gt;
USER_ONLY_SECURITY maps to USRIDONL&lt;br/&gt;
CLEAR_TEXT_PASSWORD_SECURITY mapts to USRIDPWD&lt;br/&gt;
ENCRYPTED_USER_AND_PASSWORD_SECURITY to EUSRIDPWD&lt;/p&gt;

&lt;p&gt;Changes for this in Property.java to add the property name. &lt;br/&gt;
Added get and set methods to NetworkServerControlImpl, add a new variable allowOnlySecurityMechanism to store the secmec (int value) that is mapped from the string value set by this property.  This value is initialized to -1 to represent either an invalid value or a case where the value is not set. &lt;br/&gt;
An error is thrown when starting the server if this value is not set correctly. &lt;/p&gt;

&lt;p&gt;2.When server sees ACCSEC command,  and if this property is set, then the server will check if the secmec value requested by client is the same security mechanism set by this property. If yes, then an appropriate reply data is generated for the requested security mechanism, else the server will return just the security mechanism set by this property to represent the security mechanisms that the server supports/accepts. &lt;br/&gt;
Modified code in following methods in DRDAConnThread&lt;/p&gt;

&lt;p&gt;client sends ACCSEC with a SECMEC value indicating the security mechanism to use. Server parses the ACCSEC command in parseACCSEC method and reads the SECMEC value&lt;/p&gt;

&lt;p&gt;parseACCSEC:&lt;br/&gt;
When server reads the SECMEC value from the client, the following check is added.&lt;br/&gt;
 &amp;#8211; check if the derby.drda.securityMechanism property has been set.&lt;br/&gt;
	A)if property is set,  then check if the client sent secmec value is the same as this property value. If so, then continue with the processing of that security mechanism.&lt;br/&gt;
	B)if property is set and property value is not same as the client sent secmec value, then set the security checkcode to CodePoint.SECCHKCD_NOTSUPPORTED. This will be sent across to the client on a ACCSECRD.&lt;/p&gt;

&lt;p&gt; &amp;#8211; If the derby.drda.securityMechanism has not been set, in that case the server does the processing as before.&lt;br/&gt;
(Note: since an if condition was added because of the check in #A, the previous code that did the processing of various security mechanisms show up in the diff but that code has not been changed&lt;br/&gt;
except for the increased indentation as a result of the code being put in an else clause)&lt;/p&gt;

&lt;p&gt;writeACCSECRD&lt;br/&gt;
&amp;#8211;  in case B in parseACCSEC, if security check code is SECCHKCD_NOTSUPPORTED and if the derby.drda.securityMechanism property has been set, then the secmec value that the server supports will be sent to the client. &lt;/p&gt;

&lt;p&gt;Note: there is another jira entry 926 - protocol error when sending invalid security mechanism. This is because per the DDM manual, the response in ACCSECRD should be of form SECMEC (value&lt;/p&gt;
{value..}
&lt;p&gt;). We currently send 3 secmec codepoints instead of sending a list with the secmec codepoint. &lt;/p&gt;

&lt;p&gt;3. Added test case scenarios in  testSecMec.java and updated master files in both DerbyNet and DerbyNetClient.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Start server with different values for derby.drda.securityMechanism and test with the connection urls using drivermanager and datasource.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    private static String[] derby_drda_securityMechanism = &lt;/p&gt;
{
+            null, //not set
+            &quot;USER_ONLY_SECURITY&quot;,
+            &quot;CLEAR_TEXT_PASSWORD_SECURITY&quot;,
+            &quot;ENCRYPTED_USER_AND_PASSWORD_SECURITY&quot;,
+            &quot;INVALID_VALUE&quot;,
+            &quot;&quot;
+    }
&lt;p&gt;;&lt;/p&gt;

&lt;p&gt;Note: the code changes include putting the entire testSecMec test in a loop to test with the different derby.drda.securityMechanism value.  Because of the addition of the loop, the indentation of the original test in the main method changed and hence the diff shows up. &lt;br/&gt;
Only change was to catch the exception on starting the server for invalid values of derby.drda.securityMechanism.&lt;/p&gt;

&lt;p&gt;I ran derbyall on sun jdk142 with classes on win2k OK. wisconsin test failed but I think that is not related to my changes. &lt;br/&gt;
I have run the testSecMec.java test with ibm142, jdk142, jdk15 in both DerbyNet and DerbyNetClient frameworks ok.&lt;/p&gt;

&lt;p&gt;M      java\engine\org\apache\derby\iapi\reference\Property.java&lt;br/&gt;
M      java\drda\org\apache\derby\impl\drda\NetworkServerControlImpl.java&lt;br/&gt;
M      java\drda\org\apache\derby\impl\drda\DRDAConnThread.java&lt;br/&gt;
M      java\testing\org\apache\derbyTesting\functionTests\tests\derbynet\testSecMec.java&lt;br/&gt;
M      java\testing\org\apache\derbyTesting\functionTests\master\DerbyNet\testSecMec.out&lt;br/&gt;
M      java\testing\org\apache\derbyTesting\functionTests\master\DerbyNetClient\testSecMec.out&lt;/p&gt;

&lt;p&gt;4. In case of the tests, the test wont be able to run in the remote host environment, because it requires the server to be restarted with the different values, whereas in remote host testing - the server is only started once separately from the test harness. I&apos;ll look more and see if there is a way to restart the server on remote host and if so address it as a followup patch &lt;/p&gt;

&lt;p&gt;-------------&lt;/p&gt;

&lt;p&gt;Currently we are not testing valid encrypted userid and password security mechanisms in our tests because the encryption algorithm needed by drda will not work with Sun JCE , will only work with the IBM JCE. It would be nice to add valid cases for encrypted userid password for atleast ibm jce, which I will try to address as a followon patch. I did test valid cases with encrypted userid and password using sample program with the ibm jce and it works ok.&lt;/p&gt;

&lt;p&gt;I&apos;d appreciate it if someone can review these changes. Thanks.&lt;/p&gt;</comment>
                            <comment id="12366377" author="skambha" created="Wed, 15 Feb 2006 05:13:41 +0000"  >&lt;p&gt;Table with the different possible server /client security mechanism interactions. &lt;/p&gt;</comment>
                            <comment id="12366439" author="skambha" created="Wed, 15 Feb 2006 14:51:38 +0000"  >&lt;p&gt;I was looking at the sysinfo information that we print from the server and this also prints information about the properties related to the server.  I will update the patch to ensure information about this new property derby.drda.securityMechanism also gets reflected when calling sysinfo from server.   &lt;/p&gt;</comment>
                            <comment id="12366693" author="skambha" created="Fri, 17 Feb 2006 06:44:54 +0000"  >&lt;p&gt;I have made changes so that information about this property is also picked up when server sysinfo is called.&lt;br/&gt;
I am attaching the following patch &apos;Derby928_v2_diff.txt&apos; and corresponding Derby928_v2_stat.txt&lt;/p&gt;

&lt;p&gt;Changes compared to previous patch (Derby928.diff.txt)&lt;/p&gt;

&lt;p&gt;&amp;#8211;  server sysinfo also prints information about the drda properties. &lt;br/&gt;
Changes were made to ensure that when derby.drda.securityMechanism is set, the sysinfo information for server will reflect that. Added this property value to be picked up only if the property was set. Change in NetworkServerControlImpl#getPropertyValues().  Internally we store the value set by this property as an int. Added a new method getStringValueForSecMec to get mapping from the integer secmec value to corresponding string. &lt;br/&gt;
&amp;#8211; added test sysinfo_withproperties.java. This test sets the derby.drda.securityMechanism property and will print out the sysinfo information of the server. &lt;br/&gt;
&amp;#8211; case of when this property is not set, is tested with the sysinfo.java test, and when the property is set, this case is covered by sysinfo_withproperties.java.&lt;br/&gt;
&amp;#8211; Added some more comments&lt;/p&gt;

&lt;p&gt;I ran derbyall with these changes on jdk142 with classes and all passed except for wisconsin. The wisconsin failure is not related to this change.  &lt;/p&gt;

&lt;p&gt;I&apos;d appreciate it if someone could review this patch.  Thanks. &lt;/p&gt;

&lt;p&gt;E.g.snippet from the master output (sysinfo_withproperties.out)&lt;br/&gt;
+Testing Sysinfo&lt;br/&gt;
+org.apache.derby.drda.NetworkServerControl sysinfo &lt;br/&gt;
+----- Derby Network Server Information --------&lt;br/&gt;
+----- listing properties &amp;#8211;&lt;br/&gt;
+derby.drda.securityMechanism=USER_ONLY_SECURITY&lt;br/&gt;
+derby.drda.maxThreads=0&lt;br/&gt;
+derby.drda.keepAlive=true&lt;br/&gt;
+derby.drda.minThreads=0&lt;br/&gt;
+derby.drda.portNumber=1527&lt;br/&gt;
+derby.drda.logConnections=false&lt;br/&gt;
+derby.drda.timeSlice=0&lt;br/&gt;
+derby.drda.startNetworkServer=false&lt;br/&gt;
+derby.drda.host=xxxFILTERED_HOSTNAMExxx&lt;br/&gt;
+derby.drda.traceAll=false&lt;br/&gt;
+----- Derby Information --------&lt;/p&gt;</comment>
                            <comment id="12368128" author="skambha" created="Wed, 1 Mar 2006 02:29:44 +0000"  >&lt;p&gt;&lt;a href=&quot;http://www.nabble.com/-jira-Created%3A-%28DERBY-928%29-Add-ability-to-network-server-to-accept-connections-with-a-certain-security-mechanism.-t1073183.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/-jira-Created%3A-%28DERBY-928%29-Add-ability-to-network-server-to-accept-connections-with-a-certain-security-mechanism.-t1073183.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks very much Deepa for reviewing this issue. &lt;/p&gt;

&lt;p&gt;Some changes went into testSecMec.java which is why this file wouldnt apply cleanly with the earlier patch. I merged my changes and am attaching a new patch (Derby928.3.diff.txt). Please take a look.&lt;/p&gt;

&lt;p&gt;The only changes in Derby928.3.diff.txt compared to the earlier Derby928.v2.diff.txt is&lt;br/&gt;
&amp;#8211; Added comment to link to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-928&quot; title=&quot;Add ability to network server to accept connections with a certain security mechanism.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-928&quot;&gt;&lt;del&gt;DERBY-928&lt;/del&gt;&lt;/a&gt; html table and also comments to runtest. Also enhanced test to avoid case of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-300&quot; title=&quot;Creation of SQLWarning on a getConnection causes hang on 131 vms when server and client are in same vm.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-300&quot;&gt;&lt;del&gt;DERBY-300&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
&amp;#8211; made one master file for both DerbyNet and DerbyNetClient for sysinfo_withproperties.out &lt;/p&gt;

&lt;p&gt;Ran derbynet/testSecMec.java with classes on ibm131/ibm141/ibm142/ibm15/jdk131/jdk141/jdk15/jdk142 OK.&lt;br/&gt;
Ran derbynetclientmats and derbynetmats on linux/ibm142 ok (with known failures)&lt;/p&gt;

&lt;p&gt;Thanks. &lt;/p&gt;</comment>
                            <comment id="12368135" author="deepa" created="Wed, 1 Mar 2006 03:16:41 +0000"  >&lt;p&gt;Thanks Sunitha for uploading the new patch. It applies cleanly. One small comment: testSecMec.java has many white space diffs not seen in previous patch. It would be good if you can take care of these unwanted diffs. Everything else looks fine.&lt;/p&gt;</comment>
                            <comment id="12368163" author="skambha" created="Wed, 1 Mar 2006 04:56:38 +0000"  >&lt;p&gt;Removed the unwanted space diffs. Ran test derbynet/testSecMec.java with ibm131/ibm141/ibm142/ibm15 as well as the sun jvms. Please look at this patch. Thanks.&lt;/p&gt;</comment>
                            <comment id="12368183" author="deepa" created="Wed, 1 Mar 2006 07:50:38 +0000"  >&lt;p&gt;I have reviewed and run tests with the latest version &apos;Derby928.3.diff.txt&apos;. I ran derbynetmats and derbynetclientmats with Sun JDK1.4.2 on Windows XP. All tests passed. The patch looks good to me. &lt;/p&gt;

&lt;p&gt;My +1 to commit this patch.&lt;/p&gt;</comment>
                            <comment id="12368184" author="kmarsden" created="Wed, 1 Mar 2006 08:16:16 +0000"  >&lt;p&gt;I will review and look at committing this patch&lt;/p&gt;</comment>
                            <comment id="12368229" author="kmarsden" created="Wed, 1 Mar 2006 15:57:48 +0000"  >&lt;p&gt;I reviewed this patch and it looks good  to me.&lt;br/&gt;
My only tiny point is that I kept having to look at the instances of this condition over and over to try to understand &lt;br/&gt;
what it meant, something about the double negative.&lt;/p&gt;

&lt;p&gt;if ( (server.getSecurityMechanism() !=&lt;br/&gt;
    NetworkServerControlImpl.INVALID_OR_NOTSET_SECURITYMECHANISM) ...&lt;/p&gt;

&lt;p&gt;Maybe a boolean method: server.restrictsSecurityMechanism()  or some such would be clearer.&lt;/p&gt;

&lt;p&gt;I am running tests and will check in in the morning.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;

</comment>
                            <comment id="12368290" author="kmarsden" created="Wed, 1 Mar 2006 23:29:44 +0000"  >&lt;p&gt;Checked this into the trunk&lt;br/&gt;
Date: Wed Mar  1 05:55:05 2006&lt;br/&gt;
New Revision: 382019&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/viewcvs?rev=382019&amp;amp;view=rev&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs?rev=382019&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The patch description was pretty big and cut over two comments so instead of cutting and pasting the description into the checkin comment I just referred to the comments in the bug.&lt;/p&gt;</comment>
                            <comment id="12368780" author="kmarsden" created="Sat, 4 Mar 2006 04:15:59 +0000"  >&lt;p&gt;I spoke with Sunitha briefly about the behaviour of old clients with this property and think there might be at least a release note needed.  Sunitha could you summarize the behaviour of older clients, JCC and ODBC when derby.drda.securityMechanism  is set?&lt;/p&gt;

&lt;p&gt;Thanks &lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;




</comment>
                            <comment id="12368788" author="bandaram" created="Sat, 4 Mar 2006 05:26:20 +0000"  >&lt;p&gt;Sunitha, since this seems to add new functionality, should this entry be listed in DerbyDevActivities Wiki page? I think keeping that page accurate, while optional, will help ensure documentation and/or release note additions are done correctly for 10.2. Let me know if you need the Wiki URL, I am sure you know it. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12368816" author="skambha" created="Sat, 4 Mar 2006 08:35:42 +0000"  >&lt;p&gt;JCC 2.6 behavior has changed from JCC2.4 with respect to how security mechanisms are handled.  I am attaching a patch to fix some masters to run cleanly with jcc2.6.&lt;/p&gt;

&lt;p&gt;This patch &apos;Derby928_canons.diff.txt&apos; updates &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;master files for derbynet/testSecMec.java for difference in behavior in jcc2.6 from 2.4&lt;/li&gt;
	&lt;li&gt;puts testSecMec.java and sysinfo_withproperties in exclude for remote server testing as both these tests require the server to be restarted with the different properties set.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The JCC 2.6 client does the following: if the client sends a security mechanism of 3( clear text userid and password) and if the server does not accept this security mechanism but supports encrypted userid/password , in that case the client will then use security mechanism (9) -encrypted userid and password and send it to the server.&lt;/p&gt;

&lt;p&gt;This auto-switching is only in 2.6 client and not in 2.4 JCC.  I have verified this behavior by seeing what the jcc 2.6 client is sending to the server in the debugger and have also verified it with the JCC folks.&lt;/p&gt;

&lt;p&gt;This is a test master update only. &lt;br/&gt;
I have run derbynet/testSecMec.java with classes with jdk131/jdk141/jdk142/jdk15/ibm131/ibm141/ibm142/ibm15 with JCC 2.6 driver OK.&lt;/p&gt;

&lt;p&gt;svn stat&lt;br/&gt;
A      java\testing\org\apache\derbyTesting\functionTests\master\DerbyNet\ver2.6\testSecMec.out&lt;br/&gt;
A      java\testing\org\apache\derbyTesting\functionTests\master\DerbyNet\ibm14\ver2.6&lt;br/&gt;
A      java\testing\org\apache\derbyTesting\functionTests\master\DerbyNet\ibm14\ver2.6\testSecMec.out&lt;br/&gt;
M      java\testing\org\apache\derbyTesting\functionTests\suites\DerbyNetRemote.exclude&lt;br/&gt;
M      java\testing\org\apache\derbyTesting\functionTests\suites\DerbyNetClientRemote.exclude&lt;/p&gt;


&lt;p&gt;Can someone please review and commit this change. Thanks. &lt;/p&gt;</comment>
                            <comment id="12368818" author="fuzzylogic" created="Sat, 4 Mar 2006 09:06:10 +0000"  >&lt;p&gt;Committed new masters in patch Derby928_canons.diff.txt with revision 382975.&lt;/p&gt;</comment>
                            <comment id="12427569" author="skambha" created="Fri, 11 Aug 2006 18:52:05 +0100"  >&lt;p&gt;Adding the release note needed flag.  Information is in wiki &lt;a href=&quot;http://wiki.apache.org/db-derby/SecurityMechanism&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/db-derby/SecurityMechanism&lt;/a&gt;   I&apos;ll try to post the info in release note format.&lt;/p&gt;</comment>
                            <comment id="12428731" author="mamtas" created="Thu, 17 Aug 2006 19:26:29 +0100"  >&lt;p&gt;Linking the 2 issues because &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1682&quot; title=&quot;Add documentation for derby.drda.securityMechanism.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1682&quot;&gt;&lt;del&gt;DERBY-1682&lt;/del&gt;&lt;/a&gt; is the documentation counterpart of this feature.&lt;/p&gt;</comment>
                            <comment id="12434846" author="skambha" created="Fri, 15 Sep 2006 00:24:09 +0100"  >&lt;p&gt;Not quite sure  if we want a release note for this new property that is being added in 10.2, as this is documented in the server guide. Kathey had suggested in one of her comments that we should probably mention the impact on older clients.&lt;br/&gt;
I started to write the release note in the release note format and it didnt seem appropriate for this case.   So I just took a shot at adding some info for the release note. &lt;/p&gt;

&lt;p&gt;I&apos;d appreciate comments/suggestions on what other info we would want to include in the release note for this issue.&lt;/p&gt;

&lt;p&gt;First draft at release note info.  &lt;br/&gt;
=========================&lt;br/&gt;
With 10.2 release, Derby provides a server property derby.drda.securityMechanism to restrict securityMechanisms accepted from the client.  This property is not set by default and thus will not have any impact on existing older clients (JCC, 10.1 derby client, odbc client).&lt;/p&gt;

&lt;p&gt;If the 10.2 server is started with derby.drda.securityMechanism property set to a valid security mechanism, the Network Server will accept only connections from clients which use that security mechanism. No other types of connections are accepted.  For e.g. If the client sends a securityMechanism that is not accepted by the server, the error message at the JCC client  will look similar to  this &quot;Connection authorization failure occurred. Reason: security mechanism not supported&quot; and with Derby client, it  will look  like this &quot;Connection authentication failure occurred.  Reason: security mechanism not supported.&quot;&lt;/p&gt;

&lt;p&gt;==========================&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12435007" author="rhillegas" created="Fri, 15 Sep 2006 16:41:30 +0100"  >&lt;p&gt;Toggling off the &quot;release note needed flag&quot; since I&apos;m already tracking this issue on the 10.2 snapshot wiki page.&lt;/p&gt;</comment>
                            <comment id="12551307" author="fuzzylogic" created="Thu, 13 Dec 2007 09:04:47 +0000"  >&lt;p&gt;This issue has been resolved for over a year with no further movement. Closing.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12347831">DERBY-1682</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12323518" name="Derby928.3.diff.txt" size="38847" author="skambha" created="Wed, 1 Mar 2006 04:56:38 +0000"/>
                            <attachment id="12323502" name="Derby928.3.stat.txt" size="1276" author="skambha" created="Wed, 1 Mar 2006 02:29:44 +0000"/>
                            <attachment id="12322951" name="Derby928.diff.txt" size="24246" author="skambha" created="Tue, 14 Feb 2006 13:44:18 +0000"/>
                            <attachment id="12322952" name="Derby928.stat.txt" size="482" author="skambha" created="Tue, 14 Feb 2006 13:44:18 +0000"/>
                            <attachment id="12322971" name="Derby928_Table_SecurityMechanisms..htm" size="42116" author="skambha" created="Wed, 15 Feb 2006 05:13:41 +0000"/>
                            <attachment id="12323705" name="Derby928_canons.diff.txt" size="14967" author="skambha" created="Sat, 4 Mar 2006 08:35:42 +0000"/>
                            <attachment id="12323706" name="Derby928_canons.stat.txt" size="472" author="skambha" created="Sat, 4 Mar 2006 08:35:42 +0000"/>
                            <attachment id="12323081" name="Derby928_v2_diff.txt" size="38635" author="skambha" created="Fri, 17 Feb 2006 06:44:54 +0000"/>
                            <attachment id="12323082" name="Derby928_v2_stat.txt" size="1393" author="skambha" created="Fri, 17 Feb 2006 06:44:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Feb 2006 03:15:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29783</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0sjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38444</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>