<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:50:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2669/DERBY-2669.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2669] If no territory attribute is not specified at create database time, then we should ignore the collation attribute if specified.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2669</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;If a user specifies a create database url like following&lt;br/&gt;
jdbc:derby:abcDB;create=true;collation=TERRITORY_BASED&lt;br/&gt;
we should ignore the collation attribute because no territory attribute has been specified. The current Derby 10.3 code does not do that. Once this is fixed, we should add a test case for it in CollationTest.java&lt;/p&gt;</description>
                <environment></environment>
        <key id="12369649">DERBY-2669</key>
            <summary>If no territory attribute is not specified at create database time, then we should ignore the collation attribute if specified.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikem">Mike Matrigali</assignee>
                                    <reporter username="mamtas">Mamta A. Satoor</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 May 2007 08:26:41 +0100</created>
                <updated>Fri, 21 Jan 2011 17:50:11 +0000</updated>
                            <resolved>Mon, 28 May 2007 10:34:31 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12496884" author="djd" created="Fri, 18 May 2007 15:27:00 +0100"  >&lt;p&gt;-1&lt;br/&gt;
A database always has a territory, when not explictly specified at create time it defaults to the locale of the JVM.&lt;/p&gt;</comment>
                            <comment id="12496942" author="mamtas" created="Fri, 18 May 2007 17:31:58 +0100"  >&lt;p&gt;Let me start out by asking this question - when user says collatoin=TERRITORY_BASED without an explicit terriotry attribute, don&apos;t we want the collation to be UCS_BASIC for user schemas too? ie use the same collation which is UCS_BASIC for both user schemas and system schemas?&lt;/p&gt;</comment>
                            <comment id="12496990" author="mamtas" created="Fri, 18 May 2007 19:36:05 +0100"  >&lt;p&gt;Just want to record the current Derby 10.3 behavior for a database where collation=TERRITORY_BASED and no territory is specified&lt;/p&gt;

&lt;p&gt;ij&amp;gt; connect &apos;jdbc:derby:c:/dellater/db1_52_data;create=true;collation=TERRITORY_BASED&apos;;&lt;br/&gt;
ij&amp;gt; select tablename from sys.systables where tablename=&apos;T1&apos;;&lt;br/&gt;
ERROR 42818: Comparisons between &apos;VARCHAR&apos; and &apos;CHAR&apos; are not supported.&lt;/p&gt;

&lt;p&gt;This does not seem correct. I think although user has asked for TERRITORY_BASE collation, since no territory attribute is specified, internally, we should be using UCS_BASIC for both system and user schemas.&lt;/p&gt;</comment>
                            <comment id="12496991" author="djd" created="Fri, 18 May 2007 19:44:56 +0100"  >&lt;p&gt;&amp;gt; Let me start out by asking this question - when user says collatoin=TERRITORY_BASED without an explicit terriotry attribute, don&apos;t we want the collation to be UCS_BASIC for user schemas too? ie use the same collation which is UCS_BASIC for both user schemas and system schemas?&lt;/p&gt;

&lt;p&gt;Why? The user asked for TERRITORY_BASED collation and the database has a territory.&lt;/p&gt;</comment>
                            <comment id="12497003" author="mamtas" created="Fri, 18 May 2007 20:17:38 +0100"  >&lt;p&gt;I need to admit that I am not sure why I assumed that collation attribute with value TERRITORY_BASED and no territory attribute should translate to UCS_BASIC for user schemas. &lt;/p&gt;

&lt;p&gt;It looks like then we are doing the right thing already. And following behavior is as expected&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:c:/dellater/db1_52_data;create=true;collation=TERRITORY_BASED&apos;; &lt;br/&gt;
ij&amp;gt; select tablename from sys.systables where tablename=&apos;T1&apos;; &lt;br/&gt;
ERROR 42818: Comparisons between &apos;VARCHAR&apos; and &apos;CHAR&apos; are not supported. &lt;/p&gt;

&lt;p&gt;I will go ahead and mark this as not an issue.&lt;/p&gt;</comment>
                            <comment id="12497016" author="mamtas" created="Fri, 18 May 2007 21:11:26 +0100"  >&lt;p&gt;Laura had following comment on this issue on derby-dev&lt;/p&gt;

&lt;p&gt;You seem to be selecting from a system table. Yet the documentation says&lt;/p&gt;

&lt;p&gt;&quot;The collation attribute applies only to user-defined tables. The&lt;br/&gt;
system tables use the Unicode codepoint collation.&quot;&lt;/p&gt;

&lt;p&gt;Am I missing something?&lt;/p&gt;</comment>
                            <comment id="12497018" author="mamtas" created="Fri, 18 May 2007 21:18:30 +0100"  >&lt;p&gt;Laura, I selected on purpose from system table to show that system tables character columns will have collation of UCS_BASIC and the character constant &apos;T1&apos; will have collation of user-schema which is TERRITORY_BASED for this db1_52 database and hence the comparison between system table character column and constant character string will fail when the comparison is done inside a user schema.&lt;/p&gt;

&lt;p&gt;Note that character string constants pickup their collation from the current schema which in my example above is &apos;APP&apos; schema which is user schema.&lt;/p&gt;

&lt;p&gt;If the same query above is executed inside SYS schema, then the query won&apos;t fail&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:c:/dellater/db1_52_data;create=true;collation=TERRITORY_BASED&apos;; &lt;br/&gt;
ij&amp;gt; set schema SYS;&lt;br/&gt;
0 rows selected&lt;br/&gt;
ij&amp;gt; select tablename from sys.systables where tablename=&apos;T1&apos;; &lt;br/&gt;
TABLENAME&lt;br/&gt;
---------------------------------------------------------------&lt;br/&gt;
0 rows selected&lt;/p&gt;

&lt;p&gt;In the case above, character string constant &apos;T1&apos; picked up the collation of SYS schema and hence the comparison did not fail.&lt;/p&gt;</comment>
                            <comment id="12497734" author="mamtas" created="Tue, 22 May 2007 07:36:33 +0100"  >&lt;p&gt;Derby is behaving as expected when JDBC url has no territory attribute but it has collation attibute with value as terriotry based. But before we close this Jira entry, we should add a test case for this.&lt;/p&gt;</comment>
                            <comment id="12499513" author="mikem" created="Mon, 28 May 2007 10:26:19 +0100"  >&lt;p&gt;The decision on this issue is to implement the following (which is not the short or long description)&lt;/p&gt;

&lt;p&gt;If a user specifies a create database url like following&lt;br/&gt;
jdbc:derby:abcDB;create=true;collation=TERRITORY_BASED&lt;br/&gt;
then a territory based collation database will be created using whatever the current territory of the JVM is. &lt;/p&gt;</comment>
                            <comment id="12499515" author="mikem" created="Mon, 28 May 2007 10:34:31 +0100"  >&lt;p&gt;The following commit adds a test of the expected behavior to the CollationTest2 test.  &lt;/p&gt;

&lt;p&gt;m3_ibm5:42&amp;gt;svn commit&lt;/p&gt;

&lt;p&gt;Sending        java\testing\org\apache\derbyTesting\functionTests\tests\lang\CollationTest2.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 542175.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12345445">DERBY-1478</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 18 May 2007 14:27:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30561</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0me7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37446</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>