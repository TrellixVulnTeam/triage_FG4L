<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:46:30 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4484/DERBY-4484.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4484] Add import/export support for UDTs.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4484</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Import/export should work on UDTs.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12443771">DERBY-4484</key>
            <summary>Add import/export support for UDTs.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 Dec 2009 15:19:21 +0000</created>
                <updated>Wed, 12 Jan 2011 19:12:36 +0000</updated>
                            <resolved>Wed, 10 Feb 2010 19:29:07 +0000</resolved>
                                    <version>10.6.1.0</version>
                                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12806539" author="rhillegas" created="Fri, 29 Jan 2010 22:32:03 +0000"  >&lt;p&gt;Attaching derby-4484-01-ac-basicExportImport.diff. This adds basic support for exporting and importing UDT columns. UDTs can be exported and imported alongside other columns to/from a file. Regression tests are running.&lt;/p&gt;

&lt;p&gt;This patch does NOT support dumping and retrieving UDT columns to/from a side file devoted to large objects--as can be done for LOBs and large binary columns. But that would be a useful next improvement.&lt;/p&gt;

&lt;p&gt;In exporting a UDT column, it is serialized first to a byte array. Then that array is turned into a hex string just like a VARBINARY column. Importing the UDT reverses this process.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;---------&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/iapi/types/DataTypeDescriptor.java&lt;br/&gt;
M      java/engine/org/apache/derby/catalog/types/BaseTypeIdImpl.java&lt;br/&gt;
M      java/engine/org/apache/derby/catalog/types/UserDefinedTypeIdImpl.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/ValueNode.java&lt;/p&gt;

&lt;p&gt;Type system support for UDTs was improved to make it possible to create a UDT descriptor from the schema qualified name of the type. The Import VTI needs this. Along the way, the ValueNode was improved to bind a classname to these UDT descriptors.&lt;/p&gt;

&lt;p&gt;---------&lt;/p&gt;


&lt;p&gt;M      java/engine/org/apache/derby/impl/load/ExportAbstract.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/load/ColumnInfo.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/load/Import.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/load/ImportResultSetMetaData.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/load/ImportAbstract.java&lt;/p&gt;

&lt;p&gt;Changes to export and import to allow UDT columns in exported files. The import machinery is a little tricky because it relies on a VTI, whose metadata descriptions had to be improved.&lt;/p&gt;


&lt;p&gt;---------&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/impl/sql/compile/CreateTableNode.java&lt;/p&gt;

&lt;p&gt;The ImportExportTest uncovered some flaws in CREATE TABLE AS which prevented us from creating a table&apos;s shape from a query if one of the result columns was of UDT type. Fixed in this patch.&lt;/p&gt;


&lt;p&gt;---------&lt;/p&gt;

&lt;p&gt;M      java/testing/org/apache/derbyTesting/functionTests/tests/lang/UDTTest.java&lt;br/&gt;
M      java/testing/org/apache/derbyTesting/functionTests/tests/tools/ImportExportTest.java&lt;/p&gt;

&lt;p&gt;Regression tests for basic export/import of UDT columns.&lt;/p&gt;

&lt;p&gt;---------&lt;/p&gt;</comment>
                            <comment id="12806574" author="rhillegas" created="Sat, 30 Jan 2010 00:10:50 +0000"  >&lt;p&gt;Tests passed cleanly for me on derby-4484-01-ac-basicExportImport.diff.&lt;/p&gt;</comment>
                            <comment id="12828123" author="rhillegas" created="Mon, 1 Feb 2010 14:38:55 +0000"  >&lt;p&gt;Committed derby-4484-01-ac-basicExportImport.diff at subversion revision 905289.&lt;/p&gt;</comment>
                            <comment id="12828141" author="knutanders" created="Mon, 1 Feb 2010 15:28:10 +0000"  >&lt;p&gt;In UserDefinedTypeIdImpl, there&apos;s an error handler that looks like this:&lt;/p&gt;

&lt;p&gt;+        } catch (Exception e) &lt;/p&gt;
{ throw new IllegalArgumentException( e.getMessage() ); }

&lt;p&gt;Here, the stack trace of the original error is lost, and it&apos;s also not obvious to me that any error happening in that method must be because of an illegal argument. I&apos;d suggest that this method is declared to throw StandardException instead (I think that&apos;s the only checked exception in the method) and the try/catch is removed. Alternatively, use iapi.error.PassThroughException instead of IllegalArgumentException so that the original exception and stack trace can be unwrapped by higher-level error handlers.&lt;/p&gt;

&lt;p&gt;Similarly, I think this error handler in ColumnInfo.getUDTClassName()&lt;/p&gt;

&lt;p&gt;+        catch (Exception e) &lt;/p&gt;
{ throw new SQLException( e.getMessage() ); }

&lt;p&gt;should throw LoadError.unexpectedError(e) instead (for preservation of stack trace and SQLState).&lt;/p&gt;</comment>
                            <comment id="12828162" author="rhillegas" created="Mon, 1 Feb 2010 16:18:35 +0000"  >&lt;p&gt;Thanks, Knut. Those are good suggestions. Attaching derby-4484-02-aa-exceptionHandling.diff, which makes those changes. Touches the following files:&lt;/p&gt;

&lt;p&gt;M      java/engine/org/apache/derby/impl/load/ColumnInfo.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/JavaValueNode.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/compile/sqlgrammar.jj&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSCOLUMNSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSALIASESRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSCOLPERMSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSSTATISTICSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSSEQUENCESRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSROUTINEPERMSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSVIEWSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSTABLEPERMSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSCHECKSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSFILESRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSTABLESRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSKEYSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSDEPENDSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSSCHEMASRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSROLESRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSFOREIGNKEYSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSTRIGGERSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSPERMSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSSTATEMENTSRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SYSCONGLOMERATESRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/impl/sql/catalog/SystemColumnImpl.java&lt;br/&gt;
M      java/engine/org/apache/derby/iapi/sql/dictionary/CatalogRowFactory.java&lt;br/&gt;
M      java/engine/org/apache/derby/iapi/types/TypeId.java&lt;br/&gt;
M      java/engine/org/apache/derby/iapi/types/DataTypeDescriptor.java&lt;br/&gt;
M      java/engine/org/apache/derby/iapi/types/JSQLType.java&lt;br/&gt;
M      java/engine/org/apache/derby/catalog/types/UserDefinedTypeIdImpl.java&lt;/p&gt;</comment>
                            <comment id="12828180" author="knutanders" created="Mon, 1 Feb 2010 16:49:53 +0000"  >&lt;p&gt;Thanks for making these changes, Rick. I didn&apos;t realize that adding a throws declaration to UserDefinedTypeIdImpl&apos;s constructor would affect so many files... But the changes look good to me. +1 to commit if the regression tests still pass.&lt;/p&gt;</comment>
                            <comment id="12828366" author="rhillegas" created="Tue, 2 Feb 2010 00:22:59 +0000"  >&lt;p&gt;Thanks, Knut. The tests ran cleanly for me. Committed derby-4484-02-aa-exceptionHandling.diff at subversion revision 905472.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12325061">DERBY-651</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12431832" name="derby-4484-01-ac-basicExportImport.diff" size="29636" author="rhillegas" created="Fri, 29 Jan 2010 22:32:03 +0000"/>
                            <attachment id="12434416" name="derby-4484-02-aa-exceptionHandling.diff" size="20941" author="rhillegas" created="Mon, 1 Feb 2010 16:18:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 1 Feb 2010 15:28:10 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31249</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0o5r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37732</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>