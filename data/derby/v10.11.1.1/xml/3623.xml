<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:34 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3623/DERBY-3623.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3623] Convert deadlockMode.java to JUnit</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3623</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description></description>
                <environment></environment>
        <key id="12394038">DERBY-3623</key>
            <summary>Convert deadlockMode.java to JUnit</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="espinha">Tiago R. Espinha</assignee>
                                    <reporter username="espinha">Tiago R. Espinha</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Apr 2008 22:03:42 +0100</created>
                <updated>Mon, 4 May 2009 19:22:17 +0100</updated>
                            <resolved>Fri, 25 Apr 2008 22:33:39 +0100</resolved>
                                                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12590456" author="espinha" created="Fri, 18 Apr 2008 14:54:27 +0100"  >&lt;p&gt;Added a replacement test using JUnit. The file should be added and deadlockMode.java deleted. Changed the name for coherence with the rest of the tests. It&apos;s my first conversion and I tried to a maximum to stick with the Java code conventions. Any tips are appreciated.&lt;/p&gt;</comment>
                            <comment id="12591030" author="espinha" created="Mon, 21 Apr 2008 21:13:45 +0100"  >&lt;p&gt;Added a patch for the following:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Remove the old harness test and its files&lt;/li&gt;
	&lt;li&gt;Add the new test&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;derbyall passed, suites.All passed with just one failure that I believe to not be related with my changes. It had something to do with collation and I believe someone else was just tampering with it.&lt;/p&gt;</comment>
                            <comment id="12591082" author="kmarsden" created="Mon, 21 Apr 2008 23:03:18 +0100"  >&lt;p&gt;Need to remove master/deadlockMode.out.&lt;/p&gt;

&lt;p&gt;-Table setup should be in decorateSQL method instead of setup.  Then cleanup of the table will be automatic. See BatchUpdateTest for an example.&lt;/p&gt;

&lt;p&gt;-There is no need to check success of each insert.  It will just throw an exception if there is a problem.&lt;/p&gt;

&lt;p&gt;When I run the test it passes but I see these exceptions in the console: I think the code:&lt;br/&gt;
 } catch (Exception e) &lt;/p&gt;
{
            checkThreadsDone();
            
            assertNull(
                    &quot;FAIL - Exception thrown&quot;,
                    e);
        }
&lt;p&gt;is not quite right. We normally want to throw the exception but since this is a multithreaded test I see that won&apos;t quite work.  Anyway I am investigating.&lt;/p&gt;


&lt;p&gt;testThreadsUpdatingTable Exception in thread &quot;Thread-26&quot; junit.framework.AssertionFailedError: FAIL - Exception thrown&lt;br/&gt;
        at junit.framework.Assert.fail(Assert.java:47)&lt;br/&gt;
        at junit.framework.Assert.assertTrue(Assert.java:20)&lt;br/&gt;
        at junit.framework.Assert.assertNull(Assert.java:233)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.DeadlockModeTest.threadWorker(DeadlockModeTest.java:201)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.DeadlockModeTest.access$000(DeadlockModeTest.java:46)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.DeadlockModeTest$1.run(DeadlockModeTest.java:133)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:803)&lt;br/&gt;
...&lt;/p&gt;</comment>
                            <comment id="12591089" author="kmarsden" created="Mon, 21 Apr 2008 23:15:36 +0100"  >&lt;p&gt;The core exception seems to be:&lt;/p&gt;

&lt;p&gt;java.sql.SQLSyntaxErrorException: Table/View &apos;T&apos; does not exist.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:91)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:201)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:391)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:2125)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(ConnectionChild.java:81)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:614)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(EmbedStatement.java:175)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.DeadlockModeTest.threadWorker(DeadlockModeTest.java:184)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.DeadlockModeTest.access$000(DeadlockModeTest.java:46)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.DeadlockModeTest$1.run(DeadlockModeTest.java:133)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;</comment>
                            <comment id="12591099" author="kmarsden" created="Tue, 22 Apr 2008 00:01:33 +0100"  >&lt;p&gt;I made this quick test to see what happens with asserts in spawned threads and the result is that they do not cause the test to fail.  I think we will need some mechanism to accumulate the exceptions to be reported in the event of failure.&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;</comment>
                            <comment id="12592467" author="espinha" created="Fri, 25 Apr 2008 19:51:04 +0100"  >&lt;p&gt;Added a new patch file. This one already removes master/deadlockMode.out and fixes all the aforementioned issues.&lt;/p&gt;

&lt;p&gt;The table creation and filling is now done on decorateSQL as suggested by Kathey, and since threads&apos; asserts won&apos;t affect the main test flow, added a LinkedList that cumulates all the exceptions thrown by threads. This list is then checked by the main thread (upon all the other threads having finished) and if there are exceptions, the test fails().&lt;/p&gt;</comment>
                            <comment id="12592476" author="kmarsden" created="Fri, 25 Apr 2008 20:25:30 +0100"  >&lt;p&gt;What&apos;s the difference between baseSuite and encryptedBaseSuite?  Why are both needed?&lt;/p&gt;</comment>
                            <comment id="12592477" author="espinha" created="Fri, 25 Apr 2008 20:30:24 +0100"  >&lt;p&gt;My bad, forgot to explain that.&lt;/p&gt;

&lt;p&gt;encryptedBaseSuite applies an ecryptedDatabase Decorator to the suite before inserting it into a CleanDatabaseTestSetup, whereas baseSuite does the exact same thing just without the encryption.&lt;/p&gt;

&lt;p&gt;The only difference is a call to Decorator.encryptedDatabase(suite) present on encryptedBaseSuite, while on the baseSuite the &quot;suite&quot; object is used directly, without being wrapped in the decorator.&lt;/p&gt;</comment>
                            <comment id="12592513" author="espinha" created="Fri, 25 Apr 2008 22:33:39 +0100"  >&lt;p&gt;Fixed on revision 651703.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12380648" name="ThreadTest.java" size="1765" author="kmarsden" created="Tue, 22 Apr 2008 00:01:33 +0100"/>
                            <attachment id="12380962" name="derby3623-20080425.patch" size="22054" author="espinha" created="Fri, 25 Apr 2008 19:48:04 +0100"/>
                            <attachment id="12380638" name="derby3623.patch" size="20703" author="espinha" created="Mon, 21 Apr 2008 21:11:32 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 21 Apr 2008 22:03:18 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30928</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0xrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39290</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>