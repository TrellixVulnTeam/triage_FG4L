<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:09:56 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4381/DERBY-4381.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4381] Connection to Derby database using jar subprotocol doesn&apos;t work if the path has round bracket in it</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4381</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;In 64 bit windows vista OS, if an executable is 32 bit than it is generally installed under &lt;br/&gt;
&quot;C:\Program Files (x86)&quot; folder. The brackets in the path cause problems while connecting&lt;br/&gt;
to any database stored in that folder(in jar format) through derby JDBC.&lt;/p&gt;

&lt;p&gt;The effective connection string is :&lt;br/&gt;
jdbc:derby:jar:(C:/Program Files(86)/ClassicModels.jar)ClassicModels &lt;br/&gt;
This fails because the closing brackets is not escaped. &lt;/p&gt;

&lt;p&gt;I looked into the documentation and didn&apos;t find references to escaping the brackets in the path. &lt;br/&gt;
I think this problem should be reproducible on all platforms.&lt;/p&gt;




&lt;p&gt;you cannot connect to it,  &lt;/p&gt;</description>
                <environment>Windows Vista</environment>
        <key id="12436119">DERBY-4381</key>
            <summary>Connection to Derby database using jar subprotocol doesn&apos;t work if the path has round bracket in it</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="myrna">Myrna van Lunteren</assignee>
                                    <reporter username="sgowda">Shivaraju Gowda</reporter>
                        <labels>
                            <label>derby_triage10_5_2</label>
                    </labels>
                <created>Sat, 19 Sep 2009 01:54:40 +0100</created>
                <updated>Mon, 6 Oct 2014 18:21:33 +0100</updated>
                            <resolved>Thu, 2 Oct 2014 21:21:31 +0100</resolved>
                                    <version>10.5.3.0</version>
                                    <fixVersion>10.10.2.1</fixVersion>
                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                    <timeoriginalestimate seconds="18000">5h</timeoriginalestimate>
                            <timeestimate seconds="18000">5h</timeestimate>
                                        <comments>
                            <comment id="12765741" author="stan" created="Wed, 14 Oct 2009 21:35:56 +0100"  >&lt;p&gt;Is it standard to escape special characters?  Perhaps this should be changed to a documentation issue?  &lt;/p&gt;

&lt;p&gt;Since this involves a Windows standard folder I will add a TIP to the WIKI so the information is searchable.&lt;/p&gt;</comment>
                            <comment id="12765745" author="sgowda" created="Wed, 14 Oct 2009 21:45:55 +0100"  >
&lt;p&gt;&amp;gt; Is it standard to escape special characters?Perhaps this should be changed to a documentation issue? &lt;/p&gt;

&lt;p&gt;I don&apos;t know, even if it is I couldn&apos;t figure out what escape character to use from the documentation. I &lt;br/&gt;
tried the backslash, &quot;\&quot;, as in the connection string below, and it didn&apos;t work.&lt;/p&gt;

&lt;p&gt;jdbc:derby:jar:(C:/Program Files&amp;#40;86&amp;#41;/ClassicModels.jar)ClassicModels &lt;/p&gt;

&lt;p&gt;&amp;gt; Since this involves a Windows standard folder I will add a TIP to the WIKI so the information is searchable.&lt;/p&gt;

&lt;p&gt;The only workaround I can think of is to place the db jar file in a path which doesn&apos;t&lt;br/&gt;
have the round brackets. Do you have any other suggestion?&lt;/p&gt;</comment>
                            <comment id="12765792" author="dagw" created="Wed, 14 Oct 2009 23:29:36 +0100"  >&lt;p&gt;We could introduce &apos;\&apos; (backslash) as an escape character in this syntax, but I guess that could make some&lt;br/&gt;
Windows users unhappy, since I think Derby (Java) accepts &apos;\&apos; as directory delimiter along with &apos;/&apos; (forward slash).&lt;br/&gt;
One would then have to write C:&lt;br class=&quot;atl-forced-newline&quot; /&gt;Program Files&lt;br class=&quot;atl-forced-newline&quot; /&gt; ... Using forward slashes would avoid this, but changing this&lt;br/&gt;
syntax would likely break existing apps.  One possible way out would be to interpret backslash as a meta-character only in front of punctuation and whitespace characters, otherwise it would be taken verbatim. E.g. &lt;br class=&quot;atl-forced-newline&quot; /&gt; means a single backslash, \w means a backslash followed by a lower case w.&lt;/p&gt;</comment>
                            <comment id="12765804" author="bryanpendleton" created="Thu, 15 Oct 2009 00:01:30 +0100"  >&lt;p&gt;Rather than trying to escape the parentheses, would it work to match up the left- and right-parentheses,&lt;br/&gt;
and then use the outermost set of parentheses as the ones which matter?&lt;/p&gt;</comment>
                            <comment id="12765891" author="dagw" created="Thu, 15 Oct 2009 04:35:13 +0100"  >&lt;p&gt;Do we have any guarantees that the directory name&apos;s use of parentheses will be balanced?&lt;br/&gt;
I was assuming we could not rely on that. I guess we could start from the end of the URL and move backwards until we hit a &apos;)&apos; . &lt;/p&gt;</comment>
                            <comment id="12799518" author="viyer" created="Wed, 13 Jan 2010 01:48:03 +0000"  >&lt;p&gt;The syntax for loading a database as read-only has parentheses in it. As with any other syntax rules an &quot;override&quot; mechanism for special characters or keywords should be provided which could be delimited quotes or back slashes. Perhaps if location was removed from the syntax and made an optional property in the connect call?&lt;/p&gt;</comment>
                            <comment id="14025546" author="rpseng" created="Mon, 9 Jun 2014 19:53:14 +0100"  >&lt;p&gt;Dear all,&lt;/p&gt;

&lt;p&gt;This is still an issue on both Windows and Linux platforms. Embedded databases in file paths with parentheses &quot;(&quot;, eg. &quot;c:\Program Files(x86)\bla\bla.jar&quot; will not load when the full path is given. This is because the code looking for the jar path stops in the first closing &quot;)&quot; it finds.&lt;/p&gt;

&lt;p&gt;This is fixed simply by replacing the line 95 of JarStorageFactory.java:&lt;br/&gt;
rightParen = dataDirectory.indexOf( &apos;)&apos;, leftParen + 1);&lt;/p&gt;

&lt;p&gt;by this:&lt;br/&gt;
rightParen = dataDirectory.lastIndexOf(&apos;)&apos;);&lt;/p&gt;

&lt;p&gt;Just my 2 cents.&lt;/p&gt;</comment>
                            <comment id="14026946" author="myrna" created="Tue, 10 Jun 2014 21:23:32 +0100"  >&lt;p&gt;Thanks for that suggestion Rafael...&lt;br/&gt;
Note however, that (according to the api) String.lastIndexOf is only supported since Java 7, and Derby still supports Java 6, so that needs to be taken into consideration.&lt;/p&gt;</comment>
                            <comment id="14026965" author="rpseng" created="Tue, 10 Jun 2014 21:40:40 +0100"  >&lt;p&gt;Dear Myrna,&lt;/p&gt;

&lt;p&gt;I didn&apos;t know String.lastIndexOf was that new, we could just use the following then:&lt;/p&gt;

&lt;p&gt;		rightParen = dataDirectory.length()-1;&lt;br/&gt;
		while(rightParen&amp;gt;0 &amp;amp;&amp;amp; dataDirectory.charAt(rightParen)!=&apos;)&apos;)&lt;br/&gt;
			rightParen--;&lt;/p&gt;

&lt;p&gt;All the best.&lt;/p&gt;</comment>
                            <comment id="14027184" author="myrna" created="Wed, 11 Jun 2014 00:08:17 +0100"  >&lt;p&gt;On closer look, it appears that the api I was looking at is just missing the &apos;since&apos; entry for lastIndex of - it seems this was available with Java 6 and it seems to work fine with (ibm)1.6.&lt;/p&gt;</comment>
                            <comment id="14027185" author="myrna" created="Wed, 11 Jun 2014 00:11:16 +0100"  >&lt;p&gt;It seems to work fine with directories with unmatched brackets,  spaces, and the like.&lt;br/&gt;
All while fully qualifying the directory.&lt;br/&gt;
I&apos;ll try to get this into the upcoming 10.11 release (candidate planned next week).&lt;/p&gt;</comment>
                            <comment id="14028167" author="myrna" created="Wed, 11 Jun 2014 19:28:18 +0100"  >&lt;p&gt;Note that the behavior is the same whether the params are in the path, or the jar file name. The error when the problem occurs is XJ040 (failed to start database), caused by XJ001 - FileNotFoundException.&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:jar:(bla)db.jar)bladb&apos;;&lt;br/&gt;
ERROR XJ040: Failed to start database &apos;jar:(bla)db.jar)bladb&apos; with class loader sun.misc.Launcher$AppClassLoader@81536285, see the next exception for details.&lt;br/&gt;
ERROR XJ001: Java exception: &apos;bla (The system cannot find the file specified.): java.io.FileNotFoundException&apos;.&lt;/p&gt;</comment>
                            <comment id="14028191" author="myrna" created="Wed, 11 Jun 2014 19:39:49 +0100"  >&lt;p&gt;The fix of using lastIndexOf will not work of course if the database name has a round bracket in it. &lt;/p&gt;</comment>
                            <comment id="14028283" author="rpseng" created="Wed, 11 Jun 2014 20:34:46 +0100"  >&lt;p&gt;Indeed, this will be a side effect of that fix. It will not work if the database name itself has a round bracket. However, as a programmer or database manager you have control over this, thus I still think this fix should be considered.&lt;/p&gt;

&lt;p&gt;Of course, a better way to fix this is support for the jar path by system property, say:&lt;br/&gt;
derby.database.jarpath&lt;/p&gt;

&lt;p&gt;And then use this property for the jar file path, when set.&lt;/p&gt;</comment>
                            <comment id="14028330" author="myrna" created="Wed, 11 Jun 2014 21:16:26 +0100"  >&lt;p&gt;Adding such a property might be a reasonable request, but I&apos;m not interested at working towards that at this time. &lt;br/&gt;
I agree the lastIndexOf approach is a good improvement. Using a round bracket in a database name in a jar doesn&apos;t work now, and it won&apos;t work after the change; but I think this is an unusual thing to do. &lt;br/&gt;
If the round bracket is in the path or jar file name it will work after the change, and having a round bracket in the path is a common thing - at least on windows. &lt;br/&gt;
I will continue with that fix. I added a test case and am running the full suite of tests.&lt;/p&gt;</comment>
                            <comment id="14028679" author="jira-bot" created="Thu, 12 Jun 2014 02:11:18 +0100"  >&lt;p&gt;Commit 1602054 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1602054&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1602054&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4381&quot; title=&quot;Connection to Derby database using jar subprotocol doesn&amp;#39;t work if the path has round bracket in it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4381&quot;&gt;&lt;del&gt;DERBY-4381&lt;/del&gt;&lt;/a&gt;; Connection to Derby database using jar subprotocol doesn&apos;t work if the path has round braket  in it&lt;br/&gt;
   adding a test and changing search for matching bracket to be from the last occurrence.&lt;br/&gt;
   fix suggested by Rafael Soares (rafael dot enq at gmail dot com)&lt;/p&gt;</comment>
                            <comment id="14028897" author="knutanders" created="Thu, 12 Jun 2014 08:20:37 +0100"  >&lt;p&gt;Thanks for fixing this bug.&lt;/p&gt;

&lt;p&gt;Some small nits:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The patch introduces an unused import in JarStorageFactory (JVMInfo).&lt;/li&gt;
	&lt;li&gt;The test case talks about &quot;param&quot; when I think it means &quot;paren(thesis)&quot;.&lt;/li&gt;
	&lt;li&gt;The indentation seems to be off in the last two code blocks of the test case.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14029415" author="jira-bot" created="Thu, 12 Jun 2014 18:05:32 +0100"  >&lt;p&gt;Commit 1602232 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1602232&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1602232&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4381&quot; title=&quot;Connection to Derby database using jar subprotocol doesn&amp;#39;t work if the path has round bracket in it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4381&quot;&gt;&lt;del&gt;DERBY-4381&lt;/del&gt;&lt;/a&gt;; Connection to Derby database using jar subprotocol doesn&apos;t work if the path has round bracket in it&lt;br/&gt;
   fixing formatting, comments, and removing an unnecessary import&lt;/p&gt;</comment>
                            <comment id="14029426" author="myrna" created="Thu, 12 Jun 2014 18:11:13 +0100"  >&lt;p&gt;Thanks for the review Knut, I addressed your comments with revision 1602232.&lt;br/&gt;
I&apos;m resolving this now, I think the basic concern of this issue has been addressed. Thanks to everyone who gave opinions/suggestions on this over the years.&lt;/p&gt;</comment>
                            <comment id="14155222" author="myrna" created="Wed, 1 Oct 2014 19:09:59 +0100"  >&lt;p&gt;reopen for backport to 10.10 branch.&lt;/p&gt;</comment>
                            <comment id="14155605" author="jira-bot" created="Wed, 1 Oct 2014 22:45:44 +0100"  >&lt;p&gt;Commit 1628844 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=myrna&quot; class=&quot;user-hover&quot; rel=&quot;myrna&quot;&gt;Myrna van Lunteren&lt;/a&gt; in branch &apos;code/branches/10.10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1628844&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1628844&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4381&quot; title=&quot;Connection to Derby database using jar subprotocol doesn&amp;#39;t work if the path has round bracket in it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4381&quot;&gt;&lt;del&gt;DERBY-4381&lt;/del&gt;&lt;/a&gt;; Connection to Derby database using jar subprotocol doesn&apos;t work if the path has round bracket in it&lt;br/&gt;
  backport of revision 1602054 and revision 1602232 from trunk.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12746192">DERBY-6759</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10421"><![CDATA[Seen in production]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 14 Oct 2009 20:35:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24218</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0imn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36836</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>