<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:36:47 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5755/DERBY-5755.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5755] Minor cleanup of DataDictionaryImpl.getRoutineList()</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5755</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I noticed two small possibilities for improvement in DataDictionaryImpl.getRoutineList() when I worked on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5730&quot; title=&quot;DataDictionaryImpl leaks references to itself via SYSFUN_AD&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5730&quot;&gt;&lt;del&gt;DERBY-5730&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The method always returns a list of one or zero items. Instead of creating an ArrayList, it should use Collections.singletonList() and Collections.EMPTY_LIST, which are more memory-efficient.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;It loops through the entire SYSFUN_FUNCTIONS array, even if the matching function is found in the first cell of the array. It should break out of the loop once a match is found.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12554669">DERBY-5755</key>
            <summary>Minor cleanup of DataDictionaryImpl.getRoutineList()</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 May 2012 13:20:52 +0100</created>
                <updated>Tue, 24 Jul 2012 18:28:03 +0100</updated>
                            <resolved>Mon, 14 May 2012 12:49:07 +0100</resolved>
                                    <version>10.9.1.0</version>
                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13272278" author="knutanders" created="Thu, 10 May 2012 13:30:37 +0100"  >&lt;p&gt;Attaching a patch that makes the suggested changes to the method. All the regression tests passed with the patch.&lt;/p&gt;</comment>
                            <comment id="13272433" author="dagw" created="Thu, 10 May 2012 16:52:29 +0100"  >&lt;p&gt;Looks to me as if the calling code is checking against duplicates? Cf. PrivilegeNode ca line 105 which throws if mor ethan one routine returned. Wouldn&apos;t the new code mask this error checking?&lt;br/&gt;
Cf also signature of getRoutineList: &quot;Get the list of routines matching the schema and routine name&quot; having a plural &quot;routines&quot;.&lt;/p&gt;</comment>
                            <comment id="13273133" author="knutanders" created="Fri, 11 May 2012 10:23:51 +0100"  >&lt;p&gt;Hi Dag,&lt;/p&gt;

&lt;p&gt;You&apos;re right that the interface (DataDictionary) allows for returning lists with more than one element, so the callers still need to account for that possibility, even though the specific implementation (DataDictionaryImpl) says in its javadoc that it always returns 0 or 1.&lt;/p&gt;

&lt;p&gt;As to the possibility of masking errors, you&apos;re right that the patch would mask duplicates in the SYSFUN_FUNCTIONS array, but it would not change anything for routines looked up in the catalogs, as the signature of getAliasDescriptor() guarantees that no more than one descriptor is returned. I&apos;m not sure if we&apos;ll ever want to add duplicate names in SYSFUN_FUNCTIONS, but it might make sense to preserve the current code&apos;s readiness for it.&lt;/p&gt;

&lt;p&gt;What about this alternative patch (1b)? It makes the following changes:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;remove the early termination of the loop that the 1a patch introduced&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;still collect results into an ArrayList, but only for SYSFUN_FUNCTIONS&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;use Collections.EMPTY_LIST and Collection.singletonList(), but only for the descriptors fetched from the catalog, which are known at compile-time to be exactly 0 or 1&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13273384" author="dagw" created="Fri, 11 May 2012 17:05:47 +0100"  >&lt;p&gt;Thanks for the explanation. +1  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13274566" author="knutanders" created="Mon, 14 May 2012 12:49:18 +0100"  >&lt;p&gt;Thanks, Dag!&lt;br/&gt;
Committed revision 1338167.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526335" name="d5755-1a.diff" size="1979" author="knutanders" created="Thu, 10 May 2012 13:30:37 +0100"/>
                            <attachment id="12526500" name="d5755-1b.diff" size="1776" author="knutanders" created="Fri, 11 May 2012 10:23:50 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 10 May 2012 15:52:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>238919</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0asn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35567</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>