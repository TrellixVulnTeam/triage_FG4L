<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:39:56 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1076/DERBY-1076.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1076] Resolve the ouput differences in upgrade test</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1076</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The output of running the upgrade test script (runphases.ksh) differs from what is checked into the master file (java\testing\org\apache\derbyTesting\functionTests\master\phaseTester.out). These differences need to be checked to see there are no real issues in the upgrade itself.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12329756">DERBY-1076</key>
            <summary>Resolve the ouput differences in upgrade test</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12313520">DERBY-514</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="deepa">Deepa Remesh</assignee>
                                    <reporter username="deepa">Deepa Remesh</reporter>
                        <labels>
                    </labels>
                <created>Sat, 4 Mar 2006 08:31:32 +0000</created>
                <updated>Mon, 29 Jun 2009 23:43:02 +0100</updated>
                            <resolved>Tue, 4 Apr 2006 18:16:16 +0100</resolved>
                                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12369948" author="deepa" created="Sat, 11 Mar 2006 08:44:19 +0000"  >&lt;p&gt;When I run the upgrade test on my machine, I get a huge diff. I am attaching the diff and out file.  There are few diffs caused by difference in version (10.1.2.2 vs 10.1.2.3) and machine-specific locations. Other than that, the main diffs are caused by the following exceptions in the output:&lt;br/&gt;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
getColumnPrivileges():&lt;br/&gt;
FAIL &amp;#8211; unexpected exception&lt;br/&gt;
SQLSTATE(42X05):ERROR 42X05: Table &apos;SYS.SYSCOLPERMS&apos; does not exist.&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:311)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(FromBaseTable.java:2382)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(FromBaseTable.java:2120)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.FromList.bindTables(FromList.java:303)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(SelectNode.java:471)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(DMLStatementNode.java:220)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(DMLStatementNode.java:158)&lt;br/&gt;
	at org.apache.derby.impl.sql.compile.CursorNode.bind(CursorNode.java:252)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(GenericStatement.java:344)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericStatement.prepare(GenericStatement.java:118)&lt;br/&gt;
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(GenericLanguageConnectionContext.java:721)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.&amp;lt;init&amp;gt;(EmbedPreparedStatement.java:118)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement20.&amp;lt;init&amp;gt;(EmbedPreparedStatement20.java:82)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement30.&amp;lt;init&amp;gt;(EmbedPreparedStatement30.java:62)&lt;br/&gt;
	at org.apache.derby.jdbc.Driver30.newEmbedPreparedStatement(Driver30.java:92)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.prepareMetaDataStatement(EmbedConnection.java:1614)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedDatabaseMetaData.getPreparedQuery(EmbedDatabaseMetaData.java:3172)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedDatabaseMetaData.getColumnPrivileges(EmbedDatabaseMetaData.java:1798)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.metadata.getMetaDataRS(metadata.java:113)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.metadata_test.runTest(metadata_test.java:729)&lt;br/&gt;
	at org.apache.derbyTesting.upgradeTests.phaseTester.main(phaseTester.java:177)&lt;br/&gt;
Test metadata finished&lt;br/&gt;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Test metadata starting&lt;br/&gt;
FAIL &amp;#8211; unexpected exception&lt;br/&gt;
SQLSTATE(X0Y32):ERROR X0Y32: Table/View &apos;T&apos; already exists in Schema &apos;APP&apos;.&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:344)&lt;br/&gt;
	at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.duplicateDescriptorException(DataDictionaryImpl.java:1505)&lt;br/&gt;
	at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addDescriptorNow(DataDictionaryImpl.java:1496)&lt;br/&gt;
	at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addDescriptor(DataDictionaryImpl.java:1478)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.CreateTableConstantAction.executeConstantAction(CreateTableConstantAction.java:223)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.MiscResultSet.open(MiscResultSet.java:56)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:379)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1108)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:517)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:475)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.metadata_test.runTest(metadata_test.java:190)&lt;br/&gt;
	at org.apache.derbyTesting.upgradeTests.phaseTester.main(phaseTester.java:177)&lt;br/&gt;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;FAIL &amp;#8211; unexpected exception&lt;br/&gt;
SQLSTATE(X0Y32):ERROR X0Y32: Table/View &apos;T&apos; already exists in Schema &apos;APP&apos;.&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:392)&lt;br/&gt;
	at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.duplicateDescriptorException(DataDictionaryImpl.java:1606)&lt;br/&gt;
	at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addDescriptorNow(DataDictionaryImpl.java:1597)&lt;br/&gt;
	at org.apache.derby.impl.sql.catalog.DataDictionaryImpl.addDescriptor(DataDictionaryImpl.java:1579)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.CreateTableConstantAction.executeConstantAction(CreateTableConstantAction.java:223)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.MiscResultSet.open(MiscResultSet.java:56)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(GenericPreparedStatement.java:361)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(EmbedStatement.java:1142)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:550)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(EmbedStatement.java:480)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.metadata_test.runTest(metadata_test.java:190)&lt;br/&gt;
	at org.apache.derbyTesting.upgradeTests.phaseTester.main(phaseTester.java:177)&lt;br/&gt;
Test metadata finished&lt;br/&gt;
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt;I would appreciate if someone else can also take a look and help me figure out the cause for these differences. &lt;/p&gt;

&lt;p&gt;Note: For details of running the upgrade test, please see Mamta&apos;s comment at &lt;a href=&quot;http://issues.apache.org/jira/browse/DERBY-573#action_12359550&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/DERBY-573#action_12359550&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12370568" author="deepa" created="Thu, 16 Mar 2006 02:53:18 +0000"  >&lt;p&gt;Attaching a patch &apos;derby-1076_metadata_test.diff&apos; which is a one-line change in metadata_test.java. The change is to cleanup the test objects at beginning of test to allow the upgrade test to continue if there are intermittent failures. This patch reduces the diffs (Table/View &apos;T&apos; already exists in Schema &apos;APP&apos;. ) mentioned in the previous comment and helps to continue with my work on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1075&quot; title=&quot;Combine the script and the test available for upgrade testing into a java test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1075&quot;&gt;&lt;del&gt;DERBY-1075&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This patch changes only tests. With this patch, I ran the metadata tests (jdbcapi/metadata.java and odbc_metadata.java) in all three frameworks with Sun jdk1.4.2. Please take a look at this patch.&lt;/p&gt;</comment>
                            <comment id="12370773" author="kmarsden" created="Fri, 17 Mar 2006 09:47:34 +0000"  >
&lt;p&gt;It seems to me that perhaps this issue should be Blocker and not Minor as marked.&lt;br/&gt;
If the upgrade tests are broken, how can we release 10.2?  Rick do you have an opinion as release manager? &lt;/p&gt;

&lt;p&gt;Deepa could you summarize any analysis you have done on the diffs?&lt;/p&gt;
</comment>
                            <comment id="12370779" author="deepa" created="Fri, 17 Mar 2006 12:02:46 +0000"  >&lt;p&gt;Kathey, I agree that we should be able to run upgrade tests to check that upgrade does not have problems before 10.2 is released. &lt;/p&gt;

&lt;p&gt;I am continuing the effort put into upgrade test by Mamta, Dan and others and trying to make it run as part of derbyall. Currently, I think it is difficult to test the upgrade mainly because of two things: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Test is not part of derbyall. We have to run the test and compare the master files manually.&lt;/li&gt;
	&lt;li&gt;Running manually is also a problem because of the existing diffs in the master file&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;From what I have seen, the diffs are caused by following:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Failure in DatabaseMetadata.getColumnPrivileges (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1121&quot; title=&quot;jdbcapi/checkDriver.java fails in remote server testing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1121&quot;&gt;&lt;del&gt;DERBY-1121&lt;/del&gt;&lt;/a&gt;). Because of this, metadata test does not run to completion after soft upgrade. Maybe, as a test, we should modify the metadata test to ignore this exception and run the test after soft upgrade. This is just to make sure there are no other problems further along the test. I&apos;ll try this.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Master updates in metadata test not reflected in phaseTester.out. The major part of phaseTester.out is the output of metadata test. After each phase, metadata test is run. phaseTester.out has to be updated to reflect the changes which have happened in the meantime.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;The master file is created with version 10.1.2.2. If we run the test with another version say, 10.1.2.4, there will be diffs. It will be good to avoid version information in the master file and do the necessary checking inside the test itself. I am working on this in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1075&quot; title=&quot;Combine the script and the test available for upgrade testing into a java test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1075&quot;&gt;&lt;del&gt;DERBY-1075&lt;/del&gt;&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Some machine specific locations in the file. We can avoid printing this to the output. I am doing this is &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1075&quot; title=&quot;Combine the script and the test available for upgrade testing into a java test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1075&quot;&gt;&lt;del&gt;DERBY-1075&lt;/del&gt;&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Proposal:&lt;br/&gt;
I have a draft patch attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1075&quot; title=&quot;Combine the script and the test available for upgrade testing into a java test&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1075&quot;&gt;&lt;del&gt;DERBY-1075&lt;/del&gt;&lt;/a&gt; and would appreciate feedback on it. This patch creates a java class which can be used to write upgrade tests. Once this patch is reviewed and okay, we can then proceed to create upgrade tests. This should allow anybody to run the tests using the test harness. Once the output differences are resolved, we can add the tests to a suite and make it part of derbyall run. Does this sound reasonable?&lt;/p&gt;</comment>
                            <comment id="12370856" author="deepa" created="Sat, 18 Mar 2006 01:51:08 +0000"  >&lt;p&gt;I have opened &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1124&quot; title=&quot;DatabaseMetaData.getTablePrivileges fails in soft upgrade mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1124&quot;&gt;&lt;del&gt;DERBY-1124&lt;/del&gt;&lt;/a&gt; for the soft upgrade problem I found in getTablePrivileges query. &lt;/p&gt;

&lt;p&gt;To check whether there are any other problems after soft upgrade, I ran metadata test by commenting out the problem queries (getColumnPrivileges and getTablePrivileges). I did not see any other issues.&lt;/p&gt;</comment>
                            <comment id="12372344" author="deepa" created="Thu, 30 Mar 2006 10:09:43 +0100"  >&lt;p&gt;Attaching a patch &apos;derby-1076_master_update.diff&apos; which updates the master file for upgrade test. The master file is updated to reflect changes in the metadata test. Also there were extra lines in the master file in the previous checkin. I have also replaced 10.1.2.2 with 10.1.2.1 as Knut had suggested. This version info will hopefully go away with my next patch to allow running the test as part of harness. Still there are few diffs because of the diffs in the generated SQL id which look like this line:&lt;br/&gt;
,APP,REFACTION1,A,,APP,REFACTNONE,A,1,3,3,SQL060329093642910,SQL060329093642450,7&lt;br/&gt;
This will also go away once the test can be run with the harness, which filters out the generated ids.&lt;/p&gt;

&lt;p&gt;This patch modifies only a master file. Please take a look at  this patch. Thanks.&lt;/p&gt;</comment>
                            <comment id="12372722" author="knutanders" created="Sat, 1 Apr 2006 06:20:25 +0100"  >&lt;p&gt;The patch looks good, but the recent &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-690&quot; title=&quot;Add scrollable, updatable, insensitive result sets&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-690&quot;&gt;&lt;del&gt;DERBY-690&lt;/del&gt;&lt;/a&gt; check-in added some lines to the output from the metadata test. I can commit the patch if you update it with the new output.&lt;/p&gt;</comment>
                            <comment id="12372972" author="deepa" created="Tue, 4 Apr 2006 01:59:09 +0100"  >&lt;p&gt;Thanks Knut for looking at the patch. I am attaching a second version of patch &apos;derby-1076_master_update_v2.diff&apos; with the added lines from the metadata test.&lt;/p&gt;</comment>
                            <comment id="12373063" author="knutanders" created="Tue, 4 Apr 2006 18:16:16 +0100"  >&lt;p&gt;Thanks Deepa, the upgrade test now runs cleanly (except from the identifiers). Committed revision 391255.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12330344">DERBY-1120</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12330393">DERBY-1124</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12324740" name="derby-1076_master_update.diff" size="193984" author="deepa" created="Thu, 30 Mar 2006 10:09:42 +0100"/>
                            <attachment id="12324896" name="derby-1076_master_update_v2.diff" size="200847" author="deepa" created="Tue, 4 Apr 2006 01:59:07 +0100"/>
                            <attachment id="12324238" name="derby-1076_metadata_test.diff" size="620" author="deepa" created="Thu, 16 Mar 2006 02:53:18 +0000"/>
                            <attachment id="12324045" name="phaseTester.diff" size="123339" author="deepa" created="Sat, 11 Mar 2006 08:44:19 +0000"/>
                            <attachment id="12324046" name="phaseTester.out" size="67060" author="deepa" created="Sat, 11 Mar 2006 08:44:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Mar 2006 09:47:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29847</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0w47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39021</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>