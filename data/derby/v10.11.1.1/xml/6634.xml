<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:51:52 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6634/DERBY-6634.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6634] Improve test coverage of SqlXmlUtil.java</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6634</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The test coverage report for SqlXmlUtil indicates that we don&apos;t have tests for:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;recompilation of XML queries used in triggers (the code looks dead, and can probably be removed)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;serialization of sequences of atomic values returned by an XPath query (as far as I can see, we only support single atomic values and sequences of documents, so probably that&apos;s also code that can be removed, possibly replaced by an assert)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;XMLEXISTS operations where the XPath query returns a scalar (after &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6624&quot; title=&quot;Use javax.xml.xpath interfaces for XPath support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6624&quot;&gt;&lt;del&gt;DERBY-6624&lt;/del&gt;&lt;/a&gt;, it will take the same code path as a query that returns a non-empty sequence, so it won&apos;t show up in the report anymore, but it&apos;s still useful to have a test case for it)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;XMLQUERY operations where the XPath query returns a boolean (after &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6624&quot; title=&quot;Use javax.xml.xpath interfaces for XPath support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6624&quot;&gt;&lt;del&gt;DERBY-6624&lt;/del&gt;&lt;/a&gt;, the same code path will be taken for all data types, so it won&apos;t show up in the report anymore, but it&apos;s still useful to have a test case for it)&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12723119">DERBY-6634</key>
            <summary>Improve test coverage of SqlXmlUtil.java</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Jun 2014 13:51:12 +0100</created>
                <updated>Fri, 4 Jul 2014 09:14:17 +0100</updated>
                            <resolved>Fri, 4 Jul 2014 09:14:17 +0100</resolved>
                                    <version>10.11.1.1</version>
                                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="14042091" author="knutanders" created="Tue, 24 Jun 2014 14:21:15 +0100"  >&lt;p&gt;The patch &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12652191/12652191_d6634-1a-dead-code.diff&quot; title=&quot;d6634-1a-dead-code.diff attached to DERBY-6634&quot;&gt;d6634-1a-dead-code.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; removes some dead, untested code that originally was there in order to compile XPath queries in trigger actions the first time the trigger fired. The code was made redundant by the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3870&quot; title=&quot;Concurrent Inserts of rows with XML data results in an exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3870&quot;&gt;&lt;del&gt;DERBY-3870&lt;/del&gt;&lt;/a&gt;, when SqlXmlUtil stopped implementing Formatable and was no longer stored as part of the trigger action&apos;s stored prepared statement.&lt;/p&gt;

&lt;p&gt;All regression tests ran cleanly with the patch.&lt;/p&gt;</comment>
                            <comment id="14043156" author="jira-bot" created="Wed, 25 Jun 2014 08:58:07 +0100"  >&lt;p&gt;Commit 1605285 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1605285&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1605285&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6634&quot; title=&quot;Improve test coverage of SqlXmlUtil.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6634&quot;&gt;&lt;del&gt;DERBY-6634&lt;/del&gt;&lt;/a&gt;: Improve test coverage of SqlXmlUtil.java&lt;/p&gt;

&lt;p&gt;Remove dead code from the time when SqlXmlUtil implemented the&lt;br/&gt;
Formatable interface (before &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3870&quot; title=&quot;Concurrent Inserts of rows with XML data results in an exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3870&quot;&gt;&lt;del&gt;DERBY-3870&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="14043165" author="knutanders" created="Wed, 25 Jun 2014 09:04:31 +0100"  >&lt;p&gt;The patch &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12652353/12652353_d6634-2a-more-tests.diff&quot; title=&quot;d6634-2a-more-tests.diff attached to DERBY-6634&quot;&gt;d6634-2a-more-tests.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; adds more test cases to XMLTypeAndOpsTest to cover some previously untested code paths for:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;XMLQUERY where the query returns an atomic boolean value&lt;/li&gt;
	&lt;li&gt;XMLEXISTS where the query returns an atomic value&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14043166" author="jira-bot" created="Wed, 25 Jun 2014 09:05:14 +0100"  >&lt;p&gt;Commit 1605287 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1605287&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1605287&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6634&quot; title=&quot;Improve test coverage of SqlXmlUtil.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6634&quot;&gt;&lt;del&gt;DERBY-6634&lt;/del&gt;&lt;/a&gt;: Improve test coverage of SqlXmlUtil.java&lt;/p&gt;

&lt;p&gt;Add missing test cases for:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;XMLQUERY that returns an atomic boolean&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;XMLEXISTS where the query returns an atomic value&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14047478" author="knutanders" created="Mon, 30 Jun 2014 10:06:00 +0100"  >&lt;p&gt;Attaching &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12653120/12653120_d6634-3a-impossible-paths.diff&quot; title=&quot;d6634-3a-impossible-paths.diff attached to DERBY-6634&quot;&gt;d6634-3a-impossible-paths.diff&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; which removes some code paths that seem to be impossible to reach:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;serializeToString(): Remove check for the items argument being null. All callers pass in a non-null List object. By removing the check, we prevent potential bugs from going unnoticed (they&apos;ll be reported as NPE instead of being ignored).&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;serializeToString(): Remove code that serializes a list of atomic values. The only possible input to the method is a single atomic value or a list of document nodes. There&apos;s no need for the extra complexity to handle lists of atomic values, so remove it.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;serializeToString(): Remove check for the xmlVal argument being null. If xmlVal is null where the check is, there is a bug, and reporting it as NPE is better than ignoring it.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The regression tests ran cleanly with the patch.&lt;/p&gt;</comment>
                            <comment id="14048635" author="jira-bot" created="Tue, 1 Jul 2014 09:30:34 +0100"  >&lt;p&gt;Commit 1607017 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1607017&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1607017&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6634&quot; title=&quot;Improve test coverage of SqlXmlUtil.java&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6634&quot;&gt;&lt;del&gt;DERBY-6634&lt;/del&gt;&lt;/a&gt;: Improve test coverage of SqlXmlUtil.java&lt;/p&gt;

&lt;p&gt;Remove impossible code paths so that they don&apos;t show up as untested&lt;br/&gt;
code. In particular:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Remove some unnecessary null tests. The callers already make sure&lt;br/&gt;
  that the arguments cannot be null, so it&apos;s better to skip the checks&lt;br/&gt;
  so that potential future bugs get reported as NPEs instead of being&lt;br/&gt;
  silently ignored.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Remove code that serializes lists of atomic values. Derby only&lt;br/&gt;
  supports queries that return single atomic values.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14052249" author="knutanders" created="Fri, 4 Jul 2014 09:14:17 +0100"  >&lt;p&gt;Resolving the issue. The only code that&apos;s not covered in the SqlXmlUtil class now, is:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;catch blocks that are supposed to detect that the JAXP implementation is missing or broken&lt;/li&gt;
	&lt;li&gt;methods that are required by ErrorHandler and NamespaceContext interfaces, but that I cannot find a way to exercise (I suspect we might need to support XMLVALIDATE and namespaces in XPath queries before all of these can be reached)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12722452">DERBY-6624</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12652191" name="d6634-1a-dead-code.diff" size="1883" author="knutanders" created="Tue, 24 Jun 2014 14:21:15 +0100"/>
                            <attachment id="12652353" name="d6634-2a-more-tests.diff" size="1980" author="knutanders" created="Wed, 25 Jun 2014 09:04:31 +0100"/>
                            <attachment id="12653120" name="d6634-3a-impossible-paths.diff" size="6993" author="knutanders" created="Mon, 30 Jun 2014 10:06:00 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 25 Jun 2014 07:58:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>401306</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzqxlj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>401383</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>