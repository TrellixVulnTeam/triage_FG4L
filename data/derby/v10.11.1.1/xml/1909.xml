<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:31:37 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1909/DERBY-1909.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1909] ALTER TABLE DROP COLUMN needs to update GRANTed column privileges</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1909</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When ALTER TABLE DROP COLUMN is used to drop a column from a table, it needs to update the GRANTed column privileges on that table.&lt;/p&gt;

&lt;p&gt;The following behaviors need to be provided:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;DROP COLUMN needs to automatically revoke any privileges which have been granted on this column&lt;/li&gt;
	&lt;li&gt;Privileges which have been granted on other columns in this table need to be adjusted due to changed column position numbers&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;When this problem is fixed, the following additional cleanup steps should occur:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The check that disables DROP COLUMN in sqlAuthorization mode needs to be removed&lt;/li&gt;
	&lt;li&gt;There is a comment in AlterTableConstantAction that needs to be revised&lt;/li&gt;
	&lt;li&gt;The tests in lang/altertableDropColumn.sql should be moved into altertable.sql&lt;/li&gt;
	&lt;li&gt;altertableDropColumn.sql and altertableDropColumn.out should be deleted&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Search for this JIRA issue number in the code to find the relevant places to change.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12352140">DERBY-1909</key>
            <summary>ALTER TABLE DROP COLUMN needs to update GRANTed column privileges</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bryanpendleton">Bryan Pendleton</assignee>
                                    <reporter username="bryanpendleton">Bryan Pendleton</reporter>
                        <labels>
                    </labels>
                <created>Sat, 30 Sep 2006 21:54:16 +0100</created>
                <updated>Fri, 21 Jan 2011 17:49:20 +0000</updated>
                            <resolved>Mon, 5 Feb 2007 04:59:40 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12438932" author="bryanpendleton" created="Sat, 30 Sep 2006 21:56:29 +0100"  >&lt;p&gt;This issue is a follow-on from &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1489&quot; title=&quot;Provide ALTER TABLE DROP COLUMN functionality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1489&quot;&gt;&lt;del&gt;DERBY-1489&lt;/del&gt;&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1489&quot; title=&quot;Provide ALTER TABLE DROP COLUMN functionality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1489&quot;&gt;&lt;del&gt;DERBY-1489&lt;/del&gt;&lt;/a&gt; implements most of the DROP COLUMN behaviors, but did not handle the interaction with GRANTed column privileges.&lt;/p&gt;</comment>
                            <comment id="12460891" author="bryanpendleton" created="Tue, 26 Dec 2006 16:15:16 +0000"  >&lt;p&gt;The techniques in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1847&quot; title=&quot;SELECT statement asserts with XJ001 when attempted to select a newly added column in SQL authorization mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1847&quot;&gt;&lt;del&gt;DERBY-1847&lt;/del&gt;&lt;/a&gt; may be useful as a building block for fixing this issue.&lt;/p&gt;</comment>
                            <comment id="12460911" author="bryanpendleton" created="Tue, 26 Dec 2006 18:52:13 +0000"  >&lt;p&gt;repro.sql is a first start at a script demonstrating the problem&lt;/p&gt;</comment>
                            <comment id="12460940" author="bryanpendleton" created="Wed, 27 Dec 2006 03:01:03 +0000"  >&lt;p&gt;I started working on a possible patch, but hit a bit of a confusion while trying&lt;br/&gt;
to re-factor some code in DataDictionaryImpl.java. I don&apos;t want to lose the&lt;br/&gt;
work I did, so I&apos;m attaching d1909_partial_incomplete.diff to save that work.&lt;br/&gt;
Hopefully I can pick up this work and continue it once I understand the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1847&quot; title=&quot;SELECT statement asserts with XJ001 when attempted to select a newly added column in SQL authorization mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1847&quot;&gt;&lt;del&gt;DERBY-1847&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
fix better.&lt;/p&gt;</comment>
                            <comment id="12461225" author="bryanpendleton" created="Thu, 28 Dec 2006 16:55:41 +0000"  >&lt;p&gt;Attached is rewrite_syscolperms_v1.diff, a proposed patch for this problem.&lt;/p&gt;

&lt;p&gt;The core of this proposed patch involves refactoring and reusing the&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1847&quot; title=&quot;SELECT statement asserts with XJ001 when attempted to select a newly added column in SQL authorization mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1847&quot;&gt;&lt;del&gt;DERBY-1847&lt;/del&gt;&lt;/a&gt; method which knows how to rewrite SYSCOLPERMS rows&lt;br/&gt;
to update the COLUMNS column. The &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1847&quot; title=&quot;SELECT statement asserts with XJ001 when attempted to select a newly added column in SQL authorization mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1847&quot;&gt;&lt;del&gt;DERBY-1847&lt;/del&gt;&lt;/a&gt; version of that code&lt;br/&gt;
only handled the case of adding a bit to the COLUMNS column; this patch&lt;br/&gt;
extends that method to support removing a bit from the COLUMNS&lt;br/&gt;
column as well, then calls the method from the AlterTable execution logic.&lt;/p&gt;

&lt;p&gt;The diff file is rather large because because it includes the removal of&lt;br/&gt;
altertableDropColumn.sql and altertableDropColumn.out, and the&lt;br/&gt;
merging of those files into altertable.sql and altertable.out, so the&lt;br/&gt;
entire contents of those files are included in the diff twice each &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The rest of the diff is pretty small and straightforward and hopefully is&lt;br/&gt;
not hard to review.&lt;/p&gt;

&lt;p&gt;The diff includes the proposed 2-line change from &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1847&quot; title=&quot;SELECT statement asserts with XJ001 when attempted to select a newly added column in SQL authorization mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1847&quot;&gt;&lt;del&gt;DERBY-1847&lt;/del&gt;&lt;/a&gt;, because&lt;br/&gt;
that change is mandatory for this fix. Once the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1847&quot; title=&quot;SELECT statement asserts with XJ001 when attempted to select a newly added column in SQL authorization mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1847&quot;&gt;&lt;del&gt;DERBY-1847&lt;/del&gt;&lt;/a&gt; change is&lt;br/&gt;
resolved, I&apos;ll revisit this diff to remove those two lines from DataDictionaryImpl.java&lt;/p&gt;

&lt;p&gt;The proposed patch has one particularly interesting behavior: in the case&lt;br/&gt;
in which a column is dropped from a table, and there exists a user who&lt;br/&gt;
was granted privileges on that column, and that column only, in that table,&lt;br/&gt;
the diff processes their SYSCOLPERMS row and leaves a &quot;empty&quot; row; that&lt;br/&gt;
is, a row in which the COLUMNS column of SYSCOLPERMS has all bits clear.&lt;br/&gt;
From what I can tell, this does not cause any problems; the behavior is&lt;br/&gt;
reasonable. However, it might be argued that it would be preferable to&lt;br/&gt;
entirely delete the row in this case. Feedback from reviewers about this&lt;br/&gt;
behavior and about how to address it (if necessary), would be much appreciated.&lt;/p&gt;</comment>
                            <comment id="12462722" author="bryanpendleton" created="Sat, 6 Jan 2007 16:23:58 +0000"  >&lt;p&gt;Attached is rewrite_syscolperms_v2.diff. This patch proposal differs from&lt;br/&gt;
the v1 version only in that the code patch to DataDictionaryImpl.java&lt;br/&gt;
for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1847&quot; title=&quot;SELECT statement asserts with XJ001 when attempted to select a newly added column in SQL authorization mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1847&quot;&gt;&lt;del&gt;DERBY-1847&lt;/del&gt;&lt;/a&gt; has been removed from this patch.&lt;/p&gt;

&lt;p&gt;This patch now applies cleanly against the head of trunk and is, I&lt;br/&gt;
believe, ready for commit. derbyall and suites.All pass with this patch.&lt;br/&gt;
Please review the patch as time permits.&lt;/p&gt;
</comment>
                            <comment id="12470075" author="bryanpendleton" created="Sun, 4 Feb 2007 19:10:39 +0000"  >&lt;p&gt;Attached is rewrite_syscolperms_v3.diff. This patch is up to date with the head of trunk, and includes the change to EmptyDictionary.java (thanks Andrew!).&lt;/p&gt;

&lt;p&gt;I intend to commit this patch, unless I find any problems in my last re-run of derbyall &amp;amp; suites.All.&lt;/p&gt;

&lt;p&gt;If there are any review comments, please let me know.&lt;/p&gt;</comment>
                            <comment id="12470127" author="bryanpendleton" created="Mon, 5 Feb 2007 04:59:40 +0000"  >&lt;p&gt;Committed rewrite_syscolperms_v3.diff to subversion as revision 503550.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12362078">DERBY-2294</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12311732">DERBY-396</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12349878">DERBY-1847</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12345616">DERBY-1489</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12347901" name="d1909_partial_incomplete.diff" size="5748" author="bryanpendleton" created="Wed, 27 Dec 2006 03:01:03 +0000"/>
                            <attachment id="12347895" name="repro.sql" size="312" author="bryanpendleton" created="Tue, 26 Dec 2006 18:52:13 +0000"/>
                            <attachment id="12347999" name="rewrite_syscolperms_v1.diff" size="91470" author="bryanpendleton" created="Thu, 28 Dec 2006 16:55:41 +0000"/>
                            <attachment id="12347998" name="rewrite_syscolperms_v1.stat" size="772" author="bryanpendleton" created="Thu, 28 Dec 2006 16:55:41 +0000"/>
                            <attachment id="12348440" name="rewrite_syscolperms_v2.diff" size="91245" author="bryanpendleton" created="Sat, 6 Jan 2007 16:21:00 +0000"/>
                            <attachment id="12350302" name="rewrite_syscolperms_v3.diff" size="91913" author="bryanpendleton" created="Sun, 4 Feb 2007 19:10:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22783</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0myn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37538</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>