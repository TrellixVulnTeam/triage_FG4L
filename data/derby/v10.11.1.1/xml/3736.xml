<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:41:56 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3736/DERBY-3736.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3736] Revoking a column level privilege from a user, a prepared statement relying on that privilege can still be executed </title>
                <link>https://issues.apache.org/jira/browse/DERBY-3736</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When a table level SELECT privilege is revoked, a dependent prepared statement is &lt;br/&gt;
invalidated and can no longer be executed, but in the case of a column level privilege&lt;br/&gt;
SELECT privilege, the dependent prepared statement can still be executed.&lt;/p&gt;

&lt;p&gt;This works as expected in 10.2, but does not work in all 10.3 and 10.4 releases.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12399037">DERBY-3736</key>
            <summary>Revoking a column level privilege from a user, a prepared statement relying on that privilege can still be executed </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Jun 2008 22:14:04 +0100</created>
                <updated>Wed, 1 Jul 2009 17:35:46 +0100</updated>
                            <resolved>Wed, 9 Jul 2008 10:02:30 +0100</resolved>
                                    <version>10.3.1.4</version>
                    <version>10.3.2.1</version>
                    <version>10.3.3.0</version>
                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.2.0</fixVersion>
                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12608200" author="dagw" created="Wed, 25 Jun 2008 22:23:12 +0100"  >&lt;p&gt;Attaching a repro, column-level.sql which shows the issue.&lt;br/&gt;
For contrast I attach table-level.sql which fails as expected.&lt;/p&gt;

&lt;p&gt;I also attach a diff I made to GrantRevokeDDLTest with a test case&lt;br/&gt;
which can be used to reproduce.&lt;/p&gt;

&lt;p&gt;I ran the scripts with this incantation&lt;br/&gt;
java -Dderby.user.dag=wanvik -Dderby.user.donald=duck -Dderby.connection.requireAuthentication=true -Dderby.database.sqlAuthorization=true -jar derbyrun.jar ij &amp;lt; script&lt;/p&gt;</comment>
                            <comment id="12609900" author="dagw" created="Wed, 2 Jul 2008 13:39:33 +0100"  >&lt;p&gt;Enclosing a patch which fixes the issue by adding a&lt;br/&gt;
line for the column case in TablePrivilegeInfo:&lt;/p&gt;

&lt;p&gt;&amp;gt; dd.getDependencyManager().invalidateFor&lt;br/&gt;
   (td, DependencyManager.INTERNAL_RECOMPILE_REQUEST, lcc);&lt;/p&gt;

&lt;p&gt;There is already such a line for the case when a table level privilege is revoked&lt;br/&gt;
and there it carries the following comment:&lt;/p&gt;

&lt;p&gt;// When revoking a privilege from a Table we need to&lt;br/&gt;
// invalidate all GPSs refering to it. But GPSs aren&apos;t&lt;br/&gt;
// Dependents of TablePermsDescr, but of the&lt;br/&gt;
// TableDescriptor itself, so we must send&lt;br/&gt;
// INTERNAL_RECOMPILE_REQUEST to the TableDescriptor&apos;s&lt;br/&gt;
// Dependents.&lt;/p&gt;

&lt;p&gt;The patch adds the test case to GrantRevokeDDLTest uploaded earlier.&lt;br/&gt;
It fails without the above change to TablePrivilegeInfo, but works with it.&lt;/p&gt;

&lt;p&gt;Running regressions now, ready for review.&lt;/p&gt;</comment>
                            <comment id="12609930" author="rhillegas" created="Wed, 2 Jul 2008 15:18:02 +0100"  >&lt;p&gt;Thanks for the patch, Dag. It looks good. You might want to decorate your one line fix with the comment block which explains why INTERNAL_RECOMPILE_REQUEST is being requested:&lt;/p&gt;

&lt;p&gt;// When revoking a privilege from a Table we need to&lt;br/&gt;
// invalidate all GPSs refering to it. But GPSs aren&apos;t&lt;br/&gt;
// Dependents of TablePermsDescr, but of the&lt;br/&gt;
// TableDescriptor itself, so we must send&lt;br/&gt;
// INTERNAL_RECOMPILE_REQUEST to the TableDescriptor&apos;s&lt;br/&gt;
// Dependents. &lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Rick&lt;/p&gt;</comment>
                            <comment id="12610157" author="dagw" created="Thu, 3 Jul 2008 09:15:15 +0100"  >&lt;p&gt;Thanks for looking at this, Rick. I will add the comment for the&lt;br/&gt;
column case as well. Regressions ran ok.&lt;/p&gt;</comment>
                            <comment id="12610918" author="dagw" created="Mon, 7 Jul 2008 09:58:49 +0100"  >&lt;p&gt;Updating a new version, derby-3736b which replaces the first version.&lt;br/&gt;
This adds the comment Rick asked for plus fixes some whitespace issues.&lt;/p&gt;

&lt;p&gt;I will commit this soon if no objects arise.&lt;/p&gt;</comment>
                            <comment id="12611569" author="dagw" created="Tue, 8 Jul 2008 14:06:58 +0100"  >&lt;p&gt;committed derby-3736b as svn 674808 on trunk.&lt;/p&gt;</comment>
                            <comment id="12611573" author="dagw" created="Tue, 8 Jul 2008 14:23:25 +0100"  >&lt;p&gt;I link this issue to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2594&quot; title=&quot;Revoking a privilege from an SQL Object should invalidate statements dependent on that object&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2594&quot;&gt;&lt;del&gt;DERBY-2594&lt;/del&gt;&lt;/a&gt;, which addressed the &lt;br/&gt;
analog issue for table level privileges.&lt;/p&gt;</comment>
                            <comment id="12611576" author="dagw" created="Tue, 8 Jul 2008 14:26:38 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2594&quot; title=&quot;Revoking a privilege from an SQL Object should invalidate statements dependent on that object&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2594&quot;&gt;&lt;del&gt;DERBY-2594&lt;/del&gt;&lt;/a&gt; explains why this was not an issue in 10.2. &lt;br/&gt;
I will backport this fix to the 10.3 and 10.4 branches.&lt;/p&gt;</comment>
                            <comment id="12611947" author="dagw" created="Wed, 9 Jul 2008 10:02:30 +0100"  >&lt;p&gt;Merged patch to 10.3 branch as svn 675121 and to 10.4 branch as svn 675116, closing.&lt;/p&gt;

&lt;p&gt;The regressions ran OK on 10.3 branch, but I saw several errors and and one fault on the 10.4 branch which&lt;br/&gt;
I deem to be unrelated (JMX management beans tests).&lt;/p&gt;</comment>
                            <comment id="12611953" author="dagw" created="Wed, 9 Jul 2008 10:25:19 +0100"  >&lt;p&gt;The errors I saw on the 10.4 branch running regressions were due to running with classes,&lt;br/&gt;
not the DERBY jar files in CLASSPATH.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12368116">DERBY-2594</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12384709" name="GrantRevokeDDLTest.diff" size="1556" author="dagw" created="Wed, 25 Jun 2008 22:23:12 +0100"/>
                            <attachment id="12384708" name="column-level.sql" size="359" author="dagw" created="Wed, 25 Jun 2008 22:23:12 +0100"/>
                            <attachment id="12385116" name="derby-3736.diff" size="2301" author="dagw" created="Wed, 2 Jul 2008 13:39:33 +0100"/>
                            <attachment id="12385117" name="derby-3736.stat" size="170" author="dagw" created="Wed, 2 Jul 2008 13:39:33 +0100"/>
                            <attachment id="12385377" name="derby-3736b.diff" size="2561" author="dagw" created="Mon, 7 Jul 2008 09:58:49 +0100"/>
                            <attachment id="12385378" name="derby-3736b.stat" size="170" author="dagw" created="Mon, 7 Jul 2008 09:58:49 +0100"/>
                            <attachment id="12384707" name="table-level.sql" size="353" author="dagw" created="Wed, 25 Jun 2008 22:23:12 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10420"><![CDATA[Regression]]></customfieldvalue>
    <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 2 Jul 2008 14:18:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23816</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0se7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38418</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>