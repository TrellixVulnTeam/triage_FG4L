<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:58 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2955/DERBY-2955.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2955] ERROR 42ZA2 creating table with check constraint with literal comparison</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2955</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I cannot create the following table with a collated database.  &lt;br/&gt;
EMPNAME should be TERRITORY_BASED collation I think, but perhaps is not initialized in time for the check constraint processing.&lt;/p&gt;

&lt;p&gt;ij&amp;gt; connect &apos;jdbc:derby:nordb;create=true;territory=no_NO;collation=TERRITORY_BASED&apos;;&lt;br/&gt;
ij&amp;gt; CREATE TABLE STAFF9 (EMPNUM    CHAR(3) NOT NULL&lt;br/&gt;
            CONSTRAINT STAFF9_PK PRIMARY KEY,&lt;br/&gt;
            EMPNAME  CHAR(20),&lt;br/&gt;
            GRADE DECIMAL(4),&lt;br/&gt;
            CITY   CHAR(15),&lt;br/&gt;
            CONSTRAINT STAFF9_EMPNAME CHECK (EMPNAME NOT LIKE &apos;T%&apos;));&lt;br/&gt;
ERROR 42ZA2: Operand of LIKE predicate with type CHAR(20) and collation UCS_BASIC is not compatable with LIKE pattern op&lt;br/&gt;
erand with type CHAR(2) and collation TERRITORY_BASED.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12374153">DERBY-2955</key>
            <summary>ERROR 42ZA2 creating table with check constraint with literal comparison</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mamtas">Mamta A. Satoor</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Jul 2007 15:43:37 +0100</created>
                <updated>Fri, 20 Jul 2007 08:41:47 +0100</updated>
                            <resolved>Fri, 20 Jul 2007 08:41:38 +0100</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12513911" author="kmarsden" created="Thu, 19 Jul 2007 15:47:22 +0100"  >&lt;p&gt;This issue was discovered in the testing for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2656&quot; title=&quot;Run suites.All against a collated database&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2656&quot;&gt;&lt;del&gt;DERBY-2656&lt;/del&gt;&lt;/a&gt;.   The test schema8 failed with the following exception:&lt;/p&gt;

&lt;p&gt;schema8(org.apache.derbyTesting.functionTests.tests.nist.NistScripts) failed:&lt;br/&gt;
junit.framework.ComparisonFailure: Output at line 115 expected:&amp;lt;0 rows inserted/updated/deleted&amp;gt; but was:&amp;lt;ERROR 42ZA2: Operand of LIKE predicate with type CHAR(20) and collation UCS_BASIC is not compatable with LIKE pattern operand with type CHAR(2) and collation TERRITORY_BASED.&amp;gt;&lt;br/&gt;
	at junit.framework.Assert.assertEquals(Assert.java:81)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.CanonTestCase.compareCanon(CanonTestCase.java:100)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.ScriptTestCase.runTest(ScriptTestCase.java:124)&lt;br/&gt;
	at junit.framework.TestCase.runBare(TestCase.java:127)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)&lt;br/&gt;
	at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.framework.TestResult.run(TestResult.java:109)&lt;br/&gt;
	at junit.framework.TestCase.run(TestCase.java:118)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:208)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:203)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at TimeRunner.main(TimeRunner.java:29)&lt;/p&gt;</comment>
                            <comment id="12513913" author="kmarsden" created="Thu, 19 Jul 2007 15:51:16 +0100"  >&lt;p&gt;Here is another error that can occur with check constraint from the temp_schema10 test.&lt;br/&gt;
ij&amp;gt;  CREATE TABLE RET_CATALOG (&lt;br/&gt;
     VENDOR_ID INT,&lt;br/&gt;
     PRODUCT_ID INT,&lt;br/&gt;
     WHOLESALE NUMERIC (10,2),&lt;br/&gt;
     RETAIL NUMERIC (10,2),&lt;br/&gt;
     MARKUP NUMERIC (10,2),&lt;br/&gt;
     EXPORT_CODE CHAR(2),&lt;br/&gt;
     EXPORT_LICNSE_DATE CHAR(20),&lt;br/&gt;
     CHECK (EXPORT_LICNSE_DATE IS NULL OR (&lt;br/&gt;
       EXPORT_CODE = &apos;F1&apos; OR&lt;br/&gt;
       EXPORT_CODE = &apos;F2&apos; OR&lt;br/&gt;
       EXPORT_CODE = &apos;F3&apos;                  )),&lt;br/&gt;
     CHECK (EXPORT_CODE &amp;lt;&amp;gt; &apos;F2&apos; OR WHOLESALE &amp;gt; 10000.00),&lt;br/&gt;
     CHECK (RETAIL &amp;gt;= WHOLESALE),&lt;br/&gt;
     CHECK (RETAIL = WHOLESALE + MARKUP));&lt;br/&gt;
ERROR 42818: Comparisons between &apos;CHAR&apos; and &apos;CHAR&apos; are not supported.&lt;/p&gt;</comment>
                            <comment id="12514119" author="mamtas" created="Fri, 20 Jul 2007 07:43:31 +0100"  >&lt;p&gt;Checked in a fix for this in main with revision 557886 with following commit comments&lt;/p&gt;

&lt;p&gt;We used to set the collation type of character string columns in the generate phase rather than the bind phase of create table. But this will cause problem with following query&lt;br/&gt;
       CREATE TABLE STAFF9 (EMPNAME CHAR(20),&lt;br/&gt;
       CONSTRAINT STAFF9_EMPNAME CHECK (EMPNAME NOT LIKE &apos;T%&apos;))&lt;br/&gt;
For the query above, when run in a territory based db, we need to have the correct collation set in bind phase of create table so that when LIKE is handled in LikeEscapeOperatorNode, we have the correct collation set for EMPNAME otherwise it will throw an exception for &apos;T%&apos; having collation of territory based and EMPNAME having the default collation of UCS_BASIC. The change in this commit will ensure that character string columns get their collation set early on in the bind phase so when the bind code for LIKE kicks in, we are all set with correct collation information.&lt;/p&gt;</comment>
                            <comment id="12514141" author="mamtas" created="Fri, 20 Jul 2007 08:41:38 +0100"  >&lt;p&gt;Migrated changes into 10.3 codeline as part of revision 557910&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12369433">DERBY-2656</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Jul 2007 06:43:31 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy11fb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39881</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>