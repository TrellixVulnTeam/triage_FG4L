<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:19:40 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4777/DERBY-4777.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4777] Different behavior in Client and Embedded modes when update on an invalid cursor</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4777</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Consider the sql snippet below:&lt;/p&gt;

&lt;p&gt;create table test(c1 int, c2 int);&lt;br/&gt;
insert into test values(1,1);&lt;br/&gt;
update test set c1=2 where current of jdk4;&lt;/p&gt;

&lt;p&gt;for the &apos;update&apos; line, we get &apos;ERROR XJ202: Invalid cursor name &apos;JDK4&apos;. &apos; in Client mode, while &apos;ERROR 42X30: Cursor &apos;JDK4&apos; not found. Verify that autocommit is OFF.&apos; in Embed mode.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12471682">DERBY-4777</key>
            <summary>Different behavior in Client and Embedded modes when update on an invalid cursor</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yunlee">Yun Lee</assignee>
                                    <reporter username="yunlee">Yun Lee</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Aug 2010 12:57:42 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:10 +0100</updated>
                            <resolved>Thu, 26 Aug 2010 18:35:02 +0100</resolved>
                                    <version>10.7.1.1</version>
                                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12898869" author="yunlee" created="Mon, 16 Aug 2010 13:08:35 +0100"  >&lt;p&gt;In DERBY,  ERROR 42X30 (LANG_CURSOR_NOT_FOUND) occures in CurrentOfResultSet.getCursor() and CurrentOfNode.bindNonVTITables(). While ERROR XJ202 (CURSOR_INVALID_NAME) occurs in Statement.setCursorName() and Statement.flowExecute().&lt;/p&gt;

&lt;p&gt;I think CURSOR_INVALID_NAME should just be used to show the &apos;name&apos; of a cursor is invalid, but not the cursor itself is invalid. If a cursor itselft is not invalid, a LANG_CURSOR_NOT_FOUND is more suitable. &lt;/p&gt;</comment>
                            <comment id="12898916" author="yunlee" created="Mon, 16 Aug 2010 13:16:55 +0100"  >&lt;p&gt;For derby-4777.patch, CURSOR_INVALID_NAME is replaced by LANG_CURSOR_NOT_FOUND in Statement.flowExecute(). &lt;/p&gt;

&lt;p&gt;Accordingly, CurrentOfTest.testDelete() begins to use 42X30(LANG_CURSOR_NOT_FOUND) in both modes.&lt;/p&gt;

&lt;p&gt;Please check it, thanks!&lt;/p&gt;</comment>
                            <comment id="12899711" author="myrna" created="Wed, 18 Aug 2010 03:57:26 +0100"  >&lt;p&gt;attaching an improved patch.&lt;/p&gt;</comment>
                            <comment id="12899715" author="myrna" created="Wed, 18 Aug 2010 04:12:02 +0100"  >&lt;p&gt;Thanks Yun for that inital patch.&lt;/p&gt;

&lt;p&gt;But when I built, and ran our lang/holdCursorIJ.sql test with -Dframework=DerbyNetClient (which after all is how we got to notice this difference between client and embedded) it failed with the following diff:&lt;/p&gt;

&lt;p&gt;234 del&lt;br/&gt;
&amp;lt; ERROR XJ202: Invalid cursor name &apos;JDK4&apos;.&lt;br/&gt;
234a234&lt;br/&gt;
&amp;gt; ERROR 42X30: UNKNOWN MESSAGE, id 42X30 : &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; JDK4&lt;br/&gt;
280 del&lt;br/&gt;
&amp;lt; ERROR XJ202: Invalid cursor name &apos;JDK4&apos;.&lt;br/&gt;
280a280&lt;br/&gt;
&amp;gt; ERROR 42X30: UNKNOWN MESSAGE, id 42X30 : &lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; JDK4 &lt;/p&gt;

&lt;p&gt;I had expected a difference, but not this &apos;UNKNOWN MESSAGE&apos;.&lt;br/&gt;
The messages that the client access, need to be &apos;split&apos; out of the shared messages. This is handled in the build process by the file java/build/org/apache/derbyBuild/splitmessages.java. I added the line:&lt;br/&gt;
 clientMessageIds.add(SQLState.LANG_CURSOR_NOT_FOUND); and after that, the holdCursorIj had the expected output:&lt;/p&gt;

&lt;p&gt;I&apos;m running tests to confirm this works, if all ok, I&apos;ll commit this.&lt;/p&gt;

&lt;p&gt;However, we&apos;re not done - as this is a change in SQLState, and people &lt;b&gt;might&lt;/b&gt; have programmed their application to expect a certain sqlstate, I think this issue needs a release note. &lt;br/&gt;
See the first part of this wiki for how that&apos;s done: &lt;a href=&quot;http://wiki.apache.org/db-derby/ReleaseNoteProcess&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/db-derby/ReleaseNoteProcess&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12899846" author="yunlee" created="Wed, 18 Aug 2010 14:39:08 +0100"  >&lt;p&gt;Thanks Myrna! I will add a patch for a release note tomorrow or the day after.&lt;/p&gt;</comment>
                            <comment id="12899880" author="myrna" created="Wed, 18 Aug 2010 16:51:33 +0100"  >&lt;p&gt;Tests ran cleanly against classes (except for testPing/&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4762&quot; title=&quot;Failure in testPing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4762&quot;&gt;&lt;del&gt;DERBY-4762&lt;/del&gt;&lt;/a&gt;) so I committed the modified patch with revision 986750. Marking Release Note Needed sothe issue will be flagged when we make a next release.&lt;/p&gt;</comment>
                            <comment id="12900101" author="dagw" created="Thu, 19 Aug 2010 00:16:55 +0100"  >&lt;p&gt;Changed to the title of this issue somewhat for legibility.&lt;/p&gt;</comment>
                            <comment id="12901162" author="yunlee" created="Sun, 22 Aug 2010 14:35:15 +0100"  >&lt;p&gt;A patch for releasenote.html is submitted, please check it, thanks!&lt;/p&gt;</comment>
                            <comment id="12902945" author="myrna" created="Thu, 26 Aug 2010 18:33:10 +0100"  >&lt;p&gt;Thanks for that releaseNote.&lt;br/&gt;
On the whole, it looks good.&lt;/p&gt;

&lt;p&gt;However, release notes don&apos;t need to be appended as &apos;patches&apos;/svn diffs. Instead, the templates/releaseNote.html is supposed to get copied to a temporary location, not actually changed, and then copied, modified file can be attached to the jira issue without a name change.&lt;/p&gt;

&lt;p&gt;The flag &apos;release Note needed&apos; stays on, the bug gets closed, and during the next release cycle, the file &apos;releaseNote.html&apos; attached to the issue will automatically be included in the list of items requiring a release note.&lt;/p&gt;

&lt;p&gt;I&apos;m attaching the releaseNote.html resulting from your patch (I applied the patch, copied the file, then reverted the tools/release/templates/releaseNote.html).&lt;br/&gt;
I made a couple of tiny changes to the phrasing, nothing important.&lt;/p&gt;</comment>
                            <comment id="12931505" author="rhillegas" created="Fri, 12 Nov 2010 19:28:43 +0000"  >&lt;p&gt;Updating the release note, incorporating feedback from Dag on the 10.7.1 release notes.&lt;/p&gt;</comment>
                            <comment id="13685146" author="knutanders" created="Mon, 17 Jun 2013 10:19:10 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="32841">DERBY-310</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12461296">DERBY-4609</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12401144">DERBY-3801</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12452353" name="DERBY-4777_b.diff" size="3469" author="myrna" created="Wed, 18 Aug 2010 03:57:26 +0100"/>
                            <attachment id="12452352" name="DERBY-4777_b.stat" size="313" author="myrna" created="Wed, 18 Aug 2010 03:57:26 +0100"/>
                            <attachment id="12452736" name="derby-4777-releasenote.patch" size="1762" author="yunlee" created="Sun, 22 Aug 2010 14:35:14 +0100"/>
                            <attachment id="12452737" name="derby-4777-releasenote.stat" size="48" author="yunlee" created="Sun, 22 Aug 2010 14:35:15 +0100"/>
                            <attachment id="12452168" name="derby-4777.patch" size="1922" author="yunlee" created="Mon, 16 Aug 2010 13:16:55 +0100"/>
                            <attachment id="12452169" name="derby-4777.stat" size="151" author="yunlee" created="Mon, 16 Aug 2010 13:16:55 +0100"/>
                            <attachment id="12459478" name="releaseNote.html" size="4459" author="rhillegas" created="Fri, 12 Nov 2010 19:28:43 +0000"/>
                            <attachment id="12453149" name="releaseNote.html" size="4669" author="myrna" created="Thu, 26 Aug 2010 18:33:10 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10363"><![CDATA[Embedded/Client difference]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 18 Aug 2010 02:57:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31372</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0opz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37823</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>