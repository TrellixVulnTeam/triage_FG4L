<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:12:00 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5449/DERBY-5449.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5449] 10.8 client with 10.5 server gives java.lang.ClassCastException: java.lang.Boolean incompatible with java.lang.Short in NetStatementRequest.buildFDODTA with CursorTest.testCursorParam()</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5449</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Using 10.8 client and 10.5 server and testing jars lang.CursorTest fails as follows:&lt;br/&gt;
Java Version:    1.6.0&lt;br/&gt;
Java Vendor:     IBM Corporation&lt;br/&gt;
Java home:       C:\cygwin\ibmsvn\ntsoftware\ibm16\jre&lt;br/&gt;
Java classpath:  .;c:/cygwin/svn4/10.8/jars/sane/derbyclient.jar;C:/cygwin/ibmreleases/10.5.3.2.1132854/derbyTesting.jar;C:/cygwin/ibmreleases/10.5.3.&lt;br/&gt;
2.1132854/derbyrun.jar;C:/cygwin/svn4/trunka/tools/java/junit.jar;C:/cygwin/svn4/trunka/tools/java/jakarta-oro-2.0.8.jar&lt;br/&gt;
OS name:         Windows XP&lt;br/&gt;
OS architecture: x86&lt;br/&gt;
OS version:      5.1 build 2600 Service Pack 3&lt;br/&gt;
Java user name:  kmarsden&lt;br/&gt;
Java user home:  C:\Documents and Settings\Administrator&lt;br/&gt;
Java user dir:   C:\cygwin\home\kmarsden\repro\10_8cli10_5serverClassCast&lt;br/&gt;
java.specification.name: Java Platform API Specification&lt;br/&gt;
java.specification.version: 1.6&lt;br/&gt;
java.runtime.version: jvmwi3260sr9-20110203_74623&lt;br/&gt;
java.fullversion: JRE 1.6.0 IBM J9 2.4 Windows XP x86-32 jvmwi3260sr9-20110203_74623 (JIT enabled, AOT enabled)&lt;br/&gt;
J9VM - 20110203_074623&lt;br/&gt;
JIT  - r9_20101028_17488ifx3&lt;br/&gt;
GC   - 20101027_AA&lt;br/&gt;
--------- Derby Information --------&lt;br/&gt;
JRE - JDBC: Java SE 6 - JDBC 4.0&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;C:\cygwin\ibmreleases\10.5.3.2.1132854\derby.jar&amp;#93;&lt;/span&gt; 10.5.3.2 - (1171883)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;C:\cygwin\ibmreleases\10.5.3.2.1132854\derbytools.jar&amp;#93;&lt;/span&gt; 10.5.3.2 - (1171883)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;C:\cygwin\ibmreleases\10.5.3.2.1132854\derbynet.jar&amp;#93;&lt;/span&gt; 10.5.3.2 - (1171883)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;C:\cygwin\svn4\10.8\jars\sane\derbyclient.jar&amp;#93;&lt;/span&gt; 10.8.2.2 - (1177062M)&lt;br/&gt;
------------------------------------------------------&lt;br/&gt;
----------------- Locale Information -----------------&lt;br/&gt;
Current Locale :  [English/United States &lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;]&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;cs&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;de_DE&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;es&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;fr&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;hu&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;it&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;ja_JP&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;ko_KR&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;pl&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;pt_BR&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;ru&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;zh_CN&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;zh_TW&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.8.2.2 - (1177062M)&lt;br/&gt;
------------------------------------------------------&lt;br/&gt;
+ java -Xmx512M -Xms512M -Dderby.tests.debug=false -Dderby.tests.trace=true &apos;-DderbyTesting.oldReleasePath=C:\cygwin\svnreleases\jars&apos; junit.textui.Te&lt;br/&gt;
stRunner org.apache.derbyTesting.functionTests.tests.lang.CursorTest&lt;br/&gt;
+ tee rju.out&lt;br/&gt;
.&lt;br/&gt;
testCursor used 312 ms .&lt;br/&gt;
testCursorParam used 156 ms .&lt;br/&gt;
testGetCursorName used 204 ms .&lt;br/&gt;
testCursor used 547 ms .&lt;br/&gt;
testCursorParam used 625 ms E.&lt;br/&gt;
testGetCursorName used 172 ms .&lt;br/&gt;
derby2417testSetCursorNextExecute used 125 ms&lt;br/&gt;
Time: 9.532&lt;br/&gt;
There was 1 error:&lt;br/&gt;
1) testCursorParam(org.apache.derbyTesting.functionTests.tests.lang.CursorTest)java.lang.ClassCastException: java.lang.Boolean incompatible with java.&lt;br/&gt;
lang.Short&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementRequest.buildFDODTA(NetStatementRequest.java:731)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementRequest.buildSQLDTAcommandData(NetStatementRequest.java:540)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementRequest.writeOpenQuery(NetStatementRequest.java:191)&lt;br/&gt;
        at org.apache.derby.client.net.NetPreparedStatement.writeOpenQuery_(NetPreparedStatement.java:194)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.writeOpenQuery(PreparedStatement.java:1819)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.flowExecute(PreparedStatement.java:2062)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.executeQueryX(PreparedStatement.java:391)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.executeQuery(PreparedStatement.java:376)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.CursorTest.testCursorParam(CursorTest.java:109)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:109)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;/p&gt;

&lt;p&gt;FAILURES!!!&lt;br/&gt;
Tests run: 7,  Failures: 0,  Errors: 1&lt;/p&gt;

&lt;p&gt;+ set +x&lt;/p&gt;

&lt;p&gt;There were quite a few (18?) other similar failures in the 10.8 client 10.5 server run,  see output attached.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12526142">DERBY-5449</key>
            <summary>10.8 client with 10.5 server gives java.lang.ClassCastException: java.lang.Boolean incompatible with java.lang.Short in NetStatementRequest.buildFDODTA with CursorTest.testCursorParam()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Oct 2011 02:51:56 +0100</created>
                <updated>Fri, 15 Nov 2013 08:15:12 +0000</updated>
                            <resolved>Tue, 25 Oct 2011 12:18:22 +0100</resolved>
                                    <version>10.8.2.2</version>
                                    <fixVersion>10.8.3.0</fixVersion>
                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13126540" author="knutanders" created="Thu, 13 Oct 2011 13:59:44 +0100"  >&lt;p&gt;This might be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5042&quot; title=&quot;ResultSet.updateBoolean() on new BOOLEAN type throws exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5042&quot;&gt;&lt;del&gt;DERBY-5042&lt;/del&gt;&lt;/a&gt;. I&apos;ll take a look.&lt;/p&gt;</comment>
                            <comment id="13128822" author="knutanders" created="Mon, 17 Oct 2011 13:37:38 +0100"  >&lt;p&gt;When talking to old servers, the client switches the DRDA type of parameters with Boolean values from BOOLEAN to SMALLINT. Before &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5042&quot; title=&quot;ResultSet.updateBoolean() on new BOOLEAN type throws exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5042&quot;&gt;&lt;del&gt;DERBY-5042&lt;/del&gt;&lt;/a&gt;, the Boolean parameter values were still sent as java.lang.Short, so switching the type was sufficient. After &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5042&quot; title=&quot;ResultSet.updateBoolean() on new BOOLEAN type throws exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5042&quot;&gt;&lt;del&gt;DERBY-5042&lt;/del&gt;&lt;/a&gt;, the values are sent as java.lang.Boolean, so there&apos;s a mismatch between the type information and the actual type of the value when the client talks to an old server, which is what causes the ClassCastException.&lt;/p&gt;

&lt;p&gt;The attached patch (1a) makes the client convert the parameter value from a java.lang.Boolean to a java.lang.Short when it determines that the DRDA type must be switched from BOOLEAN to SMALLINT.&lt;/p&gt;

&lt;p&gt;I&apos;ll see if I can come up with a test case to put in the compatibility test suite.&lt;/p&gt;</comment>
                            <comment id="13129610" author="knutanders" created="Tue, 18 Oct 2011 10:34:33 +0100"  >&lt;p&gt;Here&apos;s an updated version of the patch (1b) that also adds a test case to the compatibility test suite.&lt;/p&gt;</comment>
                            <comment id="13129736" author="knutanders" created="Tue, 18 Oct 2011 14:41:33 +0100"  >&lt;p&gt;All the regression tests passed with the 1b patch.&lt;/p&gt;</comment>
                            <comment id="13130447" author="knutanders" created="Wed, 19 Oct 2011 09:17:59 +0100"  >&lt;p&gt;Committed revision 1186020.&lt;/p&gt;

&lt;p&gt;I plan to backport the fix to the 10.8 branch, so I&apos;ll keep the issue open for now.&lt;/p&gt;</comment>
                            <comment id="13134940" author="knutanders" created="Tue, 25 Oct 2011 12:18:22 +0100"  >&lt;p&gt;Merged to 10.8.&lt;br/&gt;
Committed revision 1188608.&lt;/p&gt;</comment>
                            <comment id="13823416" author="knutanders" created="Fri, 15 Nov 2013 08:15:12 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update: close all resolved issues that haven&amp;#39;t had any activity the last year&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12499366" name="d5449-1a.diff" size="1518" author="knutanders" created="Mon, 17 Oct 2011 13:37:37 +0100"/>
                            <attachment id="12499522" name="d5449-1b.diff" size="4233" author="knutanders" created="Tue, 18 Oct 2011 10:34:33 +0100"/>
                            <attachment id="12498105" name="rjall_10_5_server_10_8LatestClient_out.txt" size="691468" author="kmarsden" created="Fri, 7 Oct 2011 02:55:46 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10420"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 13 Oct 2011 12:59:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49814</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10424"><![CDATA[Repro attached]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0f33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36262</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>