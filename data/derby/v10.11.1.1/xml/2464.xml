<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:49:21 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2464/DERBY-2464.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2464] convert lang/ShutdownDatabase.java to junit</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2464</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Place holder for the conversion of lang/ShutdownDatabase.java to junit&lt;/p&gt;</description>
                <environment></environment>
        <key id="12365156">DERBY-2464</key>
            <summary>convert lang/ShutdownDatabase.java to junit</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mkutty">Manjula Kutty</assignee>
                                    <reporter username="mkutty">Manjula Kutty</reporter>
                        <labels>
                    </labels>
                <created>Fri, 16 Mar 2007 23:34:36 +0000</created>
                <updated>Tue, 22 Jun 2010 12:00:14 +0100</updated>
                            <resolved>Tue, 27 Mar 2007 20:07:37 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12482877" author="mkutty" created="Wed, 21 Mar 2007 19:06:18 +0000"  >&lt;p&gt;Attaching the first patch for this test. Please review it. Please review.&lt;/p&gt;</comment>
                            <comment id="12482909" author="djd" created="Wed, 21 Mar 2007 20:42:03 +0000"  >&lt;p&gt;It looks like the test is just using a single database.&lt;/p&gt;

&lt;p&gt;So could the test use the TestConfiguration.singleUseDatabaseDecorator instead of the additional database decorator?&lt;br/&gt;
This would mean that you wouldn&apos;t need a reopenConnection() method, though I don&apos;t think the test does as it stands.&lt;br/&gt;
I&apos;m not sure why the test can&apos;t just use openConnection(dbName) again.&lt;/p&gt;

&lt;p&gt;Then going further, I wonder why the default database cannot be used? The single use databases are for when the test leaves the database in a state such that it cannot be re-used, does this test do that?&lt;/p&gt;

&lt;p&gt;The assertGetIntEquals() probably needs some cleanup, if an exception is thrown no failure will be generated.&lt;br/&gt;
Can you use instead the existing:&lt;/p&gt;

&lt;p&gt;JDBC.assertSingleValueResultSet()&lt;/p&gt;

&lt;p&gt;which I think is what you are trying to test for.&lt;/p&gt;</comment>
                            <comment id="12482940" author="mkutty" created="Wed, 21 Mar 2007 22:36:44 +0000"  >&lt;p&gt;Thanks for the valuable comments, Dan, I made changes to the test so that it will use the default database . But when I did the drop table in the tear down method, I get the following error . Any gues what is going wrong here?&lt;/p&gt;

&lt;p&gt;I commented that code in the tear down method and just did the drop table in each test.&lt;/p&gt;

&lt;p&gt;There was 1 error:&lt;br/&gt;
1) testOnlyTransactionWasCommited(org.apache.derbyTesting.functionTests.tests.la&lt;br/&gt;
ng.ShutdownDatabaseTest)java.sql.SQLException: A network protocol error was enco&lt;br/&gt;
untered and the connection has been terminated: the requested command encountere&lt;br/&gt;
d an unarchitected and implementation-specific condition for which there was no&lt;br/&gt;
architected message&lt;br/&gt;
        at org.apache.derby.client.am.SQLExceptionFactory.getSQLException(Unknow&lt;br/&gt;
n Source)&lt;br/&gt;
        at org.apache.derby.client.am.SqlException.getSQLException(Unknown Sourc&lt;br/&gt;
e)&lt;br/&gt;
        at org.apache.derby.client.am.Statement.execute(Unknown Source)&lt;br/&gt;
        at org.apache.derbyTesting.functionTests.tests.lang.ShutdownDatabaseTest&lt;br/&gt;
.tearDown(ShutdownDatabaseTest.java:77)&lt;br/&gt;
        at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:&lt;br/&gt;
80)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
        at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
        at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
        at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
Caused by: org.apache.derby.client.am.DisconnectException: A network protocol er&lt;br/&gt;
ror was encountered and the connection has been terminated: the requested comman&lt;br/&gt;
d encountered an unarchitected and implementation-specific condition for which t&lt;br/&gt;
here was no architected message&lt;br/&gt;
        at org.apache.derby.client.net.NetConnectionReply.parseCMDCHKRM(Unknown&lt;br/&gt;
Source)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.parseExecuteImmediateEr&lt;br/&gt;
ror(Unknown Source)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.parseEXCSQLIMMreply(Unk&lt;br/&gt;
nown Source)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatementReply.readExecuteImmediate(Un&lt;br/&gt;
known Source)&lt;br/&gt;
        at org.apache.derby.client.net.StatementReply.readExecuteImmediate(Unkno&lt;br/&gt;
wn Source)&lt;br/&gt;
        at org.apache.derby.client.net.NetStatement.readExecuteImmediate_(Unknow&lt;br/&gt;
n Source)&lt;br/&gt;
        at org.apache.derby.client.am.Statement.readExecuteImmediate(Unknown Sou&lt;br/&gt;
rce)&lt;br/&gt;
        at org.apache.derby.client.am.Statement.flowExecute(Unknown Source)&lt;br/&gt;
        at org.apache.derby.client.am.Statement.executeX(Unknown Source)&lt;br/&gt;
        ... 27 more&lt;/p&gt;
</comment>
                            <comment id="12482964" author="djd" created="Thu, 22 Mar 2007 00:06:39 +0000"  >&lt;p&gt;I see those failures, I simplfied the test and continued to see those failures.&lt;br/&gt;
The main simplification was not using openConnection(), just continue to use the utility methods like createStatement() after a shutdown.&lt;br/&gt;
These use getConnection() which will open a new connection if the existing connection is closed.&lt;br/&gt;
This also means the connection will be closed automatically, while those opened via openConnection() need to be closed explicitly.&lt;/p&gt;

&lt;p&gt;So i think the test has found a bug, shutting down the database causes some issues for the network server.&lt;br/&gt;
I&apos;ll commit my modified version but running only in embedded, can you enter a bug for the failure?&lt;/p&gt;</comment>
                            <comment id="12482971" author="djd" created="Thu, 22 Mar 2007 00:48:20 +0000"  >&lt;p&gt;patch applied (with cleanup)  Committed revision 521056.&lt;/p&gt;</comment>
                            <comment id="12483218" author="mkutty" created="Thu, 22 Mar 2007 16:47:43 +0000"  >&lt;p&gt;do i have to keep this issue opened until there is a fix for n/w server? Or can I make it resolved now?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12467552">DERBY-4707</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12416700">DERBY-4090</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12365514">DERBY-2477</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12353882" name="DERBY-2464_diff_03_21.txt" size="14935" author="mkutty" created="Wed, 21 Mar 2007 19:06:18 +0000"/>
                            <attachment id="12353900" name="DERBY-2464_diff_03_21_ver1.txt" size="11718" author="mkutty" created="Wed, 21 Mar 2007 22:36:44 +0000"/>
                            <attachment id="12353881" name="DERBY-2464_stat_03_21.txt" size="846" author="mkutty" created="Wed, 21 Mar 2007 19:06:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 21 Mar 2007 20:42:03 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30459</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0q1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38038</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>