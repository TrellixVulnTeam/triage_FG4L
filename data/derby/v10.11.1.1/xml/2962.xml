<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:39:40 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2962/DERBY-2962.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2962] Change functional tests to use casts for System table queries to avoid conversion errors when run with TERRITORY_BASED collation</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2962</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Many of the tests use system table queries which fail when run against a database with TERRITORY_BASED collation with exceptions like:&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: Comparisons between &apos;VARCHAR&apos; and &apos;CHAR&apos; are not supported.&lt;br/&gt;
and can be seen when running lang/FullCollationTests.java&lt;/p&gt;

&lt;p&gt;It would be good to change the tests to use casts so that the queries succeed and the tests can complete.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12374209">DERBY-2962</key>
            <summary>Change functional tests to use casts for System table queries to avoid conversion errors when run with TERRITORY_BASED collation</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Thu, 19 Jul 2007 22:16:40 +0100</created>
                <updated>Wed, 14 Nov 2007 22:39:02 +0000</updated>
                            <resolved>Mon, 30 Jul 2007 23:38:33 +0100</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12516563" author="kmarsden" created="Mon, 30 Jul 2007 23:38:33 +0100"  >&lt;p&gt;I changed the tests that run with Suites.All (FullCollationTests) but not derbyall since we are not setup to test that except by checking out all the *app.property files. &lt;/p&gt;
</comment>
                            <comment id="12517271" author="johnemb" created="Thu, 2 Aug 2007 15:11:42 +0100"  >&lt;p&gt;I observed that the change to miscerrors.sql in revision 558801 are causing test failures in junit suites in some environments, see for example&lt;br/&gt;
&lt;a href=&quot;http://dbtg.thresher.com/derby/test/Daily/jvm1.5/testing/Limited/testSummary-561847.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.thresher.com/derby/test/Daily/jvm1.5/testing/Limited/testSummary-561847.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;miscerrors(org.apache.derbyTesting.functionTests.tests.lang.LangScripts)junit.framework.ComparisonFailure: Output at line 69 expected:&amp;lt;...where CAST(SQL_TEXT &lt;span class=&quot;error&quot;&gt;&amp;#91;AS LONG VARCHAR) LIKE &amp;#39;%932432%&amp;#39; &amp;#93;&lt;/span&gt;                    ...&amp;gt; but was:&amp;lt;...where CAST(SQL_TEXT [ AS LONG VARCHAR) LIKE &apos;%932432%&apos;]                    ...&amp;gt;&lt;/p&gt;

&lt;p&gt;I think, from reading logs from nightly regression tests and my own tests, that the order of the two output rows from the statement&lt;/p&gt;

&lt;p&gt;ij&amp;gt; select SQL_TEXT from syscs_diag.statement_cache where CAST(SQL_TEXT  AS LONG VARCHAR) LIKE &apos;%932432%&apos;;&lt;/p&gt;

&lt;p&gt;varies between JVM versions (e.g. Sun JVM 1.6 has correct order according to the master file, while JVM versions 1.4 and 1.5 have the opposite order), hence causing the failure.&lt;/p&gt;

&lt;p&gt;Kathey, was it intentional to include an extra space in the above mentioned statement (between &quot;TEXT&quot; and &quot;AS&quot;)?&lt;br/&gt;
I think if the second space is removed, the result will contain one row instead of two, and we won&apos;t see this diff any longer...&lt;/p&gt;</comment>
                            <comment id="12517288" author="kmarsden" created="Thu, 2 Aug 2007 16:08:55 +0100"  >&lt;p&gt;I posted a patch a while back and would most appreciate if you could try &lt;br/&gt;
it and I will check it in.&lt;br/&gt;
&lt;a href=&quot;http://www.nabble.com/lang.LangScripts-failure-tf4135897.html#a11810906&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/lang.LangScripts-failure-tf4135897.html#a11810906&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The test does not fail in my environment so I cannot test it.&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;

</comment>
                            <comment id="12517310" author="johnemb" created="Thu, 2 Aug 2007 17:17:19 +0100"  >&lt;p&gt;I have tested the patch and have verified that the test succeeds with the patch, and fails without it. Feel free to commit &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 2 Aug 2007 14:11:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30672</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy10rb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39773</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>