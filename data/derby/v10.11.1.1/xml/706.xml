<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:46:42 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-706/DERBY-706.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-706] Improve testing and increase code coverage for Network Server classes</title>
                <link>https://issues.apache.org/jira/browse/DERBY-706</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Improve testing of network server by increasing tests to cover 100% of the classes and increase the method level coverage. The current code coverage(class/method) for network server based on svn revision 208786 are:&lt;br/&gt;
org.apache.derby.drda.NetworkServercontrol.java - 100/72 &lt;br/&gt;
org.apache.derby.impl.drda - 97/78 &lt;/p&gt;

&lt;p&gt;Details of code coverage from EMMA tool are available from Derby Wiki. Links are:&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/db-derby/CodeCoverage&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/db-derby/CodeCoverage&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~fuzzylogic/codecoverage/208786/_files/c5.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~fuzzylogic/codecoverage/208786/_files/c5.html&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~fuzzylogic/codecoverage/208786/_files/25.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~fuzzylogic/codecoverage/208786/_files/25.html&lt;/a&gt;&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12325655">DERBY-706</key>
            <summary>Improve testing and increase code coverage for Network Server classes</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="deepa">Deepa Remesh</assignee>
                                    <reporter username="deepa">Deepa Remesh</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Nov 2005 12:24:52 +0000</created>
                <updated>Wed, 16 Aug 2006 09:23:31 +0100</updated>
                            <resolved>Tue, 13 Jun 2006 03:20:09 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12358212" author="deepa" created="Tue, 22 Nov 2005 09:35:21 +0000"  >&lt;p&gt;Attaching first patch &apos;derby-706.diff&apos; for this. This patch adds some tests for network server and re-arranges/removes some internal methods which are not used. Details of patch are:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;derbynet/getCurrentProperties.java - Added tests for NetworkServerControl.logConnections and setTraceDirectory methods. Modified getCurrentProperties_sed.properties to use a substitute instead of delete for traceDirectory.&lt;/li&gt;
	&lt;li&gt;derbynet/testProperties.java - Added some more command line tests.&lt;/li&gt;
	&lt;li&gt;derbynet/timeslice.java and maxthreads.java - Added tests for invalid values.&lt;/li&gt;
	&lt;li&gt;derbynet/runtimeinfo.java and sysinfo.java - Added test to call methods in NetworkServer control&lt;/li&gt;
	&lt;li&gt;Modified master files.&lt;/li&gt;
	&lt;li&gt;DRDAResultSet.java - removed unused constructor &quot;DRDAResultSet(ResultSet rs)&quot;&lt;/li&gt;
	&lt;li&gt;DRDAStatement.java - Changed getNumRsCols() to use getRsDRDATypes() instead of directly calling DRDAResultSet method. Removed isProcedure() method which is not used. Changed getResultSetCursorName() to call drdaRs.getResultSetCursorName() which handles case for null result set.&lt;/li&gt;
	&lt;li&gt;NetworkServerControlImpl.java - Removed methods for connection pooling which is not implemented and not used.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;With this patch, I ran derbyall with Sun JDK 1.4.2. No failures. Please review/commit this patch.&lt;/p&gt;</comment>
                            <comment id="12358423" author="kmarsden" created="Thu, 24 Nov 2005 07:10:52 +0000"  >&lt;p&gt;I committted this change.&lt;/p&gt;

&lt;p&gt;My only comment is that for  setMaxThreads/setTimeSlice I think that  we need to make sure that the functionality is tested in addition to  adding the api call.  I don&apos;t think there are any tests that currently test that the timeslice is working properly.    &lt;/p&gt;

&lt;p&gt;In addition to the fact that we don&apos;t have tests for this   I once noticed something in CllientThread and put a comment in the code but never actually filed a bug, but it makes me think that there might be a problem with setTimeSlice.&lt;/p&gt;

&lt;p&gt;					//this looks highly suspect.  Why does timeSlice setSoTimeout?		&lt;br/&gt;
					if (timeSlice != 0)&lt;br/&gt;
						clientSocket.setSoTimeout(timeSlice);&lt;/p&gt;

&lt;p&gt;Let me know if you want input on how to test this.&lt;/p&gt;</comment>
                            <comment id="12359665" author="deepa" created="Thu, 8 Dec 2005 08:15:24 +0000"  >&lt;p&gt;I have attached a second patch &apos;derby-706_2.diff&apos; which adds some more tests and re-arranges/removes some internal methods. Details of patch are:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;DDMWriter: Removes min method because Math.min is used. Use doesRequestContainData() method.&lt;/li&gt;
	&lt;li&gt;DDMReader: Use readCodePoint() method&lt;/li&gt;
	&lt;li&gt;DRDAConnThread: QRYOPTVAL codepoint is not part of DRDA spec. parseCcsidSBC was giving NPE.&lt;/li&gt;
	&lt;li&gt;CodePointNameTable: Add codepoints to be used in protocol.tests&lt;/li&gt;
	&lt;li&gt;protocol.tests: Added tests to cover methods which were not tested before.&lt;/li&gt;
	&lt;li&gt;Session, DRDAStatement, Database, DRDAProtocolException: Remove some methods which are not needed. The same can be done using other methods.&lt;/li&gt;
	&lt;li&gt;TestProto: Use lookup method.&lt;/li&gt;
	&lt;li&gt;testProtocol: Added &quot;derby.drda.traceAll=true&quot; to derby.properties file to test methods in DssTrace&lt;/li&gt;
	&lt;li&gt;testProperties: Added test for trace off command. Added &quot;derby.drda.traceAll=true&quot; to derby.properties file to test memcheck.&lt;/li&gt;
	&lt;li&gt;runtimeinfo: Rearranged test because the output was not predictable on different jvms/machines.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Ran derbyall with Sun JDK 1.4.2 on WinXP. No failures. Please review/commit this patch. &lt;/p&gt;

&lt;p&gt;Kathey, I looked into your question:&lt;br/&gt;
//this looks highly suspect. Why does timeSlice setSoTimeout?&lt;br/&gt;
if (timeSlice != 0)&lt;br/&gt;
clientSocket.setSoTimeout(timeSlice); &lt;/p&gt;

&lt;p&gt;From what I understand, setSoTimeout socket option is used so that a thread waits only for the time specified.  Otherwise for blocking operations, a thread can wait indefinitely. In case of network server, it can wait indefinitely without considering value specified in timeslice property. I have not included the test for these in this patch.&lt;/p&gt;

&lt;p&gt;I have couple of questions:&lt;/p&gt;

&lt;p&gt;1. In one case where agentError is thrown (DRDAConnThread#parseNOCMorNOCS), it seems to me that a syntax error should be thrown here. For agentErrors, no code point is sent back to the client. In DDM manual, I saw AGNPRMRM is used for severe agent errors. Is there something else which can be sent back for non-severe errors?&lt;br/&gt;
2. QRYINSID is checked in CNTQRY and CLSQRY but it is not being used. Should this be used?&lt;/p&gt;

&lt;p&gt;I would appreciate if someone can provide answers for above. Thanks. &lt;/p&gt;</comment>
                            <comment id="12360022" author="kmarsden" created="Sat, 10 Dec 2005 11:37:17 +0000"  >&lt;p&gt;Hi Deepa, &lt;/p&gt;

&lt;p&gt;Your patch looks good except for this System.out in DRDAConnThread.&lt;/p&gt;

&lt;p&gt;  System.out.println(&quot;ccsidSBCEncoding - &quot; + ccsidSBCEncoding);&lt;/p&gt;</comment>
                            <comment id="12360220" author="deepa" created="Tue, 13 Dec 2005 01:42:03 +0000"  >&lt;p&gt;Thanks for catching this, Kathey. I have uploaded  derby-706_2_v2.diff.&lt;/p&gt;</comment>
                            <comment id="12415900" author="deepa" created="Tue, 13 Jun 2006 03:20:09 +0100"  >&lt;p&gt;With svn revisions 348577 and 356553 , code coverage was increased to:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;org.apache.derby.drda increase NetworkServercontrol.java - 100/72 -&amp;gt; 100/94&lt;br/&gt;
Method coverage is not 100% because 1 method (setClientLocale) is left out from automated test. It is only used by servlet. &lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;org.apache.derby.drda.impl.drda - 97/78 &lt;del&gt;&amp;gt; 100&lt;/del&gt;&amp;gt;85&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12428350" author="johnemb" created="Wed, 16 Aug 2006 09:23:31 +0100"  >&lt;p&gt;Seems like SVN revision 356553 (patch &apos;derby-706_2.diff&apos;) did not apply cleanly. The file &lt;/p&gt;

&lt;p&gt;java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testProperties_derby.properties&lt;/p&gt;

&lt;p&gt;is &quot;corrupt&quot;; it includes for some reason the following text three times (without line breaks between each, so it looks cluttered):&lt;/p&gt;

&lt;p&gt;   #defaults&lt;br/&gt;
   derby.infolog.append=true&lt;br/&gt;
   derby.locks.waitTimeout=120&lt;br/&gt;
   derby.language.logStatementText=true&lt;/p&gt;

&lt;p&gt;   #added to cover call to memCheck class&lt;br/&gt;
   derby.drda.debug=true&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;http://svn.apache.org/viewvc/db/derby/code/trunk/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testProperties_derby.properties?view=markup&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/db/derby/code/trunk/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testProperties_derby.properties?view=markup&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I am not sure if this has affected the test in any way, but it should be fixed. See also &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1694&quot; title=&quot;derbynet/testProperties.java hangs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1694&quot;&gt;&lt;del&gt;DERBY-1694&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="31584">DERBY-209</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12320845" name="derby-706.diff" size="28608" author="deepa" created="Tue, 22 Nov 2005 09:35:21 +0000"/>
                            <attachment id="12320846" name="derby-706.status" size="1560" author="deepa" created="Tue, 22 Nov 2005 09:35:21 +0000"/>
                            <attachment id="12321214" name="derby-706_2.status" size="1547" author="" created="Thu, 8 Dec 2005 07:54:58 +0000"/>
                            <attachment id="12321293" name="derby-706_2_v2.diff" size="24713" author="deepa" created="Tue, 13 Dec 2005 01:42:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 24 Nov 2005 07:10:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29669</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy14vr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40441</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>