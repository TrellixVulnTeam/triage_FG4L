<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:39:51 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3046/DERBY-3046.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3046] setObj(int,Object,int) causes NPE if no parameter markers are present; should generate SQLException as for setObject(int,Object)</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3046</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Change WwdClientExample so that there are no parameters, e.g.&lt;/p&gt;

&lt;p&gt;psInsert = conn.prepareStatement(&quot;insert into WISH_LIST(WISH_ITEM) values (&apos;?&apos;)&quot;);&lt;/p&gt;

&lt;p&gt;Now change &lt;br/&gt;
   psInsert.setString(1,answer);&lt;br/&gt;
to&lt;br/&gt;
  psInsert.setObject(1,answer);&lt;/p&gt;

&lt;p&gt;and the error is OK:&lt;/p&gt;

&lt;p&gt;SQLState:   XCL14&lt;br/&gt;
Severity: 20000&lt;br/&gt;
Message:  The column position &apos;1&apos; is out of range.  The number of columns for this ResultSet is &apos;0&apos;.&lt;br/&gt;
java.sql.SQLException: The column position &apos;1&apos; is out of range.  The number of columns for this ResultSet is &apos;0&apos;.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;However, using:&lt;/p&gt;

&lt;p&gt;psInsert.setObject(1,answer,java.sql.Types.VARCHAR);&lt;/p&gt;

&lt;p&gt;causes an NPE:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.checkForValidParameterIndex(Unknown Source)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.setObjectX(Unknown Source)&lt;br/&gt;
        at org.apache.derby.client.am.PreparedStatement.setObject(Unknown Source)&lt;br/&gt;
        at WwdClientExample.main(WwdClientExample.java:93)&lt;/p&gt;

&lt;p&gt;Surely it should behave the same as the previous method call - i.e. return an SQLException?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12377464">DERBY-3046</key>
            <summary>setObj(int,Object,int) causes NPE if no parameter markers are present; should generate SQLException as for setObject(int,Object)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mamtas">Mamta A. Satoor</assignee>
                                    <reporter username="sebb@apache.org">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Sep 2007 17:17:22 +0100</created>
                <updated>Fri, 21 Jan 2011 17:50:50 +0000</updated>
                            <resolved>Fri, 26 Oct 2007 06:27:28 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.2.1</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>JDBC</component>
                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12536336" author="mamtas" created="Fri, 19 Oct 2007 21:32:45 +0100"  >&lt;p&gt;Committed fix for this in trunk (revision 586596) with following commit comments. Will merge this into 10.3 codeline soon.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3046&quot; title=&quot;setObj(int,Object,int) causes NPE if no parameter markers are present; should generate SQLException as for setObject(int,Object)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3046&quot;&gt;&lt;del&gt;DERBY-3046&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This commit fixes the null pointer exception by making sure that we do not try to access the object&apos;s elements if the object is null. I have also added a test case for this fix. &lt;/p&gt;

&lt;p&gt;Additionally, while working on this, I found that we return different sql state for parameter being out of range for PreparedStatment.setObject and Preparedstatement.setXXX calls in Network Server. I have entered a Jira entry for that issue &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3139&quot; title=&quot;setObject and other setXXX methods on PreparedStatement throw different exceptions in Network Server when parameter number is out of range&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3139&quot;&gt;DERBY-3139&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12536340" author="mamtas" created="Fri, 19 Oct 2007 21:52:27 +0100"  >&lt;p&gt;Migrated change into 10.3 codeline with revision 586607. Will go ahead and close this issue,&lt;/p&gt;</comment>
                            <comment id="12537830" author="mamtas" created="Fri, 26 Oct 2007 06:11:56 +0100"  >&lt;p&gt;Reopening the issue because I have another small change to make as part of this Jira entry which will ensure that setObject returns the same exception in both Network Server and Embedded WHEN the PreparedStatement has no parameters associated with it at all. Currently, following sql will return different exceptions in Embedded and Network Server (this test case is copied from derbynet.PrepareStatementTest).&lt;/p&gt;

&lt;p&gt;ps = prepareStatement(&quot;insert into WISH_LIST(WISH_ITEM) values (&apos;bb&apos;)&quot;);&lt;br/&gt;
ps.setObject(1,&quot;cc&quot;,java.sql.Types.VARCHAR);&lt;/p&gt;

&lt;p&gt;ps.setObject in Embedded will throw SQL State 07009 whereas in Network Server, it will throw SQL State XCL13. As part of the change that I plan to commit, in the example case above, we will always throw SQL State 07009 in both Embedded and Network Server.&lt;/p&gt;
</comment>
                            <comment id="12537832" author="mamtas" created="Fri, 26 Oct 2007 06:22:41 +0100"  >&lt;p&gt;Committed the changes into trunk using revision 588527. The commit comments were as follows&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3046&quot; title=&quot;setObj(int,Object,int) causes NPE if no parameter markers are present; should generate SQLException as for setObject(int,Object)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3046&quot;&gt;&lt;del&gt;DERBY-3046&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
This commit will ensure that setObject returns the same exception in both Network Server and Embedded WHEN the &lt;br/&gt;
PreparedStatement has no parameters associated with it at all. Without the changes that are going in this commit,&lt;br/&gt;
following sql will return different exceptions in Embedded and Network Server (this test case is copied from &lt;br/&gt;
derbynet.PrepareStatementTest). &lt;/p&gt;

&lt;p&gt;ps = prepareStatement(&quot;insert into WISH_LIST(WISH_ITEM) values (&apos;bb&apos;)&quot;); &lt;br/&gt;
ps.setObject(1,&quot;cc&quot;,java.sql.Types.VARCHAR); &lt;/p&gt;

&lt;p&gt;ps.setObject in Embedded will throw SQL State 07009 whereas in Network Server, it will throw SQL State XCL13. &lt;br/&gt;
As part of this commit, in the example case above, we will always throw SQL State 07009 in both Embedded and &lt;br/&gt;
Network Server. &lt;/p&gt;</comment>
                            <comment id="12537835" author="mamtas" created="Fri, 26 Oct 2007 06:27:28 +0100"  >&lt;p&gt;Migrated changes from trunk (revision 588527) into 10.3 (revision 588530).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 19 Oct 2007 20:32:45 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23394</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0m27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37392</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>