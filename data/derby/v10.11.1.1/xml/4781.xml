<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:30:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4781/DERBY-4781.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4781] suites.All fails completely with  Failed to invoke suite():java.lang.reflect.InvocationTargetException  because of XplainStatisticsTest</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4781</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;weme 6.2 tests fail to kick off because of XplainStatisticsTest after the change:&lt;br/&gt;
r982637  &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4587&quot; title=&quot;Add tools for improved analysis and understanding of query plans and execution statistics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4587&quot;&gt;&lt;del&gt;DERBY-4587&lt;/del&gt;&lt;/a&gt;: Add tools for query plan analysis &lt;/p&gt;

&lt;p&gt;The problem seems related to the import and use of &lt;/p&gt;

&lt;p&gt;import org.w3c.dom.Document;&lt;br/&gt;
import org.w3c.dom.NodeList;&lt;/p&gt;

&lt;p&gt;I am not sure if there are additional jars that I need to use to get these libraries from the weme distribution or if they are available.   After this same checkin the test also fails on CVM/phoneme with the error below but it does not prevent the full suite from kicking off.&lt;/p&gt;

&lt;p&gt;ime: 15,558.801&lt;br/&gt;
There was 1 error:&lt;br/&gt;
1) testScanPositions(org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest)java.lang.NoSuchMethodError: java.lang.String: method split(Ljava/lang/String&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;[Ljava/lang/String; not found&lt;br/&gt;
	at org.apache.derby.impl.tools.planexporter.AccessDatabase.replace(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.tools.planexporter.AccessDatabase.statement(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest.disableXplainStyle(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.lang.XplainStatisticsTest.testScanPositions(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(Unknown Source)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(Unknown Source)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(Unknown Source)&lt;br/&gt;
	at junit.extensions.TestSetup.run(Unknown Source)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(Unknown Source)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(Unknown Source)&lt;br/&gt;
	at junit.extensions.TestSetup.run(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(Unknown Source)&lt;br/&gt;
	at sun.misc.CVM.runMain(Unknown Source)&lt;/p&gt;

&lt;p&gt;FAILURES!!!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://dbtg.foundry.sun.com/derby/test/Daily/javaME/testing/testlog/ubuntu/983036-suitesAll_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.foundry.sun.com/derby/test/Daily/javaME/testing/testlog/ubuntu/983036-suitesAll_diff.txt&lt;/a&gt;&lt;/p&gt;
</description>
                <environment>java.fullversion: IBM J9 2.4 Windows XP x86-32  (JIT enabled, AOT enabled)&lt;br/&gt;
J9VM - 20080919_023055_lHdFGQ&lt;br/&gt;
JIT  - r9.weme62_20080724_2131&lt;br/&gt;
GC   - 20080609_AA&lt;br/&gt;
</environment>
        <key id="12472045">DERBY-4781</key>
            <summary>suites.All fails completely with  Failed to invoke suite():java.lang.reflect.InvocationTargetException  because of XplainStatisticsTest</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nirmal">Nirmal Fernando</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Aug 2010 00:18:24 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:49 +0100</updated>
                            <resolved>Tue, 1 Feb 2011 05:22:17 +0000</resolved>
                                    <version>10.7.1.1</version>
                                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                            <comments>
                            <comment id="12900547" author="nirmal" created="Fri, 20 Aug 2010 02:09:30 +0100"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;To me it seems like this error was caused by the use of String.split() method, in the replace method of AccessDatabase class.&lt;br/&gt;
May be replacement to that method would do? What you think?&lt;/p&gt;

&lt;p&gt;Thanks for pointing this out!!&lt;/p&gt;
</comment>
                            <comment id="12900552" author="bryanpendleton" created="Fri, 20 Aug 2010 02:55:04 +0100"  >&lt;p&gt;The exception seems to point to a problem with String.split() I agree. Nirmal, if you&lt;br/&gt;
can construct a patch which does not use String.split(), then perhaps Kathey could&lt;br/&gt;
check your patch in her environment to see if it resolves the problem for her?&lt;/p&gt;</comment>
                            <comment id="12900554" author="nirmal" created="Fri, 20 Aug 2010 03:50:23 +0100"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;This patch removes String.split() method and uses String.replaceAll() method.&lt;br/&gt;
I&apos;m not sure whether that method is available, though.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12900557" author="kmarsden" created="Fri, 20 Aug 2010 04:08:28 +0100"  >&lt;p&gt;I think that will resolve the failure with phoneme but weme is more serious.  In weme we do not have the xml classes:&lt;/p&gt;

&lt;p&gt;import org.w3c.dom.Document;&lt;br/&gt;
import org.w3c.dom.NodeList;&lt;/p&gt;


&lt;p&gt;And this leads to an immediate and complete failure of suites.All with suite():java.lang.reflect.InvocationTargetException.&lt;/p&gt;

&lt;p&gt;Running the test stand alone gives more information:&lt;br/&gt;
+ c:/cygwin/ibmsvn/ntsoftware/weme6.2/bin/j9 -jcl:foun11 -Demma.active= -Xbootclasspath&lt;br/&gt;
a:c:/cygwin/ibmsvn/ntsoftware/weme6.2/lib/jdbc.jar -Dbootcp=c:/cygwin/ibmsvn/nt&lt;br/&gt;
oftware/weme6.2/lib/jdbc.jar junit.textui.TestRunner org.apache.derbyTesting.fu&lt;br/&gt;
ctionTests.tests.lang.XplainStatisticsTest&lt;br/&gt;
Failed to invoke suite():java.lang.NoClassDefFoundError: org.w3c.dom.Document&lt;/p&gt;

&lt;p&gt;I searched all the jars and zips in the weme distribution for this class and did not see it. Myrna is checking if there is an external jar somewhere available. If not we will need to do something in the test to load the classes dynamically if available and skip the fixture using them for weme. Hopefully that won&apos;t be necessary.&lt;/p&gt;

</comment>
                            <comment id="12900562" author="nirmal" created="Fri, 20 Aug 2010 04:25:03 +0100"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;These two classes are available in &quot;xml-apis.jar&quot; located in tools/java.&lt;/p&gt;

&lt;p&gt;Hope this helps!&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="12900565" author="kmarsden" created="Fri, 20 Aug 2010 04:49:35 +0100"  >&lt;p&gt;Thank you Nirmal. I do not actually see xml-apis.jar in the repository &lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc/db/derby/code/trunk/tools/java/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/db/derby/code/trunk/tools/java/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I  downloaded it with xalan 2.7.1, put it in my boot path and just get the split error seen with phoneme, so presumably xml-apis.jar is J2ME ready and works fine at least for this test.  So I guess the question is should xml-apis.jar be checked in?  It certainly would be convenient for weme runs if it is.&lt;/p&gt;

</comment>
                            <comment id="12900582" author="nirmal" created="Fri, 20 Aug 2010 07:00:58 +0100"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;I think the problem occurred with weme is due to that two import lines, ideally I should not use them there. (PS: The tests already checks for the presence of these classes in the classpath. It&apos;s just that bad use of import made the noise I believe.) &lt;/p&gt;

&lt;p&gt;Hopefully this patch will solve the problem. Kathey, if you don&apos;t mind please run the test class after removing xml-apis.jar from your classpath and update me whether this works.&lt;/p&gt;

&lt;p&gt;Thank you very much!&lt;/p&gt;</comment>
                            <comment id="12900807" author="kmarsden" created="Fri, 20 Aug 2010 19:09:32 +0100"  >&lt;p&gt;Hello Nirmal,&lt;/p&gt;

&lt;p&gt;for the removeSplitMethod patch, there is still and issue because replaceAll is not available either. See:&lt;br/&gt;
&lt;a href=&quot;http://download-llnw.oracle.com/javame/config/cldc/ref-impl/cldc1.1/jsr139/java/lang/String.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download-llnw.oracle.com/javame/config/cldc/ref-impl/cldc1.1/jsr139/java/lang/String.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For  the fixerToDOM patch it does not work to  inline the full  class names into the method.  You would need to use Class.forName() to load the class and then reflection to get at the methods if the class does not exist.  I think it would be ok though to just require that weme runs run with xml-apis.jar.  I think it is fine to check it in and think it would be covered by the Xalan statement in the NOTICE file. We used to have it but removed it because it was no longer used by the build.&lt;/p&gt;</comment>
                            <comment id="12900954" author="bryanpendleton" created="Sat, 21 Aug 2010 02:35:18 +0100"  >&lt;p&gt;+1 to the solution Kathey proposes in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4782&quot; title=&quot;Add Xalan xml-apis.jar to tools/java for test runs with jvms that don&amp;#39;t include its classes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4782&quot;&gt;&lt;del&gt;DERBY-4782&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12900960" author="nirmal" created="Sat, 21 Aug 2010 02:57:44 +0100"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;I was searching for that API, thanks for the link! I&apos;ll attach a patch soon!&lt;/p&gt;

&lt;p&gt;Thanks for addressing the issue with weme too!&lt;/p&gt;</comment>
                            <comment id="12900965" author="nirmal" created="Sat, 21 Aug 2010 04:15:30 +0100"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;This should definitely solves the problem with the split method.&lt;/p&gt;

&lt;p&gt;Thanks. &lt;/p&gt;</comment>
                            <comment id="12901415" author="knutanders" created="Mon, 23 Aug 2010 15:20:30 +0100"  >&lt;p&gt;Kathey, before we give up, could you check if the attached patch (signature.diff) solves the NoClassDefFoundError? I think we&apos;ve seen before that weme complains if a class references an unknown class in one of the method signatures, but has no problems loading the class if the unknown class is only referenced inside the methods. The patch makes the getADocument() return an Object instead of a Document and lets the callers take care of casting the returned value to Document.&lt;/p&gt;</comment>
                            <comment id="12901607" author="kmarsden" created="Mon, 23 Aug 2010 22:45:14 +0100"  >&lt;p&gt;Thank you Knut. signature.diff indeed made the tests run.   I committed with revision 988321, so we should see weme run tonight.&lt;/p&gt;

&lt;p&gt;One thing I noticed is that there is a fairly large block of work in an if(XML.classpathMeetsXMLReqs()) block, so actually the same number of fixtures run with or without XML availability.  It would be nice if somehow this testing could be a separate fixture so that we see a lower  test count when fewer tests are run.&lt;/p&gt;</comment>
                            <comment id="12901754" author="knutanders" created="Tue, 24 Aug 2010 08:13:57 +0100"  >&lt;p&gt;The new replace() method looks broken to me. Won&apos;t it always return an empty string if a matching character is found? Also, does it need to call stmt.indexOf(expr) three times? Once ought to be enough, I think.&lt;/p&gt;</comment>
                            <comment id="12901764" author="nirmal" created="Tue, 24 Aug 2010 09:08:54 +0100"  >&lt;p&gt;Hi Knut,&lt;/p&gt;

&lt;p&gt;I think the replace() method works fine! Since there&apos;s a recursive call to the same method just before the &quot;return &quot; &quot;;&quot; statement, therefore the return statement will be executed only when there&apos;s no matching character found.&lt;/p&gt;

&lt;p&gt;I&apos;ve introduced a local variable for the stmt.indexOf(expr), and overwrite the patch.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12901913" author="knutanders" created="Tue, 24 Aug 2010 15:44:39 +0100"  >&lt;p&gt;The replace() method doesn&apos;t work as expected in my environment, at least. See the attached program ReplaceTest, which produces this output:&lt;/p&gt;

&lt;p&gt;replace(&quot;&amp;lt;hello&amp;gt;&quot;, &quot;&amp;lt;&quot;, &quot;&amp;lt;&quot;): &quot;&quot;&lt;br/&gt;
replace(&quot;adfad&amp;lt;adfadf&quot;, &quot;&amp;lt;&quot;, &quot;&amp;lt;&quot;): &quot;&quot;&lt;br/&gt;
replace(&quot;afad&amp;gt;asdfad&quot;, &quot;&amp;lt;&quot;, &quot;&amp;lt;&quot;): &quot;afad&amp;gt;asdfad&quot;&lt;br/&gt;
replace(&quot;test&quot;, &quot;&amp;lt;&quot;, &quot;&amp;lt;&quot;): &quot;test&quot;&lt;/p&gt;

&lt;p&gt;Note that the first two calls return an empty string.&lt;/p&gt;</comment>
                            <comment id="12901918" author="bryanpendleton" created="Tue, 24 Aug 2010 15:56:57 +0100"  >&lt;p&gt;Rather than writing the method recursively, perhaps it&apos;s clearer to write it as a &apos;while&apos; loop:&lt;/p&gt;

&lt;p&gt;  int idx = stmt.indexOf(expr);&lt;br/&gt;
  while (idx &amp;gt;= 0)&lt;/p&gt;
  {
    stmt = stmt.substring(0, idx) + replace + stmt.substring(idx+1);
    idx = stmt.indexOf(expr);
  }
&lt;p&gt;  return stmt;&lt;/p&gt;</comment>
                            <comment id="12901974" author="nirmal" created="Tue, 24 Aug 2010 18:23:55 +0100"  >&lt;p&gt;Hi Knut, thanks for pointing that out! You&apos;re correct that method is broken. &lt;/p&gt;

&lt;p&gt;Thanks Bryan, for proposing that, I&apos;ve overwritten the patch, with your suggestion.&lt;/p&gt;

&lt;p&gt;Sorry for the inconvenience!&lt;/p&gt;</comment>
                            <comment id="12902394" author="knutanders" created="Wed, 25 Aug 2010 13:06:45 +0100"  >&lt;p&gt;Thanks for the fix, Nirmal! I&apos;ve committed it to trunk with revision 989036.&lt;/p&gt;</comment>
                            <comment id="12935789" author="knutanders" created="Thu, 25 Nov 2010 16:34:42 +0000"  >&lt;p&gt;Looks like the work is done on this issue. Marking as fixed.&lt;/p&gt;</comment>
                            <comment id="13685367" author="knutanders" created="Mon, 17 Jun 2013 10:19:49 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12452936" name="ReplaceTest.java" size="779" author="knutanders" created="Tue, 24 Aug 2010 15:44:39 +0100"/>
                            <attachment id="12452607" name="derby-4587-fixerToDOM.diff" size="2803" author="nirmal" created="Fri, 20 Aug 2010 07:00:58 +0100"/>
                            <attachment id="12452948" name="derby-4587-removeSplitMethod.diff" size="934" author="nirmal" created="Tue, 24 Aug 2010 18:23:55 +0100"/>
                            <attachment id="12452903" name="derby-4587-removeSplitMethod.diff" size="791" author="nirmal" created="Tue, 24 Aug 2010 09:08:54 +0100"/>
                            <attachment id="12452698" name="derby-4587-removeSplitMethod.diff" size="991" author="nirmal" created="Sat, 21 Aug 2010 04:15:30 +0100"/>
                            <attachment id="12452600" name="derby-4587-removeSplitMethod.diff" size="734" author="nirmal" created="Fri, 20 Aug 2010 03:50:23 +0100"/>
                            <attachment id="12452814" name="signature.diff" size="2158" author="knutanders" created="Mon, 23 Aug 2010 15:20:30 +0100"/>
                    </attachments>
                <subtasks>
                            <subtask id="12472128">DERBY-4782</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 20 Aug 2010 01:09:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24462</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10422"><![CDATA[High Value Fix]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0jbr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36949</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>