<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:08:54 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3202/DERBY-3202.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3202] &apos;AccessControlException: access denied (java.io.FilePermission C:\....\file-2.log read)&apos; in ErrorStreamTest.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3202</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Seen on Windows only.&lt;/p&gt;

&lt;p&gt;See e.g. &lt;br/&gt;
&lt;a href=&quot;http://dbtg.thresher.com/derby/test/Daily/jvm1.6/testing/Limited/testSummary-594211.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.thresher.com/derby/test/Daily/jvm1.6/testing/Limited/testSummary-594211.html&lt;/a&gt; : vista, w2003.&lt;/p&gt;

&lt;p&gt;suitesAll fail *************************************************************&lt;br/&gt;
1) testFile(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:\cludev\jagtmp\autoderbyN_regression\suitesAll_30\log\system\file-2.log read)&lt;br/&gt;
2) testWrongFile(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:\cludev\jagtmp\autoderbyN_regression\suitesAll_30\log\system\foo\file-3.log read)&lt;br/&gt;
3) testFileOverMethod(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:\cludev\jagtmp\autoderbyN_regression\suitesAll_30\log\system\file-8.log read)&lt;br/&gt;
4) testFileOverField(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:\cludev\jagtmp\autoderbyN_regression\suitesAll_30\log\system\file-9.log read)&lt;br/&gt;
5) testFileOverMethodAndField(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:\cludev\jagtmp\autoderbyN_regression\suitesAll_30\log\system\file-10.log read)&lt;br/&gt;
1) testDefault(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: File C:\cludev\jagtmp\autoderbyN_regression\suitesAll_30\log\system\derby.log could not be deleted&lt;br/&gt;
2) testMethod(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: assertNotEmpty failed:C:\cludev\jagtmp\autoderbyN_regression\suitesAll_30\log\system\method-4.log&lt;br/&gt;
suitesAll fail *************************************************************&lt;/p&gt;


&lt;p&gt;1) testFile(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)java.security.AccessControlException: access denied (java.io.FilePermission C:\cludev\jagtmp\autoderbyN_regression\suitesAll_30\log\system\file-2.log read)&lt;br/&gt;
	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:323)&lt;br/&gt;
	at java.security.AccessController.checkPermission(AccessController.java:546)&lt;br/&gt;
	at java.lang.SecurityManager.checkPermission(SecurityManager.java:532)&lt;br/&gt;
	at java.lang.SecurityManager.checkRead(SecurityManager.java:871)&lt;br/&gt;
	at java.io.File.exists(File.java:731)&lt;br/&gt;
	at java.io.Win32FileSystem.canonicalize(Win32FileSystem.java:402)&lt;br/&gt;
	at java.io.File.getCanonicalPath(File.java:559)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest.testFile(ErrorStreamTest.java:140)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:95)&lt;/p&gt;

&lt;p&gt;++&lt;/p&gt;</description>
                <environment>OS: Windows&lt;br/&gt;
JVM: Sun Microsystems Inc. 1.5.0, Sun Microsystems Inc. 1.4.2</environment>
        <key id="12382405">DERBY-3202</key>
            <summary>&apos;AccessControlException: access denied (java.io.FilePermission C:\....\file-2.log read)&apos; in ErrorStreamTest.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vemund">Vemund &#216;stgaard</assignee>
                                    <reporter username="olesolberg">Ole Solberg</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Nov 2007 07:43:23 +0000</created>
                <updated>Sun, 16 Dec 2012 08:26:40 +0000</updated>
                            <resolved>Tue, 27 Nov 2007 13:01:29 +0000</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12542420" author="vemund" created="Wed, 14 Nov 2007 11:26:16 +0000"  >&lt;p&gt;Problem was that getCanonicalPath() needed a security permission on Windows (but not on Solaris/Linux). In addition the Derby engine had to be shut down before derby.log could be deleted on Windows.&lt;/p&gt;

&lt;p&gt;This patch should fix the problem. At least it worked for me on windows, running the test standalone and as part of suites.All. Also ran the test standalone on Solaris, and it still worked as expected.&lt;/p&gt;</comment>
                            <comment id="12542471" author="knutanders" created="Wed, 14 Nov 2007 14:24:58 +0000"  >&lt;p&gt;Thanks for the patch, Vemund. Committed revision 594894. I&apos;m leaving the issue open until we have verified that the problem is fixed in the nightly tests.&lt;/p&gt;</comment>
                            <comment id="12543175" author="knutanders" created="Fri, 16 Nov 2007 19:23:09 +0000"  >&lt;p&gt;The failures didn&apos;t appear in last night&apos;s regression tests. Closing the issue.&lt;/p&gt;</comment>
                            <comment id="12543914" author="olesolberg" created="Tue, 20 Nov 2007 14:57:39 +0000"  >&lt;p&gt;A similar&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; failure still shows up on vista/1.4.2. &lt;br/&gt;
See e.g. &lt;a href=&quot;http://dbtg.thresher.com/derby/test/Daily/jvm1.4/testing/Limited/testSummary-596365.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.thresher.com/derby/test/Daily/jvm1.4/testing/Limited/testSummary-596365.html&lt;/a&gt; / vista,&lt;br/&gt;
or via todays &lt;a href=&quot;http://dbtg.thresher.com/derby/test/stats_today.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.thresher.com/derby/test/stats_today.html&lt;/a&gt; .&lt;/p&gt;

&lt;p&gt;1) testDefault(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: assertNotEmpty failed:C:\cludev\jagtmp\autoderbyN_derbyall\suitesAll_1\log\system\derby.log&lt;br/&gt;
2) testFile(org.apache.derbyTesting.functionTests.tests.engine.ErrorStreamTest)junit.framework.AssertionFailedError: assertNotEmpty failed:C:\cludev\jagtmp\autoderbyN_derbyall\suitesAll_1\log\system\file-2.log&lt;/p&gt;</comment>
                            <comment id="12544454" author="vemund" created="Wed, 21 Nov 2007 13:17:20 +0000"  >&lt;p&gt;It is most likely a different issue, and I&apos;m a bit surprised it only happens on Vista with a 1.4 JVM, and not in any other configuration. I&apos;ll find a Vista machine and see if I can figure it out.&lt;/p&gt;</comment>
                            <comment id="12545414" author="vemund" created="Mon, 26 Nov 2007 11:49:14 +0000"  >&lt;p&gt;I think we have hit a bug in the 1.4.2 JDK on Vista. Derby specifically creates a PrintWriter with automatic flushing enabled for writing to derby.log, but in this test nothing is flushed to derby.log before the engine is shut down.&lt;/p&gt;

&lt;p&gt;The nightly testing is run with update 13 of Suns 1.4.2 JDK, I&apos;ll try update 16 and see if it is fixed there. If it fails there as well I am not sure what we can do about this problem.&lt;/p&gt;</comment>
                            <comment id="12545445" author="vemund" created="Mon, 26 Nov 2007 13:49:20 +0000"  >&lt;p&gt;This also fails with the latest available update (16) of Suns JDK1.4.2 on Vista. I&apos;ve logged the bug against the jdk, but this test will keep failing the way things are now.&lt;/p&gt;

&lt;p&gt;I&apos;m unsure about how to best handle this. Since the test only fails with jdk1.4.2 on Vista, the bug does not create a lot of noise and the test works on all other platforms/jdks. I also consider the fact that logmessages are flushed immediately a part of Derbys functionality and not an implementation detail, so I think the test is valid the way it is. Any precedent for how cases like this one are handled?&lt;/p&gt;</comment>
                            <comment id="12545758" author="vemund" created="Tue, 27 Nov 2007 08:55:29 +0000"  >&lt;p&gt;This patch changes the ErrorStream test to avoid the problematic piece of code (File.length() checks) when running on Windows Vista with Sun JDK 1.4.2, for all other configurations it should behave the same way as before. This should remove the &quot;noise&quot; from the nightly testing.&lt;/p&gt;

&lt;p&gt;I have also changed the setup of the tests a little to be more robust if any of the tests fail.&lt;/p&gt;</comment>
                            <comment id="12545759" author="vemund" created="Tue, 27 Nov 2007 08:57:41 +0000"  >&lt;p&gt;One more patch for this test on Windows.&lt;/p&gt;</comment>
                            <comment id="12545764" author="knutanders" created="Tue, 27 Nov 2007 09:20:12 +0000"  >&lt;p&gt;Hi Vemund,&lt;/p&gt;

&lt;p&gt;Did you mean to use BaseTestCase.println() instead of System.out.println() in buggyFileLength()? I think we should avoid System.out.println() as much as possible in the tests.&lt;/p&gt;

&lt;p&gt;If the problem is that File.length() is buggy and not that the output isn&apos;t flushed, would the test work on Vista if assertNotEmpty() used a stream to check whether the file was empty? Something like this:&lt;/p&gt;

&lt;p&gt;assertTrue(&quot;File doesn&apos;t exist&quot;, f.exists());&lt;br/&gt;
FileInputStream fis = new FileInputStream(f);&lt;br/&gt;
assertNotSame(&quot;File is empty&quot;, -1, fis.read);&lt;br/&gt;
fis.close();&lt;/p&gt;</comment>
                            <comment id="12545768" author="vemund" created="Tue, 27 Nov 2007 09:35:29 +0000"  >&lt;p&gt;Ops, yes I was going to change that back to println before submitting...&lt;/p&gt;

&lt;p&gt;I am not sure if it is File.length() that is buggy or if the output isn&apos;t flushed, I&apos;ll try your suggestion and see if that works.&lt;/p&gt;</comment>
                            <comment id="12545779" author="vemund" created="Tue, 27 Nov 2007 10:19:55 +0000"  >&lt;p&gt;That certainly was a better solution, apparently the flushing works fine it is just File.length() that is buggy in certain circumstances. &lt;/p&gt;

&lt;p&gt;Here is a new patch using your approach instead. Hopefully this works on all other configurations as well, I tested a few and it looked good.&lt;/p&gt;</comment>
                            <comment id="12545815" author="knutanders" created="Tue, 27 Nov 2007 13:01:28 +0000"  >&lt;p&gt;Thanks Vemund! Committed revision 598626.&lt;/p&gt;</comment>
                            <comment id="13533303" author="waikhom" created="Sun, 16 Dec 2012 08:26:40 +0000"  >&lt;p&gt;I am also using db-derby-10.9.1.0-bin. when I start the startNetworkServer.bat it gives me an error as follows.&lt;br/&gt;
java.security.AccessControlException: access denied (java.io.FilePermission derby.log read).&lt;/p&gt;

&lt;p&gt;Could someone help me how to get the derby version with &quot;Committed revision 594894&quot; ?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12381357">DERBY-3156</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12369496" name="3202-diff" size="4678" author="vemund" created="Wed, 14 Nov 2007 11:26:16 +0000"/>
                            <attachment id="12369497" name="3202-diff.stat" size="92" author="vemund" created="Wed, 14 Nov 2007 11:26:16 +0000"/>
                            <attachment id="12370277" name="3202-vistaproblem-diff" size="2579" author="vemund" created="Tue, 27 Nov 2007 08:55:29 +0000"/>
                            <attachment id="12370278" name="3202-vistaproblem-diff.stat" size="92" author="vemund" created="Tue, 27 Nov 2007 08:55:29 +0000"/>
                            <attachment id="12370285" name="3202-vistaproblem-diffv2" size="1671" author="vemund" created="Tue, 27 Nov 2007 10:19:54 +0000"/>
                            <attachment id="12370286" name="3202-vistaproblem-diffv2.stat" size="92" author="vemund" created="Tue, 27 Nov 2007 10:19:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 14 Nov 2007 11:26:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23493</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0vzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39000</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>