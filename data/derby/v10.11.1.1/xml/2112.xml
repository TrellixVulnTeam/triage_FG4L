<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:35:03 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2112/DERBY-2112.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2112] Nullpointer on executeBatchRequestX when preparedStatement has no parameters</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2112</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;there is a problem when using batch statements without bind parameters &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/help_16.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, with ClientDriver (derbyclient.jar):&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeBatchRequestX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeBatchX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeBatch(Unknown Source)&lt;br/&gt;
	at teste.Teste9.main(Teste9.java:29)&lt;/p&gt;

&lt;p&gt;test process to reproduce the bug:&lt;/p&gt;

&lt;p&gt;create a database called mydbtest under $DERBY_HOME/data&lt;/p&gt;

&lt;p&gt;create and populate a new table called teste1:&lt;/p&gt;

&lt;p&gt;create table teste1 ( valor numeric );&lt;br/&gt;
insert into teste1 values (1);&lt;br/&gt;
insert into teste1 values (2);&lt;br/&gt;
insert into teste1 values (3);&lt;/p&gt;

&lt;p&gt;start derby network server.&lt;/p&gt;

&lt;p&gt;run the following code:&lt;/p&gt;

&lt;p&gt;	public static void main(String[] args) throws SQLException {&lt;/p&gt;

&lt;p&gt;	    try &lt;/p&gt;
{
	        Class.forName(&quot;org.apache.derby.jdbc.ClientDriver&quot; );
	    }
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
	        e.printStackTrace();
	        return;
	    }

&lt;p&gt;	    Connection c = DriverManager.getConnection(&quot;jdbc:derby://localhost:1527/d:/derby_10/data/mydbtest&quot;, &quot;app&quot;, &quot;app&quot;);&lt;/p&gt;

&lt;p&gt;	    PreparedStatement ps = c.prepareStatement(&quot;update teste1 set valor = 8&quot;);&lt;br/&gt;
	    ps2.addBatch();&lt;/p&gt;

&lt;p&gt;	    int j[] = ps.executeBatch();&lt;br/&gt;
	    System.out.println(j&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;);&lt;br/&gt;
	    ps.close();&lt;/p&gt;

&lt;p&gt;	    c.close();&lt;br/&gt;
	}&lt;/p&gt;

&lt;p&gt;this exception is thrown:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeBatchRequestX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeBatchX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeBatch(Unknown Source)&lt;br/&gt;
	at teste.Teste9.main(Teste9.java:29)&lt;/p&gt;

&lt;p&gt;------&lt;/p&gt;

&lt;p&gt;i&apos;ve studied the source and got the bug on class org.apache.derby.client.am.PreparedStatement line 2043.&lt;/p&gt;

&lt;p&gt;then, i&apos;ve changed that line from this:&lt;/p&gt;

&lt;p&gt;			parameterMetaData_.clientParamtertype_ = (int[]) parameterTypeList.get&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;/p&gt;

&lt;p&gt;to this:&lt;/p&gt;

&lt;p&gt;			if (parameterMetaData_ != null) &lt;/p&gt;
{
				parameterMetaData_.clientParamtertype_ = (int[]) parameterTypeList.get(i);
			}

&lt;p&gt;after running the build and updating the derbyclient.jar, my application worked fine, so this seems to solve the problem.&lt;/p&gt;

&lt;p&gt;i didn&apos;t run the automatic build tests to check for other impacts / collateral effects.&lt;/p&gt;


&lt;p&gt;follows org.apache.derby.tools.sysinfo output:&lt;/p&gt;

&lt;p&gt;------------------ Informacoes sobre Java ------------------&lt;br/&gt;
Vers?o do Java:                     1.4.2_08&lt;br/&gt;
Fornecedor do Java:                 Sun Microsystems Inc.&lt;br/&gt;
Diret?rio base do Java:             C:\j2sdk1.4.2_08\jre&lt;br/&gt;
Caminho de classes do Java:         .;.;C:\PROGRA~1\JMF21~1.1E\lib\sound.jar;C:\PROGRA~1\JMF21~1.1E\lib\jmf.jar;C:\PROGRA~1\J&lt;br/&gt;
MF21~1.1E\lib;%systemroot%\java\classes;.;D:\DERBY_10/lib/derby.jar;D:\DERBY_10/lib/derbynet.jar;D:\DERBY_10/lib/derbyclient.&lt;br/&gt;
jar;D:\DERBY_10/lib/derbytools.jar&lt;br/&gt;
Nome do Sistema Operacional:        Windows XP&lt;br/&gt;
Arquitetura do Sistema Operacional: x86&lt;br/&gt;
Vers?o do Sistema Operacional:      5.1&lt;br/&gt;
Nome do usu&#223;rio Java:               acd025&lt;br/&gt;
Diret?rio base do usu&#223;rio Java:     D:\Profiles\acd025&lt;br/&gt;
Diret?rio do usu&#223;rio Java:          D:\derby_10&lt;br/&gt;
java.specification.name: Java Platform API Specification&lt;br/&gt;
java.specification.version: 1.4&lt;br/&gt;
---------------- Informa??es sobre o Derby -----------------&lt;br/&gt;
JRE - JDBC: J2SE 1.4.2 - JDBC 3.0&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;D:\derby_10\lib\derby.jar&amp;#93;&lt;/span&gt; 10.2.1.6 - (452058)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;D:\derby_10\lib\derbytools.jar&amp;#93;&lt;/span&gt; 10.2.1.6 - (452058)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;D:\derby_10\lib\derbynet.jar&amp;#93;&lt;/span&gt; 10.2.1.6 - (452058)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;D:\derby_10\lib\derbyclient.jar&amp;#93;&lt;/span&gt; 10.2.1.6 - (452058)&lt;br/&gt;
------------------------------------------------------&lt;br/&gt;
---------------- Informa??es sobre o Idioma ----------------&lt;br/&gt;
Idioma atual :  [portugu?s/Brasil &lt;span class=&quot;error&quot;&gt;&amp;#91;pt_BR&amp;#93;&lt;/span&gt;]&lt;br/&gt;
Encontrado suporte para o idioma: &lt;span class=&quot;error&quot;&gt;&amp;#91;de_DE&amp;#93;&lt;/span&gt;&lt;br/&gt;
         vers?o: 10.2.1.6 - (452058)&lt;br/&gt;
Encontrado suporte para o idioma: &lt;span class=&quot;error&quot;&gt;&amp;#91;es&amp;#93;&lt;/span&gt;&lt;br/&gt;
         vers?o: 10.2.1.6 - (452058)&lt;br/&gt;
Encontrado suporte para o idioma: &lt;span class=&quot;error&quot;&gt;&amp;#91;fr&amp;#93;&lt;/span&gt;&lt;br/&gt;
         vers?o: 10.2.1.6 - (452058)&lt;br/&gt;
Encontrado suporte para o idioma: &lt;span class=&quot;error&quot;&gt;&amp;#91;it&amp;#93;&lt;/span&gt;&lt;br/&gt;
         vers?o: 10.2.1.6 - (452058)&lt;br/&gt;
Encontrado suporte para o idioma: &lt;span class=&quot;error&quot;&gt;&amp;#91;ja_JP&amp;#93;&lt;/span&gt;&lt;br/&gt;
         vers?o: 10.2.1.6 - (452058)&lt;br/&gt;
Encontrado suporte para o idioma: &lt;span class=&quot;error&quot;&gt;&amp;#91;ko_KR&amp;#93;&lt;/span&gt;&lt;br/&gt;
         vers?o: 10.2.1.6 - (452058)&lt;br/&gt;
Encontrado suporte para o idioma: &lt;span class=&quot;error&quot;&gt;&amp;#91;pt_BR&amp;#93;&lt;/span&gt;&lt;br/&gt;
         vers?o: 10.2.1.6 - (452058)&lt;br/&gt;
Encontrado suporte para o idioma: &lt;span class=&quot;error&quot;&gt;&amp;#91;zh_CN&amp;#93;&lt;/span&gt;&lt;br/&gt;
         vers?o: 10.2.1.6 - (452058)&lt;br/&gt;
Encontrado suporte para o idioma: &lt;span class=&quot;error&quot;&gt;&amp;#91;zh_TW&amp;#93;&lt;/span&gt;&lt;br/&gt;
         vers?o: 10.2.1.6 - (452058)&lt;br/&gt;
------------------------------------------------------&lt;/p&gt;


</description>
                <environment>Using java version 1.5.0_05 (sun). </environment>
        <key id="12356489">DERBY-2112</key>
            <summary>Nullpointer on executeBatchRequestX when preparedStatement has no parameters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="myrna">Myrna van Lunteren</assignee>
                                    <reporter username="cesardevera">Cesar Devera</reporter>
                        <labels>
                    </labels>
                <created>Thu, 23 Nov 2006 12:24:51 +0000</created>
                <updated>Sat, 10 Feb 2007 14:49:38 +0000</updated>
                            <resolved>Sat, 10 Feb 2007 14:49:38 +0000</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12452399" author="kristwaa" created="Fri, 24 Nov 2006 09:21:20 +0000"  >&lt;p&gt;&apos;Derby2112ReproNPE.java&apos; demonstrates the reported bug (basically took code from the reporter of this issue).&lt;/p&gt;

&lt;p&gt;I also ran derbyall/suites.All with the proposed fix, and it ran without failures. I think a patch including a test case for this bug should be created.&lt;/p&gt;</comment>
                            <comment id="12470367" author="myrna" created="Mon, 5 Feb 2007 21:53:03 +0000"  >&lt;p&gt;Updated stack trace (with trunk at revision 502319), from running an attempt to convert test batchUpdate.java to junit. So, a test already exists, it&apos;s just not getting executed with network server currently.&lt;br/&gt;
---------------------------------&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeBatchRequestX(PreparedStatement.java:2264)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeBatchX(PreparedStatement.java:2193)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeBatch(PreparedStatement.java:1629)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.BatchUpdateTest.runNoParametersPreparedBatch(BatchUpdateTest.java:1000)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.BatchUpdateTest.testPreparedStatementBatchUpdatePositive(BatchUpdateTest.java:190)&lt;br/&gt;
---------------------------------&lt;/p&gt;</comment>
                            <comment id="12471719" author="myrna" created="Fri, 9 Feb 2007 15:10:00 +0000"  >&lt;p&gt;Attaching a patch with the fix suggested by Cesar &amp;amp; which activates the test in jdbcapi/BatchUpdateTest.java for network server.&lt;br/&gt;
suites.All and derbyall ran cleanly for me too, but as I know nothing about this code, another check is probably good. &lt;/p&gt;

&lt;p&gt;Review please?&lt;/p&gt;</comment>
                            <comment id="12471987" author="myrna" created="Sat, 10 Feb 2007 14:49:38 +0000"  >&lt;p&gt;I looked at the code again, and I believe this is really ok. So, I updated the BatchUpdateTest.java &amp;amp; committed with revision 505700. See: &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=505700&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=505700&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12350769" name="DERBY-2112_20070209.diff" size="1555" author="myrna" created="Fri, 9 Feb 2007 15:10:00 +0000"/>
                            <attachment id="12345598" name="Derby2112ReproNPE.java" size="2210" author="kristwaa" created="Fri, 24 Nov 2006 09:21:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 24 Nov 2006 09:21:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22892</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy13ef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40201</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>