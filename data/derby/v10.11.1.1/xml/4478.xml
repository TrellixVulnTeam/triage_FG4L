<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:48:56 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4478/DERBY-4478.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4478] Use AtomicLong for XactFactory.tranId</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4478</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Dyre Tjeldvoll posted some results on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3092&quot; title=&quot;Use java.util.concurrent in TransactionTable to improve scalability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3092&quot;&gt;&lt;del&gt;DERBY-3092&lt;/del&gt;&lt;/a&gt; that indicated that some types of load might cause contention on XactFactory.tranId (a shared long), and suggested that it was replaced with a java.util.concurrent.atomic.AtomicLong on the platforms that support java.util.concurrent.*.&lt;/p&gt;

&lt;p&gt;I&apos;m splitting this issue out from &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3092&quot; title=&quot;Use java.util.concurrent in TransactionTable to improve scalability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3092&quot;&gt;&lt;del&gt;DERBY-3092&lt;/del&gt;&lt;/a&gt; so that the two possible improvements reported there can be addressed independently.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12443394">DERBY-4478</key>
            <summary>Use AtomicLong for XactFactory.tranId</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Dec 2009 14:48:54 +0000</created>
                <updated>Wed, 3 Sep 2014 09:31:33 +0100</updated>
                            <resolved>Mon, 15 Jul 2013 10:55:01 +0100</resolved>
                                    <version>10.6.1.0</version>
                                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13706842" author="knutanders" created="Fri, 12 Jul 2013 11:42:53 +0100"  >&lt;p&gt;Now that Java 6 is the minimum level and AtomicLong is available on all supported platforms, I think we should just do this.&lt;/p&gt;

&lt;p&gt;The attached patch d4478-1a.diff makes the suggested change.&lt;/p&gt;

&lt;p&gt;I repeated the scalability experiment from &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3092&quot; title=&quot;Use java.util.concurrent in TransactionTable to improve scalability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3092&quot;&gt;&lt;del&gt;DERBY-3092&lt;/del&gt;&lt;/a&gt;. The result was the same as back then: this change on its own didn&apos;t seem to affect scalability one way or another.&lt;/p&gt;

&lt;p&gt;Still, I think an AtomicLong is the right abstraction for this use, and it makes the code slightly simpler, so I think it&apos;s an improvement nevertheless.&lt;/p&gt;

&lt;p&gt;All the regression tests ran cleanly with the patch.&lt;/p&gt;</comment>
                            <comment id="13707008" author="mikem" created="Fri, 12 Jul 2013 16:22:09 +0100"  >&lt;p&gt;I reviewed this change and it looks ok to me.  I was particularly looking to make sure the change is backward compatible&lt;br/&gt;
in the soft upgrade case, but that does not seem to be an issue as we are only changing a private in memory variable. &lt;br/&gt;
The object that is persisted to disk, the &quot;xid&quot;, is set with a  real long so we are not changing the disk representation and&lt;br/&gt;
those that need to go back to a previous derby release and a lower level jvm should be ok.&lt;/p&gt;

&lt;p&gt;For those looking to use Atomic elsewhere should look closely at the javadoc, they are not 1-1 replacements for associated&lt;br/&gt;
base types, ie like long.  For instance:&lt;br/&gt;
&quot;Atomic classes are not general purpose replacements for java.lang.Integer and related classes. They do not define methods such as hashCode and compareTo. (Because atomic variables are expected to be mutated, they are poor choices for hash table keys.) Additionally, classes are provided only for those types that are commonly useful in intended applications. &quot;&lt;/p&gt;</comment>
                            <comment id="13708351" author="jira-bot" created="Mon, 15 Jul 2013 10:54:18 +0100"  >&lt;p&gt;Commit 1503157 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=knutanders&quot; class=&quot;user-hover&quot; rel=&quot;knutanders&quot;&gt;Knut Anders Hatlen&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1503157&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1503157&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4478&quot; title=&quot;Use AtomicLong for XactFactory.tranId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4478&quot;&gt;&lt;del&gt;DERBY-4478&lt;/del&gt;&lt;/a&gt;: Use AtomicLong for XactFactory.tranId&lt;/p&gt;</comment>
                            <comment id="13708352" author="knutanders" created="Mon, 15 Jul 2013 10:55:01 +0100"  >&lt;p&gt;Thanks for looking at the patch, Mike.&lt;/p&gt;</comment>
                            <comment id="14119592" author="knutanders" created="Wed, 3 Sep 2014 09:31:33 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12379282">DERBY-3092</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12591985" name="d4478-1a.diff" size="2108" author="knutanders" created="Fri, 12 Jul 2013 11:42:53 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10362"><![CDATA[Performance]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Jul 2013 15:22:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31247</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0rev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38259</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>