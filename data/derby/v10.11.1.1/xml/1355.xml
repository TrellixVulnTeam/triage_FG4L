<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1355/DERBY-1355.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1355] ClientDriver ResultSetMetaData.isAutoIncrement(column) always returns false</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1355</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;With ClientDriver, resultSet.getMetaData().isAutoIncrement(column) always returns false. &lt;/p&gt;

&lt;p&gt;EmbeddedDriver correctly returns the true value (true or false)&lt;/p&gt;

&lt;p&gt;The following code demonstrates the problem:&lt;br/&gt;
===================================================================================&lt;br/&gt;
import java.sql.Connection;&lt;br/&gt;
import java.sql.DriverManager;&lt;br/&gt;
import java.sql.ResultSet;&lt;br/&gt;
import java.sql.ResultSetMetaData;&lt;br/&gt;
import java.sql.SQLException;&lt;br/&gt;
import java.sql.Statement;&lt;/p&gt;

&lt;p&gt;import org.apache.derby.jdbc.ClientDriver;&lt;br/&gt;
import org.apache.derby.jdbc.EmbeddedDriver;&lt;/p&gt;

&lt;p&gt;public class TestAutoIncrement {&lt;br/&gt;
    private static final String URL_EMBEDDED = &quot;jdbc:derby:EmbeddedTestBase;&quot;;&lt;/p&gt;

&lt;p&gt;    private static final String URL_CLIENT = &quot;jdbc:derby://localhost:1527/ClientTestBase;&quot;;&lt;/p&gt;

&lt;p&gt;    public TestAutoIncrement() &lt;/p&gt;
{
        super();
    }

&lt;p&gt;    public static void main(String[] args) throws SQLException &lt;/p&gt;
{
        System.out.println(new ClientDriver().getClass().getName()
                + &quot; registered&quot;);
        System.out.println(new EmbeddedDriver().getClass().getName()
                + &quot; registered&quot;);
        new TestAutoIncrement().test();
    }

&lt;p&gt;    private void test() throws SQLException {&lt;br/&gt;
        if (test(URL_EMBEDDED) != test(URL_CLIENT)) &lt;/p&gt;
{
            System.out.println(&quot;Embedded and client driver behave differently for isAutoIncrement().&quot;);
        }
&lt;p&gt; else &lt;/p&gt;
{
            System.out.println(&quot;Embedded and client driver behave the same for isAutoIncrement().&quot;);
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;    private boolean test(String url) throws SQLException {&lt;br/&gt;
        boolean ai = false;&lt;br/&gt;
        Connection connection = DriverManager.getConnection(url&lt;br/&gt;
                + &quot;create=true;&quot;);&lt;br/&gt;
        Statement statement = connection.createStatement();&lt;br/&gt;
        statement&lt;br/&gt;
                .execute(&quot;CREATE TABLE TEST_TABEL (&quot;&lt;br/&gt;
                        + &quot;ID INTEGER NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),&quot;&lt;br/&gt;
                        + &quot;VALUE INTEGER NOT NULL, PRIMARY KEY (ID))&quot;);&lt;br/&gt;
        statement.execute(&quot;INSERT INTO TEST_TABEL (VALUE) VALUES(1)&quot;);&lt;br/&gt;
        ResultSet resultSet = statement&lt;br/&gt;
                .executeQuery(&quot;SELECT * FROM TEST_TABEL&quot;);&lt;br/&gt;
        ResultSetMetaData meta = resultSet.getMetaData();&lt;br/&gt;
        ai = meta.isAutoIncrement(1);&lt;br/&gt;
        System.out.println(&quot;For &quot; + url + &quot; &quot; + meta.getColumnName(1)&lt;br/&gt;
                + &quot; isAutoIncrement: &quot; + ai);&lt;br/&gt;
        connection.close();&lt;br/&gt;
        try &lt;/p&gt;
{
            DriverManager.getConnection(url + &quot;shutdown=true;&quot;);
        }
&lt;p&gt; catch (SQLException e) &lt;/p&gt;
{
            System.out.println(e.getMessage());
        }
&lt;p&gt;        return ai;&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;}&lt;br/&gt;
===================================================================================&lt;br/&gt;
The output I receive from the above program is:&lt;/p&gt;

&lt;p&gt;org.apache.derby.jdbc.ClientDriver registered&lt;br/&gt;
org.apache.derby.jdbc.EmbeddedDriver registered&lt;br/&gt;
For jdbc:derby:EmbeddedTestBase; ID isAutoIncrement: true&lt;br/&gt;
Database &apos;EmbeddedTestBase&apos; shutdown.&lt;br/&gt;
For jdbc:derby://localhost:1527/ClientTestBase; ID isAutoIncrement: false&lt;br/&gt;
DERBY SQL error: SQLCODE: -1, SQLSTATE: 08006, SQLERRMC: Database &lt;br/&gt;
&apos;ClientTestBase&apos; shutdown.&lt;br/&gt;
Embedded and client driver behave differently for isAutoIncrement().&lt;br/&gt;
===================================================================================&lt;br/&gt;
Ouput from sysinfo:&lt;/p&gt;

&lt;p&gt;------------------ Java Information ------------------&lt;br/&gt;
Java Version:    1.5.0_06&lt;br/&gt;
Java Vendor:     Sun Microsystems Inc.&lt;br/&gt;
Java home:       C:\Program Files\Java\jre1.5.0_06&lt;br/&gt;
Java classpath: &lt;br/&gt;
.;C:\PROGRA~1\JMF21~1.1E\lib\sound.jar;C:\PROGRA~1\JMF21~1.1E\lib\jmf.jar;C:\PROGRA~1\JMF21~1.1E\lib;C:\WINDOWS\java\classes;C:\WorkSpace\PB &lt;br/&gt;
3.0\bin;C:\WorkSpace\Filipe\bin;C:\Documents and Settings\Piet\My &lt;br/&gt;
Documents\Resources\Jars\ImgrRdr130.jar;C:\Documents and Settings\Piet\My &lt;br/&gt;
Documents\Resources\Jars\lucene-1.4.1.jar;C:\Documents and Settings\Piet\My &lt;br/&gt;
Documents\Resources\Jars\Multivalent20040415.jar;C:\Workspace\Stick\bin;&lt;br/&gt;
OS name:         Windows XP&lt;br/&gt;
OS architecture: x86&lt;br/&gt;
OS version:      5.1&lt;br/&gt;
Java user name:  Piet&lt;br/&gt;
Java user home:  C:\Documents and Settings\Piet&lt;br/&gt;
Java user dir:   C:\StickFolder&lt;br/&gt;
java.specification.name: Java Platform API Specification&lt;br/&gt;
java.specification.version: 1.5&lt;br/&gt;
--------- Derby Information --------&lt;br/&gt;
JRE - JDBC: J2SE 5.0 - JDBC 3.0&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;/org/apache/derby/info/DBMS.properties&amp;#93;&lt;/span&gt; 10.1.2.1 - (330608)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;/org/apache/derby/info/tools.properties&amp;#93;&lt;/span&gt; 10.1.2.1 - (330608)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;/org/apache/derby/info/net.properties&amp;#93;&lt;/span&gt; 10.1.2.1 - (330608)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;/org/apache/derby/info/dnc.properties&amp;#93;&lt;/span&gt; 10.1.2.1 - (330608)&lt;br/&gt;
------------------------------------------------------&lt;br/&gt;
----------------- Locale Information -----------------&lt;br/&gt;
Current Locale :  [Nederlands/Nederland &lt;span class=&quot;error&quot;&gt;&amp;#91;nl_NL&amp;#93;&lt;/span&gt;]&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;de_DE&amp;#93;&lt;/span&gt;&lt;br/&gt;
  version: 10.1.2.1 - (330608)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;es&amp;#93;&lt;/span&gt;&lt;br/&gt;
  version: 10.1.2.1 - (330608)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;fr&amp;#93;&lt;/span&gt;&lt;br/&gt;
  version: 10.1.2.1 - (330608)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;it&amp;#93;&lt;/span&gt;&lt;br/&gt;
  version: 10.1.2.1 - (330608)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;ja_JP&amp;#93;&lt;/span&gt;&lt;br/&gt;
  version: 10.1.2.1 - (330608)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;ko_KR&amp;#93;&lt;/span&gt;&lt;br/&gt;
  version: 10.1.2.1 - (330608)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;pt_BR&amp;#93;&lt;/span&gt;&lt;br/&gt;
  version: 10.1.2.1 - (330608)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;zh_CN&amp;#93;&lt;/span&gt;&lt;br/&gt;
  version: 10.1.2.1 - (330608)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;zh_TW&amp;#93;&lt;/span&gt;&lt;br/&gt;
  version: 10.1.2.1 - (330608)&lt;br/&gt;
------------------------------------------------------&lt;/p&gt;</description>
                <environment>Windows XP</environment>
        <key id="12343597">DERBY-1355</key>
            <summary>ClientDriver ResultSetMetaData.isAutoIncrement(column) always returns false</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mayureshnirhali">Mayuresh Nirhali</assignee>
                                    <reporter username="pietblok">Piet Blok</reporter>
                        <labels>
                    </labels>
                <created>Sat, 27 May 2006 20:06:14 +0100</created>
                <updated>Fri, 21 Jan 2011 17:48:38 +0000</updated>
                            <resolved>Sat, 9 Jun 2007 03:07:56 +0100</resolved>
                                    <version>10.1.2.1</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Network Client</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12496802" author="mayureshnirhali" created="Fri, 18 May 2007 08:34:29 +0100"  >&lt;p&gt;I have created a quick patch for this.&lt;/p&gt;

&lt;p&gt;It is evident from DRDA spec that, sqlxGenerated can tell if &apos;generated&apos; attribute of a particular column is true. If the column is auto generated then sqlxgenerated will be 2. The same check can be used to validate AutoIncrement attribute in isAutoIncrement. I would like to know from the NetworkClient experts if this is the right fix.&lt;/p&gt;

&lt;p&gt;I have started the testruns and will also look into if there is an existing test which needs modification, else I will add a new case.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="12498206" author="mayureshnirhali" created="Wed, 23 May 2007 12:44:22 +0100"  >&lt;p&gt;derbyall and Suites.All ran fine.&lt;/p&gt;

&lt;p&gt;I will now look into adding a new testcase in client testsuite.&lt;/p&gt;</comment>
                            <comment id="12498579" author="mayureshnirhali" created="Thu, 24 May 2007 11:54:11 +0100"  >&lt;p&gt;Created another patch for the test changes.&lt;/p&gt;

&lt;p&gt;Updated LangHarnessJavaTest to run AIjdbc test in client-server mode as well. The AIjdbc test reprodices the issue when run in clientserver mode.&lt;/p&gt;

&lt;p&gt;The patches are ready for review.&lt;/p&gt;</comment>
                            <comment id="12502985" author="myrna" created="Sat, 9 Jun 2007 03:07:56 +0100"  >&lt;p&gt;I applied test and client patches...&lt;br/&gt;
I ran the AIjdbc test (with embedded &amp;amp; client), with and without the Client change, and test shows the problem before the fix, and does not show the problem after the fix. Ran lang._Suite for good measure.&lt;/p&gt;

&lt;p&gt;In addition, I corrected text to be printed out in case of a failure in one of the&lt;br/&gt;
 test cases in test AIjdbc.java.&lt;/p&gt;

&lt;p&gt;committed fix and test change with revision 545681.&lt;/p&gt;

&lt;p&gt;Removed 10.2.3.0 fixin value, because I do not intend to backport this to 10.2, although backporting at least the client change is probably no big effort for someone if it&apos;s needed. &lt;/p&gt;

&lt;p&gt;Thx for the patches Mayuresh!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12358083" name="derby1355_testv1.diff" size="1444" author="mayureshnirhali" created="Thu, 24 May 2007 11:54:11 +0100"/>
                            <attachment id="12357607" name="derby1355_v1.diff" size="580" author="mayureshnirhali" created="Fri, 18 May 2007 08:34:29 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 18 May 2007 07:34:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0n5z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37571</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>