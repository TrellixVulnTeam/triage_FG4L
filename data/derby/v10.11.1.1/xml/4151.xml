<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:38 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4151/DERBY-4151.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4151] java.net.ConnectException in J2EEDataSourceTest (with network server) on IBM iseries</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4151</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;12 of the fixtures of the J2EEDataSource test fail on iseries, with failures like this:&lt;/p&gt;

&lt;p&gt;23) testConnectionErrorEvent(org.apache.derbyTesting.functionTests.tests.jdbcapi.J2EEDataSourceTest)java.sql.SQLException: Error starting network  server&lt;br/&gt;
	at java.lang.Throwable.&amp;lt;init&amp;gt;(Throwable.java:196)&lt;br/&gt;
	at java.lang.Exception.&amp;lt;init&amp;gt;(Exception.java:41)&lt;br/&gt;
	at java.sql.SQLException.&amp;lt;init&amp;gt;(SQLException.java:80)&lt;br/&gt;
	at org.apache.derbyTesting.junit.TestConfiguration.startNetworkServer(TestConfiguration.java:1455)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.J2EEDataSourceTest.testConnectionErrorEvent(J2EEDataSourceTest.java:615)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:84)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
Caused by: java.lang.reflect.InvocationTargetException&lt;br/&gt;
	at java.lang.Exception.&amp;lt;init&amp;gt;(Exception.java:77)&lt;br/&gt;
	at java.lang.reflect.InvocationTargetException.&amp;lt;init&amp;gt;(InvocationTargetException.java:54)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.NetworkServerControlWrapper.invoke(NetworkServerControlWrapper.java:94)&lt;br/&gt;
	at org.apache.derbyTesting.junit.NetworkServerControlWrapper.ping(NetworkServerControlWrapper.java:106)&lt;br/&gt;
	at org.apache.derbyTesting.junit.TestConfiguration.startNetworkServer(TestConfiguration.java:1439)&lt;br/&gt;
	... 38 more&lt;br/&gt;
Caused by: java.lang.Exception: DRDA_NoIO.S:Could not connect to Derby Network Server on host 127.0.0.1, port 1527: A remote host refused an attempted connect operation.&lt;br/&gt;
	at java.lang.Throwable.&amp;lt;init&amp;gt;(Throwable.java:196)&lt;br/&gt;
	at java.lang.Exception.&amp;lt;init&amp;gt;(Exception.java:41)&lt;br/&gt;
	at org.apache.derby.impl.drda.NetworkServerControlImpl.consolePropertyMessageWork(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.drda.NetworkServerControlImpl.consolePropertyMessage(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.drda.NetworkServerControlImpl.setUpSocket(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.drda.NetworkServerControlImpl.ping(Unknown Source)&lt;br/&gt;
	at org.apache.derby.drda.NetworkServerControl.ping(Unknown Source)&lt;br/&gt;
	... 44 more&lt;/p&gt;

&lt;p&gt;My classpath (in case it matters) contains:&lt;br/&gt;
derbytools.jar:derbyclient.jar:derbynet.jar:derbyrun.jar:derbyTesting.jar:junit.jar&lt;/p&gt;</description>
                <environment>IBM iseries, OS: AS/400; OS version: V5R4M0, jvm: IBM 1.5 (build 1.5.0_13-b05) , IBM 1.6 (1.6.0_b105)</environment>
        <key id="12422197">DERBY-4151</key>
            <summary>java.net.ConnectException in J2EEDataSourceTest (with network server) on IBM iseries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="myrna">Myrna van Lunteren</assignee>
                                    <reporter username="myrna">Myrna van Lunteren</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Apr 2009 06:48:27 +0100</created>
                <updated>Sun, 1 Nov 2009 19:25:40 +0000</updated>
                            <resolved>Sun, 1 Nov 2009 19:25:24 +0000</resolved>
                                                    <fixVersion>10.5.1.1</fixVersion>
                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12771471" author="myrna" created="Thu, 29 Oct 2009 16:46:30 +0000"  >&lt;p&gt;I&apos;m trying to figure out what&apos;s up with these failures. I&apos;m not done with my research, but thought I&apos;d document what I found so far:&lt;br/&gt;
The problem occurs with both ibm1.5 and ibm1.6 jvms. &lt;br/&gt;
With 10.4. there were no such troubles - but with all 10.5 versions (and recent builds of trunk) there are.&lt;br/&gt;
It&apos;s only the network server runs of the fixtures. &lt;br/&gt;
I ran with 10.4.2.0 jars and a recent derbyTesting.jar and got failures; hence, it seems something in the test changed that made these failures appear.&lt;br/&gt;
I looked at the test&apos;s changes, and did some further experiments with a recent 10.6 alpha build (830420) and derbyTesting.jar files from older builds close from around the time of the changes to the test, and found that after revision 675870 for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3319&quot; title=&quot;Logical connections do not check if a transaction is active on close&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3319&quot;&gt;&lt;del&gt;DERBY-3319&lt;/del&gt;&lt;/a&gt; 11 tests fail.&lt;br/&gt;
Revision 654870 added the following fixtures:&lt;br/&gt;
  testCloseActiveConnection_DS&lt;br/&gt;
  testCloseActiveConnection_CP&lt;br/&gt;
  testCloseActiveConnection_XA_local&lt;br/&gt;
  testCloseActiveConnection_XA_global&lt;br/&gt;
It&apos;s interesting to note that the first test failure is the second test run after these &quot;new&quot; additions:&lt;br/&gt;
---------------------------------------------&lt;br/&gt;
...(fixtures pass until here...)&lt;br/&gt;
testBadConnectionAttributeSyntax used 26 ms .&lt;br/&gt;
testCloseActiveConnection_DS used 220 ms .&lt;br/&gt;
testCloseActiveConnection_CP used 124 ms .&lt;br/&gt;
testCloseActiveConnection_XA_local used 142 ms .&lt;br/&gt;
testCloseActiveConnection_XA_global used 111 ms .&lt;br/&gt;
testDescriptionProperty used 43 ms .&lt;br/&gt;
testConnectionErrorEvent used 10698 ms E.&lt;br/&gt;
testConnectionEventListenerIsNull used 15 ms E.&lt;br/&gt;
testReadOnlyToWritableTran used 14 ms E.&lt;br/&gt;
testAutoCommitOnXAResourceStart used 13 ms E.&lt;br/&gt;
testAllDataSources used 13 ms E.&lt;br/&gt;
testClosedCPDSConnection used 14 ms E.&lt;br/&gt;
testClosedXADSConnection used 16 ms E.&lt;br/&gt;
testSetSchemaInXAConnection used 13 ms E.&lt;br/&gt;
testPooledReuseOnClose used 15 ms E.&lt;br/&gt;
testSchemaIsReset used 13 ms E.&lt;br/&gt;
testSchemaIsResetWhenDeleted used 12 ms E.&lt;br/&gt;
testClientDSConnectionAttributes used 254 ms .&lt;br/&gt;
...(remaining fixtures pass)...&lt;br/&gt;
---------------------------------------------&lt;/p&gt;</comment>
                            <comment id="12771640" author="myrna" created="Thu, 29 Oct 2009 21:46:30 +0000"  >&lt;p&gt;I find that a suite of the following fixtures (in this sequence) will cause the failure in the testConnectionErrorEvent fixture:&lt;br/&gt;
  testGlobalLocalInterleaf&lt;br/&gt;
  testCloseActiveConnection_CP&lt;br/&gt;
  testCloseActiveConnection_XA_local&lt;br/&gt;
  testDescriptionProperty&lt;br/&gt;
  testConnectionErrorEvent&lt;br/&gt;
Leaving any of these fixtures out will make the test pass.&lt;/p&gt;</comment>
                            <comment id="12771997" author="myrna" created="Fri, 30 Oct 2009 17:24:55 +0000"  >&lt;p&gt;attaching files from the testfailure.&lt;/p&gt;</comment>
                            <comment id="12772261" author="myrna" created="Sat, 31 Oct 2009 17:20:38 +0000"  >&lt;p&gt;I got one pass with only 4 tests, then the same set failed, which caused me to believe it was a matter of cleaning up.&lt;br/&gt;
Adding some close() calls to 3 of the fixtures that were affected and the problem goes away.&lt;br/&gt;
I&apos;ll commit later.&lt;/p&gt;</comment>
                            <comment id="12772278" author="myrna" created="Sat, 31 Oct 2009 19:28:33 +0000"  >&lt;p&gt;committed with revision 831584. &lt;br/&gt;
I plan to backport this to 10.5 later.&lt;/p&gt;</comment>
                            <comment id="12772357" author="myrna" created="Sun, 1 Nov 2009 19:24:51 +0000"  >&lt;p&gt;backported to 10.5 with revision 831738.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12423764" name="DERBY-4151.diff" size="957" author="myrna" created="Sat, 31 Oct 2009 17:20:38 +0000"/>
                            <attachment id="12423695" name="derby.log" size="6612" author="myrna" created="Fri, 30 Oct 2009 17:24:55 +0000"/>
                            <attachment id="12423696" name="error-stacktrace.out" size="3967" author="myrna" created="Fri, 30 Oct 2009 17:24:55 +0000"/>
                            <attachment id="12423697" name="serverConsoleOutput.log" size="2078" author="myrna" created="Fri, 30 Oct 2009 17:24:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10420"><![CDATA[Regression]]></customfieldvalue>
    <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24064</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0rnb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38297</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>