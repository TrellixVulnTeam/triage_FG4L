<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:37:43 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4059/DERBY-4059.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4059] If space reclamation cannot obtain container lock it will not retry getting the lock</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4059</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;As noted in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4054&quot; title=&quot;Multithreaded clob update with exclusive table locking causes table growth that is not reclaimed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4054&quot;&gt;DERBY-4054&lt;/a&gt; openContainerNW throws an exception if it canno get the container lock and bypasses the retry logic.  See:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4054?focusedCommentId=12673376#action_12673376&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/DERBY-4054?focusedCommentId=12673376#action_12673376&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We should catch the exception and retry if we can&apos;t get the container lock. This probably won&apos;t fix the repro for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4054&quot; title=&quot;Multithreaded clob update with exclusive table locking causes table growth that is not reclaimed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4054&quot;&gt;DERBY-4054&lt;/a&gt;, but should be helpful in some user scenarios.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12414884">DERBY-4059</key>
            <summary>If space reclamation cannot obtain container lock it will not retry getting the lock</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12414680">DERBY-4054</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Feb 2009 17:15:54 +0000</created>
                <updated>Mon, 4 May 2009 19:22:11 +0100</updated>
                            <resolved>Thu, 19 Feb 2009 20:09:55 +0000</resolved>
                                    <version>10.1.3.1</version>
                    <version>10.2.2.0</version>
                    <version>10.3.3.0</version>
                    <version>10.4.2.0</version>
                    <version>10.5.1.1</version>
                                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12674081" author="kmarsden" created="Tue, 17 Feb 2009 00:55:16 +0000"  >&lt;p&gt;I am trying to write a test where having the post commit retries will actually help, but am having trouble making a case.  Even if I change ClobReclamationTest.xtestMultiThreadedUpdateTableLocking() to have each of the two threads  update just two rows, it seems to give up after three retries.  Is there any wait between retries of post commit actions or does it just loop through its todo list and retry when it is finished with its current queue?&lt;/p&gt;</comment>
                            <comment id="12674318" author="kmarsden" created="Tue, 17 Feb 2009 19:22:36 +0000"  >&lt;p&gt;Attached is a patch for the code change so that we will retry if we can&apos;t get a container lock.  I cannot however come up with a test case where it seems to make any difference.  As I commented earlier, the retry seems to be too quick. I manually verified that we do retry and give up by setting derby.debug.true=DaemonTrace  and looking at the derby.log.&lt;/p&gt;

&lt;p&gt;I&apos;d like to come up with a test case though where the retry helps before I check in.&lt;/p&gt;</comment>
                            <comment id="12675066" author="kmarsden" created="Thu, 19 Feb 2009 18:10:25 +0000"  >&lt;p&gt;After observing the behavior with the patch and chatting with Mike, I have come to the conclusion that the three retries is just really not sufficient.  We will need to something else with the retries, either have some short wait instead of no wait when trying to get locks, up the retries or do something more elaborate like Mike suggested in this comment &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4055?focusedCommentId=12673436#action_12673436&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/DERBY-4055?focusedCommentId=12673436#action_12673436&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think I will go ahead and check in this fix as is as it does enable retries when getting the container lock, even though those retries aren&apos;t very useful.  It should make the code more consistent for whatever solution we settle on to fix this long term.  I will add a comment to the code that three retries is likely not enough.&lt;/p&gt;



</comment>
                    </comments>
                    <attachments>
                            <attachment id="12400349" name="derby-4059_code_change_diff.txt" size="1639" author="kmarsden" created="Tue, 17 Feb 2009 19:22:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31115</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Issue &amp; fix info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10102"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0xvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39307</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>