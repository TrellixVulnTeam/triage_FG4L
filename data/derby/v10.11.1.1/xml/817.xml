<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:18:02 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-817/DERBY-817.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-817] Improvements to Network Client driver - analyze/improve use of java collection classes in the code</title>
                <link>https://issues.apache.org/jira/browse/DERBY-817</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When working on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-210&quot; title=&quot;Network Server will leak prepared statements if not explicitly closed by the user until the connection is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-210&quot;&gt;DERBY-210&lt;/a&gt;, following came up as cases for possible improvements/optimizations:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Bryan pointed out that synchronization is missing when accessing openStatements_ and CommitAndRollbackListeners_ , which are members of org.apache.derby.client.am.Connection class.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Bryan suggested adding convenience methods to access these lists.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Do we need to add Lobs to CommitAndRollbackListeners_? In case of Lobs, I cannot see anything else being done with it other than adding and removing from this list. Is there any other purpose for adding Lobs to this list?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Do we need to add PreparedStatements to CommitAndRollbackListeners_? A comment in the code mentions they are added to the list because prepared statements need to be re-prepared after commit/rollback. As I understand, this is not required. Also, in the code, only internal statements like statements used for auto-generated keys etc are being re-prepared. Maybe, this can be avoided.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Do we need to add all result sets to the HashTable &apos;positionedUpdateCursorNameToResultSet_&apos; in SectionManager? All ResultSets get added to this Hashtable though only ResultSets from positioned update statements are retrieved and used from this table. There seems to be some extra work going on in client driver in just adding and removing &quot;all&quot; result sets to this hashtable. I think this can be avoided. Can we avoid adding result sets from positioned update statements to this hashtable? Some analysis can be done to see if this hashtable itself can be removed.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The items listed above are independent and sub-tasks may be opened to work on them individually. Some of them are questions and depending on findings, they may not need further work. &lt;/p&gt;

&lt;p&gt;These issues were discussed in the following threads:&lt;br/&gt;
&lt;a href=&quot;http://www.nabble.com/-jira-Updated%3A-%28DERBY-210%29-Network-Server-will-leak-prepared-statements-if-not-explicitly-closed-by-the-user-until-the-connection-is-closed-t914229.html#a2371474&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/-jira-Updated%3A-%28DERBY-210%29-Network-Server-will-leak-prepared-statements-if-not-explicitly-closed-by-the-user-until-the-connection-is-closed-t914229.html#a2371474&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://www.nabble.com/-jira-Commented%3A-%28DERBY-210%29-Network-Server-will-leak-prepared-statements-if-not-explicitly-closed-by-the-user-until-the-connection-is-closed-t915113.html#a2373800&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/-jira-Commented%3A-%28DERBY-210%29-Network-Server-will-leak-prepared-statements-if-not-explicitly-closed-by-the-user-until-the-connection-is-closed-t915113.html#a2373800&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12327686">DERBY-817</key>
            <summary>Improvements to Network Client driver - analyze/improve use of java collection classes in the code</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="deepa">Deepa Remesh</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jan 2006 06:23:24 +0000</created>
                <updated>Tue, 17 Jan 2006 09:24:17 +0000</updated>
                                            <version>10.1.1.0</version>
                    <version>10.1.2.1</version>
                    <version>10.2.1.6</version>
                                                    <component>Network Client</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12362901" author="kmarsden" created="Tue, 17 Jan 2006 09:24:17 +0000"  >&lt;p&gt;One additional thing that I noticed in reviewing the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-210&quot; title=&quot;Network Server will leak prepared statements if not explicitly closed by the user until the connection is closed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-210&quot;&gt;DERBY-210&lt;/a&gt; was that Connection.java had this comment &lt;br/&gt;
which to the best of my knowledge is not true on either count and should be considered in evaluating the role of &lt;br/&gt;
 CommitAndRollbackListeners_ in the client.&lt;/p&gt;

&lt;p&gt;// Some statuses of DERBY objects may be invalid on server after both &lt;br/&gt;
    // commit and rollback. For example,&lt;br/&gt;
    // (1) prepared statements need to be re-prepared&lt;br/&gt;
    //     after both commit and rollback&lt;br/&gt;
    // (2) result set will be unpositioned on server after both commit and rollback.&lt;br/&gt;
    // If they depend on both commit and rollback, they need to get on CommitAndRollbackListeners_.&lt;/p&gt;

</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 17 Jan 2006 09:24:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29718</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy17dz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40847</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>