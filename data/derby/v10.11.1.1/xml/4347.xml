<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:22:35 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4347/DERBY-4347.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4347] Provide a property to increase network server start  timeout  for JUnit tests</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4347</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt; Sometimes when running JUnit tests with jvm options that are known to slow things down significantly network server start timeouts can occur e.g.&lt;br/&gt;
SecureServerTest( Opened = false, Authenticated= false, CustomDerbyProperties= null, WildCardHost= null )junit.framework.AssertionFailedError: Timed out waiting for network server to start:Spawned SpawnedNetworkServer exitCode=143&lt;br/&gt;
		 at org.apache.derbyTesting.junit.NetworkServerTestSetup.setUp(NetworkServerTestSetup.java:203)&lt;br/&gt;
		 at junit.extensions.TestSetup$1.protect(TestSetup.java:18)&lt;br/&gt;
		 at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
		 at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
		 at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
		 at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
		 at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
		 at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
		 at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
		 at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;br/&gt;
		 at junit.extensions.TestDecorator.basicRun(TestDecorator.java:22)&lt;br/&gt;
		 at junit.extensions.TestSetup$1.protect(TestSetup.java:19)&lt;br/&gt;
		 at junit.extensions.TestSetup.run(TestSetup.java:23)&lt;/p&gt;


&lt;p&gt;The current wait time is 40 seconds and is set in org.apache.derbyTesting.junit.NetworkServerTestSetup&lt;/p&gt;

&lt;p&gt;/** Setting maximum wait time to 40 seconds.   On some platforms&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;it may take this long to start the server.  Increasing the wait&lt;/li&gt;
	&lt;li&gt;time should not adversely affect those&lt;/li&gt;
	&lt;li&gt;systems with fast port turnaround as the actual code loops for&lt;/li&gt;
	&lt;li&gt;SLEEP_TIME intervals, so should never see WAIT_TIME.&lt;br/&gt;
     */&lt;br/&gt;
    private static final long WAIT_TIME = 40000;&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;It would be nice to have system property (maybe derby.tests.networkServerStartTimeout=&amp;lt;ms&amp;gt;)  to allow this to be configurable in environments where we expect the start to take longer.&lt;/p&gt;

&lt;p&gt;I am not sure if there are other timeouts in the tests for replication etc or if they all use this same setting.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12432792">DERBY-4347</key>
            <summary>Provide a property to increase network server start  timeout  for JUnit tests</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="myrna">Myrna van Lunteren</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Aug 2009 16:46:34 +0100</created>
                <updated>Fri, 23 Jan 2015 00:31:36 +0000</updated>
                            <resolved>Tue, 15 Sep 2009 00:12:36 +0100</resolved>
                                    <version>10.5.3.0</version>
                    <version>10.6.1.0</version>
                                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12744386" author="knutanders" created="Tue, 18 Aug 2009 07:38:12 +0100"  >&lt;p&gt;We could also just increase the default wait time. It shouldn&apos;t have any negative effects except that it takes longer for the test to fail if the server doesn&apos;t start, but that&apos;s hardly worth optimizing for.&lt;/p&gt;

&lt;p&gt;Minor nit: If we add the system property, I think it would be better to specify the number of seconds to wait instead of milliseconds, as I don&apos;t see the need for ms resolution. It would also be more in line with the other (non-testing) timeout properties like derby.locks.*timeout.&lt;/p&gt;</comment>
                            <comment id="12748577" author="myrna" created="Thu, 27 Aug 2009 22:20:18 +0100"  >&lt;p&gt;Although I&apos;m wary of adding configurable properties (because the old test harness had many, most of them badly documented and/or not working properly) this one has long been on my wish list. &lt;br/&gt;
For instance, when running platform tests, for which I only have slower machines available. Or, like Kathey says, for doing experiments with jvm settings.&lt;br/&gt;
You can make a specialized build with the slower setting, but it gets old, making the same change repeatedly.&lt;/p&gt;

&lt;p&gt;I don&apos;t think making that change permanently for these one-off situations is necessary.&lt;/p&gt;

&lt;p&gt;There are a few tests which expect the server to fail, and those would be sitting around even longer (although it&apos;s probably only 1 or 2 tests, so on a complete testrun it probably doesn&apos;t matter so much). Also, I&apos;d worry that we hide server startup performance creep if we&apos;d increase the default (although there&apos;s probably/hopefully a performance tests for that somewhere).&lt;/p&gt;

&lt;p&gt;I agree on Knut&apos;s point re the seconds vs. milliseconds.&lt;/p&gt;</comment>
                            <comment id="12749593" author="kmarsden" created="Mon, 31 Aug 2009 20:58:14 +0100"  >&lt;p&gt;I seem to recall concern that increasing the default wait time might mask actual network server start performance regressions.   Seconds instead of milliseconds sounds fine.&lt;/p&gt;
</comment>
                            <comment id="12751241" author="myrna" created="Fri, 4 Sep 2009 01:26:42 +0100"  >&lt;p&gt;Attaching a first attempt at implementing this.&lt;br/&gt;
I&apos;m running suites.All now. Would appreciate review.&lt;br/&gt;
This patch would enable one to overwrite the default wait time passing on the number of seconds using the property derby.tests.networkServerStartTimeout.&lt;/p&gt;</comment>
                            <comment id="12753259" author="myrna" created="Wed, 9 Sep 2009 22:00:09 +0100"  >&lt;p&gt;Forgot to report back - I got 1 &quot;new&quot; test failure on my machine (ignoring engine.ErrorStreamTest.testDefault which failed on windows although mamta checked in a fix yesterday, my build must be from before) when running suites.All (but not when running the test by itself);  &lt;br/&gt;
ttestSetPortPriority(org.apache.derbyTesting.functionTests.tests.derbynet.ServerPropertiesTest)junit.framework.AssertionFailedError: Can not ping server specified with -p&lt;br/&gt;
But I reverted my change, ran the suite again, and got the same error, so I don&apos;t think it&apos;s related.&lt;/p&gt;
</comment>
                            <comment id="12753273" author="kmarsden" created="Wed, 9 Sep 2009 22:29:33 +0100"  >&lt;p&gt;Hi Myrna,  I think it would be clearer for the test to throw an error if it cannot parse the timeout rather than just print a message. Sometimes with automated test runs the output is not immediately apparent as we found with the encryption test that was printing for a while that it was not running but did not fail.&lt;/p&gt;</comment>
                            <comment id="12754365" author="myrna" created="Fri, 11 Sep 2009 22:42:36 +0100"  >&lt;p&gt;Attaching a new patch which attempts to address Kathey&apos;s comments.&lt;br/&gt;
The getWaitTime() method has been restructured a bit, and now will cause a failure when an invalid value is passed in for derby.tests.networkServerStartTimeout.&lt;/p&gt;

&lt;p&gt;There were no problems when I ran suites.All with this patch.  &lt;br/&gt;
If there are no comments, I&apos;ll likely commit this in the next few days.&lt;/p&gt;</comment>
                            <comment id="12755162" author="myrna" created="Mon, 14 Sep 2009 20:58:50 +0100"  >&lt;p&gt;I&apos;ve committed the v2 patch to trunk with revision 814815.&lt;br/&gt;
I&apos;ll work on backporting this to 10.5 and on updating appropriate areas in the wiki.&lt;/p&gt;</comment>
                            <comment id="12755238" author="myrna" created="Tue, 15 Sep 2009 00:12:36 +0100"  >&lt;p&gt;backported 814815 from trunk to 10.5 with revision 814906.&lt;br/&gt;
I also added a section to &lt;a href=&quot;http://wiki.apache.org/db-derby/DerbyJUnitTesting&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/db-derby/DerbyJUnitTesting&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12404146">DERBY-3873</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12418568" name="DERBY-4347.diff" size="2533" author="myrna" created="Fri, 4 Sep 2009 01:26:42 +0100"/>
                            <attachment id="12419344" name="DERBY-4347.diffv2" size="2599" author="myrna" created="Fri, 11 Sep 2009 22:42:36 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 18 Aug 2009 06:38:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31202</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0nxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37697</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>