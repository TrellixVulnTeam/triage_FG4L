<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:38:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2583/DERBY-2583.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2583] At code generation time, look at collation type to determine what kind of DVD should get generated for character types.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2583</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Currently, in Derby 10.2, we generate SQLChar/SQLVarchar/SQLLongvarchar/SQLClob for various SQL character types. All these DVDs have the default collation of UCS_BASIC. &lt;/p&gt;

&lt;p&gt;Starting 10.3, we should look at the collation type of the DTD before deciding what kind of DVD gets generated for SQL character types.  If the collation type of the character type is terriotry based collation, then we should generate CollatorSQLChar/CollatorSQLVarchar/CollatorSQLLongvarchar/CollatorSQLClob rather than SQLChar/SQLVarchar/SQLLongvarchar/SQLClob. The CollatorSQLxxx DVDs will have the territory based collator associated with them and hence the collation order of these DVDs will be different than the DVDs with default collation of UCS_BASIC. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12367893">DERBY-2583</key>
            <summary>At code generation time, look at collation type to determine what kind of DVD should get generated for character types.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mamtas">Mamta A. Satoor</assignee>
                                    <reporter username="mamtas">Mamta A. Satoor</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Apr 2007 07:48:09 +0100</created>
                <updated>Thu, 2 May 2013 03:29:08 +0100</updated>
                            <resolved>Wed, 16 May 2007 17:47:29 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12491172" author="mamtas" created="Tue, 24 Apr 2007 09:04:31 +0100"  >&lt;p&gt;Attaching patch, DERBY2583_generate_right_DVD_for_character_DTD_v1_diff.txt, which is not ready for commit yet because I am still running the tests but wanted to put it out for review. The files impacted in this patch are as follows&lt;br/&gt;
svn stat -q&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\CastNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\NotNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\NumericTypeCompiler.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\ResultColumn.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\UserDefinedTypeCompiler.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\SpecialFunctionNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\UserTypeConstantNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\JavaToSQLValueNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\UnaryComparisonOperatorNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\CLOBTypeCompiler.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\CurrentDatetimeOperatorNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\ConstantNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\BaseTypeCompiler.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\CurrentRowLocationNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\CoalesceFunctionNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\ExpressionClassBuilder.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\ConcatenationOperatorNode.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\CharTypeCompiler.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\sql\compile\ResultColumnList.java&lt;br/&gt;
M      java\engine\org\apache\derby\iapi\sql\compile\TypeCompiler.java&lt;/p&gt;

&lt;p&gt;The patch mainly addresses how code generation should account for collation type when generating DVDs for character types. In the past, there was one to one correspondance between a character DTD and the corresponding DVD that got generated for it. Starting Derby 10.3, a DTD associated with a character type can generate one of the 2 different kinds of DVDs and the DVD chosen will depend on the collation type of the DTD. Note that this applies only to character types. &lt;/p&gt;

&lt;p&gt;Character types that will have a collation of UCS_BASIC associated with them will continue to generate what was generated in Derby 10.2 ie SQLChar/SQLVarchar/SQLLongvarchar/SQLClob. But the character types that will have collation type of territory based associated with them will now generate CollatorSQLChar/CollatorSQLVarchar/CollatorSQLLongvarchar/CollatorSQLClob. This dependency of DVD type on collation type will be handled in classes ExpressionClassBuilder and in TypeCompiler implementations.&lt;/p&gt;

&lt;p&gt;CastNode, ConstantNode, NotNode, ResultColumn, SpecialFunctionNode, JavaToSQLValueNode, UnaryComparisonOperatorNode, UserTypeConstantNode,&lt;br/&gt;
CurrentDatetimeOperatorNode, CurrentRowLocationNode, CoalesceFunctionNode, ConcatenationOperatorNode, ResultColumnList : All of &lt;br/&gt;
these compile time classes require code generation of DVDs. These classes now need to pass the collation type of the DTD for which a DVD needs to be generated. This collation type will be used to generate code for correct DVD.&lt;/p&gt;

&lt;p&gt;The actual changes for generating the correct DVD went into CLOBTypeCompiler and CharTypeCompiler. These 2 classes will first generate a DVD for character types w/o taking the collation type into consideration. Then it will call a new method which is defined on the base class BaseTypeCompiler and that new method is called generateCollationSensitiveDataValue. This new method will check if the collation type is UCS_BASIC and if yes, then it will simply return because we have already generated code for DVD with collation type of UCS_BASIC. But if the collation type is territory based, then it will generate the additional&lt;br/&gt;
code of &lt;br/&gt;
DVDwithUCS_BASIC.getValue(DVF.getCharacterCollator(collationType));&lt;br/&gt;
This generated code will make sure that the DVD generated has territory based collator associated with it and the new DVD class will be of type CollatorSQLChar/CollatorSQLVarchar/CollatorSQLLongvarchar/CollatorSQLClob. In order to generate the additional code above, we need to have DVF on the stack. This pusing of DVF on stack will be done by the private method pushDataValueFactory defined on BaseTypeCompiler&lt;/p&gt;

&lt;p&gt;Once the tests finish successfully, I will commit this patch. But will appreciate anyone looking at this change and providing feedback.&lt;/p&gt;</comment>
                            <comment id="12491455" author="mamtas" created="Tue, 24 Apr 2007 22:07:47 +0100"  >&lt;p&gt;Just finished committing the patch DERBY2583_generate_right_DVD_for_character_DTD_v1_diff.txt with revision 532082.&lt;/p&gt;

&lt;p&gt;The derbyall suite ran fine. Junit tests are still running but so far no failure caused by the patch. &lt;/p&gt;</comment>
                            <comment id="12496347" author="mamtas" created="Wed, 16 May 2007 17:47:29 +0100"  >&lt;p&gt;The code generation is finished with revision 538325 that went in as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2335&quot; title=&quot;Compare character datatypes with different collation ordering.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2335&quot;&gt;&lt;del&gt;DERBY-2335&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12501463" author="mamtas" created="Tue, 5 Jun 2007 07:30:39 +0100"  >&lt;p&gt;Some changes for code generation also went in as revision 538325 and 541370&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12362830">DERBY-2336</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12356121" name="DERBY2583_generate_right_DVD_for_character_DTD_v1_diff.txt" size="25602" author="mamtas" created="Tue, 24 Apr 2007 09:04:31 +0100"/>
                            <attachment id="12356122" name="DERBY2583_generate_right_DVD_for_character_DTD_v1_stat.txt" size="1625" author="mamtas" created="Tue, 24 Apr 2007 09:04:31 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30531</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0t67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38544</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>