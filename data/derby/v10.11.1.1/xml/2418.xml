<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:24:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2418/DERBY-2418.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2418] TestProto.java used by testProtocol.java hardcodes port 1527</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2418</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;NetHarnessJavaTest reuses the old framework test &apos;testProtocol&apos; via&lt;br/&gt;
old framework adapter HarnessJavaTest.&lt;br/&gt;
testProtocol uses the class TestProto which hardcodes use of port 1527.&lt;br/&gt;
It would be nice to pass the port used in the current TestConfiguration&lt;br/&gt;
to testProtocol/TestProto so the JUnit suites can move towards being runnable&lt;br/&gt;
with another port than the default. &lt;/p&gt;

&lt;p&gt;Currently, using another port than 1527 for TestConfiguration.DEFAULT_PORT,&lt;br/&gt;
 the test fails and crashes JUnit&apos;s TestRunner with the console message:&lt;/p&gt;

&lt;p&gt;Couldn&apos;t get I/O for the connection to: localhost&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12364420">DERBY-2418</key>
            <summary>TestProto.java used by testProtocol.java hardcodes port 1527</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="julo">Julius Stroffek</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Mar 2007 03:30:28 +0000</created>
                <updated>Wed, 20 Jun 2007 15:35:01 +0100</updated>
                            <resolved>Sat, 24 Mar 2007 04:36:27 +0000</resolved>
                                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12479621" author="julo" created="Fri, 9 Mar 2007 15:34:06 +0000"  >&lt;p&gt;A patch is really simple - I have done following:&lt;/p&gt;

&lt;p&gt;1.) moved a code from TestProto constructor to initialize method&lt;br/&gt;
2.) added a constructor of TestProto with port number&lt;br/&gt;
3.) added a port number to a call to TestProto constructor in testProtocol.java. The port number is recevied by a call to TestConfiguration.getCurrent().getPort()&lt;/p&gt;

&lt;p&gt;I ran derbyall and suites.All without failures. I hardcoded port 1529 as TestConfiguration.DEFAULT_PORT and run suites.All again without any failures.&lt;/p&gt;

&lt;p&gt;Actually, HarnessJavaTest has one failure for both runs, but this happens to me for last 2 weeks every time. I think there is a problem with string comparison and it is probably a locale/encoding issue and has nothing to do with my change.&lt;/p&gt;</comment>
                            <comment id="12479773" author="dagw" created="Fri, 9 Mar 2007 23:59:07 +0000"  >&lt;p&gt;Thanks for the quick patch, Julius!  I think it is good.&lt;/p&gt;

&lt;p&gt;You may want to avoid 1527 as a magical constant in initialize(). You&lt;br/&gt;
(or committer) should probably use TestConfiguration.DEFAULT_PORT&lt;br/&gt;
instead (to be replaced soon by whatever constant &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2419&quot; title=&quot;Tighten encapsulation of state in TestConfiguration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2419&quot;&gt;&lt;del&gt;DERBY-2419&lt;/del&gt;&lt;/a&gt; ends up&lt;br/&gt;
with for Derby&apos;s default port - not to be confused with the preferred&lt;br/&gt;
port for the present run, cf. items 1) and 2) in&lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/browse/DERBY-2419#action_12479415&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/DERBY-2419#action_12479415&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Now, when we make DerbyNetNewServer rely on getPort as well,&lt;br/&gt;
we should have a clean bill of health for suites.All wrt port usage, cf&lt;br/&gt;
my comment to this issue on derby-dev on Thursday.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;
</comment>
                            <comment id="12479774" author="dagw" created="Sat, 10 Mar 2007 00:09:32 +0000"  >&lt;p&gt;See also &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2440&quot; title=&quot;DerbyNetNewServer should specify port when it starts a server to avoid requiring 1527 to run&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2440&quot;&gt;&lt;del&gt;DERBY-2440&lt;/del&gt;&lt;/a&gt;. I filed an issue for DerbyNetNewServer as well.&lt;/p&gt;</comment>
                            <comment id="12481580" author="julo" created="Fri, 16 Mar 2007 11:42:22 +0000"  >&lt;p&gt;Dag, thanks for the comments.&lt;/p&gt;

&lt;p&gt;The reason why I decided to create a new constructor with a port number and not to place TestConfiguration.getCurrent().getPort() is that TestProto class is not in a testing package and I  do not find it good to import a class from the testing package. The constructor of TestProto without a port number is only used in TestFile.java, which is not used by any tests and looks only like a command line utility to run DRDA test on any file. I would do one of these&lt;/p&gt;

&lt;p&gt;1.) use NetworkServerControl.DEFAULT_PORTNUMBER instead of TestConfiguration&apos;s &lt;br/&gt;
2.) remove the TestFile.java since it is only a command line utility&lt;/p&gt;

&lt;p&gt;I do not know which of those is better but I would say 2.)&lt;/p&gt;</comment>
                            <comment id="12481713" author="dagw" created="Fri, 16 Mar 2007 17:50:02 +0000"  >&lt;p&gt;I agree that passing this in via the constructor is better. As an&lt;br/&gt;
option 3), instead of removing TestFile.java, you could also just have&lt;br/&gt;
that class pass in the port, by letting TestFile import&lt;br/&gt;
NetworkServerControl.DEFAULT_PORTNUMBER. That way, the&lt;br/&gt;
semantics of TestFile.java would be unchanged.&lt;/p&gt;

&lt;p&gt;I would not recommend option 1) since that defeats the purpose of&lt;br/&gt;
 having the tests rely on the test configuration for the port number.&lt;/p&gt;
</comment>
                            <comment id="12483523" author="julo" created="Fri, 23 Mar 2007 11:07:38 +0000"  >&lt;p&gt;I changed also the hard coded port to NetworkServerControl.DEFAULT_PORTNUMBER in TestFile.java.&lt;/p&gt;

&lt;p&gt;I ran derbyall and suites.All without failures.&lt;/p&gt;</comment>
                            <comment id="12483649" author="dagw" created="Fri, 23 Mar 2007 16:43:38 +0000"  >&lt;p&gt;The patch looks good to me now, I recommend it be committed. Thanks&lt;br/&gt;
for fixing this, Julius!&lt;/p&gt;

&lt;p&gt;Some whitespace nits which you may want to fix yourself, or wait for&lt;br/&gt;
the committer&apos;s decision:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;in TestFile.java, line 57  exceeds 80 characters&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;in TestProto.java, the prevailing convention is to use tab rather&lt;br/&gt;
  than blanks for indentation. While we generally prefer blanks in&lt;br/&gt;
  Derby for new files, we try to stick to the surrounding lines&apos;&lt;br/&gt;
  convention, in part to make diff files look better (since tab often&lt;br/&gt;
  expands to eight under Unix, rather than Derby&apos;s convention of 4).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  Many new lines are indented using blanks, rather than tabs.&lt;br/&gt;
  Line 158 and 186 has been modified and now use use blanks for whitespace.&lt;br/&gt;
  Line 184  has been modified to use a (different) mix of blanks and tab&lt;br/&gt;
  whitespace: blanks before tabs in indentation.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;in testProtocol.java, modified line 54 exceeds 80 characters&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I realize this is a bit of a bore; the whitespace situation is Derby&lt;br/&gt;
is a mess, unfortunately, but we strive to avoid making it&lt;br/&gt;
worse. Hopefully one day we can decide on a suitable time to get rid&lt;br/&gt;
of tab characters..&lt;/p&gt;</comment>
                            <comment id="12483806" author="fuzzylogic" created="Sat, 24 Mar 2007 04:36:27 +0000"  >&lt;p&gt;Committed _try2 patch to trunk with revision 521977&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12352993" name="d2418.diff" size="2485" author="julo" created="Fri, 9 Mar 2007 15:34:06 +0000"/>
                            <attachment id="12352994" name="d2418.stat" size="243" author="julo" created="Fri, 9 Mar 2007 15:34:06 +0000"/>
                            <attachment id="12354053" name="d2418_try2.diff" size="2937" author="julo" created="Fri, 23 Mar 2007 11:07:37 +0000"/>
                            <attachment id="12354054" name="d2418_try2.stat" size="301" author="julo" created="Fri, 23 Mar 2007 11:07:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 9 Mar 2007 15:34:06 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30433</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy11lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39908</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>