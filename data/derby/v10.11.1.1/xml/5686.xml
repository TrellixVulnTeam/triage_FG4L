<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:37:20 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5686/DERBY-5686.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5686] multiple intermittent errors in nightly tests during DriverMgrAuthenticationTest test. reason: An SQL data change is not permitted for a read-only connection, user or database. 	</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5686</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;8 errors in nightly test runs on 4/4/2012 against trunk, windows, ibm16, build 1310147 .  Tests passed against same build, same machine on ibm15 and ibm17&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/1310147-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/1310147-suites.All_diff.txt&lt;/a&gt;&lt;br/&gt;
There were 8 errors:&lt;br/&gt;
1) testNotFullAccessUsers(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setProperties(DatabasePropertyTestSetup.java:352)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setUp(DatabasePropertyTestSetup.java:268)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:20)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)&lt;br/&gt;
	... 47 more&lt;br/&gt;
2) testNotFullAccessUsers(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.tearDown(DatabasePropertyTestSetup.java:294)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)&lt;br/&gt;
	... 41 more&lt;br/&gt;
3) testChangePasswordAndDatabasePropertiesOnly(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setProperties(DatabasePropertyTestSetup.java:352)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setUp(DatabasePropertyTestSetup.java:268)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:20)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)&lt;br/&gt;
	... 47 more&lt;br/&gt;
4) testChangePasswordAndDatabasePropertiesOnly(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.tearDown(DatabasePropertyTestSetup.java:294)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)&lt;br/&gt;
	... 41 more&lt;br/&gt;
5) testGreekCharacters(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setProperties(DatabasePropertyTestSetup.java:352)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setUp(DatabasePropertyTestSetup.java:268)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:20)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)&lt;br/&gt;
	... 47 more&lt;br/&gt;
6) testGreekCharacters(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.tearDown(DatabasePropertyTestSetup.java:294)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)&lt;br/&gt;
	... 41 more&lt;br/&gt;
7) testSystemShutdown(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setProperties(DatabasePropertyTestSetup.java:352)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setUp(DatabasePropertyTestSetup.java:268)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:20)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)&lt;br/&gt;
	... 47 more&lt;br/&gt;
8) testSystemShutdown(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.tearDown(DatabasePropertyTestSetup.java:294)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)&lt;br/&gt;
	... 41 more&lt;/p&gt;

&lt;p&gt;FAILURES!!!&lt;br/&gt;
Tests run: 15467,  Failures: 0,  Errors: 8&lt;/p&gt;
</description>
                <environment>Most often seen with trunk, on: Windows XP (Professional Version 2002, SP3) Intel(R) Xeon(TM) CPU 2.40 GHz 2.39 GHz, 3.87 GB of RAM. Hyperthreading on or off. JVM version seems not to matter (seen with ibm 1.5, 1.6, 1.7, weme6.2). Machine runs 4 jvm suites.All runs concurrently, so heavily loaded. Similar load on a windows XP on VMWare similuated with Xeon(TM) MP CPU 3.33GHz, 3.34GHz machine does not display this behavior.&lt;br/&gt;
Once a variation was seen (see &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5735&quot; title=&quot;2 failures in Derby2017LayerATest on trunk(revision 1332036) with ibm17&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5735&quot;&gt;&lt;strike&gt;DERBY-5735&lt;/strike&gt;&lt;/a&gt;) on another machine (Windows 2008, 4 CPU) with 10.8.&lt;br/&gt;
</environment>
        <key id="12549919">DERBY-5686</key>
            <summary>multiple intermittent errors in nightly tests during DriverMgrAuthenticationTest test. reason: An SQL data change is not permitted for a read-only connection, user or database. 	</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mikem">Mike Matrigali</reporter>
                        <labels>
                            <label>derby_triage10_10</label>
                    </labels>
                <created>Fri, 6 Apr 2012 19:57:30 +0100</created>
                <updated>Wed, 16 Apr 2014 03:41:05 +0100</updated>
                                            <version>10.10.2.0</version>
                                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13248651" author="mikem" created="Fri, 6 Apr 2012 20:46:39 +0100"  >&lt;p&gt;I spent some time looking at code and the 4/4/2012 error.  I think we are seeing this error intermittently across builds and across jvms.  I had&lt;br/&gt;
been interpreting the read only message as something to do with left over files and maybe somehow booting on files being left over and still open&lt;br/&gt;
on windows and then derby falling over to readonly.  I see that the DriverMgrAuthenticationTest does as bunch of playing with readonly authentication,&lt;br/&gt;
and now am wondering if the setup and/or tearDown routines are somehow getting a left over readonly connection and fail since they need &lt;br/&gt;
write access.&lt;/p&gt;

&lt;p&gt;So for this case we have 8 errors and no failures, but each of the errors causes a whole test to just not run so more serious.  &lt;br/&gt;
From this test run we have the following from test run:&lt;br/&gt;
(net)jdbcapi.AutoGenJDBC30Test.testUserGivenColumnsNull used 110 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testConnectShutdownAuthentication used 12453 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testUserFunctions used 1312 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testNotFullAccessUsers used 2594 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testChangePasswordAndDatabasePropertiesOnly used 1531 ms .&lt;/p&gt;

&lt;p&gt;(emb)jdbcapi.DriverMgrAuthenticationTest.testGreekCharacters used 6453 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testSystemShutdown used 6968 ms .&lt;br/&gt;
(net)jdbcapi.DriverMgrAuthenticationTest.testConnectShutdownAuthentication used 7921 ms .&lt;br/&gt;
(net)jdbcapi.DriverMgrAuthenticationTest.testUserFunctions used 2422 ms EEEEEEEE&amp;lt;assertDirectoryDeleted&amp;gt; attempt 1 left 2 files/dirs behind: 0=D:\jartest\JarResults.2012-04-05\ibm16_suites.All\system\singleUse\oneusec0\db.lck 1=D:\jartest\JarResults.2012-04-05\ibm16_suites.All\system\singleUse\oneusec0&lt;br/&gt;
.&lt;br/&gt;
(emb)jdbcapi.PoolDSAuthenticationTest.testConnectShutdownAuthentication used 19859 ms .&lt;/p&gt;

&lt;p&gt;It looks to me like network version of testUserFunctions ran and then we started having problems setting up to run&lt;br/&gt;
network testNotFullAccessUsers, and all the rest of the tests left in the suite. &lt;/p&gt;

&lt;p&gt;The end of the testUserFunctions has the following code:&lt;br/&gt;
  // reset&lt;br/&gt;
  conn1 = openDefaultConnection(&quot;dan&quot;, (&quot;dan&quot; + PASSWORD_SUFFIX));&lt;br/&gt;
  setDatabaseProperty(&lt;br/&gt;
      &quot;derby.database.defaultConnectionMode&quot;,&quot;fullAccess&quot;, conn1);&lt;br/&gt;
  setDatabaseProperty(&lt;br/&gt;
      &quot;derby.connection.requireAuthentication&quot;,&quot;false&quot;, conn1);&lt;br/&gt;
  stmt = conn1.createStatement();&lt;br/&gt;
  assertUpdateCount(stmt, 0, &quot;drop table APP.t1&quot;);&lt;br/&gt;
  conn1.commit();&lt;br/&gt;
  stmt.close();&lt;br/&gt;
  conn1.close();&lt;/p&gt;

&lt;p&gt;I am tempted to add a shutdown database here, and reopen default connection to just make sure the next test&apos;s setup has the right&lt;br/&gt;
connection.  Or could add some retry logic in the setup and teardown - not sure how easy that would be.  But I don&apos;t want to mask a real code bug.  I am wondering if there is any sort of connection caching that we are doing that&lt;br/&gt;
might not be correctly clearing readonly access?  I seem to remember past bugs where a reused connection would have some left over attribute&lt;br/&gt;
sometimes that was not meant to be.  &lt;/p&gt;

&lt;p&gt;I read the documentation and it doesn&apos;t explicitly say so, but it doesn&apos;t say not - so I assume that setting these database properties are&lt;br/&gt;
supposed to take effect immediately.  So my assumptions on derby correct behavior would be, but would appreciate opinions of those&lt;br/&gt;
with authentication expertise:&lt;/p&gt;

&lt;p&gt;1) existing connections don&apos;t change their access authentication&lt;br/&gt;
2) new connections initiated after the commit of the database properties should pick up new default authentication.&lt;/p&gt;

&lt;p&gt;The DatabasePropertyTestSetup.setUp code is going to use a connection that was produced from a getConnection() call which will use&lt;br/&gt;
existing test connection if it exists.&lt;/p&gt;

&lt;p&gt;Of course this would be all easier to understand if I could reproduce, but I have not been able to in my environment so this is all from &lt;br/&gt;
looking at static test results and the code.  Any opinions on next steps are appreciated. &lt;/p&gt;</comment>
                            <comment id="13248653" author="mikem" created="Fri, 6 Apr 2012 20:49:08 +0100"  >&lt;p&gt;This issue may or may not be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5572&quot; title=&quot;multiple errors in nightly tests during DriverMgrAuthenticationTest test. reason: Connection authentication failure occurred.  Reason: userid or password invalid.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5572&quot;&gt;&lt;del&gt;DERBY-5572&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5572&quot; title=&quot;multiple errors in nightly tests during DriverMgrAuthenticationTest test. reason: Connection authentication failure occurred.  Reason: userid or password invalid.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5572&quot;&gt;&lt;del&gt;DERBY-5572&lt;/del&gt;&lt;/a&gt; is getting userid-password errors instead of readonly.  But if problem is that a connection is being used that has leftover attributes from the test, then they could be same issue.&lt;/p&gt;</comment>
                            <comment id="13248659" author="mikem" created="Fri, 6 Apr 2012 20:54:56 +0100"  >&lt;p&gt;I think this is the same issue, though shows different tests failing and only 4 errors.  failed windows, ibm16, build 1308644, 4/2/2012&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/1308644-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/1308644-suites.All_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;1) testSystemShutdown(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedCallableStatement.executeStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.execute(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.AuthenticationTest.setDatabaseProperty(AuthenticationTest.java:1297)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.jdbcapi.AuthenticationTest.setUp(AuthenticationTest.java:192)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:113)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)&lt;br/&gt;
	... 63 more&lt;br/&gt;
Caused by: ERROR 25502: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.conn.GenericAuthorizer.authorize(Unknown Source)&lt;br/&gt;
	at org.apache.derby.exe.ac0249415ax0136x76efxea75xffff977260360.g0(Unknown Source)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)&lt;br/&gt;
	at org.apache.derby.impl.services.reflect.ReflectMethod.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.CallStatementResultSet.open(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)&lt;br/&gt;
	... 57 more&lt;br/&gt;
2) testSystemShutdown(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedCallableStatement.executeStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.tearDown(DatabasePropertyTestSetup.java:294)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at &amp;lt;unknown class&amp;gt;.&amp;lt;unknown method&amp;gt;(Unknown Source)&lt;br/&gt;
	... 55 more&lt;br/&gt;
Caused by: ERROR 25502: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.conn.GenericAuthorizer.authorize(Unknown Source)&lt;br/&gt;
	at org.apache.derby.exe.acfb4d815dx0136x76efxea75xffff977260360.g0(Unknown Source)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)&lt;br/&gt;
	at org.apache.derby.impl.services.reflect.ReflectMethod.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.CallStatementResultSet.open(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)&lt;br/&gt;
	... 49 more&lt;br/&gt;
3) testSystemShutdown(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLNonTransientConnectionException: Connection authentication failure occurred.  Reason: Invalid authentication..&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.checkUserCredentials(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source)&lt;br/&gt;
	at java.sql.DriverManager.getConnection(DriverManager.java:379)&lt;br/&gt;
	at java.sql.DriverManager.getConnection(DriverManager.java:354)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DriverManagerConnector.openConnection(DriverManagerConnector.java:100)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DriverManagerConnector.openConnection(DriverManagerConnector.java:67)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DriverManagerConnector.openConnection(DriverManagerConnector.java:43)&lt;br/&gt;
	at org.apache.derbyTesting.junit.TestConfiguration.openDefaultConnection(TestConfiguration.java:1633)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestSetup.getConnection(BaseJDBCTestSetup.java:72)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.tearDown(DatabasePropertyTestSetup.java:280)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: java.sql.SQLException: Connection authentication failure occurred.  Reason: Invalid authentication..&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)&lt;br/&gt;
	... 53 more&lt;br/&gt;
4) testSystemShutdown(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverMgrAuthenticationTest)java.sql.SQLNonTransientConnectionException: Connection authentication failure occurred.  Reason: Invalid authentication..&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.newSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.checkUserCredentials(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.InternalDriver.connect(Unknown Source)&lt;br/&gt;
	at org.apache.derby.jdbc.AutoloadedDriver.connect(Unknown Source)&lt;br/&gt;
	at java.sql.DriverManager.getConnection(DriverManager.java:379)&lt;br/&gt;
	at java.sql.DriverManager.getConnection(DriverManager.java:354)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DriverManagerConnector.openConnection(DriverManagerConnector.java:100)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DriverManagerConnector.openConnection(DriverManagerConnector.java:67)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DriverManagerConnector.openConnection(DriverManagerConnector.java:43)&lt;br/&gt;
	at org.apache.derbyTesting.junit.TestConfiguration.openDefaultConnection(TestConfiguration.java:1633)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestSetup.getConnection(BaseJDBCTestSetup.java:72)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.tearDown(DatabasePropertyTestSetup.java:280)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: java.sql.SQLException: Connection authentication failure occurred.  Reason: Invalid authentication..&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)&lt;br/&gt;
	... 48 more&lt;br/&gt;
There was 1 failure:&lt;br/&gt;
1) DriverMgrAuthenticationTestjunit.framework.AssertionFailedError: Failed to delete 14 files (root=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf): D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c10.dat (isDir=false, canRead=true, canWrite=true, size=20480), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c180.dat (isDir=false, canRead=true, canWrite=true, size=36864), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c191.dat (isDir=false, canRead=true, canWrite=true, size=16384), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c20.dat (isDir=false, canRead=true, canWrite=true, size=32768), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c51.dat (isDir=false, canRead=true, canWrite=true, size=16384), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c60.dat (isDir=false, canRead=true, canWrite=true, size=12288), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c71.dat (isDir=false, canRead=true, canWrite=true, size=8192), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c90.dat (isDir=false, canRead=true, canWrite=true, size=24576), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ca1.dat (isDir=false, canRead=true, canWrite=true, size=24576), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cc0.dat (isDir=false, canRead=true, canWrite=true, size=8192), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cd1.dat (isDir=false, canRead=true, canWrite=true, size=8192), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ce1.dat (isDir=false, canRead=true, canWrite=true, size=8192), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0 (isDir=true, canRead=true, canWrite=true, size=0), D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf (isDir=true, canRead=true, canWrite=true, size=0)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseJDBCTestCase.assertDirectoryDeleted(BaseJDBCTestCase.java:1491)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DropDatabaseSetup.removeDir(DropDatabaseSetup.java:120)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DropDatabaseSetup.access$000(DropDatabaseSetup.java:35)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DropDatabaseSetup$1.run(DropDatabaseSetup.java:106)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:202)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DropDatabaseSetup.removeDirectory(DropDatabaseSetup.java:103)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DropDatabaseSetup.removeDirectory(DropDatabaseSetup.java:99)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DropDatabaseSetup.removeDatabase(DropDatabaseSetup.java:92)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DropDatabaseSetup.tearDown(DropDatabaseSetup.java:78)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;/p&gt;

&lt;p&gt;FAILURES!!!&lt;br/&gt;
Tests run: 15471,  Failures: 1,  Errors: 4&lt;/p&gt;


&lt;p&gt;Here is the output from when the test failed:&lt;br/&gt;
(net)jdbcapi.AutoGenJDBC30Test.testUserGivenColumnsNull used 94 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testConnectShutdownAuthentication used 27905 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testUserFunctions used 2469 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testNotFullAccessUsers used 765 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testChangePasswordAndDatabasePropertiesOnly used 1000 ms .&lt;/p&gt;

&lt;p&gt;(emb)jdbcapi.DriverMgrAuthenticationTest.testGreekCharacters used 7656 ms .&lt;br/&gt;
(emb)jdbcapi.DriverMgrAuthenticationTest.testSystemShutdown java.io.FileNotFoundException: system\singleUse\oneusebf\db.lck (Access is denied.)&lt;br/&gt;
	at java.io.FileInputStream.open(Native Method)&lt;br/&gt;
	at java.io.FileInputStream.&amp;lt;init&amp;gt;(FileInputStream.java:137)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests.copySingleFile(PrivilegedFileOpsForTests.java:304)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests.recursiveCopy(PrivilegedFileOpsForTests.java:276)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests.access$000(PrivilegedFileOpsForTests.java:49)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests$8.run(PrivilegedFileOpsForTests.java:235)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:251)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests.copy(PrivilegedFileOpsForTests.java:233)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:137)&lt;br/&gt;
	at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.framework.TestResult.run(TestResult.java:109)&lt;br/&gt;
	at junit.framework.TestCase.run(TestCase.java:120)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.textui.TestRunner.doRun(TestRunner.java:121)&lt;br/&gt;
	at junit.textui.TestRunner.start(TestRunner.java:185)&lt;br/&gt;
	at junit.textui.TestRunner.main(TestRunner.java:143)&lt;br/&gt;
used 1484 ms EEEE&amp;lt;assertDirectoryDeleted&amp;gt; attempt 1 left 15 files/dirs behind: 0=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\db.lck 1=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c10.dat 2=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c180.dat 3=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c191.dat 4=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c20.dat 5=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c51.dat 6=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c60.dat 7=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c71.dat 8=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c90.dat 9=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ca1.dat 10=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cc0.dat 11=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cd1.dat 12=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ce1.dat 13=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0 14=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf&lt;br/&gt;
&amp;lt;assertDirectoryDeleted&amp;gt; attempt 2 left 14 files/dirs behind: 0=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c10.dat 1=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c180.dat 2=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c191.dat 3=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c20.dat 4=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c51.dat 5=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c60.dat 6=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c71.dat 7=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c90.dat 8=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ca1.dat 9=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cc0.dat 10=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cd1.dat 11=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ce1.dat 12=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0 13=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf&lt;br/&gt;
&amp;lt;assertDirectoryDeleted&amp;gt; attempt 3 left 14 files/dirs behind: 0=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c10.dat 1=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c180.dat 2=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c191.dat 3=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c20.dat 4=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c51.dat 5=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c60.dat 6=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c71.dat 7=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c90.dat 8=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ca1.dat 9=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cc0.dat 10=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cd1.dat 11=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ce1.dat 12=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0 13=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf&lt;br/&gt;
&amp;lt;assertDirectoryDeleted&amp;gt; attempt 4 left 14 files/dirs behind: 0=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c10.dat 1=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c180.dat 2=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c191.dat 3=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c20.dat 4=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c51.dat 5=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c60.dat 6=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c71.dat 7=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\c90.dat 8=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ca1.dat 9=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cc0.dat 10=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\cd1.dat 11=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0\ce1.dat 12=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf\seg0 13=D:\jartest\JarResults.2012-04-02\ibm16_suites.All\system\singleUse\oneusebf&lt;br/&gt;
F.&lt;br/&gt;
(net)jdbcapi.DriverMgrAuthenticationTest.testConnectShutdownAuthentication used 4625 ms .&lt;br/&gt;
(net)jdbcapi.DriverMgrAuthenticationTest.testUserFunctions used 937 ms .&lt;br/&gt;
(net)jdbcapi.DriverMgrAuthenticationTest.testNotFullAccessUsers used 1188 ms .&lt;br/&gt;
(net)jdbcapi.DriverMgrAuthenticationTest.testChangePasswordAndDatabasePropertiesOnly used 578 ms .&lt;br/&gt;
(net)jdbcapi.DriverMgrAuthenticationTest.testGreekCharacters used 2219 ms .&lt;br/&gt;
(net)jdbcapi.DriverMgrAuthenticationTest.testSystemShutdown used 1188 ms .&lt;br/&gt;
(emb)jdbcapi.PoolDSAuthenticationTest.testConnectShutdownAuthentication used 6391 ms .&lt;/p&gt;
</comment>
                            <comment id="13263367" author="myrna" created="Fri, 27 Apr 2012 06:46:48 +0100"  >&lt;p&gt;Attaching a patch which modifies DatabasePropertyTestSetup to catch SQLSTATE 25502 in the teardown method; and gather some info and print it out, and then close the current connection, and retry the same clearing of properties with a new connection.&lt;/p&gt;

&lt;p&gt;Hopefully this will clear the problem, if not, at least it will give us a bit more insight in the state of the connection when we see this.&lt;/p&gt;

&lt;p&gt;Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="13263997" author="myrna" created="Fri, 27 Apr 2012 22:38:17 +0100"  >&lt;p&gt;I committed my patch. &lt;br/&gt;
If the error is not seen, it won&apos;t affect the run, and if it &lt;b&gt;is&lt;/b&gt; seen in the teardown method of the DatabasePropertyTestSetup, we&apos;ll hopefully see some info. &lt;/p&gt;

&lt;p&gt;However, I don&apos;t think this will solve the issue - or at least not entirely, because it doesn&apos;t seem to be always the DatabasePropertyTestSetup that&apos;s involved, nor is it always &apos;SQL&apos;. For instance, it can also be &apos;DDL&apos; i.e. ERROR 25503 (instead of 25502), see the stacktrace of the first failure with weme 6.2 on 4/25 (&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/weme6.2/1330624-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/weme6.2/1330624-suites.All_diff.txt&lt;/a&gt;);&lt;br/&gt;
 1)&lt;br/&gt;
 testDropTableAfterUpgradeWithConstraint(org.apache.derbyTesting.functionTests.tests.upgradeTests.BasicSetup)java.sql.SQLException: DDL is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.upgradeTests.BasicSetup.testDropTableAfterUpgradeWithConstraint(BasicSetup.java:286)&lt;br/&gt;
	at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:195)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:113)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: ERROR 25503: DDL is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.conn.GenericAuthorizer.authorize(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.GenericResultSetFactory.getDDLResultSet(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.execute.ConstantActionActivation.execute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericActivationHolder.execute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)&lt;br/&gt;
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)&lt;br/&gt;
	... 101 more&lt;br/&gt;
------------------------&lt;/p&gt;

&lt;p&gt;This however seems related to a java.io.FileNotFoundException on db.lck which is printed earlier in the output, but apparently not causing a failure:&lt;/p&gt;

&lt;p&gt;------------------------&lt;br/&gt;
(emb)upgradeTests.BasicSetup.testDropTableAfterUpgradeWithConstraint java.io.FileNotFoundException: system\singleUse\oneusecb\db.lck (A component of the path name does not exist)&lt;br/&gt;
	at java.io.FileInputStream.&amp;lt;init&amp;gt;(FileInputStream.java:55)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests.copySingleFile(PrivilegedFileOpsForTests.java:304)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests.recursiveCopy(PrivilegedFileOpsForTests.java:276)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests.access$000(PrivilegedFileOpsForTests.java:49)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests$8.run(PrivilegedFileOpsForTests.java:235)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:255)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.util.PrivilegedFileOpsForTests.copy(PrivilegedFileOpsForTests.java:233)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:137)&lt;br/&gt;
	at junit.framework.TestResult$1.protect(TestResult.java:106)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.framework.TestResult.run(TestResult.java:109)&lt;br/&gt;
	at junit.framework.TestCase.run(TestCase.java:120)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.framework.TestResult.runProtected(TestResult.java:124)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.framework.TestSuite.runTest(TestSuite.java:230)&lt;br/&gt;
	at junit.framework.TestSuite.run(TestSuite.java:225)&lt;br/&gt;
	at junit.textui.TestRunner.doRun(TestRunner.java:121)&lt;br/&gt;
	at junit.textui.TestRunner.start(TestRunner.java:185)&lt;br/&gt;
	at junit.textui.TestRunner.main(TestRunner.java:143) &lt;br/&gt;
------------------------&lt;/p&gt;

&lt;p&gt;But we&apos;ll wait and see what happens.&lt;/p&gt;</comment>
                            <comment id="13265215" author="myrna" created="Mon, 30 Apr 2012 22:06:53 +0100"  >&lt;p&gt;We did not hit the error during DatabasePropertyTestSetup.teardown, so I don&apos;t know whether we now would get more useful output, but we did hit another occurrence - this time during DatabasePropertyTestSetup.setUp()- see: &lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm17/1332036-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm17/1332036-suites.All_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The stack of the first failure:&lt;br/&gt;
---------------------------  &lt;br/&gt;
1) testEmbeddedAttributes(org.apache.derbyTesting.functionTests.tests.jdbcapi.DriverTest)java.sql.SQLException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory40.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdate(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setProperties(DatabasePropertyTestSetup.java:392)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setUp(DatabasePropertyTestSetup.java:272)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:20)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: An SQL data change is not permitted for a read-only connection, user or database.&lt;br/&gt;
	at org.apache.derby.client.am.Statement.completeExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.parseEXCSQLSTTreply(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.StatementReply.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetStatement.readExecuteCall_(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Statement.readExecuteCall(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.flowExecute(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.PreparedStatement.executeUpdateX(Unknown Source)&lt;br/&gt;
	... 29 more&lt;/p&gt;

&lt;p&gt;As happens sometimes, there was no actual &apos;fail&apos; directory for this; the only fail dirs created were for the subsequent jdbcapi.Derby2017LayerATest failures which report the DDL read-only message (SQLState Error 25503). I think those failures are likely later - the first occurrence is the .SQLState Error 25502.&lt;/p&gt;

&lt;p&gt;I am attaching a patch - &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5686&quot; title=&quot;multiple intermittent errors in nightly tests during DriverMgrAuthenticationTest test. reason: An SQL data change is not permitted for a read-only connection, user or database. 	&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5686&quot;&gt;DERBY-5686&lt;/a&gt;_2.diff which tries to catch this error during setUp by adding similar code as was added for the teardown() to the setProperties method.&lt;/p&gt;

&lt;p&gt;Review is welcome, otherwise I&apos;ll commit this in a couple of hours.&lt;/p&gt;</comment>
                            <comment id="13265552" author="myrna" created="Tue, 1 May 2012 01:45:56 +0100"  >&lt;p&gt;I committed the _2.diff patch with revision 1332484.&lt;/p&gt;</comment>
                            <comment id="13267664" author="myrna" created="Thu, 3 May 2012 19:28:19 +0100"  >&lt;p&gt;Unfortunately, my changes weren&apos;t enough to make the test pass - see:&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm15/1332892-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm15/1332892-suites.All_diff.txt&lt;/a&gt;&lt;br/&gt;
and&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/1332892-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm16/1332892-suites.All_diff.txt&lt;/a&gt;&lt;br/&gt;
The ibm 1.5 failure was in DatabasePropertyTestSetup.teardown(), but the new connection was also reported as readOnly, so retry was pointless. I&apos;m not any further in understanding where it (the connection or the database?) was set to readOnly.&lt;br/&gt;
One theory was that an earlier test did a setReadOnly and that this somehow propogated - jdbcapi.DataSourceTest and jdbcapi.J2EEDataSourceTest do this at some point - but in the ibm 1.5 failures, as in several earlier cases, those 2 tests either didn&apos;t run at all (e.g. with 1.7 jvm) or didn&apos;t run before the first failure.&lt;br/&gt;
After the initial failure we see a host of other trouble such as invalid authentication errors.&lt;/p&gt;

&lt;p&gt;The ibm 1.6 failure shows that it did hit the additional code in DatabasePropertyTestSetup.setProperties, but unfortunately the code I added to do conn.close() failed, because the transaction is still open (causing different failures than before, not helping matters).&lt;/p&gt;
</comment>
                            <comment id="13267720" author="kristwaa" created="Thu, 3 May 2012 20:21:54 +0100"  >&lt;p&gt;Attaching patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5686&quot; title=&quot;multiple intermittent errors in nightly tests during DriverMgrAuthenticationTest test. reason: An SQL data change is not permitted for a read-only connection, user or database. 	&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5686&quot;&gt;DERBY-5686&lt;/a&gt;_3, which modifies the logic in assertDirectoryDeleted to tolerate that the root directory for some reason gets unexpectedly deleted.&lt;br/&gt;
Note that the method will still fail if the directory doesn&apos;t exist in the first iteration.&lt;/p&gt;

&lt;p&gt;Patch ready for review. &lt;/p&gt;

&lt;p&gt;FYI, I saw that one test failed because of the old logic in the ibm16 run Myrna referred to. The only file that couldn&apos;t be deleted was db.lck. The root directory wasn&apos;t listed as &quot;undeletable&quot;. Probably db.lck was attempted deleted early on while Derby was still running, and assertDirectoryDeleted deleted all the other files. I&apos;m guessing that Derby deleted the lock file as part of shutdown before assertDirectoryDeleted got around to delete the root directory. Removing the directory succeeded because it would have been empty at that point.&lt;/p&gt;</comment>
                            <comment id="13267967" author="myrna" created="Fri, 4 May 2012 01:05:46 +0100"  >&lt;p&gt;I&apos;m attaching another patch which tries to finagle the retrying/catch info code. This is still debugging code, and may possibly be removed/adjusted again later. Ready for review.&lt;/p&gt;</comment>
                            <comment id="13267971" author="myrna" created="Fri, 4 May 2012 01:08:06 +0100"  >&lt;p&gt;Thanks for looking at this issue Kristian.&lt;br/&gt;
+1 to implementing patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5686&quot; title=&quot;multiple intermittent errors in nightly tests during DriverMgrAuthenticationTest test. reason: An SQL data change is not permitted for a read-only connection, user or database. 	&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5686&quot;&gt;DERBY-5686&lt;/a&gt;_3.diff, it looks like a good improvement, although I think the error related to assertDirectoryDeleted is a result of the earlier failures, or at least a later issue...&lt;/p&gt;</comment>
                            <comment id="13268897" author="kristwaa" created="Sat, 5 May 2012 05:23:16 +0100"  >&lt;p&gt;Committed patch 3 to trunk with revision 1334313.&lt;/p&gt;</comment>
                            <comment id="13270918" author="myrna" created="Wed, 9 May 2012 00:12:48 +0100"  >&lt;p&gt;Unfortunately, the latest commit now causes a loop that we never break out of... &lt;br/&gt;
This for instance is the end of console output from a recent unfinished (and hence not published) test run before I killed the process:&lt;br/&gt;
-------------------------------- &lt;br/&gt;
(net)jdbcapi.InternationalConnectTest.testDriverManagerConnect used 13797 ms .&lt;br/&gt;
(net)jdbcapi.InternationalConnectTest.testXADSConnect &amp;lt;assertDirectoryDeleted&amp;gt; attempt 1 left 1 files/dirs behind: 0=D:\jartest\JarResults.2012-05-07\ibm17_suites.All\system&amp;#63;\tmp&lt;br/&gt;
&amp;lt;assertDirectoryDeleted&amp;gt; root directory unexpectedly gone - delayed, external or concurrent delete?&lt;br/&gt;
&amp;lt;assertDirectoryDeleted&amp;gt; attempt 1 left 1 files/dirs behind: 0=D:\jartest\JarResults.2012-05-07\ibm17_suites.All\system&amp;#63;\tmp&lt;br/&gt;
&amp;lt;assertDirectoryDeleted&amp;gt; root directory unexpectedly gone - delayed, external or concurrent delete?&lt;br/&gt;
&amp;lt;assertDirectoryDeleted&amp;gt; attempt 1 left 1 files/dirs behind: 0=D:\jartest\JarResults.2012-05-07\ibm17_suites.All\system&amp;#63;\tmp&lt;br/&gt;
&amp;lt;assertDirectoryDeleted&amp;gt; root directory unexpectedly gone - delayed, external or concurrent delete?&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;....etc...&amp;#93;&lt;/span&gt; &lt;br/&gt;
-------------------------------- &lt;br/&gt;
Did we perhaps miss adding attempts++? I&apos;m going to assume we did. I&apos;ll add a finally block... &lt;/p&gt;</comment>
                            <comment id="13270921" author="myrna" created="Wed, 9 May 2012 00:19:29 +0100"  >&lt;p&gt;committed adding a finally block with revision 1335820.&lt;/p&gt;</comment>
                            <comment id="13271268" author="kristwaa" created="Wed, 9 May 2012 11:09:42 +0100"  >&lt;p&gt;Thanks, Myrna.&lt;/p&gt;

&lt;p&gt;Sorry about that mistake. When I look at the code now, I believe I forgot a return-statement in the else-block (inside the catch-block).&lt;br/&gt;
See patch 3a, which also backs out the addition of the finally-block. While the unconditional increment of attempts breaks the loop, it will cause the test/setup to fail because fl will always contain at least one element. I suppose Java lists &apos;?&apos; as the directory name because it has been deleted.&lt;/p&gt;

&lt;p&gt;Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="13271415" author="myrna" created="Wed, 9 May 2012 14:46:55 +0100"  >&lt;p&gt;Thanks for the explanation Kristian. +1 for committing your update.&lt;/p&gt;</comment>
                            <comment id="13271588" author="mikem" created="Wed, 9 May 2012 17:57:29 +0100"  >&lt;p&gt;looks like the following is caused by retry logic not committing/aborting transaction before closing connection:&lt;br/&gt;
&lt;a href=&quot;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm15/1335323-suites.All_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://people.apache.org/~myrnavl/derby_test_results/main/windows/testlog/ibm15/1335323-suites.All_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;There were 2 errors:&lt;br/&gt;
1) testInvalidAlgorithmName(org.apache.derbyTesting.functionTests.tests.jdbcapi.AuthenticationTest)java.sql.SQLException: Cannot close a connection while a transaction is still active.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Connection.closeResourcesX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Connection.closeX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetConnection.closeX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Connection.close(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetConnection.close(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setProperties(DatabasePropertyTestSetup.java:372)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.setUp(DatabasePropertyTestSetup.java:272)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:20)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: Cannot close a connection while a transaction is still active.&lt;br/&gt;
	at org.apache.derby.client.am.Connection.checkForTransactionInProgress(Unknown Source)&lt;br/&gt;
	... 51 more&lt;br/&gt;
2) testInvalidAlgorithmName(org.apache.derbyTesting.functionTests.tests.jdbcapi.AuthenticationTest)java.sql.SQLException: Cannot close a connection while a transaction is still active.&lt;br/&gt;
	at org.apache.derby.client.am.SQLExceptionFactory.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.SqlException.getSQLException(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Connection.closeResourcesX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Connection.closeX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetConnection.closeX(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.am.Connection.close(Unknown Source)&lt;br/&gt;
	at org.apache.derby.client.net.NetConnection.close(Unknown Source)&lt;br/&gt;
	at org.apache.derbyTesting.junit.DatabasePropertyTestSetup.tearDown(DatabasePropertyTestSetup.java:303)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:22)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestSetup.run(BaseTestSetup.java:57)&lt;br/&gt;
	at junit.extensions.TestDecorator.basicRun(TestDecorator.java:24)&lt;br/&gt;
	at junit.extensions.TestSetup$1.protect(TestSetup.java:21)&lt;br/&gt;
	at junit.extensions.TestSetup.run(TestSetup.java:25)&lt;br/&gt;
Caused by: org.apache.derby.client.am.SqlException: Cannot close a connection while a transaction is still active.&lt;br/&gt;
	at org.apache.derby.client.am.Connection.checkForTransactionInProgress(Unknown Source)&lt;br/&gt;
	... 45 more&lt;/p&gt;</comment>
                            <comment id="13271621" author="myrna" created="Wed, 9 May 2012 18:38:49 +0100"  >&lt;p&gt;Yes, that&apos;s why I put up my patch _4.diff on May 4...I was hoping for a review... &lt;br/&gt;
But now I&apos;m working on an alternative that catches error 25001 (Cannot close a connection while a transaction is still active) and does a commit then tries the close again. I want to run a full test suite with this change, so it&apos;ll take a while.&lt;br/&gt;
Also I am working on some additional changes, because I think I&apos;ve seen the error when it wasn&apos;t DatabasePropertyTestSetup that reported the db to be read-only.&lt;/p&gt;</comment>
                            <comment id="13271634" author="kristwaa" created="Wed, 9 May 2012 18:55:21 +0100"  >&lt;p&gt;Committed patch 3a to trunk with revision 1336316.&lt;br/&gt;
Sorry for polluting your issue, Myrna. I&apos;ll take a look at your next patch and see if I can contribute with anything of value.&lt;br/&gt;
Do you mind filling out the environment-field of this issue?&lt;/p&gt;</comment>
                            <comment id="13271638" author="myrna" created="Wed, 9 May 2012 18:59:24 +0100"  >&lt;p&gt;Attaching another patch, which tries to address the situation where the retry logic in DatabasePropertyTestSetup would get an error. This also adds some code to cleanDatabaseTestSetup to catch tests leaving the connection in read-only state.&lt;/p&gt;</comment>
                            <comment id="13271697" author="myrna" created="Wed, 9 May 2012 19:51:16 +0100"  >&lt;p&gt;Thanks Kristian. The review comment wasn&apos;t necessarily directed at you...Plus I forgot to set the patch available flag.&lt;br/&gt;
I feel better about the _5.diff and committed it already - revision 1336349. &lt;br/&gt;
I updated the environment field of this issue.&lt;/p&gt;</comment>
                            <comment id="13272880" author="myrna" created="Fri, 11 May 2012 00:11:11 +0100"  >&lt;p&gt;Attaching a patch which tries to address another possible cause for the problems - perhaps the shutdown reports it&apos;s finished before it&apos;s actually completely shutdown.&lt;br/&gt;
So this patch tries to check whether the db.lck and/or (for unix) dbex.lck file(s) are still present - if so, loop until they&apos;re gone, then continue to delete the database.&lt;/p&gt;

&lt;p&gt;This patch passed on my system (a different one from where the test failures are seen). Patch ready for review.&lt;/p&gt;</comment>
                            <comment id="13273054" author="kristwaa" created="Fri, 11 May 2012 06:23:30 +0100"  >&lt;p&gt;Thanks for updating the environment field, Myrna.&lt;/p&gt;

&lt;p&gt;Is patch 6 temporary, or is it intended as a permanent addition?&lt;/p&gt;

&lt;p&gt;Especially if the latter, I have a few questions and comments:&lt;br/&gt;
 o Are there cases where the lock files won&apos;t be removed for some reason?&lt;br/&gt;
    If yes, then there should be a timeout function, i.e. don&apos;t wait for more than X minutes.&lt;br/&gt;
 o You can avoid the boolean by using break, but with a timeout the loop will probably be rewritten anyway.&lt;br/&gt;
 o This patch masks an issue. I&apos;d like it to print something if it has to wait, similar to what assertDirectoryDeleted does, as an incentive/reminder for fixing the real issue.&lt;br/&gt;
    I expect that with patch 6 committed, you shouldn&apos;t see any more output from assertDirectoryDeleted, except for in cases where there&apos;s a real bug with not closing file handles.&lt;/p&gt;

&lt;p&gt;The theory about the database shutdown now being complete is pretty much confirmed, since the file deletion logic has failed deleting db.lock and tmp. Both of these are supposed to be removed by Derby when it has shut down properly. I don&apos;t know if this is the reason for the read-only connections, but it will be good to rule that out.&lt;/p&gt;

&lt;p&gt;Do we know if the database goes read-only on boot, or if it turns read-only after being booted?&lt;/p&gt;</comment>
                            <comment id="13276321" author="myrna" created="Wed, 16 May 2012 00:09:50 +0100"  >&lt;p&gt;Patch 6 was intended as a more permanent solution - if it did solve the problem...&lt;br/&gt;
But we&apos;re still unclear on what causes derby to think the db is read-only.&lt;/p&gt;

&lt;p&gt;One part of the trouble is that this machine was running our nightly tests - meaning I only had a small time frame to debug/analyze/run experiments. I now switched the nightly runs to another machine, so I can debug/experiment better. At which point I don&apos;t need to commit to see the bad results, so the patch doesn&apos;t need to go in until we&apos;re sure it&apos;s fixing the trouble.&lt;/p&gt;

&lt;p&gt;To go into your questions (answers with a&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
o Are there cases where the lock files won&apos;t be removed for some reason?&lt;br/&gt;
   If yes, then there should be a timeout function, i.e. don&apos;t wait for more than X minutes.  &lt;br/&gt;
a:   I think this is what we&apos;re concerned about. Shutdown() should remove the lock files, but in this case it seems sometimes they&apos;re not removed, there seems to be a timing issue. The theory there is that if db.lck is present, we&apos;ll get an 25502 error. &lt;br/&gt;
   And you&apos;re right - there needs to be a timeout, possibly with some message.&lt;br/&gt;
o You can avoid the boolean by using break, but with a timeout the loop will probably be rewritten anyway. &lt;br/&gt;
a:  You&apos;re right.&lt;br/&gt;
o This patch masks an issue. I&apos;d like it to print something if it has to wait, similar to what assertDirectoryDeleted does, as an incentive/reminder for fixing the real issue. &lt;br/&gt;
a: Printing something makes sense, I&apos;ll work on that.&lt;/p&gt;

&lt;p&gt;q:  Do we know if the database goes read-only on boot, or if it turns read-only after being booted? &lt;br/&gt;
a: we don&apos;t know...It would be good to figure this out too...&lt;/p&gt;</comment>
                            <comment id="13277060" author="kmarsden" created="Wed, 16 May 2012 20:58:04 +0100"  >&lt;p&gt;Although not well understood the connection between the tests and the , errors. At least the error that occurs in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5766&quot; title=&quot;BaseDataFileFactory.boot() should log the exception that causes it to boot the database read only &quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5766&quot;&gt;DERBY-5766&lt;/a&gt; seems the same, so linking the issue&lt;/p&gt;</comment>
                            <comment id="13278337" author="myrna" created="Thu, 17 May 2012 23:17:51 +0100"  >&lt;p&gt;Attaching another version of the patch which I think addresses Kristian&apos;s comments. &lt;/p&gt;</comment>
                            <comment id="13286914" author="kmarsden" created="Thu, 31 May 2012 21:43:35 +0100"  >&lt;p&gt;Hi Myrna, I think your patch from the 17th is safe to commit. I wonder where are the single use databases shutdown. It seems it is mostly those that relate to the failures in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5686&quot; title=&quot;multiple intermittent errors in nightly tests during DriverMgrAuthenticationTest test. reason: An SQL data change is not permitted for a read-only connection, user or database. 	&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5686&quot;&gt;DERBY-5686&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13288951" author="myrna" created="Mon, 4 Jun 2012 23:08:29 +0100"  >&lt;p&gt;The machine (results no longer published) was displaying the read-only trouble again on Friday night&apos;s run.&lt;br/&gt;
I committed the patch _7.diff with revision 1346174.&lt;/p&gt;</comment>
                            <comment id="13436135" author="myrna" created="Thu, 16 Aug 2012 18:31:53 +0100"  >&lt;p&gt;Despite the patch, we kept seeing various read-only errors.&lt;br/&gt;
I finally had the disk swapped for a new one, and I deleted some space on the way - and now the problems are gone.&lt;br/&gt;
I added back in the largeDataTest suite, to see what happens.&lt;/p&gt;

&lt;p&gt;On the whole, there have been a number of test failures reported that I think relate to the same issue. I&apos;ll mark all of those duplicates of this.&lt;/p&gt;

&lt;p&gt;Also, there have been some reports from users complaining about sudden read-only databases.&lt;br/&gt;
It&apos;s something that can happen when the disk is full - in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-555&quot; title=&quot;Unable to restart after disk is full&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-555&quot;&gt;&lt;del&gt;DERBY-555&lt;/del&gt;&lt;/a&gt; Suresh hypothesized that this would happen if the db.lck file could not get created.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-555?focusedCommentId=12320936&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12320936&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/DERBY-555?focusedCommentId=12320936&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12320936&lt;/a&gt;&lt;br/&gt;
But this is on booting the database. Was that the case with our failing test cases? Perhaps so, as in the case of it hitting through junit.DatabasePropertyTestSetup.&lt;/p&gt;

&lt;p&gt;Here are some relevant user questions:&lt;br/&gt;
&lt;a href=&quot;http://old.nabble.com/Derby-database-started-suddenly-in-READ-ONLY-mode-td33271488.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://old.nabble.com/Derby-database-started-suddenly-in-READ-ONLY-mode-td33271488.html&lt;/a&gt; &lt;br/&gt;
&lt;a href=&quot;http://old.nabble.com/Derby-on-Tomcat-server-keeps-setting-itself-to-read-only-td23152838.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://old.nabble.com/Derby-on-Tomcat-server-keeps-setting-itself-to-read-only-td23152838.html&lt;/a&gt;&lt;br/&gt;
perhaps also &lt;a href=&quot;http://forums.overclockers.co.uk/showthread.php?p=13923396&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://forums.overclockers.co.uk/showthread.php?p=13923396&lt;/a&gt; - maybe a case of running out of memory when tomcat is up?&lt;/p&gt;
</comment>
                            <comment id="13440390" author="myrna" created="Thu, 23 Aug 2012 16:41:24 +0100"  >&lt;p&gt;After adding the largeDataSuite again, the machine apparently got so maxed out in some way (memory? There ought to have been enough disk space...) that I couldn&apos;t log on to look at anything.&lt;br/&gt;
Automatic reporting did see one occurrence of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5735&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/DERBY-5735&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Then when I decided to boot the machine in order to stop the largeDataSuite again, it killed the disk.&lt;br/&gt;
So, there is still a possibility that this occurs, but I don&apos;t want to spend more time on this now. It may even be &apos;by design&apos; (based on the comments in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-555&quot; title=&quot;Unable to restart after disk is full&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-555&quot;&gt;&lt;del&gt;DERBY-555&lt;/del&gt;&lt;/a&gt;), but it would at least be nice if derby could give a better message, because when you see &apos;read-only&apos;, the logical assumption is that there is something wrong with permissions or read-only settings somewhere.&lt;br/&gt;
Unassigning myself.&lt;/p&gt;</comment>
                            <comment id="13464192" author="kmarsden" created="Wed, 26 Sep 2012 22:38:13 +0100"  >&lt;p&gt;Taking off of High Value Fix per Myrna&apos;s comments depriortizing the issue. The better error reporting she recommends will still be on  the High Value Fix list in the form of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5686&quot; title=&quot;multiple intermittent errors in nightly tests during DriverMgrAuthenticationTest test. reason: An SQL data change is not permitted for a read-only connection, user or database. 	&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5686&quot;&gt;DERBY-5686&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12547686">DERBY-5669</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12538857">DERBY-5572</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12540202">DERBY-5588</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12548219">DERBY-5672</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12553388">DERBY-5735</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12547284">DERBY-5665</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12547292">DERBY-5666</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12556076">DERBY-5766</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12314126">DERBY-555</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12538857">DERBY-5572</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12540202">DERBY-5588</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12548219">DERBY-5672</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12553388">DERBY-5735</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12526131" name="DERBY-5686-3a-add_missing_return.diff" size="1122" author="kristwaa" created="Wed, 9 May 2012 11:09:42 +0100"/>
                            <attachment id="12524815" name="DERBY-5686_1.diff" size="4692" author="myrna" created="Fri, 27 Apr 2012 06:46:48 +0100"/>
                            <attachment id="12525107" name="DERBY-5686_2.diff" size="3247" author="myrna" created="Mon, 30 Apr 2012 22:06:53 +0100"/>
                            <attachment id="12525499" name="DERBY-5686_3.diff" size="1250" author="kristwaa" created="Thu, 3 May 2012 20:21:54 +0100"/>
                            <attachment id="12525538" name="DERBY-5686_4.diff" size="2233" author="myrna" created="Fri, 4 May 2012 01:05:45 +0100"/>
                            <attachment id="12526187" name="DERBY-5686_5.diff" size="3610" author="myrna" created="Wed, 9 May 2012 18:59:24 +0100"/>
                            <attachment id="12526448" name="DERBY-5686_6.diff" size="7411" author="myrna" created="Fri, 11 May 2012 00:11:11 +0100"/>
                            <attachment id="12527943" name="DERBY-5686_7.diff" size="8443" author="myrna" created="Thu, 17 May 2012 23:17:50 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 27 Apr 2012 05:46:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>234910</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy09f3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>