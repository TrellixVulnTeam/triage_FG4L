<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:28:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1938/DERBY-1938.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1938] Add support for setObject(&lt;arg&gt;, null)</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1938</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Derby presently does not implement support for the method&lt;br/&gt;
PreparedStatement.setObject (and similarly for CallableStatement.setObject) &lt;br/&gt;
when the supplied value is null, unless a type argument (3rd arg) is also present. &lt;br/&gt;
That is, in:&lt;br/&gt;
    void setObject(int parameterIndex,&lt;br/&gt;
                              Object x)&lt;br/&gt;
                              throws SQLException&lt;br/&gt;
x can not be null. &lt;/p&gt;

&lt;p&gt;Derby will presently throw an SQLException (client: XJ021, embedded: 22005)&lt;br/&gt;
if x is null when calling this method on a preparedStatement.&lt;/p&gt;

&lt;p&gt;Porting some applications may be made easier if this restriction is lifted.&lt;br/&gt;
See also discussion in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1904&quot; title=&quot;COALESCE with NULL parameter problem&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1904&quot;&gt;&lt;del&gt;DERBY-1904&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12352552">DERBY-1938</key>
            <summary>Add support for setObject(&lt;arg&gt;, null)</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Oct 2006 23:38:16 +0100</created>
                <updated>Thu, 13 Jan 2011 17:31:47 +0000</updated>
                            <resolved>Wed, 8 Sep 2010 16:27:44 +0100</resolved>
                                                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12440464" author="bernt" created="Fri, 6 Oct 2006 15:13:58 +0100"  >&lt;p&gt;NOTE: Tutorial, 3rd ed says (25.1.6 p. 653): &quot;The method setObject, however, can take a null value only if the JDBC type is specified&quot;.&lt;/p&gt;

&lt;p&gt;Although the tutorial is not the spec, it&apos;s clearly the intention that the SQL NULL in JDBC should behave like SQL NULL in the SQL spec, and that JDBC compliant applications should &lt;b&gt;not&lt;/b&gt; call setObject(n, null) and that drivers are not required to implement it to be JDBC compliant.&lt;/p&gt;</comment>
                            <comment id="12440800" author="naka" created="Mon, 9 Oct 2006 04:32:36 +0100"  >&lt;p&gt;I found next comment in the code.&lt;/p&gt;

&lt;p&gt;org.apache.derby.impl.jdbc.EmbedPreparedStatement :&lt;/p&gt;

&lt;p&gt;    public final void setObject(int parameterIndex, Object x) throws SQLException {&lt;br/&gt;
		checkStatus();	&lt;br/&gt;
		int colType = getParameterJDBCType(parameterIndex);&lt;/p&gt;

&lt;p&gt;		// JDBC Tutorial and Reference books states in the PreparedStatement&lt;br/&gt;
		// overview, that passing a untyped null into setObject() is not allowed.&lt;br/&gt;
		// JCC disallows this, basically SQL can not handle a untyped NULL.&lt;br/&gt;
		// Section 25.1.6 (Third edition), 24.1.5 (Second Edition)&lt;/p&gt;

&lt;p&gt;		if (x == null) &lt;/p&gt;
{
			//setNull(parameterIndex, colType);
			//return;
			throw dataTypeConversion(parameterIndex, &quot;null&quot;);
		}
</comment>
                            <comment id="12440804" author="naka" created="Mon, 9 Oct 2006 05:06:16 +0100"  >&lt;p&gt;In the spec of jdbc-3_0, I found next content.&lt;/p&gt;

&lt;p&gt;13.2.2.2 Type Conversions Using the Method setObject&lt;br/&gt;
                             &amp;lt;snip&amp;gt;&lt;br/&gt;
If setObject is called without a type parameter, the Java Object&lt;br/&gt;
mapped using the default mapping for that object type.&lt;br/&gt;
                             &amp;lt;snip&amp;gt;&lt;/p&gt;

&lt;p&gt;13.2.2.3 Setting NULL Parameters&lt;br/&gt;
                              &amp;lt;snip&amp;gt;&lt;br/&gt;
If a Java null is passed to any of the setter methods&lt;br/&gt;
parameter will be set to JDBC NULL.&lt;/p&gt;


&lt;p&gt;According to this content, I think we can remove code to throw exception of dataTypeConversion in &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/browse/DERBY-1938#action_12440800&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/browse/DERBY-1938#action_12440800&lt;/a&gt; .&lt;/p&gt;</comment>
                            <comment id="12440887" author="naka" created="Mon, 9 Oct 2006 14:16:51 +0100"  >&lt;ul&gt;
	&lt;li&gt;Description of the patch&lt;/li&gt;
	&lt;li&gt;Make it possible to setObject(&amp;lt;arg&amp;gt;,null) in embedded and NetClient.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Result of the test&lt;/li&gt;
	&lt;li&gt;Execute derbyall and found no error.&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="12440912" author="djd" created="Mon, 9 Oct 2006 17:19:37 +0100"  >&lt;p&gt;Section 13.2.2.2 does not apply here. Since Java null has no type it cannot be mapped using this rule: &lt;br/&gt;
 &quot;the Java Object mapped using the default mapping for that object type. &quot;&lt;/p&gt;

&lt;p&gt;I think the real justification for changing setObject(col, null) seems be to match other JDBC drivers (which ones?) and/or applications that seem to expect this to work. But there&apos;s liittle evidence of that justification in this thread.&lt;/p&gt;

&lt;p&gt;I think it&apos;s clear that the JDBC spec (from the tutorial) indicates that applications should not depend on this behaviour.&lt;/p&gt;
</comment>
                            <comment id="12440927" author="naka" created="Mon, 9 Oct 2006 18:02:01 +0100"  >&lt;p&gt;I think &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1904&quot; title=&quot;COALESCE with NULL parameter problem&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1904&quot;&gt;&lt;del&gt;DERBY-1904&lt;/del&gt;&lt;/a&gt; suggests to support for setObject(&amp;lt;arg&amp;gt;, null) In the view of other JDBC driver and/or applications ...&lt;/p&gt;

&lt;p&gt;I think it is subtle in spec because 13.2.2.3  observe silent for type of java null ... &lt;/p&gt;</comment>
                            <comment id="12441001" author="naka" created="Mon, 9 Oct 2006 23:47:19 +0100"  >&lt;p&gt;Next information was posted to mailing list.&lt;/p&gt;

&lt;p&gt; The following wording was added to the JDBC 4.0 javadocs to address this issue:&lt;/p&gt;

&lt;p&gt;Note: Not all databases allow for a non-typed Null to be sent to the backend. For maximum portability, the setNull or the setObject(int parameterIndex, Object x, int sqlType) method should be used instead of setObject(int parameterIndex, Object x).&lt;/p&gt;


&lt;p&gt;I think the decision should be deferred and wait for requests ...&lt;/p&gt;</comment>
                            <comment id="12441025" author="dagw" created="Tue, 10 Oct 2006 01:47:43 +0100"  >&lt;p&gt;I googled and found a discussion on this on the mailinglist&lt;br/&gt;
for the Jakarta taglibs project:&lt;/p&gt;

&lt;p&gt;   &lt;a href=&quot;http://www.mail-archive.com/taglibs-user@jakarta.apache.org/msg07198.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/taglibs-user@jakarta.apache.org/msg07198.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This thread (dated; 2004) seems to indicate that at least the jTDS driver for SQL server &lt;br/&gt;
accepts this usage. &lt;/p&gt;

&lt;p&gt;Digging more, the next link says that the behavior is sanctioned an in deed checked &lt;br/&gt;
by the J2EE CTS (the person claims to have consulted former spec lead Jonathan Bruce):&lt;/p&gt;

&lt;p&gt;   &lt;a href=&quot;http://www.mail-archive.com/taglibs-user@jakarta.apache.org/msg06987.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/taglibs-user@jakarta.apache.org/msg06987.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is a link to mail by Lance, indicating the Oracle can also accept this in a &lt;br/&gt;
&quot;CTS compatibility mode&quot;:&lt;/p&gt;

&lt;p&gt;   &lt;a href=&quot;http://www.mail-archive.com/taglibs-user@jakarta.apache.org/msg06997.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.mail-archive.com/taglibs-user@jakarta.apache.org/msg06997.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The JDBC Tutorial books says &quot;no&quot;, the 4.0 API says &quot;OK, but not guaranteed portable&quot;.&lt;br/&gt;
The API is more authoritative than the book, according to Lance.&lt;/p&gt;

&lt;p&gt;Given the above, and that the API is more authoritative than the book, I think it would &lt;br/&gt;
perhaps be OK for Derby to support this in the interest of ease of portability of apps to&lt;br/&gt;
Derby. &lt;/p&gt;

&lt;p&gt;Not my itch, though &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;
</comment>
                            <comment id="12471653" author="kristwaa" created="Fri, 9 Feb 2007 10:52:37 +0000"  >&lt;p&gt;Clearing patch available flag. No activity on this for a long time.&lt;br/&gt;
If anyone feels the itch, please help drive this issue to completion.&lt;br/&gt;
It is not quite clear to me what is actually holding it back, but there seems to be uncertainty on how it resolve the issue.&lt;/p&gt;</comment>
                            <comment id="12706983" author="kmarsden" created="Thu, 7 May 2009 17:38:23 +0100"  >&lt;p&gt;Unassigning due to inactivity. Please reassign yourself if you would like to work on this issue.&lt;/p&gt;</comment>
                            <comment id="12906588" author="pholthuizen" created="Mon, 6 Sep 2010 22:08:58 +0100"  >&lt;p&gt;This is issue has a patch. Is it going to be applied?&lt;/p&gt;</comment>
                            <comment id="12906598" author="knutanders" created="Mon, 6 Sep 2010 22:45:01 +0100"  >&lt;p&gt;If someone is willing to do the work to update the patch so that it applies cleanly on head of trunk, and it passes the tests, I think we could check it in. There was some controversy initially when the patch was contributed, but I agree with Dag&apos;s comment that the JDBC 4.0 API implies that it&apos;s OK for an implementation to accept setObject(&amp;lt;arg&amp;gt;, null), although it&apos;s not required.&lt;/p&gt;</comment>
                            <comment id="12906676" author="pholthuizen" created="Tue, 7 Sep 2010 06:29:06 +0100"  >&lt;p&gt;I think, although the issue is marked as minor, it makes Derby easier to use and therefor may have a positive impact on the adoption of Derby with starters. And as said before it is completely in line with the JDBC 3.0 and 4.0 specification as Dag pointed out.&lt;/p&gt;</comment>
                            <comment id="12906785" author="kristwaa" created="Tue, 7 Sep 2010 13:44:17 +0100"  >&lt;p&gt;Attaching a reworked patch, needs review.&lt;br/&gt;
Awaiting test results (suites.All passed, derbyall still running).&lt;/p&gt;</comment>
                            <comment id="12906795" author="knutanders" created="Tue, 7 Sep 2010 14:41:43 +0100"  >&lt;p&gt;Hi Kristian,&lt;/p&gt;

&lt;p&gt;The patch looks good to me. One small nit: In the modified test case in ParameterMappingTest we could now remove the try/catch and just pass on exceptions up to the JUnit framework.&lt;/p&gt;</comment>
                            <comment id="12907184" author="kristwaa" created="Wed, 8 Sep 2010 13:13:44 +0100"  >&lt;p&gt;Thanks, Knut Anders.&lt;/p&gt;

&lt;p&gt;Attaching a revised patch 1b. More of the existing test could have been modified as well, but I won&apos;t do that.&lt;br/&gt;
derbyall passed with the changes introduced by the patch.&lt;/p&gt;</comment>
                            <comment id="12907197" author="knutanders" created="Wed, 8 Sep 2010 13:43:49 +0100"  >&lt;p&gt;Thanks for the updated patch, Kristian. +1 from me.&lt;/p&gt;</comment>
                            <comment id="12907207" author="dagw" created="Wed, 8 Sep 2010 14:13:24 +0100"  >&lt;p&gt;Thanks for handling this one, guys. +1 from me too.&lt;/p&gt;</comment>
                            <comment id="12907250" author="kristwaa" created="Wed, 8 Sep 2010 16:27:43 +0100"  >&lt;p&gt;Committed patch 1b to trunk with revision 995089.&lt;/p&gt;</comment>
                            <comment id="12907307" author="pholthuizen" created="Wed, 8 Sep 2010 17:55:17 +0100"  >&lt;p&gt;Another thank you from me too.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12346905">DERBY-1610</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12352066">DERBY-1904</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12342574" name="DERBY-1938.patch" size="119813" author="naka" created="Mon, 9 Oct 2006 14:16:51 +0100"/>
                            <attachment id="12454011" name="derby-1938-1a-reworked_patch.diff" size="4354" author="kristwaa" created="Tue, 7 Sep 2010 13:44:17 +0100"/>
                            <attachment id="12454096" name="derby-1938-1b-reworked_patch.diff" size="5728" author="kristwaa" created="Wed, 8 Sep 2010 13:13:44 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 6 Oct 2006 14:13:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30194</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0np3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37657</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>