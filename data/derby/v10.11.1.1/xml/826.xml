<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:21:23 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-826/DERBY-826.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-826] sysinfo does not report the version of derby.jar if the class does not explictly contain it.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-826</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;derby.jar is in the classpath here indirectly because derbynet.jar includes it through a manifest entry.&lt;br/&gt;
java -cp jars/sane/derbynet.jar org.apache.derby.tools.sysinfo&lt;/p&gt;

&lt;p&gt;------------------ Java Information ------------------&lt;br/&gt;
Java Version:    1.4.2&lt;br/&gt;
Java Vendor:     IBM Corporation&lt;br/&gt;
Java home:       C:\Program Files\IBM\Java142\jre&lt;br/&gt;
Java classpath:  jars/sane/derbynet.jar&lt;br/&gt;
OS name:         Windows XP&lt;br/&gt;
OS architecture: x86&lt;br/&gt;
OS version:      5.1&lt;br/&gt;
Java user name:  djd&lt;br/&gt;
Java user home:  C:\Documents and Settings\Administrator&lt;br/&gt;
Java user dir:   c:&amp;#95;work\svn_clean2\trunk&lt;br/&gt;
java.specification.name: Java Platform API Specification&lt;br/&gt;
java.specification.version: 1.4&lt;br/&gt;
--------- Derby Information --------&lt;br/&gt;
JRE - JDBC: J2SE 1.4.2 - JDBC 3.0&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;C:\_work\svn_clean2\trunk\jars\sane\derbynet.jar&amp;#93;&lt;/span&gt; 10.2.0.0 alpha - (370500M)&lt;br/&gt;
------------------------------------------------------&lt;br/&gt;
----------------- Locale Information -----------------&lt;br/&gt;
Current Locale :  [English/United States &lt;span class=&quot;error&quot;&gt;&amp;#91;en_US&amp;#93;&lt;/span&gt;]&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;de_DE&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.2.0.0 alpha - (370500M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;es&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.2.0.0 alpha - (370500M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;fr&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.2.0.0 alpha - (370500M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;it&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.2.0.0 alpha - (370500M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;ja_JP&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.2.0.0 alpha - (370500M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;ko_KR&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.2.0.0 alpha - (370500M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;pt_BR&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.2.0.0 alpha - (370500M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;zh_CN&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.2.0.0 alpha - (370500M)&lt;br/&gt;
Found support for locale: &lt;span class=&quot;error&quot;&gt;&amp;#91;zh_TW&amp;#93;&lt;/span&gt;&lt;br/&gt;
         version: 10.2.0.0 alpha - (370500M)&lt;br/&gt;
------------------------------------------------------&lt;/p&gt;</description>
                <environment></environment>
        <key id="12327847">DERBY-826</key>
            <summary>sysinfo does not report the version of derby.jar if the class does not explictly contain it.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fuzzylogic">Andrew McIntyre</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Jan 2006 03:13:37 +0000</created>
                <updated>Mon, 14 May 2007 23:11:43 +0100</updated>
                            <resolved>Sun, 16 Apr 2006 01:01:46 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12373711" author="fuzzylogic" created="Sat, 8 Apr 2006 12:57:33 +0100"  >&lt;p&gt;This patch attempts to locate the info properties files using getResource() first, and then through the classpath. This allows us to find the info properties files when loaded from mechanisms other than through the classpath, e.g. from the extensions directory, java -jar, the Class-Path attribute, etc. Also added javadoc for the methods that I touched.&lt;/p&gt;

&lt;p&gt;Related to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-668&quot; title=&quot;SysInfo does not print the right information when Derby is not loaded through the classpath.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-668&quot;&gt;&lt;del&gt;DERBY-668&lt;/del&gt;&lt;/a&gt;, this fixes the regular (non -cp) part of that issue.&lt;/p&gt;

&lt;p&gt;I will commit this early next week if there are no concerns.&lt;/p&gt;</comment>
                            <comment id="12374580" author="fuzzylogic" created="Sat, 15 Apr 2006 06:35:23 +0100"  >&lt;p&gt;Thanks for the helpful review, Bryan. &lt;/p&gt;

&lt;p&gt;1 - Yes, I removed this and an unused import from an experiment I had done previously.&lt;/p&gt;

&lt;p&gt;2 &amp;amp; 3 - A great suggestion on 3. I pulled out the formatting code and put it into a new method, formatURL. This also normalizes the path separators in the jar/directory locations, so the duplicates are properly removed for 2.&lt;/p&gt;

&lt;p&gt;4 - Added additional javadoc comments to mergeZips.&lt;/p&gt;

&lt;p&gt;Let me know if you think this needs any more refinement, otherwise I&apos;d like to commit it soon.&lt;/p&gt;</comment>
                            <comment id="12374588" author="bryanpendleton" created="Sat, 15 Apr 2006 08:28:39 +0100"  >&lt;p&gt;Hi Andrew. Thank you for considering all my feedback. Your new patch looks very good to me. I have only one final concern. When I was spot-testing your patch, I noticed that, while the mergeZips method appears to strip duplicates out of zip1 entirely, and it strips out of zip2 any entries that also exist in zip1, it does not strip duplicates which exist twice in zip2.&lt;/p&gt;

&lt;p&gt;For example, try running java -cp derby.jar:db2jcc.jar:db2jcc.jar:derbytools.jar sysinfo. I believe you will see info about db2jcc.jar being printed twice.&lt;/p&gt;

&lt;p&gt;I think this can be fixed by changing the zip2 processing loop in mergeZips so that, when it searches to see if the current entry duplicates an existing entry, it searches the entries in &quot;v&quot;, rather than searching the entries in zip1.&lt;/p&gt;

&lt;p&gt;I&apos;ve attached a proposed version 3 of the patch. The only substantive change between this version and your version is as follows:&lt;/p&gt;

&lt;p&gt;&amp;lt; +            for (int k = 0; k &amp;lt; zip1.length; k++)&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
&amp;gt; +            for (int k = 0; k &amp;lt; v.size(); k++)&lt;br/&gt;
265c265,266&lt;br/&gt;
&amp;lt; +                  if (zip1&lt;span class=&quot;error&quot;&gt;&amp;#91;k&amp;#93;&lt;/span&gt; == null)&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
&amp;gt; +                  ZipInfoProperties z = (ZipInfoProperties)v.get(k);&lt;br/&gt;
&amp;gt; +                  if (z == null)&lt;br/&gt;
267c268&lt;br/&gt;
&amp;lt; +                  if (zip2&lt;span class=&quot;error&quot;&gt;&amp;#91;j&amp;#93;&lt;/span&gt;.getLocation().equals(zip1&lt;span class=&quot;error&quot;&gt;&amp;#91;k&amp;#93;&lt;/span&gt;.getLocation()))&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
&amp;gt; +                  if (zip2&lt;span class=&quot;error&quot;&gt;&amp;#91;j&amp;#93;&lt;/span&gt;.getLocation().equals(z.getLocation()))&lt;/p&gt;
</comment>
                            <comment id="12374603" author="fuzzylogic" created="Sat, 15 Apr 2006 16:26:44 +0100"  >&lt;p&gt;Good catch, Bryan!&lt;/p&gt;

&lt;p&gt;I&apos;m attaching derby-826-v4.diff, which includes your changes plus the following:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;removes the check for z == null in the second loop of mergeZips(). We already checked that elements being added to the vector are not null in the first loop.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;catches possible NullPointerExceptions if loadZipFromResource() returns a null array. This is unlikely, but possible, if somehow sysinfo is able to run but is isolated from the info properties files so that it cannot load them using getResourceAsStream() or they don&apos;t exist. The corresponding diff in getAllInfo() is:&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+        // No info properties files found, but here we are in sysinfo.&lt;br/&gt;
+        // Avoid an NPE in mergeZips by creating a ZipInfoProperties array&lt;br/&gt;
+        // with the location of the sysinfo that is currently executing.&lt;br/&gt;
+        if (zips == null)&lt;br/&gt;
+        &lt;/p&gt;
{
+            zips = new ZipInfoProperties[1];
+            ZipInfoProperties zip = new ZipInfoProperties(ProductVersionHolder.getProductVersionHolderFromMyEnv(org.apache.derby.tools.sysinfo.TOOLS));
+            zip.setLocation(getFileWhichLoadedClass(new Main().getClass()));
+            zips[0] = zip;
+        }

&lt;p&gt;This is looking pretty airtight. Do you see any other potential problems?&lt;/p&gt;</comment>
                            <comment id="12374635" author="bryanpendleton" created="Sat, 15 Apr 2006 22:43:42 +0100"  >&lt;p&gt;&amp;gt; Do you see any other potential problems?&lt;/p&gt;

&lt;p&gt;Nope, this patch looks great; please check this puppy in!&lt;/p&gt;</comment>
                            <comment id="12374648" author="fuzzylogic" created="Sun, 16 Apr 2006 01:01:46 +0100"  >&lt;p&gt;Committed derby-826-v.diff with revision 394334.&lt;/p&gt;</comment>
                            <comment id="12495801" author="djd" created="Mon, 14 May 2007 23:11:43 +0100"  >&lt;p&gt;sysinfo now shows derby.jar information even if it&apos;s not explicitly in the classpath&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12325220">DERBY-668</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12325363" name="derby-826-v3.diff" size="11417" author="bryanpendleton" created="Sat, 15 Apr 2006 08:28:39 +0100"/>
                            <attachment id="12325371" name="derby-826-v4.diff" size="11914" author="fuzzylogic" created="Sat, 15 Apr 2006 16:26:44 +0100"/>
                            <attachment id="12325077" name="derby-826.diff" size="11092" author="fuzzylogic" created="Sat, 8 Apr 2006 12:57:28 +0100"/>
                            <attachment id="12325359" name="derby-826_v2.diff" size="11345" author="fuzzylogic" created="Sat, 15 Apr 2006 06:35:23 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 8 Apr 2006 11:57:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22165</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy12a7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40020</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>