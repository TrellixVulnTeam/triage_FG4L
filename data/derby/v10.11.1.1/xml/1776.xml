<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:13:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1776/DERBY-1776.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1776] ERROR 42Z72: XML syntax error; missing keyword(s): &apos;AS&apos;. - Misleading text</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1776</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;create table t (i int, x xml);&lt;br/&gt;
select xmlserialize&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from t;&lt;/p&gt;

&lt;p&gt;ERROR 42Z72: XML syntax error; missing keyword(s): &apos;AS&apos;.&lt;/p&gt;

&lt;p&gt;This is not an &apos;XML Syntax error&apos;, it&apos;s a syntax in the SQL language. No need to have a special error messgae here, wouldn&apos;t the error be caught by regular parsing?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12348855">DERBY-1776</key>
            <summary>ERROR 42Z72: XML syntax error; missing keyword(s): &apos;AS&apos;. - Misleading text</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="army">A B</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Aug 2006 15:18:30 +0100</created>
                <updated>Thu, 19 Oct 2006 17:26:06 +0100</updated>
                            <resolved>Fri, 22 Sep 2006 19:41:22 +0100</resolved>
                                    <version>10.2.1.6</version>
                    <version>10.3.1.4</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12435586" author="army" created="Mon, 18 Sep 2006 23:00:02 +0100"  >&lt;p&gt;&amp;gt; wouldn&apos;t the error be caught by regular parsing?&lt;/p&gt;

&lt;p&gt;Yes, regular parsing would catch this and other SQL/XML-related syntax errors, but the error message is somewhat unhelpful--I can&apos;t remember exactly, but it&apos;s something like&lt;/p&gt;

&lt;p&gt;  &quot;Encountered &apos;)&apos; at line x column y.&quot;&lt;/p&gt;

&lt;p&gt;And while it&apos;s true that a user could eventually figure it out, I thought that, given the high number of required keywords for the SQL/XML operators, it&apos;d be more user friendly to actually provide a hint as to what was really missing.  When you consider that the SQL/XML syntax tends to be rather wordy and that SQL/XML operators are often used one on top of the other (ex. XMLSERIALIZE (XMLQUERY(...)...), it&apos;s pretty easy to end up with long lines of query--and frankly, I as a user found myself getting impatient trying to figure out which operator was missing what keyword.  So I created 42Z72.&lt;/p&gt;

&lt;p&gt;I guess one option is to remove that message altogether and let the user count lines and columns to find out where the unexpected &apos;)&apos; is and what it&apos;s supposed to be.  But instead of that, I&apos;d rather just reword the error message to address the fact that this is &quot;not an XML syntax error, it&apos;s a syntax in the SQL language&quot;.  Maybe something like:&lt;/p&gt;

&lt;p&gt;ERROR 42Z72: Missing SQL/XML keyword(s): &apos;AS&apos;. &lt;/p&gt;

&lt;p&gt;Does that seem like an acceptable approach?&lt;/p&gt;</comment>
                            <comment id="12435590" author="djd" created="Mon, 18 Sep 2006 23:07:57 +0100"  >&lt;p&gt;Yes, though the loss of the line and column number is a shame.&lt;br/&gt;
Be useful to know how you implemented this, so that other more helpful messages could be added in the future.&lt;br/&gt;
Maybe add to the wiki?&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/db-derby/LanguageSystem&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/db-derby/LanguageSystem&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12435608" author="army" created="Tue, 19 Sep 2006 00:45:43 +0100"  >&lt;p&gt;Well, after that paragraph of justification, it turns out that there are only three places where we use the 42Z79 SQLSTATE.  But still, I think it&apos;s a useful error message and should be kept around; it could come in handy further down the road if SQL/XML functionality is expanded.&lt;/p&gt;

&lt;p&gt;As for line/column numbers, it turns out that those values are readily available from within sqlgrammar.jj and thus can easily be passed as part of the error message.  The only potential downside that I can see is that we have to create an Integer object out of the line/col numbers in order to pass them to the StandardException constructor...but maybe that&apos;s not a big deal...?  The fact that no one has done this earlier makes me wonder if there&apos;s some &quot;gotcha&quot; here that I&apos;m missing, but I haven&apos;t seen any problems with it just yet...&lt;/p&gt;

&lt;p&gt;Attaching a patch d1776_v1.patch that changes the error message for 42Z79 as mentioned in my previous comment and also does the following:&lt;/p&gt;

&lt;p&gt;  1. Adds line and column numbers to the error message to indicate where&lt;br/&gt;
     the missing keyword is expected.&lt;/p&gt;

&lt;p&gt;  2. Removes one &quot;lookahead&quot; call that was causing 42Z79 to be raised&lt;br/&gt;
     for a missing &quot;AS&quot; keyword when in fact the keyword was present&lt;br/&gt;
     (what was missing was the datatype).  To avoid confusion, I&lt;br/&gt;
     removed the lookahead and now the user will see a more generic&lt;br/&gt;
     42X01 error in that particular case.&lt;/p&gt;

&lt;p&gt;  3. Updated xml_general master files accordingly.&lt;/p&gt;

&lt;p&gt;So with this patch applied, instead of:&lt;/p&gt;

&lt;p&gt; select xmlserialize&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from t;&lt;br/&gt;
 ERROR 42Z72: XML syntax error; missing keyword(s): &apos;AS&apos;. &lt;/p&gt;

&lt;p&gt;we&apos;ll now see:&lt;/p&gt;

&lt;p&gt; create table t (i int, x xml);&lt;br/&gt;
 ERROR 42Z72: Missing SQL/XML keyword(s) &apos;AS&apos; at line 1, column 22.&lt;/p&gt;

&lt;p&gt;I ran xmlSuite with this patch and all of the tests passed.  I haven&apos;t run derbyall yet and I don&apos;t expect any failures (since the changes are theoretically limited to XML) but I will try to run it tonight just for sanity.  In the meantime, review comments would be great.&lt;/p&gt;</comment>
                            <comment id="12435907" author="army" created="Tue, 19 Sep 2006 16:45:43 +0100"  >&lt;p&gt;derbyall on Windows 2000 with ibm142 against sane jars ran with no new failures.  So this patch is ready for review/commit.&lt;/p&gt;</comment>
                            <comment id="12436091" author="mikem" created="Wed, 20 Sep 2006 03:38:37 +0100"  >&lt;p&gt;reviewed and committed patch as is to trunk.  It can be merged to 10.2.&lt;/p&gt;

&lt;p&gt;Well, after that paragraph of justification, it turns out that there are only three places where we use the 42Z79 SQLSTATE. But still, I think it&apos;s a useful error message and should be kept around; it could come in handy further down the road if SQL/XML functionality is expanded.&lt;/p&gt;

&lt;p&gt;As for line/column numbers, it turns out that those values are readily available from within sqlgrammar.jj and thus can easily be passed as part of the error message. The only potential downside that I can see is that we have to create an Integer object out of the line/col numbers in order to pass them to the StandardException constructor...but maybe that&apos;s not a big deal...? The fact that no one has done this earlier makes me wonder if there&apos;s some &quot;gotcha&quot; here that I&apos;m missing, but I haven&apos;t seen any problems with it just yet...&lt;/p&gt;

&lt;p&gt;Attaching a patch d1776_v1.patch that changes the error message for 42Z79 as mentioned in my previous comment and also does the following:&lt;/p&gt;

&lt;p&gt;  1. Adds line and column numbers to the error message to indicate where&lt;br/&gt;
     the missing keyword is expected.&lt;/p&gt;

&lt;p&gt;  2. Removes one &quot;lookahead&quot; call that was causing 42Z79 to be raised&lt;br/&gt;
     for a missing &quot;AS&quot; keyword when in fact the keyword was present&lt;br/&gt;
     (what was missing was the datatype). To avoid confusion, I&lt;br/&gt;
     removed the lookahead and now the user will see a more generic&lt;br/&gt;
     42X01 error in that particular case.&lt;/p&gt;

&lt;p&gt;  3. Updated xml_general master files accordingly.&lt;/p&gt;

&lt;p&gt;So with this patch applied, instead of:&lt;/p&gt;

&lt;p&gt; select xmlserialize&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from t;&lt;br/&gt;
 ERROR 42Z72: XML syntax error; missing keyword(s): &apos;AS&apos;.&lt;/p&gt;

&lt;p&gt;we&apos;ll now see:&lt;/p&gt;

&lt;p&gt; create table t (i int, x xml);&lt;br/&gt;
 ERROR 42Z72: Missing SQL/XML keyword(s) &apos;AS&apos; at line 1, column 22. &lt;/p&gt;</comment>
                            <comment id="12436265" author="army" created="Wed, 20 Sep 2006 16:58:09 +0100"  >&lt;p&gt;In a review comment for a different issue someone mentioned that instead of creating new Integer() objects it&apos;d be better to use the Derby ReuseFactory where possible to avoid excessive object creation.  I get the feeling that&apos;s not a big deal with the _v1 patch for this issue, but I nonetheless thought it&apos;d be a good idea to follow that advice with the changes.&lt;/p&gt;

&lt;p&gt;So I&apos;m attaching a tiny patch, d1776_reuseInt.patch, that replaces the calls to &quot;new Integer()&quot; in the _v1 patch (which has already  been committed) with calls to ReuseFactory.getInteger().  Functionally, the patch doesn&apos;t change anything.&lt;/p&gt;

&lt;p&gt;I ran xmlSuite on Windows 2000 with ibm142 and all tests passed.&lt;/p&gt;</comment>
                            <comment id="12436956" author="fuzzylogic" created="Fri, 22 Sep 2006 19:41:22 +0100"  >&lt;p&gt;Marking resolved, merged to 10.2 branch with revision 449013. &lt;/p&gt;</comment>
                            <comment id="12443568" author="army" created="Thu, 19 Oct 2006 17:26:06 +0100"  >&lt;p&gt;Changes in trunk and 10.2 and no further comments, so closing the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12341223" name="d1776_reuseInt.patch" size="1365" author="army" created="Wed, 20 Sep 2006 16:58:09 +0100"/>
                            <attachment id="12341091" name="d1776_v1.patch" size="7538" author="army" created="Tue, 19 Sep 2006 00:45:43 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 18 Sep 2006 22:00:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22698</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy144v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40320</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>