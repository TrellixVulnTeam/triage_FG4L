<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:40:04 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1675/DERBY-1675.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1675] Network Server should not send to client that it supports EUSRIDPWD when running against Sun JVM</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1675</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;As part of ACCSECRD, if the server does not accept the security mechanism sent by the client,  the server will send a list of security mechanism that it supports. Currently even when the server is running with sun jvm,  it will still send EUSRIDPWD as a sec mec that it supports, which is incorrect. The server should test if it can support EUSRIDPWD dynamically  and if it does, only then send EURRIDPWD as an option that it supports.&lt;/p&gt;

&lt;p&gt;see DRDAConnThread.writeACCSECRD(int)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12347810">DERBY-1675</key>
            <summary>Network Server should not send to client that it supports EUSRIDPWD when running against Sun JVM</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="skambha">Sunitha Kambhampati</assignee>
                                    <reporter username="skambha">Sunitha Kambhampati</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Aug 2006 19:27:02 +0100</created>
                <updated>Fri, 15 Sep 2006 22:55:17 +0100</updated>
                            <resolved>Fri, 15 Sep 2006 21:55:34 +0100</resolved>
                                    <version>10.0.2.0</version>
                    <version>10.0.2.1</version>
                    <version>10.1.1.0</version>
                    <version>10.1.2.1</version>
                    <version>10.1.3.1</version>
                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Network Server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12433162" author="skambha" created="Thu, 7 Sep 2006 17:33:49 +0100"  >&lt;p&gt;EUSRIDPWD support depends on the JCE available in the classpath of the server&lt;/p&gt;

&lt;p&gt;This patch(derby1675.diff.txt) does the following&lt;br/&gt;
1. Add code to check if server jvm can support EUSRIDPWD.  &lt;br/&gt;
2. Throw an error if the derby.drda.securityMechanism is set to ENCRYPTED_USER_AND_PASSWORD_SECURITY &lt;br/&gt;
and if the server jvm cannot support EUSRIDPWD.&lt;br/&gt;
3. Server sends the client the list of supported security mechanisms as part of ACCSECRD. Now, the server will correctly only send EUSRIDPWD as an option if the running server can support this security mechanism.&lt;/p&gt;

&lt;p&gt;Test related changes:&lt;br/&gt;
Changes were made to testProtocol.java and a new method readSecMecAndSECCHKCD is added to TestProto to read the SECMEC and SECCHKCD values.  Note, that with ibm142 and ibm15 jvms that support eusridpwd, the SECMEC value 9 (eusridpwd) will be sent as part of the ACCSECRD response. But for the jvms that dont support the eusridpwd, the SECMEC value of 9 wont be sent. The new method readSecMecAndSECCHKCD takes &lt;br/&gt;
care of printing out the SECMEC values that are sent by the server - this results in the need for a new master file for the jvm that support eusridpwd and the jvm that cannot support it.  A new master file has been added for ibm14.&lt;/p&gt;

&lt;p&gt;Tests for codepath that covers #2 is already present in testSecMec.java. This results in themaster updates for the jvms that do not support eusridpwd for the case where server is started with&lt;br/&gt;
derby..drda.securityMechanism=ENCRYPTED_USER_AND_PASSWORD_SECURITY.&lt;/p&gt;


&lt;p&gt;derbyall ran ok on ibm142/linux with two known intermittent failures(NSInSameJVM and DerbyNetAutoStart)&lt;/p&gt;

&lt;p&gt;I ran testSecMec on win2k/t40laptop/ on ibm jvm 131,142,15 as well as sun jvm 131,142,15. Also have updated masters for jcc versions 2.4,2.6,2.8.&lt;/p&gt;

&lt;p&gt;Can someone please review this change. &lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;
</comment>
                            <comment id="12433180" author="forsini" created="Thu, 7 Sep 2006 18:57:23 +0100"  >&lt;p&gt;Am reviewing the changes - I have changes in similar code areas (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1517&quot; title=&quot;Derby Network Client to handle list of SECMEC(s) returned by existing/released DRDA Derby Network Servers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1517&quot;&gt;DERBY-1517&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="12433441" author="mikem" created="Fri, 8 Sep 2006 17:53:32 +0100"  >&lt;p&gt;I ran full set of tests against this patch on XP, sun jdk 1.42 and passed except for 2 known intermittent errors in &lt;br/&gt;
testProperties and DerbyNetNewServer&lt;/p&gt;</comment>
                            <comment id="12433501" author="mikem" created="Fri, 8 Sep 2006 22:37:11 +0100"  >&lt;p&gt;francois do you have any initial comments on the change?  tests passed for me and they look reasonable but would prefer to get review of someone experienced in this code.  I can work on committing this today or tommorow, but after that I will be away for a week.  This seems like something that would be nice to get into 10.2.&lt;/p&gt;</comment>
                            <comment id="12433535" author="forsini" created="Sat, 9 Sep 2006 01:41:16 +0100"  >&lt;p&gt;Here are my comments.&lt;/p&gt;

&lt;p&gt;Very good changes indeed Sunitha. My comments are ONLY minor ones. Mostly recommendations with some of the comments, etc.&lt;/p&gt;

&lt;p&gt;1) java/drda/org/apache/derby/impl/drda/NetworkServerControlImpl.java&lt;/p&gt;

&lt;p&gt;A) Static block:&lt;/p&gt;

&lt;p&gt;+    // Sun JCE does not have support for EUSRIDPWD, whereas&lt;br/&gt;
+    // most versions of IBM JCE have support for this.  Hence&lt;br/&gt;
+    // find out if the server can support EUSRIDPWD.&lt;/p&gt;

&lt;p&gt;Minor nit but EUSRIDPWD is not part of the JVM - It is just that some JCE provider(s) may not have DH support with a Prime of 32-bytes. I &lt;/p&gt;

&lt;p&gt;would have phrased this differently, such as:&lt;/p&gt;

&lt;p&gt;    // DRDA Specification for the EUSRIDPWD security mechanism&lt;br/&gt;
    // requires DH algorithm support with a 32-byte prime to be&lt;br/&gt;
    // used. Not all JCE implementations have support for this.&lt;br/&gt;
    // Hence here we need to find out if EUSRIDPWD can be used&lt;br/&gt;
    // with the current JVM.&lt;/p&gt;

&lt;p&gt;Again, this is just my recommendation to phrase this differently - Take it or leave it &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;+    /**&lt;br/&gt;
+     * EUSRIDPWD support depends on the availability of the&lt;br/&gt;
+     * algorithm in the JCE implementation in the classpath &lt;br/&gt;
+     * of the server. At runtime, information about this &lt;br/&gt;
+     * capability is figured out.  &lt;br/&gt;
+     * @return whether EUSRIDPWD is supported or not&lt;br/&gt;
+     */&lt;/p&gt;

&lt;p&gt;B) supportsEUSRIDPWD():&lt;/p&gt;

&lt;p&gt;Here I would have just put the following comments:&lt;/p&gt;

&lt;p&gt;    /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;This method returns whether EUSRIDPWD security mechanism&lt;/li&gt;
	&lt;li&gt;is supported or not. See class static block for more&lt;/li&gt;
	&lt;li&gt;info.&lt;/li&gt;
	&lt;li&gt;@return true if EUSRIDPWD is supported, falso otherwise&lt;br/&gt;
     */&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think you need 1 more CR (line space before the next getIntPropVal())&lt;/p&gt;

&lt;p&gt;2) +++ java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/protocol.tests&lt;/p&gt;

&lt;p&gt;-readScalar2Bytes SECMEC 3// SECMEC&lt;br/&gt;
-readScalar2Bytes SECMEC 9// SECMEC&lt;br/&gt;
-readScalar2Bytes SECMEC 4// SECMEC&lt;br/&gt;
-readScalar2Bytes SECMEC 8// SECMEC&lt;br/&gt;
-readScalar1Byte SECCHKCD 1// SECMEC&lt;br/&gt;
+readSecMecAndSECCHKCD // read secmec values and secchkcd&lt;/p&gt;

&lt;p&gt;We&apos;re loosing the returned list to check here but I guess it is not obvious to have this protocol test driver behave conditionally based on the JVM being run, etc...since there is no canon&apos;s for this test if am not mistaken...Anyway, too much of a big deal I&apos;d say.&lt;/p&gt;

&lt;p&gt;I have also tested the patch with Solaris / jdk 1.5 ...&lt;/p&gt;

&lt;p&gt;Cheers.&lt;/p&gt;</comment>
                            <comment id="12433537" author="skambha" created="Sat, 9 Sep 2006 01:58:18 +0100"  >&lt;p&gt;Thanks Francois  for your comments.   &lt;/p&gt;

&lt;p&gt;&amp;gt; &quot;We&apos;re loosing the returned list to check here&quot;&lt;/p&gt;

&lt;p&gt;Wrt to #2,  We are not losing the returned list to check since the readSecMecAndSECCHKCD method prints the secmec that it receives.  Actually that was the reason, I had to print the values in readSecMecAndSECCHKCD. &lt;/p&gt;

&lt;p&gt;Thus we have two different cannons, which is why the testProtocol.out was added for ibm14.&lt;/p&gt;

&lt;p&gt;So if you look at the diff for testProtocol.out ,  for e.g.,  you will see this. &lt;br/&gt;
......&lt;br/&gt;
Test trying security mechanism we don&apos;t support&lt;br/&gt;
+SECMEC=3 SECMEC=4 SECMEC=8 SECCHKCD=1&lt;/p&gt;

&lt;p&gt;In case for ibm142 (new masterfile that got added), you would see &lt;br/&gt;
+Test trying security mechanism we don&apos;t support&lt;br/&gt;
+SECMEC=3 SECMEC=9 SECMEC=4 SECMEC=8 SECCHKCD=1&lt;/p&gt;

&lt;p&gt;Do you agree ? or am I missing something in your comment. &lt;/p&gt;

&lt;p&gt;I like your suggestion for  the comments in the code. I&apos;ll make that change.&lt;/p&gt;

&lt;p&gt;Thanks. &lt;/p&gt;</comment>
                            <comment id="12433539" author="forsini" created="Sat, 9 Sep 2006 02:07:48 +0100"  >&lt;p&gt;Oops - Yes this is right - I actually checked the canon&apos;s - nevermind Sunitha &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12433543" author="mikem" created="Sat, 9 Sep 2006 02:33:30 +0100"  >&lt;p&gt;I committed the submitted patch (derby1675.diff.txt) to the trunk as requested by Sunitha and given the minor&lt;br/&gt;
nature of the reviewers comments  -thanks Francois for the quick review.&lt;br/&gt;
Go ahead and post&lt;br/&gt;
the follow up comment change patch to this issue.  This 2 step process actually works better for&lt;br/&gt;
me as I can easily scan the second patch and if it is only comments won&apos;t need to run any other tests to &lt;br/&gt;
feel ok to commit.&lt;/p&gt;

&lt;p&gt;m1_142:6&amp;gt;svn commit&lt;/p&gt;

&lt;p&gt;Sending        java\drda\org\apache\derby\impl\drda\DRDAConnThread.java&lt;br/&gt;
Sending        java\drda\org\apache\derby\impl\drda\NetworkServerControlImpl.java&lt;br/&gt;
Sending        java\drda\org\apache\derby\impl\drda\TestProto.java&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\master\DerbyNet\jdk14\ver2.8\testSecMec.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\master\DerbyNet\testSecMec.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\master\DerbyNet\ver2.6\testSecMec.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\master\DerbyNet\ver2.8\testSecMec.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\master\DerbyNetClient\jdk14\testSecMec.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\master\DerbyNetClient\testSecMec.out&lt;br/&gt;
Adding         java\testing\org\apache\derbyTesting\functionTests\master\ibm14&lt;br/&gt;
Adding         java\testing\org\apache\derbyTesting\functionTests\master\ibm14\testProtocol.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\master\testProtocol.out&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\derbynet\protocol.tests&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\derbynet\testSecMec.java&lt;br/&gt;
Transmitting file data .............&lt;br/&gt;
Committed revision 441722.&lt;/p&gt;</comment>
                            <comment id="12433559" author="skambha" created="Sat, 9 Sep 2006 05:13:11 +0100"  >&lt;p&gt;Thanks Mike for the commit for derby1675.diff.txt. &lt;/p&gt;

&lt;p&gt;I am attaching a followup  patch  derby1675.comments.diff.txt . &lt;br/&gt;
This patch only has change in comments. &lt;/p&gt;

&lt;p&gt;svn stat&lt;br/&gt;
M      java\drda\org\apache\derby\impl\drda\NetworkServerControlImpl.java&lt;/p&gt;

&lt;p&gt;Can someone please commit this patch.  Thanks. &lt;/p&gt;</comment>
                            <comment id="12433595" author="knutanders" created="Sat, 9 Sep 2006 12:23:26 +0100"  >&lt;p&gt;Committed derby1675.comments.diff.txt into trunk with revision 441779.&lt;/p&gt;</comment>
                            <comment id="12434214" author="skambha" created="Tue, 12 Sep 2006 17:54:46 +0100"  >&lt;p&gt;Thanks Knut for the commit.  I am leaving this issue open till this fix goes into 10.2.&lt;/p&gt;</comment>
                            <comment id="12435116" author="skambha" created="Fri, 15 Sep 2006 21:55:34 +0100"  >&lt;p&gt;This fix is backported to 10.2 as part of the mega merge effort.  Thanks Rick.&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=446679&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;rev=446679&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12348522">DERBY-1755</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12340495" name="derby1675.comments.diff.txt" size="1778" author="skambha" created="Sat, 9 Sep 2006 05:13:11 +0100"/>
                            <attachment id="12340395" name="derby1675.diff.txt" size="75555" author="skambha" created="Thu, 7 Sep 2006 17:33:49 +0100"/>
                            <attachment id="12340394" name="derby1675.stat.txt" size="1208" author="skambha" created="Thu, 7 Sep 2006 17:33:49 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 7 Sep 2006 17:57:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30101</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy14mf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40399</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>