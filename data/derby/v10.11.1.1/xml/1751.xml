<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:09:24 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1751/DERBY-1751.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1751] derbynet/testSecMec.java fails with ShutdownException in DerbyNetClient framework</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1751</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;During 10.2.1.0 beta testing this test failed with org.apache.derby.iapi.services.context.ShutdownException on 2 of 4 platforms running Solaris zones:&lt;/p&gt;

&lt;p&gt;Platform &quot;sparc_zone2&quot;:&lt;br/&gt;
    derbynetclientmats/derbynetmats/DerbyNetClient/derbynetmats/testSecMec.diff&lt;/p&gt;

&lt;p&gt;Platform &quot;sparc_zone3&quot;:&lt;br/&gt;
    derbynetclientmats/derbynetmats/DerbyNetClient/derbynetmats/testSecMec.diff&lt;br/&gt;
    derbyall/derbynetclientmats/DerbyNetClient/derbynetmats/derbynetmats/testSecMec.diff&lt;/p&gt;

&lt;p&gt;The test did not fail on other platforms, which may indicate timing sensitivity (tests are run concurrently in 4 zones (1 global, 3 local) on one single machine). Here is one of the diffs (from platform &quot;sparc_zone2&quot;):&lt;/p&gt;


&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbynetclientmats/derbynetmats/DerbyNetClient/derbynetmats/testSecMec.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: testSecMec jdk1.6.0-rc DerbyNetClient derbynetmats:derbynetmats 2006-08-14 21:31:48 ***&lt;br/&gt;
308a309,312&lt;br/&gt;
&amp;gt; java.sql.SQLException: Java exception: &apos;: org.apache.derby.iapi.services.context.ShutdownException&apos;.&lt;br/&gt;
&amp;gt; 	... 14 more----------------------------------------------&lt;br/&gt;
&amp;gt; Testing with derby.drda.securityMechanism=INVALID_VALUE&lt;br/&gt;
&amp;gt; EXPECTED EXCEPTION DRDA_InvalidValue.U:Invalid value, INVALID_VALUE, for derby.drda.securityMechanism.&lt;br/&gt;
310,312d313&lt;br/&gt;
&amp;lt; Testing with derby.drda.securityMechanism=INVALID_VALUE&lt;br/&gt;
&amp;lt; EXPECTED EXCEPTION DRDA_InvalidValue.U:Invalid value, INVALID_VALUE, for derby.drda.securityMechanism.&lt;br/&gt;
&amp;lt; -----&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   testSecMec jdk1.6.0-rc DerbyNetClient derbynetmats:derbynetmats 2006-08-14 21:32:54 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;The failure occurred in the DerbyNetClient framework when shutting down the database for the second (and last) time in the method testUSRSSBPWD_with_BUILTIN(). This test method was added August 9, 2006 (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-528&quot; title=&quot;Support for DRDA Strong User ID and Password Substitute Authentication (USRSSBPWD) scheme&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-528&quot;&gt;&lt;del&gt;DERBY-528&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Attatching derby.log from the failure in derbynetclientmats/derbynetmats on sparc_zone2.&lt;/p&gt;
</description>
                <environment>JVM: Sun JDK 6 (build 1.6.0-rc-b95)&lt;br/&gt;
OS: Solaris 10 (sparc) local zones&lt;br/&gt;
Hardware: Sun Fire V210 Server, 2 x 1000 MHz CPU</environment>
        <key id="12348473">DERBY-1751</key>
            <summary>derbynet/testSecMec.java fails with ShutdownException in DerbyNetClient framework</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="fernanda">Fernanda Pizzorno</assignee>
                                    <reporter username="johnemb">John H. Embretsen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Aug 2006 14:21:45 +0100</created>
                <updated>Mon, 29 Jun 2009 23:57:57 +0100</updated>
                            <resolved>Mon, 25 Sep 2006 14:06:26 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.2.0</fixVersion>
                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12433649" author="knutanders" created="Sat, 9 Sep 2006 22:41:57 +0100"  >&lt;p&gt;This test and many others fail intermittently this way because they start a network server within the test itself. Since the server is running in the same process as the test, harmless exceptions (caused by the database engine shutting down at the same time as one of the server threads is closing a connection) are printed together with the test output. Since these tests are not testing engine shutdown behaviour, they should ignore server output.&lt;/p&gt;

&lt;p&gt;The network server is started like this:&lt;br/&gt;
  networkServer = new NetworkServerControl(InetAddress.getByName(hostName),NETWORKSERVER_PORT);&lt;br/&gt;
  networkServer.start(null);&lt;/p&gt;

&lt;p&gt;The null argument given to start() means that console output should be disabled. However, it doesn&apos;t disable all output. Some of the consolePrint* methods print exceptions to System.err when the console is null. The only way to make the server completely silent, is to set the console printer to a stream which just throws away all output. Something like:&lt;/p&gt;

&lt;p&gt;  PrintWriter pw = new PrintWriter(new OutputStream() { public void write(int b) { } });&lt;br/&gt;
  networkServer.start(pw);&lt;/p&gt;</comment>
                            <comment id="12433651" author="bryanpendleton" created="Sat, 9 Sep 2006 23:08:45 +0100"  >&lt;p&gt;This sounds quite similar to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-273&quot; title=&quot;The derbynet/dataSourcePermissions_net.java test fails intermittently&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-273&quot;&gt;&lt;del&gt;DERBY-273&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12433735" author="bryanpendleton" created="Sun, 10 Sep 2006 21:08:52 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1114&quot; title=&quot;derbynet/testSecMec.java fails intermittently and test exits mysteriously when server is shutdown as part of the testrun.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1114&quot;&gt;&lt;del&gt;DERBY-1114&lt;/del&gt;&lt;/a&gt; also seems relevant to this issue. It seems like&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-273&quot; title=&quot;The derbynet/dataSourcePermissions_net.java test fails intermittently&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-273&quot;&gt;&lt;del&gt;DERBY-273&lt;/del&gt;&lt;/a&gt;,  &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1114&quot; title=&quot;derbynet/testSecMec.java fails intermittently and test exits mysteriously when server is shutdown as part of the testrun.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1114&quot;&gt;&lt;del&gt;DERBY-1114&lt;/del&gt;&lt;/a&gt;, and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1751&quot; title=&quot;derbynet/testSecMec.java fails with ShutdownException in DerbyNetClient framework&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1751&quot;&gt;&lt;del&gt;DERBY-1751&lt;/del&gt;&lt;/a&gt; should all be&lt;br/&gt;
considered as an &quot;ongoing thread&quot; of issues with this particular test.&lt;/p&gt;</comment>
                            <comment id="12435859" author="rhillegas" created="Tue, 19 Sep 2006 16:13:48 +0100"  >&lt;p&gt;Moving to 10.2.2.0.&lt;/p&gt;</comment>
                            <comment id="12436504" author="fernanda" created="Thu, 21 Sep 2006 12:10:09 +0100"  >&lt;p&gt;The attached patch (derby-1751.diff) avoids the problem seen in this issue by setting the console output of the network server to a file. This change in made to the following files:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;java/testing/org/apache/derbyTesting/functionTests/tests/jdbc4/TestConnectionMethods.java&lt;/li&gt;
	&lt;li&gt;java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/testSecMec.java&lt;/li&gt;
	&lt;li&gt;java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/dataSourcePermissions_net.java&lt;/li&gt;
	&lt;li&gt;java/testing/org/apache/derbyTesting/junit/NetworkServerTestSetup.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;It also changes DRDAProtocolException so that agent Errors will be printed to the network server console intead of System.out.&lt;/p&gt;

&lt;p&gt;I have successfully run derbyall with this patch, and I have verified that shutdown exceptions do not cause the test to fail with this patch. Can someone please review it?&lt;/p&gt;

&lt;p&gt;Thank you in advance!&lt;/p&gt;</comment>
                            <comment id="12436616" author="knutanders" created="Thu, 21 Sep 2006 20:32:56 +0100"  >&lt;p&gt;Hi Fernanda,&lt;/p&gt;

&lt;p&gt;Derbyall passed on JVM 1.5, but the jdbc40 suite (DerbyNetClient, JVM 1.6 b99) failed:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file jdbc40/DerbyNetClient/jdbc40/TestConnectionMethods.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: TestConnectionMethods jdk1.6.0-rc DerbyNetClient jdbc40:jdbc40 2006-09-21 20:18:10 ***&lt;br/&gt;
0 add&lt;br/&gt;
&amp;gt; INFO: Network server shutdown returned: java.lang.NullPointerException&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   TestConnectionMethods jdk1.6.0-rc DerbyNetClient jdbc40:jdbc40 2006-09-21 20:18:19 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Could this be related to your patch?&lt;/p&gt;</comment>
                            <comment id="12436675" author="bryanpendleton" created="Thu, 21 Sep 2006 23:20:28 +0100"  >&lt;p&gt;I haven&apos;t reviewed your patch, but wonder: it sounds like the approach&lt;br/&gt;
you are taking here is very similar to that taken for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-273&quot; title=&quot;The derbynet/dataSourcePermissions_net.java test fails intermittently&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-273&quot;&gt;&lt;del&gt;DERBY-273&lt;/del&gt;&lt;/a&gt;. Is that&lt;br/&gt;
true? Can you compare and constrast the approach taken in this issue&lt;br/&gt;
with the one in that issue, as that might assist reviewers who were involved&lt;br/&gt;
in that issue with their review of this issue. Thanks!&lt;/p&gt;</comment>
                            <comment id="12436791" author="fernanda" created="Fri, 22 Sep 2006 09:42:15 +0100"  >&lt;p&gt;I forgot to run the jdbc40 suite, sorry. Thanks for catching this error Knut Anders. I am attaching a new patch (derby-1751v2.diff) were the problem is fixed.&lt;/p&gt;</comment>
                            <comment id="12436795" author="fernanda" created="Fri, 22 Sep 2006 09:55:50 +0100"  >&lt;p&gt;Hi Bryan,&lt;/p&gt;

&lt;p&gt;The approach I am taking in this patch is similar to the approach &lt;br/&gt;
taken in Derby-273. The difference is that the approach I am &lt;br/&gt;
taking will set the NetworkServer&apos;s console output to a file when &lt;br/&gt;
the server is started and the output will continue to be to the &lt;br/&gt;
same file until the server is closed. The approach taken on &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-273&quot; title=&quot;The derbynet/dataSourcePermissions_net.java test fails intermittently&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-273&quot;&gt;&lt;del&gt;DERBY-273&lt;/del&gt;&lt;/a&gt; was to set the output to a file right before shutting &lt;br/&gt;
down the server. This not sufficient to prevent the test from &lt;br/&gt;
failing due to a shut down exception because these exceptions &lt;br/&gt;
do not happen only when the server is shut down, they can also&lt;br/&gt;
happen when the engine is shut down (connection with the property&lt;br/&gt;
shutdown=true).&lt;/p&gt;

&lt;p&gt;Fernanda&lt;/p&gt;</comment>
                            <comment id="12436894" author="bryanpendleton" created="Fri, 22 Sep 2006 16:49:24 +0100"  >&lt;p&gt;Thanks Fernanda for the explanation. Your patch is certainly&lt;br/&gt;
simpler than the previous technique and it is nice to see all&lt;br/&gt;
that test code get simpler. I guess I am a little bit concerned&lt;br/&gt;
that this technique might cause us to miss important messages&lt;br/&gt;
in the server output, but I don&apos;t have anything better to suggest&lt;br/&gt;
right now. +1 from me for this patch.&lt;/p&gt;</comment>
                            <comment id="12437546" author="knutanders" created="Mon, 25 Sep 2006 14:06:26 +0100"  >&lt;p&gt;Thanks to Fernanda for fixing the problem and to Bryan for reviewing the patch.&lt;br/&gt;
Committed v2 into trunk with revision 449671, and into 10.2 with revision 449674.&lt;/p&gt;</comment>
                            <comment id="12441115" author="johnemb" created="Tue, 10 Oct 2006 11:38:15 +0100"  >&lt;p&gt;I have not observed any related failures lately (although I have not seen any test results from Solaris Zones platforms yet, and the platform is not available to me at the moment) so I have confidene that this issue has been fixed. I am closing the issue, thanks for resolving!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12327439">DERBY-803</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12330262">DERBY-1114</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12339412" name="ASF.LICENSE.NOT.GRANTED--derby.log" size="63818" author="johnemb" created="Wed, 23 Aug 2006 14:21:46 +0100"/>
                            <attachment id="12341282" name="derby-1751.diff" size="14699" author="fernanda" created="Thu, 21 Sep 2006 12:10:09 +0100"/>
                            <attachment id="12341283" name="derby-1751.stat" size="505" author="fernanda" created="Thu, 21 Sep 2006 12:10:09 +0100"/>
                            <attachment id="12341364" name="derby-1751v2.diff" size="14759" author="fernanda" created="Fri, 22 Sep 2006 09:42:15 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 9 Sep 2006 21:41:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22682</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0von:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38951</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>