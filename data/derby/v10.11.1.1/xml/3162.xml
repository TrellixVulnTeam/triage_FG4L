<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:19:37 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3162/DERBY-3162.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3162] Create a framework for replication tests</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3162</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Handle&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;starting and stopping Derby servers to have the master and slave replication roles,&lt;/li&gt;
	&lt;li&gt;doing administrative commands like startreplication, startslave, stopreplication, failover,&lt;/li&gt;
	&lt;li&gt;performing consistency checks on the slave vs. the master,&lt;/li&gt;
	&lt;li&gt;running load clients against master and slave in the various states of replication,&lt;/li&gt;
	&lt;li&gt;provoking error situations on master and slave, and network,&lt;/li&gt;
	&lt;li&gt;...&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12381453">DERBY-3162</key>
            <summary>Create a framework for replication tests</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12381451">DERBY-3161</parent>
                                    <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="olesolberg">Ole Solberg</assignee>
                                    <reporter username="olesolberg">Ole Solberg</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Oct 2007 14:42:03 +0000</created>
                <updated>Fri, 4 Apr 2008 15:40:48 +0100</updated>
                            <resolved>Fri, 4 Apr 2008 15:40:48 +0100</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12540690" author="olesolberg" created="Wed, 7 Nov 2007 07:35:36 +0000"  >&lt;p&gt;First version of a a framework for running replication tests.&lt;/p&gt;


&lt;p&gt;Depends on derby-3163.1-v1.diff.txt.&lt;/p&gt;

&lt;p&gt;+ java/testing/org/apache/derbyTesting/functionTests/tests/replicationTests/ReplicationRun.java&lt;/p&gt;

&lt;p&gt;+ java/testing/org/apache/derbyTesting/functionTests/tests/replicationTests/build.xml&lt;/p&gt;

&lt;p&gt;M java/testing/build.xml:&lt;br/&gt;
+  	&amp;lt;ant dir=&quot;$&lt;/p&gt;
{derby.testing.src.dir}
&lt;p&gt;/$&lt;/p&gt;
{derby.testing.functest.dir}
&lt;p&gt;/tests/replicationTests&quot;/&amp;gt; &lt;/p&gt;</comment>
                            <comment id="12573272" author="olesolberg" created="Thu, 28 Feb 2008 13:27:02 +0000"  >&lt;p&gt;New patch for replication test framework and tests.&lt;br/&gt;
This patch combines and extends the previous patches on 3162 AND 3164 in ONE new patch.&lt;/p&gt;

&lt;p&gt;This patch makes it possible to run replication tests with master and slave servers on localhost.&lt;br/&gt;
This variant, as implemented in the JUnit test o.a.dT.fT.tests.replicationTests.ReplicationRun_Local, does NOT depend on a propertyfile to specify hosts, ports, testhosts etc.&lt;/p&gt;

&lt;p&gt;ReplicationRun_Local will run a small set of existing JUnit tests against the master server/database and as such is an initial regression test for replication.&lt;/p&gt;

&lt;p&gt;The set of existing JUnit tests will be extended, and tests on behaviour of a replicated system in the different states of replication will be added in coming patches.&lt;/p&gt;
</comment>
                            <comment id="12573638" author="oysteing" created="Fri, 29 Feb 2008 08:49:52 +0000"  >&lt;p&gt;I tried to run the ReplicationRun_Local test, but in order for it to&lt;br/&gt;
run, I had to manually create the directories db_master and db_slave&lt;br/&gt;
for the test to run.&lt;/p&gt;

&lt;p&gt;Since this patch does not affect people not working on replication, I&lt;br/&gt;
suggest that I commit the patch more or less as it is, and then we can&lt;br/&gt;
do I more thorough review afterwards.&lt;/p&gt;

&lt;p&gt;Some initial comments based on a quick look at parts of the patch:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I assume you did not intend to include the build.xml.orig file.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Do you intend to document ReplicationRun_Local in&lt;br/&gt;
   README.runningTests?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I did not understand the following line in README.runningTests:&lt;br/&gt;
      cd &amp;lt;testing dir&amp;gt;/ # $
{user.dir}&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;README.framework seems a bit out of date&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Some general observations:&lt;/li&gt;
	&lt;li&gt;Several classes has a lot of unused imports.&lt;/li&gt;
	&lt;li&gt;Many very long lines&lt;/li&gt;
	&lt;li&gt;For some classes I miss an initial javadoc that explains the&lt;br/&gt;
      purpose of the class.&lt;/li&gt;
	&lt;li&gt;As far as I know, there should be only one exception per @throws&lt;br/&gt;
      tag.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12573641" author="narayanan" created="Fri, 29 Feb 2008 09:06:53 +0000"  >
&lt;p&gt; &amp;gt; Several classes has a lot of unused imports.&lt;/p&gt;

&lt;p&gt;IDE&apos;s (I use Netbeans) support a fix imports feature that automatically &lt;br/&gt;
removes the&lt;br/&gt;
imports that are not used. Since these are new classes that are &lt;br/&gt;
introduced you could use&lt;br/&gt;
this feature safely without any fear of generating diffs that may be &lt;br/&gt;
unrelated to your feature.&lt;/p&gt;</comment>
                            <comment id="12573747" author="oysteing" created="Fri, 29 Feb 2008 14:02:09 +0000"  >&lt;p&gt;I have looked a bit closer at the ReplicationRun class, and I have&lt;br/&gt;
some comments.  Note, however, as I said in my previous comment, if&lt;br/&gt;
you like, I can commit the existing patch and you can work on the&lt;br/&gt;
improvements in follow-up patches.  Some comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I must admit that it took me some time to understand how I should&lt;br/&gt;
   go about to add new tests, but if I understand it correctly, the&lt;br/&gt;
   way to do it is to subclass ReplicationRun for my test class and&lt;br/&gt;
   use the methods of ReplicationRun to initiate replication.  I miss&lt;br/&gt;
   some instructions on how to go about writing new tests in this&lt;br/&gt;
   framework.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I feel it is a bit confusing that ReplicationRun seems to be both a&lt;br/&gt;
   framework and a test.  I think it would be better if the methods&lt;br/&gt;
   used to perform replication operations were separated from actual&lt;br/&gt;
   test cases.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I also think it would be a good idea to separate the code for&lt;br/&gt;
   testing with localhost from the code for testing with master and&lt;br/&gt;
   slaves on different hosts.  In other words, I suggest having two&lt;br/&gt;
   classes (with a common base class), one for local testing and one&lt;br/&gt;
   for distributed testing both implementing the same set of methods&lt;br/&gt;
   like startServer, initMaster etc.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I miss some documentation of all the static fields in&lt;br/&gt;
   ReplicationRun.  &lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Many of the fields are both initialized when they are declared and&lt;br/&gt;
   in initEnvironment.  It seems a bit errorprone to duplicate this.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Why is masterServerHost etc. set to localhost in ReplicationRun?  I&lt;br/&gt;
   thought that was supposed to be behavior that were specific to&lt;br/&gt;
   ReplicationRun_Local.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I think the classes Utils and State should be given more specific&lt;br/&gt;
   names.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I think it is a source of confusion that both ReplicationRun and&lt;br/&gt;
   its inner class State contains a method called initEnvironment.  By&lt;br/&gt;
   the way, the State does not currently seem to be in use.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Some unused imports: FileChannel, Inet6Address, JDBC&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I am not sure it is a good idea to import whole packages.  At&lt;br/&gt;
   least for java.util, Properties seems to be the only class used.&lt;br/&gt;
   Why not import just that class.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The freezeDB string is empty.  Note that you still need to freeze&lt;br/&gt;
   the database when replication is started.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Some comments have references to PoC.  I guess that is obsolete.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Does masterServer and slaveServer need to be declared at class&lt;br/&gt;
   level?  They seem to be local to the test case when they are used.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Why implement setUp and tearDown when they only call the&lt;br/&gt;
   corresponding method in the super class?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The file name README.properties is a bit awkward since IDEs and&lt;br/&gt;
   other tools may think it is a properties file, which it is not.&lt;/li&gt;
&lt;/ul&gt;




</comment>
                            <comment id="12573764" author="olesolberg" created="Fri, 29 Feb 2008 14:32:37 +0000"  >&lt;p&gt;Thanks &#216;ystein for reviewing this!&lt;/p&gt;

&lt;p&gt;&amp;gt; &#216;ystein Gr&#248;vlen commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3162&quot; title=&quot;Create a framework for replication tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3162&quot;&gt;&lt;del&gt;DERBY-3162&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
&amp;gt; ----------------------------------------&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; I tried to run the ReplicationRun_Local test, but in order for it to&lt;br/&gt;
&amp;gt; run, I had to manually create the directories db_master and db_slave&lt;br/&gt;
&amp;gt; for the test to run.&lt;/p&gt;

&lt;p&gt;I missed that one, probably because I have been running in the same dirs all the time so it was always there...&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt; Since this patch does not affect people not working on replication, I&lt;br/&gt;
&amp;gt; suggest that I commit the patch more or less as it is, and then we can&lt;br/&gt;
&amp;gt; do I more thorough review afterwards.&lt;/p&gt;

&lt;p&gt;I would appreciate that. It will probably make it easier to incrementally do all the required enhancements and fixes pointed out below.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt; Some initial comments based on a quick look at parts of the patch:&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt;  - I assume you did not intend to include the build.xml.orig file.&lt;/p&gt;

&lt;p&gt;Can&apos;t find that in my sandbox!&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - Do you intend to document ReplicationRun_Local in&lt;br/&gt;
&amp;gt;    README.runningTests?&lt;/p&gt;

&lt;p&gt;I will.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - I did not understand the following line in README.runningTests:&lt;br/&gt;
&amp;gt;       cd &amp;lt;testing dir&amp;gt;/ # $&lt;/p&gt;
{user.dir}&lt;br/&gt;
I&apos;ll clean that up (I probably meant that ${user.dir}
&lt;p&gt; would be &amp;lt;testing dir&amp;gt;.)&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - README.framework seems a bit out of date&lt;/p&gt;

&lt;p&gt;Will fix.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - Some general observations:&lt;br/&gt;
&amp;gt;     - Several classes has a lot of unused imports.&lt;br/&gt;
&amp;gt;     - Many very long lines&lt;br/&gt;
&amp;gt;     - For some classes I miss an initial javadoc that explains the&lt;br/&gt;
&amp;gt;       purpose of the class.&lt;br/&gt;
&amp;gt;     - As far as I know, there should be only one exception per @throws&lt;br/&gt;
&amp;gt;       tag.&lt;br/&gt;
&amp;gt; &lt;/p&gt;



&lt;p&gt;&amp;gt; &#216;ystein Gr&#248;vlen commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3162&quot; title=&quot;Create a framework for replication tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3162&quot;&gt;&lt;del&gt;DERBY-3162&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
&amp;gt; ----------------------------------------&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; I have looked a bit closer at the ReplicationRun class, and I have&lt;br/&gt;
&amp;gt; some comments.  Note, however, as I said in my previous comment, if&lt;br/&gt;
&amp;gt; you like, I can commit the existing patch and you can work on the&lt;br/&gt;
&amp;gt; improvements in follow-up patches.  Some comments:&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt;  - I must admit that it took me some time to understand how I should&lt;br/&gt;
&amp;gt;    go about to add new tests, but if I understand it correctly, the&lt;br/&gt;
&amp;gt;    way to do it is to subclass ReplicationRun for my test class and&lt;br/&gt;
&amp;gt;    use the methods of ReplicationRun to initiate replication.  I miss&lt;br/&gt;
&amp;gt;    some instructions on how to go about writing new tests in this&lt;br/&gt;
&amp;gt;    framework.&lt;/p&gt;

&lt;p&gt;Yes, that is the intention. I agree instructions should be enhanced.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - I feel it is a bit confusing that ReplicationRun seems to be both a&lt;br/&gt;
&amp;gt;    framework and a test.  I think it would be better if the methods&lt;br/&gt;
&amp;gt;    used to perform replication operations were separated from actual&lt;br/&gt;
&amp;gt;    test cases.&lt;/p&gt;

&lt;p&gt;The test part should be removed.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - I also think it would be a good idea to separate the code for&lt;br/&gt;
&amp;gt;    testing with localhost from the code for testing with master and&lt;br/&gt;
&amp;gt;    slaves on different hosts.  In other words, I suggest having two&lt;br/&gt;
&amp;gt;    classes (with a common base class), one for local testing and one&lt;br/&gt;
&amp;gt;    for distributed testing both implementing the same set of methods&lt;br/&gt;
&amp;gt;    like startServer, initMaster etc.&lt;/p&gt;

&lt;p&gt;Yes, when looking at this now I tend to agree. I started out creating the framework (and test) for the distributed case and the &quot;localhost case&quot; was added later.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - I miss some documentation of all the static fields in&lt;br/&gt;
&amp;gt;    ReplicationRun.  &lt;/p&gt;

&lt;p&gt;Will add.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - Many of the fields are both initialized when they are declared and&lt;br/&gt;
&amp;gt;    in initEnvironment.  It seems a bit errorprone to duplicate this.&lt;/p&gt;

&lt;p&gt;Thanks for pointing this out - I have stared too long at this code alone I guess &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt;  - Why is masterServerHost etc. set to localhost in ReplicationRun?  I&lt;br/&gt;
&amp;gt;    thought that was supposed to be behavior that were specific to&lt;br/&gt;
&amp;gt;    ReplicationRun_Local.&lt;/p&gt;

&lt;p&gt;Ditto.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - I think the classes Utils and State should be given more specific&lt;br/&gt;
&amp;gt;    names.&lt;/p&gt;

&lt;p&gt;Will fix.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - I think it is a source of confusion that both ReplicationRun and&lt;br/&gt;
&amp;gt;    its inner class State contains a method called initEnvironment.  By&lt;br/&gt;
&amp;gt;    the way, the State does not currently seem to be in use.&lt;/p&gt;

&lt;p&gt;Will clean up this.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - Some unused imports: FileChannel, Inet6Address, JDBC&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt;  - I am not sure it is a good idea to import whole packages.  At&lt;br/&gt;
&amp;gt;    least for java.util, Properties seems to be the only class used.&lt;br/&gt;
&amp;gt;    Why not import just that class.&lt;/p&gt;

&lt;p&gt;Thanks for pointing this out.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - The freezeDB string is empty.  Note that you still need to freeze&lt;br/&gt;
&amp;gt;    the database when replication is started.&lt;/p&gt;

&lt;p&gt;Will clean up.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - Some comments have references to PoC.  I guess that is obsolete.&lt;/p&gt;

&lt;p&gt;Will clean up.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - Does masterServer and slaveServer need to be declared at class&lt;br/&gt;
&amp;gt;    level?  They seem to be local to the test case when they are used.&lt;/p&gt;

&lt;p&gt;Thanks for pointing this out.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - Why implement setUp and tearDown when they only call the&lt;br/&gt;
&amp;gt;    corresponding method in the super class?&lt;/p&gt;

&lt;p&gt;Thanks for pointing this out.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  - The file name README.properties is a bit awkward since IDEs and&lt;br/&gt;
&amp;gt;    other tools may think it is a properties file, which it is not.&lt;/p&gt;

&lt;p&gt;Thanks! did not think of that!&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;/p&gt;

</comment>
                            <comment id="12573820" author="oysteing" created="Fri, 29 Feb 2008 16:36:12 +0000"  >&lt;p&gt;Patch v2 committed as revision 632371.&lt;br/&gt;
Looking forward to follow-up patches with discussed improvements.&lt;/p&gt;</comment>
                            <comment id="12573860" author="djd" created="Fri, 29 Feb 2008 17:37:15 +0000"  >&lt;p&gt;Is this a new framework for executing tests or just a way of having junit tests that test replication?&lt;/p&gt;

&lt;p&gt;From README.runningTests it seems it is the latter, which is good.&lt;/p&gt;

&lt;p&gt;Any reason why the tests need to start with no security manager set as a property instead of using the no security manager decorator. Then the test would be self contained like any other test.&lt;/p&gt;</comment>
                            <comment id="12573913" author="olesolberg" created="Fri, 29 Feb 2008 19:23:15 +0000"  >&lt;p&gt;This is a way of having junit tests that test replication.&lt;/p&gt;

&lt;p&gt;Starting with no security manager set as a property is really &quot;old habit&quot; by me..... Will look into using the no security manager decorator.&lt;br/&gt;
Thanks for the hint!&lt;/p&gt;</comment>
                            <comment id="12574588" author="olesolberg" created="Mon, 3 Mar 2008 16:10:47 +0000"  >&lt;p&gt;Patch derby-3162.3-v1 for replication test framework.&lt;/p&gt;

&lt;p&gt;1. Handle that startMaster now correctly gets &quot;XRE04&quot; while slave is not yet ready after startSlave.&lt;/p&gt;

&lt;p&gt;2. Create &lt;/p&gt;
{user.dir}
&lt;p&gt;/&lt;span class=&quot;error&quot;&gt;&amp;#91;db_master|db_slave&amp;#93;&lt;/span&gt; if not existing.&lt;/p&gt;

&lt;p&gt;3. Start servers via rt.exec().&lt;/p&gt;

&lt;p&gt;4. New ReplicationRun_Full which handles the distributed case with replication state tests&lt;br/&gt;
    and optional load on servers.&lt;/p&gt;
</comment>
                            <comment id="12574720" author="army" created="Mon, 3 Mar 2008 20:10:05 +0000"  >&lt;p&gt;A few javadoc warnings that have arisen from commits for this issue:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;javadoc&amp;#93;&lt;/span&gt; java\testing\org\apache\derbyTesting\functionTests\tests\replicationTests\Utils.java:62: warning - @return tag cannot be used in method with void return type.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;javadoc&amp;#93;&lt;/span&gt; java\testing\org\apache\derbyTesting\functionTests\tests\replicationTests\Utils.java:135: warning - @return tag cannot be used in method with void return type.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;javadoc&amp;#93;&lt;/span&gt; java\testing\org\apache\derbyTesting\functionTests\tests\replicationTests\Utils.java:147: warning - @param argument &quot;srcPath&quot; is not a parameter name.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;javadoc&amp;#93;&lt;/span&gt; java\testing\org\apache\derbyTesting\functionTests\tests\replicationTests\Utils.java:147: warning - @param argument &quot;destPath&quot; is not a parameter name.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;javadoc&amp;#93;&lt;/span&gt; java\testing\org\apache\derbyTesting\functionTests\tests\replicationTests\Utils.java:147: warning - @return tag cannot be used in method with void return type.&lt;/p&gt;</comment>
                            <comment id="12574869" author="olesolberg" created="Tue, 4 Mar 2008 07:43:25 +0000"  >&lt;p&gt;New patch 3162.3-v2, as 3162.3-v1, plus fixes for Javadoc warnings.&lt;/p&gt;</comment>
                            <comment id="12574900" author="oysteing" created="Tue, 4 Mar 2008 09:52:13 +0000"  >&lt;p&gt;Ole, thanks for the follow-up patch.  I have some comments:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;ReplicationRun#startServer_direct: You have several attempts to set&lt;br/&gt;
   the same properties.  I think that is a bit confusing to the&lt;br/&gt;
   reader.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;ReplicationRun_Full:&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;suite() does addTestSuite(ReplicationRun.class).  Is that the&lt;br/&gt;
     right class?  (Trying to run the class indicates that it is not.)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Lots of unecessary imports.  Only the junit packages seems to be&lt;br/&gt;
     needed.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;No need to override setUp and tearDown when they only call the&lt;br/&gt;
     overridden method.&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="12574928" author="olesolberg" created="Tue, 4 Mar 2008 10:52:08 +0000"  >&lt;p&gt;&#216;ystein, thanks for your comments.&lt;/p&gt;

&lt;p&gt;Patch 3162.3-v3 should handle your comments on ReplicationRun#startServer_direct and ReplicationRun_Full.&lt;/p&gt;

&lt;p&gt;I will treat similar problems in other classes in follow up patches. Thanks again!&lt;/p&gt;
</comment>
                            <comment id="12574970" author="oysteing" created="Tue, 4 Mar 2008 13:08:31 +0000"  >&lt;p&gt;Committed patch derby-3162.3-v3.diff.txt as revision 633466.&lt;/p&gt;</comment>
                            <comment id="12575691" author="olesolberg" created="Thu, 6 Mar 2008 13:16:26 +0000"  >&lt;p&gt;Patch 3162.3-v4 for testing replication:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Added tests for checking replication command behaviour in&lt;br/&gt;
  different states of replication.&lt;br/&gt;
  (ReplicationRun_Local_StateTest_part*)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Added &apos;ReplicationSuite.suite()&apos; at end of .../suites/All.java.&lt;br/&gt;
  That is, the replication test will be run as part of suites.All.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;replication tests now uses &apos;SecurityManagerSetup.noSecurityManager()&apos;.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;changed replication test trace output to use Utils.DEBUG().&lt;br/&gt;
  Can be turned on by &apos;-Dderby.tests.repltrace=true&apos;.&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="12575703" author="olesolberg" created="Thu, 6 Mar 2008 13:39:59 +0000"  >&lt;p&gt;Patch derby-3162.3-v4b replaces derby-3162.3-v4.&lt;/p&gt;

&lt;p&gt;Had forgotten to enable part of a test that would fail without &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3358&quot; title=&quot;After an incorrect(unsuccesfull) startMaster comand, further correct startMaster attempts also fail.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3358&quot;&gt;&lt;del&gt;DERBY-3358&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12576072" author="olesolberg" created="Fri, 7 Mar 2008 08:21:32 +0000"  >&lt;p&gt;Patch 3162.3-v4c replaces 3162.3-v4b: enabling more test cases in TestPreStartedMaster.&lt;/p&gt;</comment>
                            <comment id="12576223" author="olesolberg" created="Fri, 7 Mar 2008 15:00:09 +0000"  >&lt;p&gt;Patch 3162.3-v4d replaces 3162.3-v4c:&lt;/p&gt;

&lt;p&gt;Added tests for the replication state after failover has been done.&lt;/p&gt;</comment>
                            <comment id="12576279" author="oysteing" created="Fri, 7 Mar 2008 17:14:02 +0000"  >&lt;p&gt;Thanks for the new tests, Ole.  I have committed the derby-3162.3-v4d.diff.txt patch as revision 634734.&lt;/p&gt;

&lt;p&gt;I think there is quite a few things that needs to be cleaned up, but I am still committing this as I think  the tests are useful, and I have checked that it does not break the regression tests.  I have not have time to verify that all state changes are covered, and I hope that other people could join in verifying this.&lt;/p&gt;

&lt;p&gt;Some initial comments/questions:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;When I run the junit regression test, I get the directories from&lt;br/&gt;
   the replication tests in the current directory.  Most tests write&lt;br/&gt;
   to the system directory.  (I know this is not the only test that&lt;br/&gt;
   violates this)&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Why is not the replication suite put in the suites package like all&lt;br/&gt;
   other suites?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;What would it take to run the replication tests with the security&lt;br/&gt;
   manager? &lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;I would prefer if the tests were given more meaningful names?&lt;br/&gt;
   part1a and part1b does not tell me very much what has been tested.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Why is there only one test case per class?  Would it not make sense&lt;br/&gt;
   to put all state tests into the same class?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Why has not part2 of the stat tests been added to the test suite?&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;I had hoped that the same test classes could be used both for running&lt;br/&gt;
   locally and distributed, and that a property/parameter was used to&lt;br/&gt;
   determine how to run it.  How much work will it be to enable that.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;What is the purpose of testReplication_CleanUp?  It seems to only&lt;br/&gt;
   stop servers.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;All the methods with multiple parameters that all uses defaults,&lt;br/&gt;
   makes the tests less readable.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;I suggest using assertSQLState to check that the expected exception&lt;br/&gt;
   occurs.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12576322" author="olesolberg" created="Fri, 7 Mar 2008 18:48:41 +0000"  >&lt;p&gt;Thanks &#216;ystein, for your comments and committing the patch!&lt;/p&gt;

&lt;p&gt;&amp;gt; &#216;ystein Gr&#248;vlen updated &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3162&quot; title=&quot;Create a framework for replication tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3162&quot;&gt;&lt;del&gt;DERBY-3162&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
&amp;gt; -----------------------------------&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt;     Derby Info:   (was: &lt;span class=&quot;error&quot;&gt;&amp;#91;Patch Available&amp;#93;&lt;/span&gt;)&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; Thanks for the new tests, Ole.  I have committed the derby-3162.3-v4d.diff.txt patch as revision 634734.&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt; I think there is quite a few things that needs to be cleaned up, but I am still committing this as I think  the tests are useful, and I have checked that it does not break the regression tests.  I have not have time to verify that all state changes are covered, and I hope that other people could join in verifying this.&lt;/p&gt;

&lt;p&gt;There is definitly quite some cleanup that needs to be done on theses tests and framework.&lt;br/&gt;
Your comments are all valid and useful!&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt; Some initial comments/questions:&lt;br/&gt;
&amp;gt; &lt;br/&gt;
&amp;gt;  * When I run the junit regression test, I get the directories from&lt;br/&gt;
&amp;gt;    the replication tests in the current directory.  Most tests write&lt;br/&gt;
&amp;gt;    to the system directory.  (I know this is not the only test that&lt;br/&gt;
&amp;gt;    violates this)&lt;/p&gt;

&lt;p&gt;I will fix this.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  * Why is not the replication suite put in the suites package like all&lt;br/&gt;
&amp;gt;    other suites?&lt;/p&gt;

&lt;p&gt;I will fix this.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  * What would it take to run the replication tests with the security&lt;br/&gt;
&amp;gt;    manager? &lt;/p&gt;

&lt;p&gt;I must admit I have to investigate that.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  * I would prefer if the tests were given more meaningful names?&lt;br/&gt;
&amp;gt;    part1a and part1b does not tell me very much what has been tested.&lt;/p&gt;

&lt;p&gt;I agree.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  * Why is there only one test case per class?  Would it not make sense&lt;br/&gt;
&amp;gt;    to put all state tests into the same class?&lt;/p&gt;

&lt;p&gt;I think that should be done.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  * Why has not part2 of the stat tests been added to the test suite?&lt;/p&gt;

&lt;p&gt;But I think it is:&lt;br/&gt;
From ReplicationSuite:&lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
		suite.addTest(ReplicationRun_Local_StateTest_part1_3.suite());&lt;/p&gt;

&lt;p&gt;		suite.addTest(ReplicationRun_Local_StateTest_part2.suite());&lt;br/&gt;
.&lt;/p&gt;


&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  * I had hoped that the same test classes could be used both for running&lt;br/&gt;
&amp;gt;    locally and distributed, and that a property/parameter was used to&lt;br/&gt;
&amp;gt;    determine how to run it.  How much work will it be to enable that.&lt;/p&gt;

&lt;p&gt;That is he intention. The framework and tests were initially written for and run&lt;br/&gt;
in a distributed context.&lt;/p&gt;

&lt;p&gt;This patch has only been tested for running locally, and was specifically&lt;br/&gt;
meant to be useable for running the replication tests as part of suites.All.&lt;/p&gt;

&lt;p&gt;For the distributed case the selection of server hosts, test to run etc. &lt;br/&gt;
are specified in a property file.&lt;br/&gt;
There should not be much work to (re)enable that.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  * What is the purpose of testReplication_CleanUp?  It seems to only&lt;br/&gt;
&amp;gt;    stop servers.&lt;/p&gt;

&lt;p&gt;It is currently not used, should be removed.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  * All the methods with multiple parameters that all uses defaults,&lt;br/&gt;
&amp;gt;    makes the tests less readable.&lt;/p&gt;

&lt;p&gt;I agree.&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;br/&gt;
&amp;gt;  * I suggest using assertSQLState to check that the expected exception&lt;br/&gt;
&amp;gt;    occurs.&lt;/p&gt;

&lt;p&gt;I will change to that - I actually knew it were available so I should have used it!&lt;/p&gt;

&lt;p&gt;&amp;gt; &lt;/p&gt;</comment>
                            <comment id="12576500" author="olesolberg" created="Sat, 8 Mar 2008 06:58:49 +0000"  >&lt;p&gt;The patch derby-3162.4-v1 fixes the &apos;StringIndexOutOfBoundsException&apos; seen on Windows&lt;br/&gt;
in the ReplicationSuite tests.&lt;/p&gt;</comment>
                            <comment id="12576518" author="olesolberg" created="Sat, 8 Mar 2008 09:54:18 +0000"  >&lt;p&gt;Patch derby-3162.4-v2 replaces derby-3162.4-v1:&lt;/p&gt;

&lt;p&gt;This patch fixes some stupid classpath / pathSeparator problems which&lt;br/&gt;
also showed up on Windows.&lt;/p&gt;


&lt;p&gt;I do however still have trouble running the tests on Windows:&lt;/p&gt;

&lt;p&gt;I am seeing messages like &apos;Warning: UnknkownHostException: OLESO-FERRARI: OLESO-FERRARI.&apos;&lt;br/&gt;
in connection with  InetAddress.getByName(hostName) in ReplicationRun.pingServer.&lt;/p&gt;


&lt;p&gt;The patch therefore comments out the replication suite from suites.All.&lt;/p&gt;

&lt;p&gt;&apos;org.apache.derbyTesting.functionTests.tests.replicationTests.ReplicationSuite&apos; must thus be run &lt;br/&gt;
separatly.&lt;/p&gt;


&lt;p&gt;I am sorry for the inconvenience &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12576548" author="narayanan" created="Sat, 8 Mar 2008 14:59:04 +0000"  >&lt;p&gt;&amp;gt;I am seeing messages like &apos;Warning: UnknkownHostException: OLESO-FERRARI: OLESO-FERRARI.&apos;&lt;br/&gt;
&amp;gt;in connection with InetAddress.getByName(hostName) in ReplicationRun.pingServer.&lt;/p&gt;

&lt;p&gt;I checked the ping code, seems harmless and also seems to conform to what NetworkServerControl&lt;br/&gt;
comments asks you to do&lt;/p&gt;

&lt;p&gt;ping code -&lt;/p&gt;

&lt;p&gt;ping( new NetworkServerControl(InetAddress.getByName(hostName),port), iterations);&lt;/p&gt;

&lt;p&gt;NetworkServerControl comments -&lt;/p&gt;

&lt;p&gt;This is an example of starting and shutting down the Network Server in the example&lt;br/&gt;
above with the API.&lt;/p&gt;

&lt;p&gt;NetworkServerControl serverControl = new NetworkServerControl(InetAddress.getByName(&quot;myhost&quot;),1621)&lt;br/&gt;
serverControl.shutdown();&lt;/p&gt;

&lt;p&gt;Looks like a lookup failure in windows to me,&lt;/p&gt;

&lt;p&gt;I am not sure that your code is at fault.&lt;/p&gt;</comment>
                            <comment id="12577008" author="olesolberg" created="Mon, 10 Mar 2008 14:33:40 +0000"  >&lt;p&gt;Patch derby-3162.4-v3 replaces derby-3162.4-v2.&lt;/p&gt;

&lt;p&gt;This patch uses the complete classpath without attempting to run with a minimal classpath when starting servers etc.&lt;/p&gt;

&lt;p&gt;I have successfully run ReplicationSuite against jar files AND against class files.&lt;/p&gt;

&lt;p&gt;The patch still disables ReplicationSuite.suite() in suites.All.&lt;/p&gt;</comment>
                            <comment id="12577023" author="oysteing" created="Mon, 10 Mar 2008 15:00:50 +0000"  >&lt;p&gt;Thanks, Ole.  Patch derby-3162.4-v3 committed as revision 635575.&lt;/p&gt;</comment>
                            <comment id="12577027" author="jorgenlo" created="Mon, 10 Mar 2008 15:15:54 +0000"  >&lt;p&gt;I encountered an issue with the classpath. I use this setup in all my sandboxes:&lt;/p&gt;

&lt;p&gt;sandbox&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8211; test&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;#8211; oldharness&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;   `-- junit&lt;br/&gt;
`-- trunk&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;


&lt;p&gt;When I run the replication test suite from the junit directory with classpath=../../trunk/jars/sane, I get a &lt;/p&gt;

&lt;p&gt;java.lang.NoClassDefFoundError: org/apache/derby/drda/NetworkServerControl&lt;/p&gt;

&lt;p&gt;If I replace the classpath with the absolute path ( /home/.../trunk/jars/sane), the problem goes away.&lt;/p&gt;</comment>
                            <comment id="12578185" author="olesolberg" created="Thu, 13 Mar 2008 08:33:33 +0000"  >&lt;p&gt;Patch derby-3162.5-v1 fixes several problems wrt. classpath, running on Windows, incorrect master or slave database path.&lt;/p&gt;

&lt;p&gt;I ran ReplicationSuite (with jvm 1.6) on&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Linux: w/jars, w/classes&lt;/li&gt;
	&lt;li&gt;Solaris: w/jars&lt;/li&gt;
	&lt;li&gt;Windows: w/jars&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;The problem with relative classpath is not yet resolved.&lt;/p&gt;

&lt;p&gt;I am seeing hangs when running with jvm 1.5, 1.4. Will create JIRAs for this.&lt;/p&gt;</comment>
                            <comment id="12578451" author="oysteing" created="Thu, 13 Mar 2008 19:04:47 +0000"  >&lt;p&gt;Patch derby-3162.5-v1.diff.txt  committed as revision 636837.&lt;/p&gt;</comment>
                            <comment id="12578480" author="oysteing" created="Thu, 13 Mar 2008 20:26:32 +0000"  >&lt;p&gt;Patch derby-3162.5-v1.diff.txt merge to 10.4 branch as revision 636864.&lt;/p&gt;</comment>
                            <comment id="12579815" author="olesolberg" created="Tue, 18 Mar 2008 12:02:21 +0000"  >&lt;p&gt;Patch 3162.6-v1 for replicationtests:&lt;/p&gt;

&lt;p&gt;Fix to allow ReplicationSuite to run on JVM 1.4 and 1.5:&lt;/p&gt;

&lt;p&gt;The replicationTest framework (ReplicationRun) used Drivermanager.getConnection() &lt;br/&gt;
to do startMaster=true and startSlave=true concurrently.&lt;br/&gt;
On 1.5 (and 1.4), but not on 1.6, it turned out that this caused a deadlock (on DriverManager.class?).&lt;/p&gt;

&lt;p&gt;Using DataSource instead of DriverManager solved the problem.&lt;/p&gt;

&lt;p&gt;Big thanks to Kristian Waagan who helped analyzing this!&lt;/p&gt;



&lt;p&gt;The patch has been tested on&lt;br/&gt;
Linux:   jars: 1.4, 1.5, 1.6. classes: 1.4, 1.5, 1.6&lt;br/&gt;
Solaris: jars: 1.4, 1.5, 1.6&lt;br/&gt;
Windows: jars: 1.4, 1.5, 1.6&lt;/p&gt;</comment>
                            <comment id="12580397" author="dyret" created="Wed, 19 Mar 2008 15:08:02 +0000"  >&lt;p&gt;This issue has 10.5 as fixversion. Should it not be 10.4?&lt;/p&gt;</comment>
                            <comment id="12581632" author="oysteing" created="Mon, 24 Mar 2008 18:35:17 +0000"  >&lt;p&gt;Patch 6 committed at revision 640506&lt;/p&gt;</comment>
                            <comment id="12581820" author="olesolberg" created="Tue, 25 Mar 2008 08:08:10 +0000"  >&lt;p&gt;Changed fix version to 10.4&lt;/p&gt;</comment>
                            <comment id="12582285" author="oysteing" created="Wed, 26 Mar 2008 13:41:23 +0000"  >&lt;p&gt;Patch 6 merged to 10.4 branch at revision 641302.&lt;/p&gt;</comment>
                            <comment id="12582557" author="olesolberg" created="Thu, 27 Mar 2008 09:08:59 +0000"  >&lt;p&gt;Patch derby-3162.8_v1_post641328 for replication testing.&lt;/p&gt;

&lt;p&gt;Main topics of this patch are&lt;br/&gt;
A:  make replication tests run when starting with a &lt;br/&gt;
    relative path for classpath. (2.1 and 2.5 below.)&lt;br/&gt;
B:  Enable ReplicationSuite in suites.All (3. below)&lt;/p&gt;


&lt;p&gt;1. java/testing/org/apache/derbyTesting/functionTests/tests/replicationTests/ReplicationSuite.java&lt;br/&gt;
 .1  Added ReplicationRun_Local_1.suite() which does a simple consistency test&lt;br/&gt;
     on contents in master and slave db&apos;s after replication.&lt;/p&gt;

&lt;p&gt;2. java/testing/org/apache/derbyTesting/functionTests/tests/replicationTests/ReplicationRun.java&lt;br/&gt;
 .1 Set user.dir and derby.system.home correctly when starting servers.&lt;br/&gt;
    (StartServer())&lt;br/&gt;
 .2 Minor cleanup on detecting we are running in a &quot;localhost&quot; environment.&lt;br/&gt;
 .3 Cleanup some DEBUG.&lt;br/&gt;
 .4 Do master and slave verification directly from the ReplicationRun VM.&lt;br/&gt;
    (verifySlave(), verifyMaster())&lt;br/&gt;
 .5 Set user.dir correctly when running existing JUnit tests as&lt;br/&gt;
    &quot;replication load&quot;.&lt;br/&gt;
    (runUserCommandLocally())&lt;/p&gt;

&lt;p&gt;3. java/testing/org/apache/derbyTesting/functionTests/suites/All.java&lt;br/&gt;
 .1 Add ReplicationSuite.suite() to suites.All.&lt;/p&gt;



&lt;p&gt;The patch has been tested on&lt;br/&gt;
Linux:   jars: 1.4, 1.5, 1.6. classes: 1.4, 1.5, 1.6&lt;br/&gt;
  rel.cp jars:      1.5, 1.6 &lt;br/&gt;
Solaris: jars: 1.4, 1.5, 1.6&lt;br/&gt;
Windows: jars: 1.4, 1.5, 1.6&lt;/p&gt;</comment>
                            <comment id="12582982" author="oysteing" created="Fri, 28 Mar 2008 10:56:22 +0000"  >&lt;p&gt;Thanks for the  derby-3162.8_v1_post641328.diff.txt  patch, Ole.&lt;br/&gt;
I did some editing of indentation and long lines, and removed the declaration of an unused variable before committing it at revision 642193.&lt;/p&gt;</comment>
                            <comment id="12584147" author="oysteing" created="Tue, 1 Apr 2008 15:17:14 +0100"  >&lt;p&gt;Patch 8 merged to 10.4 branch at revision 643415..&lt;/p&gt;</comment>
                            <comment id="12585553" author="olesolberg" created="Fri, 4 Apr 2008 15:40:48 +0100"  >&lt;p&gt;Currently planned framework and tests for trunk and 10.4 branch are committed and used in nightly tests: Closing.&lt;br/&gt;
Additional improvements and additions will be traced by new JIRA issues. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12369080" name="derby-3162.1-v1.diff.txt" size="72332" author="olesolberg" created="Wed, 7 Nov 2007 07:35:36 +0000"/>
                            <attachment id="12376718" name="derby-3162.2-v2.diff.txt" size="351026" author="olesolberg" created="Thu, 28 Feb 2008 13:27:02 +0000"/>
                            <attachment id="12376719" name="derby-3162.2-v2.stat.txt" size="4491" author="olesolberg" created="Thu, 28 Feb 2008 13:27:02 +0000"/>
                            <attachment id="12376986" name="derby-3162.3-v1.diff.txt" size="48267" author="olesolberg" created="Mon, 3 Mar 2008 16:10:47 +0000"/>
                            <attachment id="12376985" name="derby-3162.3-v1.stat.txt" size="611" author="olesolberg" created="Mon, 3 Mar 2008 16:10:47 +0000"/>
                            <attachment id="12377043" name="derby-3162.3-v2.diff.txt" size="49510" author="olesolberg" created="Tue, 4 Mar 2008 07:43:25 +0000"/>
                            <attachment id="12377042" name="derby-3162.3-v2.stat.txt" size="611" author="olesolberg" created="Tue, 4 Mar 2008 07:43:25 +0000"/>
                            <attachment id="12377069" name="derby-3162.3-v3.diff.txt" size="50020" author="olesolberg" created="Tue, 4 Mar 2008 10:52:08 +0000"/>
                            <attachment id="12377068" name="derby-3162.3-v3.stat.txt" size="724" author="olesolberg" created="Tue, 4 Mar 2008 10:52:08 +0000"/>
                            <attachment id="12377320" name="derby-3162.3-v4c.diff.txt" size="99856" author="olesolberg" created="Fri, 7 Mar 2008 08:21:32 +0000"/>
                            <attachment id="12377321" name="derby-3162.3-v4c.stat.txt" size="1533" author="olesolberg" created="Fri, 7 Mar 2008 08:21:32 +0000"/>
                            <attachment id="12377352" name="derby-3162.3-v4d.diff.txt" size="106124" author="olesolberg" created="Fri, 7 Mar 2008 15:00:09 +0000"/>
                            <attachment id="12377353" name="derby-3162.3-v4d.stat.txt" size="1533" author="olesolberg" created="Fri, 7 Mar 2008 15:00:09 +0000"/>
                            <attachment id="12377529" name="derby-3162.4-v3.diff.txt" size="23483" author="olesolberg" created="Mon, 10 Mar 2008 14:33:39 +0000"/>
                            <attachment id="12377530" name="derby-3162.4-v3.stat.txt" size="175" author="olesolberg" created="Mon, 10 Mar 2008 14:33:40 +0000"/>
                            <attachment id="12377757" name="derby-3162.5-v1.diff.txt" size="31424" author="olesolberg" created="Thu, 13 Mar 2008 08:33:33 +0000"/>
                            <attachment id="12377758" name="derby-3162.5-v1.stat.txt" size="1145" author="olesolberg" created="Thu, 13 Mar 2008 08:33:33 +0000"/>
                            <attachment id="12378118" name="derby-3162.6_v1.diff.txt" size="6797" author="olesolberg" created="Tue, 18 Mar 2008 12:02:21 +0000"/>
                            <attachment id="12378119" name="derby-3162.6_v1.stat.txt" size="193" author="olesolberg" created="Tue, 18 Mar 2008 12:02:21 +0000"/>
                            <attachment id="12378694" name="derby-3162.8_v1_post641328.diff.txt" size="22316" author="olesolberg" created="Thu, 27 Mar 2008 09:08:59 +0000"/>
                            <attachment id="12378695" name="derby-3162.8_v1_post641328.stat.txt" size="387" author="olesolberg" created="Thu, 27 Mar 2008 09:08:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 29 Feb 2008 08:49:52 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30748</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0z0n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39491</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>