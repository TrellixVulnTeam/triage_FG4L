<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:42 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3658/DERBY-3658.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3658] LOBStateTracker should not use SYSIBM.CLOBRELEASELOCATOR when the database is soft-upgraded from 10.2</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3658</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Reported by Daniel Noll on derby-user: &lt;a href=&quot;http://thread.gmane.org/gmane.comp.apache.db.derby.user/9107&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://thread.gmane.org/gmane.comp.apache.db.derby.user/9107&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To reproduce:&lt;/p&gt;

&lt;p&gt;  1. Create a database with Derby 10.2.2.0&lt;br/&gt;
  2. Create a table with a clob column and insert some data&lt;br/&gt;
  3. Access that database with client+server at version 10.4.1.3 and iterate through the rows in the table&lt;/p&gt;

&lt;p&gt;You&apos;ll see an error message like this:&lt;/p&gt;

&lt;p&gt;ERROR 42Y03: &apos;SYSIBM.CLOBRELEASELOCATOR&apos; is not recognized as a function or procedure.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12395198">DERBY-3658</key>
            <summary>LOBStateTracker should not use SYSIBM.CLOBRELEASELOCATOR when the database is soft-upgraded from 10.2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 May 2008 13:45:01 +0100</created>
                <updated>Tue, 30 Jun 2009 16:55:48 +0100</updated>
                            <resolved>Fri, 2 May 2008 23:16:58 +0100</resolved>
                                    <version>10.3.3.0</version>
                    <version>10.4.1.3</version>
                                    <fixVersion>10.4.2.0</fixVersion>
                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>JDBC</component>
                    <component>Network Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12593770" author="knutanders" created="Fri, 2 May 2008 14:07:12 +0100"  >&lt;p&gt;The attached patch seems to fix the problem (no regression tests have been run yet).&lt;/p&gt;

&lt;p&gt;The problem is that the client doesn&apos;t know the version of the database accessed on the server, so a LOBStateTracker is created if the server supports locators, which does not necessarily mean that the database supports locators. The code that fetches LOBs knows how to handle this, and sets the locator to -1 if locators aren&apos;t supported. The patch therefore checks that the locator is valid before it releases it in LOBStateTracker.checkCurrentRow(). Since the locator value is invalid when locators aren&apos;t supported, this means that it won&apos;t try to call the missing stored procedures.&lt;/p&gt;</comment>
                            <comment id="12593786" author="kristwaa" created="Fri, 2 May 2008 14:46:00 +0100"  >&lt;p&gt;The approach taken seems sound. +1 to commit if the tests pass.&lt;/p&gt;

&lt;p&gt;I missed the point when I implemented this, believing if the server supported locators Cursor.locator would return a valid locator.&lt;br/&gt;
Does it make sense to explicitly note the possibility of an invalid locator even if the server supports it, for instance in &lt;span class=&quot;error&quot;&gt;&amp;#91;Net&amp;#93;&lt;/span&gt;Cursor.locator?&lt;br/&gt;
That said, the possibility of getting INVALID_LOCATOR should of course have made me check the value...&lt;/p&gt;</comment>
                            <comment id="12593842" author="knutanders" created="Fri, 2 May 2008 19:35:19 +0100"  >&lt;p&gt;Thanks for looking at the patch, Kristian. The tests passed, so I committed the patch to trunk with revision 652865. I also plan to back-port it to the 10.4 branch. I&apos;ll also see if I can clarify the comments for &lt;span class=&quot;error&quot;&gt;&amp;#91;Net&amp;#93;&lt;/span&gt;Cursor.locator().&lt;/p&gt;</comment>
                            <comment id="12593843" author="kmarsden" created="Fri, 2 May 2008 19:39:13 +0100"  >&lt;p&gt;Can you backport it to 10.3 as well?&lt;/p&gt;</comment>
                            <comment id="12593886" author="kmarsden" created="Fri, 2 May 2008 22:02:52 +0100"  >&lt;p&gt;I will go ahead and merge to 10.3 and run some tests so we make the 5pm cutoff for the release.&lt;/p&gt;</comment>
                            <comment id="12593887" author="knutanders" created="Fri, 2 May 2008 22:02:56 +0100"  >&lt;p&gt;Yes, I&apos;ll do that. I didn&apos;t think the bug affected 10.3, but it seems like LOBStateTracker is present on the 10.3 branch as well. Added 10.3.2.2 to the list of affected versions.&lt;/p&gt;</comment>
                            <comment id="12593890" author="knutanders" created="Fri, 2 May 2008 22:13:04 +0100"  >&lt;p&gt;Merged to 10.4 with revision 652914.&lt;br/&gt;
Merged to 10.3 with revision 652917.&lt;/p&gt;</comment>
                            <comment id="12593914" author="knutanders" created="Fri, 2 May 2008 23:13:19 +0100"  >&lt;p&gt;Ops, sorry, I missed your comment about having started back-porting it to 10.3. Some extra testing doesn&apos;t hurt though. Thanks!&lt;/p&gt;</comment>
                            <comment id="12593916" author="knutanders" created="Fri, 2 May 2008 23:16:58 +0100"  >&lt;p&gt;I updated the comments in Connection.serverSupportsLocators() and Cursor.locator() so that they say explicitly that a server that supports locators may send LOB values instead of locators if the database is soft upgraded. Committed (to trunk only) revision 652929.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12381307" name="d3658.diff" size="997" author="knutanders" created="Fri, 2 May 2008 14:07:12 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10420"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 2 May 2008 13:46:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23774</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0uuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38815</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>