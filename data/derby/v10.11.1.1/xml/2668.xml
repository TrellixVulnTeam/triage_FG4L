<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:50:12 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2668/DERBY-2668.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2668] At the time of compilation of a comparison operation, if the collation types of the operands do not match, then we should throw a meaningful error message.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2668</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;In Derby 10.3, we are adding a new feature (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1478&quot; title=&quot;Add built in language based ordering and like processing to Derby&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1478&quot;&gt;&lt;del&gt;DERBY-1478&lt;/del&gt;&lt;/a&gt;) which will allow character string types to have a territory based collation (except for persistent character string type columns from system schema). When 2 character types are compared, they should have the same collation type associated with them. If not then Derby 10.3 will throw an exception. Currently, in Derby 10.3 codeline, the exception thrown is something like &quot;ERROR 42818: Comparisons between &apos;VARCHAR&apos; and &apos;CHAR&apos; are not supported.&quot; but this error message is misleading. The error is really for collation mismatch. We should fix following error so it indicates the real reason behind the exception.&lt;/p&gt;

&lt;p&gt;eg sql&lt;br/&gt;
ij&amp;gt; connect &apos;nodb;create=true;territory=no;collation=TERRITORY_BASED&apos;; &lt;br/&gt;
ij&amp;gt; select * from sys.systables where tablename = &apos;T1&apos;; &lt;br/&gt;
ERROR 42818: Comparisons between &apos;VARCHAR&apos; and &apos;CHAR&apos; are not supported. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12369647">DERBY-2668</key>
            <summary>At the time of compilation of a comparison operation, if the collation types of the operands do not match, then we should throw a meaningful error message.</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="mamtas">Mamta A. Satoor</reporter>
                        <labels>
                    </labels>
                <created>Fri, 18 May 2007 07:25:01 +0100</created>
                <updated>Fri, 21 Jan 2011 17:50:11 +0000</updated>
                            <resolved>Mon, 6 Aug 2007 18:01:50 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12496799" author="mamtas" created="Fri, 18 May 2007 07:58:53 +0100"  >&lt;p&gt;I haven&apos;t spent enough time thinking about this but I think it is more than just fixing the error message string. It seems that the comparable method in DTD should return int rather than boolean and the return int value will decide if we should throw what we are throwing today (ie something like ERROR 42818: Comparisons between &apos;VARCHAR&apos; and &apos;CHAR&apos; are not supported. ) or throw a new message because collations don&apos;t match. This is just my initial thought, haven&apos;t spend enough time to think about a solution&lt;/p&gt;</comment>
                            <comment id="12508246" author="mamtas" created="Tue, 26 Jun 2007 18:16:09 +0100"  >&lt;p&gt;There is a thread on Derby list at &lt;a href=&quot;http://www.nabble.com/comparisons-between-system-and-user-table-columns-with-TERRITORY_BASED-collation-tf3967283.html#a11261072&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/comparisons-between-system-and-user-table-columns-with-TERRITORY_BASED-collation-tf3967283.html#a11261072&lt;/a&gt; This talks about possible changes to the error message text. Copied portion of email from Bryan Pendleton below&lt;/p&gt;


&lt;p&gt;Can we make it say something like:&lt;/p&gt;

&lt;p&gt;ERROR 42818: Comparisons between &apos;VARCHAR(en_US)&apos; and &apos;VARCHAR(UCS_BASIC)&apos; are not supported.&lt;/p&gt;

&lt;p&gt;That is, sort of pack the collation information into the datatype&lt;br/&gt;
name somehow?&lt;/p&gt;
</comment>
                            <comment id="12517602" author="kmarsden" created="Fri, 3 Aug 2007 19:45:49 +0100"  >&lt;p&gt;Before I update many masters I wanted to run a preview of the patch for this issue and the new error format by the community.  The new error will look as below with collation always printing with string types when comparisons are not supported.  Please let me know what you think.&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;



&lt;p&gt;ij&amp;gt; select * from sys.systables where tablename = &apos;T1&apos;;&lt;br/&gt;
ERROR 42818: Comparisons between &apos;VARCHAR (UCS_BASIC)&apos; and &apos;CHAR (TERRITORY_BASED)&apos; are not supported.&lt;br/&gt;
ij&amp;gt; select * from sys.systables where tablename = 1;&lt;br/&gt;
ERROR 42818: Comparisons between &apos;VARCHAR (UCS_BASIC)&apos; and &apos;INTEGER&apos; are not supported.&lt;/p&gt;</comment>
                            <comment id="12517658" author="kmarsden" created="Sat, 4 Aug 2007 00:22:51 +0100"  >&lt;p&gt;Here is an alternate, wordier message.  Would something with this level of detail be better?&lt;/p&gt;


&lt;p&gt;ij&amp;gt; select * from sys.systables where tablename = &apos;T1&apos;;&lt;br/&gt;
ERROR 42818: Comparisons between &apos;VARCHAR (UCS_BASIC)&apos; and &apos;CHAR (TERRITORY_BASED)&apos; are not supported. Types must be comparable. String types must also have matching collation. If collation does not match, a possible solution is to cast operands to force them to the default collation (e.g. select tablename from sys.systables where CAST(tablename as VARCHAR(128)) = &apos;T1&apos;)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12372254">DERBY-2866</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12345445">DERBY-1478</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12368325">DERBY-2599</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12363143" name="derby-2668_preview_diff.txt" size="1513" author="kmarsden" created="Fri, 3 Aug 2007 19:45:49 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 3 Aug 2007 18:45:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30560</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0mef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37447</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>