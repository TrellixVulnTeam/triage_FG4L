<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:25:16 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5486/DERBY-5486.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5486] Upgrade tests should verify that DERBY-4437 was backed out of 10.8.2.2</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5486</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The following code in UpgradeRun needs to be reworked to verify that sequence/identities behave as expected when upgrading from 10.8.2.2:&lt;/p&gt;

&lt;p&gt;                if ( lessThan( version, new int[] &lt;/p&gt;
{ 10, 8, 1, 6 }
&lt;p&gt; ) )&lt;/p&gt;
                { suite.addTest(Changes10_8_2.suite(phase)); }

&lt;p&gt;The following might do the trick:&lt;/p&gt;

&lt;p&gt;                if (oldMinor &amp;lt; 7)&lt;br/&gt;
                    suite.addTest(Changes10_7.suite(phase));&lt;br/&gt;
                if (oldMinor &amp;lt; 9)&lt;/p&gt;
                {
                    suite.addTest(Changes10_9.suite(phase));
                    suite.addTest(Changes10_8_2.suite(phase));
                }

&lt;p&gt;Thanks to Kristian for spotting this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12528935">DERBY-5486</key>
            <summary>Upgrade tests should verify that DERBY-4437 was backed out of 10.8.2.2</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Oct 2011 19:17:06 +0100</created>
                <updated>Fri, 14 Jun 2013 18:20:38 +0100</updated>
                            <resolved>Fri, 13 Apr 2012 17:43:21 +0100</resolved>
                                                                    <component>SQL</component>
                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13138178" author="knutanders" created="Fri, 28 Oct 2011 09:59:27 +0100"  >&lt;p&gt;Would it be better to move the test cases from Changes10_8_2 to Changes10_9? Since the changes didn&apos;t actually end up in 10.8.2, the current name of the class is misleading.&lt;/p&gt;</comment>
                            <comment id="13138247" author="rhillegas" created="Fri, 28 Oct 2011 13:02:52 +0100"  >&lt;p&gt;Thanks, Knut. That&apos;s a good suggestion.&lt;/p&gt;</comment>
                            <comment id="13140185" author="rhillegas" created="Mon, 31 Oct 2011 14:32:30 +0000"  >&lt;p&gt;Attaching derby-5486-01-ab-mergeFiles.diff. This patch removes Changes10_8_2, merging it into Changes10_9. Removes the special exception for 10.8.2. I see errors in trigger-related upgrade tests. However, these are identical to the errors I see on a codeline without this patch. Committed at subversion revision 1195476.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M       java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_9.java&lt;br/&gt;
M       java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/UpgradeRun.java&lt;br/&gt;
D       java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_8_2.java&lt;/p&gt;</comment>
                            <comment id="13143450" author="rhillegas" created="Thu, 3 Nov 2011 19:05:39 +0000"  >&lt;p&gt;Attaching derby-5486-02-aa-removeTests.diff. This patch removes the tests which were merged in the previous patch. For some reason those tests are turning up intermittent failures in the nightly tests. I don&apos;t know what the instability is. However, on further reflection, I don&apos;t think that these tests add any value on top of the existing upgrade/downgrade tests for identity behavior. So I am removing these useless tests rather than spend any time tracking down the instability. Committed at subversion revision 1197272.&lt;/p&gt;</comment>
                            <comment id="13143890" author="knutanders" created="Fri, 4 Nov 2011 10:25:54 +0000"  >&lt;p&gt;Are we confident that the intermittent failures are problems with the tests and not with the implementation? If so, just removing the tests sounds OK. But if there&apos;s potentially a problem with the implementation, that problem will still be there after the removal of the tests...&lt;/p&gt;</comment>
                            <comment id="13143945" author="rhillegas" created="Fri, 4 Nov 2011 12:14:04 +0000"  >&lt;p&gt;Hi Knut,&lt;/p&gt;

&lt;p&gt;Yes, I think that is the case. Thanks.&lt;/p&gt;</comment>
                            <comment id="13144430" author="knutanders" created="Fri, 4 Nov 2011 22:54:44 +0000"  >&lt;p&gt;It looks to me as if the tests failed because the sequence returned the same value twice. That sounds like a bug to me. I&apos;m able to reproduce it on trunk by running these two ij sessions:&lt;/p&gt;

&lt;p&gt;ij version 10.9&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:db;create=true&apos;;&lt;br/&gt;
ij&amp;gt; create sequence s;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; values next value for s;&lt;br/&gt;
1          &lt;br/&gt;
-----------&lt;br/&gt;
-2147483648&lt;/p&gt;

&lt;p&gt;1 row selected&lt;br/&gt;
ij&amp;gt; &lt;/p&gt;

&lt;p&gt;At this point, kill the ij process. Should not be a clean shutdown. Then restart ij and retrieve the next value from the sequence:&lt;/p&gt;

&lt;p&gt;ij version 10.9&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:db&apos;;&lt;br/&gt;
ij&amp;gt; values next value for s;&lt;br/&gt;
1          &lt;br/&gt;
-----------&lt;br/&gt;
-2147483648&lt;/p&gt;

&lt;p&gt;1 row selected&lt;br/&gt;
ij&amp;gt; &lt;/p&gt;

&lt;p&gt;Here, we got the same value as we did the first time, but we should have got a new value.&lt;/p&gt;</comment>
                            <comment id="13145356" author="knutanders" created="Mon, 7 Nov 2011 11:45:25 +0000"  >&lt;p&gt;It is also possible to get the same value returned twice in a single ij session (might be a different bug):&lt;/p&gt;

&lt;p&gt;ij version 10.9&lt;br/&gt;
ij&amp;gt; connect &apos;jdbc:derby:memory:db;create=true&apos;;&lt;br/&gt;
ij&amp;gt; create table t (x int);&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; create sequence s;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; autocommit off;&lt;br/&gt;
ij&amp;gt; select count&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; from sys.syssequences with rs;&lt;br/&gt;
1          &lt;br/&gt;
-----------&lt;br/&gt;
1          &lt;/p&gt;

&lt;p&gt;1 row selected&lt;br/&gt;
ij&amp;gt; values next value for s;&lt;br/&gt;
1          &lt;br/&gt;
-----------&lt;br/&gt;
-2147483648&lt;/p&gt;

&lt;p&gt;1 row selected&lt;br/&gt;
ij&amp;gt; drop table t;&lt;br/&gt;
0 rows inserted/updated/deleted&lt;br/&gt;
ij&amp;gt; rollback;&lt;br/&gt;
ij&amp;gt; values next value for s;&lt;br/&gt;
1          &lt;br/&gt;
-----------&lt;br/&gt;
-2147483648&lt;/p&gt;

&lt;p&gt;1 row selected&lt;/p&gt;</comment>
                            <comment id="13145545" author="rhillegas" created="Mon, 7 Nov 2011 15:13:36 +0000"  >&lt;p&gt;Thanks, Knut. Those do look like bugs. I have logged JIRAs for them and linked them to a master JIRA for fixes to sequence/identity generators: &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5495&quot; title=&quot;Master issue to track fixes to sequence generators&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5495&quot;&gt;&lt;del&gt;DERBY-5495&lt;/del&gt;&lt;/a&gt;. Thanks.&lt;/p&gt;</comment>
                            <comment id="13253527" author="rhillegas" created="Fri, 13 Apr 2012 17:43:21 +0100"  >&lt;p&gt;I don&apos;t intend to work on this issue, now that derby-4437 has been backed out of the trunk as well as the 10.8 branch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12530579">DERBY-5495</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12501613" name="derby-5486-01-ab-mergeFiles.diff" size="15781" author="rhillegas" created="Mon, 31 Oct 2011 14:32:29 +0000"/>
                            <attachment id="12502201" name="derby-5486-02-aa-removeTests.diff" size="6044" author="rhillegas" created="Thu, 3 Nov 2011 19:05:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 28 Oct 2011 08:59:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>214795</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0ce7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35826</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>