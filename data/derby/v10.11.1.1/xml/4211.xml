<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:37:05 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4211/DERBY-4211.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4211] &apos;derbyall/encryptionAll/storemats.fail:store/updatelocksJDBC30.sql&apos; fails with unexpected locks</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4211</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;See &lt;a href=&quot;http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/testlog/SunOS-5.10_i86pc-i386/771180-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.thresher.com/derby/test/tinderbox_trunk16/jvm1.6/testing/testlog/SunOS-5.10_i86pc-i386/771180-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/encryptionAll/storemats/storemats/updatelocksJDBC30.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: updatelocksJDBC30 jdk1.6.0_06 storemats:storemats 2009-05-04 11:56:42 ***&lt;br/&gt;
9184a9185&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE  &lt;br/&gt;
9194a9196&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE  &lt;br/&gt;
9205a9208&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE  &lt;br/&gt;
9215a9219&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE  &lt;br/&gt;
9224a9229&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE  &lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   updatelocksJDBC30 jdk1.6.0_06 storemats:storemats 2009-05-04 11:57:00 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>OS:&lt;br/&gt;
Solaris 10 5/08 s10x_u5wos_10 X86 64bits - SunOS 5.10 Generic_127128-11&lt;br/&gt;
&lt;br/&gt;
JVM:&lt;br/&gt;
Sun Microsystems Inc.&lt;br/&gt;
java version &amp;quot;1.6.0_06&amp;quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_06-b02)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 10.0-b22, mixed mode)&lt;br/&gt;
</environment>
        <key id="12424524">DERBY-4211</key>
            <summary>&apos;derbyall/encryptionAll/storemats.fail:store/updatelocksJDBC30.sql&apos; fails with unexpected locks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikem">Mike Matrigali</assignee>
                                    <reporter username="olesolberg">Ole Solberg</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 May 2009 15:36:34 +0100</created>
                <updated>Mon, 17 Jun 2013 10:19:40 +0100</updated>
                            <resolved>Sun, 11 Jul 2010 17:23:27 +0100</resolved>
                                    <version>10.6.1.0</version>
                                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.2.1</fixVersion>
                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12705609" author="knutanders" created="Mon, 4 May 2009 15:42:37 +0100"  >&lt;p&gt;Duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4132&quot; title=&quot;intermittent test failure: extra lock in store/updatelocksJDBC30&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4132&quot;&gt;&lt;del&gt;DERBY-4132&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="12886752" author="mikem" created="Fri, 9 Jul 2010 17:06:09 +0100"  >&lt;p&gt;The row that shows up as extra locks is a committed deleted row.  I think the problem is that this row, which in this phase of the test is the only row on the page, is usually cleaned up by the background post commit thread.  Sometimes do to timing it sticks around for a few queries.  If it is there, then even though it is deleted the system needs to get locks on it.&lt;/p&gt;</comment>
                            <comment id="12886755" author="mikem" created="Fri, 9 Jul 2010 17:08:20 +0100"  >&lt;p&gt;this reproduced for me on a 2 processor ubuntu box running jdk 1.6, against 10.5.  I&apos;ve run a number of 10.5 full test runs and would estimate it passed 9 out of 10 times in this environment in full test runs.&lt;/p&gt;

&lt;p&gt;010-07-08 17:40:18 ***&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/storeall/storemats/storemats/updatelocksJDBC30.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: updatelocksJDBC30 jdk1.6.0_20 storemats:storemats 2010-07-08 17:33:47 ***&lt;br/&gt;
9184a9185&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
9194a9196&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
9205a9208&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
9215a9219&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
9224a9229&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   updatelocksJDBC30 jdk1.6.0_20 storemats:storemats 2010-07-08 17:33:59 ***
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/storeall/storemore/backupRestore.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12886775" author="mikem" created="Fri, 9 Jul 2010 18:12:11 +0100"  >&lt;p&gt;In 100 runs on ubuntu 2 processor jdk16 run against a SANE trunk build got 3 errors:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;Start: updatelocksJDBC30 jdk1.6.0_20 2010-07-09 09:23:36 ***&lt;br/&gt;
14308d14307&lt;br/&gt;
&amp;lt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
14309a14309&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |2   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
14320d14319&lt;br/&gt;
&amp;lt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
14323a14323&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |2   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
14334d14333&lt;br/&gt;
&amp;lt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
14339a14339&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |2   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
14348d14347&lt;br/&gt;
&amp;lt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
14353a14353&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |2   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
14361d14360&lt;br/&gt;
&amp;lt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
14366a14366&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |2   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   updatelocksJDBC30 jdk1.6.0_20 2010-07-09 09:23:51 ***&lt;/li&gt;
			&lt;li&gt;Start: updatelocksJDBC30 jdk1.6.0_20 2010-07-09 09:36:58 ***&lt;br/&gt;
9184a9185&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
9194a9196&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
9205a9208&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
9215a9219&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
9224a9229&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |1   |U   |A           |(2,6)     |GRANT|ACTIVE&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   updatelocksJDBC30 jdk1.6.0_20 2010-07-09 09:37:11 ***&lt;/li&gt;
			&lt;li&gt;Start: updatelocksJDBC30 jdk1.6.0_20 2010-07-09 09:45:01 ***&lt;br/&gt;
14338d14337&lt;br/&gt;
&amp;lt; APP     |UserTran|ROW     |1   |U   |A           |(6,6)     |GRANT|ACTIVE&lt;br/&gt;
14339a14339&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |2   |U   |A           |(6,6)     |GRANT|ACTIVE&lt;br/&gt;
14352d14351&lt;br/&gt;
&amp;lt; APP     |UserTran|ROW     |1   |U   |A           |(6,6)     |GRANT|ACTIVE&lt;br/&gt;
14353a14353&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |2   |U   |A           |(6,6)     |GRANT|ACTIVE&lt;br/&gt;
14365d14364&lt;br/&gt;
&amp;lt; APP     |UserTran|ROW     |1   |U   |A           |(6,6)     |GRANT|ACTIVE&lt;br/&gt;
14366a14366&lt;br/&gt;
&amp;gt; APP     |UserTran|ROW     |2   |U   |A           |(6,6)     |GRANT|ACTIVE&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   updatelocksJDBC30 jdk1.6.0_20 2010-07-09 09:45:14 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12886935" author="mikem" created="Sat, 10 Jul 2010 00:01:22 +0100"  >&lt;p&gt;commited fix to trunk.&lt;/p&gt;

&lt;p&gt;m1_jdk16:41&amp;gt;svn commit&lt;br/&gt;
Sending        java/testing/org/apache/derbyTesting/functionTests/master/updatelocksJDBC30.out&lt;br/&gt;
Sending        java/testing/org/apache/derbyTesting/functionTests/tests/store/updateBtreeHoldCursorLocksJDBC30.subsql&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 962716.&lt;/p&gt;</comment>
                            <comment id="12887037" author="mikem" created="Sat, 10 Jul 2010 15:24:31 +0100"  >&lt;p&gt;merged fix #962716 from trunk to 10.6 codeline.&lt;/p&gt;

&lt;p&gt;m106_jdk16:14&amp;gt;svn commit&lt;br/&gt;
Sending        .&lt;br/&gt;
Sending        java/testing/org/apache/derbyTesting/functionTests/master/updatelocksJDBC30.out&lt;br/&gt;
Sending        java/testing/org/apache/derbyTesting/functionTests/tests/store/updateBtreeHoldCursorLocksJDBC30.subsql&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 962848.&lt;/p&gt;</comment>
                            <comment id="12887211" author="mikem" created="Sun, 11 Jul 2010 17:20:20 +0100"  >&lt;p&gt;merged fix #962716 from trunk to 10.5 codeline. &lt;/p&gt;

&lt;p&gt;m105_jdk16:12&amp;gt;svn commit&lt;br/&gt;
Sending        .&lt;br/&gt;
Sending        java/testing/org/apache/derbyTesting/functionTests/master/updatelocksJDBC30.out&lt;br/&gt;
Sending        java/testing/org/apache/derbyTesting/functionTests/tests/store/updateBtreeHoldCursorLocksJDBC30.subsql&lt;br/&gt;
Transmitting file data ..&lt;br/&gt;
Committed revision 963100.&lt;/p&gt;</comment>
                            <comment id="12887212" author="mikem" created="Sun, 11 Jul 2010 17:23:26 +0100"  >&lt;p&gt;fixed, and backported to 10.5 and 10.6&lt;/p&gt;</comment>
                            <comment id="12993623" author="mamtas" created="Fri, 11 Feb 2011 18:23:22 +0000"  >&lt;p&gt;Saw the failure on tinderbox with Sun&apos;s jdk 1.6 on trunk at &lt;a href=&quot;http://dbtg.foundry.sun.com/derby/test/tinderbox_trunk16/jvm1.6/testing/testlog/SunOS-5.10_i86pc-i386/1069761-derbyall_diff.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://dbtg.foundry.sun.com/derby/test/tinderbox_trunk16/jvm1.6/testing/testlog/SunOS-5.10_i86pc-i386/1069761-derbyall_diff.txt&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/storeall/storemats/storemats/updatelocksJDBC30.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: updatelocksJDBC30 jdk1.6.0_18 storemats:storemats 2011-02-11 14:02:48 ***&lt;br/&gt;
4983,4992d4982&lt;br/&gt;
&amp;lt; APP     |UserTran|TABLE   |1   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
&amp;lt; ij&amp;gt; next scan_cursor;&lt;br/&gt;
&amp;lt; A          |B          |C                                                                                                                               &lt;br/&gt;
&amp;lt; --------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
&amp;lt; 3          |-30        |-three                                                                                                                          &lt;br/&gt;
&amp;lt; ij&amp;gt; update a set b=30,c=&apos;three&apos; where current of scan_cursor;&lt;br/&gt;
&amp;lt; 1 row inserted/updated/deleted&lt;br/&gt;
&amp;lt; ij&amp;gt; select * from lock_table order by tabname, type desc, mode, cnt, lockname;&lt;br/&gt;
&amp;lt; USERNAME|TRANTYPE|TYPE    |CNT |MODE|TABNAME     |LOCKNAME  |STATE|STATUS  &lt;br/&gt;
&amp;lt; ---------------------------------------------------------------------------&lt;br/&gt;
4993a4984,4993&lt;br/&gt;
&amp;gt; ij&amp;gt; next scan_cursor;&lt;br/&gt;
&amp;gt; A          |B          |C                                                                                                                               &lt;br/&gt;
&amp;gt; --------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
&amp;gt; 3          |-30        |-three                                                                                                                          &lt;br/&gt;
&amp;gt; ij&amp;gt; update a set b=30,c=&apos;three&apos; where current of scan_cursor;&lt;br/&gt;
&amp;gt; 1 row inserted/updated/deleted&lt;br/&gt;
&amp;gt; ij&amp;gt; select * from lock_table order by tabname, type desc, mode, cnt, lockname;&lt;br/&gt;
&amp;gt; USERNAME|TRANTYPE|TYPE    |CNT |MODE|TABNAME     |LOCKNAME  |STATE|STATUS  &lt;br/&gt;
&amp;gt; ---------------------------------------------------------------------------&lt;br/&gt;
&amp;gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
5003 del&lt;br/&gt;
&amp;lt; APP     |UserTran|TABLE   |2   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
5003a5003&lt;br/&gt;
&amp;gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
5010 del&lt;br/&gt;
&amp;lt; APP     |UserTran|TABLE   |2   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
5010a5010&lt;br/&gt;
&amp;gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   updatelocksJDBC30 jdk1.6.0_18 storemats:storemats 2011-02-11 14:02:55 ***
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/derbynetclientmats/DerbyNetClient/encodingTests/TestEnc.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: TestEnc jdk1.6.0_18 DerbyNetClient derbynetclientmats:encodingTests 2011-02-11 14:08:04 ***&lt;br/&gt;
derbyTesting.encoding can only be used with jdk15, skipping test&lt;/li&gt;
			&lt;li&gt;End:   TestEnc jdk1.6.0_18 DerbyNetClient derbynetclientmats:encodingTests 2011-02-11 14:08:04 ***
			&lt;ul&gt;
				&lt;li&gt;
				&lt;ul&gt;
					&lt;li&gt;
					&lt;ul&gt;
						&lt;li&gt;
						&lt;ul&gt;
							&lt;li&gt;
							&lt;ul&gt;
								&lt;li&gt;
								&lt;ul&gt;
									&lt;li&gt;Diff file derbyall/encryptionAll/storemats/storemats/updatelocksJDBC30.diff&lt;/li&gt;
								&lt;/ul&gt;
								&lt;/li&gt;
							&lt;/ul&gt;
							&lt;/li&gt;
						&lt;/ul&gt;
						&lt;/li&gt;
					&lt;/ul&gt;
					&lt;/li&gt;
				&lt;/ul&gt;
				&lt;/li&gt;
			&lt;/ul&gt;
			&lt;/li&gt;
			&lt;li&gt;Start: updatelocksJDBC30 jdk1.6.0_18 storemats:storemats 2011-02-11 14:11:15 ***&lt;br/&gt;
2504,2513d2503&lt;br/&gt;
&amp;lt; APP     |UserTran|TABLE   |1   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
&amp;lt; ij&amp;gt; next scan_cursor;&lt;br/&gt;
&amp;lt; A          |B          |C                                                                                                                               &lt;br/&gt;
&amp;lt; --------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
&amp;lt; 3          |-30        |-three                                                                                                                          &lt;br/&gt;
&amp;lt; ij&amp;gt; update a set b=30,c=&apos;three&apos; where current of scan_cursor;&lt;br/&gt;
&amp;lt; 1 row inserted/updated/deleted&lt;br/&gt;
&amp;lt; ij&amp;gt; select * from lock_table order by tabname, type desc, mode, cnt, lockname;&lt;br/&gt;
&amp;lt; USERNAME|TRANTYPE|TYPE    |CNT |MODE|TABNAME     |LOCKNAME  |STATE|STATUS  &lt;br/&gt;
&amp;lt; ---------------------------------------------------------------------------&lt;br/&gt;
2514a2505,2514&lt;br/&gt;
&amp;gt; ij&amp;gt; next scan_cursor;&lt;br/&gt;
&amp;gt; A          |B          |C                                                                                                                               &lt;br/&gt;
&amp;gt; --------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br/&gt;
&amp;gt; 3          |-30        |-three                                                                                                                          &lt;br/&gt;
&amp;gt; ij&amp;gt; update a set b=30,c=&apos;three&apos; where current of scan_cursor;&lt;br/&gt;
&amp;gt; 1 row inserted/updated/deleted&lt;br/&gt;
&amp;gt; ij&amp;gt; select * from lock_table order by tabname, type desc, mode, cnt, lockname;&lt;br/&gt;
&amp;gt; USERNAME|TRANTYPE|TYPE    |CNT |MODE|TABNAME     |LOCKNAME  |STATE|STATUS  &lt;br/&gt;
&amp;gt; ---------------------------------------------------------------------------&lt;br/&gt;
&amp;gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
2524 del&lt;br/&gt;
&amp;lt; APP     |UserTran|TABLE   |2   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
2524a2524&lt;br/&gt;
&amp;gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
2531 del&lt;br/&gt;
&amp;lt; APP     |UserTran|TABLE   |2   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
2531a2531&lt;br/&gt;
&amp;gt; APP     |UserTran|TABLE   |3   |IX  |A           |Tablelock |GRANT|ACTIVE  &lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   updatelocksJDBC30 jdk1.6.0_18 storemats:storemats 2011-02-11 14:11:23 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12993643" author="mikem" created="Fri, 11 Feb 2011 19:07:18 +0000"  >&lt;p&gt;My first guess is this test is being affected by the istats change.  I would be happy to fix the test, but first want to make sure&lt;br/&gt;
there is not an istats bug that I would be hiding.  So would like some feed back on the following:&lt;/p&gt;

&lt;p&gt;1) Are the locks that are requested in background gotten on a &quot;user&quot; transaction, rather than an internal transaction?  If so, should&lt;br/&gt;
they be?  Current the background daemon uses internal transactions so that user&apos;s querying the lock table can tell the difference between&lt;br/&gt;
their xact&apos;s and internal work.&lt;/p&gt;

&lt;p&gt;2) I see from the derby.log that istats work is definitely happening.  Should istats be working on these tables.  The tables in this test always about&lt;br/&gt;
7 rows.  From reading the ones created in the updatelocks test are always created using the following form:&lt;br/&gt;
    create table a(a int, b int);&lt;br/&gt;
    alter table a add column c varchar(1900);&lt;br/&gt;
    insert into a values (1, 10, &apos;one&apos;);&lt;br/&gt;
    insert into a values (2, 20, &apos;two&apos;);&lt;br/&gt;
    insert into a values (3, 30, &apos;three&apos;);&lt;br/&gt;
    insert into a values (4, 40, &apos;four&apos;);&lt;br/&gt;
    insert into a values (5, 50, &apos;five&apos;);&lt;br/&gt;
    insert into a values (6, 60, &apos;six&apos;);&lt;br/&gt;
    insert into a values (7, 70, &apos;seven&apos;);&lt;br/&gt;
    create index a_idx on a (a);&lt;br/&gt;
    commit;&lt;/p&gt;

&lt;p&gt;Some have indexes, some don&apos;t.  If they have indexes they are always created after the row are loaded so all stats should be up to date.  &lt;/p&gt;</comment>
                            <comment id="13039628" author="kristwaa" created="Thu, 26 May 2011 11:26:36 +0100"  >&lt;p&gt;Running store/updatelocksJDBC30.sql with istat logging indicates that no istat work is being done:&lt;br/&gt;
Thu May 26 12:10:53 CEST 2011 Thread&lt;span class=&quot;error&quot;&gt;&amp;#91;main,5,main&amp;#93;&lt;/span&gt; &lt;/p&gt;
{istat}
&lt;p&gt; stopping daemon, active=false, work/age=0/8338 &lt;span class=&quot;error&quot;&gt;&amp;#91;q/p/s=0/0/0,err:k/u/c=0/0/0,rej:f/d/o=0/0/0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;There have been reports of failures for these tests long before the istat feature was available. Even though the initial addition of the istat feature caused failures for at least some of the updatelocks tests, this doesn&apos;t appear to be the case any more.&lt;/p&gt;

&lt;p&gt;One theory is that some times locks are taken due to activity in a background thread. Would rewriting the tests to JUnit and adding wait/retry logic wrt querying the lock table be a way forward?&lt;br/&gt;
A quick look at the existing test classes suggests that this is a fair amount of work, but the tests seem to rely on a rather smallish set of core functions.&lt;/p&gt;</comment>
                            <comment id="13040025" author="dagw" created="Fri, 27 May 2011 02:54:15 +0100"  >&lt;p&gt;I tried to run ijToJUnit on the master, but it choked on the use of cursors in the test, so you&apos;d need to fix the tool if you want to attempt automatic conversion of (parts) of the test to JUnit.&lt;/p&gt;</comment>
                            <comment id="13685321" author="knutanders" created="Mon, 17 Jun 2013 10:19:40 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12421594">DERBY-4132</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10369"><![CDATA[Regression Test Failure]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 4 May 2009 14:42:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24104</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0g6f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36439</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>