<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:13:35 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2202/DERBY-2202.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2202] DROP PROCEDURE depends on SET SCHEMA</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2202</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;This is possibly related to Bug &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1304&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/DERBY-1304&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Use ij to execute the following statements:&lt;/p&gt;

&lt;p&gt;CREATE SCHEMA datamgmt;&lt;br/&gt;
CREATE PROCEDURE datamgmt.exit ( IN value INTEGER )&lt;br/&gt;
 MODIFIES SQL DATA&lt;br/&gt;
 PARAMETER STYLE JAVA&lt;br/&gt;
 LANGUAGE JAVA&lt;br/&gt;
 EXTERNAL NAME &apos;java.lang.System.exit&apos;&lt;br/&gt;
;&lt;br/&gt;
DROP PROCEDURE datamgmt.exit;&lt;br/&gt;
DROP SCHEMA datamgmt RESTRICT;&lt;/p&gt;

&lt;p&gt;Then execute exactly the same lines once again. Then statement &quot;DROP PROCEDURE datamgmt.exit&quot; yields:&lt;/p&gt;

&lt;p&gt;ERROR 42X94: PROCEDURE &apos;EXIT&apos; does not exist.&lt;/p&gt;

&lt;p&gt;However, if the DROP works if a default schema (SET SCHEMA) is used instead of the prefixed schemaName. That is, the following lines can be executed more than once in a row:&lt;/p&gt;

&lt;p&gt;CREATE SCHEMA datamgmt;&lt;br/&gt;
CREATE PROCEDURE datamgmt.exit ( IN value INTEGER )&lt;br/&gt;
 MODIFIES SQL DATA&lt;br/&gt;
 PARAMETER STYLE JAVA&lt;br/&gt;
 LANGUAGE JAVA&lt;br/&gt;
 EXTERNAL NAME &apos;java.lang.System.exit&apos;&lt;br/&gt;
;&lt;br/&gt;
SET SCHEMA datamgmt;&lt;br/&gt;
DROP PROCEDURE exit;&lt;br/&gt;
DROP SCHEMA datamgmt RESTRICT;&lt;/p&gt;

&lt;p&gt;Therefore, SET SCHEMA can be used as a workaround, hence minor importance.&lt;/p&gt;</description>
                <environment>Sun Solaris;&lt;br/&gt;
java version &amp;quot;1.4.1_06&amp;quot;&lt;br/&gt;
Java(TM) 2 Runtime Environment, Standard Edition (build 1.4.1_06-b01)&lt;br/&gt;
Java HotSpot(TM) Client VM (build 1.4.1_06-b01, mixed mode)</environment>
        <key id="12359488">DERBY-2202</key>
            <summary>DROP PROCEDURE depends on SET SCHEMA</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yipng">Yip Ng</assignee>
                                    <reporter username="bodenstorfer">Bernhard Bodenstorfer</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Dec 2006 13:51:30 +0000</created>
                <updated>Mon, 5 Jul 2010 18:12:46 +0100</updated>
                            <resolved>Mon, 1 Jan 2007 21:13:29 +0000</resolved>
                                    <version>10.2.2.0</version>
                                    <fixVersion>10.2.2.1</fixVersion>
                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12461480" author="fuzzylogic" created="Sat, 30 Dec 2006 08:10:19 +0000"  >&lt;p&gt;On a hunch, I suspected something might not be getting cleaned up properly from the transaction for the DROP PROCEDURE statement. A quick test showed that if I turned off autocommit in ij, the problem goes away. Turn it back on, it returns. Attaching an ij script based on the description of the issue that demonstrates this.&lt;/p&gt;</comment>
                            <comment id="12461596" author="yipng" created="Mon, 1 Jan 2007 02:41:18 +0000"  >&lt;p&gt;Attaching patch derby2202-trunk-diff01.txt and additional testcases for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2202&quot; title=&quot;DROP PROCEDURE depends on SET SCHEMA&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2202&quot;&gt;&lt;del&gt;DERBY-2202&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
The symptom of this jira is the same as those described in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1304&quot; title=&quot;DROP view does not always completely remove view&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1304&quot;&gt;&lt;del&gt;DERBY-1304&lt;/del&gt;&lt;/a&gt; for DROP VIEW except that it applies to DROP PROCEDURE, DROP FUNCTION and DROP SYNONYM statements.  (Their bind logic are centralized in DropAliasNode.)  The DropAliasNode&apos;s bindStatement() should have created a dependency on the statement, so when its associated alias descriptor gets dropped, the statement can be invalidated accordingly. This explains why subsequent DROP PROCEDURE statement fails.&lt;/p&gt;

&lt;p&gt;derbyall and junit suite passes successfully.  Appreciate if someone can review this patch.  Thanks.&lt;/p&gt;</comment>
                            <comment id="12461599" author="yipng" created="Mon, 1 Jan 2007 05:16:39 +0000"  >&lt;p&gt;Just a minor note on the added tests, depend.sql has been moved to Lang JUnit suite from derbylang, so to run the newly added tests in depend.sql:&lt;/p&gt;

&lt;p&gt;java org.apache.derbyTesting.functionTests.tests.lang.LangScripts depend&lt;/p&gt;</comment>
                            <comment id="12461626" author="bryanpendleton" created="Mon, 1 Jan 2007 17:21:13 +0000"  >&lt;p&gt;Hi Yip,&lt;/p&gt;

&lt;p&gt;Thanks for the quick work and the clear explanation and the good tests.&lt;br/&gt;
The patch looks good to me; I intend to run a few tests and commit it.&lt;/p&gt;

&lt;p&gt;One question: why is grantRevokeDDL.out changed? I see that it is just&lt;br/&gt;
a different SQLState, but what is actually going on there?&lt;/p&gt;</comment>
                            <comment id="12461633" author="yipng" created="Mon, 1 Jan 2007 18:36:09 +0000"  >&lt;p&gt;Hi Bryan:&lt;/p&gt;

&lt;p&gt;Thanks for reviewing the patch.  The SQLSTATE now is reported in bind phase instead of at execution due to the fix. (the prepared statement for the DROP FUNCTION has been invalidated.)&lt;/p&gt;

&lt;p&gt;ERROR 42X94: FUNCTION &apos;SELECTFROMSPECIFICSCHEMA&apos; does not exist.&lt;/p&gt;

&lt;p&gt;ERROR 42Y55: &apos;DROP FUNCTION&apos; cannot be performed on &apos;SELECTFROMSPECIFICSCHEMA&apos; because it does not exist.&lt;/p&gt;
</comment>
                            <comment id="12461644" author="bryanpendleton" created="Mon, 1 Jan 2007 21:13:29 +0000"  >&lt;p&gt;Thanks Yip. That makes perfect sense. It seems that grantRevokeDDL&lt;br/&gt;
was actually demonstrating the presence of the bug, but we didn&apos;t&lt;br/&gt;
recognize it before because the error message didn&apos;t obviously show&lt;br/&gt;
the problem. I committed the patch to the trunk as revision 491632.&lt;/p&gt;

&lt;p&gt;Should we merge this fix back to 10.2? If so, is there anything tricky in the merge?&lt;/p&gt;
</comment>
                            <comment id="12462017" author="yipng" created="Wed, 3 Jan 2007 18:31:34 +0000"  >&lt;p&gt;Hi Bryan, attached derby2202-10.2-diff01.txt for 10.2.  &lt;/p&gt;

&lt;p&gt;For 10.2, lang/depend.sql appears to be in the derbylang suite.  I will run derbyall later today against 10.2 and will post the result here.&lt;/p&gt;</comment>
                            <comment id="12462037" author="myrna" created="Wed, 3 Jan 2007 19:40:03 +0000"  >&lt;p&gt;I updated the j9_foundation canon for grantRevokeDDL.out with revision: 492253 (see: &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=492253&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=492253&lt;/a&gt;). This should merge cleanly to 10.2.&lt;/p&gt;</comment>
                            <comment id="12462080" author="yipng" created="Wed, 3 Jan 2007 23:11:14 +0000"  >&lt;p&gt;derbyall ran successfully with 10.2&lt;/p&gt;</comment>
                            <comment id="12462091" author="bryanpendleton" created="Wed, 3 Jan 2007 23:51:01 +0000"  >&lt;p&gt;I intend to commit derby2202-10.2-diff01.txt, together with Myrna&apos;s updated j9&lt;br/&gt;
reference file change 492253, to the 10.2 branch, as a single combined change.&lt;/p&gt;</comment>
                            <comment id="12462120" author="bryanpendleton" created="Thu, 4 Jan 2007 03:02:25 +0000"  >&lt;p&gt;Committed the 10.2 changes to subversion as revision 492392&lt;/p&gt;</comment>
                            <comment id="12562061" author="dyret" created="Thu, 24 Jan 2008 13:10:09 +0000"  >&lt;p&gt;This issue is resolved and has not been updated in the last 12 months (since 24/Jan/07). &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12348108" name="2202_repro.sql" size="1006" author="fuzzylogic" created="Sat, 30 Dec 2006 08:10:19 +0000"/>
                            <attachment id="12348213" name="derby2202-10.2-diff01.txt" size="7474" author="yipng" created="Wed, 3 Jan 2007 18:26:10 +0000"/>
                            <attachment id="12348212" name="derby2202-10.2-stat01.txt" size="412" author="yipng" created="Wed, 3 Jan 2007 18:26:10 +0000"/>
                            <attachment id="12348130" name="derby2202-trunk-diff01.txt" size="7569" author="yipng" created="Mon, 1 Jan 2007 02:41:18 +0000"/>
                            <attachment id="12348129" name="derby2202-trunk-stat01.txt" size="412" author="yipng" created="Mon, 1 Jan 2007 02:41:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 30 Dec 2006 08:10:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22942</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0psn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37997</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>