<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:16 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4089/DERBY-4089.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4089] It should be possible to run unit tests right after &quot;ant all&quot;</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4089</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Right now, the property &quot;derby.junit.classpath&quot; is empty by default. There should be an ant target which sets the correct classpath to run all tests after an initial checkout and &quot;ant all&quot;.&lt;/p&gt;

&lt;p&gt;The current situation is very confusing to beginners and people who try to build Derby for the first time. For example, when running the tests, I got this exception:&lt;/p&gt;

&lt;p&gt;java.lang.ClassNotFoundException: org.apache.derbyTesting.junit.EnvTest&lt;/p&gt;

&lt;p&gt;but that class was there, the file was there, everything was correct. Googling for the error didn&apos;t turn anything up, either. It took me a while to believe that build.xml just wouldn&apos;t try to setup a classpath for the tests.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12416536">DERBY-4089</key>
            <summary>It should be possible to run unit tests right after &quot;ant all&quot;</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kristwaa">Kristian Waagan</assignee>
                                    <reporter username="digulla">Aaron Digulla</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Mar 2009 14:10:27 +0000</created>
                <updated>Mon, 17 Jun 2013 10:19:11 +0100</updated>
                            <resolved>Wed, 15 Jun 2011 13:36:39 +0100</resolved>
                                    <version>10.4.2.0</version>
                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Build tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12680470" author="kristwaa" created="Tue, 10 Mar 2009 14:18:13 +0000"  >&lt;p&gt;I agree this problem should be addressed.&lt;br/&gt;
A few of the targets do set the classpath, most don&apos;t. &lt;br/&gt;
It should be possible to easily override the classpath, as there are three sources; classes, sane jars and insane jars.&lt;/p&gt;

&lt;p&gt;The classes directory is nice to use when doing development, as you don&apos;t have to wait for the jars to be built, but additional problems can be detected when running with the product jars.&lt;/p&gt;</comment>
                            <comment id="12680479" author="digulla" created="Tue, 10 Mar 2009 14:38:54 +0000"  >&lt;p&gt;I suggest to make &quot;classes&quot; the default (because a novice user will use that first and it fits 95% of the use cases). Experienced developers can then override the default with sane and insane jars (nice name &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, as they see fit because they have the information to make such a decision.&lt;/p&gt;</comment>
                            <comment id="12680499" author="kristwaa" created="Tue, 10 Mar 2009 14:59:51 +0000"  >&lt;p&gt;Sounds like a good approach to me.&lt;br/&gt;
A problem with using the jars, is that novice users may end up running the tests against stale code as the &apos;ant all&apos; target doesn&apos;t rebuild the jar files.&lt;/p&gt;</comment>
                            <comment id="12680505" author="rhillegas" created="Tue, 10 Mar 2009 15:11:22 +0000"  >&lt;p&gt;Hi Aaron and Kristian,&lt;/p&gt;

&lt;p&gt;I think that the jar files are a better default than the classpath. I think that the tests are more meaningful when they run against the production configuration (jar files)--and building the jar files does not seem like a big burden to me. I would go so far as to say that testing against the production configuration is the only meaningful barrier to checkin. Some tests only run against jar files (like the autoloading of the jdbc drivers and the automatic installation of the network security manager). The production configuration catches tricky packaging issues in which developers forget to update the build logic to supplement the jars with classes which are loaded by reflection rather than reference.&lt;/p&gt;</comment>
                            <comment id="12680514" author="kristwaa" created="Tue, 10 Mar 2009 15:44:04 +0000"  >&lt;p&gt;Rick,&lt;/p&gt;

&lt;p&gt;Do you consider both the sane and the insane jars as a production configuration?&lt;/p&gt;

&lt;p&gt;I actually find that building the jars is a small burden when I do quick iterative development. If we choose to use the jars as the default, I think we should consider including the build target for the jars in the default target (currently &apos;buildsource&apos;) or &apos;all&apos;.&lt;br/&gt;
It&apos;s acceptable that the subsequent test run fails the first time when I haven&apos;t built the jars, but after that first time my new code will be ignored unless the jars are automatically updated. We could of course make the build detect stale jars.&lt;br/&gt;
If we aim for testing of the production configuration, also for novice users / casual developers, shouldn&apos;t we also include the &apos;clobber&apos; target in the default target?&lt;/p&gt;

&lt;p&gt;Even experienced developers have checked in code that breaks the build or tests because they didn&apos;t run the tests against jars, so I&apos;m thinking there must be a reason why &lt;span class=&quot;error&quot;&gt;&amp;#91;some&amp;#93;&lt;/span&gt; people choose the classes directory over the jars. I agree that running with jars catches more issues, I feel the question is more whether it should be the default configuration to do so or not (&quot;out-of-the-box experience&quot;?).&lt;/p&gt;</comment>
                            <comment id="12680518" author="digulla" created="Tue, 10 Mar 2009 15:55:47 +0000"  >&lt;p&gt;The default should work for most people, that&apos;s why it&apos;s the &quot;default&quot;. As soon as you know your way around the source, a developer can define his own property file and override the default. But that simply doesn&apos;t work for novices.&lt;/p&gt;

&lt;p&gt;Also, novices have no commit rights. So I can&apos;t see how making life harder for them is going to help solve deeper development issues with Java and the Derby team. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12680521" author="rhillegas" created="Tue, 10 Mar 2009 16:02:04 +0000"  >&lt;p&gt;Hi Kristian,&lt;/p&gt;

&lt;p&gt;Technically, I think that we should run the tests against both the sane and the insane jars. One configuration verifies the production configuration. The other verifies some assumptions. But over the last 4 years we haven&apos;t seen a lot of difference in tests run against sane vs. insane jars. I would say that we have seen a number of cases where the jar tests broke even though the classpath tests succeeded.&lt;/p&gt;</comment>
                            <comment id="13046503" author="kristwaa" created="Thu, 9 Jun 2011 13:29:25 +0100"  >&lt;p&gt;Attaching patch 1a, which tries to make everyone happier &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The classpath for the junit targets will be set automatically, with the following preferences:&lt;br/&gt;
 o if derby.junit.classpath is specified by the user, don&apos;t do anything&lt;br/&gt;
 o if derby.junit.classpath is unspecified&lt;br/&gt;
    o look for insane jars&lt;br/&gt;
    o look for sane jars&lt;br/&gt;
    o if either of them are found, set derby.junit.classpath to empty string and set derby.junit.test.jars to point to the directory with the jars&lt;br/&gt;
 o if no jars are located, set derby.junit.classpath to the classes-directory&lt;br/&gt;
 o additionally, ant will append the user&apos;s CLASSPATH environment variable to the junit classpath&lt;/p&gt;

&lt;p&gt;I also added an informational printout telling which classpath is being used.&lt;/p&gt;

&lt;p&gt;Patch ready for review, although it might be wise to see the outcome of the discussion under this issue and/or &quot;Refactoring ant junit target to automatically set classpath&quot; on derby-dev first.&lt;/p&gt;</comment>
                            <comment id="13049750" author="kristwaa" created="Wed, 15 Jun 2011 13:36:01 +0100"  >&lt;p&gt;Attaching patch 1b (minor changes, i.e. comments).&lt;/p&gt;</comment>
                            <comment id="13049751" author="kristwaa" created="Wed, 15 Jun 2011 13:36:39 +0100"  >&lt;p&gt;Committed patch 1b to trunk with revision 1136011.&lt;/p&gt;</comment>
                            <comment id="13685153" author="knutanders" created="Mon, 17 Jun 2013 10:19:11 +0100"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;bulk update&amp;#93;&lt;/span&gt; Close all resolved issues that haven&apos;t been updated for more than one year.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12412369">DERBY-4021</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12532493">DERBY-5512</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12481919" name="derby-4089-1a-set_classpath.diff" size="8858" author="kristwaa" created="Thu, 9 Jun 2011 13:29:25 +0100"/>
                            <attachment id="12482662" name="derby-4089-1b-set_classpath.diff" size="8869" author="kristwaa" created="Wed, 15 Jun 2011 13:36:01 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 10 Mar 2009 14:18:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31126</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0eif:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36169</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>