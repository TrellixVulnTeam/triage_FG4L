<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:31:49 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-858/DERBY-858.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-858] ijConnName test output order is non-deterministic.</title>
                <link>https://issues.apache.org/jira/browse/DERBY-858</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The test loads four initial connections using these ij.connection properties in the test&apos;s _app.properties file.&lt;/p&gt;

&lt;p&gt;ij.connection.connOne=jdbc:derby:wombat;create=true&lt;br/&gt;
ij.connection.connTwo=jdbc:derby:lemming;create=true&lt;br/&gt;
ij.connection.connThree=jdbc:noone:fruitfly;create=true&lt;br/&gt;
ij.connection.connFour=jdbc:derby:nevercreated&lt;/p&gt;

&lt;p&gt;The order these connections are created, and hence the order of the test output is only determined by the hash table ordering of the properties file. Making small changes in  ijConnName_app.properties files can change the order, making the test appear to fail.&lt;/p&gt;

&lt;p&gt;E.g. I tried to enable the test with a security manager by modifying the noSecurityManger to be set to false, and the order changed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12328017">DERBY-858</key>
            <summary>ijConnName test output order is non-deterministic.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="myrna">Myrna van Lunteren</assignee>
                                    <reporter username="djd">Daniel John Debrunner</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Jan 2006 04:39:25 +0000</created>
                <updated>Wed, 26 May 2010 22:13:33 +0100</updated>
                            <resolved>Wed, 26 May 2010 22:13:33 +0100</resolved>
                                                    <fixVersion>10.3.3.1</fixVersion>
                    <fixVersion>10.4.2.1</fixVersion>
                    <fixVersion>10.5.3.1</fixVersion>
                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12775178" author="myrna" created="Mon, 9 Nov 2009 22:47:16 +0000"  >&lt;p&gt;ij5.sql has the same problem.&lt;br/&gt;
If the hash table ordering is different, this may result in ConnTwo being the first connection made, and so the active connection.&lt;/p&gt;

&lt;p&gt;I think it&apos;s ok for these two tests to not have the 2nd valid pre-defined connection. Does anyone disagree?&lt;/p&gt;</comment>
                            <comment id="12776483" author="myrna" created="Wed, 11 Nov 2009 15:20:21 +0000"  >&lt;p&gt;Attaching a patch for this issue.&lt;/p&gt;

&lt;p&gt;I removed the second connection from the _app.properties file in ijConnName.sql and ij5.sql, (and adjusted comments) and added ijConnName_sed.properties to remove the 08001 and XJ004 errors resulting from connThree and connFour...As a result, I could remove the extra ijConnName and ij5 masters.&lt;/p&gt;

&lt;p&gt;We do lose a tiny bit of information from the test by doing this: an extra 08001 or XJ004 error would go unnoticed, and we don&apos;t see the connection &apos;name&apos; show up in the ij prompt. I think there are other tests that would catch a change in behavior that would cause an extra 08001 or XJ004. &lt;/p&gt;

&lt;p&gt;I found 2 junit tests that had depencies on hashtable ordering: derbynet.SysinfoTest and derbynet.ServerPropertiesTest.&lt;br/&gt;
So I changed the way those tests check for expected values.&lt;/p&gt;</comment>
                            <comment id="12776523" author="knutanders" created="Wed, 11 Nov 2009 17:25:16 +0000"  >&lt;p&gt;The patch looks fine to me. A couple of tiny issues, though:&lt;/p&gt;

&lt;p&gt;1) I noticed that SysinfoTest.searchMatchingString() uses&lt;br/&gt;
String.matches(String), which takes a regex argument. It looks to me&lt;br/&gt;
as if we&apos;re actually looking for exact match here, and not a regex&lt;br/&gt;
match, so it&apos;s probably better to use equals() instead.&lt;/p&gt;

&lt;p&gt;2) The error message generated here can be wrong:&lt;/p&gt;

&lt;p&gt;+            String ns = actualOutputArray&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;;&lt;br/&gt;
+            assertTrue(&quot;Expected String: &quot; + OUTPUT&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt; + &lt;br/&gt;
+                &quot;doesn&apos;t match actual output: &quot; + ns,&lt;br/&gt;
+                searchMatchingString(ns));&lt;br/&gt;
+&lt;/p&gt;

&lt;p&gt;OUTPUT&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt; is not necessarily the string that&apos;s supposed to match&lt;br/&gt;
actualOutputArray&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;, given that the order is JVM dependent (which is&lt;br/&gt;
also why we use searchMatchingString() here and not just&lt;br/&gt;
ns.equals(OUTPUT&lt;span class=&quot;error&quot;&gt;&amp;#91;i&amp;#93;&lt;/span&gt;)).&lt;/p&gt;

&lt;p&gt;3) It looks like you forgot to remove one line of code that was&lt;br/&gt;
commented out:&lt;/p&gt;

&lt;p&gt;+        String [] OUTPUT1 = &lt;/p&gt;
{
+        //String OUTPUT1 = 
+            &quot;--------- Derby Network Server Information --------&quot; , 

4) A couple of instances in SysinfoTest where the closing braces have
been moved to an odd position:

-        assertEquals(OUTPUT, s);
-    }
&lt;p&gt;		&lt;br/&gt;
+        assertMatchingStringExists(s);    }		&lt;/p&gt;</comment>
                            <comment id="12776700" author="myrna" created="Wed, 11 Nov 2009 22:42:04 +0000"  >&lt;p&gt;Thanks Knut for the review.&lt;br/&gt;
Attaching a second patch; I believe this addresses your comments.&lt;br/&gt;
I plan to commit this to trunk and backport to 10.5.&lt;/p&gt;</comment>
                            <comment id="12776723" author="knutanders" created="Wed, 11 Nov 2009 23:10:39 +0000"  >&lt;p&gt;Thanks, Myrna, for addressing my comments. The latest patch looks fine.&lt;/p&gt;</comment>
                            <comment id="12777028" author="myrna" created="Thu, 12 Nov 2009 15:49:28 +0000"  >&lt;p&gt;Merge to 10.5 was not clean for ServerPropertiesTest and SysinfoTest (I think because of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4217&quot; title=&quot;Make the default port for the suites.All run configurable with a system property.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4217&quot;&gt;&lt;del&gt;DERBY-4217&lt;/del&gt;&lt;/a&gt;), so I&apos;m attaching a patch that does the backport. I intend to commit in a couple of hours. tests ran clean.&lt;/p&gt;</comment>
                            <comment id="12777101" author="myrna" created="Thu, 12 Nov 2009 18:28:59 +0000"  >&lt;p&gt;committed to trunk with revision 835153 and backported to 10.5 with revision  835482.&lt;br/&gt;
Interesting svn quirk: the merged added file didn&apos;t show up when I did svn diff on 10.5. But it was there with svn stat and it seems to have been correctly added.&lt;/p&gt;</comment>
                            <comment id="12781690" author="myrna" created="Mon, 23 Nov 2009 22:57:33 +0000"  >&lt;p&gt;Reopening to address an issue with the SysinfoTest on DOS (i.e. Windows but not using a shell environment like cygwin); it will give a diff like so:&lt;br/&gt;
1) testSysinfoLocale(org.apache.derbyTesting.functionTests.tests.derbynet.SysinfoTest)junit.framework.AssertionFailedError: expected:&amp;lt;14&amp;gt; but was:&amp;lt;1&amp;gt;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SysinfoTest.assertMatchingStringExists(SysinfoTest.java:322)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SysinfoTest.testSysinfoLocale(SysinfoTest.java:249)&lt;/p&gt;</comment>
                            <comment id="12871956" author="myrna" created="Wed, 26 May 2010 22:13:33 +0100"  >&lt;p&gt;closing again; the error for which I reopened looks the same to me as &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4617&quot; title=&quot;Sysinfo.testSysinfoLocale failed with IB47 M 1.6 on Windows 7 64bit&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4617&quot;&gt;&lt;del&gt;DERBY-4617&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
Marking also closed in 10.3 and 10.4 as I&apos;ve backported the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4536&quot; title=&quot;testProperties and sysinfo_withproperties test failures with ibm 1.6 on 10.3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4536&quot;&gt;&lt;del&gt;DERBY-4536&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12424610" name="DERBY-858.diff" size="28738" author="myrna" created="Wed, 11 Nov 2009 15:20:21 +0000"/>
                            <attachment id="12424662" name="DERBY-858.diff2" size="28220" author="myrna" created="Wed, 11 Nov 2009 22:42:04 +0000"/>
                            <attachment id="12424721" name="DERBY-858_105.diff" size="27851" author="myrna" created="Thu, 12 Nov 2009 15:49:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 9 Nov 2009 22:47:16 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22177</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0q7r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38065</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>