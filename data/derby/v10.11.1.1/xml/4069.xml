<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:23:18 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4069/DERBY-4069.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4069] Wrong behavior when ROW_NUMBER is combined with ORDER BY</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4069</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The regression test OLAPTest.java contains this query:&lt;/p&gt;

&lt;p&gt;   create table t1 (a int, b int)&lt;br/&gt;
   insert into t1 values (10,100),(20,200),(30,300),(40,400),(50,500)&lt;br/&gt;
   select row_number() over () as r, t1.* from t1 order by b desc&lt;/p&gt;

&lt;p&gt;and the result is asserted to be&lt;/p&gt;

&lt;p&gt;   expectedRows = new String[][]{{&quot;1&quot;, &quot;50&quot;, &quot;500&quot;}, &lt;br/&gt;
                                 &lt;/p&gt;
{&quot;2&quot;, &quot;40&quot;, &quot;400&quot;}
&lt;p&gt;, &lt;br/&gt;
                                 &lt;/p&gt;
{&quot;3&quot;, &quot;30&quot;, &quot;300&quot;}
&lt;p&gt;,&lt;br/&gt;
                                 &lt;/p&gt;
{&quot;4&quot;, &quot;20&quot;, &quot;200&quot;}
&lt;p&gt;, &lt;br/&gt;
                                 {&quot;5&quot;, &quot;10&quot;, &quot;100&quot;}};&lt;/p&gt;

&lt;p&gt;The test succeeds, but I believe the canon is wrong here.&lt;/p&gt;

&lt;p&gt;ORDER BY should be applied at the cursor level, that is &lt;em&gt;after&lt;/em&gt; a&lt;br/&gt;
windowing clause in the select expression has been applied, so we would&lt;br/&gt;
expect to see:&lt;/p&gt;

&lt;p&gt;   &lt;/p&gt;
{&quot;5&quot;, &quot;50&quot;, &quot;500&quot;}
&lt;p&gt;, &lt;/p&gt;
{&quot;4&quot;, &quot;40&quot;, &quot;400&quot;}
&lt;p&gt; ...&lt;/p&gt;

&lt;p&gt;Note: It should be added that since the window does not contain any&lt;br/&gt;
&amp;lt;window order clause&amp;gt;, cf. SQL:2003 section 7.11, the actual ordering&lt;br/&gt;
of the rows in the window is implementation dependent.  In Derby,&lt;br/&gt;
without the query&apos;s ORDER BY, the rows are ordered as in the INSERT&lt;br/&gt;
statement above, so I think this reflects a bug in the&lt;br/&gt;
implementation.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12415425">DERBY-4069</key>
            <summary>Wrong behavior when ROW_NUMBER is combined with ORDER BY</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Feb 2009 23:54:07 +0000</created>
                <updated>Fri, 23 Oct 2009 23:49:36 +0100</updated>
                            <resolved>Fri, 23 Oct 2009 23:49:36 +0100</resolved>
                                    <version>10.4.1.3</version>
                    <version>10.4.2.0</version>
                                    <fixVersion>10.6.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12726842" author="knutanders" created="Fri, 3 Jul 2009 10:25:30 +0100"  >&lt;p&gt;Triaged for 10.5.2.&lt;/p&gt;</comment>
                            <comment id="12746938" author="dagw" created="Mon, 24 Aug 2009 17:13:01 +0100"  >&lt;p&gt;There is a patch under &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3634&quot; title=&quot;Cannot use row_number() in ORDER BY clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3634&quot;&gt;&lt;del&gt;DERBY-3634&lt;/del&gt;&lt;/a&gt; that fixes this issue as well; marking patch available.&lt;/p&gt;</comment>
                            <comment id="12769514" author="dagw" created="Fri, 23 Oct 2009 23:49:36 +0100"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3634&quot; title=&quot;Cannot use row_number() in ORDER BY clause&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3634&quot;&gt;&lt;del&gt;DERBY-3634&lt;/del&gt;&lt;/a&gt; has been resolved with a patch that fixes this issues as well, so closing.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12394334">DERBY-3634</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10367"><![CDATA[Deviation from standard]]></customfieldvalue>
    <customfieldvalue key="10366"><![CDATA[Wrong query result]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 3 Jul 2009 09:25:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24006</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0rnr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38299</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310050" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Urgency</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10052"><![CDATA[Normal]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>