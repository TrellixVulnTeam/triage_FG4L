<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:50:27 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1643/DERBY-1643.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1643] A  &quot;revoke execute ... restrict&quot; should fail if there are dependent objects on the execute privilege</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1643</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;As per the functional spec attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1330&quot; title=&quot;Provide runtime privilege checking for grant/revoke functionality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1330&quot;&gt;&lt;del&gt;DERBY-1330&lt;/del&gt;&lt;/a&gt;, a &quot;revoke execute ... restrict&quot; should fail if there are dependent objects on the execute privilege&lt;/p&gt;

&lt;p&gt;In order to implement this, when revoke execute is executed, a special invalidation action should be sent and dependent objects will need to catch that invalidation and throw an exception. If there are no dependents, then no exception will be thrown and revoke execute will succeed.&lt;/p&gt;

&lt;p&gt;I am just creating a new jira entry here so it is easier to track sub items of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1330&quot; title=&quot;Provide runtime privilege checking for grant/revoke functionality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1330&quot;&gt;&lt;del&gt;DERBY-1330&lt;/del&gt;&lt;/a&gt;. Will link this Jira entry to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1330&quot; title=&quot;Provide runtime privilege checking for grant/revoke functionality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1330&quot;&gt;&lt;del&gt;DERBY-1330&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;See the functional spec attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1330&quot; title=&quot;Provide runtime privilege checking for grant/revoke functionality&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1330&quot;&gt;&lt;del&gt;DERBY-1330&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12347285">DERBY-1643</key>
            <summary>A  &quot;revoke execute ... restrict&quot; should fail if there are dependent objects on the execute privilege</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mamtas">Mamta A. Satoor</assignee>
                                    <reporter username="mamtas">Mamta A. Satoor</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Aug 2006 03:51:52 +0100</created>
                <updated>Wed, 1 Jul 2009 01:34:43 +0100</updated>
                            <resolved>Wed, 30 Aug 2006 07:29:01 +0100</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12425853" author="mamtas" created="Fri, 4 Aug 2006 21:44:13 +0100"  >&lt;p&gt;Here is the next incremental patch(DERBY1643_diff_V1_RevokeExecutePrivilege.txt) for revoke privileges related to routines. The o/p of svn stat -q is attached as DERBY1643_stat_V1_RevokeExecutePrivilege.txt. Also, derbyall ran fine with Sun&apos;s jdk 1.4 on Windows XP platform.&lt;/p&gt;

&lt;p&gt;In Derby, the execute permission on a routine can&apos;t be revoked as long as there are dependent objects relying on that permissions. This patch implements that behavior by adding a new revoke invalidation action REVOKE_EXECUTE_PRIVILEGE, just for routine revoke. This invalidation gets sent when a revoke execute is issued. When dependents, a ViewDescriptor and/or a TriggerDescriptor, get this invalidation action, they will raise error that revoke execute can&apos;t be performed because there is a dependent object on that permission.&lt;/p&gt;

&lt;p&gt;In general, there can be 3 kind of persistent dependents on a permission. They are namely, a ViewDescriptor, a TriggerDescriptor, and a ConstraintDescriptor. But in Derby, a constraint can&apos;t use a routine and hence a constraint can&apos;t possibly depend on execute privilege. If ever, for some unknown reason(bug), a ConstraintDescriptor will receive REVOKE_EXECUTE_PRIVILEGE, Derby will end up throwing an exception saying that revoke execute can&apos;t be performed because there is a dependent object on it.&lt;/p&gt;


&lt;p&gt;Test changes&lt;br/&gt;
1)Have a view depend on the execute routine privilege. &quot;Revoke execute ... restrict&quot; will fail as long as the view exists. Once the view is dropped, since there are no more dependents on execute routine privilege, &quot;Revoke execute ... restrict&quot; will pass.&lt;br/&gt;
2)Similar test for trigger. If trigger is relying on a execute routine privilege, then that privilege can&apos;t be revoked as long as trigger is still around. After the trigger is dropped, execute routine privilege can be revoked.&lt;br/&gt;
3)In addition, I added a test which is not directly related to revoke routine work. Just an additional test for grant revoke. In this test, I have couple triggers on a single table depend on different privileges. When a privilege is revoked, only the&lt;br/&gt;
affected triggers get dropped, the rest of the triggers should remain still active.&lt;/p&gt;</comment>
                            <comment id="12425911" author="djd" created="Sat, 5 Aug 2006 01:25:19 +0100"  >&lt;p&gt;Patch committed revision 428930. Thanks Mamta&lt;/p&gt;</comment>
                            <comment id="12425913" author="djd" created="Sat, 5 Aug 2006 01:30:56 +0100"  >&lt;p&gt;I committed the patch but believe there should be a follow up. The new constant defined for the revoke invalidation is REVOKE_EXECUTE_PRIVILEGE, but I think it&apos;s factored in the wrong dimension. I think the behaviour being implemented is revoke restrict, and thus the constant should be: REVOKE_PRIVILEGE_RESTRICT.&lt;/p&gt;

&lt;p&gt;Probably good to change this early rather than having some REVOKE constants meaning cascade and some restrict but no consistent naming.&lt;/p&gt;

&lt;p&gt;I would have made a simple name change in Eclipse, but the comments around REVOKE_EXECUTE_PRIVILEGE wouldn&apos;t apply to the new name so it&apos;s a little more involved. Also with the REVOKE_PRIVILEGE_RESTRICT the descriptors could be modified to throw the exception even if today they don&apos;t support routines (eg. constraints) would make the code &quot;self-healing&quot; when check constraints support function calls.&lt;/p&gt;</comment>
                            <comment id="12426078" author="mamtas" created="Sun, 6 Aug 2006 19:51:06 +0100"  >&lt;p&gt;Dan, I have attached a patch (DERBY1643_diff_V2_RevokeExecutePrivilege.txt) which renames the constant for revoke restrict invalidation action. The svn stat -q o/p is attached as DERBY1643_stat_V2_RevokeExecutePrivilege.txt.&lt;/p&gt;

&lt;p&gt;I only ran the 2 grant revoke tests since nothing else should get impacted by this change (or so I think&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12426957" author="djd" created="Wed, 9 Aug 2006 17:18:10 +0100"  >&lt;p&gt;Cleaning the summary&lt;/p&gt;</comment>
                            <comment id="12430043" author="djd" created="Wed, 23 Aug 2006 17:49:23 +0100"  >&lt;p&gt; DERBY1643_diff_V2_RevokeExecutePrivilege.txt patch was applied on 8/9 - thanks Mamta&lt;/p&gt;</comment>
                            <comment id="12431488" author="mamtas" created="Wed, 30 Aug 2006 07:29:01 +0100"  >&lt;p&gt;Closing this issue since I am finished with the work targeted for 10.2 release. The remaining work for this issue is getting tracked in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1632&quot; title=&quot;During revoke privilege, Derby does not look for replacement privilege for the dependent objects and simply drops the dependent objects. This is not SQL compliant and should be fixed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1632&quot;&gt;DERBY-1632&lt;/a&gt;. I will link the 2 issues so we can keep track of the correlation between the 2 jira entries.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12347283">DERBY-1642</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12343197">DERBY-1330</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12347134">DERBY-1632</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12338184" name="DERBY1643_diff_V1_RevokeExecutePrivilege.txt" size="27214" author="mamtas" created="Fri, 4 Aug 2006 21:44:13 +0100"/>
                            <attachment id="12338232" name="DERBY1643_diff_V2_RevokeExecutePrivilege.txt" size="13532" author="mamtas" created="Sun, 6 Aug 2006 19:51:06 +0100"/>
                            <attachment id="12338185" name="DERBY1643_stat_V1_RevokeExecutePrivilege.txt" size="719" author="mamtas" created="Fri, 4 Aug 2006 21:44:13 +0100"/>
                            <attachment id="12338233" name="DERBY1643_stat_V2_RevokeExecutePrivilege.txt" size="545" author="mamtas" created="Sun, 6 Aug 2006 19:51:06 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 5 Aug 2006 00:25:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30086</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0sov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38466</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>