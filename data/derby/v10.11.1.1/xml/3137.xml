<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:40:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3137/DERBY-3137.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3137] SQL roles: add catalog support</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3137</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;As a next step after adding support for the roles syntax, I intend to&lt;br/&gt;
make a patch which implements catalog support for roles,&lt;br/&gt;
cf. SYS.SYSROLES described in the specification (attached to&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2207&quot; title=&quot;Improve usability of Derby&amp;#39;s client/server security by implementing ANSI Roles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2207&quot;&gt;&lt;del&gt;DERBY-2207&lt;/del&gt;&lt;/a&gt;). Also the patch should tie this support up to the parser&lt;br/&gt;
support, so the role statements can be executed. Any privileges&lt;br/&gt;
granted to roles would still have no effect at run-time.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12380756">DERBY-3137</key>
            <summary>SQL roles: add catalog support</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Oct 2007 10:24:19 +0100</created>
                <updated>Tue, 30 Jun 2009 01:14:37 +0100</updated>
                            <resolved>Fri, 2 Jan 2009 18:05:58 +0000</resolved>
                                                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                            <comments>
                            <comment id="12540218" author="dagw" created="Mon, 5 Nov 2007 17:02:11 +0000"  >&lt;p&gt;Uploading a patch, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt; for initial review. Please see uploaded&lt;br/&gt;
patch description (*.txt) for details as well as functional&lt;br/&gt;
specification attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2207&quot; title=&quot;Improve usability of Derby&amp;#39;s client/server security by implementing ANSI Roles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2207&quot;&gt;&lt;del&gt;DERBY-2207&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The patch is a bit on the big side, so feel free to post partial&lt;br/&gt;
reviews. &lt;/p&gt;

&lt;p&gt;I have tried to stick to established patterns in the code, but I will&lt;br/&gt;
likely have overlooked or misunderstood things since I haven&apos;t&lt;br/&gt;
ventured too much into these areas before, so don&apos;t assume I&apos;m right&lt;br/&gt;
&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Regression tests ran cleanly.&lt;/p&gt;</comment>
                            <comment id="12540229" author="dagw" created="Mon, 5 Nov 2007 18:18:09 +0000"  >&lt;p&gt;Uploading patch again, a wrong version of RolesTest.java was accidentally included.&lt;/p&gt;</comment>
                            <comment id="12540294" author="rhillegas" created="Mon, 5 Nov 2007 23:01:27 +0000"  >&lt;p&gt;Hi Dag,&lt;/p&gt;

&lt;p&gt;Thanks for the extensive patch description and regression tests. Also, thanks for adding the SHOW ROLES command. I think it&apos;s very useful.&lt;/p&gt;

&lt;p&gt;1) ij.jj: Comment on showRoles() refers to SYSTABLES. I think SYSROLES is intended.&lt;/p&gt;

&lt;p&gt;2) SetRoleNode: By the time you get to this node, NONE is understood to mean the same thing as NULL Role. I wonder if this is the solution to your question about disambiguating NONE and &quot;NONE&quot;. Maybe NONE should be what&apos;s meant when someone sets the ? to NULL in a dynamic &quot;SET ROLE ?&quot; statement.&lt;/p&gt;

&lt;p&gt;3) SetRoleConstantAction: Ditto that. You could then eliminate the paragraph which translates &quot;NONE&quot; to NULL.&lt;/p&gt;</comment>
                            <comment id="12540465" author="dagw" created="Tue, 6 Nov 2007 15:56:29 +0000"  >&lt;p&gt;Thanks for the comments, Rick!&lt;/p&gt;

&lt;p&gt;1) Thanks for catching that!&lt;/p&gt;

&lt;p&gt;2, 3) I think this is a reasonable thing to do. I didn&apos;t do it at&lt;br/&gt;
first because I wasn&apos;t able to read this possibility as legal from the&lt;br/&gt;
wording of the standard: Setting a Java null amounts to a SQL NULL on&lt;br/&gt;
the SQL level (JDBC 4.0, &#167;13.2.2.4, p 102), and SQL &#167;18.3 doesn&apos;t seem&lt;br/&gt;
to allow for NULL, cf. for example GR 3.&lt;/p&gt;

&lt;p&gt;Still, I think it is a reasonable thing to do, so unless people&lt;br/&gt;
object, I&apos;ll implement that solution: a Java null value to a dynamic&lt;br/&gt;
set role parameter effectively sets the role to NONE (no current role&lt;br/&gt;
set). A dynamic parameter string of &quot;NONE&quot; will be interpreted as a&lt;br/&gt;
role called NONE.&lt;/p&gt;

&lt;p&gt;BTW: GR2 requires that we trim away blanks at both ends of a string&lt;br/&gt;
value before applying it. I don&apos;t do that presently for SET ROLE,&lt;br/&gt;
because neither does SET SCHEMA. Do we want to become conformant on&lt;br/&gt;
this detail?  Unless we prohibit delimited identifiers from having&lt;br/&gt;
leading or trailing spaces, its seems unwise do do it. We don&apos;t&lt;br/&gt;
presently prohibit that, nor could I find support for prohibiting it&lt;br/&gt;
in the standard, checking syntax rules in &#167;5.2 (Token and separator).&lt;/p&gt;</comment>
                            <comment id="12540936" author="dagw" created="Thu, 8 Nov 2007 00:26:02 +0000"  >&lt;p&gt;Upload a new version of the first patch, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-2, which replaces &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
It implements the strategy for handling NONE proposed, and also fixes the ij&lt;br/&gt;
issue Rick found. &lt;br/&gt;
All regression tests ran OK (Sun Java 1.6).&lt;/p&gt;</comment>
                            <comment id="12541072" author="rhillegas" created="Thu, 8 Nov 2007 16:17:16 +0000"  >&lt;p&gt;Thanks for the new patch, Dag. Looks good to me.&lt;/p&gt;</comment>
                            <comment id="12541376" author="dagw" created="Fri, 9 Nov 2007 16:56:00 +0000"  >&lt;p&gt;Updated write-up, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-2.txt.&lt;/p&gt;</comment>
                            <comment id="12541792" author="dagw" created="Mon, 12 Nov 2007 14:50:03 +0000"  >&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-2 committed as svn 594158.&lt;/p&gt;</comment>
                            <comment id="12560426" author="dagw" created="Fri, 18 Jan 2008 15:16:02 +0000"  >&lt;p&gt;Need to add UUID to SYSROLES columns, to enable persistent&lt;br/&gt;
dependencies on role grants.&lt;/p&gt;</comment>
                            <comment id="12560435" author="dagw" created="Fri, 18 Jan 2008 15:35:59 +0000"  >&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-uuid adds a UUID column to SYSROLES plus&lt;br/&gt;
an extra index and a new access method (get role by its uuid).&lt;br/&gt;
No regressions seen by running suites.All and derbyall.&lt;/p&gt;</comment>
                            <comment id="12560552" author="rhillegas" created="Fri, 18 Jan 2008 21:25:14 +0000"  >&lt;p&gt;Thanks for the patch, Dag. It looks good to me. You may need to warn people to drop their previously created 10.4 databases after you check in this fix.&lt;/p&gt;</comment>
                            <comment id="12560599" author="dagw" created="Fri, 18 Jan 2008 23:28:48 +0000"  >&lt;p&gt;Thanks for reviewing this, Rick! &lt;br/&gt;
Yes, you are right. &lt;br/&gt;
I plan to post a heads-up to derby-dev and hold off the commit to after the week-end:&lt;br/&gt;
Old trunk databases will be incompatible after this patch is committed.&lt;/p&gt;
</comment>
                            <comment id="12561395" author="dagw" created="Tue, 22 Jan 2008 17:52:49 +0000"  >&lt;p&gt;Committed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-uuid as svn 614273. This change will make existing trunk databases invalid, so&lt;br/&gt;
please recreate any trunk database you might have before trying to run with 614273 or higher.&lt;/p&gt;</comment>
                            <comment id="12563731" author="djd" created="Tue, 29 Jan 2008 23:27:03 +0000"  >&lt;p&gt;I think it would be unwise to vary from the standard here:&lt;/p&gt;

&lt;p&gt;If NULL is disallowed as a role name in SET ROLE then Derby should follow that rule, not use NULL to mean NONE, especially when the SQL standard was corrected to not allow the value expression to resolve to the special meaning of NONE.&lt;/p&gt;

&lt;p&gt;Also for the TRIM case, I can&apos;t see any benefit to deviating from the standard.&lt;/p&gt;

&lt;p&gt;Making the code stricter (and follow the standard) is an easier path forwards, than less strict and then having backwards compatibility issues if it&apos;s needed later to strictly enforce the standard.&lt;/p&gt;</comment>
                            <comment id="12563760" author="djd" created="Wed, 30 Jan 2008 00:44:40 +0000"  >&lt;p&gt;In SpecialFunctionNode.java the data type for CURRENT_ROLE indicates it is not nullable, but I thought CURRENT_ROLE returned NULL if no role had been set?&lt;/p&gt;</comment>
                            <comment id="12563793" author="dagw" created="Wed, 30 Jan 2008 01:46:13 +0000"  >&lt;p&gt;&amp;gt; In SpecialFunctionNode.java the data type for CURRENT_ROLE indicates it is not nullable...&lt;/p&gt;

&lt;p&gt;Thanks for catching this! It&apos;s a bug.&lt;/p&gt;</comment>
                            <comment id="12563798" author="dagw" created="Wed, 30 Jan 2008 02:01:14 +0000"  >&lt;p&gt;&amp;gt; If NULL is disallowed as a role name in SET ROLE then Derby should&lt;br/&gt;
&amp;gt; follow that rule, not use NULL to mean NONE, especially when the SQL&lt;br/&gt;
&amp;gt; standard was corrected to not allow the value expression to resolve to&lt;br/&gt;
&amp;gt; the special meaning of NONE.&lt;/p&gt;

&lt;p&gt;So this would mean one could not set a role to NONE using a prepared&lt;br/&gt;
statement with a ? marker, one would need a separate prepared&lt;br/&gt;
statement for the NONE case. I don&apos;t see why the standard needs to be&lt;br/&gt;
so strict here.. But I can tighten this up, sure. I agree with your&lt;br/&gt;
general point thats its better to be tight now and then loosen up rather than&lt;br/&gt;
vice versa.&lt;/p&gt;

&lt;p&gt;&amp;gt; Also for the TRIM case, I can&apos;t see any benefit to deviating from the&lt;br/&gt;
&amp;gt; standard.&lt;/p&gt;

&lt;p&gt;Right, I did consider this, but was I stumped by the case of delimited&lt;br/&gt;
identifiers: If such identifiers could legally contain leading or&lt;br/&gt;
trailing blanks, one could not use them in a &amp;lt;value specification&amp;gt; in&lt;br/&gt;
set role statement?  I chose to follow the example of the SET SCHEMA&lt;br/&gt;
case, which is similary not compliant in this matter, AFAICT. Should&lt;br/&gt;
that be tightened up as well?&lt;/p&gt;</comment>
                            <comment id="12563830" author="djd" created="Wed, 30 Jan 2008 04:36:16 +0000"  >&lt;p&gt;For the TRIM issue the standard says:&lt;/p&gt;

&lt;p&gt;3a) Let S be &amp;lt;value specification&amp;gt; and let V be the character string that is the value of TRIM ( BOTH &apos; &apos; FROM S )&lt;br/&gt;
3b) If V does not conform to the Format and Syntax Rules of a &amp;lt;role name&amp;gt;, then an exception&lt;br/&gt;
condition is raised: invalid role specification.&lt;/p&gt;

&lt;p&gt;Note V needs to conform to the &lt;b&gt;format and syntax rules&lt;/b&gt; of a &amp;lt;role name&amp;gt; which is an &amp;lt;identifier&amp;gt;.&lt;/p&gt;

&lt;p&gt;The discussion over system authorization and user names (&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2109&quot; title=&quot;System privileges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2109&quot;&gt;DERBY-2109&lt;/a&gt;) made the case that this means the format of V is either a regular identifier or a delimited identifier. Ie. the value V needs to contain a regular or delimited identifier with delimited identifiers using double quotes,&lt;/p&gt;

&lt;p&gt;This would mean examples of valid parameters to a SET ROLE ? in a prepared statement are:&lt;/p&gt;

&lt;p&gt;   ps.setString(1, &quot;payadmin&quot;);     // Role CNF of PAYADMIN&lt;br/&gt;
   ps.setString(1, &quot;PAYADMIN&quot;);   // Role CNF of PAYADMIN&lt;/p&gt;

&lt;p&gt;   ps.setString(1, &quot;\&quot;salesadmin\&quot;&quot;);  // Role CNF of salesadmin&lt;/p&gt;

&lt;p&gt;   ps.setString(1, &quot;\&quot;  SPACEADMIN  \&quot;&quot;);  // Role CNF of   SPACEADMIN    (surrounded by spaces on each side)&lt;/p&gt;

&lt;p&gt;Thus any valid identifier can be used in a value specification for SET ROLE.&lt;/p&gt;

&lt;p&gt;Now that doesn&apos;t match what SET SCHEMA does (which should follow the same rules as the SET ROLE) and thus SET SCHEMA is non-standard.&lt;/p&gt;

&lt;p&gt;If this is correct then it&apos;s a choice of following the standard or existing behaviour for a similar command. &lt;/p&gt;

&lt;p&gt;If we follow then standard then we would eventually reach a state where 9/10 &amp;lt;SQL session statements&amp;gt; follow the standard, if we follow the existing behaviour then we reach a state where 1/10 &amp;lt;SQL session statements&amp;gt; follow the standard. (Assuming they have similar syntax requirements, I haven&apos;t checked them all).&lt;/p&gt;

</comment>
                            <comment id="12563842" author="djd" created="Wed, 30 Jan 2008 05:42:19 +0000"  >&lt;p&gt;As a comparison SET ROLE behaves as follows for:&lt;/p&gt;

&lt;p&gt;Postgres : Supports NONE. Role name is an identifier or a literal&lt;br/&gt;
   quote: &quot;PostgreSQL allows identifier syntax (&quot;rolename&quot;), while the SQL standard requires the role name to be written as a string literal.&quot;&lt;/p&gt;

&lt;p&gt;Oracle: Supports NONE. Role name seems to be only an identifier.&lt;/p&gt;

&lt;p&gt;DB2: Does not support NONE. Role name seems to be only an identifier.&lt;br/&gt;
    Also DB2&apos;s SET ROLE is used to verify membership of a role, it doesn&apos;t set the current role (DB2 performs authorization based upon the user id).&lt;/p&gt;

&lt;p&gt;The only commonality seems to be use of an identifier, which is not SQL standard, though it&apos;s ok for Derby as a &quot;de-facto&quot; standard.&lt;/p&gt;

&lt;p&gt;DB2 also reserves some roles for use as system roles, ie. any role beginning with SYS. If we imagine a day when Derby might need builtin roles for system administration it would be good to protect a namespace now, rather than introducing one later.&lt;/p&gt;
</comment>
                            <comment id="12564039" author="dagw" created="Wed, 30 Jan 2008 15:00:46 +0000"  >&lt;p&gt;So, to clarify further, the following would be equivalent:&lt;/p&gt;

&lt;p&gt;ps.setString(1, &quot;\&quot; SPACEADMIN \&quot;&quot;); // Role CNF of SPACEADMIN (surrounded by spaces on each side)&lt;br/&gt;
ps.setString(1, &quot; \&quot; SPACEADMIN \&quot;     &quot;); // Role CNF of SPACEADMIN (surrounded by spaces on each side).  TRIMable space in value string&lt;/p&gt;

&lt;p&gt;I am OK with moving towards stricter adherence here; I&apos;ll make an update patch.&lt;/p&gt;

&lt;p&gt;Thanks for the suggestion on reserving namespace. Since Derby uses SYS as a reserved schema name, I guess the &quot;SYS-&quot; prefix is as good as any.&lt;br/&gt;
I&apos;ll add this to the specification and make an update patch.&lt;/p&gt;
</comment>
                            <comment id="12564101" author="djd" created="Wed, 30 Jan 2008 17:11:05 +0000"  >&lt;p&gt;SYS- (with the hyphen) means the reserved system roles would be delimited identifiers, would it not be simpler to have ones that can be described using regular identifiers?&lt;/p&gt;</comment>
                            <comment id="12564133" author="djd" created="Wed, 30 Jan 2008 19:18:47 +0000"  >&lt;p&gt;I&apos;m still struggling with the SQL Standard here for SET ROLE (and identifiers in general):&lt;/p&gt;

&lt;p&gt;3a) Let S be &amp;lt;value specification&amp;gt; and let V be the character string that is the value of TRIM ( BOTH &apos; &apos; FROM S )&lt;br/&gt;
3b) If V does not conform to the Format and Syntax Rules of a &amp;lt;role name&amp;gt;, then an exception&lt;br/&gt;
condition is raised: invalid role specification. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2109&quot; title=&quot;System privileges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2109&quot;&gt;DERBY-2109&lt;/a&gt; discussion implied that this means the format of V needs to be that of a SQL identifier (regular or delimited).&lt;/p&gt;

&lt;p&gt;Now CURRENT_ROLE is a valid &amp;lt;value specification&amp;gt;, does this mean CURRENT_ROLE needs to return the role name as SQL identifier, instead of the CNF of the role name? The spec says &quot;value of the current role&quot;.&lt;/p&gt;

&lt;p&gt;I&apos;m not convinced that the conclusion in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-2109&quot; title=&quot;System privileges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-2109&quot;&gt;DERBY-2109&lt;/a&gt; is correct, seems more logical to me that V here should be the CNF of the role name.&lt;/p&gt;

&lt;p&gt;Section 5.2 SR 24) says the CNF of a regular identifier is used in the system catalogs, thus if CURRENT_ROLE is to be used in queries against the catalogs it has to return the CNF of the role name. Which then contradicts SET ROLE and value specification.&lt;/p&gt;

&lt;p&gt;I can&apos;t see any explicit statement about what the &quot;value of the current role&quot; means, or the more general &quot;value of an identifier&quot;.&lt;/p&gt;
</comment>
                            <comment id="12564259" author="dagw" created="Thu, 31 Jan 2008 01:40:57 +0000"  >&lt;p&gt;&amp;gt; SYS- (with the hyphen) means the reserved system roles would be delimited identifiers, would it not be simpler to have ones that can be described using regular identifiers?&lt;/p&gt;

&lt;p&gt;Sorry for the confusion, thats what I meant: &quot;SYS&quot;. No hyphen.&lt;/p&gt;

</comment>
                            <comment id="12564270" author="dagw" created="Thu, 31 Jan 2008 02:17:08 +0000"  >&lt;p&gt;Re: identifiers vs CNF:  Indeed confusing. I think I was under the impression the &amp;lt;values specification&amp;gt; would yield a CNF value, which is&lt;br/&gt;
why I added the extra syntax for using identifers also, like SET SCHEMA does. This is why I was wary of the TRIM I think; a CNF value would not have any protective text quotes around it.&lt;/p&gt;

&lt;p&gt;One interpretation of 5.2 SR 24 could be that CNF values is only ever available as a string value in queries against the system tables? It would then behoove the app to take into account when comparing, but perhaps it would simplify things on the whole?&lt;/p&gt;

&lt;p&gt;Or maybe the standard intends for a comparison of CURRENT_ROLE against information schemas to be an identifer comparison, not a string comparison.. in which case the standard is inconsistent I think.&lt;/p&gt;</comment>
                            <comment id="12566741" author="myrna" created="Thu, 7 Feb 2008 18:52:27 +0000"  >&lt;p&gt;seems to me all current patches were committed.&lt;/p&gt;</comment>
                            <comment id="12571353" author="dagw" created="Fri, 22 Feb 2008 10:58:53 +0000"  >&lt;p&gt;Bug fix in CreateRoleConstantAction committed as svn 630150.&lt;/p&gt;</comment>
                            <comment id="12582181" author="dyret" created="Wed, 26 Mar 2008 08:48:22 +0000"  >&lt;p&gt;Pushing out to 10.5&lt;/p&gt;</comment>
                            <comment id="12594246" author="dagw" created="Mon, 5 May 2008 15:48:09 +0100"  >&lt;p&gt;Uploading a one liner fix for the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-uuid patch: &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-uuid-2.diff.&lt;br/&gt;
RolesTest did not expose this bug, but my experimental patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3223&quot; title=&quot;SQL roles: make use of privileges granted to roles in actual privilege checking&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3223&quot;&gt;&lt;del&gt;DERBY-3223&lt;/del&gt;&lt;/a&gt; did.&lt;/p&gt;
</comment>
                            <comment id="12594249" author="dagw" created="Mon, 5 May 2008 15:55:11 +0100"  >&lt;p&gt;Committed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-uuid-2 as svn 653497.&lt;/p&gt;</comment>
                            <comment id="12599643" author="dagw" created="Sun, 25 May 2008 02:37:02 +0100"  >&lt;p&gt;This patch, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-rename, renames RoleDescriptor to&lt;br/&gt;
RoleGrantDescriptor, cf. discussion in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3666&quot; title=&quot;Make role descriptor a dependency Provider&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3666&quot;&gt;&lt;del&gt;DERBY-3666&lt;/del&gt;&lt;/a&gt;. It also contains other formatting,&lt;br/&gt;
javadoc, minor refactoring and comment changes, but should contain no real&lt;br/&gt;
behavioral changes. &lt;/p&gt;</comment>
                            <comment id="12599732" author="dagw" created="Sun, 25 May 2008 23:48:25 +0100"  >&lt;p&gt;Uploading a slight respin of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-rename patch.&lt;/p&gt;</comment>
                            <comment id="12600230" author="rhillegas" created="Tue, 27 May 2008 19:15:02 +0100"  >&lt;p&gt;Thanks for the renaming patch, Dag. Looks good to me.&lt;/p&gt;</comment>
                            <comment id="12600630" author="dagw" created="Wed, 28 May 2008 23:21:44 +0100"  >&lt;p&gt;Committed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-rename-b as svn 661123.&lt;/p&gt;</comment>
                            <comment id="12633767" author="dagw" created="Tue, 23 Sep 2008 16:33:51 +0100"  >&lt;p&gt;Uploading patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-ijfix. It contains:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;a fix to ij&apos;s &quot;SHOW ROLES&quot; command to give an error message if the driver is&lt;br/&gt;
  not Derby embedded or client. The command does not use database metadata, &lt;br/&gt;
  so the generated select from SYS.SYSROLES is inherently Derby specific.&lt;/li&gt;
	&lt;li&gt;a new simple test for the command, tools/ij_show_roles.sql (run via&lt;br/&gt;
  JUnit/ToolScripts.java). The test is run both the embedded and via the network client.&lt;/li&gt;
	&lt;li&gt;a fix to escape CNF role names to protect the role id when performing DROP ROLE in&lt;br/&gt;
  CleanDatabaseTestSetup#removeRoles (the test above provoked this bug).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Running regressions now.&lt;/p&gt;</comment>
                            <comment id="12633942" author="dagw" created="Tue, 23 Sep 2008 23:31:05 +0100"  >&lt;p&gt;Uploading &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-ijfix again, fixing a small bug.&lt;/p&gt;</comment>
                            <comment id="12634139" author="dagw" created="Wed, 24 Sep 2008 14:40:50 +0100"  >&lt;p&gt;Uploading &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleNoCNF which:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;changes the behavior of SET ROLE ? to interpret the dynamic argument&lt;br/&gt;
  as an undelimited SQL identifier. Up till now, it was interpreted as&lt;br/&gt;
  an identifer in internal (case normal form), but this seems wrong&lt;br/&gt;
  according to SQL 2003, section 18.3, GR3, cf discussion with Dan&lt;br/&gt;
  earlier in this thread. A Java null value is no longer accepted as&lt;br/&gt;
  an argument; &quot;none&quot; should be used also in the dynamic case.  An&lt;br/&gt;
  empty string or a null value will give identifer parse error&lt;br/&gt;
  (&quot;XCXA0&quot;).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  Also, section 18.3, GR2 calls for whitespace to be removed from the&lt;br/&gt;
  string before interpreting it as an identifier. This is now also&lt;br/&gt;
  performed.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;similarly changes the builtin function CURRENT_ROLE to now return a&lt;br/&gt;
  delimited identifer if the role is set, making it &quot;symmetrical&quot; with&lt;br/&gt;
  SET ROLE, that is, the output of CURRENT_ROLE can be used as input&lt;br/&gt;
  to &quot;SET ROLE ?&quot;. When the role is not set, CURRENT_ROLE returns&lt;br/&gt;
  NULL, which can not be used as input to &quot;SET ROLE ?&quot;, it now&lt;br/&gt;
  requires the string &quot;none&quot;. This seems to be what the standard&lt;br/&gt;
  requires.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;  I&apos;d appreciate the community&apos;s opinion on the following question:&lt;br/&gt;
  the standard makes no requirement that the returned identifier be&lt;br/&gt;
  delimited, allowing us to return an undelimited identifier in cases&lt;br/&gt;
  where this is &quot;safe&quot;. Does it add any value to do that or is it&lt;br/&gt;
  better to always return it in delimited form?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;updated tests to new behavior.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Note that with this change, SET ROLE ? and CURRENT_ROLE behaves&lt;br/&gt;
differently from SET SCHEMA and CURRENT_SCHEMA respectively. They are&lt;br/&gt;
still in violation with the standard on this point.&lt;/p&gt;

&lt;p&gt;Running regressions now.&lt;/p&gt;</comment>
                            <comment id="12634149" author="dagw" created="Wed, 24 Sep 2008 15:20:53 +0100"  >&lt;p&gt;Uploading &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleNoCNF again, changing the semantics slightly:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;NONE no longer has a special meaning when used in a dynamic (&quot;SET ROLE ?&quot;)&lt;br/&gt;
  statement, cf. the addendum ISO/IEC 9075-2:2003/Cor.2:2007 section 18.3.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12634491" author="dagw" created="Thu, 25 Sep 2008 15:21:29 +0100"  >&lt;p&gt;Uploading &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleNoCNF-2, since the first version broke&lt;br/&gt;
a test (SQLSessionContextTest). This version ran regressions cleanly.&lt;/p&gt;</comment>
                            <comment id="12634538" author="rhillegas" created="Thu, 25 Sep 2008 17:47:41 +0100"  >&lt;p&gt;Hi Dag,&lt;/p&gt;

&lt;p&gt;Thanks for the patch. One small comment:&lt;/p&gt;

&lt;p&gt;LanguageConnectionContext &amp;amp;  SetRoleConstantAction:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Some confusion may arise by using the acronym &quot;CNF&quot;, which means &quot;Conjunctive Normal Form&quot; elsewhere in our SQL interpreter.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12634556" author="dagw" created="Thu, 25 Sep 2008 18:31:40 +0100"  >&lt;p&gt;Thanks for looking at the patch, Rick! I expanded the abbreviation&lt;br/&gt;
&quot;CNF&quot; to &quot;case normal form&quot; in the comments you indicated&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleNoCNF-3.&lt;/p&gt;
</comment>
                            <comment id="12634561" author="dagw" created="Thu, 25 Sep 2008 18:45:46 +0100"  >
&lt;p&gt;Hi Rick,&lt;/p&gt;


&lt;p&gt;Rick&amp;gt; Rick Hillegas commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
Rick&amp;gt; --------------------------------------&lt;br/&gt;
Rick&amp;gt; &lt;br/&gt;
Rick&amp;gt; Hi Dag,&lt;br/&gt;
Rick&amp;gt; &lt;br/&gt;
Rick&amp;gt; Thanks for the patch. One small comment:&lt;/p&gt;

&lt;p&gt;Just FYI if you didn&apos;t notice, there are two pending patched&lt;br/&gt;
attached to this issue. The other one is &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-ijfix.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Dag&lt;/p&gt;</comment>
                            <comment id="12634574" author="rhillegas" created="Thu, 25 Sep 2008 19:27:50 +0100"  >&lt;p&gt;Thanks for bringing my attention to the &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;&lt;del&gt;ijfix patch, Dag. It looks good. For extra credit, someone may want to implement a similar command which shows the session&apos;s role closure. It&apos;s a useful slug of information&lt;/del&gt;-that is, other databases have bothered to implement the enabled_roles view defined in chapter 11 of the SQL standard (InformationSchema). Thanks.&lt;/p&gt;</comment>
                            <comment id="12634893" author="dagw" created="Fri, 26 Sep 2008 16:26:55 +0100"  >&lt;p&gt;Committed patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-ijfix as svn 699366.&lt;/p&gt;</comment>
                            <comment id="12634906" author="dagw" created="Fri, 26 Sep 2008 16:47:34 +0100"  >&lt;p&gt;Committed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleNoCN-3 as svn 699374, closing.&lt;/p&gt;</comment>
                            <comment id="12634974" author="dagw" created="Fri, 26 Sep 2008 20:18:19 +0100"  >&lt;p&gt;Rick&amp;gt; For extra credit, someone may want to implement a similar&lt;br/&gt;
Rick&amp;gt; command which shows the session&apos;s role closure. It&apos;s a useful slug of&lt;br/&gt;
Rick&amp;gt; information--that is, other databases have bothered to implement the&lt;br/&gt;
Rick&amp;gt; enabled_roles view defined in chapter 11 of the SQL standard&lt;br/&gt;
Rick&amp;gt; (InformationSchema).&lt;/p&gt;

&lt;p&gt;I made a new JIRA for this, &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3886&quot; title=&quot;SQL roles: ij show enabled and settable roles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3886&quot;&gt;&lt;del&gt;DERBY-3886&lt;/del&gt;&lt;/a&gt;, and have uploaded a patch&lt;br/&gt;
suggestion.&lt;/p&gt;</comment>
                            <comment id="12639095" author="dagw" created="Mon, 13 Oct 2008 17:27:13 +0100"  >&lt;p&gt;Uploading a follow-up patch to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleNoCNF;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleNoDynamicNone, which forbids the use&lt;br/&gt;
of NONE as a string value to SET ROLE and adds a test.&lt;/p&gt;

&lt;p&gt;Snipped from source comment:            &lt;/p&gt;

&lt;p&gt;    NONE is a special case and is not allowed with its special meaning&lt;br/&gt;
    in SET ROLE ?. Even if there is a role with case normal form&lt;br/&gt;
    &quot;NONE&quot;, we require it to be delimited here, since it would have&lt;br/&gt;
    had to be delimited to get created, too. We could have chosen to&lt;br/&gt;
    be lenient, but it seems safer to be restrictive.&lt;/p&gt;</comment>
                            <comment id="12639411" author="rhillegas" created="Tue, 14 Oct 2008 14:17:03 +0100"  >&lt;p&gt;Thanks for the patch, Dag. +1 to being restrictive.&lt;/p&gt;</comment>
                            <comment id="12639680" author="dagw" created="Wed, 15 Oct 2008 02:04:07 +0100"  >&lt;p&gt;Thanks for looking at this patch, Rick!&lt;br/&gt;
Committed as svn 704754, closing again.&lt;/p&gt;</comment>
                            <comment id="12657427" author="dagw" created="Wed, 17 Dec 2008 15:31:58 +0000"  >&lt;p&gt;Reopening to add another test case found to be missing after EMMA analysis.&lt;/p&gt;</comment>
                            <comment id="12657429" author="dagw" created="Wed, 17 Dec 2008 15:33:29 +0000"  >&lt;p&gt;Attaching &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-moreTests.&lt;/p&gt;</comment>
                            <comment id="12657430" author="dagw" created="Wed, 17 Dec 2008 15:38:44 +0000"  >&lt;p&gt;Committed as svn 727417, closing.&lt;/p&gt;</comment>
                            <comment id="12657751" author="dagw" created="Thu, 18 Dec 2008 12:41:28 +0000"  >&lt;p&gt;Reopening; EMMA analysis uncovered yet another untested code path,&lt;br/&gt;
test that setting a role which exists, but has not been granted to the user, gives the&lt;br/&gt;
correct error.&lt;/p&gt;</comment>
                            <comment id="12657752" author="dagw" created="Thu, 18 Dec 2008 12:42:47 +0000"  >&lt;p&gt;Uploading &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-moreTests-b which adds a test case for this.&lt;/p&gt;</comment>
                            <comment id="12657755" author="dagw" created="Thu, 18 Dec 2008 12:46:09 +0000"  >&lt;p&gt;Committed patch as svn 727709, closing.&lt;/p&gt;</comment>
                            <comment id="12658077" author="dagw" created="Fri, 19 Dec 2008 12:53:59 +0000"  >&lt;p&gt;Patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleNoCNF changed CURRENT_ROLE to return a SQL&lt;br/&gt;
identifier (no longer case normal form internal representation). This&lt;br/&gt;
means that the return type of VARCHAR(128) is no longer correct,&lt;br/&gt;
cf. SpecialFunctionNode#bindExpression, since quotes may make the&lt;br/&gt;
string longer than 128, even if its internal representation length is&lt;br/&gt;
maximum 128.&lt;/p&gt;

&lt;p&gt;Reopening to fix this.&lt;/p&gt;</comment>
                            <comment id="12658079" author="dagw" created="Fri, 19 Dec 2008 12:57:41 +0000"  >&lt;p&gt;Uploading patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-current_role_type which changes the type to VARCHAR(258), that is&lt;br/&gt;
2 (surrounding text quotes) + 2*128 (max number of characters needing quoting).&lt;/p&gt;</comment>
                            <comment id="12658106" author="rhillegas" created="Fri, 19 Dec 2008 15:53:44 +0000"  >&lt;p&gt;Thanks for the patch, Dag. I notice that the other cases (USER, CURRENT USER, SESSION USER, SYSTEM USER, CURRENT SCHEMA) use DataDictionary.TYPE_SYSTEM_IDENTIFIER as the type of a SQL identifier. Do you think that these other cases should agree with CURRENT ROLE? Do we need to log a bug against the other cases and recommend CURRENT ROLE as a better model?&lt;/p&gt;</comment>
                            <comment id="12658115" author="dagw" created="Fri, 19 Dec 2008 16:26:28 +0000"  >&lt;p&gt;This is because the other functions still return internal case normal form, in violation of the standard.&lt;br/&gt;
We decided to go with the standard for roles. So, yes, I guess we could file an improvement issue for those others.&lt;/p&gt;</comment>
                            <comment id="12658127" author="dagw" created="Fri, 19 Dec 2008 17:14:15 +0000"  >&lt;p&gt;Uploading patch &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleAsStringFix to handle another corner case.&lt;br/&gt;
When setting a role with a literal string argument, we should do the same checks as for dynamic parameter &lt;br/&gt;
on the identifier validity. Added that, plus new test cases.&lt;/p&gt;</comment>
                            <comment id="12658137" author="rhillegas" created="Fri, 19 Dec 2008 17:39:12 +0000"  >&lt;p&gt;Thanks for the setRoleAsStringFix patch, Dag. Looks good to me.&lt;/p&gt;</comment>
                            <comment id="12658538" author="dagw" created="Mon, 22 Dec 2008 13:47:13 +0000"  >&lt;p&gt;Committed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-current_role_type as svn 728691.&lt;/p&gt;</comment>
                            <comment id="12658553" author="dagw" created="Mon, 22 Dec 2008 15:13:30 +0000"  >&lt;p&gt;Thanks for looking at &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleAsStringFix, Rick!&lt;br/&gt;
Uploading a refactored version to remove some redundancy.&lt;br/&gt;
Moved the parser method checkIdentifierLengthLimit to IdUtil&lt;br/&gt;
and introduced IdUtil.parseRoleId.&lt;/p&gt;</comment>
                            <comment id="12660359" author="dagw" created="Fri, 2 Jan 2009 18:05:58 +0000"  >&lt;p&gt;Committed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3137&quot; title=&quot;SQL roles: add catalog support&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3137&quot;&gt;&lt;del&gt;DERBY-3137&lt;/del&gt;&lt;/a&gt;-setRoleAsStringFix-b as svn 730802, closing again.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12359718">DERBY-2207</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12405269">DERBY-3886</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12369149" name="DERBY-3137-2.diff" size="165140" author="dagw" created="Thu, 8 Nov 2007 00:26:02 +0000"/>
                            <attachment id="12369150" name="DERBY-3137-2.stat" size="3575" author="dagw" created="Thu, 8 Nov 2007 00:26:02 +0000"/>
                            <attachment id="12369246" name="DERBY-3137-2.txt" size="15075" author="dagw" created="Fri, 9 Nov 2007 16:56:00 +0000"/>
                            <attachment id="12396485" name="DERBY-3137-current_role_type.diff" size="1553" author="dagw" created="Fri, 19 Dec 2008 12:57:41 +0000"/>
                            <attachment id="12396486" name="DERBY-3137-current_role_type.stat" size="155" author="dagw" created="Fri, 19 Dec 2008 12:57:41 +0000"/>
                            <attachment id="12390796" name="DERBY-3137-ijfix.diff" size="9104" author="dagw" created="Tue, 23 Sep 2008 23:31:05 +0100"/>
                            <attachment id="12390758" name="DERBY-3137-ijfix.diff" size="9561" author="dagw" created="Tue, 23 Sep 2008 16:33:51 +0100"/>
                            <attachment id="12390797" name="DERBY-3137-ijfix.stat" size="583" author="dagw" created="Tue, 23 Sep 2008 23:31:05 +0100"/>
                            <attachment id="12390759" name="DERBY-3137-ijfix.stat" size="666" author="dagw" created="Tue, 23 Sep 2008 16:33:51 +0100"/>
                            <attachment id="12396387" name="DERBY-3137-moreTests-b.diff" size="2756" author="dagw" created="Thu, 18 Dec 2008 12:42:47 +0000"/>
                            <attachment id="12396388" name="DERBY-3137-moreTests-b.stat" size="84" author="dagw" created="Thu, 18 Dec 2008 12:42:47 +0000"/>
                            <attachment id="12396310" name="DERBY-3137-moreTests.diff" size="2859" author="dagw" created="Wed, 17 Dec 2008 15:33:29 +0000"/>
                            <attachment id="12396311" name="DERBY-3137-moreTests.stat" size="84" author="dagw" created="Wed, 17 Dec 2008 15:33:29 +0000"/>
                            <attachment id="12382977" name="DERBY-3137-rename-b.diff" size="37864" author="dagw" created="Wed, 28 May 2008 23:21:44 +0100"/>
                            <attachment id="12382978" name="DERBY-3137-rename-b.stat" size="1202" author="dagw" created="Wed, 28 May 2008 23:21:44 +0100"/>
                            <attachment id="12382743" name="DERBY-3137-rename.diff" size="39269" author="dagw" created="Sun, 25 May 2008 23:48:25 +0100"/>
                            <attachment id="12382730" name="DERBY-3137-rename.diff" size="38039" author="dagw" created="Sun, 25 May 2008 02:37:02 +0100"/>
                            <attachment id="12382744" name="DERBY-3137-rename.stat" size="1202" author="dagw" created="Sun, 25 May 2008 23:48:25 +0100"/>
                            <attachment id="12382731" name="DERBY-3137-rename.stat" size="1202" author="dagw" created="Sun, 25 May 2008 02:37:02 +0100"/>
                            <attachment id="12396602" name="DERBY-3137-setRoleAsStringFix-b.diff" size="9462" author="dagw" created="Mon, 22 Dec 2008 15:13:30 +0000"/>
                            <attachment id="12396603" name="DERBY-3137-setRoleAsStringFix-b.stat" size="289" author="dagw" created="Mon, 22 Dec 2008 15:13:30 +0000"/>
                            <attachment id="12396499" name="DERBY-3137-setRoleAsStringFix.diff" size="3321" author="dagw" created="Fri, 19 Dec 2008 17:14:15 +0000"/>
                            <attachment id="12396500" name="DERBY-3137-setRoleAsStringFix.stat" size="151" author="dagw" created="Fri, 19 Dec 2008 17:14:15 +0000"/>
                            <attachment id="12390925" name="DERBY-3137-setRoleNoCNF-2.diff" size="10104" author="dagw" created="Thu, 25 Sep 2008 15:21:29 +0100"/>
                            <attachment id="12390926" name="DERBY-3137-setRoleNoCNF-2.stat" size="610" author="dagw" created="Thu, 25 Sep 2008 15:21:29 +0100"/>
                            <attachment id="12390935" name="DERBY-3137-setRoleNoCNF-3.diff" size="10146" author="dagw" created="Thu, 25 Sep 2008 18:31:40 +0100"/>
                            <attachment id="12390936" name="DERBY-3137-setRoleNoCNF-3.stat" size="610" author="dagw" created="Thu, 25 Sep 2008 18:31:40 +0100"/>
                            <attachment id="12390838" name="DERBY-3137-setRoleNoCNF.diff" size="8445" author="dagw" created="Wed, 24 Sep 2008 15:20:52 +0100"/>
                            <attachment id="12390835" name="DERBY-3137-setRoleNoCNF.diff" size="8704" author="dagw" created="Wed, 24 Sep 2008 14:40:50 +0100"/>
                            <attachment id="12390839" name="DERBY-3137-setRoleNoCNF.stat" size="514" author="dagw" created="Wed, 24 Sep 2008 15:20:53 +0100"/>
                            <attachment id="12390836" name="DERBY-3137-setRoleNoCNF.stat" size="514" author="dagw" created="Wed, 24 Sep 2008 14:40:50 +0100"/>
                            <attachment id="12392020" name="DERBY-3137-setRoleNoDynamicNone.diff" size="3201" author="dagw" created="Mon, 13 Oct 2008 17:28:40 +0100"/>
                            <attachment id="12392021" name="DERBY-3137-setRoleNoDynamicNone.stat" size="164" author="dagw" created="Mon, 13 Oct 2008 17:28:40 +0100"/>
                            <attachment id="12381428" name="DERBY-3137-uuid-2.diff" size="638" author="dagw" created="Mon, 5 May 2008 15:48:37 +0100"/>
                            <attachment id="12373529" name="DERBY-3137-uuid.diff" size="20760" author="dagw" created="Fri, 18 Jan 2008 15:35:59 +0000"/>
                            <attachment id="12373530" name="DERBY-3137-uuid.stat" size="723" author="dagw" created="Fri, 18 Jan 2008 15:35:59 +0000"/>
                            <attachment id="12368988" name="DERBY-3137.diff" size="164897" author="dagw" created="Mon, 5 Nov 2007 18:18:09 +0000"/>
                            <attachment id="12368981" name="DERBY-3137.diff" size="164671" author="dagw" created="Mon, 5 Nov 2007 17:02:11 +0000"/>
                            <attachment id="12368982" name="DERBY-3137.stat" size="3575" author="dagw" created="Mon, 5 Nov 2007 17:02:11 +0000"/>
                            <attachment id="12368983" name="DERBY-3137.txt" size="15679" author="dagw" created="Mon, 5 Nov 2007 17:02:11 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12395926">DERBY-3673</subtask>
                            <subtask id="12396440">DERBY-3681</subtask>
                            <subtask id="12398282">DERBY-3722</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 5 Nov 2007 23:01:27 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30737</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0v9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38882</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>