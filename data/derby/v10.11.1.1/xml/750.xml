<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:28:39 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-750/DERBY-750.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-750] OnlineBackupTest1.java intermittently hangs</title>
                <link>https://issues.apache.org/jira/browse/DERBY-750</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;OnlineBackupTest1.java intermittently hangs(endless loop - 100% cpu). I have seen this on &quot;all&quot; of the platforms we test on.&lt;/p&gt;

&lt;p&gt;Seen in &quot;derbyall&quot; itself and runs of derbyall sub-testsuites storemoe and storeall.&lt;/p&gt;

&lt;p&gt;Some cases:&lt;/p&gt;

&lt;p&gt;storemore in&lt;br/&gt;
&lt;a href=&quot;http://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-354827.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-354827.html&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-355169.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-355169.html&lt;/a&gt;&lt;br/&gt;
  (Details, including sysinfo,  in &lt;a href=&quot;http://www.multinet.no/~solberg/public/Apache/Derby/testlog/SunOS-5.10_i86pc-i386/355169.zip&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.multinet.no/~solberg/public/Apache/Derby/testlog/SunOS-5.10_i86pc-i386/355169.zip&lt;/a&gt; )&lt;/p&gt;

&lt;p&gt;storeall in&lt;br/&gt;
&lt;a href=&quot;http://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-355569.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.multinet.no/~solberg/public/Apache/Derby/Limited/testSummary-355569.html&lt;/a&gt;&lt;/p&gt;
</description>
                <environment>SunOS-5.9 sun4u-sparc, Sun JVM 1.5.0_03&lt;br/&gt;
SunOS-5.10 i86pc-i386, Sun JVM 1.5.0_04&lt;br/&gt;
Windows XP / CYGWIN_NT-5.1 i686-unknow, Sun JVM1.5.0_05&lt;br/&gt;
Linux-2.4.21-27.ELsmp i686-athlon, Sun JVM 1.5.0_03</environment>
        <key id="12326591">DERBY-750</key>
            <summary>OnlineBackupTest1.java intermittently hangs</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tsuresh">Suresh Thalamati</assignee>
                                    <reporter username="olesolberg">Ole Solberg</reporter>
                        <labels>
                    </labels>
                <created>Sun, 11 Dec 2005 23:14:19 +0000</created>
                <updated>Tue, 20 Mar 2007 21:04:35 +0000</updated>
                            <resolved>Sat, 4 Mar 2006 07:10:10 +0000</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12360233" author="tsuresh" created="Tue, 13 Dec 2005 03:13:55 +0000"  >&lt;p&gt;If some one sees this test hang,   please post the stack dump.  It does not  reproduce on my linux/windows envirorments.  Stack traces might help in  pinpointing  where it  is  looping forever. &lt;/p&gt;</comment>
                            <comment id="12360290" author="olesolberg" created="Tue, 13 Dec 2005 18:47:20 +0000"  >&lt;p&gt;I started a loop doing &lt;br/&gt;
  java org.apache.derbyTesting.functionTests.harness.RunTest store/OnlineBackupTest1.java&lt;br/&gt;
and soon experienced the hang.&lt;/p&gt;

&lt;p&gt;ps -auxwww | grep Online:&lt;br/&gt;
-------------------------------------------------------------------------------&lt;br/&gt;
os136789  4058 50.2  3.215019265472 pts/1    O 10:06:58 11:44 /usr/local/java/jdk/bin//java -Dderby.system.home=/export/home/tmp/os136789/adhoc/OnlineBackupTest1 -Dderby.infolog.append=true -Duser.dir=/export/home/tmp/os136789/adhoc -Dframework=embedded org.apache.derbyTesting.functionTests.tests.store.OnlineBackupTest1 -p /export/home/tmp/os136789/adhoc/OnlineBackupTest1/OnlineBackupTest1_app.properties&lt;br/&gt;
os136789  4053  0.1  0.812132815144 pts/1    S 10:06:56  0:00 java org.apache.derbyTesting.functionTests.harness.RunTest store/OnlineBackupTest1.java&lt;br/&gt;
-------------------------------------------------------------------------------&lt;/p&gt;

&lt;p&gt; kill -3 4058&lt;/p&gt;

&lt;p&gt;produced the dump in attachement siv02_app.properties_OnlineBackupTest1.tmp&lt;/p&gt;</comment>
                            <comment id="12360634" author="tsuresh" created="Sat, 17 Dec 2005 07:08:28 +0000"  >&lt;p&gt;Thanks for posting the stack Ole.  By looking at the stacks ,  my suspicion is  backup is looking at a table that is not completely created yet, &lt;br/&gt;
container file might be there but the  first page (Alloc page)  might have been created.  &lt;/p&gt;

&lt;p&gt;It might take some time for me to fix this one ,  As a temporary solution  ,  attached patch comments &lt;br/&gt;
out the  the section of the  the test that might be hitting this problem. &lt;/p&gt;

&lt;p&gt;It would be great if some one can commit this patch. &lt;/p&gt;</comment>
                            <comment id="12365327" author="tsuresh" created="Tue, 7 Feb 2006 04:28:24 +0000"  >&lt;p&gt;Problem was backup was trying to a read a pages from a container before the first&lt;br/&gt;
allocation page for it is created with a invalid page number. First allocation page&lt;br/&gt;
number is invalid only when first page is not created.&lt;/p&gt;

&lt;p&gt;The reason backup sees containers in that state, backup finds the containers to &lt;br/&gt;
backup by scanning through the seg0 list files and gets access to the container&lt;br/&gt;
conglomerate cache, cache returns the handles after the container file is&lt;br/&gt;
created. &lt;/p&gt;

&lt;p&gt;Fix is NOT  to backup containers whose first allocation page not yet created.  It is&lt;br/&gt;
safe to not backup containers in such case instead of waiting for container&lt;br/&gt;
creation to complete, redo of the log on restore will create them. &lt;/p&gt;

&lt;p&gt;Renabled the test case that hit this problem in OnlineBackupTest1.java ,  which was commented &lt;br/&gt;
earlier.  &lt;/p&gt;

&lt;p&gt;TESTS : derbyall test suite passed on Windows XP/JDK142&lt;br/&gt;
It would be great if some can review and commit this patch. &lt;/p&gt;

&lt;p&gt;svn stat:&lt;/p&gt;

&lt;p&gt;M      java\engine\org\apache\derby\impl\store\raw\data\FileContainer.java&lt;br/&gt;
M      java\engine\org\apache\derby\impl\store\raw\data\RAFContainer.java&lt;br/&gt;
M      java\testing\org\apache\derbyTesting\functionTests\tests\store\OnlineBackupTest1.java&lt;/p&gt;</comment>
                            <comment id="12365493" author="mikem" created="Wed, 8 Feb 2006 08:37:51 +0000"  >&lt;p&gt;I committed this to svn:&lt;br/&gt;
m1_142:13&amp;gt;svn commit&lt;/p&gt;

&lt;p&gt;Sending        java\engine\org\apache\derby\impl\store\raw\data\FileContainer.ja&lt;br/&gt;
va&lt;br/&gt;
Sending        java\engine\org\apache\derby\impl\store\raw\data\RAFContainer.jav&lt;br/&gt;
a&lt;br/&gt;
Sending        java\testing\org\apache\derbyTesting\functionTests\tests\store\On&lt;br/&gt;
lineBackupTest1.java&lt;br/&gt;
Transmitting file data ...&lt;br/&gt;
Committed revision 375775.&lt;/p&gt;</comment>
                            <comment id="12419819" author="kmarsden" created="Sat, 8 Jul 2006 10:38:38 +0100"  >&lt;p&gt;set  fix version to 10.2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12322677" name="derby-750.diff" size="7246" author="tsuresh" created="Tue, 7 Feb 2006 04:28:24 +0000"/>
                            <attachment id="12321382" name="obtest1.diff" size="1677" author="tsuresh" created="Sat, 17 Dec 2005 07:08:28 +0000"/>
                            <attachment id="12321303" name="siv02_app.properties_OnlineBackupTest1.tmp" size="10100" author="olesolberg" created="Tue, 13 Dec 2005 18:43:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Dec 2005 03:13:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22127</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy134n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40157</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>