<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:46:35 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2902/DERBY-2902.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2902] AS IDENTITY (START WITH -9223372036854775808) fails</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2902</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When creating a table&lt;/p&gt;

&lt;p&gt;AS IDENTITY (START WITH -9223372036854775808)&lt;/p&gt;

&lt;p&gt;fails but&lt;/p&gt;

&lt;p&gt;AS IDENTITY (START WITH -9223372036854775807)&lt;/p&gt;

&lt;p&gt;succeeds.&lt;/p&gt;

&lt;p&gt;Guess this is a parsing SQL problem as the absolute value appears to be held in a long, which is not quite long enough at the positive end.&lt;/p&gt;</description>
                <environment>MacTel 10.4.10 JVM 1.6.0-dp</environment>
        <key id="12373065">DERBY-2902</key>
            <summary>AS IDENTITY (START WITH -9223372036854775808) fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="bryanpendleton">Bryan Pendleton</assignee>
                                    <reporter username="northshorefiend">James Alan Shepherd</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Jul 2007 14:44:51 +0100</created>
                <updated>Fri, 21 Jan 2011 17:50:32 +0000</updated>
                            <resolved>Sun, 12 Aug 2007 16:09:02 +0100</resolved>
                                    <version>10.0.2.0</version>
                    <version>10.0.2.1</version>
                    <version>10.1.1.0</version>
                    <version>10.1.2.1</version>
                    <version>10.1.3.1</version>
                    <version>10.2.1.6</version>
                    <version>10.2.2.0</version>
                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.2.1</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12510368" author="bryanpendleton" created="Thu, 5 Jul 2007 15:10:11 +0100"  >&lt;p&gt;I think the problem is indeed in the parser. It appears that the minus sign is&lt;br/&gt;
treated as a separate token in the tokenization of the expression, and the&lt;br/&gt;
value is converted to a Long, then the minus sign is applied to convert the long&lt;br/&gt;
to a negative number. There is the following code in SQLParser&apos;s exactNumber()&lt;br/&gt;
method:&lt;/p&gt;

&lt;p&gt;                        long longvalue = Long.parseLong(longToken.image);&lt;br/&gt;
                        if (sign.equals(&quot;-&quot;))&lt;br/&gt;
                        {&lt;/p&gt;
                                {if (true) return -longvalue;}
&lt;p&gt;                        }&lt;br/&gt;
                        else&lt;br/&gt;
                        {&lt;/p&gt;
                                {if (true) return longvalue;}
&lt;p&gt;                        }&lt;/p&gt;

&lt;p&gt;Since Long.MAX_VALUE is 9223372036854775807, while&lt;br/&gt;
Long.MIN_VALUE is -9223372036854775808, we cannot successfully&lt;br/&gt;
parse Long.MIN_VALUE because we try to do it by first computing&lt;br/&gt;
Long.parseLong(9223372036854775808), which exceeds Long.MAX_VALUE&lt;br/&gt;
and hence throws the exception.&lt;/p&gt;

&lt;p&gt;One approach might be to try replacing the above code in exactNumber()&lt;br/&gt;
by something like:&lt;/p&gt;

&lt;p&gt;                        if (sign.equals(&quot;-&quot;))&lt;/p&gt;
                        {
                                return Long.parseLong(&quot;-&quot; + longToken.image);
                        }
&lt;p&gt;                        else&lt;/p&gt;
                        {
                                return Long.parseLong(longToken.image);
                        }

&lt;p&gt;If I get some spare time this weekend I&apos;ll give that a try.&lt;/p&gt;
</comment>
                            <comment id="12510979" author="bryanpendleton" created="Sun, 8 Jul 2007 15:33:17 +0100"  >&lt;p&gt;Attached is parseLong.diff,  a patch proposal. It includes the code &lt;br/&gt;
change that I proposed in the previous comment on this issue, and &lt;br/&gt;
a simple set of test cases to be included in autoincrement.sql.&lt;/p&gt;

&lt;p&gt;derbyall and suites.All passed. If there are any review comments,&lt;br/&gt;
please let me know.&lt;/p&gt;</comment>
                            <comment id="12511118" author="knutanders" created="Mon, 9 Jul 2007 14:34:12 +0100"  >&lt;p&gt;Hi Bryan,&lt;br/&gt;
The patch looks good to me, but wouldn&apos;t the code be more readable if we replaced the if/else with&lt;br/&gt;
  return Long.parseLong(sign + longToken.image);&lt;br/&gt;
?&lt;/p&gt;</comment>
                            <comment id="12511289" author="bryanpendleton" created="Tue, 10 Jul 2007 00:31:19 +0100"  >&lt;p&gt;Hi Knut Anders, thanks for the suggestion. That would indeed be clearer, but&lt;br/&gt;
unfortunately Long.parseLong() doesn&apos;t support a leading &quot;+&quot; sign in its&lt;br/&gt;
allowable formats, only a leading &quot;-&quot; sign. So unfortunately if we always&lt;br/&gt;
pass the sign to Long.parseLong, the following statement is rejected:&lt;/p&gt;

&lt;p&gt;  create table t (a2 int generated always as identity (start with  +0));&lt;/p&gt;

&lt;p&gt;I&apos;ll add a comment to the code indicating this.&lt;/p&gt;</comment>
                            <comment id="12511291" author="bryanpendleton" created="Tue, 10 Jul 2007 00:39:19 +0100"  >&lt;p&gt;Attached is parseLong_with_comment.diff, with a comment&lt;br/&gt;
describing why we re-concatenate the &quot;-&quot; sign into the&lt;br/&gt;
Long.parseLong() call, and why we have to do this&lt;br/&gt;
conditionally, so that we don&apos;t try to call parseLong() with&lt;br/&gt;
a value with a leading &quot;+&quot; sign.&lt;/p&gt;</comment>
                            <comment id="12511379" author="knutanders" created="Tue, 10 Jul 2007 11:11:20 +0100"  >&lt;p&gt;Thanks Bryan, that makes sense. +1 to commit.&lt;/p&gt;</comment>
                            <comment id="12511485" author="bryanpendleton" created="Tue, 10 Jul 2007 17:40:53 +0100"  >&lt;p&gt;Committed parseLong_with_comment to the trunk as revision 554996.&lt;/p&gt;

&lt;p&gt;I think this change is worth merging back to the 10.3 branch, but I don&apos;t want to do that immediately because the 10.3 branch is being stabilized for its release. So I&apos;ll leave this issue open for now, and when the 10.3 branch is in a good state for accepting non-critical bug fixes I&apos;ll merge this change back to the 10.3 branch.&lt;/p&gt;</comment>
                            <comment id="12519312" author="bryanpendleton" created="Sun, 12 Aug 2007 16:09:02 +0100"  >&lt;p&gt;Merged the change to the 10.3 branch and committed as revision 565078.&lt;/p&gt;

&lt;p&gt;I&apos;ll ask the JIRA admin to add a new 10.3 tag to the Fix Versions, and set the 10.3 fix version then.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12361382" name="parseLong.diff" size="3530" author="bryanpendleton" created="Sun, 8 Jul 2007 15:33:16 +0100"/>
                            <attachment id="12361448" name="parseLong_with_comment.diff" size="3965" author="bryanpendleton" created="Tue, 10 Jul 2007 00:39:19 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 5 Jul 2007 14:10:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23311</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0m7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37415</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>