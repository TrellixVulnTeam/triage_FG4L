<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:32:44 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3117/DERBY-3117.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3117] Adjust master build script to require the Java 5 compiler to build Derby</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3117</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Require the Java 5 compiler in order to build Derby as approved by the community recently: &lt;a href=&quot;http://www.nabble.com/-VOTE--Require-Java-5-%28or-later%29-compiler-to-build-Derby-tf4522491.html#a13030783&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/-VOTE--Require-Java-5-%28or-later%29-compiler-to-build-Derby-tf4522491.html#a13030783&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12379880">DERBY-3117</key>
            <summary>Adjust master build script to require the Java 5 compiler to build Derby</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Mon, 8 Oct 2007 17:20:57 +0100</created>
                <updated>Fri, 21 Jan 2011 18:19:16 +0000</updated>
                            <resolved>Mon, 17 Nov 2008 18:54:35 +0000</resolved>
                                    <version>10.4.1.3</version>
                                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>Build tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12533174" author="rhillegas" created="Mon, 8 Oct 2007 18:59:46 +0100"  >&lt;p&gt;Attaching derby-3117-enforceJava5-aa.diff. This forces the build to exit early if the compiler level is not at Java 5 or higher. This also adjusts BUILDING.txt to note that Java 5 is now required in order to build Derby. Touches the following files:&lt;/p&gt;

&lt;p&gt;build.xml&lt;br/&gt;
BUILDING.txt&lt;/p&gt;</comment>
                            <comment id="12533182" author="knutanders" created="Mon, 8 Oct 2007 19:32:26 +0100"  >&lt;p&gt;Looks good! I tried to compile with JAVA_HOME pointing to a 1.4 installation, and I got a very clear error message. Worked fine with 1.6.&lt;/p&gt;

&lt;p&gt;My only comment is to this part of the patch:&lt;/p&gt;

&lt;p&gt;-(2) The Derby build environment is tested with &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;JDK 142(Sun) and Ant 161. The Derby build environment should&lt;br/&gt;
+(2) The Derby build environment is tested with Sun&apos;s Java 5 compiler,&lt;br/&gt;
+    with Sun&apos;s JDK 1.4.2 libraries, and with Ant 161. The Derby build environment should&lt;br/&gt;
     work with other versions and other sources of &lt;/li&gt;
	&lt;li&gt;JDK 14 (1.4.x), and other versions of Ant 1.6 (1.6.x).&lt;br/&gt;
+    Java 5 and  JDK 14 (1.4.x) and with other versions of Ant 1.6 (1.6.x).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;One of the lines exceeded 80 characters. Also, Ant 161 should probably be 1.6.1 (if that&apos;s the version you have tested it with), and JDK 14 should be 1.4.&lt;/p&gt;

&lt;p&gt;I think it would also be good to change the link in&lt;/p&gt;

&lt;p&gt;+(4) Download the Java 5 or later JDK.&lt;br/&gt;
+    The reference implementation is available at:&lt;br/&gt;
+       &lt;a href=&quot;http://java.sun.com/j2se&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/j2se&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;to its new name &lt;a href=&quot;http://java.sun.com/javase/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://java.sun.com/javase/&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12533184" author="knutanders" created="Mon, 8 Oct 2007 19:35:02 +0100"  >&lt;p&gt;One more thing. The old BUILDING.txt says this:&lt;/p&gt;

&lt;p&gt; (3) The directory where you have installed JDK 1.4.x will be &lt;br/&gt;
     referred to as $&lt;/p&gt;
{jdk14.dir}
&lt;p&gt; in the rest of this document.&lt;/p&gt;

&lt;p&gt;It should probably say something similar about the $&lt;/p&gt;
{java5.dir}
&lt;p&gt; variable that is used in some of the examples.&lt;/p&gt;</comment>
                            <comment id="12533189" author="rhillegas" created="Mon, 8 Oct 2007 19:59:46 +0100"  >&lt;p&gt;Thanks for the quick feedback, Knut. I have attached a new rev of the patch to address your comments: derby-3117-enforceJava5-ab.diff.&lt;/p&gt;</comment>
                            <comment id="12533295" author="knutanders" created="Tue, 9 Oct 2007 08:34:40 +0100"  >&lt;p&gt;Thanks for updating the patch, Rick. Looks great now. A couple of nits, though:&lt;/p&gt;

&lt;p&gt;1) Two blanks between &apos;such&apos; and &apos;that&apos;:&lt;br/&gt;
+    The Derby build is set up such  that most of &lt;/p&gt;

&lt;p&gt;2) Long line (&amp;gt; 80):&lt;br/&gt;
+    with Sun&apos;s JDK 1.4.2 libraries, and with Ant 1.6.1. The Derby build environment&lt;/p&gt;

&lt;p&gt;3) Should &apos;shell window&apos; be replaced with &apos;ant process&apos; in the text below?&lt;/p&gt;

&lt;p&gt;+You must also install the Java 5 (or later) JDK and this must be the version of&lt;br/&gt;
+Java used by the shell window in which you run the Derby build. You&lt;/p&gt;

&lt;p&gt;You&apos;re not required to run the build process in a shell window, and it is the value of JAVA_HOME that decides which java version ant uses, I think. (At least I was not able to build Derby when &apos;java -version&apos; in the shell window said version 1.6.0 and JAVA_HOME pointed to a JDK 1.3 installation, and I was able to build Derby when &apos;java -version&apos; said version 1.3.1 and JAVA_HOME pointed to 1.6.)&lt;/p&gt;

&lt;p&gt;4) Replace &apos;Java 6 JDK&apos; with &apos;Java 5 JDK&apos; in the text below:&lt;br/&gt;
+(6) The directory where you have installed the Java 6 JDK will be &lt;br/&gt;
+    referred to as $&lt;/p&gt;
{java5.dir}
&lt;p&gt; in the rest of this document.&lt;/p&gt;</comment>
                            <comment id="12533829" author="rhillegas" created="Wed, 10 Oct 2007 19:26:06 +0100"  >&lt;p&gt;Thanks for the continued feedback, Knut. I have attached derby-3117-01-enforceJava5-ac.diff, which addresses the issues you raised. Cheers.&lt;/p&gt;</comment>
                            <comment id="12534029" author="knutanders" created="Thu, 11 Oct 2007 13:47:28 +0100"  >&lt;p&gt;Thanks Rick! No further comments from me. +1 to commit!&lt;/p&gt;</comment>
                            <comment id="12534039" author="rhillegas" created="Thu, 11 Oct 2007 14:51:31 +0100"  >&lt;p&gt;Thanks, Knut. Committed derby-3117-01-enforceJava5-ac.diff at subversion revision 583824.&lt;/p&gt;</comment>
                            <comment id="12534761" author="johnemb" created="Mon, 15 Oct 2007 08:22:56 +0100"  >&lt;p&gt;Someone (TM) should probably update &lt;a href=&quot;http://db.apache.org/derby/dev/derby_source.html#Software+required+to+build+Derby&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://db.apache.org/derby/dev/derby_source.html#Software+required+to+build+Derby&lt;/a&gt; as well... &lt;/p&gt;</comment>
                            <comment id="12535624" author="rhillegas" created="Wed, 17 Oct 2007 18:12:59 +0100"  >&lt;p&gt;Thanks for the pointer to that page, John. That page seems to be generally out-of-date. For instance, it still tells people to install jdk 1.3 and the jdk1.3 extension jars. I am attaching a patch which updates the website&apos;s build instructions (derby-3117-02-website-aa.diff) and the corresponding html output derby_source.html.&lt;/p&gt;</comment>
                            <comment id="12535661" author="knutanders" created="Wed, 17 Oct 2007 19:12:28 +0100"  >&lt;p&gt;How are we going to set up $&lt;/p&gt;
{java15compile.classpath}
&lt;p&gt;? I see two options:&lt;/p&gt;

&lt;p&gt;  1) Introduce a j15lib variable in ant.properties, like we do for Java 1.4&lt;/p&gt;

&lt;p&gt;  2) Automatically set it based on $&lt;/p&gt;
{java.home}

&lt;p&gt;Although 2 is simpler, I think 1 is best since it prevents accidental introduction of dependencies on Java 6 (or higher) if we build with a more recent JDK.&lt;/p&gt;</comment>
                            <comment id="12535674" author="rhillegas" created="Wed, 17 Oct 2007 19:58:51 +0100"  >&lt;p&gt;Hi Knut,&lt;/p&gt;

&lt;p&gt;Can you help me understand why we need a java15compile.classpath?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12535682" author="djd" created="Wed, 17 Oct 2007 20:13:19 +0100"  >&lt;p&gt;To compile code that requires Java 1.5 classes or methods.&lt;/p&gt;</comment>
                            <comment id="12535707" author="rhillegas" created="Wed, 17 Oct 2007 20:59:16 +0100"  >&lt;p&gt;I don&apos;t see why we need this variable to compile code that requires Java 5 classes and methods. Won&apos;t the compiler&apos;s default classpath be good enough now that we&apos;re requiring a Java 5 or higher compiler? Thanks.&lt;/p&gt;</comment>
                            <comment id="12535716" author="djd" created="Wed, 17 Oct 2007 21:08:14 +0100"  >&lt;p&gt;No. Imagine you are writing a class that needs to run on Java 5 but are using JDK 6 as your compiler. If you use the compilers default class path then you run the risk of introducing methods/classes into the Java5 code that are only in JDK 6.&lt;/p&gt;

&lt;p&gt;It&apos;s just like when there was a jdk13 classpath property even though a jdk 1.4 compiler was required.&lt;/p&gt;</comment>
                            <comment id="12535738" author="rhillegas" created="Wed, 17 Oct 2007 21:53:40 +0100"  >&lt;p&gt;Thanks. In that case I agree that option (2) is brittle and (1) is better. Not foolproof, though. Someone could still set java15compile.classpath to be the Java 6 classpath.&lt;/p&gt;

&lt;p&gt;I wonder if we should further reduce the brittleness by requiring that the compiler level be exactly Java 5. This could be enforced by the build script.&lt;/p&gt;</comment>
                            <comment id="12535863" author="knutanders" created="Thu, 18 Oct 2007 09:41:55 +0100"  >&lt;p&gt;I don&apos;t think we should disallow building Derby with newer JDKs. I like the flexibility we get from saying that we require the ant process to use JDK 5 or higher, since that means I know that if I use the most recent JDK as system default and have ant.properties correctly set up, it&apos;ll just work when I type &apos;ant&apos;. If we require exact version, that means I need to write scripts to change the environment when I move between different projects.&lt;/p&gt;

&lt;p&gt;Let me suggest a slightly different approach. What about changing the check in the build script so that it uses java15compile.classpath and tries to compile a file which uses JDK 6 features? Then we would detect if someone had mistakenly set the compile classpath to Java 6. Is that foolproof enough? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12535952" author="rhillegas" created="Thu, 18 Oct 2007 16:56:50 +0100"  >&lt;p&gt;I agree that we could add that check to the compiler verification target which is invoked during build initialization. It would reduce the brittleness, but probably not eliminate it. We could imagine adding similar checks to make sure that the jdk14 and jsr169 classpaths are sensible too. However, I don&apos;t have confidence that this approach will prove the correctness of the code at compile-time. Getting people to declare these variables up front , as you suggest, probably mops up most of the problems. The remaining problems can be flushed out after checkin when the build breaks on someone else&apos;s machine--I think that risk is acceptably small. Thanks.&lt;/p&gt;
</comment>
                            <comment id="12535961" author="djd" created="Thu, 18 Oct 2007 17:21:18 +0100"  >&lt;p&gt;A possible improvement is to add some optional targets that set java15compile.classpath &lt;/p&gt;

&lt;p&gt;E.g.&lt;br/&gt;
   sun15 - sets java15compile.classpath based upon the assumption a Sun 1.5 JDK is being used&lt;br/&gt;
   ibm15 - sets java15compile.classpath based upon the assumption an IBM 1.5 JDK is being used&lt;br/&gt;
   mac15 -sets java15compile.classpath based upon the assumption a MacOs1.5 JDK is being used&lt;/p&gt;

&lt;p&gt;Of course others could be added as folks need.&lt;/p&gt;

&lt;p&gt;This then maintains the required settings in the Derby build files, rather than needed the setting in every ant.properties file.&lt;/p&gt;

&lt;p&gt;These could be used as:&lt;/p&gt;

&lt;p&gt;   ant ibm15 all&lt;/p&gt;

</comment>
                            <comment id="12535995" author="rhillegas" created="Thu, 18 Oct 2007 19:00:09 +0100"  >&lt;p&gt;Sanding down Dan&apos;s suggestion a bit: We could also assume some (overridable) defaults based on the java environment properties which ant can see, e.g., $&lt;/p&gt;
{java.vendor}
&lt;p&gt;. For a list of these useful properties, see &lt;a href=&quot;http://www.onjava.com/pub/a/onjava/2005/10/12/diagnostic-tests-with-ant.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.onjava.com/pub/a/onjava/2005/10/12/diagnostic-tests-with-ant.html&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12536226" author="rhillegas" created="Fri, 19 Oct 2007 15:05:24 +0100"  >&lt;p&gt;Committed derby-3117-02-website-aa.diff at subversion 586462.&lt;/p&gt;</comment>
                            <comment id="12537391" author="rhillegas" created="Wed, 24 Oct 2007 20:11:51 +0100"  >&lt;p&gt;I have attached a proposal for how the build scripts could automatically set java14compile.classpath and java15compile.classpath based on the  operating system and JDK vendor: BuildDefaults.txt. I would appreciate your feedback. I have provided defaults for Apple JDKs on Mac OS X. If the proposal sounds reasonable, I would appreciate the community&apos;s help in filling in the defaults for Sun and IBM JDKs on Windows and Linux and for Sun JDKs on Solaris. Thanks.&lt;/p&gt;</comment>
                            <comment id="12537415" author="djd" created="Wed, 24 Oct 2007 21:39:30 +0100"  >&lt;p&gt;The compiler check is invoked when running the tests through the ant junit targets. I think this will mean the tests cannot be run via ant using jdk 1.4 or J2ME, that&apos;s a regression that needs to be fixed.&lt;/p&gt;</comment>
                            <comment id="12537664" author="rhillegas" created="Thu, 25 Oct 2007 18:28:13 +0100"  >&lt;p&gt;Hi Dan,&lt;/p&gt;

&lt;p&gt;Could you explain the problem that you are seeing when running the ant junit tests on jdk 1.4 or J2ME? I have started up the tests via &quot;ant junit-all&quot; in a shell window whose  $JAVA_HOME is set to jdk 1.4. The tests are running without error so far. If the initialization check were going to interfere with this test run, I would expect that the interference would happen when the tests start and the test run would fail fast. Thanks.&lt;/p&gt;</comment>
                            <comment id="12537701" author="djd" created="Thu, 25 Oct 2007 20:06:26 +0100"  >&lt;p&gt;I was using this target: junit-all-codeline-jars&lt;/p&gt;

&lt;p&gt;It requires no classpath to be set, it figures out the classpath using the standard location where the jars are built.&lt;/p&gt;</comment>
                            <comment id="12537908" author="knutanders" created="Fri, 26 Oct 2007 11:02:38 +0100"  >&lt;p&gt;Hi Rick,&lt;/p&gt;

&lt;p&gt;On many platforms, Sun&apos;s JDK is installed in a directory whose name contains the update number in addition to the version number (i.e., jdk1.5.0_13), so we may need a more intelligent way to find the installed JDKs. Does ant support getting a list of, say, all directories matching jdk1.5.0* and picking one of them?&lt;/p&gt;

&lt;p&gt;On Solaris 10 (which comes with JDK 1.4.2 and JDK 5.0 in the default installation), these are the default directories:&lt;/p&gt;

&lt;p&gt;j14lib=$&lt;/p&gt;
{java.home}/../../../j2sdk1.4.2_XX/jre/lib (where XX is the update number)&lt;br/&gt;
j15lib=${java.home}
&lt;p&gt;/../../jdk1.5.0/jre/lib&lt;/p&gt;

&lt;p&gt;(given that the JAVA_HOME environment variable is not set and /usr/bin/java is the first java command found in your PATH)&lt;/p&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;p&gt;java14compile.classpath=$&lt;/p&gt;
{j14lib}/rt.jar;${j14lib}
&lt;p&gt;/jce.jar;$&lt;/p&gt;
{j14lib}
&lt;p&gt;/jsse.jar&lt;br/&gt;
java15compile.classpath=$&lt;/p&gt;
{j15lib}/rt.jar;${j15lib}
&lt;p&gt;/jce.jar;$&lt;/p&gt;
{j15lib}
&lt;p&gt;/jsse.jar&lt;/p&gt;</comment>
                            <comment id="12537982" author="rhillegas" created="Fri, 26 Oct 2007 15:56:49 +0100"  >&lt;p&gt;Attaching derby-3117-03-junit-aa.diff. This moves compiler-level-checking out of the init target into the dependencies for the buildsource target. This allows the junit tests to be run from the ant harness using the junit-all-codeline-jars target.&lt;/p&gt;</comment>
                            <comment id="12538095" author="rhillegas" created="Fri, 26 Oct 2007 21:33:22 +0100"  >&lt;p&gt;Hi Knut,&lt;/p&gt;

&lt;p&gt;You raise a good point here. This gets to be a little tricky to do in an xml script-my experience is that xml is a lousy language in which to write procedural code. Fortunately, there&apos;s a trapdoor for this kind of problem, viz.,  you write a custom ant Task. The Task would have to be compiled before we needed to look at jdk14, jdk15, java14comple.classpath, and java15compile.classpath. The Task could use org.apache.tools.ant.taskdefs.Property  to set those properties based on the JDK vendor, the operating system, and $JAVA_HOME. I could write this task and plug in the logic for Max OS X. Other people could plug in the logic for their favorite build environments later on. And of course, the current model of forcibly setting values in ant.properties would continue to work.&lt;/p&gt;</comment>
                            <comment id="12538500" author="rhillegas" created="Mon, 29 Oct 2007 13:35:17 +0000"  >&lt;p&gt;Committed derby-3117-03-junit-aa.diff at subversion revision 589624,&lt;/p&gt;</comment>
                            <comment id="12538520" author="knutanders" created="Mon, 29 Oct 2007 15:14:18 +0000"  >&lt;p&gt;Hi Rick,&lt;br/&gt;
It sounds like a custom ant task gives us the power and flexibility we need. Rather than plugging in logic for each OS/vendor combination we can think of, perhaps we can just maintain a list of search destinations. Then it is more likely that it&apos;ll work on platforms we haven&apos;t thought about (for instance, the defaults on Mac OS X may match the directory structure on another platform, so if we always search for those dirs, it&apos;ll work out of the box there as well).&lt;/p&gt;</comment>
                            <comment id="12538521" author="djd" created="Mon, 29 Oct 2007 15:28:49 +0000"  >&lt;p&gt;Isn&apos;t there a catch-22 situation with an ant task to figure out the compiler? How does the ant task get compiled? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12538522" author="rhillegas" created="Mon, 29 Oct 2007 15:33:10 +0000"  >&lt;p&gt;Hi Knut,&lt;/p&gt;

&lt;p&gt;I think I understand what you&apos;re suggesting. We could eliminate the OS check and just apply a bunch of heuristics to find the JDK directory regardless of the underlying OS. After we find a directory, however, I think we still need to switch based on JDK vendor. That is because the top-level JDK directory name might be the same for two different vendors, but each vendor would still have its own idea of what jars should be wired into java14compile.classpath and java15compile.classpath.&lt;/p&gt;</comment>
                            <comment id="12538524" author="knutanders" created="Mon, 29 Oct 2007 15:35:19 +0000"  >&lt;p&gt;&amp;gt; How does the ant task get compiled?&lt;br/&gt;
By using the default compiler for the ant process?&lt;/p&gt;</comment>
                            <comment id="12538525" author="knutanders" created="Mon, 29 Oct 2007 15:41:23 +0000"  >&lt;p&gt;Rick, do we need to check vendor? If people want such fine-grained control, they could use ant.properties instead. For people who only want to compile Derby, using the first JDK/SDK we find would probably suffice. Note that setting compile.classpath does not change which compiler we use, only which libraries the compiler uses to check that the methods/classes we use exist. So the compiled byte code will look identical regardless of which vendor&apos;s class library we use. The compiler only changes when we change JAVA_HOME.&lt;/p&gt;</comment>
                            <comment id="12538527" author="rhillegas" created="Mon, 29 Oct 2007 15:49:03 +0000"  >&lt;p&gt;Hi Dan,&lt;/p&gt;

&lt;p&gt;There is a catch-22 with building the ant task, but I&apos;m hoping it&apos;s relatively minor. Basically, the build tools would be built with whatever compiler is visible in $JAVA_HOME together with its default understanding of what the bootclasspath is. I think the trick here is that our build tasks (the &amp;lt;javac&amp;gt; calls) are setting bootclasspath to $&lt;/p&gt;
{empty}, which forces &amp;lt;javac&amp;gt; to rely on follow-on &amp;lt;classpath&amp;gt; declarations to contain the location of the JDK jars. So the idea would be to invoke &amp;lt;javac&amp;gt; on the buildtools directory without forcing bootclasspath to ${empty}
&lt;p&gt;. I think this creates a small possibility that someone could introduce a Java6-specific reference into the buildtools and we wouldn&apos;t notice this until someone else tried to compile Derby in a Java 5 environment. I think I could live with that exposure.&lt;/p&gt;

&lt;p&gt;Of course, I haven&apos;t mocked this up yet and there could be a bigger catch-22!&lt;/p&gt;</comment>
                            <comment id="12538528" author="knutanders" created="Mon, 29 Oct 2007 15:49:51 +0000"  >&lt;p&gt;Ah, sorry Rick. I didn&apos;t read your comment carefully enough... Yes, you&apos;re right, we probably need to know the vendor in order to find out which jar files to include.&lt;/p&gt;</comment>
                            <comment id="12538529" author="rhillegas" created="Mon, 29 Oct 2007 15:56:08 +0000"  >&lt;p&gt;Hi Knut,&lt;/p&gt;

&lt;p&gt;I&apos;m afraid I&apos;m not tracking what you&apos;re suggesting. Knowing the JDK vendor tells us which JDK jars we should wire into the compile classpath. How do you propose that we figure out that list? Are you thinking that we should just look for a lib directory under the jdk and wire in everything in that directory?&lt;/p&gt;</comment>
                            <comment id="12538578" author="knutanders" created="Mon, 29 Oct 2007 20:27:12 +0000"  >&lt;p&gt;&amp;gt; Are you thinking that we should just look for a lib directory under the jdk and wire in everything in that directory?&lt;/p&gt;

&lt;p&gt;No, I had just forgotten that the different JDKs had different sets of jars. But when you mention it, it actually sounds like a good idea. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; That would be more robust and require less platform specific code, wouldn&apos;t it? I know that we normally want to keep the number of jars on compile.classpath as small as possible to prevent new dependencies from being introduced. But as far as I have understood, the new target that sets up compile.classpath automatically is primarily aimed at users who download the code to experiment with it or try out patches. For these users, the most important thing is that the build works, so such a broad approach might make sense. For Derby developers on the other hand, I think we should still encourage them to set up ant.properties so that they know exactly which libraries that are used in the build process.&lt;/p&gt;</comment>
                            <comment id="12538874" author="rhillegas" created="Tue, 30 Oct 2007 18:11:59 +0000"  >&lt;p&gt;Attaching a first attempt to set the classpath properties automatically: derby-3117-04-propertySetter-aa.diff. I will run the regression tests in some combinations. In the meantime, I would appreciate your feedback.&lt;/p&gt;

&lt;p&gt;This patch tries to set the classpath properties if they are not already set:&lt;/p&gt;

&lt;p&gt;java14compile.classpath&lt;br/&gt;
java15compile.classpath&lt;/p&gt;

&lt;p&gt;If the following library properties are set, they may influence how we set the corresponding classpath properties:&lt;/p&gt;

&lt;p&gt;j14lib&lt;br/&gt;
j15lib&lt;/p&gt;

&lt;p&gt;This tool behaves as follows:&lt;/p&gt;

&lt;p&gt;1) If the classpath properties are set, nothing happens and we simply exit.&lt;/p&gt;

&lt;p&gt;2) Otherwise, if a library property is set, we attempt to set the corresponding classpath property to be a list of all the jars in the directory pointed to by the library property.&lt;/p&gt;

&lt;p&gt;3) Otherwise we try to set the classpath properties to values specific to the vendor of the running vm. In this first submission, the only supported jdk vendor is Apple. Hopefully, other vendors will be added later on.&lt;/p&gt;

&lt;p&gt;4) Otherwise, if we don&apos;t recognize the vm vendor, we abort the build.&lt;/p&gt;


&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;A      java/build/org/apache/derbyPreBuild/PropertySetter.java&lt;/p&gt;

&lt;p&gt;This is the ant task which does the bulk of the work.&lt;/p&gt;


&lt;p&gt;A      java/build/org/apache/derbyPreBuild&lt;br/&gt;
A      java/build/org/apache/derbyPreBuild/build.xml&lt;/p&gt;

&lt;p&gt;Build machinery for the ant task.&lt;/p&gt;


&lt;p&gt;M      build.xml&lt;/p&gt;

&lt;p&gt;Wires the ant task into the main build. Some of the initial property setting has been moved into a new target so that the new task runs in a fairly sterile environment. The idea is that the new task is called on to set the classpath properties very early into the build. If you want to override the choices made by this task, you need to set the library or classpath properties in your ant.properties file.&lt;/p&gt;</comment>
                            <comment id="12539077" author="rhillegas" created="Wed, 31 Oct 2007 13:37:04 +0000"  >&lt;p&gt;Attaching new rev of previous patch: derby-3117-propertySetter-ab.diff. This adds the property setting to the buildjars target. Without that change, tests were failing when run against jar files.&lt;/p&gt;</comment>
                            <comment id="12539700" author="rhillegas" created="Fri, 2 Nov 2007 21:01:30 +0000"  >&lt;p&gt;Attaching derby-3117-04-propertySetter-ac.diff. This adds property setting support for Sun and IBM JDKs, at least on Linux.&lt;/p&gt;</comment>
                            <comment id="12540079" author="rhillegas" created="Sun, 4 Nov 2007 16:19:52 +0000"  >&lt;p&gt;Attaching derby-3117-04-propertySetter-ad.diff. This adds property setting support for Sun JDKs on Solaris.&lt;/p&gt;</comment>
                            <comment id="12541066" author="rhillegas" created="Thu, 8 Nov 2007 15:38:30 +0000"  >&lt;p&gt;I would appreciate it if people could test-drive the latest patch. I am particularly interested in feedback from people who build Derby in Windows and Windows/Cygwin environments. I think there are 2 particularly interesting experiments:&lt;/p&gt;

&lt;p&gt;1) Does the build work as you expect if you don&apos;t change your ant.properties?&lt;/p&gt;

&lt;p&gt;2) Does the build succeed if you have an empty ant.properties (or one which just has a &quot;deprecation=off&quot; line)?&lt;/p&gt;

&lt;p&gt;Feedback from people who build in other environments is also welcome.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12541104" author="thomanie" created="Thu, 8 Nov 2007 18:48:17 +0000"  >&lt;p&gt;I applied derby-3117-04-propertySetter-ad.diff on WinXP with Suns 1.6.0_03, and &lt;/p&gt;

&lt;p&gt;1) the build works fine without changing my existing ant.properties&lt;/p&gt;

&lt;p&gt;2) cleaning my sandbox with &apos;ant clobber&apos;, then removing ant.properties, and attempting a rebuild fails as below:&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
...&lt;br/&gt;
setCompilerProperties:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; Directory C:\program files\java\jdk1.6.0_03\jre\..\..\jre1.5.0_13\jre\lib does not exist.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; Don&apos;t know how to set java15compile.classpath. Please consult&lt;br/&gt;
 BUILDING.txt for instructions on how to set the jdk-library and compiler-classpath properties.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; Don&apos;t know how to set java15compile.classpath. Please consult&lt;br/&gt;
 BUILDING.txt for instructions on how to set the jdk-library and compiler-classpath properties.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.derbyPreBuild.PropertySetter.couldntSetProperty(PropertySetter.java:548)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.derbyPreBuild.PropertySetter.setClasspathFromLib(PropertySetter.java:371)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.derbyPreBuild.PropertySetter.defaultSetter(PropertySetter.java:349)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.derbyPreBuild.PropertySetter.setForMostJDKs(PropertySetter.java:309)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.derbyPreBuild.PropertySetter.setForSunJDKs(PropertySetter.java:276)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.derbyPreBuild.PropertySetter.execute(PropertySetter.java:206)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at sun.reflect.GeneratedMethodAccessor6.invoke(Unknown Source)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.Task.perform(Task.java:348)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.Target.execute(Target.java:357)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.Target.performTasks(Target.java:385)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.Project.executeTarget(Project.java:1298)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.Project.executeTargets(Project.java:1181)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.Main.runBuild(Main.java:698)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.Main.startAnt(Main.java:199)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.launch.Launcher.run(Launcher.java:257)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt;      at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)&lt;/p&gt;

&lt;p&gt;BUILD FAILED&lt;br/&gt;
C:\MyProjects\derby\trunk\build.xml:184: Don&apos;t know how to set java15compile.classpath. &lt;br/&gt;
Please consult BUILDING.txt for instructions on how to set the jdk-library and compiler-classpath properties.&lt;/p&gt;

&lt;p&gt;Total time: 2 seconds&lt;br/&gt;
&amp;#8212;&lt;/p&gt;

&lt;p&gt;It seems the current patch does not actually take the exact java compiler version into consideration, but assumes 1.5. &lt;br/&gt;
 &quot;  &lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; Directory C:\program files\java\jdk1.6.0_03\jre\..\..\jre1.5.0_13\jre\lib does not exist.&quot;&lt;/p&gt;</comment>
                            <comment id="12541106" author="thomanie" created="Thu, 8 Nov 2007 18:53:29 +0000"  >&lt;p&gt;Changing to WinXP, Suns 1.5.0_13 :&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;br/&gt;
...&lt;br/&gt;
setCompilerProperties:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; Directory c:\Program Files\java\jdk1.5.0_13\jre\..\..\jre1.5.0_13\jre\lib does not exist.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; Don&apos;t know how to set java15compile.classpath. Please consult&lt;br/&gt;
 BUILDING.txt for instructions on how to set the jdk-library and compiler-classpath properties.&lt;br/&gt;
...&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
Seems there&apos;s one too many  &quot;..\&quot;s in the jre-path set.&lt;br/&gt;
This is also true in the 1.6.0_03 case above.&lt;/p&gt;</comment>
                            <comment id="12541143" author="rhillegas" created="Thu, 8 Nov 2007 21:39:30 +0000"  >&lt;p&gt;Thanks for the quick response, Thomas. Attaching derby-3117-01-propertySetter-ae.diff. Hopefully this addresses the problem you were seeing. From the  output you attached (thanks for that) it looks as though the PropertySetter found JREs rather than JDKs--in this case the PropertySetter should not append an extra &quot;/jre&quot; to the end of the library locations which it constructs.&lt;/p&gt;</comment>
                            <comment id="12541157" author="thomanie" created="Thu, 8 Nov 2007 22:21:18 +0000"  >&lt;p&gt;derby-3117-01-propertySetter-ae.diff seems to work fine with WinXP / Sun 1.6.0_03 JDK&lt;/p&gt;

&lt;p&gt;My sandbox builds fine &lt;br/&gt;
1) with my existing ant.properties in user.home&lt;br/&gt;
2) without an ant.properties in user.home, and with JAVA_HOME set to point to my 1.6.0_03 installation&lt;/p&gt;

&lt;p&gt;Not sure if this is supposed to be supported - but if I unset JAVA_HOME as well, but keep both &amp;lt;jdk&amp;gt;/bin and &amp;lt;ant&amp;gt;/bin in my PATH, I get:&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
C:\MyProjects\derby\trunk&amp;gt;ant all testing buildjars&lt;br/&gt;
Unable to locate tools.jar. Expected to find it in C:\Program Files\Java\jre1.6.0_03\lib\tools.jar&lt;br/&gt;
Buildfile: build.xml&lt;/p&gt;

&lt;p&gt;checkCompilerLevel:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Warning: z.java modified in the future.&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 1 source file&lt;/p&gt;

&lt;p&gt;BUILD FAILED&lt;br/&gt;
C:\MyProjects\derby\trunk\build.xml:100: Unable to find a javac compiler;&lt;br/&gt;
com.sun.tools.javac.Main is not on the classpath.&lt;br/&gt;
Perhaps JAVA_HOME does not point to the JDK.&lt;br/&gt;
It is currently set to &quot;C:\Program Files\Java\jre1.6.0_03&quot;&lt;/p&gt;

&lt;p&gt;Total time: 0 seconds &lt;br/&gt;
&amp;#8212;&lt;/p&gt;</comment>
                            <comment id="12541294" author="thomanie" created="Fri, 9 Nov 2007 11:32:30 +0000"  >&lt;p&gt;I think it would also be beneficial if the build process either println&apos;d the ant properties it created/set, or as a minimum wrote&lt;br/&gt;
   Using JDK at &apos;&amp;lt;path&amp;gt;/&amp;lt;to&amp;gt;/&amp;lt;javac&amp;gt;/&amp;lt;its&amp;gt;/&amp;lt;using&amp;gt;/&apos; &lt;br/&gt;
and/or&lt;br/&gt;
   Found JDK (1.)5 at &apos;&amp;lt;path&amp;gt;/&amp;lt;to&amp;gt;/&amp;lt;jdk1.5&amp;gt;&lt;br/&gt;
or similar, at the start of the build.&lt;/p&gt;

&lt;p&gt;This is especially true if you have no ant.properties file in the first place, and/or have multiple JDKs installed. This will give a nice visual confirmation to the user in these scenarios.&lt;/p&gt;</comment>
                            <comment id="12541332" author="rhillegas" created="Fri, 9 Nov 2007 14:33:19 +0000"  >&lt;p&gt;Thanks for the continued feedback, Thomas. If JAVA_HOME isn&apos;t set, then the ant startup script makes a good faith effort to set JAVA_HOME to something reasonable. In your case it seems that ant made a bad choice. Our build script also expects that JAVA_HOME will be set correctly--this patch does not lift that requirement.&lt;/p&gt;

&lt;p&gt;Attaching derby-3117-04-propertySetter-af.diff. This incorporates your suggestion: now PropertySetter reports when it sets the compiler properties. These are informational messages which appear by default but which can be suppressed by running ant with the -quiet flag.&lt;/p&gt;

&lt;p&gt;Thanks again!&lt;/p&gt;</comment>
                            <comment id="12541334" author="rhillegas" created="Fri, 9 Nov 2007 14:38:30 +0000"  >&lt;p&gt;I would appreciate if if someone could test-drive this patch in a windows or windows/cygwin environment which uses the IBM jdks. It takes maybe 5 minutes to download/install this patch and run the following experiments:&lt;/p&gt;

&lt;p&gt;1) run the build without any changs to your ant.properties&lt;/p&gt;

&lt;p&gt;2) run the build with an empty ant.properties (or an ant.properties with just a &quot;deprecation=off&quot; line)&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12541444" author="thomanie" created="Fri, 9 Nov 2007 21:10:55 +0000"  >&lt;p&gt;derby-3117-04-propertySetter-af.diff properly displays the properties it sets (still with Sun JDK).&lt;/p&gt;

&lt;p&gt;But ...&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
setCompilerProperties:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; Setting property java14compile.classpath to C:\program files\&lt;br/&gt;
java\jdk1.6.0_03\jre\..\..\jdk1.4.2_15\jre\lib\charsets.jar;C:\program files\jav&lt;br/&gt;
a\jdk1.6.0_03\jre\..\..\jdk1.4.2_15\jre\lib\jce.jar;C:\program files\java\jdk1.6&lt;br/&gt;
.0_03\jre\..\..\jdk1.4.2_15\jre\lib\jsse.jar;C:\program files\java\jdk1.6.0_03\j&lt;br/&gt;
re\..\..\jdk1.4.2_15\jre\lib\plugin.jar;C:\program files\java\jdk1.6.0_03\jre\..&lt;br/&gt;
\..\jdk1.4.2_15\jre\lib\rt.jar;C:\program files\java\jdk1.6.0_03\jre\..\..\jdk1.&lt;br/&gt;
4.2_15\jre\lib\sunrsasign.jar&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; Setting property java15compile.classpath to C:\program files\&lt;br/&gt;
java\jdk1.6.0_03\jre\..\..\jre1.5.0_13\lib\charsets.jar;C:\program files\java\jd&lt;br/&gt;
k1.6.0_03\jre\..\..\jre1.5.0_13\lib\deploy.jar;C:\program files\java\jdk1.6.0_03&lt;br/&gt;
\jre\..\..\jre1.5.0_13\lib\javaws.jar;C:\program files\java\jdk1.6.0_03\jre\..\.&lt;br/&gt;
.\jre1.5.0_13\lib\jce.jar;C:\program files\java\jdk1.6.0_03\jre\..\..\jre1.5.0_1&lt;br/&gt;
3\lib\jsse.jar;C:\program files\java\jdk1.6.0_03\jre\..\..\jre1.5.0_13\lib\plugi&lt;br/&gt;
n.jar;C:\program files\java\jdk1.6.0_03\jre\..\..\jre1.5.0_13\lib\rt.jar&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;It seems PropertySetter still use 1.5.0_13, even though my JAVA_HOME points to 1.6.0_03. &lt;br/&gt;
1.6 satisfies the 1.5 requirement, so should it not use 1.6 for java15compile.classpath if my JAVA_HOME points to 1.6?&lt;/p&gt;

&lt;p&gt;Not only is it using 1.5, it&apos;s actually jumping into the 1.5 jre&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; dir, not the 1.5 JDK jre dir.&lt;/p&gt;</comment>
                            <comment id="12541448" author="rhillegas" created="Fri, 9 Nov 2007 21:42:51 +0000"  >&lt;p&gt;Thanks for the continuing feedback,Thomas. A couple responses follow:&lt;/p&gt;

&lt;p&gt;1) The java14compile.classpath is supposed to point at the 1.4 libs. We use this variable to tell the compiler where the 1.4 libraries live so that the compiler can object if someone uses Java 5 or Java 6 code in classes which are supposed to run on 1.4 VMs. Similarly, java15compile.classpath is supposed to point at the Java 5 libs. That way the compiler can object if someone uses Java 6 code in classes which are supposed to run on Java 5 VMs. For instance, it would be a mistake to reference JDBC 4.0 extensions in code which is supposed to run on Java 5. So the setting of java15compile.classpath looks right to me. The java15compile.classpath should point into a Java 5 library, not a Java 6 library.&lt;/p&gt;

&lt;p&gt;2) I think that PropertySetter is picking up the JRE rather than the JDK because both are visible to it at the same directory level above $JAVA_HOME. We could put in special logic to make PropertySetter prefer the JDK to the JRE if it finds both--but since the libraries ought to contain the same jar files, I don&apos;t think this would have any practical impact.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;
</comment>
                            <comment id="12541452" author="myrna" created="Fri, 9 Nov 2007 22:06:57 +0000"  >&lt;p&gt;I tried this with an IBM15 jvm...When I ran without any changes to my (&quot;$HOME&quot;/)ant.properties the build appeared to go fine (although I didn&apos;t try to run anything...hm...).&lt;/p&gt;

&lt;p&gt;However, with an empty, or absent ant.properties, the build failed in the shared target;&lt;br/&gt;
-------------------------------&lt;br/&gt;
...&lt;br/&gt;
shared:&lt;/p&gt;

&lt;p&gt;compile:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 12 source files to C:\derbyt\svn\trunk\classes&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Fatal Error: Unable to find package java.lang in classpath or bootclasspath&lt;/p&gt;

&lt;p&gt;BUILD FAILED&lt;br/&gt;
C:\trunk\build.xml:410: The following error occurred while executing this line:&lt;br/&gt;
C:\trunk\java\shared\build.xml:67: Compile failed; see the compiler error output for details.&lt;br/&gt;
-------------------------&lt;/p&gt;

&lt;p&gt;This was with JAVA_HOME not set. Note that my java(c) executable is both accessible through PATH and ANT_JAVA.&lt;/p&gt;

&lt;p&gt;Any further suggestions?&lt;/p&gt;</comment>
                            <comment id="12541801" author="rhillegas" created="Mon, 12 Nov 2007 15:16:39 +0000"  >&lt;p&gt;Thanks, Myrna. You still need to set JAVA_HOME. I&apos;m sorry that I didn&apos;t make that clear. Could you retry the experiment with JAVA_HOME set and with an empty or absent ant.properties? Thanks!&lt;/p&gt;</comment>
                            <comment id="12541835" author="djd" created="Mon, 12 Nov 2007 16:48:03 +0000"  >&lt;p&gt;Is it possible to put this functionality in an optional target for now, that would allow others to test it and add support for other vms before enabling it as the default?&lt;/p&gt;

&lt;p&gt;E.g. with a target of setprops one could do:&lt;/p&gt;

&lt;p&gt; ant setprops all&lt;/p&gt;

</comment>
                            <comment id="12541920" author="rhillegas" created="Mon, 12 Nov 2007 19:53:23 +0000"  >&lt;p&gt;It would be tricky to modify this patch so that the new property setting is optional. But I will give it some thought.&lt;/p&gt;</comment>
                            <comment id="12541956" author="myrna" created="Mon, 12 Nov 2007 21:39:41 +0000"  >&lt;p&gt;I believe my earlier attempt failed because patch &lt;b&gt;af&lt;/b&gt; wasn&apos;t applied successfully.&lt;br/&gt;
Now, I get this:&lt;br/&gt;
-------------------------------&lt;br/&gt;
Buildfile: build.xml&lt;/p&gt;

&lt;p&gt;checkCompilerLevel:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 1 source file&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;delete&amp;#93;&lt;/span&gt; Deleting: C:\derbyt\svn\trunk\z.java&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;delete&amp;#93;&lt;/span&gt; Deleting: C:\derbyt\svn\trunk\z.class&lt;/p&gt;

&lt;p&gt;init:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;mkdir&amp;#93;&lt;/span&gt; Created dir: C:\derbyt\svn\trunk\classes&lt;/p&gt;

&lt;p&gt;ensuresanitystate:&lt;/p&gt;

&lt;p&gt;evaluate.sane:&lt;/p&gt;

&lt;p&gt;ensuresanitystate.sane:&lt;/p&gt;

&lt;p&gt;sane:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;propertyfile&amp;#93;&lt;/span&gt; Creating new property file: C:\derbyt\svn\trunk\java\engine\state.properties&lt;/p&gt;

&lt;p&gt;ensuresanitystate.insane:&lt;/p&gt;

&lt;p&gt;setissane:&lt;/p&gt;

&lt;p&gt;prebuild:&lt;/p&gt;

&lt;p&gt;compile:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; Compiling 1 source file to C:[...my path to trunk...]trunk\classes&lt;/p&gt;

&lt;p&gt;build:&lt;/p&gt;

&lt;p&gt;setCompilerProperties:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; Array index out of range: -1&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; java.lang.ArrayIndexOutOfBoundsException: Array index out of range: -1&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.derbyPreBuild.PropertySetter.getJreLib(PropertySetter.java:325)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.derbyPreBuild.PropertySetter.setForMostJDKs(PropertySetter.java:307)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.derbyPreBuild.PropertySetter.setForIbmJDKs(PropertySetter.java:259)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.derbyPreBuild.PropertySetter.execute(PropertySetter.java:206)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at java.lang.reflect.Method.invoke(Method.java:615)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:105)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Task.perform(Task.java:348)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Target.execute(Target.java:357)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Target.performTasks(Target.java:385)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1329)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Project.executeTarget(Project.java:1298)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Project.executeTargets(Project.java:1181)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Main.runBuild(Main.java:698)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.Main.startAnt(Main.java:199)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.launch.Launcher.run(Launcher.java:257)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;setJdkProperties&amp;#93;&lt;/span&gt; 	at org.apache.tools.ant.launch.Launcher.main(Launcher.java:104)&lt;/p&gt;

&lt;p&gt;BUILD FAILED&lt;br/&gt;
C:[...my path to trunk...]trunk\build.xml:184: java.lang.ArrayIndexOutOfBoundsException: Array index out of range: -1&lt;/p&gt;</comment>
                            <comment id="12542044" author="djd" created="Tue, 13 Nov 2007 04:40:15 +0000"  >&lt;p&gt;Rick&amp;gt; It would be tricky to modify this patch so that the new property setting is optional.&lt;/p&gt;

&lt;p&gt;If it&apos;s a hassle don&apos;t bother, just thought it might be an easier way to get the patch committed and testable by others and also allowing others to add support for other platforms.&lt;/p&gt;</comment>
                            <comment id="12542186" author="rhillegas" created="Tue, 13 Nov 2007 18:02:25 +0000"  >&lt;p&gt;Attaching the next rev of the property-setting patch: derby-3117-04-propertySetter-ag.diff. This makes the automatic property setting optional. In order to get automatic setting of the compiler properties, you need to add the following line to your ant.properties:&lt;/p&gt;

&lt;p&gt;autosetProps=on&lt;/p&gt;

&lt;p&gt;Once we&apos;re confident that this patch addresses the major platforms we use, we can make automatic property setting standard.&lt;/p&gt;

&lt;p&gt;This patch also adds another diagnostic so that the PropertySetter won&apos;t stumble on an array bounds exception in the situation that Myrna tripped across. Hopefully, PropertySetter will fail more gracefully and give some useful information.&lt;/p&gt;

&lt;p&gt;I believe that PropertySetter was failing for Myrna because the program doesn&apos;t know the names of the IBM JDKs on Windows. However, it&apos;s also possible that the PropertySetter doesn&apos;t know where to look for the JDKs on Windows. Myrna, could you do the following:&lt;/p&gt;

&lt;p&gt;1) add &quot;autosetProps=on&quot; to your ant.properties&lt;/p&gt;

&lt;p&gt;2) then re-run the experiments. You should get some diagnostic output. Could you post that in a comment. Also, could you give me some additional information:&lt;/p&gt;

&lt;p&gt; a) the directory names of the IBM JDKs on your machine&lt;br/&gt;
 b) where those directories live relative to $JAVA_HOME&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12542476" author="myrna" created="Wed, 14 Nov 2007 14:51:18 +0000"  >&lt;p&gt;I like the extra comments / diagnostics.&lt;/p&gt;

&lt;p&gt;I hadn&apos;t realized the 1.5 ibm jvm was expected to be installed in a dir with the string &apos;50&apos;; and that an 1.4.2 jvm was expected to be sitting in a dir next to the 1.5. install dir. (I habitually change the installdir names of jvms to something much shorter.)&lt;br/&gt;
The comments/diagnostics now made the expectations clear (of course I could&apos;ve looked in the propertySetter source before, sorry about that).&lt;/p&gt;

&lt;p&gt;When I finagled my env to have the default names and the two jvms sitting next to eachother the build worked fine.&lt;br/&gt;
And also, the build worked fine when I did not have setautoProps on.&lt;/p&gt;</comment>
                            <comment id="12542656" author="rhillegas" created="Thu, 15 Nov 2007 02:31:43 +0000"  >&lt;p&gt;Thanks, Myrna. I think that your feedback has helped improve this tool greatly.&lt;/p&gt;</comment>
                            <comment id="12542761" author="rhillegas" created="Thu, 15 Nov 2007 12:49:18 +0000"  >&lt;p&gt;Attaching derby-3117-propertySetter-ah.diff. This is a slight change to the previous patch: I updated the class header comment on PropertySetter to record Myrna&apos;s feedback that the tool seems to work now on IBM JDKs on Windows.&lt;/p&gt;</comment>
                            <comment id="12542762" author="rhillegas" created="Thu, 15 Nov 2007 12:51:00 +0000"  >&lt;p&gt;I think the patch supports enough platforms at this point that it is worth committing. I plan to commit the patch on Monday unless someone objects.&lt;/p&gt;</comment>
                            <comment id="12543571" author="rhillegas" created="Mon, 19 Nov 2007 13:59:50 +0000"  >&lt;p&gt;Committed derby-3117-04-propertySetter-ah.diff at subversion revision 596304.&lt;/p&gt;</comment>
                            <comment id="12543677" author="rhillegas" created="Mon, 19 Nov 2007 20:39:11 +0000"  >&lt;p&gt;Attaching derby-3117-05-setterCleanup.diff. This makes the PropertySetter&apos;s lookup of grandparent directories more portable. Committed at subversion revision 596438.&lt;/p&gt;</comment>
                            <comment id="12543711" author="knutanders" created="Mon, 19 Nov 2007 22:18:59 +0000"  >&lt;p&gt;d3117-solaris.diff enabled me to build Derby on Solaris with the JDKs in their default locations. I added a method getJdkSearchPath() where one can add system dependent directories to search if the simple check in the parent directory of JAVA_HOME fails.&lt;/p&gt;</comment>
                            <comment id="12543719" author="rhillegas" created="Mon, 19 Nov 2007 22:52:14 +0000"  >&lt;p&gt;Thanks for the patch, Knut. It looks good to me. I have tested it in the following environments:&lt;/p&gt;

&lt;p&gt;Apple JDKs on Mac OS X&lt;br/&gt;
Sun JDKs on Ubuntu&lt;br/&gt;
IBM JDKs on Ubuntu&lt;/p&gt;</comment>
                            <comment id="12543728" author="knutanders" created="Mon, 19 Nov 2007 23:12:32 +0000"  >&lt;p&gt;Thanks for testing the patch, Rick! Committed revision 596478.&lt;/p&gt;</comment>
                            <comment id="12552781" author="rhillegas" created="Tue, 18 Dec 2007 15:13:15 +0000"  >&lt;p&gt;Attaching derby-3117-06-setterDefault-aa.diff. This patch makes the automatic setting of compiler properties the default behavior for the Derby build. Touches one file:&lt;/p&gt;

&lt;p&gt;build.xml&lt;/p&gt;

&lt;p&gt;Committed at subversion revision 605224.&lt;/p&gt;</comment>
                            <comment id="12552803" author="rhillegas" created="Tue, 18 Dec 2007 16:03:25 +0000"  >&lt;p&gt;Attaching derby-3117-07-buildInstructions-aa.diff. These are changes to BUILDING.txt to reflect the behavior introduced by the previous submission. Includes the following changes:&lt;/p&gt;

&lt;p&gt;1) Adds a preface to section 3.2 stating that customization of ant.properties is optional.&lt;/p&gt;

&lt;p&gt;2) Removes the Mac OS X instructions since these are hardcoded into the default property setter now.&lt;/p&gt;</comment>
                            <comment id="12554036" author="rhillegas" created="Fri, 21 Dec 2007 21:29:40 +0000"  >&lt;p&gt;Committed derby-3117-07-buildInstructions-aa.diff at subversion revision 606323.&lt;/p&gt;</comment>
                            <comment id="12556879" author="kristwaa" created="Tue, 8 Jan 2008 12:25:16 +0000"  >&lt;p&gt;While looking into &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3149&quot; title=&quot;Add ant targets for building and running the package private tests against the classes directories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3149&quot;&gt;&lt;del&gt;DERBY-3149&lt;/del&gt;&lt;/a&gt;, I found that documentation of the variable/property &apos;j15lib&apos; is  missing in BUILDING.txt.&lt;br/&gt;
I have attached &apos;derby-3117-08a-j15libBuildingInstr.diff&apos; as a suggestion. Please review.&lt;br/&gt;
The patch also changes one of the headings (2.2.2) in the &quot;table of contents&quot;.&lt;/p&gt;</comment>
                            <comment id="12556897" author="rhillegas" created="Tue, 8 Jan 2008 13:46:58 +0000"  >&lt;p&gt;Thanks for the improvements to BUILDING.txt, Kristian. derby-3117-08aj15libBuildingInstr.diff looks good to me.&lt;/p&gt;</comment>
                            <comment id="12557182" author="kristwaa" created="Wed, 9 Jan 2008 08:42:42 +0000"  >&lt;p&gt;Committed &apos;derby-3117-08aj15libBuildingInstr.diff&apos; to trunk with revision 610304.&lt;/p&gt;

&lt;p&gt;Has the time to remove the duplicate code in build.xml come now?&lt;br/&gt;
Parts of it (dontAutosetProps) caused some confusion (see &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3149&quot; title=&quot;Add ant targets for building and running the package private tests against the classes directories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3149&quot;&gt;&lt;del&gt;DERBY-3149&lt;/del&gt;&lt;/a&gt;) due to lack of documentation. However, there is no need to document it if it is going to be removed.&lt;/p&gt;

&lt;p&gt;Also, are there still more patches awaiting commit here?&lt;br/&gt;
I wasn&apos;t quite sure, so I left the patch available flag on.&lt;/p&gt;


&lt;p&gt;thanks,&lt;/p&gt;</comment>
                            <comment id="12557283" author="rhillegas" created="Wed, 9 Jan 2008 14:26:43 +0000"  >&lt;p&gt;Hi Kristian,&lt;/p&gt;

&lt;p&gt;Thanks for committing your improvement to BUILDING.txt. I&apos;m not sure what you mean by duplicate code. I think this is the trajectory we are on:&lt;/p&gt;

&lt;p&gt;1) Check in the PropertySetter but leave the old scheme as the default. This phase lasted a month. In this phase other people were able to make PropertySetter work correctly in more environments.&lt;/p&gt;

&lt;p&gt;2) Make PropertySetter the default. This is the phase we&apos;re in now. It appears from your experience with &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3149&quot; title=&quot;Add ant targets for building and running the package private tests against the classes directories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3149&quot;&gt;&lt;del&gt;DERBY-3149&lt;/del&gt;&lt;/a&gt; that some people are not happy with the new default behavior and have not switched over to using it.&lt;/p&gt;

&lt;p&gt;3) Remove the old scheme and just rely on PropertySetter. I think that before we can move to this phase, we have to address the problems that are keeping people stuck on the old scheme. Hopefully this is just a matter of making PropertySetter smarter.&lt;/p&gt;

&lt;p&gt;I was only aware of one issue which prevented us from moving from (2) to (3). That is an issue raised by Andrew just before the holidays: &lt;a href=&quot;http://www.nabble.com/Re%3A-Change-to-Derby-build-soon-p14463570.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/Re%3A-Change-to-Derby-build-soon-p14463570.html&lt;/a&gt; Thanks for bringing my attention to the issue which Kathey encountered in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3149&quot; title=&quot;Add ant targets for building and running the package private tests against the classes directories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3149&quot;&gt;&lt;del&gt;DERBY-3149&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I think we still need to do the following before we can move from (2) to (3):&lt;/p&gt;

&lt;p&gt;A) Fix the known issues raised by Andrew and Kathey.&lt;/p&gt;

&lt;p&gt;B) Warn the community that we want to remove the old scheme. We could poll the community to discover who is still stuck on the old scheme and why.&lt;/p&gt;

&lt;p&gt;C) Fix the issues raised by that poll.&lt;/p&gt;

&lt;p&gt;D) Remove the old scheme.&lt;/p&gt;

&lt;p&gt;That, at least, is what makes sense to me.&lt;/p&gt;</comment>
                            <comment id="12557293" author="kristwaa" created="Wed, 9 Jan 2008 15:36:08 +0000"  >&lt;p&gt;Thanks for the useful plan summary Rick &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;With duplicate code, I was thinking on the following (taken from build.xml).&lt;br/&gt;
  &amp;lt;target name=&quot;setInitialProperties&quot; if=&quot;dontAutosetProps&quot;&lt;br/&gt;
          description=&quot;Set the initial properties for this build script. This duplicates the property setting block in setCompilerProperties. Once we make setCompilerProperties mandatory, this target should be removed.&quot;&lt;/p&gt;

&lt;p&gt;and &lt;/p&gt;

&lt;p&gt;  &amp;lt;target name=&quot;setCompilerProperties&quot; unless=&quot;dontAutosetProps&quot;&lt;br/&gt;
          description=&quot;Set the ant variables which identify the compiler classpaths. Remove the autosetProps logic when this target becomes mandatory.&quot;&lt;/p&gt;

&lt;p&gt;That said, maybe I was a bit to impatient.&lt;br/&gt;
I just thought that the PropertySetter is coded in such a way that there is no longer any need for dontAutosetProps, since it will return without doing anything it the java1Xcompile.classpath variables are set, and it will derive them if the j1Xlib variables are set.&lt;/p&gt;

&lt;p&gt;I&apos;m current running with j4lib and j5lib in my ant.properties and it is working fine.&lt;br/&gt;
Your plan makes sense to me.&lt;/p&gt;</comment>
                            <comment id="12565580" author="rhillegas" created="Mon, 4 Feb 2008 22:41:36 +0000"  >&lt;p&gt;Attaching derby-3117-09-leopard-PropertySetter.diff. This makes the PropertySetter flexible enough to work with the 10.4 and 10.5 revs of Mac OS X and its vms. Committed at subversion revision 618476.&lt;/p&gt;</comment>
                            <comment id="12566981" author="knutanders" created="Fri, 8 Feb 2008 10:42:35 +0000"  >&lt;p&gt;Attaching d3117-concurrent.diff. This patch compiles the code that depends on the java.util.concurrent package with JDK 1.5 instead of JDK 1.6. Also uncommented the entries for these classes in modules.properties, and removed the corresponding rewrite rule, since it&apos;s no longer an optional part of the build after this change.&lt;/p&gt;

&lt;p&gt;I have verified that the classes that depend on JDK 1.5 are built when jdk16 is not defined in ant.properties, and that the different Java versions (1.4, 1.5 and 1.6) pick up the correct classes at run time. suites.All ran cleanly.&lt;/p&gt;

&lt;p&gt;Committed revision 619828.&lt;/p&gt;</comment>
                            <comment id="12648238" author="kmarsden" created="Mon, 17 Nov 2008 18:38:43 +0000"  >&lt;p&gt;Can this issue be closed as fixed?&lt;/p&gt;</comment>
                            <comment id="12648247" author="rhillegas" created="Mon, 17 Nov 2008 18:54:35 +0000"  >&lt;p&gt;Hi Kathey,&lt;/p&gt;

&lt;p&gt;I think this issue could be sanded down more but I haven&apos;t worked on it in a long time. I think it&apos;s ok to declare victory now. Closing the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12368316" name="BuildDefaults.txt" size="2341" author="rhillegas" created="Wed, 24 Oct 2007 20:11:51 +0100"/>
                            <attachment id="12375060" name="d3117-concurrent.diff" size="3532" author="knutanders" created="Fri, 8 Feb 2008 10:42:35 +0000"/>
                            <attachment id="12369826" name="d3117-solaris.diff" size="3000" author="knutanders" created="Mon, 19 Nov 2007 22:18:59 +0000"/>
                            <attachment id="12367275" name="derby-3117-01-enforceJava5-aa.diff" size="4812" author="rhillegas" created="Mon, 8 Oct 2007 18:59:46 +0100"/>
                            <attachment id="12367280" name="derby-3117-01-enforceJava5-ab.diff" size="5002" author="rhillegas" created="Mon, 8 Oct 2007 19:59:46 +0100"/>
                            <attachment id="12367511" name="derby-3117-01-enforceJava5-ac.diff" size="5005" author="rhillegas" created="Wed, 10 Oct 2007 19:26:06 +0100"/>
                            <attachment id="12367887" name="derby-3117-02-website-aa.diff" size="9078" author="rhillegas" created="Wed, 17 Oct 2007 18:12:58 +0100"/>
                            <attachment id="12368490" name="derby-3117-03-junit-aa.diff" size="793" author="rhillegas" created="Fri, 26 Oct 2007 15:56:49 +0100"/>
                            <attachment id="12368699" name="derby-3117-04-propertySetter-aa.diff" size="18788" author="rhillegas" created="Tue, 30 Oct 2007 18:11:59 +0000"/>
                            <attachment id="12368763" name="derby-3117-04-propertySetter-ab.diff" size="19464" author="rhillegas" created="Wed, 31 Oct 2007 13:37:04 +0000"/>
                            <attachment id="12368895" name="derby-3117-04-propertySetter-ac.diff" size="22995" author="rhillegas" created="Fri, 2 Nov 2007 21:01:18 +0000"/>
                            <attachment id="12368943" name="derby-3117-04-propertySetter-ad.diff" size="23043" author="rhillegas" created="Sun, 4 Nov 2007 16:19:52 +0000"/>
                            <attachment id="12369192" name="derby-3117-04-propertySetter-ae.diff" size="24281" author="rhillegas" created="Thu, 8 Nov 2007 21:39:30 +0000"/>
                            <attachment id="12369232" name="derby-3117-04-propertySetter-af.diff" size="24370" author="rhillegas" created="Fri, 9 Nov 2007 14:33:19 +0000"/>
                            <attachment id="12369435" name="derby-3117-04-propertySetter-ag.diff" size="26128" author="rhillegas" created="Tue, 13 Nov 2007 18:02:24 +0000"/>
                            <attachment id="12369591" name="derby-3117-04-propertySetter-ah.diff" size="26136" author="rhillegas" created="Thu, 15 Nov 2007 12:49:18 +0000"/>
                            <attachment id="12369815" name="derby-3117-05-setterCleanup-aa.diff" size="3379" author="rhillegas" created="Mon, 19 Nov 2007 20:39:11 +0000"/>
                            <attachment id="12371866" name="derby-3117-06-setterDefault-aa.diff" size="956" author="rhillegas" created="Tue, 18 Dec 2007 15:13:15 +0000"/>
                            <attachment id="12371874" name="derby-3117-07-buildInstructions-aa.diff" size="3737" author="rhillegas" created="Tue, 18 Dec 2007 16:03:25 +0000"/>
                            <attachment id="12372706" name="derby-3117-08a-j15libBuildingInstr.diff" size="1134" author="kristwaa" created="Tue, 8 Jan 2008 12:25:16 +0000"/>
                            <attachment id="12374718" name="derby-3117-09-leopard-PropertySetter.diff" size="1184" author="rhillegas" created="Mon, 4 Feb 2008 22:41:36 +0000"/>
                            <attachment id="12367888" name="derby_source.html" size="13392" author="rhillegas" created="Wed, 17 Oct 2007 18:12:59 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 8 Oct 2007 18:32:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30729</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0jtr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37030</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>