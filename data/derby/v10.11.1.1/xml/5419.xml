<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:43:58 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5419/DERBY-5419.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5419] Make Derby run on Oracle Java ME Embedded Client</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5419</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I tried running Derby on Oracle Java ME Embedded Client 1.0, and booting the engine failed:&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.NoClassDefFoundError: java.nio.channels.OverlappingFileLockException&lt;br/&gt;
	at org.apache.derby.impl.io.DirStorageFactory4.newPersistentFile(DirStorageFactory4.java:57)&lt;br/&gt;
	at org.apache.derby.impl.io.DirStorageFactory.newStorageFile(DirStorageFactory.java:58)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.StorageFactoryService$1.run(StorageFactoryService.java:96)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(Compiled Method)(AccessController.java:351)&lt;br/&gt;
	at java.security.AccessController.doPrivileged(AccessController.java:320)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.StorageFactoryService.&amp;lt;init&amp;gt;(StorageFactoryService.java:86)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.getPersistentService(BaseMonitor.java:1630)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.access$100(BaseMonitor.java:99)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor$ProviderEnumeration.getNextStorageFactory(BaseMonitor.java:2146)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor$ProviderEnumeration.hasMoreElements(BaseMonitor.java:2159)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.findProviderAndStartService(BaseMonitor.java:1516)&lt;br/&gt;
	at org.apache.derby.impl.services.monitor.BaseMonitor.startPersistentService(BaseMonitor.java:979)&lt;br/&gt;
	at org.apache.derby.iapi.services.monitor.Monitor.startPersistentService(Monitor.java:550)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.bootDatabase(EmbedConnection.java:2697)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.EmbedConnection.&amp;lt;init&amp;gt;(EmbedConnection.java:385)&lt;/p&gt;

&lt;p&gt;This seems to happen because Derby recognizes it as a Java 1.4 platform, whereas it&apos;s actually a CDC/FP 1.1.2 platform.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12523566">DERBY-5419</key>
            <summary>Make Derby run on Oracle Java ME Embedded Client</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Sep 2011 15:58:06 +0100</created>
                <updated>Mon, 12 Mar 2012 09:51:47 +0000</updated>
                            <resolved>Fri, 23 Sep 2011 12:33:31 +0100</resolved>
                                    <version>10.8.2.2</version>
                                    <fixVersion>10.8.2.2</fixVersion>
                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>Services</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13107893" author="knutanders" created="Mon, 19 Sep 2011 16:15:24 +0100"  >&lt;p&gt;Derby tries to find out if the JVM is a Java ME variant in the JVMInfo class. It uses the java.specification.name property to determine that. Currently, it checks if the property value starts with &quot;J2ME&quot;, in which case it&apos;s recognized as IBM WCTME, or if it contains the two words &quot;Profile&quot; and &quot;Specification&quot;, in which case it&apos;s recognized as phoneME.&lt;/p&gt;

&lt;p&gt;The property has this value on Oracle Java ME Embedded Client 1.0, which isn&apos;t recognized by either of the two checks:&lt;/p&gt;

&lt;p&gt;CDC 1.1.2 (JSR218)- FP 1.1.2 (JSR219) (SecOp 1.0)- PBP 1.1.2 (JSR217)- (RMI JSR66)- (JDBC JSR169)- (WebServices JSR172)- (Specification&lt;/p&gt;

&lt;p&gt;The attached patch makes JVMInfo also check if the value starts with CDC. With that change, the engine doesn&apos;t try to load modules that require Java SE on this platform, and I&apos;m able to run some smaller tests. (I haven&apos;t managed to run suites.All yet, as it fails with an OOME after a while.)&lt;/p&gt;</comment>
                            <comment id="13113345" author="knutanders" created="Fri, 23 Sep 2011 12:33:31 +0100"  >&lt;p&gt;I only wish there were a more robust way to detect that we&apos;re running on Java ME. The CLDC spec defines a system property called microedition.platform, which has the value &quot;j2me&quot; on both phoneME and OJEC (don&apos;t know about weme and others). Unfortunately, the property value is defined to be implementation-dependent, so it might not be more reliable after all.&lt;/p&gt;

&lt;p&gt;In any case, I&apos;ve now checked in the patch that improves the current logic so that it recognizes Oracle Java ME Embedded Client too.&lt;/p&gt;

&lt;p&gt;Committed to trunk, revision 1174646.&lt;br/&gt;
Merged to 10.8 and committed revision 1174649.&lt;/p&gt;</comment>
                            <comment id="13113531" author="myrna" created="Fri, 23 Sep 2011 17:15:02 +0100"  >&lt;p&gt;For what it&apos;s worth, weme (6.2) doesn&apos;t set this system property &apos;microedition.platform&apos; at all.&lt;br/&gt;
It does set the following which hint at j2ME or CDC Foundation information: &lt;br/&gt;
java.specification.name: J2ME Foundation Specification&lt;br/&gt;
java.specification.version: 1.1&lt;br/&gt;
java.vm.specification.version: 1.0&lt;br/&gt;
java.version: WECE J2ME Foundation Specification v1.1&lt;/p&gt;</comment>
                            <comment id="13113758" author="knutanders" created="Fri, 23 Sep 2011 21:52:03 +0100"  >&lt;p&gt;Thanks, Myrna. Sounds like there&apos;s not many more robust options when it comes to properties, then. Maybe checking for the lack of the DriverManager class would work.&lt;/p&gt;</comment>
                            <comment id="13227398" author="knutanders" created="Mon, 12 Mar 2012 09:51:29 +0000"  >&lt;p&gt;I just tried again with Oracle Java ME Embedded Client 1.1, and there the value of the java.specification.name property has changed to &quot;Foundation Profile Specification&quot;, which is the same as phoneME reports. This means OJEC 1.1 is recognized by all the Derby versions that recognize phoneME, not only the versions that contain the fix for this issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12495085" name="d5419-1a-check-for-cdc.diff" size="657" author="knutanders" created="Mon, 19 Sep 2011 16:15:24 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 23 Sep 2011 16:15:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31628</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0cqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35881</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>