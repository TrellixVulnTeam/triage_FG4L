<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:31:03 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3587/DERBY-3587.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3587] Convert jdbcapi/testRelative.java to JUnit</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3587</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Convert jdbcapi/testRelative.java from the old testHarness to JUnit.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12392901">DERBY-3587</key>
            <summary>Convert jdbcapi/testRelative.java to JUnit</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="suranjay">Suran Jayathilaka</assignee>
                                    <reporter username="suranjay">Suran Jayathilaka</reporter>
                        <labels>
                    </labels>
                <created>Wed, 2 Apr 2008 08:51:51 +0100</created>
                <updated>Fri, 21 Jan 2011 17:51:50 +0000</updated>
                            <resolved>Sat, 10 May 2008 23:53:55 +0100</resolved>
                                                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12586168" author="suranjay" created="Sun, 6 Apr 2008 20:01:30 +0100"  >&lt;p&gt;This patch adds the RelativeTest.java file which is a conversion of the jdbcapi/testRelative test, to the same package as the latter. Also adds the tests to the _Suite class.&lt;/p&gt;

&lt;p&gt;Please review and comment if anything is lacking or incorrect.&lt;/p&gt;</comment>
                            <comment id="12586859" author="kmarsden" created="Tue, 8 Apr 2008 16:56:58 +0100"  >&lt;p&gt;Thanks for the patch. Below are some comments:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;remove the old test from the suite and remove associated test and master files.&lt;/li&gt;
	&lt;li&gt;In RelativeTest, keep connections  local to the fixtures  instead of making  a field.&lt;/li&gt;
	&lt;li&gt;Instead of creating your table in setup, use CleanDatabaseSetup and decorateSQL, (see BatchUpdateTest for an example).  This way it will get automatically cleaned up.&lt;/li&gt;
	&lt;li&gt;Instead of con.prepareStatement() and con.createStatement()  you can use just prepareStatement  createStatement() and statements  will get closed automatically.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In the following code, only the call that is expected to fail should be in the try block&lt;br/&gt;
	try &lt;/p&gt;
{
			rs.relative(10);
			/*
			 * Attempting to move beyond the first/last row in the 
			 * result set positions the cursor before/after the the 
			 * first/last row. Therefore, attempting to get value now
			 * will throw an exception.
			 */
			rs.getString(&quot;name&quot;);
		}
&lt;p&gt; catch (SQLException sqle) &lt;/p&gt;
{
			assertSQLState(&quot;Unexpected SQL state.&quot;, NO_CURRENT_ROW_SQL_STATE, sqle);
		}
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I wonder if using&lt;br/&gt;
	assertSQLState(&quot;Unexpected SQL state.&quot;, NO_CURRENT_ROW_SQL_STATE, sqle);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;instead of &lt;br/&gt;
	assertSQLState(NO_CURRENT_ROW_SQL_STATE, sqle);&lt;/p&gt;

&lt;p&gt;will actually give us less information on failure, because I think with the latter format we will see what the actual SQLException is and with the former we will not.&lt;/p&gt;

&lt;p&gt;I am not sure, but I think with some JVM&apos;s the test order may vary, so initializing NO_CURRENT_ROW_SQL_STATE = &quot;24000&quot;; and then changing it on setUp if we are running with derbyclient might be a problem if the network server tests go first. It might be clearer just to put the condition in the catch block or make an assertNoCurrrentRow() method that has the condition.&lt;/p&gt;

&lt;p&gt;Otherwise looks good.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;</comment>
                            <comment id="12589203" author="suranjay" created="Tue, 15 Apr 2008 20:40:22 +0100"  >&lt;p&gt;Thanks for the helpful comments.&lt;/p&gt;

&lt;p&gt;This updated patch removes the testRelative.java and master/testRelative.out files. Also makes the changes suggested above. &lt;/p&gt;

&lt;p&gt;Please review and comment.&lt;/p&gt;</comment>
                            <comment id="12592711" author="kmarsden" created="Mon, 28 Apr 2008 01:53:59 +0100"  >&lt;p&gt;Sorry for the delay reviewing this patch.&lt;br/&gt;
Looks good except for the test should be removed from JDBCHarnessJavaTest and also remove it from &lt;br/&gt;
suites/jdbcapi.runall and suites/DerbyNet.exclude.  It&apos;s good to run suites.All and derbyall to catch issues like this.&lt;/p&gt;</comment>
                            <comment id="12593568" author="suranjay" created="Thu, 1 May 2008 17:29:57 +0100"  >&lt;p&gt;References to testRelative removed from JDBCHarnessJavaTest, suites/jdbcapi.runall and suites/DerbyNet.exclude.&lt;br/&gt;
Test suites run.&lt;/p&gt;</comment>
                            <comment id="12594994" author="kmarsden" created="Wed, 7 May 2008 19:36:33 +0100"  >&lt;p&gt;I just noticed in the test that we are missing fail lines if an expected failure executes. For example we have:&lt;/p&gt;

&lt;p&gt;try &lt;/p&gt;
{
			/*
			 * Attempting to move beyond the first/last row in the result set
			 * positions the cursor before/after the the first/last row.
			 * Therefore, attempting to get value will throw an exception.
			 */
			rs.getString(&quot;name&quot;);
		}
&lt;p&gt; catch (SQLException sqle) {&lt;br/&gt;
			/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;sets the expected sql state for the expected exceptions,&lt;/li&gt;
	&lt;li&gt;according to return value of usingDerbyNetClient().&lt;br/&gt;
			 */&lt;br/&gt;
			String NO_CURRENT_ROW_SQL_STATE = &quot;&quot;;&lt;br/&gt;
			if (usingDerbyNetClient()) 
{
				NO_CURRENT_ROW_SQL_STATE = &quot;XJ121&quot;;
			}
&lt;p&gt; else &lt;/p&gt;
{
				NO_CURRENT_ROW_SQL_STATE = &quot;24000&quot;;
			}
&lt;p&gt;			assertSQLState(NO_CURRENT_ROW_SQL_STATE, sqle);&lt;br/&gt;
		}&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;There should be a fail call after rs.getString so that we get a failure if the statement executes.  Could you submit a followup patch?&lt;/p&gt;
</comment>
                            <comment id="12595561" author="suranjay" created="Fri, 9 May 2008 12:18:27 +0100"  >&lt;p&gt;This patch adds the fail() statements that will fail the test if rs.getString() doesn&apos;t throw an exception when reading from an invalid row.&lt;/p&gt;</comment>
                            <comment id="12595641" author="kmarsden" created="Fri, 9 May 2008 16:37:10 +0100"  >&lt;p&gt;Thanks Suran. Committed revision 654859. This issue can probably be resolved now.&lt;/p&gt;</comment>
                            <comment id="12595864" author="suranjay" created="Sat, 10 May 2008 23:53:55 +0100"  >&lt;p&gt;testRelative conversion to junit complete.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12381751" name="derby-3587-fail_addition.diff" size="1022" author="suranjay" created="Fri, 9 May 2008 12:18:27 +0100"/>
                            <attachment id="12380211" name="jdbcapi-testRelative-converted-2.diff" size="21227" author="suranjay" created="Tue, 15 Apr 2008 20:40:22 +0100"/>
                            <attachment id="12381257" name="jdbcapi-testRelative-converted-3.diff" size="16047" author="suranjay" created="Thu, 1 May 2008 17:29:57 +0100"/>
                            <attachment id="12379512" name="jdbcapi-testRelative-converted.diff" size="6975" author="suranjay" created="Sun, 6 Apr 2008 20:01:30 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 8 Apr 2008 15:56:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30916</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0lhj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>37299</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>