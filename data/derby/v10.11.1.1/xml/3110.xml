<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:32:48 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3110/DERBY-3110.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3110] server hangs after trace on command fails</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3110</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Tried turning on trace:&lt;/p&gt;

&lt;p&gt;&amp;gt;networkservercontrol  trace on&lt;br/&gt;
Invalid reply from network server: Insufficient data.&lt;/p&gt;

&lt;p&gt;The server process shows the following stack trace:&lt;/p&gt;

&lt;p&gt;access denied (java.io.FilePermission Server58.trace write)&lt;br/&gt;
java.security.AccessControlException: access denied (java.io.FilePermission Server58.trace write)&lt;br/&gt;
        at java.security.AccessControlContext.checkPermission(AccessControlContext.java:269)&lt;br/&gt;
        at java.security.AccessController.checkPermission(AccessController.java:401)&lt;br/&gt;
        at java.lang.SecurityManager.checkPermission(SecurityManager.java:524)&lt;br/&gt;
        at java.lang.SecurityManager.checkWrite(SecurityManager.java:954)&lt;br/&gt;
        at java.io.FileOutputStream.&amp;lt;init&amp;gt;(FileOutputStream.java:169)&lt;br/&gt;
        at java.io.FileOutputStream.&amp;lt;init&amp;gt;(FileOutputStream.java:70)&lt;br/&gt;
        at java.io.FileWriter.&amp;lt;init&amp;gt;(FileWriter.java:46)&lt;br/&gt;
        at org.apache.derby.impl.drda.DssTrace.startComBufferTrace(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.drda.Session.initTrace(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.drda.Session.setTraceOn(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.drda.NetworkServerControlImpl.setTrace(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.drda.NetworkServerControlImpl.processCommands(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.drda.DRDAConnThread.sessionInitialState(Unknown Source)&lt;br/&gt;
        at org.apache.derby.impl.drda.DRDAConnThread.run(Unknown Source)&lt;/p&gt;

&lt;p&gt;The server now does not respond to ping or shutdown, and has to be killed.&lt;/p&gt;

&lt;p&gt;See also &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3103&quot; title=&quot;Basic server security  policy does not allow trace to be turned on&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3103&quot;&gt;&lt;del&gt;DERBY-3103&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12379806">DERBY-3110</key>
            <summary>server hangs after trace on command fails</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="sebb@apache.org">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Oct 2007 16:41:32 +0100</created>
                <updated>Wed, 10 Apr 2013 22:51:28 +0100</updated>
                            <resolved>Mon, 5 Nov 2007 23:53:03 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.2.1</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>Network Server</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12534407" author="kmarsden" created="Fri, 12 Oct 2007 22:06:42 +0100"  >&lt;p&gt;The failure turning tracing on is because of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3086&quot; title=&quot;The server policy needs to grant derbynet.jar more permissions so that sysinfo and drda tracing will work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3086&quot;&gt;&lt;del&gt;DERBY-3086&lt;/del&gt;&lt;/a&gt;, but the hang in the event of failure is a different issue.&lt;/p&gt;
</comment>
                            <comment id="12538041" author="kmarsden" created="Fri, 26 Oct 2007 18:59:55 +0100"  >&lt;p&gt;Attached is an initial patch for this issue. If there is an error in turning on tracing for any of the sessions, we fail to turn global tracing on and return an error to the client. The change also wraps the tracing in a privilege block   I am working to try to make a test for this.&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;
</comment>
                            <comment id="12538133" author="kmarsden" created="Sat, 27 Oct 2007 00:13:49 +0100"  >&lt;p&gt;I am attempting to write a test to test this issue but find that the network server started in the junit test is acting like it has not been started under security manager.  This test should fail because&lt;br/&gt;
1) It doesn&apos;t have the fix for derby-3110 &lt;br/&gt;
2) the derby_tests.policy file does not have write permission to derby.system.home&lt;/p&gt;

&lt;p&gt;But I find that the trace files are created and no error occurs. Any thoughts on why network server wouldn&apos;t be starting with security manager? I used&lt;br/&gt;
 return TestConfiguration.clientServerSuite(NetworkServerControlApiTest.class);&lt;/p&gt;

&lt;p&gt;to start network server.&lt;/p&gt;


</comment>
                            <comment id="12540221" author="kmarsden" created="Mon, 5 Nov 2007 17:22:24 +0000"  >&lt;p&gt;Here is a revised patch for this issue. The code patch remains the same. The test loads its own policy file to allow for tracing. The new test NetworkServerControlApiTest only tests tracing now but can be expanded to cover the other API calls.&lt;/p&gt;

</comment>
                            <comment id="13628156" author="rhillegas" created="Wed, 10 Apr 2013 20:37:05 +0100"  >&lt;p&gt;After syncing with the head of trunk, I see the following warning when I build Derby:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; /Users/rh161140/derby/mainline/trunk/java/testing/org/apache/derbyTesting/functionTests/tests/derbynet/NetworkServerControlApiTest.java:224: warning: &lt;span class=&quot;error&quot;&gt;&amp;#91;deprecation&amp;#93;&lt;/span&gt; toURL() in File has been deprecated&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;             String  urlString = file.toURL().toExternalForm();&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt;                                     ^&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; 1 warning&lt;/p&gt;

&lt;p&gt;The offending line appears to have been added by revision 592111, which is associated with &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3110&quot; title=&quot;server hangs after trace on command fails&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3110&quot;&gt;&lt;del&gt;DERBY-3110&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13628311" author="knutanders" created="Wed, 10 Apr 2013 22:51:28 +0100"  >&lt;p&gt;I think the warning got exposed by the recent changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6162&quot; title=&quot;Simplify privileged actions in NetworkServerControlApiTest&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6162&quot;&gt;&lt;del&gt;DERBY-6162&lt;/del&gt;&lt;/a&gt;. I see the warning if I build without an ant.properties file, but I don&apos;t see it if I build with j15lib pointing to a proper Java 5 runtime.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12397290">DERBY-3701</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12379056">DERBY-3086</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12368502" name="derby-3110_diff.txt" size="7918" author="kmarsden" created="Fri, 26 Oct 2007 18:59:55 +0100"/>
                            <attachment id="12368984" name="derby-3110_diff2.txt" size="27888" author="kmarsden" created="Mon, 5 Nov 2007 17:22:24 +0000"/>
                            <attachment id="12368503" name="derby-3110_stat.txt" size="259" author="kmarsden" created="Fri, 26 Oct 2007 18:59:55 +0100"/>
                            <attachment id="12368985" name="derby-3110_stat2.txt" size="561" author="kmarsden" created="Mon, 5 Nov 2007 17:22:24 +0000"/>
                            <attachment id="12368529" name="derby-3110_test_diff.txt" size="4282" author="kmarsden" created="Sat, 27 Oct 2007 00:13:49 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Oct 2007 21:06:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23441</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0yuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39463</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>