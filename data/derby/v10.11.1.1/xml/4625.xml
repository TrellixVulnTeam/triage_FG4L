<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:10:46 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-4625/DERBY-4625.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-4625] TIMESTAMP function doesn&apos;t accept nanoseconds</title>
                <link>https://issues.apache.org/jira/browse/DERBY-4625</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;The TIMESTAMP function fails if the string argument specifies the number of nanoseconds. It works if the argument is limited to microsecond resolution.&lt;/p&gt;

&lt;p&gt;ij&amp;gt; values timestamp(&apos;2010-04-21 12:00:00.123456&apos;);&lt;br/&gt;
1                         &lt;br/&gt;
--------------------------&lt;br/&gt;
2010-04-21 12:00:00.123456&lt;/p&gt;

&lt;p&gt;1 row selected&lt;br/&gt;
ij&amp;gt; values timestamp(&apos;2010-04-21 12:00:00.123456789&apos;);&lt;br/&gt;
ERROR 22008: &apos;2010-04-21 12:00:00.123456789&apos; is an invalid argument to the timestamp function.&lt;/p&gt;

&lt;p&gt;Since Derby (and JDBC) supports nanosecond resolution, the TIMESTAMP function should also support it.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12462637">DERBY-4625</key>
            <summary>TIMESTAMP function doesn&apos;t accept nanoseconds</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nirmal">Nirmal Fernando</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Apr 2010 11:57:49 +0100</created>
                <updated>Thu, 30 Jun 2011 10:21:39 +0100</updated>
                            <resolved>Wed, 16 Feb 2011 00:05:23 +0000</resolved>
                                    <version>10.5.3.0</version>
                                    <fixVersion>10.5.3.2</fixVersion>
                    <fixVersion>10.6.2.4</fixVersion>
                    <fixVersion>10.7.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12860562" author="asthiwanka" created="Sat, 24 Apr 2010 19:29:57 +0100"  >&lt;p&gt;Hi Knut,&lt;br/&gt;
                 What are the classes that are used to call the timestamp functions?I referred mechanisms in UnaryDateTimestampOperatorNode.java class to some extent.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12860824" author="knutanders" created="Mon, 26 Apr 2010 07:02:34 +0100"  >&lt;p&gt;Hi Thiwanka,&lt;/p&gt;

&lt;p&gt;At compile time, calls to the TIMESTAMP function are represented by the TimestampOperatorNode class. At run time, the parsing of the timestamp string is performed by SQLTimestamp.parseTimestamp().&lt;/p&gt;</comment>
                            <comment id="12904213" author="nirmal" created="Mon, 30 Aug 2010 15:49:09 +0100"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I&apos;m attaching a patch which solves this issue. &lt;br/&gt;
This will probably break some tests since some properties have changed.&lt;br/&gt;
I&apos;m running tests now, and will attach a patch which will address updates&lt;br/&gt;
to those tests soon.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12904225" author="knutanders" created="Mon, 30 Aug 2010 16:25:43 +0100"  >&lt;p&gt;Thanks, Nirmal.&lt;/p&gt;

&lt;p&gt;Perhaps the change in DataTypeUtilities is better to leave out for now to make the impact on the tests smaller. If I understand correctly, it doesn&apos;t seem to be strictly necessary for getting the TIMESTAMP function to accept nanoseconds, it helps IJ display the entire value. Maybe that change could be made as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4614&quot; title=&quot;JDBC metadata gives incorrect lengths for timestamps&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4614&quot;&gt;&lt;del&gt;DERBY-4614&lt;/del&gt;&lt;/a&gt; instead?&lt;/p&gt;

&lt;p&gt;The patch seems to make an unintended change to the license header in SQLTimestamp.java.&lt;/p&gt;

&lt;p&gt;The constant SQLTimestamp.FRACTION_TO_NANO is used in SQLChar.setValue(Timestamp,Calendar). I think changing it from 1000 to 1 may make the calculations in SQLChar become wrong. (If we fix &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4626&quot; title=&quot;Timestamp truncated when converted to string with explicit calendar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4626&quot;&gt;&lt;del&gt;DERBY-4626&lt;/del&gt;&lt;/a&gt; that code will probably go away, though.)&lt;/p&gt;

&lt;p&gt;It would also be good to have a test case (for example in DateTimeTest) that verifies that the function now accepts nanosecond resolution.&lt;/p&gt;</comment>
                            <comment id="12905167" author="nirmal" created="Wed, 1 Sep 2010 20:14:33 +0100"  >&lt;p&gt;Hi Knut,&lt;/p&gt;

&lt;p&gt;Thanks for reviewing the patch.&lt;/p&gt;

&lt;p&gt;&amp;gt;The constant SQLTimestamp.FRACTION_TO_NANO is used in SQLChar.setValue(Timestamp,Calendar). I think changing it from 1000 to 1 may make the calculations in &amp;gt;SQLChar become wrong. (If we fix &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4626&quot; title=&quot;Timestamp truncated when converted to string with explicit calendar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4626&quot;&gt;&lt;del&gt;DERBY-4626&lt;/del&gt;&lt;/a&gt; that code will probably go away, though.) &lt;/p&gt;

&lt;p&gt;Without changing 1000 to 1 we can&apos;t get the expected result. I am wondering whether there are test cases which is addressed this setValue(..) function. If so since I did not find any regression failures regarding that, can&apos;t we conclude that the calculations of SQLChar are still correct?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12905365" author="nirmal" created="Thu, 2 Sep 2010 02:10:34 +0100"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I have attached a patch to &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4614&quot; title=&quot;JDBC metadata gives incorrect lengths for timestamps&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4614&quot;&gt;&lt;del&gt;DERBY-4614&lt;/del&gt;&lt;/a&gt; which is intended to address this issue as well.&lt;br/&gt;
Since both issues are co-related to some extent, it&apos;s difficult to provide a separate patch.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12905434" author="knutanders" created="Thu, 2 Sep 2010 08:13:28 +0100"  >&lt;p&gt;&amp;gt; I am wondering whether there are test cases which is addressed this&lt;br/&gt;
&amp;gt; setValue(..) function. If so since I did not find any regression&lt;br/&gt;
&amp;gt; failures regarding that, can&apos;t we conclude that the calculations of&lt;br/&gt;
&amp;gt; SQLChar are still correct?&lt;/p&gt;

&lt;p&gt;It seems that the calculation in SQLChar changed, but in a way that&lt;br/&gt;
fixed &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4626&quot; title=&quot;Timestamp truncated when converted to string with explicit calendar&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4626&quot;&gt;&lt;del&gt;DERBY-4626&lt;/del&gt;&lt;/a&gt;. So that&apos;s actually a good thing! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;However, the change also makes the code in SQLChar a bit&lt;br/&gt;
confusing. Take for instance this fragment:&lt;/p&gt;

&lt;p&gt;    int micros = &lt;br/&gt;
        (theValue.getNanos() + SQLTimestamp.FRACTION_TO_NANO/2) / &lt;br/&gt;
            SQLTimestamp.FRACTION_TO_NANO;&lt;/p&gt;

&lt;p&gt;After the patch, the micros variable will actually hold the nanosecond&lt;br/&gt;
value, so we should change its name to nanos. Also, since the above&lt;br/&gt;
code now transforms nanoseconds to nanoseconds (that is, it doesn&apos;t do&lt;br/&gt;
anything), we should probably simplify it to:&lt;/p&gt;

&lt;p&gt;    int nanos = theValue.getNanos();&lt;/p&gt;</comment>
                            <comment id="12910549" author="nirmal" created="Fri, 17 Sep 2010 13:11:07 +0100"  >&lt;p&gt;Patch #2 is addressing Knut&apos;s latest comment!&lt;br/&gt;
Hope this issue is solved now!&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12913005" author="knutanders" created="Tue, 21 Sep 2010 15:25:18 +0100"  >&lt;p&gt;Thanks, Nirmal!&lt;/p&gt;

&lt;p&gt;The patch looks good to me. The new test case in DateTimeTest was commented out. I&apos;ve commented it back in and started the regression tests suites. I&apos;ll commit the fix if the tests pass.&lt;/p&gt;</comment>
                            <comment id="12913054" author="knutanders" created="Tue, 21 Sep 2010 17:07:47 +0100"  >&lt;p&gt;All the regression tests ran cleanly.&lt;br/&gt;
Committed revision 999479.&lt;/p&gt;</comment>
                            <comment id="12989040" author="nirmal" created="Tue, 1 Feb 2011 05:16:49 +0000"  >&lt;p&gt;Resolving this issue!&lt;/p&gt;</comment>
                            <comment id="12989891" author="kmarsden" created="Wed, 2 Feb 2011 23:43:08 +0000"  >&lt;p&gt;Reopen for backport&lt;/p&gt;</comment>
                            <comment id="12992181" author="mikem" created="Tue, 8 Feb 2011 20:59:28 +0000"  >&lt;p&gt;temp taking ownership to backport to 10.6 and 10.5.&lt;/p&gt;</comment>
                            <comment id="12995070" author="mikem" created="Wed, 16 Feb 2011 00:05:23 +0000"  >&lt;p&gt;backported fix to 10.5 and 10.6.  resolving and resetting original owner.&lt;/p&gt;</comment>
                            <comment id="12995075" author="mikem" created="Wed, 16 Feb 2011 00:13:08 +0000"  >&lt;p&gt;fixing released version for the backports.  mistakenly picked released versions rather than unreleased versions.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12462639">DERBY-4626</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12368487">DERBY-2602</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12461979">DERBY-4614</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12497378">DERBY-4994</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12453427" name="derby-4625-1.diff" size="1605" author="nirmal" created="Mon, 30 Aug 2010 15:49:09 +0100"/>
                            <attachment id="12454845" name="derby_4625-2.diff" size="3768" author="nirmal" created="Fri, 17 Sep 2010 12:58:27 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 24 Apr 2010 18:29:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24376</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0fyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>36404</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>