<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:25:13 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3004/DERBY-3004.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3004] Get rid of the finalizer in EmbedResultSet</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3004</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;Finalizers make object allocation and garbage collection more expensive and should be avoided for object types that are frequently allocated. EmbedResultSet has a finalize() method and is frequently allocated for many types of load. The following comment was posted on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1876&quot; title=&quot;Investigate overhead of JDBC layer and compiled activation code for simple embedded read-only, forward ResultSets&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1876&quot;&gt;&lt;del&gt;DERBY-1876&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;By commenting out the finalize() method in EmbedResultSet, the time to run the test on my laptop is reduced from ~3 seconds to ~1.3 seconds (OpenSolaris, Sun Java SE 6). Since the finalizer is a no-op if the activation isn&apos;t single-use, I think we should investigate whether there are ways to avoid this cost for ResultSets that don&apos;t need the finalizer.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12375948">DERBY-3004</key>
            <summary>Get rid of the finalizer in EmbedResultSet</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="knutanders">Knut Anders Hatlen</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Aug 2007 08:45:29 +0100</created>
                <updated>Mon, 29 Jun 2009 15:05:15 +0100</updated>
                            <resolved>Fri, 17 Aug 2007 10:33:19 +0100</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12519614" author="knutanders" created="Tue, 14 Aug 2007 08:51:50 +0100"  >&lt;p&gt;Daniel John Debrunner commented (on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1876&quot; title=&quot;Investigate overhead of JDBC layer and compiled activation code for simple embedded read-only, forward ResultSets&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1876&quot;&gt;&lt;del&gt;DERBY-1876&lt;/del&gt;&lt;/a&gt;):&lt;/p&gt;

&lt;p&gt;&amp;gt; I wonder if it&apos;s possible to move the finalizer logic to&lt;br/&gt;
&amp;gt; EmbedStatement. Since a ResultSet will always be referenced by its&lt;br/&gt;
&amp;gt; Statement then we only need to close the ResultSet when it&apos;s&lt;br/&gt;
&amp;gt; statement is finalized. Then EmbedResultSet would not need a&lt;br/&gt;
&amp;gt; finalizer method.&lt;/p&gt;

&lt;p&gt;I think this is correct. I&apos;ll take a look at it and see if I can fix&lt;br/&gt;
it. EmbedPreparedStatement already has a finalize method which&lt;br/&gt;
probably can be pushed into EmbedStatement.&lt;/p&gt;</comment>
                            <comment id="12520153" author="knutanders" created="Thu, 16 Aug 2007 07:58:24 +0100"  >&lt;p&gt;Pushing EmbedPreparedStatement&apos;s finalizer into EmbedStatement wasn&apos;t such a good idea after all, since EmbedPreparedStatements may contain both reusable activations and single-use activations at the same time (the single-use activations come from calls to getGeneratedKeys()). So it sounds cleaner to let EmbedStatement.finalize() take care of closing the single-use activation and EmbedPreparedStatement the reusable activations.&lt;/p&gt;</comment>
                            <comment id="12520155" author="knutanders" created="Thu, 16 Aug 2007 08:08:07 +0100"  >&lt;p&gt;Attaching a fix for this issue. The patch removes EmbedResultSet.finalize() and adds EmbedStatement.finalize(). The new finalizer checks whether EmbedStatement contains a reference to a ResultSet, and if it does and the ResultSet has a single-use activation, the activation is marked as unused. If the ResultSet is no longer referenced by the EmbedStatement, it means that it has been closed already and no clean-up action is needed.&lt;/p&gt;

&lt;p&gt;Derbyall and suites.All ran cleanly (except a failure in lang/compressTable.sql which is also seen in the tinderbox).&lt;/p&gt;</comment>
                            <comment id="12520505" author="knutanders" created="Fri, 17 Aug 2007 10:33:19 +0100"  >&lt;p&gt;Committed revision 566981.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12350467">DERBY-1876</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12363908" name="d3004.diff" size="3197" author="knutanders" created="Thu, 16 Aug 2007 08:08:03 +0100"/>
                            <attachment id="12363909" name="d3004.stat" size="132" author="knutanders" created="Thu, 16 Aug 2007 08:08:06 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10362"><![CDATA[Performance]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30688</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0wq7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39120</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>