<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:26:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-6597/DERBY-6597.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-6597] LUCENESUPPORT.LISTINDEXES() fails with FileNotFoundException</title>
                <link>https://issues.apache.org/jira/browse/DERBY-6597</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;DROP TABLE seems to cascade and drop any Lucene indexes defined on the table. However, there seems to be some traces of meta-data left, so that LUCENESUPPORT.LISTINDEXES thinks the index is still there, and fails with FileNotFoundException when trying to access the index:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ij version 10.11
ij&amp;gt; connect &apos;jdbc:derby:memory:db;create=true&apos;;
ij&amp;gt; create table t(x int primary key, c clob);
0 rows inserted/updated/deleted
ij&amp;gt; call syscs_util.syscs_register_tool(&apos;luceneSupport&apos;, true);
0 rows inserted/updated/deleted
ij&amp;gt; call lucenesupport.createindex(&apos;app&apos;, &apos;t&apos;, &apos;c&apos;, null);
0 rows inserted/updated/deleted
ij&amp;gt; drop table t;
0 rows inserted/updated/deleted
ij&amp;gt; select * from table ( lucenesupport.listindexes() ) li;
SCHEMANAME                                                                                                                      |TABLENAME                                                                                                                       |COLUMNNAME                                                                                                                      |LASTUPDATED                  |LUCENEVERSION       |ANALYZER                                                                                                                        |ANALYZERMAKER                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ERROR XJ001: Java exception: &apos;java.io.FileNotFoundException: /tmp/db/LUCENE/APP/T/C/derby-lucene.properties&apos;.
ERROR XJ001: Java exception: &apos;/tmp/db/LUCENE/APP/T/C/derby-lucene.properties: java.io.FileNotFoundException&apos;.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12718165">DERBY-6597</key>
            <summary>LUCENESUPPORT.LISTINDEXES() fails with FileNotFoundException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="knutanders">Knut Anders Hatlen</reporter>
                        <labels>
                            <label>derby_backport_reject_10_10</label>
                    </labels>
                <created>Tue, 3 Jun 2014 16:03:38 +0100</created>
                <updated>Thu, 25 Sep 2014 00:17:30 +0100</updated>
                            <resolved>Mon, 9 Jun 2014 15:23:40 +0100</resolved>
                                    <version>10.11.1.1</version>
                                    <fixVersion>10.11.1.1</fixVersion>
                                    <component>SQL</component>
                    <component>Tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="14016594" author="knutanders" created="Tue, 3 Jun 2014 16:08:47 +0100"  >&lt;p&gt;Doesn&apos;t look like the DROP TABLE operation has anything to do with this problem. It fails the same way even without it:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ij version 10.11
ij&amp;gt; connect &apos;jdbc:derby:memory:db;create=true&apos;;
ij&amp;gt; create table t(x int primary key, c clob);
0 rows inserted/updated/deleted
ij&amp;gt; call syscs_util.syscs_register_tool(&apos;luceneSupport&apos;, true);
0 rows inserted/updated/deleted
ij&amp;gt; call lucenesupport.createindex(&apos;app&apos;, &apos;t&apos;, &apos;c&apos;, null);
0 rows inserted/updated/deleted
ij&amp;gt; select * from table ( lucenesupport.listindexes() ) li;
SCHEMANAME                                                                                                                      |TABLENAME                                                                                                                       |COLUMNNAME                                                                                                                      |LASTUPDATED                  |LUCENEVERSION       |ANALYZER                                                                                                                        |ANALYZERMAKER                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ERROR XJ001: Java exception: &apos;java.io.FileNotFoundException: /tmp/khatlen/ij-dev/db/LUCENE/APP/T/C/derby-lucene.properties&apos;.
ERROR XJ001: Java exception: &apos;/tmp/khatlen/ij-dev/db/LUCENE/APP/T/C/derby-lucene.properties: java.io.FileNotFoundException&apos;.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maybe the problem is that the table was empty when CREATEINDEX was called on it?&lt;/p&gt;</comment>
                            <comment id="14025214" author="rhillegas" created="Mon, 9 Jun 2014 15:21:38 +0100"  >&lt;p&gt;Attaching derby-6597-01-aa-writePropertiesOutsideIndexingLoop.diff. This patch fixes the problem. The Lucene tests run cleanly with this patch.&lt;/p&gt;

&lt;p&gt;This turns out to be the same issue described by &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6603&quot; title=&quot;Make LuceneSupport.createOrRecreateIndex() write the index properties file once per indexing run&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6603&quot;&gt;&lt;del&gt;DERBY-6603&lt;/del&gt;&lt;/a&gt;. The index properties were being written for each indexed row in the table/view. If there were no rows, then the index properties weren&apos;t written at all.&lt;/p&gt;

&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;p&gt;M       java/optional/org/apache/derby/optional/lucene/LuceneSupport.java&lt;/p&gt;</comment>
                            <comment id="14025215" author="jira-bot" created="Mon, 9 Jun 2014 15:23:10 +0100"  >&lt;p&gt;Commit 1601391 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhillegas&quot; class=&quot;user-hover&quot; rel=&quot;rhillegas&quot;&gt;Rick Hillegas&lt;/a&gt; in branch &apos;code/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1601391&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/r1601391&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-6597&quot; title=&quot;LUCENESUPPORT.LISTINDEXES() fails with FileNotFoundException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-6597&quot;&gt;&lt;del&gt;DERBY-6597&lt;/del&gt;&lt;/a&gt;: Write the properties for a Lucene index only once and not for each indexed row; commit derby-6597-01-aa-writePropertiesOutsideIndexingLoop.diff.&lt;/p&gt;</comment>
                            <comment id="14026235" author="knutanders" created="Tue, 10 Jun 2014 09:11:04 +0100"  >&lt;p&gt;Thanks, Rick. The patch seems to have fixed the problem. Closing the issue.&lt;/p&gt;</comment>
                            <comment id="14147069" author="mikem" created="Thu, 25 Sep 2014 00:17:30 +0100"  >&lt;p&gt;lucene support added in 10.11 so adding backport reject for 10.10 and before&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12317415">DERBY-590</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12649380" name="derby-6597-01-aa-writePropertiesOutsideIndexingLoop.diff" size="1004" author="rhillegas" created="Mon, 9 Jun 2014 15:21:38 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 9 Jun 2014 14:21:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396367</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hzq3hr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>396489</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>