<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:47:40 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-2157/DERBY-2157.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-2157] SqlExceptionTest.testChainedException and .testNextException fail with wctme5.7 foundation</title>
                <link>https://issues.apache.org/jira/browse/DERBY-2157</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;We get the following failure in suites.All:&lt;/p&gt;

&lt;p&gt;1) testChainedException(org.apache.derbyTesting.functionTests.tests.derbynet.SqlExceptionTest)java.lang.NoSuchMethodError: java/sql/SQLException.getCause()Ljava/lang/Throwable;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SqlExceptionTest.testChainedException(SqlExceptionTest.java:58)&lt;br/&gt;
	at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:199)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:76)&lt;br/&gt;
2) testNextException(org.apache.derbyTesting.functionTests.tests.derbynet.SqlExceptionTest)java.lang.NoSuchMethodError: java/sql/SQLException.getCause()Ljava/lang/Throwable;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SqlExceptionTest.testNextException(SqlExceptionTest.java:74)&lt;br/&gt;
	at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:199)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:76)&lt;/p&gt;
</description>
                <environment>IBM jvm wctme5.7 foundation class libraries</environment>
        <key id="12357934">DERBY-2157</key>
            <summary>SqlExceptionTest.testChainedException and .testNextException fail with wctme5.7 foundation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="myrna">Myrna van Lunteren</assignee>
                                    <reporter username="myrna">Myrna van Lunteren</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Dec 2006 20:00:24 +0000</created>
                <updated>Wed, 1 Jul 2009 01:09:09 +0100</updated>
                            <resolved>Tue, 16 Jan 2007 06:11:10 +0000</resolved>
                                    <version>10.3.1.4</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12456187" author="myrna" created="Wed, 6 Dec 2006 20:04:03 +0000"  >&lt;p&gt;Not sure if this is a regression, so not checking that box...&lt;/p&gt;</comment>
                            <comment id="12463994" author="myrna" created="Thu, 11 Jan 2007 19:29:00 +0000"  >&lt;p&gt;for reference, the result with weme6.1 (j9 2.3/j2ME 1.1) is as follows:&lt;/p&gt;

&lt;p&gt;------------------&lt;br/&gt;
There were 2 failures:&lt;br/&gt;
1) testChainedException(org.apache.derbyTesting.functionTests.tests.derbynet.SqlExceptionTest)junit.framework.AssertionFailedError: expected:&amp;lt;org.apache.derby.client.am.SqlException: getConnection() is not valid on a closed PooledConnection. Caused by exception class java.io.IOException: Test exception Caused by exception class java.io.IOException: Test exception&amp;gt; but was:&amp;lt;null&amp;gt;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SqlExceptionTest.testChainedException(SqlExceptionTest.java:58)&lt;br/&gt;
	at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:203)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:76)&lt;br/&gt;
2) testNextException(org.apache.derbyTesting.functionTests.tests.derbynet.SqlExceptionTest)junit.framework.AssertionFailedError: expected:&amp;lt;org.apache.derby.client.am.SqlException: getConnection() is not valid on a closed PooledConnection.&amp;gt; but was:&amp;lt;null&amp;gt;&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.derbynet.SqlExceptionTest.testNextException(SqlExceptionTest.java:74)&lt;br/&gt;
	at java.lang.reflect.AccessibleObject.invokeV(AccessibleObject.java:203)&lt;br/&gt;
	at org.apache.derbyTesting.junit.BaseTestCase.runBare(BaseTestCase.java:76)&lt;br/&gt;
----------------------------------&lt;/p&gt;</comment>
                            <comment id="12463997" author="djd" created="Thu, 11 Jan 2007 19:38:43 +0000"  >&lt;p&gt;derbynet.SqlExceptionTest() is a test for the client driver which is not supported with J2ME/CDC/Foundation JSR 169.&lt;/p&gt;

&lt;p&gt;I see clean runs with suites.All and WCTME 5.7 but I don&apos;t include derbyclient.jar or derbynet.jar in the classpath, thus the SqlExceptionTest will be skipped.&lt;/p&gt;</comment>
                            <comment id="12464043" author="myrna" created="Thu, 11 Jan 2007 22:44:24 +0000"  >&lt;p&gt;If I understand the code correctly, the TestConfiguration.java has code to ignore any tests that actually requires the networkserver to kick in:&lt;br/&gt;
-------------------&lt;br/&gt;
    public static Test clientServerDecorator(Test suite)&lt;/p&gt;
    {
        // Need to have network server and client and not
        // running in J2ME (JSR169).
        if (!(Derby.hasClient() &amp;amp;&amp;amp; Derby.hasServer())
                || JDBC.vmSupportsJSR169())
            return new TestSuite(&quot;empty: no network server support&quot;);
                   
        Test test = new NetworkServerTestSetup(suite, false);
            
        return new ServerSetup(test, DEFAULT_HOSTNAME, DEFAULT_PORT);
    }
&lt;p&gt;--------------------&lt;br/&gt;
So, unless I misinterpret things, if one &lt;b&gt;does&lt;/b&gt; have derbynet.jar &amp;amp; derbyclient.jar, only the &apos;embedded&apos; tests get run in sqlException...&lt;/p&gt;
</comment>
                            <comment id="12464044" author="myrna" created="Thu, 11 Jan 2007 22:50:13 +0000"  >&lt;p&gt;However, this particular test still may not be applicable, because I see a reference to PooledConnection in the stack for weme6.1 which is not in JSR169.&lt;/p&gt;

&lt;p&gt;Need to verify that that&apos;s the problem wctme5.7 also.&lt;/p&gt;</comment>
                            <comment id="12464050" author="djd" created="Thu, 11 Jan 2007 23:38:12 +0000"  >&lt;p&gt;SQLExceptionTest doesn&apos;t use the clientServerDecorator, so that logic is not going to kick in.&lt;br/&gt;
It&apos;s a direct test of the client SqlException, it&apos;s not suitable for J2ME.&lt;/p&gt;</comment>
                            <comment id="12464051" author="myrna" created="Thu, 11 Jan 2007 23:40:00 +0000"  >&lt;p&gt;So, the wctme5.7 fails because it&apos;s implementing the j2ME spec 1.0, based on jdk 1.3.1, which does not have Throwable.getCause(). (Hence the NoSuchMethodError).&lt;/p&gt;</comment>
                            <comment id="12465003" author="myrna" created="Mon, 15 Jan 2007 22:46:41 +0000"  >&lt;p&gt;I attached a patch that&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;modifies JDBC.java to add a check for existence of the method ResultSet.getBigDecimal for vmSupportsJSR169()&lt;/li&gt;
	&lt;li&gt;calls the vmSupportsJSR169() method in the test org.apache.derbyTesting.functionTests.tests.derbynet.sqlExceptionTest.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Is this an OK approach?&lt;/p&gt;</comment>
                            <comment id="12465006" author="djd" created="Mon, 15 Jan 2007 23:26:18 +0000"  >&lt;p&gt;Not sure what this is trying to do, the SqlException test  is not meant to run on JSR169 so why/how is it being run?&lt;/p&gt;

&lt;p&gt;I run suites.All with WCTME 5,7 and this test correctly does not run for me, but then I don&apos;t include derbyclient.jar in my classpath since that jar is not supported on JSR 169.&lt;/p&gt;</comment>
                            <comment id="12465014" author="djd" created="Tue, 16 Jan 2007 00:18:05 +0000"  >&lt;p&gt;I was forgetting that a wctme (jsr169) run should also be successful against the classes folder when running suites.All so maybe there are some changes needed to disable the test. I&apos;ll run suites.All to see if I get these failures.&lt;/p&gt;

&lt;p&gt;I don&apos;t think the vmSupportsJSR169() method needs to change, it makes the correct checks for if JSR169 is supported.&lt;/p&gt;</comment>
                            <comment id="12465029" author="myrna" created="Tue, 16 Jan 2007 01:19:08 +0000"  >&lt;p&gt;You&apos;re right, I thought I had to change JDBC.java because of, well -  faulty reasoning - at an earlier stage and did not backtrack all my changes.&lt;/p&gt;

&lt;p&gt;Attaching a new patch, that only changes SqlExceptTest.java.&lt;br/&gt;
If you see this failure with classes too, and the change to SqlExceptionTest is reasonable, I will commit this fix.&lt;/p&gt;</comment>
                            <comment id="12465030" author="djd" created="Tue, 16 Jan 2007 01:27:44 +0000"  >&lt;p&gt;Can the empty suite include &lt;b&gt;why&lt;/b&gt; the test is not valid for JSR169, it&apos;s very painful later trying to reason why tests are not run in certain environments if the reason is not there. E.g. I think something like this would be better:&lt;/p&gt;

&lt;p&gt;empty: client not supported on JSR169&lt;/p&gt;</comment>
                            <comment id="12465066" author="myrna" created="Tue, 16 Jan 2007 06:10:18 +0000"  >&lt;p&gt;Committed 496602: &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=496602&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=496602&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12348986" name="DERBY-2157_20070115.diff" size="2633" author="myrna" created="Mon, 15 Jan 2007 22:42:54 +0000"/>
                            <attachment id="12348989" name="DERBY-2157_20070115_b.diff" size="1046" author="myrna" created="Tue, 16 Jan 2007 01:14:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 11 Jan 2007 19:38:43 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22915</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0tk7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38607</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>