<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:17:59 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-810/DERBY-810.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-810] intermittent diff for store/RecoveryAfterBackup.java test</title>
                <link>https://issues.apache.org/jira/browse/DERBY-810</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;I saw this diff for test running at 2006-01-11 00:45:23  PST. The test seemed to run fine the next night.It would appear that this is some sort of intermittent test output problem.   The test was just checked in on 2006-01-09.&lt;/p&gt;


&lt;p&gt;store/RecoveryAfterBackup.java.  on jdk15&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;Start: RecoveryAfterBackup jdk1.5.0_02 storeall:storerecovery 2006-01-11 00:45:23 ***&lt;br/&gt;
4 del&lt;br/&gt;
&amp;lt; SQL Exception: Derby system shutdown.&lt;br/&gt;
5 del&lt;br/&gt;
&amp;lt; Starting restore with roll-forward recovery..&lt;br/&gt;
5a4&lt;br/&gt;
&amp;gt; SQL Exception: Derby system shutdown.Starting restore with roll-forward recovery..&lt;br/&gt;
Test Failed.&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>Sun jdk 1.5</environment>
        <key id="12327581">DERBY-810</key>
            <summary>intermittent diff for store/RecoveryAfterBackup.java test</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="oysteing">&#216;ystein Gr&#248;vlen</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Jan 2006 05:44:49 +0000</created>
                <updated>Wed, 1 Jul 2009 01:13:00 +0100</updated>
                            <resolved>Thu, 19 Jan 2006 02:33:33 +0000</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.2.1.6</fixVersion>
                                    <component>Store</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12362682" author="tsuresh" created="Sat, 14 Jan 2006 04:45:22 +0000"  >&lt;p&gt;Difference in the output seems to be a new line.  My guess is System.out   and System.err  (output of the printStackTrace() )  output to the file are getting  intermingled. &lt;br/&gt;
Related code in RecoveryAfterBackup.java:&lt;/p&gt;

&lt;p&gt;            // Shut down database&lt;br/&gt;
            Properties shutdownAttrs = new Properties();&lt;br/&gt;
            shutdownAttrs.setProperty(&quot;shutdownDatabase&quot;, &quot;shutdown&quot;);&lt;br/&gt;
            System.out.println(&quot;Shutting down database ...&quot;);&lt;br/&gt;
            try &lt;/p&gt;
{
                DataSource ds = TestUtil.getDataSource(shutdownAttrs);
                ds.getConnection();
            }
&lt;p&gt; catch (Throwable ith) &lt;/p&gt;
{
                ith.printStackTrace();
            }

&lt;p&gt;            // Start up with rollforward-recovery&lt;br/&gt;
            System.out.println(&quot;Starting restore with roll-forward recovery..&quot;);&lt;/p&gt;

&lt;p&gt;Oyestin:  I did not notice this when I reviewed the patch for Derby-298.  Any particular reason for printing stack trace on shutdown ? Normally I check for the shutdown SQLState  and not print the stack trace if the shutdown is successful.  I think to avoid timing issues with tests  ,  it is better to print the stack traces to System.out . &lt;/p&gt;


&lt;p&gt;output in the temp file:&lt;br/&gt;
Count: 2 Sum: 1&lt;br/&gt;
Inserting records ...&lt;br/&gt;
Shutting down database ...&lt;br/&gt;
SQL Exception: Derby system shutdown.Starting restore with roll-forward recovery..&lt;/p&gt;

&lt;p&gt;	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:80)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Util.java:97)&lt;br/&gt;
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:161)&lt;br/&gt;
	at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:182)&lt;br/&gt;
	at org.apache.derby.jdbc.EmbeddedDataSource.getConnection(EmbeddedDataSource.java:478)&lt;br/&gt;
	at org.apache.derby.jdbc.EmbeddedDataSource.getConnection(EmbeddedDataSource.java:422)&lt;br/&gt;
	at org.apache.derbyTesting.functionTests.tests.store.RecoveryAfterBackup.main(RecoveryAfterBackup.java:85)&lt;br/&gt;
Verifying database ...&lt;br/&gt;
Count: 256 Sum: 32640&lt;/p&gt;
</comment>
                            <comment id="12362855" author="oysteing" created="Tue, 17 Jan 2006 01:05:40 +0000"  >&lt;p&gt;Thanks, Suresh for the analysis.  I think you are right that the reason for the failure is that output to stdout and stderr gets mixed.  I agree that it is better to check for the shutdown SQLState instead of relying on the output of printStackTrace.  I will create a patch to change this.&lt;/p&gt;</comment>
                            <comment id="12362995" author="oysteing" created="Wed, 18 Jan 2006 02:18:13 +0000"  >&lt;p&gt;The attach patch should solve this problem.  I no longer print the stack trace if the normal shutdown exception is received.&lt;/p&gt;</comment>
                            <comment id="12363024" author="davidvc" created="Wed, 18 Jan 2006 05:32:11 +0000"  >&lt;p&gt;I applied this patch and it built fine, but when I try to run storemats I get this error.  I tried running it as a separate test and got the same error.  Is there something I&apos;m missing?  And who thought of this name for a database - ick! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Framework: embedded&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;Start: RecoveryAfterBackup jdk1.4.2_07 2006-01-17 10:29:22 ***&lt;br/&gt;
1 del&lt;br/&gt;
&amp;lt; Count: 2 Sum: 1&lt;br/&gt;
2 del&lt;br/&gt;
&amp;lt; Inserting records ...&lt;br/&gt;
3 del&lt;br/&gt;
&amp;lt; Shutting down database ...&lt;br/&gt;
4 del&lt;br/&gt;
&amp;lt; Database shutdown completed&lt;br/&gt;
5 del&lt;br/&gt;
&amp;lt; Starting restore with roll-forward recovery..&lt;br/&gt;
6 del&lt;br/&gt;
&amp;lt; Verifying database ...&lt;br/&gt;
7 del&lt;br/&gt;
&amp;lt; Count: 256 Sum: 32640&lt;br/&gt;
7 add&lt;br/&gt;
&amp;gt; ERROR XJ004: Database &apos;hairynosedwombat&apos; not found.&lt;br/&gt;
&amp;gt; SQL Exception: Database &apos;hairynosedwombat&apos; not found.&lt;br/&gt;
Test Failed.&lt;/li&gt;
			&lt;li&gt;End:   RecoveryAfterBackup jdk1.4.2_07 2006-01-17 10:29:23 ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="12363025" author="davidvc" created="Wed, 18 Jan 2006 05:34:28 +0000"  >&lt;p&gt;I&apos;d also like to suggest that in the code you use a SQLState constant rather than a hardcoded string, it would make it a little more reliable in case SQL States are modified in the future... (doubtful, but possible, I just saw a change that did that).&lt;/p&gt;</comment>
                            <comment id="12363029" author="djd" created="Wed, 18 Jan 2006 06:16:18 +0000"  >&lt;p&gt;The SQLState constants are not part of the public api, tests should not be using them. In fact it&apos;s better if the test does have its own version of the constant as then a incorrect change in the code would be caugth be the test. Changing the SQL state for shutdown is a change in api. and could break existing applications.&lt;/p&gt;</comment>
                            <comment id="12363030" author="davidvc" created="Wed, 18 Jan 2006 06:30:51 +0000"  >&lt;p&gt;Yes, what you say makes sense, thanks, Dan.&lt;/p&gt;</comment>
                            <comment id="12363122" author="davidvc" created="Thu, 19 Jan 2006 02:33:33 +0000"  >&lt;p&gt;Committed revision 370195&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12322028" name="derby-810.diff" size="1570" author="oysteing" created="Wed, 18 Jan 2006 02:18:13 +0000"/>
                            <attachment id="12322029" name="derby-810.stat" size="184" author="oysteing" created="Wed, 18 Jan 2006 02:18:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 14 Jan 2006 04:45:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>22162</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0tb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38566</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>