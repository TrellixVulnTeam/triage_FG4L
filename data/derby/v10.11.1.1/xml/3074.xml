<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:28:45 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3074/DERBY-3074.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3074] Database shutdown exception 08006 throws SQLTransientConnectionException instead of SQLNonTransientConnectionException</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3074</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;SQLNonTransientConnectionException is described as:&lt;/p&gt;

&lt;p&gt; The subclass of SQLException thrown for the SQLState class value &apos;08&apos;, representing that the connection operation that failed will not succeed when the operation is retried without the cause of the failure being corrected.  See repro DerbyEmbeddedException.java &lt;/p&gt;

&lt;p&gt;Yet, database shutdown which is SQLState 8006 throws an SQLTransientConnectionSQLException&lt;br/&gt;
10.4.0.0 alpha - (1)&lt;br/&gt;
Apache Derby&lt;br/&gt;
got connection now shutdown&lt;br/&gt;
08006:Database &apos;sampl127&apos; shutdown.&lt;br/&gt;
Exception in thread &quot;main&quot; java.sql.SQLTransientConnectionException: Database &apos;sampl127&apos; shutdown.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:76)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Util.java:202)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(TransactionResourceImpl.java:391)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(TransactionResourceImpl.java:346)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.handleException(EmbedConnection.java:1574)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.&amp;lt;init&amp;gt;(EmbedConnection.java:385)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection30.&amp;lt;init&amp;gt;(EmbedConnection30.java:73)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection40.&amp;lt;init&amp;gt;(EmbedConnection40.java:54)&lt;br/&gt;
        at org.apache.derby.jdbc.Driver40.getNewEmbedConnection(Driver40.java:68)&lt;br/&gt;
        at org.apache.derby.jdbc.InternalDriver.connect(InternalDriver.java:211)&lt;br/&gt;
        at org.apache.derby.jdbc.AutoloadedDriver.connect(AutoloadedDriver.java:119)&lt;br/&gt;
        at java.sql.DriverManager.getConnection(DriverManager.java:582)&lt;br/&gt;
        at java.sql.DriverManager.getConnection(DriverManager.java:207)&lt;br/&gt;
        at DerbyEmbeddedException.main(DerbyEmbeddedException.java:29)&lt;br/&gt;
Caused by: java.sql.SQLException: Database &apos;sampl127&apos; shutdown.&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(SQLExceptionFactory.java:45)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(SQLExceptionFactory40.java:13&lt;br/&gt;
5)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(SQLExceptionFactory40.java:70)&lt;br/&gt;
        ... 13 more&lt;br/&gt;
Caused by: ERROR 08006: Database &apos;sampl127&apos; shutdown.&lt;br/&gt;
        at org.apache.derby.iapi.error.StandardException.newException(StandardException.java:290)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.TransactionResourceImpl.shutdownDatabaseException(TransactionResourceImpl.java:224&lt;br/&gt;
)&lt;br/&gt;
        at org.apache.derby.impl.jdbc.EmbedConnection.&amp;lt;init&amp;gt;(EmbedConnection.java:355)&lt;br/&gt;
        ... 8 more&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;C:/kmarsden/repro/NonTransientException&amp;#93;&lt;/span&gt; java or&lt;/p&gt;</description>
                <environment></environment>
        <key id="12378215">DERBY-3074</key>
            <summary>Database shutdown exception 08006 throws SQLTransientConnectionException instead of SQLNonTransientConnectionException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kmarsden">Kathey Marsden</assignee>
                                    <reporter username="kmarsden">Kathey Marsden</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Sep 2007 00:58:08 +0100</created>
                <updated>Wed, 14 Nov 2007 22:40:27 +0000</updated>
                            <resolved>Mon, 17 Sep 2007 19:12:04 +0100</resolved>
                                    <version>10.2.2.0</version>
                    <version>10.3.1.4</version>
                    <version>10.4.1.3</version>
                                    <fixVersion>10.3.2.1</fixVersion>
                    <fixVersion>10.4.1.3</fixVersion>
                                    <component>JDBC</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12527314" author="kmarsden" created="Fri, 14 Sep 2007 00:59:41 +0100"  >&lt;p&gt;repro to show that Transient instead of NonTransient exception is thrown.&lt;/p&gt;</comment>
                            <comment id="12527407" author="knutanders" created="Fri, 14 Sep 2007 09:36:37 +0100"  >&lt;p&gt;SQLExceptionFactory40 (both the embedded version and the client version) has this comment:&lt;/p&gt;

&lt;p&gt;            //none of the sqlstate supported by derby belongs to&lt;br/&gt;
            //NonTransientConnectionException&lt;/p&gt;

&lt;p&gt;My first thought when reading this, is that it should have been the other way around - all 08xxx states in Derby are non-transient (that is, a retry won&apos;t succeed unless the cause of the failure is corrected), but I haven&apos;t checked that it is the case.&lt;/p&gt;</comment>
                            <comment id="12527510" author="djd" created="Fri, 14 Sep 2007 15:31:50 +0100"  >&lt;p&gt;When I looked at the same code last night that was my guess as well, someone just got mixed up between Transient &amp;amp; Not Transient.&lt;/p&gt;</comment>
                            <comment id="12527590" author="kmarsden" created="Fri, 14 Sep 2007 19:11:52 +0100"  >&lt;p&gt;Attached is a patch for this issue and also &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-3075&quot; title=&quot;Client error: 08001 Error connecting to server.. throws SQLTransientConnectionException instead of SQLNonTransientConnectionException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-3075&quot;&gt;&lt;del&gt;DERBY-3075&lt;/del&gt;&lt;/a&gt;. I change SQLExceptionFactory40 for client and embedded to throw SQLNonTransientConnectionException instead of SQLTransientConnectionException for &apos;08&apos; exceptions. Added test for embedded database shutdown and client connect to server that is not up to ensure that they throw SQLNonTransientConnectionException.&lt;/p&gt;

&lt;p&gt;I am running tests now.&lt;/p&gt;</comment>
                            <comment id="12527658" author="kmarsden" created="Sat, 15 Sep 2007 00:28:25 +0100"  >&lt;p&gt;Tests passed except for ErrorCodeTest which failed with the tinderbox run.  Please review.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;Kathey&lt;/p&gt;</comment>
                            <comment id="12528100" author="kmarsden" created="Mon, 17 Sep 2007 19:12:04 +0100"  >&lt;p&gt;checked fix into trunk and 10.3&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12378216">DERBY-3075</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12365785" name="DerbyEmbeddedException.java" size="1038" author="kmarsden" created="Fri, 14 Sep 2007 00:59:40 +0100"/>
                            <attachment id="12365884" name="derby-3074_3075_diff.txt" size="6324" author="kmarsden" created="Fri, 14 Sep 2007 19:11:52 +0100"/>
                            <attachment id="12365885" name="derby-3074_3075_stat.txt" size="244" author="kmarsden" created="Fri, 14 Sep 2007 19:11:52 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 14 Sep 2007 08:36:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23412</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy10qv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>39771</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>