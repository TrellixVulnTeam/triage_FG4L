<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:47:37 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-1868/DERBY-1868.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-1868] Merge argument descriptors into SQLState strings so that SQLState documentation can be generated by a program</title>
                <link>https://issues.apache.org/jira/browse/DERBY-1868</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1566&quot; title=&quot;Document SQLStates in 10.2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1566&quot;&gt;&lt;del&gt;DERBY-1566&lt;/del&gt;&lt;/a&gt;. That JIRA introduced a program, written by David, which generates human-readable tables of message strings for inclusion in the Reference Guide. The tool doesn&apos;t patch in friendly arguments. That leaves the message strings peppered with unfriendly placeholders like &lt;/p&gt;
{0}
&lt;p&gt;. &lt;/p&gt;
{1}
&lt;p&gt;, etc.. Laura painstakingly editted the tables, by hand substituting in friendlier arguments like &amp;lt;userName&amp;gt; and &amp;lt;tableName&amp;gt;.&lt;/p&gt;

&lt;p&gt;We need to move Laura&apos;s substitutions into the source code so that David&apos;s program can automatically plug them in. This will save us a lot of grief when we generate future releases. Dan and Andrew have proposed approaches to this problem. Those approaches are discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-1566&quot; title=&quot;Document SQLStates in 10.2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-1566&quot;&gt;&lt;del&gt;DERBY-1566&lt;/del&gt;&lt;/a&gt;. Here is Andrew&apos;s comment on Dan&apos;s proposal:&lt;/p&gt;

&lt;p&gt;&quot;While Dan&apos;s suggestion here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/db-derby-dev/200608.mbox/%3c44F62247.2080500@apache.org%3e&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/db-derby-dev/200608.mbox/%3c44F62247.2080500@apache.org%3e&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;to generate the message file and doc from a single XML file would be ideal, a simpler approach to implement would be to maintain the meanings of the markers in another properties file, identified by message key and marker number. So, e.g. the new properties file would contain:&lt;/p&gt;

&lt;p&gt;01500.0=&amp;lt;constraintName&amp;gt;&lt;br/&gt;
01500.1=&amp;lt;tableName&amp;gt;&lt;/p&gt;

&lt;p&gt;Then ErrorMessageGenerator could look up the value of the markers by SQLState and MessageFormat marker number in the properties file, although this approach would require maintaining two files instead of one.&quot;&lt;/p&gt;

&lt;p&gt;I glossed this further: &quot;If we adopt Andrew&apos;s approach, I would recommend co-locating the argument descriptiors in the same properties file which contains the messages. This will help keep the argument descriptors from drifting out of sync with the messages themselves--that is a substantial advantage of Dan&apos;s approach.&quot;&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12350284">DERBY-1868</key>
            <summary>Merge argument descriptors into SQLState strings so that SQLState documentation can be generated by a program</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Sep 2006 21:58:34 +0100</created>
                <updated>Wed, 13 Dec 2006 13:57:42 +0000</updated>
                            <resolved>Wed, 13 Dec 2006 13:57:32 +0000</resolved>
                                    <version>10.2.1.6</version>
                                    <fixVersion>10.3.1.4</fixVersion>
                                    <component>Build tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12438501" author="rhillegas" created="Thu, 28 Sep 2006 18:46:00 +0100"  >&lt;p&gt;When I run the generator on xp/cygwin, it generates a file with windows-style line endings (carriage-return + linefeed). This confuses subversion when I try to check the generated file into the docs source tree. Attaching derby-1868-lineEndings-v01.diff, which causes the program to emit UNIX-style line endings (linefeed) suitable for checkin.&lt;/p&gt;</comment>
                            <comment id="12445295" author="rhillegas" created="Sat, 28 Oct 2006 00:22:59 +0100"  >&lt;p&gt;I have attached a first cut at an xml descriptor file and its grammer. This can be used to generate both the engine&apos;s messages_en.properties and the SQLState tables in the Reference Guide. I would appreciate the community&apos;s advice on how to improve this source file.&lt;/p&gt;

&lt;p&gt;In particular, there are two axes on which I considered laying out this data. One has to be the primary and the other the secondary axis:&lt;/p&gt;

&lt;p&gt;1) According to whether the messages are documented in the SQLState section of the Reference Guide.&lt;/p&gt;

&lt;p&gt;2) According to whether the message handles are defined in SQLState.java or MessageId.java.&lt;/p&gt;

&lt;p&gt;I opted for (1) as the primary axis and (2) as the secondary axis. This makes it easy to tell at a glance whether a message is documented. However, it involves mixing handles from SQLState.java and MessageId.java in the same section of the source code.&lt;/p&gt;

&lt;p&gt;Your opinions are appreciated. This is an opportunity to improve how we manage our internationalized engine messages.&lt;/p&gt;</comment>
                            <comment id="12445627" author="rhillegas" created="Mon, 30 Oct 2006 15:52:18 +0000"  >&lt;p&gt;Where should various files live? Does the following sound agreeable?&lt;/p&gt;

&lt;p&gt;1) The xml message source and its dtd grammar can live next to the generated messages_en.properties in java/engine/org/apache/derby/loc.&lt;/p&gt;

&lt;p&gt;2) The generated dita file (the dita input for the SQLState page in the Reference Guide) can go in a new generated directory: classes/doc.&lt;/p&gt;

&lt;p&gt;3) We can add a build tool to java/build/org/apache/derbyBuild. This tool will generate the engine&apos;s messages_en.properties and the dita file.&lt;/p&gt;</comment>
                            <comment id="12446019" author="rhillegas" created="Tue, 31 Oct 2006 19:56:22 +0000"  >&lt;p&gt;Attaching derby-1868-merge-v01.diff. This makes the changes necessary for this JIRA:&lt;/p&gt;

&lt;p&gt;1) Removes the now obsolete ErrorMessageGenerator.&lt;/p&gt;

&lt;p&gt;2) Replaces it with a new Ant Task, MessageBuilder. This new task runs during the Derby build at the same time that the splitmessages target runs. MessageBuilder takes an xml file of message descriptors and generates the engine&apos;s messages_en.properties as well as the SQLState tables in the Reference Guide (rrefexcept71493.dita).&lt;/p&gt;

&lt;p&gt;3) Makes corresponding changes to the build file in engine/org/apache/derby/loc.&lt;/p&gt;

&lt;p&gt;4) Removes the engine&apos;s messages_en.properties from version control since this file is now generated.&lt;/p&gt;

&lt;p&gt;5) Adds the corresponding descriptor file and its grammar: messages.xml and messages.dtd.&lt;/p&gt;

&lt;p&gt;Derbyall ran cleanly for me. This patch touches the following files:&lt;/p&gt;

&lt;p&gt;D      java/build/org/apache/derbyBuild/ErrorMessageGenerator.java&lt;br/&gt;
A      java/build/org/apache/derbyBuild/MessageBuilder.java&lt;br/&gt;
M      java/build/org/apache/derbyBuild/build.xml&lt;br/&gt;
A      java/engine/org/apache/derby/loc/messages.dtd&lt;br/&gt;
D      java/engine/org/apache/derby/loc/messages_en.properties&lt;br/&gt;
M      java/engine/org/apache/derby/loc/build.xml&lt;br/&gt;
A      java/engine/org/apache/derby/loc/messages.xml&lt;/p&gt;</comment>
                            <comment id="12446050" author="djd" created="Tue, 31 Oct 2006 20:41:02 +0000"  >&lt;p&gt;Looks good, with many opportunities for additional functionality (in the future).&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;creating the Java constants (SQLState.java) from the XML file&lt;/li&gt;
	&lt;li&gt;adding &quot;what to do&quot; text in the XML file for use in the documentation&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Nice job Rick.&lt;/p&gt;</comment>
                            <comment id="12446300" author="rhillegas" created="Wed, 1 Nov 2006 16:45:25 +0000"  >&lt;p&gt;Committed derby-1868-merged-v01.diff at subversion revision 469975.&lt;/p&gt;</comment>
                            <comment id="12446316" author="rhillegas" created="Wed, 1 Nov 2006 17:44:58 +0000"  >&lt;p&gt;Commit derby-1868-merged-v02.diff at subversion revision 470008. This causes the clobber target to delete the generated messages_en.properties. This also hides that generated file from subversion.&lt;/p&gt;</comment>
                            <comment id="12446326" author="davidvc" created="Wed, 1 Nov 2006 18:02:20 +0000"  >&lt;p&gt;Hi, Rick, thanks for your work on this.  It&apos;s great that our poor doc people won&apos;t have to weed through new messages for each release.  &lt;/p&gt;

&lt;p&gt;I do have some comments, perhaps to be fixed in subsequent revisions:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;In MessageBuilder.java PROPERTIES-BOILERPLATE and REF_GUIDE_NOTES - It seems odd to me that the generated files should have license headers.  I would think that the license header belongs in MessageBuilder.java and messages.xml, but not in the files it generates.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;In messages.xml, it would be good to tell a newbie how to add a new message - in particular, how they use and what happens with the &amp;lt;arg&amp;gt; element&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;As it stands today, translators will have to translate two files: the messages_en.properties file and the documentation file that contains the messages.  Wouldn&apos;t it make more sense to translate the messages.xml file and the MessageBuilder should generate appropriate properties files and dita files for each language (although I don&apos;t know where translated documentation ends up).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;David&lt;/p&gt;</comment>
                            <comment id="12446392" author="knutanders" created="Wed, 1 Nov 2006 22:18:56 +0000"  >&lt;p&gt;I&apos;m not able to build Derby after these changes, probably because my ant installation doesn&apos;t have ant.jar under &quot;$&lt;/p&gt;
{ant.home}
&lt;p&gt;/lib/ant.jar&quot;. The attached patch, which changes the classpath entry to &quot;$&lt;/p&gt;
{ant.library.dir}/ant.jar&quot;, makes it possible to build Derby in my environment. Rick, could you test whether ${ant.library.dir}
&lt;p&gt; works in your environment? Thanks.&lt;/p&gt;</comment>
                            <comment id="12446396" author="rhillegas" created="Wed, 1 Nov 2006 22:53:34 +0000"  >&lt;p&gt;Thanks, Knut Anders. Your patch works for me. I committed it at subversion revision 470128.&lt;/p&gt;</comment>
                            <comment id="12446401" author="rhillegas" created="Wed, 1 Nov 2006 23:11:27 +0000"  >&lt;p&gt;Hi David,&lt;/p&gt;

&lt;p&gt;Thanks for reviewing this patch. Some responses follow:&lt;/p&gt;

&lt;p&gt;1) License headers appeared in the previous, non-generated versions of messages_en.properties and rrefexcept71493.dita. I erred on the side of caution and included license headers in the generated versions. License headers might still make sense for the following reasons:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;messages_en.properties is shipped with the product&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;rrefexcept71493, although generated, is still independently checked into the source repository&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Although they are generated, I could see them being construed as &quot;creative&quot; works deserving the license header. I always get muddled around these legal issues and am inclined to err on the side of caution. Do you think there is some harm done by doing this?&lt;/p&gt;

&lt;p&gt;2) I like your suggestion about having translators translate messages.xml and have MessageBuilder generate locale-specific versions of rrefexcept71493.dita. So, instead of one messages.xml, we could have messages.xml.en, messages.xml.ja_JP, etc. It would be helpful to move the boilerplate out of MessageBuilder into messages.xml.*. Note that today&apos;s shift to xml-based descriptors has not increased the translator&apos;s burden Yesterday, translators still had to tranlate both of the files you mentioned. Your suggestion is a great one--but it&apos;s someone else&apos;s follow-on itch!&lt;/p&gt;</comment>
                            <comment id="12446996" author="rhillegas" created="Fri, 3 Nov 2006 15:53:09 +0000"  >&lt;p&gt;Committed derby-1868-merged-v03.diff at subversion revision 470862. This adds to message.xml a sentence which directs message writers to the website for guidance on how to write messages.&lt;/p&gt;</comment>
                            <comment id="12456031" author="rhillegas" created="Wed, 6 Dec 2006 14:26:39 +0000"  >&lt;p&gt;Reassigning to 10.3 since that&apos;s where the work will show up.&lt;/p&gt;</comment>
                            <comment id="12458121" author="rhillegas" created="Wed, 13 Dec 2006 13:57:32 +0000"  >&lt;p&gt;There are plenty of improvments which people can make, but this task itself is done, so I&apos;m resolving and closing this issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12344140" name="antlib.diff" size="596" author="knutanders" created="Wed, 1 Nov 2006 22:18:56 +0000"/>
                            <attachment id="12341921" name="derby-1868-lineEndings-v01.diff" size="3944" author="rhillegas" created="Thu, 28 Sep 2006 18:46:00 +0100"/>
                            <attachment id="12344030" name="derby-1868-merged-v01.diff" size="403420" author="rhillegas" created="Tue, 31 Oct 2006 19:56:22 +0000"/>
                            <attachment id="12344122" name="derby-1868-merged-v02.diff" size="1593" author="rhillegas" created="Wed, 1 Nov 2006 17:44:58 +0000"/>
                            <attachment id="12344297" name="derby-1868-merged-v03.diff" size="697" author="rhillegas" created="Fri, 3 Nov 2006 15:53:09 +0000"/>
                            <attachment id="12343818" name="messages.dtd" size="1996" author="rhillegas" created="Sat, 28 Oct 2006 00:22:59 +0100"/>
                            <attachment id="12343817" name="messages.xml" size="244283" author="rhillegas" created="Sat, 28 Oct 2006 00:22:59 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 31 Oct 2006 20:41:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30166</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy13sv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40266</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>