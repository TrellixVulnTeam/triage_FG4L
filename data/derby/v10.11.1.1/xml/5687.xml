<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:37:19 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-5687/DERBY-5687.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-5687] Back out the concurrency improvements for identity columns introduced by derby-4437</title>
                <link>https://issues.apache.org/jira/browse/DERBY-5687</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4437&quot; title=&quot;Concurrent inserts into table with identity column perform poorly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4437&quot;&gt;&lt;del&gt;DERBY-4437&lt;/del&gt;&lt;/a&gt; attempted to improve the concurrency of identity columns by using SYSSEQUENCE-style sequence generators. These improvements caused NsTest to behave differently than it used to and they disclosed a problem in clearing the identity cache. The community lost confidence in this solution and it was backed out of the 10.8 branch under issue &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5448&quot; title=&quot;In the 10.8 branch, back out the concurrency improvements introduced by using SequenceUpdaters to allocate identity values.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5448&quot;&gt;&lt;del&gt;DERBY-5448&lt;/del&gt;&lt;/a&gt;. This new issue is filed to back the improvements out of the 10.9 trunk. Further useful discussion about how to improve the concurrency and correctness of identity columns has been taking place on &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5443&quot; title=&quot;reduce number of times sequence updater does it work on user thread rather than nested user thread.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5443&quot;&gt;&lt;del&gt;DERBY-5443&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-5493&quot; title=&quot;Same value returned by successive calls to a sequence generator.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-5493&quot;&gt;&lt;del&gt;DERBY-5493&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For the 10.9 release, identity columns will return to their old behavior of being ill-suited for high concurrency applications. Applications which need higher concurrency should be re-coded to use sequences rather than identity columns.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12550222">DERBY-5687</key>
            <summary>Back out the concurrency improvements for identity columns introduced by derby-4437</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhillegas">Rick Hillegas</assignee>
                                    <reporter username="rhillegas">Rick Hillegas</reporter>
                        <labels>
                            <label>derby_backport_reject_10_8</label>
                    </labels>
                <created>Mon, 9 Apr 2012 13:58:11 +0100</created>
                <updated>Thu, 27 Jun 2013 23:21:22 +0100</updated>
                            <resolved>Thu, 27 Jun 2013 23:21:22 +0100</resolved>
                                    <version>10.9.1.0</version>
                                    <fixVersion>10.9.1.0</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13249882" author="rhillegas" created="Mon, 9 Apr 2012 16:40:11 +0100"  >&lt;p&gt;Attaching derby-5687-01-aa-backOutImprovement.diff. This patch backs out concurrency improvements introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4437&quot; title=&quot;Concurrent inserts into table with identity column perform poorly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4437&quot;&gt;&lt;del&gt;DERBY-4437&lt;/del&gt;&lt;/a&gt;. Regression tests passed cleanly for me. Committed at subversion 1311285.&lt;/p&gt;

&lt;p&gt;More specifically, this patch backs out the following patches:&lt;/p&gt;

&lt;p&gt;derby-4437-01-aj-allTestsPass.diff&lt;/p&gt;

&lt;p&gt;  The main patch which ported the work on sequences to identity columns.&lt;/p&gt;

&lt;p&gt;derby-4437-02-ac-alterTable-bulkImport-deferredInsert.diff&lt;/p&gt;

&lt;p&gt;  Test cases to verify that the port did not break various features.&lt;/p&gt;

&lt;p&gt;derby-4437-03-aa-upgradeTest.diff&lt;/p&gt;

&lt;p&gt;  Upgrade/downgrade tests for the port.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M       java/storeless/org/apache/derby/impl/storeless/EmptyDictionary.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/compile/CreateSequenceNode.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/compile/NextSequenceNode.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/InsertResultSet.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/BaseActivation.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/execute/InsertConstantAction.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/catalog/DataDictionaryImpl.java&lt;br/&gt;
M       java/engine/org/apache/derby/impl/sql/catalog/SequenceUpdater.java&lt;br/&gt;
M       java/engine/org/apache/derby/iapi/sql/dictionary/DataDictionary.java&lt;br/&gt;
M       java/engine/org/apache/derby/iapi/sql/dictionary/SequenceDescriptor.java&lt;br/&gt;
M       java/engine/org/apache/derby/iapi/reference/Property.java&lt;br/&gt;
M       java/testing/org/apache/derbyTesting/functionTests/tests/lang/AlterTableTest.java&lt;br/&gt;
M       java/testing/org/apache/derbyTesting/functionTests/tests/lang/AutoIncrementTest.java&lt;br/&gt;
D       java/testing/org/apache/derbyTesting/functionTests/tests/lang/t_4437_2.dat&lt;br/&gt;
M       java/testing/org/apache/derbyTesting/functionTests/tests/upgradeTests/Changes10_9.java&lt;/p&gt;</comment>
                            <comment id="13249913" author="rhillegas" created="Mon, 9 Apr 2012 17:17:11 +0100"  >&lt;p&gt;Attaching derby-5687-02-aa-publicAPI.diff. This patch adjusts the javadoc for SequencePreallocator, which appears in Derby&apos;s public API. The patch removes references to identity columns so that the javadoc now only talks about sequences. Committed at subversion revision 1311310.&lt;/p&gt;

&lt;p&gt;Touches the following file:&lt;/p&gt;

&lt;p&gt;M       java/engine/org/apache/derby/catalog/SequencePreallocator.java&lt;/p&gt;</comment>
                            <comment id="13249919" author="rhillegas" created="Mon, 9 Apr 2012 17:26:44 +0100"  >&lt;p&gt;Attaching derby-5687-03-aa-adjustUserDocs.diff. This patch adjusts the reference guide so that it no longer mentions identity columns when discussing sequence pre-allocators. Committed at subversion revision 1311312.&lt;/p&gt;

&lt;p&gt;Touches the following files:&lt;/p&gt;

&lt;p&gt;M       src/ref/rrefsqlj37836.dita&lt;br/&gt;
M       src/ref/rrefsqljcreatesequence.dita&lt;br/&gt;
M       src/ref/rrefproperpreallocator.dita&lt;/p&gt;</comment>
                            <comment id="13249922" author="rhillegas" created="Mon, 9 Apr 2012 17:27:56 +0100"  >&lt;p&gt;Re-attaching the user docs changes in order to grant the license to ASF.&lt;/p&gt;</comment>
                            <comment id="13251158" author="myrna" created="Wed, 11 Apr 2012 00:05:53 +0100"  >&lt;p&gt;For what it&apos;s worth, with sane jars built sync-ed up to revision 1311499 I ran the &apos;Embedded small&apos; nstest 10 times on a windows machine where before I would see at least 3 to 5 of the runs have SYSCOLUMNS deadlocks, and/or Asserts complaining about either transaction not pristine, or transaction changed on live cacheable...And this time there were none of these problems.&lt;/p&gt;

&lt;p&gt;I&apos;ll start closing the various bugs that represent these issues.&lt;/p&gt;</comment>
                            <comment id="13274629" author="rhillegas" created="Mon, 14 May 2012 15:52:20 +0100"  >&lt;p&gt;Resolving this issue. The change was backed out. &lt;a href=&quot;https://issues.apache.org/jira/browse/DERBY-4437&quot; title=&quot;Concurrent inserts into table with identity column perform poorly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DERBY-4437&quot;&gt;&lt;del&gt;DERBY-4437&lt;/del&gt;&lt;/a&gt; remains open but the other related bugs have been closed.&lt;/p&gt;</comment>
                            <comment id="13695115" author="mikem" created="Thu, 27 Jun 2013 23:20:46 +0100"  >&lt;p&gt;just reopening to set derby_backport_reject_10_8 flag&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12548026">DERBY-5671</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12440016">DERBY-4437</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12512234">DERBY-5307</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12521966" name="derby-5687-01-aa-backOutImprovement.diff" size="58486" author="rhillegas" created="Mon, 9 Apr 2012 16:40:11 +0100"/>
                            <attachment id="12521969" name="derby-5687-02-aa-publicAPI.diff" size="2407" author="rhillegas" created="Mon, 9 Apr 2012 17:17:11 +0100"/>
                            <attachment id="12521971" name="derby-5687-03-aa-adjustUserDocs.diff" size="4066" author="rhillegas" created="Mon, 9 Apr 2012 17:27:56 +0100"/>
                            <attachment id="12521970" name="derby-5687-03-aa-adjustUserDocs.diff" size="4066" author="rhillegas" created="Mon, 9 Apr 2012 17:26:44 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 10 Apr 2012 23:05:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>235087</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0bu7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35736</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>