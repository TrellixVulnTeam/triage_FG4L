<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun May 17 03:38:29 UTC 2015

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/DERBY-3722/DERBY-3722.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[DERBY-3722] Add circularity check for the GRANT role statement</title>
                <link>https://issues.apache.org/jira/browse/DERBY-3722</link>
                <project id="10594" key="DERBY">Derby</project>
                    <description>&lt;p&gt;When a role is granted to another role (with the GRANT &amp;lt;role&amp;gt; statement), we need to check that the grant relation does not give rise to a circularity. This is described in Section 12.5, Syntax rule 1 of ISO/IEC 9075-2 2003.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12398282">DERBY-3722</key>
            <summary>Add circularity check for the GRANT role statement</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12380756">DERBY-3137</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dagw">Dag H. Wanvik</assignee>
                                    <reporter username="dagw">Dag H. Wanvik</reporter>
                        <labels>
                    </labels>
                <created>Sat, 14 Jun 2008 23:32:56 +0100</created>
                <updated>Tue, 30 Jun 2009 01:14:35 +0100</updated>
                            <resolved>Sun, 22 Jun 2008 02:10:59 +0100</resolved>
                                                    <fixVersion>10.5.1.1</fixVersion>
                                    <component>SQL</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12605110" author="dagw" created="Sat, 14 Jun 2008 23:45:28 +0100"  >&lt;p&gt;This patch implements circularity checking for granting roles and adds new tests&lt;br/&gt;
for this to RolesTest. It also contains some minor cleanups (renaming and javadoc).&lt;/p&gt;

&lt;p&gt;It does this by constructing an in-memory map of the roles grant relations  and&lt;br/&gt;
providing an iterator over this. The intention is that this be useful also when&lt;br/&gt;
checking permissions conferred by roles in later patches.&lt;/p&gt;

&lt;p&gt;Running regressions.&lt;/p&gt;</comment>
                            <comment id="12605215" author="kristwaa" created="Mon, 16 Jun 2008 08:58:02 +0100"  >&lt;p&gt;A few nits:&lt;br/&gt;
 1) Mixed use of tabs and spaces.&lt;br/&gt;
 2) No JavaDoc for &apos;checkCircularity&apos; (intentional?)&lt;br/&gt;
 3) Typo: +	 * Currently, we always reads from SYSROLES.&lt;br/&gt;
 4) By quickly looking at the test &apos;checkGrantCircularity&apos;, it is not clear to me what is supposed to happen.&lt;br/&gt;
    Add two lines of comments, stating first block of statements should succeed and the second block of statements should cause the role circularity logic to thrown an exception?&lt;br/&gt;
 5) +     *         unseen node (grantee or rolename, depending in&lt;br/&gt;
    &quot;in&quot; should be &quot;on&quot;?&lt;br/&gt;
 6) + * &amp;lt;bold&amp;gt;or&amp;lt;/bold&amp;gt; one &amp;kt;grant role statement&amp;gt;, section 12.5.&lt;br/&gt;
    &amp;amp;kt should be &amp;amp;lt?&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;RoleClosureIteratorImpl&amp;#93;&lt;/span&gt;&lt;br/&gt;
 7) Unused imports.&lt;br/&gt;
 8) Make &apos;inverse&apos; final to signal it doesn&apos;t change during the RCII objects lifetime?&lt;br/&gt;
 9) A typo and a superfluous &apos;(&apos; in the JavaDoc? &lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;GrantRoleConstantAction&amp;#93;&lt;/span&gt;&lt;br/&gt;
 10) &apos;grantor&apos; in checkCircularity isn&apos;t used. Is it there for future requirements?&lt;/p&gt;

&lt;p&gt;I have &lt;b&gt;not&lt;/b&gt; reviewed all the code.&lt;/p&gt;

&lt;p&gt;Applied the patch and started regression tests.&lt;/p&gt;</comment>
                            <comment id="12605332" author="rhillegas" created="Mon, 16 Jun 2008 17:06:41 +0100"  >&lt;p&gt;Thanks for the patch, Dag. It looks like a lot of the changes are formatting changes and/or changes to names. I have a couple comments:&lt;/p&gt;

&lt;p&gt;RoleClosureIterator&lt;/p&gt;

&lt;p&gt;1) Thanks for the diagram. Are there some missing GRANTS? For instance the GRANT of a3 to d is in the graph but not in the block of SQL preceding the graph.&lt;/p&gt;

&lt;p&gt;2) I am having difficulty understanding what the iterator will list. There are some &quot;or&quot;s in the examples which lead me to think that the list is not deterministic. Could you clarify if the list is one of the following or something else?&lt;/p&gt;

&lt;p&gt;a) A list of all arcs which are part of some curve terminating in the desired role.&lt;/p&gt;

&lt;p&gt;b) One arc for each role which can be connected by some curve to the desired role. If there are many curves connecting two roles, then we cannot predict which arc will appear in the list.&lt;/p&gt;


&lt;p&gt;RoleClosureIteratorImpl&lt;/p&gt;

&lt;p&gt;1) I think it would be good if the arguments to the constructor were documented. Then the reader wouldn&apos;t have to flip back and forth between this class and the DataDictionary.&lt;/p&gt;</comment>
                            <comment id="12605333" author="dagw" created="Mon, 16 Jun 2008 17:08:04 +0100"  >&lt;p&gt;Thanks for looking at this, Kristian!&lt;/p&gt;

&lt;p&gt;A new version of the patch, derby-3722-2, addresses your comments:&lt;/p&gt;

&lt;p&gt; 1) Blank/tabs mix fixed.&lt;br/&gt;
 2) Added JavaDoc for checkCircularity.&lt;br/&gt;
 3) Typo fixed&lt;br/&gt;
 4) Added more comments to checkGrantCircularity&lt;br/&gt;
 5) Fixed typo: in-&amp;gt;on&lt;br/&gt;
 6) Fixed &amp;amp;kt -&amp;gt; &amp;amp;lt&lt;br/&gt;
 7) Unused imports.&lt;br/&gt;
 8) Made &apos;inverse&apos; final.&lt;br/&gt;
 9) Fixed &apos;(&apos;&lt;br/&gt;
 10) Removed &apos;grantor&apos; from checkCircularity,&lt;/p&gt;

&lt;p&gt;I also improved some javadoc in RoleClosureIteratorImpl.&lt;/p&gt;

&lt;p&gt;The first patch passed the regression tests, so I expect this one to&lt;br/&gt;
pass as well. Re-running now.&lt;/p&gt;</comment>
                            <comment id="12605340" author="dagw" created="Mon, 16 Jun 2008 17:34:12 +0100"  >&lt;p&gt;Thanks for looking at this Rick!&lt;/p&gt;

&lt;p&gt;I just posted a new version of the patch to answer Kristian&apos;s&lt;br/&gt;
comments, btw.&lt;/p&gt;

&lt;p&gt;&amp;gt; 1) Thanks for the diagram. Are there some missing GRANTS? For&lt;br/&gt;
&amp;gt; instance the GRANT of a3 to d is in the graph but not in the block&lt;br/&gt;
&amp;gt; of SQL preceding the graph.&lt;/p&gt;

&lt;p&gt;There is a typo: &quot;GRANT a2 to d&quot; should read &quot;GRANT a3 to d&quot;. I will&lt;br/&gt;
fix that.&lt;/p&gt;

&lt;p&gt;&amp;gt; b) One arc for each role which can be connected by some curve to the&lt;br/&gt;
&amp;gt; desired role. If there are many curves connecting two roles, then we&lt;br/&gt;
&amp;gt; cannot predict which arc will appear in the list.&lt;/p&gt;

&lt;p&gt;This is correct. I said in the javadoc it is not defined which arc is&lt;br/&gt;
returned in such a case. I see it can be a bit confusing to return the&lt;br/&gt;
arcs (the role grant descriptors) rather than just the nodes (the role&lt;br/&gt;
name string) when iterating over the closure. I will reconsider this, I think.&lt;/p&gt;

&lt;p&gt;&amp;gt; RoleClosureIteratorImpl&lt;br/&gt;
&amp;gt; 1) I think it would be good if the arguments to the constructor were&lt;br/&gt;
&amp;gt; documented. Then the reader wouldn&apos;t have to flip back and forth&lt;br/&gt;
&amp;gt; between this class and the DataDictionary.&lt;/p&gt;

&lt;p&gt;The latest patch does that.&lt;/p&gt;</comment>
                            <comment id="12605459" author="dagw" created="Tue, 17 Jun 2008 01:03:53 +0100"  >&lt;p&gt;I made a new version of the patch, derby-3722-3, which lets the&lt;br/&gt;
iterator&apos;s &apos;next&apos; method return a role name string instead of the&lt;br/&gt;
RoleGrantDescriptor in the graph. This simplifies usage. &lt;/p&gt;

&lt;p&gt;I also fixed the typo pointed out by Rick, and started using&lt;br/&gt;
BaseTestCase#fail in RolesTest where exception chaining is&lt;br/&gt;
useful. &lt;/p&gt;

&lt;p&gt;Version 2 of the patch passed regression tests, so I expect this one&lt;br/&gt;
to it as well, although not finished yet.&lt;/p&gt;</comment>
                            <comment id="12605933" author="dagw" created="Wed, 18 Jun 2008 14:23:01 +0100"  >&lt;p&gt;Regression tests passed. If there are no further comments I will commit version #3 tomorrow.&lt;/p&gt;</comment>
                            <comment id="12607055" author="dagw" created="Sun, 22 Jun 2008 02:10:59 +0100"  >&lt;p&gt;derby-3722-3 committed as svn 670284, closing.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12384016" name="derby-3722-1.diff" size="38702" author="dagw" created="Sat, 14 Jun 2008 23:45:28 +0100"/>
                            <attachment id="12384017" name="derby-3722-1.stat" size="1169" author="dagw" created="Sat, 14 Jun 2008 23:45:28 +0100"/>
                            <attachment id="12384070" name="derby-3722-2.diff" size="39935" author="dagw" created="Mon, 16 Jun 2008 17:08:04 +0100"/>
                            <attachment id="12384071" name="derby-3722-2.stat" size="1169" author="dagw" created="Mon, 16 Jun 2008 17:08:04 +0100"/>
                            <attachment id="12384092" name="derby-3722-3.diff" size="41425" author="dagw" created="Tue, 17 Jun 2008 01:03:53 +0100"/>
                            <attachment id="12384093" name="derby-3722-3.stat" size="1169" author="dagw" created="Tue, 17 Jun 2008 01:03:53 +0100"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310200" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bug behavior facts</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10361"><![CDATA[Security]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 16 Jun 2008 07:58:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30968</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2|hy0v9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>38885</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>