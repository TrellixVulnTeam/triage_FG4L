Unexpected behavior on self privilege revocation