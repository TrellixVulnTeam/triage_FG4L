java.lang.ClassCastException returning null from a case statement  in subquery