various spots casts assignments to a type more restrictive than needed, increasing cohesion. Patch reduces the casting to the required types.