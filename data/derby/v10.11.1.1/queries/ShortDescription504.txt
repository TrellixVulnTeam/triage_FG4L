SELECT DISTINCT returns duplicates when selecting from subselects