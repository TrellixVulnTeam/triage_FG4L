Select statement with subqueries with group by and count distinct statements returns wrong number of results