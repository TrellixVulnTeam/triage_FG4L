[patch] non short circuit op, could cause eof problems