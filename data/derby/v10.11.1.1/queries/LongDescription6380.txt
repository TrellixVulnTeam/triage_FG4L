DERBY-6350(Provide a rolling file implementation of derby.log) is adding a very useful feature to Derby. To test the feature, I ran the junit suite with rollingFile option as shown below
time java -Dderby.stream.error.style=rollingFile -Dderby.tests.trace=true junit.textui.TestRunner org.apache.derbyTesting.functionTests.suites.All > runall.out 2>&1
I noticed that even though we are running junit suite with the rollingFile, we still create derby.log(although it was empty) along with expected derby-0.log and so on. I had not expected to see the traditional derby.log when running with rollingFile. In addition, when a test failed, the failed directory had empty derby.log copied but the rolling log files did not get copied. The code changes to copy the rolling log files in case of failure probably need to go into org.apache.derbyTesting.junit.BaseTestCase:runBare() in the "catch (Throwable running) {" section. The log files are crucial to do any test failure debugging and hence should get copied in the failed directory.